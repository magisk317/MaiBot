import{r as u,j as e,L as Vn,e as ha,R as Ps,b as X0,f as Z0,g as W0,h as ew,k as sw,l as lt,m as tw,n as aw,O as oj,o as lw}from"./router-9vIXuQkh.js";import{a as nw,b as rw,g as iw}from"./react-vendor-BmxF9s7Q.js";import{N as cw,c as ow,O as ei,P as dw,g as Tm}from"./utils-BqoaXoQ1.js";import{L as dj,T as uj,C as mj,R as uw,a as xj,V as mw,b as xw,S as hj,c as hw,d as fj,I as fw,e as pj,f as pw,g as gj,h as gw,i as jw,j as vw,O as jj,P as Nw,k as vj,l as Nj,D as bj,A as yj,m as wj,n as bw,o as yw,p as _j,q as ww,r as Sj,s as _w,t as Sw,u as kj,v as kw,w as Cw,x as Cj,y as Tj,F as Ej,z as Mj,B as Tw,E as Ew,G as Aj,H as Mw,J as Aw,K as zw,M as Rw,N as Dw,Q as Ow,U as Lw,W as Uw,X as $w,Y as Bw,Z as Pw,_ as Iw,$ as Fw,a0 as Hw,a1 as qw,a2 as zj,a3 as Vw,a4 as Gw}from"./radix-extra-DmmnfeQE.js";import{R as Rj,T as Dj,L as Kw,g as Qw,C as Qi,X as Yi,Y as qr,h as Yw,B as Uo,j as Ji,P as Jw,k as Xw,l as Zw}from"./charts-simvewUa.js";import{S as Ww,O as Oj,o as e1,C as Lj,p as s1,T as Uj,D as $j,R as t1,q as a1,H as Bj,I as l1,J as Pj,K as n1,L as Ij,M as Fj,N as r1,Q as Hj,V as i1,U as qj,X as Vj,Y as c1,Z as o1,_ as Gj,$ as d1,a0 as u1,a1 as Kj,e as Qj,f as sd,c as td,P as sr,d as ad,b as Nn,h as m1,l as x1,m as h1,u as Qm,r as f1,a as p1,a2 as g1,a3 as Yj,a4 as j1,a5 as v1,a6 as N1,a7 as Jj,a8 as Xj,a9 as Zj,aa as Wj,ab as ev,ac as sv,ad as b1}from"./radix-core-DyJi0yyw.js";import{R as mt,a as lc,C as Rt,b as st,L as Fs,X as Sa,c as Lt,d as $a,e as Yr,f as Pa,g as ia,E as y1,h as tv,Z as el,i as ca,j as aa,S as Ut,B as av,U as $l,k as Kn,P as hc,l as lv,F as La,m as w1,n as bn,o as _1,M as Ba,A as ax,D as S1,p as Jr,T as lx,q as k1,r as nv,I as Yt,s as Ft,t as Fo,u as nc,v as oa,H as C1,w as os,x as ra,y as rc,z as nx,G as ec,J as Sg,K as rx,N as rv,O as T1,Q as $o,V as E1,W as ld,Y as M1,_ as A1,$ as nd,a0 as Ua,a1 as Xs,a2 as ix,a3 as cx,a4 as iv,a5 as fc,a6 as cv,a7 as Jn,a8 as yn,a9 as wn,aa as ox,ab as ov,ac as xa,ad as Bl,ae as Xn,af as Zn,ag as rd,ah as z1,ai as R1,aj as D1,ak as dx,al as Bo,am as Wn,an as Xr,ao as Ho,ap as O1,aq as qo,ar as ic,as as dv,at as L1,au as U1,av as Vo,aw as $1,ax as ux,ay as kg,az as B1,aA as P1,aB as uv,aC as I1,aD as fn,aE as mv,aF as Em,aG as Cg,aH as F1,aI as Mm,aJ as H1,aK as q1,aL as V1,aM as G1,aN as xv,aO as K1,aP as Zr,aQ as Q1,aR as Y1,aS as hv,aT as fv,aU as J1,aV as X1,aW as Tg,aX as Z1,aY as W1,aZ as e_,a_ as s_,a$ as t_}from"./icons-CBTr14-W.js";import{S as a_,p as l_,j as n_,a as r_,E as Am,R as i_,o as c_}from"./codemirror-TZqPU532.js";import{u as pv,a as Go,s as gv,K as jv,P as vv,b as Nv,D as bv,c as yv,S as wv,v as o_,d as _v,C as Sv,h as d_}from"./dnd-BiPfFtVp.js";import{_ as ka,c as u_,g as kv,D as m_,z as Ro}from"./misc-CJqnlRwD.js";import{D as x_,U as h_}from"./uppy-DFP_VzYR.js";import{M as f_,r as p_,a as g_,b as j_}from"./markdown-CKA5gBQ9.js";import{c as v_,H as Ko,P as Qo,u as N_,d as b_,R as y_,B as w_,e as __,C as S_,M as k_,f as C_}from"./reactflow-DtsZHOR4.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const h of m.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function r(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function c(d){if(d.ep)return;d.ep=!0;const m=r(d);fetch(d.href,m)}})();var zm={exports:{}},Vi={},Rm={exports:{}},Dm={};var Eg;function T_(){return Eg||(Eg=1,(function(a){function l(D,Q){var B=D.length;D.push(Q);e:for(;0<B;){var ue=B-1>>>1,Y=D[ue];if(0<d(Y,Q))D[ue]=Q,D[B]=Y,B=ue;else break e}}function r(D){return D.length===0?null:D[0]}function c(D){if(D.length===0)return null;var Q=D[0],B=D.pop();if(B!==Q){D[0]=B;e:for(var ue=0,Y=D.length,_e=Y>>>1;ue<_e;){var he=2*(ue+1)-1,Te=D[he],G=he+1,$=D[G];if(0>d(Te,B))G<Y&&0>d($,Te)?(D[ue]=$,D[G]=B,ue=G):(D[ue]=Te,D[he]=B,ue=he);else if(G<Y&&0>d($,B))D[ue]=$,D[G]=B,ue=G;else break e}}return Q}function d(D,Q){var B=D.sortIndex-Q.sortIndex;return B!==0?B:D.id-Q.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;a.unstable_now=function(){return m.now()}}else{var h=Date,f=h.now();a.unstable_now=function(){return h.now()-f}}var p=[],g=[],N=1,j=null,b=3,y=!1,w=!1,A=!1,M=!1,S=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(D){for(var Q=r(g);Q!==null;){if(Q.callback===null)c(g);else if(Q.startTime<=D)c(g),Q.sortIndex=Q.expirationTime,l(p,Q);else break;Q=r(g)}}function R(D){if(A=!1,C(D),!w)if(r(p)!==null)w=!0,H||(H=!0,je());else{var Q=r(g);Q!==null&&pe(R,Q.startTime-D)}}var H=!1,O=-1,X=5,L=-1;function me(){return M?!0:!(a.unstable_now()-L<X)}function Ne(){if(M=!1,H){var D=a.unstable_now();L=D;var Q=!0;try{e:{w=!1,A&&(A=!1,I(O),O=-1),y=!0;var B=b;try{s:{for(C(D),j=r(p);j!==null&&!(j.expirationTime>D&&me());){var ue=j.callback;if(typeof ue=="function"){j.callback=null,b=j.priorityLevel;var Y=ue(j.expirationTime<=D);if(D=a.unstable_now(),typeof Y=="function"){j.callback=Y,C(D),Q=!0;break s}j===r(p)&&c(p),C(D)}else c(p);j=r(p)}if(j!==null)Q=!0;else{var _e=r(g);_e!==null&&pe(R,_e.startTime-D),Q=!1}}break e}finally{j=null,b=B,y=!1}Q=void 0}}finally{Q?je():H=!1}}}var je;if(typeof E=="function")je=function(){E(Ne)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ge=ce.port2;ce.port1.onmessage=Ne,je=function(){ge.postMessage(null)}}else je=function(){S(Ne,0)};function pe(D,Q){O=S(function(){D(a.unstable_now())},Q)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(D){D.callback=null},a.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<D?Math.floor(1e3/D):5},a.unstable_getCurrentPriorityLevel=function(){return b},a.unstable_next=function(D){switch(b){case 1:case 2:case 3:var Q=3;break;default:Q=b}var B=b;b=Q;try{return D()}finally{b=B}},a.unstable_requestPaint=function(){M=!0},a.unstable_runWithPriority=function(D,Q){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var B=b;b=D;try{return Q()}finally{b=B}},a.unstable_scheduleCallback=function(D,Q,B){var ue=a.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?ue+B:ue):B=ue,D){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=B+Y,D={id:N++,callback:Q,priorityLevel:D,startTime:B,expirationTime:Y,sortIndex:-1},B>ue?(D.sortIndex=B,l(g,D),r(p)===null&&D===r(g)&&(A?(I(O),O=-1):A=!0,pe(R,B-ue))):(D.sortIndex=Y,l(p,D),w||y||(w=!0,H||(H=!0,je()))),D},a.unstable_shouldYield=me,a.unstable_wrapCallback=function(D){var Q=b;return function(){var B=b;b=Q;try{return D.apply(this,arguments)}finally{b=B}}}})(Dm)),Dm}var Mg;function E_(){return Mg||(Mg=1,Rm.exports=T_()),Rm.exports}var Ag;function M_(){if(Ag)return Vi;Ag=1;var a=E_(),l=nw(),r=rw();function c(s){var t="https://react.dev/errors/"+s;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+s+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function m(s){var t=s,n=s;if(s.alternate)for(;t.return;)t=t.return;else{s=t;do t=s,(t.flags&4098)!==0&&(n=t.return),s=t.return;while(s)}return t.tag===3?n:null}function h(s){if(s.tag===13){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function f(s){if(s.tag===31){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function p(s){if(m(s)!==s)throw Error(c(188))}function g(s){var t=s.alternate;if(!t){if(t=m(s),t===null)throw Error(c(188));return t!==s?null:s}for(var n=s,i=t;;){var o=n.return;if(o===null)break;var x=o.alternate;if(x===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===x.child){for(x=o.child;x;){if(x===n)return p(o),s;if(x===i)return p(o),t;x=x.sibling}throw Error(c(188))}if(n.return!==i.return)n=o,i=x;else{for(var v=!1,k=o.child;k;){if(k===n){v=!0,n=o,i=x;break}if(k===i){v=!0,i=o,n=x;break}k=k.sibling}if(!v){for(k=x.child;k;){if(k===n){v=!0,n=x,i=o;break}if(k===i){v=!0,i=x,n=o;break}k=k.sibling}if(!v)throw Error(c(189))}}if(n.alternate!==i)throw Error(c(190))}if(n.tag!==3)throw Error(c(188));return n.stateNode.current===n?s:t}function N(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s;for(s=s.child;s!==null;){if(t=N(s),t!==null)return t;s=s.sibling}return null}var j=Object.assign,b=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),me=Symbol.for("react.memo_cache_sentinel"),Ne=Symbol.iterator;function je(s){return s===null||typeof s!="object"?null:(s=Ne&&s[Ne]||s["@@iterator"],typeof s=="function"?s:null)}var ce=Symbol.for("react.client.reference");function ge(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ce?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case S:return"Profiler";case M:return"StrictMode";case R:return"Suspense";case H:return"SuspenseList";case L:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case E:return s.displayName||"Context";case I:return(s._context.displayName||"Context")+".Consumer";case C:var t=s.render;return s=s.displayName,s||(s=t.displayName||t.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return t=s.displayName||null,t!==null?t:ge(s.type)||"Memo";case X:t=s._payload,s=s._init;try{return ge(s(t))}catch{}}return null}var pe=Array.isArray,D=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},ue=[],Y=-1;function _e(s){return{current:s}}function he(s){0>Y||(s.current=ue[Y],ue[Y]=null,Y--)}function Te(s,t){Y++,ue[Y]=s.current,s.current=t}var G=_e(null),$=_e(null),z=_e(null),K=_e(null);function De(s,t){switch(Te(z,t),Te($,s),Te(G,null),t.nodeType){case 9:case 11:s=(s=t.documentElement)&&(s=s.namespaceURI)?Qp(s):0;break;default:if(s=t.tagName,t=t.namespaceURI)t=Qp(t),s=Yp(t,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(G),Te(G,s)}function se(){he(G),he($),he(z)}function Le(s){s.memoizedState!==null&&Te(K,s);var t=G.current,n=Yp(t,s.type);t!==n&&(Te($,s),Te(G,n))}function rs(s){$.current===s&&(he(G),he($)),K.current===s&&(he(K),Ii._currentValue=B)}var J,W;function Ue(s){if(J===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);J=t&&t[1]||"",W=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+J+s+W}var ae=!1;function Ee(s,t){if(!s||ae)return"";ae=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(xe){var oe=xe}Reflect.construct(s,[],we)}else{try{we.call()}catch(xe){oe=xe}s.call(we.prototype)}}else{try{throw Error()}catch(xe){oe=xe}(we=s())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(xe){if(xe&&oe&&typeof xe.stack=="string")return[xe.stack,oe.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=i.DetermineComponentFrameRoot(),v=x[0],k=x[1];if(v&&k){var P=v.split(`
`),ie=k.split(`
`);for(o=i=0;i<P.length&&!P[i].includes("DetermineComponentFrameRoot");)i++;for(;o<ie.length&&!ie[o].includes("DetermineComponentFrameRoot");)o++;if(i===P.length||o===ie.length)for(i=P.length-1,o=ie.length-1;1<=i&&0<=o&&P[i]!==ie[o];)o--;for(;1<=i&&0<=o;i--,o--)if(P[i]!==ie[o]){if(i!==1||o!==1)do if(i--,o--,0>o||P[i]!==ie[o]){var ve=`
`+P[i].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=i&&0<=o);break}}}finally{ae=!1,Error.prepareStackTrace=n}return(n=s?s.displayName||s.name:"")?Ue(n):""}function de(s,t){switch(s.tag){case 26:case 27:case 5:return Ue(s.type);case 16:return Ue("Lazy");case 13:return s.child!==t&&t!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return Ee(s.type,!1);case 11:return Ee(s.type.render,!1);case 1:return Ee(s.type,!0);case 31:return Ue("Activity");default:return""}}function Re(s){try{var t="",n=null;do t+=de(s,n),n=s,s=s.return;while(s);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var ys=Object.prototype.hasOwnProperty,Js=a.unstable_scheduleCallback,kt=a.unstable_cancelCallback,pa=a.unstable_shouldYield,rt=a.unstable_requestPaint,$s=a.unstable_now,q=a.unstable_getCurrentPriorityLevel,He=a.unstable_ImmediatePriority,Ke=a.unstable_UserBlockingPriority,Ze=a.unstable_NormalPriority,Ts=a.unstable_LowPriority,as=a.unstable_IdlePriority,Es=a.log,es=a.unstable_setDisableYieldValue,Is=null,ds=null;function is(s){if(typeof Es=="function"&&es(s),ds&&typeof ds.setStrictMode=="function")try{ds.setStrictMode(Is,s)}catch{}}var ws=Math.clz32?Math.clz32:Ae,it=Math.log,vt=Math.LN2;function Ae(s){return s>>>=0,s===0?32:31-(it(s)/vt|0)|0}var Ge=256,Ls=262144,ct=4194304;function Ht(s){var t=s&42;if(t!==0)return t;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function da(s,t,n){var i=s.pendingLanes;if(i===0)return 0;var o=0,x=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var k=i&134217727;return k!==0?(i=k&~x,i!==0?o=Ht(i):(v&=k,v!==0?o=Ht(v):n||(n=k&~s,n!==0&&(o=Ht(n))))):(k=i&~x,k!==0?o=Ht(k):v!==0?o=Ht(v):n||(n=i&~s,n!==0&&(o=Ht(n)))),o===0?0:t!==0&&t!==o&&(t&x)===0&&(x=o&-o,n=t&-t,x>=n||x===32&&(n&4194048)!==0)?t:o}function Ia(s,t){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&t)===0}function Xt(s,t){switch(s){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function te(){var s=ct;return ct<<=1,(ct&62914560)===0&&(ct=4194304),s}function ye(s){for(var t=[],n=0;31>n;n++)t.push(s);return t}function U(s,t){s.pendingLanes|=t,t!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Me(s,t,n,i,o,x){var v=s.pendingLanes;s.pendingLanes=n,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=n,s.entangledLanes&=n,s.errorRecoveryDisabledLanes&=n,s.shellSuspendCounter=0;var k=s.entanglements,P=s.expirationTimes,ie=s.hiddenUpdates;for(n=v&~n;0<n;){var ve=31-ws(n),we=1<<ve;k[ve]=0,P[ve]=-1;var oe=ie[ve];if(oe!==null)for(ie[ve]=null,ve=0;ve<oe.length;ve++){var xe=oe[ve];xe!==null&&(xe.lane&=-536870913)}n&=~we}i!==0&&Xe(s,i,0),x!==0&&o===0&&s.tag!==0&&(s.suspendedLanes|=x&~(v&~t))}function Xe(s,t,n){s.pendingLanes|=t,s.suspendedLanes&=~t;var i=31-ws(t);s.entangledLanes|=t,s.entanglements[i]=s.entanglements[i]|1073741824|n&261930}function us(s,t){var n=s.entangledLanes|=t;for(s=s.entanglements;n;){var i=31-ws(n),o=1<<i;o&t|s[i]&t&&(s[i]|=t),n&=~o}}function cs(s,t){var n=t&-t;return n=(n&42)!==0?1:Ct(n),(n&(s.suspendedLanes|t))!==0?0:n}function Ct(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Bs(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ne(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:jg(s.type))}function fe(s,t){var n=Q.p;try{return Q.p=s,t()}finally{Q.p=n}}var ss=Math.random().toString(36).slice(2),_s="__reactFiber$"+ss,ms="__reactProps$"+ss,_t="__reactContainer$"+ss,ua="__reactEvents$"+ss,Zt="__reactListeners$"+ss,ql="__reactHandles$"+ss,kn="__reactResources$"+ss,Cn="__reactMarker$"+ss;function Nd(s){delete s[_s],delete s[ms],delete s[ua],delete s[Zt],delete s[ql]}function lr(s){var t=s[_s];if(t)return t;for(var n=s.parentNode;n;){if(t=n[_t]||n[_s]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(s=tg(s);s!==null;){if(n=s[_s])return n;s=tg(s)}return t}s=n,n=s.parentNode}return null}function nr(s){if(s=s[_s]||s[_t]){var t=s.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return s}return null}function ai(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s.stateNode;throw Error(c(33))}function rr(s){var t=s[kn];return t||(t=s[kn]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Kt(s){s[Cn]=!0}var Ox=new Set,Lx={};function Tn(s,t){ir(s,t),ir(s+"Capture",t)}function ir(s,t){for(Lx[s]=t,s=0;s<t.length;s++)Ox.add(t[s])}var Fb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ux={},$x={};function Hb(s){return ys.call($x,s)?!0:ys.call(Ux,s)?!1:Fb.test(s)?$x[s]=!0:(Ux[s]=!0,!1)}function Nc(s,t,n){if(Hb(t))if(n===null)s.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":s.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){s.removeAttribute(t);return}}s.setAttribute(t,""+n)}}function bc(s,t,n){if(n===null)s.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(t);return}s.setAttribute(t,""+n)}}function pl(s,t,n,i){if(i===null)s.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(n);return}s.setAttributeNS(t,n,""+i)}}function Fa(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Bx(s){var t=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function qb(s,t,n){var i=Object.getOwnPropertyDescriptor(s.constructor.prototype,t);if(!s.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var o=i.get,x=i.set;return Object.defineProperty(s,t,{configurable:!0,get:function(){return o.call(this)},set:function(v){n=""+v,x.call(this,v)}}),Object.defineProperty(s,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(v){n=""+v},stopTracking:function(){s._valueTracker=null,delete s[t]}}}}function bd(s){if(!s._valueTracker){var t=Bx(s)?"checked":"value";s._valueTracker=qb(s,t,""+s[t])}}function Px(s){if(!s)return!1;var t=s._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return s&&(i=Bx(s)?s.checked?"true":"false":s.value),s=i,s!==n?(t.setValue(s),!0):!1}function yc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Vb=/[\n"\\]/g;function Ha(s){return s.replace(Vb,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function yd(s,t,n,i,o,x,v,k){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),t!=null?v==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+Fa(t)):s.value!==""+Fa(t)&&(s.value=""+Fa(t)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),t!=null?wd(s,v,Fa(t)):n!=null?wd(s,v,Fa(n)):i!=null&&s.removeAttribute("value"),o==null&&x!=null&&(s.defaultChecked=!!x),o!=null&&(s.checked=o&&typeof o!="function"&&typeof o!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+Fa(k):s.removeAttribute("name")}function Ix(s,t,n,i,o,x,v,k){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),t!=null||n!=null){if(!(x!=="submit"&&x!=="reset"||t!=null)){bd(s);return}n=n!=null?""+Fa(n):"",t=t!=null?""+Fa(t):n,k||t===s.value||(s.value=t),s.defaultValue=t}i=i??o,i=typeof i!="function"&&typeof i!="symbol"&&!!i,s.checked=k?s.checked:!!i,s.defaultChecked=!!i,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),bd(s)}function wd(s,t,n){t==="number"&&yc(s.ownerDocument)===s||s.defaultValue===""+n||(s.defaultValue=""+n)}function cr(s,t,n,i){if(s=s.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<s.length;n++)o=t.hasOwnProperty("$"+s[n].value),s[n].selected!==o&&(s[n].selected=o),o&&i&&(s[n].defaultSelected=!0)}else{for(n=""+Fa(n),t=null,o=0;o<s.length;o++){if(s[o].value===n){s[o].selected=!0,i&&(s[o].defaultSelected=!0);return}t!==null||s[o].disabled||(t=s[o])}t!==null&&(t.selected=!0)}}function Fx(s,t,n){if(t!=null&&(t=""+Fa(t),t!==s.value&&(s.value=t),n==null)){s.defaultValue!==t&&(s.defaultValue=t);return}s.defaultValue=n!=null?""+Fa(n):""}function Hx(s,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(c(92));if(pe(i)){if(1<i.length)throw Error(c(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=Fa(t),s.defaultValue=n,i=s.textContent,i===n&&i!==""&&i!==null&&(s.value=i),bd(s)}function or(s,t){if(t){var n=s.firstChild;if(n&&n===s.lastChild&&n.nodeType===3){n.nodeValue=t;return}}s.textContent=t}var Gb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function qx(s,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?s.setProperty(t,""):t==="float"?s.cssFloat="":s[t]="":i?s.setProperty(t,n):typeof n!="number"||n===0||Gb.has(t)?t==="float"?s.cssFloat=n:s[t]=(""+n).trim():s[t]=n+"px"}function Vx(s,t,n){if(t!=null&&typeof t!="object")throw Error(c(62));if(s=s.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="");for(var o in t)i=t[o],t.hasOwnProperty(o)&&n[o]!==i&&qx(s,o,i)}else for(var x in t)t.hasOwnProperty(x)&&qx(s,x,t[x])}function _d(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wc(s){return Qb.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function gl(){}var Sd=null;function kd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var dr=null,ur=null;function Gx(s){var t=nr(s);if(t&&(s=t.stateNode)){var n=s[ms]||null;e:switch(s=t.stateNode,t.type){case"input":if(yd(s,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=s;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Ha(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==s&&i.form===s.form){var o=i[ms]||null;if(!o)throw Error(c(90));yd(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===s.form&&Px(i)}break e;case"textarea":Fx(s,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&cr(s,!!n.multiple,t,!1)}}}var Cd=!1;function Kx(s,t,n){if(Cd)return s(t,n);Cd=!0;try{var i=s(t);return i}finally{if(Cd=!1,(dr!==null||ur!==null)&&(uo(),dr&&(t=dr,s=ur,ur=dr=null,Gx(t),s)))for(t=0;t<s.length;t++)Gx(s[t])}}function li(s,t){var n=s.stateNode;if(n===null)return null;var i=n[ms]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(s=s.type,i=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!i;break e;default:s=!1}if(s)return null;if(n&&typeof n!="function")throw Error(c(231,t,typeof n));return n}var jl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Td=!1;if(jl)try{var ni={};Object.defineProperty(ni,"passive",{get:function(){Td=!0}}),window.addEventListener("test",ni,ni),window.removeEventListener("test",ni,ni)}catch{Td=!1}var Vl=null,Ed=null,_c=null;function Qx(){if(_c)return _c;var s,t=Ed,n=t.length,i,o="value"in Vl?Vl.value:Vl.textContent,x=o.length;for(s=0;s<n&&t[s]===o[s];s++);var v=n-s;for(i=1;i<=v&&t[n-i]===o[x-i];i++);return _c=o.slice(s,1<i?1-i:void 0)}function Sc(s){var t=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&t===13&&(s=13)):s=t,s===10&&(s=13),32<=s||s===13?s:0}function kc(){return!0}function Yx(){return!1}function ga(s){function t(n,i,o,x,v){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=x,this.target=v,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(n=s[k],this[k]=n?n(x):x[k]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?kc:Yx,this.isPropagationStopped=Yx,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kc)},persist:function(){},isPersistent:kc}),t}var En={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cc=ga(En),ri=j({},En,{view:0,detail:0}),Yb=ga(ri),Md,Ad,ii,Tc=j({},ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ii&&(ii&&s.type==="mousemove"?(Md=s.screenX-ii.screenX,Ad=s.screenY-ii.screenY):Ad=Md=0,ii=s),Md)},movementY:function(s){return"movementY"in s?s.movementY:Ad}}),Jx=ga(Tc),Jb=j({},Tc,{dataTransfer:0}),Xb=ga(Jb),Zb=j({},ri,{relatedTarget:0}),zd=ga(Zb),Wb=j({},En,{animationName:0,elapsedTime:0,pseudoElement:0}),ey=ga(Wb),sy=j({},En,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ty=ga(sy),ay=j({},En,{data:0}),Xx=ga(ay),ly={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ny={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ry={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iy(s){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(s):(s=ry[s])?!!t[s]:!1}function Rd(){return iy}var cy=j({},ri,{key:function(s){if(s.key){var t=ly[s.key]||s.key;if(t!=="Unidentified")return t}return s.type==="keypress"?(s=Sc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ny[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rd,charCode:function(s){return s.type==="keypress"?Sc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Sc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),oy=ga(cy),dy=j({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zx=ga(dy),uy=j({},ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rd}),my=ga(uy),xy=j({},En,{propertyName:0,elapsedTime:0,pseudoElement:0}),hy=ga(xy),fy=j({},Tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),py=ga(fy),gy=j({},En,{newState:0,oldState:0}),jy=ga(gy),vy=[9,13,27,32],Dd=jl&&"CompositionEvent"in window,ci=null;jl&&"documentMode"in document&&(ci=document.documentMode);var Ny=jl&&"TextEvent"in window&&!ci,Wx=jl&&(!Dd||ci&&8<ci&&11>=ci),eh=" ",sh=!1;function th(s,t){switch(s){case"keyup":return vy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ah(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var mr=!1;function by(s,t){switch(s){case"compositionend":return ah(t);case"keypress":return t.which!==32?null:(sh=!0,eh);case"textInput":return s=t.data,s===eh&&sh?null:s;default:return null}}function yy(s,t){if(mr)return s==="compositionend"||!Dd&&th(s,t)?(s=Qx(),_c=Ed=Vl=null,mr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Wx&&t.locale!=="ko"?null:t.data;default:return null}}var wy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lh(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t==="input"?!!wy[s.type]:t==="textarea"}function nh(s,t,n,i){dr?ur?ur.push(i):ur=[i]:dr=i,t=jo(t,"onChange"),0<t.length&&(n=new Cc("onChange","change",null,n,i),s.push({event:n,listeners:t}))}var oi=null,di=null;function _y(s){Fp(s,0)}function Ec(s){var t=ai(s);if(Px(t))return s}function rh(s,t){if(s==="change")return t}var ih=!1;if(jl){var Od;if(jl){var Ld="oninput"in document;if(!Ld){var ch=document.createElement("div");ch.setAttribute("oninput","return;"),Ld=typeof ch.oninput=="function"}Od=Ld}else Od=!1;ih=Od&&(!document.documentMode||9<document.documentMode)}function oh(){oi&&(oi.detachEvent("onpropertychange",dh),di=oi=null)}function dh(s){if(s.propertyName==="value"&&Ec(di)){var t=[];nh(t,di,s,kd(s)),Kx(_y,t)}}function Sy(s,t,n){s==="focusin"?(oh(),oi=t,di=n,oi.attachEvent("onpropertychange",dh)):s==="focusout"&&oh()}function ky(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ec(di)}function Cy(s,t){if(s==="click")return Ec(t)}function Ty(s,t){if(s==="input"||s==="change")return Ec(t)}function Ey(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var Ca=typeof Object.is=="function"?Object.is:Ey;function ui(s,t){if(Ca(s,t))return!0;if(typeof s!="object"||s===null||typeof t!="object"||t===null)return!1;var n=Object.keys(s),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!ys.call(t,o)||!Ca(s[o],t[o]))return!1}return!0}function uh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function mh(s,t){var n=uh(s);s=0;for(var i;n;){if(n.nodeType===3){if(i=s+n.textContent.length,s<=t&&i>=t)return{node:n,offset:t-s};s=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uh(n)}}function xh(s,t){return s&&t?s===t?!0:s&&s.nodeType===3?!1:t&&t.nodeType===3?xh(s,t.parentNode):"contains"in s?s.contains(t):s.compareDocumentPosition?!!(s.compareDocumentPosition(t)&16):!1:!1}function hh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var t=yc(s.document);t instanceof s.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)s=t.contentWindow;else break;t=yc(s.document)}return t}function Ud(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t&&(t==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||t==="textarea"||s.contentEditable==="true")}var My=jl&&"documentMode"in document&&11>=document.documentMode,xr=null,$d=null,mi=null,Bd=!1;function fh(s,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bd||xr==null||xr!==yc(i)||(i=xr,"selectionStart"in i&&Ud(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),mi&&ui(mi,i)||(mi=i,i=jo($d,"onSelect"),0<i.length&&(t=new Cc("onSelect","select",null,t,n),s.push({event:t,listeners:i}),t.target=xr)))}function Mn(s,t){var n={};return n[s.toLowerCase()]=t.toLowerCase(),n["Webkit"+s]="webkit"+t,n["Moz"+s]="moz"+t,n}var hr={animationend:Mn("Animation","AnimationEnd"),animationiteration:Mn("Animation","AnimationIteration"),animationstart:Mn("Animation","AnimationStart"),transitionrun:Mn("Transition","TransitionRun"),transitionstart:Mn("Transition","TransitionStart"),transitioncancel:Mn("Transition","TransitionCancel"),transitionend:Mn("Transition","TransitionEnd")},Pd={},ph={};jl&&(ph=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);function An(s){if(Pd[s])return Pd[s];if(!hr[s])return s;var t=hr[s],n;for(n in t)if(t.hasOwnProperty(n)&&n in ph)return Pd[s]=t[n];return s}var gh=An("animationend"),jh=An("animationiteration"),vh=An("animationstart"),Ay=An("transitionrun"),zy=An("transitionstart"),Ry=An("transitioncancel"),Nh=An("transitionend"),bh=new Map,Id="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Id.push("scrollEnd");function al(s,t){bh.set(s,t),Tn(t,[s])}var Mc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},qa=[],fr=0,Fd=0;function Ac(){for(var s=fr,t=Fd=fr=0;t<s;){var n=qa[t];qa[t++]=null;var i=qa[t];qa[t++]=null;var o=qa[t];qa[t++]=null;var x=qa[t];if(qa[t++]=null,i!==null&&o!==null){var v=i.pending;v===null?o.next=o:(o.next=v.next,v.next=o),i.pending=o}x!==0&&yh(n,o,x)}}function zc(s,t,n,i){qa[fr++]=s,qa[fr++]=t,qa[fr++]=n,qa[fr++]=i,Fd|=i,s.lanes|=i,s=s.alternate,s!==null&&(s.lanes|=i)}function Hd(s,t,n,i){return zc(s,t,n,i),Rc(s)}function zn(s,t){return zc(s,null,null,t),Rc(s)}function yh(s,t,n){s.lanes|=n;var i=s.alternate;i!==null&&(i.lanes|=n);for(var o=!1,x=s.return;x!==null;)x.childLanes|=n,i=x.alternate,i!==null&&(i.childLanes|=n),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(o=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,o&&t!==null&&(o=31-ws(n),s=x.hiddenUpdates,i=s[o],i===null?s[o]=[t]:i.push(t),t.lane=n|536870912),x):null}function Rc(s){if(50<Di)throw Di=0,Zu=null,Error(c(185));for(var t=s.return;t!==null;)s=t,t=s.return;return s.tag===3?s.stateNode:null}var pr={};function Dy(s,t,n,i){this.tag=s,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(s,t,n,i){return new Dy(s,t,n,i)}function qd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function vl(s,t){var n=s.alternate;return n===null?(n=Ta(s.tag,t,s.key,s.mode),n.elementType=s.elementType,n.type=s.type,n.stateNode=s.stateNode,n.alternate=s,s.alternate=n):(n.pendingProps=t,n.type=s.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=s.flags&65011712,n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,t=s.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=s.sibling,n.index=s.index,n.ref=s.ref,n.refCleanup=s.refCleanup,n}function wh(s,t){s.flags&=65011714;var n=s.alternate;return n===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=n.childLanes,s.lanes=n.lanes,s.child=n.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=n.memoizedProps,s.memoizedState=n.memoizedState,s.updateQueue=n.updateQueue,s.type=n.type,t=n.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s}function Dc(s,t,n,i,o,x){var v=0;if(i=s,typeof s=="function")qd(s)&&(v=1);else if(typeof s=="string")v=B0(s,n,G.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case L:return s=Ta(31,n,t,o),s.elementType=L,s.lanes=x,s;case A:return Rn(n.children,o,x,t);case M:v=8,o|=24;break;case S:return s=Ta(12,n,t,o|2),s.elementType=S,s.lanes=x,s;case R:return s=Ta(13,n,t,o),s.elementType=R,s.lanes=x,s;case H:return s=Ta(19,n,t,o),s.elementType=H,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:v=10;break e;case I:v=9;break e;case C:v=11;break e;case O:v=14;break e;case X:v=16,i=null;break e}v=29,n=Error(c(130,s===null?"null":typeof s,"")),i=null}return t=Ta(v,n,t,o),t.elementType=s,t.type=i,t.lanes=x,t}function Rn(s,t,n,i){return s=Ta(7,s,i,t),s.lanes=n,s}function Vd(s,t,n){return s=Ta(6,s,null,t),s.lanes=n,s}function _h(s){var t=Ta(18,null,null,0);return t.stateNode=s,t}function Gd(s,t,n){return t=Ta(4,s.children!==null?s.children:[],s.key,t),t.lanes=n,t.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},t}var Sh=new WeakMap;function Va(s,t){if(typeof s=="object"&&s!==null){var n=Sh.get(s);return n!==void 0?n:(t={value:s,source:t,stack:Re(t)},Sh.set(s,t),t)}return{value:s,source:t,stack:Re(t)}}var gr=[],jr=0,Oc=null,xi=0,Ga=[],Ka=0,Gl=null,dl=1,ul="";function Nl(s,t){gr[jr++]=xi,gr[jr++]=Oc,Oc=s,xi=t}function kh(s,t,n){Ga[Ka++]=dl,Ga[Ka++]=ul,Ga[Ka++]=Gl,Gl=s;var i=dl;s=ul;var o=32-ws(i)-1;i&=~(1<<o),n+=1;var x=32-ws(t)+o;if(30<x){var v=o-o%5;x=(i&(1<<v)-1).toString(32),i>>=v,o-=v,dl=1<<32-ws(t)+o|n<<o|i,ul=x+s}else dl=1<<x|n<<o|i,ul=s}function Kd(s){s.return!==null&&(Nl(s,1),kh(s,1,0))}function Qd(s){for(;s===Oc;)Oc=gr[--jr],gr[jr]=null,xi=gr[--jr],gr[jr]=null;for(;s===Gl;)Gl=Ga[--Ka],Ga[Ka]=null,ul=Ga[--Ka],Ga[Ka]=null,dl=Ga[--Ka],Ga[Ka]=null}function Ch(s,t){Ga[Ka++]=dl,Ga[Ka++]=ul,Ga[Ka++]=Gl,dl=t.id,ul=t.overflow,Gl=s}var Wt=null,Nt=null,Us=!1,Kl=null,Qa=!1,Yd=Error(c(519));function Ql(s){var t=Error(c(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hi(Va(t,s)),Yd}function Th(s){var t=s.stateNode,n=s.type,i=s.memoizedProps;switch(t[_s]=s,t[ms]=i,n){case"dialog":zs("cancel",t),zs("close",t);break;case"iframe":case"object":case"embed":zs("load",t);break;case"video":case"audio":for(n=0;n<Li.length;n++)zs(Li[n],t);break;case"source":zs("error",t);break;case"img":case"image":case"link":zs("error",t),zs("load",t);break;case"details":zs("toggle",t);break;case"input":zs("invalid",t),Ix(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":zs("invalid",t);break;case"textarea":zs("invalid",t),Hx(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||Gp(t.textContent,n)?(i.popover!=null&&(zs("beforetoggle",t),zs("toggle",t)),i.onScroll!=null&&zs("scroll",t),i.onScrollEnd!=null&&zs("scrollend",t),i.onClick!=null&&(t.onclick=gl),t=!0):t=!1,t||Ql(s,!0)}function Eh(s){for(Wt=s.return;Wt;)switch(Wt.tag){case 5:case 31:case 13:Qa=!1;return;case 27:case 3:Qa=!0;return;default:Wt=Wt.return}}function vr(s){if(s!==Wt)return!1;if(!Us)return Eh(s),Us=!0,!1;var t=s.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=s.type,n=!(n!=="form"&&n!=="button")||xm(s.type,s.memoizedProps)),n=!n),n&&Nt&&Ql(s),Eh(s),t===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));Nt=sg(s)}else if(t===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));Nt=sg(s)}else t===27?(t=Nt,on(s.type)?(s=jm,jm=null,Nt=s):Nt=t):Nt=Wt?Ja(s.stateNode.nextSibling):null;return!0}function Dn(){Nt=Wt=null,Us=!1}function Jd(){var s=Kl;return s!==null&&(ba===null?ba=s:ba.push.apply(ba,s),Kl=null),s}function hi(s){Kl===null?Kl=[s]:Kl.push(s)}var Xd=_e(null),On=null,bl=null;function Yl(s,t,n){Te(Xd,t._currentValue),t._currentValue=n}function yl(s){s._currentValue=Xd.current,he(Xd)}function Zd(s,t,n){for(;s!==null;){var i=s.alternate;if((s.childLanes&t)!==t?(s.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),s===n)break;s=s.return}}function Wd(s,t,n,i){var o=s.child;for(o!==null&&(o.return=s);o!==null;){var x=o.dependencies;if(x!==null){var v=o.child;x=x.firstContext;e:for(;x!==null;){var k=x;x=o;for(var P=0;P<t.length;P++)if(k.context===t[P]){x.lanes|=n,k=x.alternate,k!==null&&(k.lanes|=n),Zd(x.return,n,s),i||(v=null);break e}x=k.next}}else if(o.tag===18){if(v=o.return,v===null)throw Error(c(341));v.lanes|=n,x=v.alternate,x!==null&&(x.lanes|=n),Zd(v,n,s),v=null}else v=o.child;if(v!==null)v.return=o;else for(v=o;v!==null;){if(v===s){v=null;break}if(o=v.sibling,o!==null){o.return=v.return,v=o;break}v=v.return}o=v}}function Nr(s,t,n,i){s=null;for(var o=t,x=!1;o!==null;){if(!x){if((o.flags&524288)!==0)x=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var v=o.alternate;if(v===null)throw Error(c(387));if(v=v.memoizedProps,v!==null){var k=o.type;Ca(o.pendingProps.value,v.value)||(s!==null?s.push(k):s=[k])}}else if(o===K.current){if(v=o.alternate,v===null)throw Error(c(387));v.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(s!==null?s.push(Ii):s=[Ii])}o=o.return}s!==null&&Wd(t,s,n,i),t.flags|=262144}function Lc(s){for(s=s.firstContext;s!==null;){if(!Ca(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ln(s){On=s,bl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ea(s){return Mh(On,s)}function Uc(s,t){return On===null&&Ln(s),Mh(s,t)}function Mh(s,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},bl===null){if(s===null)throw Error(c(308));bl=t,s.dependencies={lanes:0,firstContext:t},s.flags|=524288}else bl=bl.next=t;return n}var Oy=typeof AbortController<"u"?AbortController:function(){var s=[],t=this.signal={aborted:!1,addEventListener:function(n,i){s.push(i)}};this.abort=function(){t.aborted=!0,s.forEach(function(n){return n()})}},Ly=a.unstable_scheduleCallback,Uy=a.unstable_NormalPriority,$t={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function eu(){return{controller:new Oy,data:new Map,refCount:0}}function fi(s){s.refCount--,s.refCount===0&&Ly(Uy,function(){s.controller.abort()})}var pi=null,su=0,br=0,yr=null;function $y(s,t){if(pi===null){var n=pi=[];su=0,br=lm(),yr={status:"pending",value:void 0,then:function(i){n.push(i)}}}return su++,t.then(Ah,Ah),t}function Ah(){if(--su===0&&pi!==null){yr!==null&&(yr.status="fulfilled");var s=pi;pi=null,br=0,yr=null;for(var t=0;t<s.length;t++)(0,s[t])()}}function By(s,t){var n=[],i={status:"pending",value:null,reason:null,then:function(o){n.push(o)}};return s.then(function(){i.status="fulfilled",i.value=t;for(var o=0;o<n.length;o++)(0,n[o])(t)},function(o){for(i.status="rejected",i.reason=o,o=0;o<n.length;o++)(0,n[o])(void 0)}),i}var zh=D.S;D.S=function(s,t){pp=$s(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&$y(s,t),zh!==null&&zh(s,t)};var Un=_e(null);function tu(){var s=Un.current;return s!==null?s:xt.pooledCache}function $c(s,t){t===null?Te(Un,Un.current):Te(Un,t.pool)}function Rh(){var s=tu();return s===null?null:{parent:$t._currentValue,pool:s}}var wr=Error(c(460)),au=Error(c(474)),Bc=Error(c(542)),Pc={then:function(){}};function Dh(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Oh(s,t,n){switch(n=s[n],n===void 0?s.push(t):n!==t&&(t.then(gl,gl),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Uh(s),s;default:if(typeof t.status=="string")t.then(gl,gl);else{if(s=xt,s!==null&&100<s.shellSuspendCounter)throw Error(c(482));s=t,s.status="pending",s.then(function(i){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=i}},function(i){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Uh(s),s}throw Bn=t,wr}}function $n(s){try{var t=s._init;return t(s._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Bn=n,wr):n}}var Bn=null;function Lh(){if(Bn===null)throw Error(c(459));var s=Bn;return Bn=null,s}function Uh(s){if(s===wr||s===Bc)throw Error(c(483))}var _r=null,gi=0;function Ic(s){var t=gi;return gi+=1,_r===null&&(_r=[]),Oh(_r,s,t)}function ji(s,t){t=t.props.ref,s.ref=t!==void 0?t:null}function Fc(s,t){throw t.$$typeof===b?Error(c(525)):(s=Object.prototype.toString.call(t),Error(c(31,s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)))}function $h(s){function t(ee,V){if(s){var re=ee.deletions;re===null?(ee.deletions=[V],ee.flags|=16):re.push(V)}}function n(ee,V){if(!s)return null;for(;V!==null;)t(ee,V),V=V.sibling;return null}function i(ee){for(var V=new Map;ee!==null;)ee.key!==null?V.set(ee.key,ee):V.set(ee.index,ee),ee=ee.sibling;return V}function o(ee,V){return ee=vl(ee,V),ee.index=0,ee.sibling=null,ee}function x(ee,V,re){return ee.index=re,s?(re=ee.alternate,re!==null?(re=re.index,re<V?(ee.flags|=67108866,V):re):(ee.flags|=67108866,V)):(ee.flags|=1048576,V)}function v(ee){return s&&ee.alternate===null&&(ee.flags|=67108866),ee}function k(ee,V,re,be){return V===null||V.tag!==6?(V=Vd(re,ee.mode,be),V.return=ee,V):(V=o(V,re),V.return=ee,V)}function P(ee,V,re,be){var We=re.type;return We===A?ve(ee,V,re.props.children,be,re.key):V!==null&&(V.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===X&&$n(We)===V.type)?(V=o(V,re.props),ji(V,re),V.return=ee,V):(V=Dc(re.type,re.key,re.props,null,ee.mode,be),ji(V,re),V.return=ee,V)}function ie(ee,V,re,be){return V===null||V.tag!==4||V.stateNode.containerInfo!==re.containerInfo||V.stateNode.implementation!==re.implementation?(V=Gd(re,ee.mode,be),V.return=ee,V):(V=o(V,re.children||[]),V.return=ee,V)}function ve(ee,V,re,be,We){return V===null||V.tag!==7?(V=Rn(re,ee.mode,be,We),V.return=ee,V):(V=o(V,re),V.return=ee,V)}function we(ee,V,re){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Vd(""+V,ee.mode,re),V.return=ee,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case y:return re=Dc(V.type,V.key,V.props,null,ee.mode,re),ji(re,V),re.return=ee,re;case w:return V=Gd(V,ee.mode,re),V.return=ee,V;case X:return V=$n(V),we(ee,V,re)}if(pe(V)||je(V))return V=Rn(V,ee.mode,re,null),V.return=ee,V;if(typeof V.then=="function")return we(ee,Ic(V),re);if(V.$$typeof===E)return we(ee,Uc(ee,V),re);Fc(ee,V)}return null}function oe(ee,V,re,be){var We=V!==null?V.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return We!==null?null:k(ee,V,""+re,be);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case y:return re.key===We?P(ee,V,re,be):null;case w:return re.key===We?ie(ee,V,re,be):null;case X:return re=$n(re),oe(ee,V,re,be)}if(pe(re)||je(re))return We!==null?null:ve(ee,V,re,be,null);if(typeof re.then=="function")return oe(ee,V,Ic(re),be);if(re.$$typeof===E)return oe(ee,V,Uc(ee,re),be);Fc(ee,re)}return null}function xe(ee,V,re,be,We){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return ee=ee.get(re)||null,k(V,ee,""+be,We);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case y:return ee=ee.get(be.key===null?re:be.key)||null,P(V,ee,be,We);case w:return ee=ee.get(be.key===null?re:be.key)||null,ie(V,ee,be,We);case X:return be=$n(be),xe(ee,V,re,be,We)}if(pe(be)||je(be))return ee=ee.get(re)||null,ve(V,ee,be,We,null);if(typeof be.then=="function")return xe(ee,V,re,Ic(be),We);if(be.$$typeof===E)return xe(ee,V,re,Uc(V,be),We);Fc(V,be)}return null}function qe(ee,V,re,be){for(var We=null,Gs=null,Qe=V,ks=V=0,Os=null;Qe!==null&&ks<re.length;ks++){Qe.index>ks?(Os=Qe,Qe=null):Os=Qe.sibling;var Ks=oe(ee,Qe,re[ks],be);if(Ks===null){Qe===null&&(Qe=Os);break}s&&Qe&&Ks.alternate===null&&t(ee,Qe),V=x(Ks,V,ks),Gs===null?We=Ks:Gs.sibling=Ks,Gs=Ks,Qe=Os}if(ks===re.length)return n(ee,Qe),Us&&Nl(ee,ks),We;if(Qe===null){for(;ks<re.length;ks++)Qe=we(ee,re[ks],be),Qe!==null&&(V=x(Qe,V,ks),Gs===null?We=Qe:Gs.sibling=Qe,Gs=Qe);return Us&&Nl(ee,ks),We}for(Qe=i(Qe);ks<re.length;ks++)Os=xe(Qe,ee,ks,re[ks],be),Os!==null&&(s&&Os.alternate!==null&&Qe.delete(Os.key===null?ks:Os.key),V=x(Os,V,ks),Gs===null?We=Os:Gs.sibling=Os,Gs=Os);return s&&Qe.forEach(function(hn){return t(ee,hn)}),Us&&Nl(ee,ks),We}function ls(ee,V,re,be){if(re==null)throw Error(c(151));for(var We=null,Gs=null,Qe=V,ks=V=0,Os=null,Ks=re.next();Qe!==null&&!Ks.done;ks++,Ks=re.next()){Qe.index>ks?(Os=Qe,Qe=null):Os=Qe.sibling;var hn=oe(ee,Qe,Ks.value,be);if(hn===null){Qe===null&&(Qe=Os);break}s&&Qe&&hn.alternate===null&&t(ee,Qe),V=x(hn,V,ks),Gs===null?We=hn:Gs.sibling=hn,Gs=hn,Qe=Os}if(Ks.done)return n(ee,Qe),Us&&Nl(ee,ks),We;if(Qe===null){for(;!Ks.done;ks++,Ks=re.next())Ks=we(ee,Ks.value,be),Ks!==null&&(V=x(Ks,V,ks),Gs===null?We=Ks:Gs.sibling=Ks,Gs=Ks);return Us&&Nl(ee,ks),We}for(Qe=i(Qe);!Ks.done;ks++,Ks=re.next())Ks=xe(Qe,ee,ks,Ks.value,be),Ks!==null&&(s&&Ks.alternate!==null&&Qe.delete(Ks.key===null?ks:Ks.key),V=x(Ks,V,ks),Gs===null?We=Ks:Gs.sibling=Ks,Gs=Ks);return s&&Qe.forEach(function(J0){return t(ee,J0)}),Us&&Nl(ee,ks),We}function ut(ee,V,re,be){if(typeof re=="object"&&re!==null&&re.type===A&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case y:e:{for(var We=re.key;V!==null;){if(V.key===We){if(We=re.type,We===A){if(V.tag===7){n(ee,V.sibling),be=o(V,re.props.children),be.return=ee,ee=be;break e}}else if(V.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===X&&$n(We)===V.type){n(ee,V.sibling),be=o(V,re.props),ji(be,re),be.return=ee,ee=be;break e}n(ee,V);break}else t(ee,V);V=V.sibling}re.type===A?(be=Rn(re.props.children,ee.mode,be,re.key),be.return=ee,ee=be):(be=Dc(re.type,re.key,re.props,null,ee.mode,be),ji(be,re),be.return=ee,ee=be)}return v(ee);case w:e:{for(We=re.key;V!==null;){if(V.key===We)if(V.tag===4&&V.stateNode.containerInfo===re.containerInfo&&V.stateNode.implementation===re.implementation){n(ee,V.sibling),be=o(V,re.children||[]),be.return=ee,ee=be;break e}else{n(ee,V);break}else t(ee,V);V=V.sibling}be=Gd(re,ee.mode,be),be.return=ee,ee=be}return v(ee);case X:return re=$n(re),ut(ee,V,re,be)}if(pe(re))return qe(ee,V,re,be);if(je(re)){if(We=je(re),typeof We!="function")throw Error(c(150));return re=We.call(re),ls(ee,V,re,be)}if(typeof re.then=="function")return ut(ee,V,Ic(re),be);if(re.$$typeof===E)return ut(ee,V,Uc(ee,re),be);Fc(ee,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,V!==null&&V.tag===6?(n(ee,V.sibling),be=o(V,re),be.return=ee,ee=be):(n(ee,V),be=Vd(re,ee.mode,be),be.return=ee,ee=be),v(ee)):n(ee,V)}return function(ee,V,re,be){try{gi=0;var We=ut(ee,V,re,be);return _r=null,We}catch(Qe){if(Qe===wr||Qe===Bc)throw Qe;var Gs=Ta(29,Qe,null,ee.mode);return Gs.lanes=be,Gs.return=ee,Gs}finally{}}}var Pn=$h(!0),Bh=$h(!1),Jl=!1;function lu(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nu(s,t){s=s.updateQueue,t.updateQueue===s&&(t.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Xl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Zl(s,t,n){var i=s.updateQueue;if(i===null)return null;if(i=i.shared,(Ys&2)!==0){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,t=Rc(s),yh(s,null,n),t}return zc(s,i,t,n),Rc(s)}function vi(s,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=s.pendingLanes,n|=i,t.lanes=n,us(s,n)}}function ru(s,t){var n=s.updateQueue,i=s.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,x=null;if(n=n.firstBaseUpdate,n!==null){do{var v={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};x===null?o=x=v:x=x.next=v,n=n.next}while(n!==null);x===null?o=x=t:x=x.next=t}else o=x=t;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:x,shared:i.shared,callbacks:i.callbacks},s.updateQueue=n;return}s=n.lastBaseUpdate,s===null?n.firstBaseUpdate=t:s.next=t,n.lastBaseUpdate=t}var iu=!1;function Ni(){if(iu){var s=yr;if(s!==null)throw s}}function bi(s,t,n,i){iu=!1;var o=s.updateQueue;Jl=!1;var x=o.firstBaseUpdate,v=o.lastBaseUpdate,k=o.shared.pending;if(k!==null){o.shared.pending=null;var P=k,ie=P.next;P.next=null,v===null?x=ie:v.next=ie,v=P;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,k=ve.lastBaseUpdate,k!==v&&(k===null?ve.firstBaseUpdate=ie:k.next=ie,ve.lastBaseUpdate=P))}if(x!==null){var we=o.baseState;v=0,ve=ie=P=null,k=x;do{var oe=k.lane&-536870913,xe=oe!==k.lane;if(xe?(Ds&oe)===oe:(i&oe)===oe){oe!==0&&oe===br&&(iu=!0),ve!==null&&(ve=ve.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var qe=s,ls=k;oe=t;var ut=n;switch(ls.tag){case 1:if(qe=ls.payload,typeof qe=="function"){we=qe.call(ut,we,oe);break e}we=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=ls.payload,oe=typeof qe=="function"?qe.call(ut,we,oe):qe,oe==null)break e;we=j({},we,oe);break e;case 2:Jl=!0}}oe=k.callback,oe!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=o.callbacks,xe===null?o.callbacks=[oe]:xe.push(oe))}else xe={lane:oe,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ve===null?(ie=ve=xe,P=we):ve=ve.next=xe,v|=oe;if(k=k.next,k===null){if(k=o.shared.pending,k===null)break;xe=k,k=xe.next,xe.next=null,o.lastBaseUpdate=xe,o.shared.pending=null}}while(!0);ve===null&&(P=we),o.baseState=P,o.firstBaseUpdate=ie,o.lastBaseUpdate=ve,x===null&&(o.shared.lanes=0),an|=v,s.lanes=v,s.memoizedState=we}}function Ph(s,t){if(typeof s!="function")throw Error(c(191,s));s.call(t)}function Ih(s,t){var n=s.callbacks;if(n!==null)for(s.callbacks=null,s=0;s<n.length;s++)Ph(n[s],t)}var Sr=_e(null),Hc=_e(0);function Fh(s,t){s=Al,Te(Hc,s),Te(Sr,t),Al=s|t.baseLanes}function cu(){Te(Hc,Al),Te(Sr,Sr.current)}function ou(){Al=Hc.current,he(Sr),he(Hc)}var Ea=_e(null),Ya=null;function Wl(s){var t=s.alternate;Te(Dt,Dt.current&1),Te(Ea,s),Ya===null&&(t===null||Sr.current!==null||t.memoizedState!==null)&&(Ya=s)}function du(s){Te(Dt,Dt.current),Te(Ea,s),Ya===null&&(Ya=s)}function Hh(s){s.tag===22?(Te(Dt,Dt.current),Te(Ea,s),Ya===null&&(Ya=s)):en()}function en(){Te(Dt,Dt.current),Te(Ea,Ea.current)}function Ma(s){he(Ea),Ya===s&&(Ya=null),he(Dt)}var Dt=_e(0);function qc(s){for(var t=s;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||pm(n)||gm(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wl=0,Ss=null,ot=null,Bt=null,Vc=!1,kr=!1,In=!1,Gc=0,yi=0,Cr=null,Py=0;function Et(){throw Error(c(321))}function uu(s,t){if(t===null)return!1;for(var n=0;n<t.length&&n<s.length;n++)if(!Ca(s[n],t[n]))return!1;return!0}function mu(s,t,n,i,o,x){return wl=x,Ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=s===null||s.memoizedState===null?Cf:Cu,In=!1,x=n(i,o),In=!1,kr&&(x=Vh(t,n,i,o)),qh(s),x}function qh(s){D.H=Si;var t=ot!==null&&ot.next!==null;if(wl=0,Bt=ot=Ss=null,Vc=!1,yi=0,Cr=null,t)throw Error(c(300));s===null||Pt||(s=s.dependencies,s!==null&&Lc(s)&&(Pt=!0))}function Vh(s,t,n,i){Ss=s;var o=0;do{if(kr&&(Cr=null),yi=0,kr=!1,25<=o)throw Error(c(301));if(o+=1,Bt=ot=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}D.H=Tf,x=t(n,i)}while(kr);return x}function Iy(){var s=D.H,t=s.useState()[0];return t=typeof t.then=="function"?wi(t):t,s=s.useState()[0],(ot!==null?ot.memoizedState:null)!==s&&(Ss.flags|=1024),t}function xu(){var s=Gc!==0;return Gc=0,s}function hu(s,t,n){t.updateQueue=s.updateQueue,t.flags&=-2053,s.lanes&=~n}function fu(s){if(Vc){for(s=s.memoizedState;s!==null;){var t=s.queue;t!==null&&(t.pending=null),s=s.next}Vc=!1}wl=0,Bt=ot=Ss=null,kr=!1,yi=Gc=0,Cr=null}function ma(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?Ss.memoizedState=Bt=s:Bt=Bt.next=s,Bt}function Ot(){if(ot===null){var s=Ss.alternate;s=s!==null?s.memoizedState:null}else s=ot.next;var t=Bt===null?Ss.memoizedState:Bt.next;if(t!==null)Bt=t,ot=s;else{if(s===null)throw Ss.alternate===null?Error(c(467)):Error(c(310));ot=s,s={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Bt===null?Ss.memoizedState=Bt=s:Bt=Bt.next=s}return Bt}function Kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wi(s){var t=yi;return yi+=1,Cr===null&&(Cr=[]),s=Oh(Cr,s,t),t=Ss,(Bt===null?t.memoizedState:Bt.next)===null&&(t=t.alternate,D.H=t===null||t.memoizedState===null?Cf:Cu),s}function Qc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return wi(s);if(s.$$typeof===E)return ea(s)}throw Error(c(438,String(s)))}function pu(s){var t=null,n=Ss.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=Ss.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Kc(),Ss.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(s),i=0;i<s;i++)n[i]=me;return t.index++,n}function _l(s,t){return typeof t=="function"?t(s):t}function Yc(s){var t=Ot();return gu(t,ot,s)}function gu(s,t,n){var i=s.queue;if(i===null)throw Error(c(311));i.lastRenderedReducer=n;var o=s.baseQueue,x=i.pending;if(x!==null){if(o!==null){var v=o.next;o.next=x.next,x.next=v}t.baseQueue=o=x,i.pending=null}if(x=s.baseState,o===null)s.memoizedState=x;else{t=o.next;var k=v=null,P=null,ie=t,ve=!1;do{var we=ie.lane&-536870913;if(we!==ie.lane?(Ds&we)===we:(wl&we)===we){var oe=ie.revertLane;if(oe===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),we===br&&(ve=!0);else if((wl&oe)===oe){ie=ie.next,oe===br&&(ve=!0);continue}else we={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},P===null?(k=P=we,v=x):P=P.next=we,Ss.lanes|=oe,an|=oe;we=ie.action,In&&n(x,we),x=ie.hasEagerState?ie.eagerState:n(x,we)}else oe={lane:we,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},P===null?(k=P=oe,v=x):P=P.next=oe,Ss.lanes|=we,an|=we;ie=ie.next}while(ie!==null&&ie!==t);if(P===null?v=x:P.next=k,!Ca(x,s.memoizedState)&&(Pt=!0,ve&&(n=yr,n!==null)))throw n;s.memoizedState=x,s.baseState=v,s.baseQueue=P,i.lastRenderedState=x}return o===null&&(i.lanes=0),[s.memoizedState,i.dispatch]}function ju(s){var t=Ot(),n=t.queue;if(n===null)throw Error(c(311));n.lastRenderedReducer=s;var i=n.dispatch,o=n.pending,x=t.memoizedState;if(o!==null){n.pending=null;var v=o=o.next;do x=s(x,v.action),v=v.next;while(v!==o);Ca(x,t.memoizedState)||(Pt=!0),t.memoizedState=x,t.baseQueue===null&&(t.baseState=x),n.lastRenderedState=x}return[x,i]}function Gh(s,t,n){var i=Ss,o=Ot(),x=Us;if(x){if(n===void 0)throw Error(c(407));n=n()}else n=t();var v=!Ca((ot||o).memoizedState,n);if(v&&(o.memoizedState=n,Pt=!0),o=o.queue,bu(Yh.bind(null,i,o,s),[s]),o.getSnapshot!==t||v||Bt!==null&&Bt.memoizedState.tag&1){if(i.flags|=2048,Tr(9,{destroy:void 0},Qh.bind(null,i,o,n,t),null),xt===null)throw Error(c(349));x||(wl&127)!==0||Kh(i,t,n)}return n}function Kh(s,t,n){s.flags|=16384,s={getSnapshot:t,value:n},t=Ss.updateQueue,t===null?(t=Kc(),Ss.updateQueue=t,t.stores=[s]):(n=t.stores,n===null?t.stores=[s]:n.push(s))}function Qh(s,t,n,i){t.value=n,t.getSnapshot=i,Jh(t)&&Xh(s)}function Yh(s,t,n){return n(function(){Jh(t)&&Xh(s)})}function Jh(s){var t=s.getSnapshot;s=s.value;try{var n=t();return!Ca(s,n)}catch{return!0}}function Xh(s){var t=zn(s,2);t!==null&&ya(t,s,2)}function vu(s){var t=ma();if(typeof s=="function"){var n=s;if(s=n(),In){is(!0);try{n()}finally{is(!1)}}}return t.memoizedState=t.baseState=s,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:s},t}function Zh(s,t,n,i){return s.baseState=n,gu(s,ot,typeof i=="function"?i:_l)}function Fy(s,t,n,i,o){if(Zc(s))throw Error(c(485));if(s=t.action,s!==null){var x={payload:o,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){x.listeners.push(v)}};D.T!==null?n(!0):x.isTransition=!1,i(x),n=t.pending,n===null?(x.next=t.pending=x,Wh(t,x)):(x.next=n.next,t.pending=n.next=x)}}function Wh(s,t){var n=t.action,i=t.payload,o=s.state;if(t.isTransition){var x=D.T,v={};D.T=v;try{var k=n(o,i),P=D.S;P!==null&&P(v,k),ef(s,t,k)}catch(ie){Nu(s,t,ie)}finally{x!==null&&v.types!==null&&(x.types=v.types),D.T=x}}else try{x=n(o,i),ef(s,t,x)}catch(ie){Nu(s,t,ie)}}function ef(s,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){sf(s,t,i)},function(i){return Nu(s,t,i)}):sf(s,t,n)}function sf(s,t,n){t.status="fulfilled",t.value=n,tf(t),s.state=n,t=s.pending,t!==null&&(n=t.next,n===t?s.pending=null:(n=n.next,t.next=n,Wh(s,n)))}function Nu(s,t,n){var i=s.pending;if(s.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,tf(t),t=t.next;while(t!==i)}s.action=null}function tf(s){s=s.listeners;for(var t=0;t<s.length;t++)(0,s[t])()}function af(s,t){return t}function lf(s,t){if(Us){var n=xt.formState;if(n!==null){e:{var i=Ss;if(Us){if(Nt){s:{for(var o=Nt,x=Qa;o.nodeType!==8;){if(!x){o=null;break s}if(o=Ja(o.nextSibling),o===null){o=null;break s}}x=o.data,o=x==="F!"||x==="F"?o:null}if(o){Nt=Ja(o.nextSibling),i=o.data==="F!";break e}}Ql(i)}i=!1}i&&(t=n[0])}}return n=ma(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:af,lastRenderedState:t},n.queue=i,n=_f.bind(null,Ss,i),i.dispatch=n,i=vu(!1),x=ku.bind(null,Ss,!1,i.queue),i=ma(),o={state:t,dispatch:null,action:s,pending:null},i.queue=o,n=Fy.bind(null,Ss,o,x,n),o.dispatch=n,i.memoizedState=s,[t,n,!1]}function nf(s){var t=Ot();return rf(t,ot,s)}function rf(s,t,n){if(t=gu(s,t,af)[0],s=Yc(_l)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=wi(t)}catch(v){throw v===wr?Bc:v}else i=t;t=Ot();var o=t.queue,x=o.dispatch;return n!==t.memoizedState&&(Ss.flags|=2048,Tr(9,{destroy:void 0},Hy.bind(null,o,n),null)),[i,x,s]}function Hy(s,t){s.action=t}function cf(s){var t=Ot(),n=ot;if(n!==null)return rf(t,n,s);Ot(),t=t.memoizedState,n=Ot();var i=n.queue.dispatch;return n.memoizedState=s,[t,i,!1]}function Tr(s,t,n,i){return s={tag:s,create:n,deps:i,inst:t,next:null},t=Ss.updateQueue,t===null&&(t=Kc(),Ss.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=s.next=s:(i=n.next,n.next=s,s.next=i,t.lastEffect=s),s}function of(){return Ot().memoizedState}function Jc(s,t,n,i){var o=ma();Ss.flags|=s,o.memoizedState=Tr(1|t,{destroy:void 0},n,i===void 0?null:i)}function Xc(s,t,n,i){var o=Ot();i=i===void 0?null:i;var x=o.memoizedState.inst;ot!==null&&i!==null&&uu(i,ot.memoizedState.deps)?o.memoizedState=Tr(t,x,n,i):(Ss.flags|=s,o.memoizedState=Tr(1|t,x,n,i))}function df(s,t){Jc(8390656,8,s,t)}function bu(s,t){Xc(2048,8,s,t)}function qy(s){Ss.flags|=4;var t=Ss.updateQueue;if(t===null)t=Kc(),Ss.updateQueue=t,t.events=[s];else{var n=t.events;n===null?t.events=[s]:n.push(s)}}function uf(s){var t=Ot().memoizedState;return qy({ref:t,nextImpl:s}),function(){if((Ys&2)!==0)throw Error(c(440));return t.impl.apply(void 0,arguments)}}function mf(s,t){return Xc(4,2,s,t)}function xf(s,t){return Xc(4,4,s,t)}function hf(s,t){if(typeof t=="function"){s=s();var n=t(s);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return s=s(),t.current=s,function(){t.current=null}}function ff(s,t,n){n=n!=null?n.concat([s]):null,Xc(4,4,hf.bind(null,t,s),n)}function yu(){}function pf(s,t){var n=Ot();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&uu(t,i[1])?i[0]:(n.memoizedState=[s,t],s)}function gf(s,t){var n=Ot();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&uu(t,i[1]))return i[0];if(i=s(),In){is(!0);try{s()}finally{is(!1)}}return n.memoizedState=[i,t],i}function wu(s,t,n){return n===void 0||(wl&1073741824)!==0&&(Ds&261930)===0?s.memoizedState=t:(s.memoizedState=n,s=jp(),Ss.lanes|=s,an|=s,n)}function jf(s,t,n,i){return Ca(n,t)?n:Sr.current!==null?(s=wu(s,n,i),Ca(s,t)||(Pt=!0),s):(wl&42)===0||(wl&1073741824)!==0&&(Ds&261930)===0?(Pt=!0,s.memoizedState=n):(s=jp(),Ss.lanes|=s,an|=s,t)}function vf(s,t,n,i,o){var x=Q.p;Q.p=x!==0&&8>x?x:8;var v=D.T,k={};D.T=k,ku(s,!1,t,n);try{var P=o(),ie=D.S;if(ie!==null&&ie(k,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ve=By(P,i);_i(s,t,ve,Ra(s))}else _i(s,t,i,Ra(s))}catch(we){_i(s,t,{then:function(){},status:"rejected",reason:we},Ra())}finally{Q.p=x,v!==null&&k.types!==null&&(v.types=k.types),D.T=v}}function Vy(){}function _u(s,t,n,i){if(s.tag!==5)throw Error(c(476));var o=Nf(s).queue;vf(s,o,t,B,n===null?Vy:function(){return bf(s),n(i)})}function Nf(s){var t=s.memoizedState;if(t!==null)return t;t={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:B},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:n},next:null},s.memoizedState=t,s=s.alternate,s!==null&&(s.memoizedState=t),t}function bf(s){var t=Nf(s);t.next===null&&(t=s.alternate.memoizedState),_i(s,t.next.queue,{},Ra())}function Su(){return ea(Ii)}function yf(){return Ot().memoizedState}function wf(){return Ot().memoizedState}function Gy(s){for(var t=s.return;t!==null;){switch(t.tag){case 24:case 3:var n=Ra();s=Xl(n);var i=Zl(t,s,n);i!==null&&(ya(i,t,n),vi(i,t,n)),t={cache:eu()},s.payload=t;return}t=t.return}}function Ky(s,t,n){var i=Ra();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Zc(s)?Sf(t,n):(n=Hd(s,t,n,i),n!==null&&(ya(n,s,i),kf(n,t,i)))}function _f(s,t,n){var i=Ra();_i(s,t,n,i)}function _i(s,t,n,i){var o={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zc(s))Sf(t,o);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=t.lastRenderedReducer,x!==null))try{var v=t.lastRenderedState,k=x(v,n);if(o.hasEagerState=!0,o.eagerState=k,Ca(k,v))return zc(s,t,o,0),xt===null&&Ac(),!1}catch{}finally{}if(n=Hd(s,t,o,i),n!==null)return ya(n,s,i),kf(n,t,i),!0}return!1}function ku(s,t,n,i){if(i={lane:2,revertLane:lm(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Zc(s)){if(t)throw Error(c(479))}else t=Hd(s,n,i,2),t!==null&&ya(t,s,2)}function Zc(s){var t=s.alternate;return s===Ss||t!==null&&t===Ss}function Sf(s,t){kr=Vc=!0;var n=s.pending;n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t}function kf(s,t,n){if((n&4194048)!==0){var i=t.lanes;i&=s.pendingLanes,n|=i,t.lanes=n,us(s,n)}}var Si={readContext:ea,use:Qc,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useLayoutEffect:Et,useInsertionEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useSyncExternalStore:Et,useId:Et,useHostTransitionStatus:Et,useFormState:Et,useActionState:Et,useOptimistic:Et,useMemoCache:Et,useCacheRefresh:Et};Si.useEffectEvent=Et;var Cf={readContext:ea,use:Qc,useCallback:function(s,t){return ma().memoizedState=[s,t===void 0?null:t],s},useContext:ea,useEffect:df,useImperativeHandle:function(s,t,n){n=n!=null?n.concat([s]):null,Jc(4194308,4,hf.bind(null,t,s),n)},useLayoutEffect:function(s,t){return Jc(4194308,4,s,t)},useInsertionEffect:function(s,t){Jc(4,2,s,t)},useMemo:function(s,t){var n=ma();t=t===void 0?null:t;var i=s();if(In){is(!0);try{s()}finally{is(!1)}}return n.memoizedState=[i,t],i},useReducer:function(s,t,n){var i=ma();if(n!==void 0){var o=n(t);if(In){is(!0);try{n(t)}finally{is(!1)}}}else o=t;return i.memoizedState=i.baseState=o,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},i.queue=s,s=s.dispatch=Ky.bind(null,Ss,s),[i.memoizedState,s]},useRef:function(s){var t=ma();return s={current:s},t.memoizedState=s},useState:function(s){s=vu(s);var t=s.queue,n=_f.bind(null,Ss,t);return t.dispatch=n,[s.memoizedState,n]},useDebugValue:yu,useDeferredValue:function(s,t){var n=ma();return wu(n,s,t)},useTransition:function(){var s=vu(!1);return s=vf.bind(null,Ss,s.queue,!0,!1),ma().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,t,n){var i=Ss,o=ma();if(Us){if(n===void 0)throw Error(c(407));n=n()}else{if(n=t(),xt===null)throw Error(c(349));(Ds&127)!==0||Kh(i,t,n)}o.memoizedState=n;var x={value:n,getSnapshot:t};return o.queue=x,df(Yh.bind(null,i,x,s),[s]),i.flags|=2048,Tr(9,{destroy:void 0},Qh.bind(null,i,x,n,t),null),n},useId:function(){var s=ma(),t=xt.identifierPrefix;if(Us){var n=ul,i=dl;n=(i&~(1<<32-ws(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Gc++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Py++,t="_"+t+"r_"+n.toString(32)+"_";return s.memoizedState=t},useHostTransitionStatus:Su,useFormState:lf,useActionState:lf,useOptimistic:function(s){var t=ma();t.memoizedState=t.baseState=s;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ku.bind(null,Ss,!0,n),n.dispatch=t,[s,t]},useMemoCache:pu,useCacheRefresh:function(){return ma().memoizedState=Gy.bind(null,Ss)},useEffectEvent:function(s){var t=ma(),n={impl:s};return t.memoizedState=n,function(){if((Ys&2)!==0)throw Error(c(440));return n.impl.apply(void 0,arguments)}}},Cu={readContext:ea,use:Qc,useCallback:pf,useContext:ea,useEffect:bu,useImperativeHandle:ff,useInsertionEffect:mf,useLayoutEffect:xf,useMemo:gf,useReducer:Yc,useRef:of,useState:function(){return Yc(_l)},useDebugValue:yu,useDeferredValue:function(s,t){var n=Ot();return jf(n,ot.memoizedState,s,t)},useTransition:function(){var s=Yc(_l)[0],t=Ot().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Gh,useId:yf,useHostTransitionStatus:Su,useFormState:nf,useActionState:nf,useOptimistic:function(s,t){var n=Ot();return Zh(n,ot,s,t)},useMemoCache:pu,useCacheRefresh:wf};Cu.useEffectEvent=uf;var Tf={readContext:ea,use:Qc,useCallback:pf,useContext:ea,useEffect:bu,useImperativeHandle:ff,useInsertionEffect:mf,useLayoutEffect:xf,useMemo:gf,useReducer:ju,useRef:of,useState:function(){return ju(_l)},useDebugValue:yu,useDeferredValue:function(s,t){var n=Ot();return ot===null?wu(n,s,t):jf(n,ot.memoizedState,s,t)},useTransition:function(){var s=ju(_l)[0],t=Ot().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Gh,useId:yf,useHostTransitionStatus:Su,useFormState:cf,useActionState:cf,useOptimistic:function(s,t){var n=Ot();return ot!==null?Zh(n,ot,s,t):(n.baseState=s,[s,n.queue.dispatch])},useMemoCache:pu,useCacheRefresh:wf};Tf.useEffectEvent=uf;function Tu(s,t,n,i){t=s.memoizedState,n=n(i,t),n=n==null?t:j({},t,n),s.memoizedState=n,s.lanes===0&&(s.updateQueue.baseState=n)}var Eu={enqueueSetState:function(s,t,n){s=s._reactInternals;var i=Ra(),o=Xl(i);o.payload=t,n!=null&&(o.callback=n),t=Zl(s,o,i),t!==null&&(ya(t,s,i),vi(t,s,i))},enqueueReplaceState:function(s,t,n){s=s._reactInternals;var i=Ra(),o=Xl(i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Zl(s,o,i),t!==null&&(ya(t,s,i),vi(t,s,i))},enqueueForceUpdate:function(s,t){s=s._reactInternals;var n=Ra(),i=Xl(n);i.tag=2,t!=null&&(i.callback=t),t=Zl(s,i,n),t!==null&&(ya(t,s,n),vi(t,s,n))}};function Ef(s,t,n,i,o,x,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(i,x,v):t.prototype&&t.prototype.isPureReactComponent?!ui(n,i)||!ui(o,x):!0}function Mf(s,t,n,i){s=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==s&&Eu.enqueueReplaceState(t,t.state,null)}function Fn(s,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(s=s.defaultProps){n===t&&(n=j({},n));for(var o in s)n[o]===void 0&&(n[o]=s[o])}return n}function Af(s){Mc(s)}function zf(s){console.error(s)}function Rf(s){Mc(s)}function Wc(s,t){try{var n=s.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Df(s,t,n){try{var i=s.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function Mu(s,t,n){return n=Xl(n),n.tag=3,n.payload={element:null},n.callback=function(){Wc(s,t)},n}function Of(s){return s=Xl(s),s.tag=3,s}function Lf(s,t,n,i){var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var x=i.value;s.payload=function(){return o(x)},s.callback=function(){Df(t,n,i)}}var v=n.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){Df(t,n,i),typeof o!="function"&&(ln===null?ln=new Set([this]):ln.add(this));var k=i.stack;this.componentDidCatch(i.value,{componentStack:k!==null?k:""})})}function Qy(s,t,n,i,o){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Nr(t,n,o,!0),n=Ea.current,n!==null){switch(n.tag){case 31:case 13:return Ya===null?mo():n.alternate===null&&Mt===0&&(Mt=3),n.flags&=-257,n.flags|=65536,n.lanes=o,i===Pc?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),sm(s,i,o)),!1;case 22:return n.flags|=65536,i===Pc?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),sm(s,i,o)),!1}throw Error(c(435,n.tag))}return sm(s,i,o),mo(),!1}if(Us)return t=Ea.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,i!==Yd&&(s=Error(c(422),{cause:i}),hi(Va(s,n)))):(i!==Yd&&(t=Error(c(423),{cause:i}),hi(Va(t,n))),s=s.current.alternate,s.flags|=65536,o&=-o,s.lanes|=o,i=Va(i,n),o=Mu(s.stateNode,i,o),ru(s,o),Mt!==4&&(Mt=2)),!1;var x=Error(c(520),{cause:i});if(x=Va(x,n),Ri===null?Ri=[x]:Ri.push(x),Mt!==4&&(Mt=2),t===null)return!0;i=Va(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,s=o&-o,n.lanes|=s,s=Mu(n.stateNode,i,s),ru(n,s),!1;case 1:if(t=n.type,x=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ln===null||!ln.has(x))))return n.flags|=65536,o&=-o,n.lanes|=o,o=Of(o),Lf(o,s,n,i),ru(n,o),!1}n=n.return}while(n!==null);return!1}var Au=Error(c(461)),Pt=!1;function sa(s,t,n,i){t.child=s===null?Bh(t,null,n,i):Pn(t,s.child,n,i)}function Uf(s,t,n,i,o){n=n.render;var x=t.ref;if("ref"in i){var v={};for(var k in i)k!=="ref"&&(v[k]=i[k])}else v=i;return Ln(t),i=mu(s,t,n,v,x,o),k=xu(),s!==null&&!Pt?(hu(s,t,o),Sl(s,t,o)):(Us&&k&&Kd(t),t.flags|=1,sa(s,t,i,o),t.child)}function $f(s,t,n,i,o){if(s===null){var x=n.type;return typeof x=="function"&&!qd(x)&&x.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=x,Bf(s,t,x,i,o)):(s=Dc(n.type,null,i,t,t.mode,o),s.ref=t.ref,s.return=t,t.child=s)}if(x=s.child,!Bu(s,o)){var v=x.memoizedProps;if(n=n.compare,n=n!==null?n:ui,n(v,i)&&s.ref===t.ref)return Sl(s,t,o)}return t.flags|=1,s=vl(x,i),s.ref=t.ref,s.return=t,t.child=s}function Bf(s,t,n,i,o){if(s!==null){var x=s.memoizedProps;if(ui(x,i)&&s.ref===t.ref)if(Pt=!1,t.pendingProps=i=x,Bu(s,o))(s.flags&131072)!==0&&(Pt=!0);else return t.lanes=s.lanes,Sl(s,t,o)}return zu(s,t,n,i,o)}function Pf(s,t,n,i){var o=i.children,x=s!==null?s.memoizedState:null;if(s===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(x=x!==null?x.baseLanes|n:n,s!==null){for(i=t.child=s.child,o=0;i!==null;)o=o|i.lanes|i.childLanes,i=i.sibling;i=o&~x}else i=0,t.child=null;return If(s,t,x,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},s!==null&&$c(t,x!==null?x.cachePool:null),x!==null?Fh(t,x):cu(),Hh(t);else return i=t.lanes=536870912,If(s,t,x!==null?x.baseLanes|n:n,n,i)}else x!==null?($c(t,x.cachePool),Fh(t,x),en(),t.memoizedState=null):(s!==null&&$c(t,null),cu(),en());return sa(s,t,o,n),t.child}function ki(s,t){return s!==null&&s.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function If(s,t,n,i,o){var x=tu();return x=x===null?null:{parent:$t._currentValue,pool:x},t.memoizedState={baseLanes:n,cachePool:x},s!==null&&$c(t,null),cu(),Hh(t),s!==null&&Nr(s,t,i,!0),t.childLanes=o,null}function eo(s,t){return t=to({mode:t.mode,children:t.children},s.mode),t.ref=s.ref,s.child=t,t.return=s,t}function Ff(s,t,n){return Pn(t,s.child,null,n),s=eo(t,t.pendingProps),s.flags|=2,Ma(t),t.memoizedState=null,s}function Yy(s,t,n){var i=t.pendingProps,o=(t.flags&128)!==0;if(t.flags&=-129,s===null){if(Us){if(i.mode==="hidden")return s=eo(t,i),t.lanes=536870912,ki(null,s);if(du(t),(s=Nt)?(s=eg(s,Qa),s=s!==null&&s.data==="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Gl!==null?{id:dl,overflow:ul}:null,retryLane:536870912,hydrationErrors:null},n=_h(s),n.return=t,t.child=n,Wt=t,Nt=null)):s=null,s===null)throw Ql(t);return t.lanes=536870912,null}return eo(t,i)}var x=s.memoizedState;if(x!==null){var v=x.dehydrated;if(du(t),o)if(t.flags&256)t.flags&=-257,t=Ff(s,t,n);else if(t.memoizedState!==null)t.child=s.child,t.flags|=128,t=null;else throw Error(c(558));else if(Pt||Nr(s,t,n,!1),o=(n&s.childLanes)!==0,Pt||o){if(i=xt,i!==null&&(v=cs(i,n),v!==0&&v!==x.retryLane))throw x.retryLane=v,zn(s,v),ya(i,s,v),Au;mo(),t=Ff(s,t,n)}else s=x.treeContext,Nt=Ja(v.nextSibling),Wt=t,Us=!0,Kl=null,Qa=!1,s!==null&&Ch(t,s),t=eo(t,i),t.flags|=4096;return t}return s=vl(s.child,{mode:i.mode,children:i.children}),s.ref=t.ref,t.child=s,s.return=t,s}function so(s,t){var n=t.ref;if(n===null)s!==null&&s.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(c(284));(s===null||s.ref!==n)&&(t.flags|=4194816)}}function zu(s,t,n,i,o){return Ln(t),n=mu(s,t,n,i,void 0,o),i=xu(),s!==null&&!Pt?(hu(s,t,o),Sl(s,t,o)):(Us&&i&&Kd(t),t.flags|=1,sa(s,t,n,o),t.child)}function Hf(s,t,n,i,o,x){return Ln(t),t.updateQueue=null,n=Vh(t,i,n,o),qh(s),i=xu(),s!==null&&!Pt?(hu(s,t,x),Sl(s,t,x)):(Us&&i&&Kd(t),t.flags|=1,sa(s,t,n,x),t.child)}function qf(s,t,n,i,o){if(Ln(t),t.stateNode===null){var x=pr,v=n.contextType;typeof v=="object"&&v!==null&&(x=ea(v)),x=new n(i,x),t.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Eu,t.stateNode=x,x._reactInternals=t,x=t.stateNode,x.props=i,x.state=t.memoizedState,x.refs={},lu(t),v=n.contextType,x.context=typeof v=="object"&&v!==null?ea(v):pr,x.state=t.memoizedState,v=n.getDerivedStateFromProps,typeof v=="function"&&(Tu(t,n,v,i),x.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(v=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),v!==x.state&&Eu.enqueueReplaceState(x,x.state,null),bi(t,i,x,o),Ni(),x.state=t.memoizedState),typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(s===null){x=t.stateNode;var k=t.memoizedProps,P=Fn(n,k);x.props=P;var ie=x.context,ve=n.contextType;v=pr,typeof ve=="object"&&ve!==null&&(v=ea(ve));var we=n.getDerivedStateFromProps;ve=typeof we=="function"||typeof x.getSnapshotBeforeUpdate=="function",k=t.pendingProps!==k,ve||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(k||ie!==v)&&Mf(t,x,i,v),Jl=!1;var oe=t.memoizedState;x.state=oe,bi(t,i,x,o),Ni(),ie=t.memoizedState,k||oe!==ie||Jl?(typeof we=="function"&&(Tu(t,n,we,i),ie=t.memoizedState),(P=Jl||Ef(t,n,P,i,oe,ie,v))?(ve||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=ie),x.props=i,x.state=ie,x.context=v,i=P):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{x=t.stateNode,nu(s,t),v=t.memoizedProps,ve=Fn(n,v),x.props=ve,we=t.pendingProps,oe=x.context,ie=n.contextType,P=pr,typeof ie=="object"&&ie!==null&&(P=ea(ie)),k=n.getDerivedStateFromProps,(ie=typeof k=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(v!==we||oe!==P)&&Mf(t,x,i,P),Jl=!1,oe=t.memoizedState,x.state=oe,bi(t,i,x,o),Ni();var xe=t.memoizedState;v!==we||oe!==xe||Jl||s!==null&&s.dependencies!==null&&Lc(s.dependencies)?(typeof k=="function"&&(Tu(t,n,k,i),xe=t.memoizedState),(ve=Jl||Ef(t,n,ve,i,oe,xe,P)||s!==null&&s.dependencies!==null&&Lc(s.dependencies))?(ie||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(i,xe,P),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(i,xe,P)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=xe),x.props=i,x.state=xe,x.context=P,i=ve):(typeof x.componentDidUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=1024),i=!1)}return x=i,so(s,t),i=(t.flags&128)!==0,x||i?(x=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:x.render(),t.flags|=1,s!==null&&i?(t.child=Pn(t,s.child,null,o),t.child=Pn(t,null,n,o)):sa(s,t,n,o),t.memoizedState=x.state,s=t.child):s=Sl(s,t,o),s}function Vf(s,t,n,i){return Dn(),t.flags|=256,sa(s,t,n,i),t.child}var Ru={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Du(s){return{baseLanes:s,cachePool:Rh()}}function Ou(s,t,n){return s=s!==null?s.childLanes&~n:0,t&&(s|=za),s}function Gf(s,t,n){var i=t.pendingProps,o=!1,x=(t.flags&128)!==0,v;if((v=x)||(v=s!==null&&s.memoizedState===null?!1:(Dt.current&2)!==0),v&&(o=!0,t.flags&=-129),v=(t.flags&32)!==0,t.flags&=-33,s===null){if(Us){if(o?Wl(t):en(),(s=Nt)?(s=eg(s,Qa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Gl!==null?{id:dl,overflow:ul}:null,retryLane:536870912,hydrationErrors:null},n=_h(s),n.return=t,t.child=n,Wt=t,Nt=null)):s=null,s===null)throw Ql(t);return gm(s)?t.lanes=32:t.lanes=536870912,null}var k=i.children;return i=i.fallback,o?(en(),o=t.mode,k=to({mode:"hidden",children:k},o),i=Rn(i,o,n,null),k.return=t,i.return=t,k.sibling=i,t.child=k,i=t.child,i.memoizedState=Du(n),i.childLanes=Ou(s,v,n),t.memoizedState=Ru,ki(null,i)):(Wl(t),Lu(t,k))}var P=s.memoizedState;if(P!==null&&(k=P.dehydrated,k!==null)){if(x)t.flags&256?(Wl(t),t.flags&=-257,t=Uu(s,t,n)):t.memoizedState!==null?(en(),t.child=s.child,t.flags|=128,t=null):(en(),k=i.fallback,o=t.mode,i=to({mode:"visible",children:i.children},o),k=Rn(k,o,n,null),k.flags|=2,i.return=t,k.return=t,i.sibling=k,t.child=i,Pn(t,s.child,null,n),i=t.child,i.memoizedState=Du(n),i.childLanes=Ou(s,v,n),t.memoizedState=Ru,t=ki(null,i));else if(Wl(t),gm(k)){if(v=k.nextSibling&&k.nextSibling.dataset,v)var ie=v.dgst;v=ie,i=Error(c(419)),i.stack="",i.digest=v,hi({value:i,source:null,stack:null}),t=Uu(s,t,n)}else if(Pt||Nr(s,t,n,!1),v=(n&s.childLanes)!==0,Pt||v){if(v=xt,v!==null&&(i=cs(v,n),i!==0&&i!==P.retryLane))throw P.retryLane=i,zn(s,i),ya(v,s,i),Au;pm(k)||mo(),t=Uu(s,t,n)}else pm(k)?(t.flags|=192,t.child=s.child,t=null):(s=P.treeContext,Nt=Ja(k.nextSibling),Wt=t,Us=!0,Kl=null,Qa=!1,s!==null&&Ch(t,s),t=Lu(t,i.children),t.flags|=4096);return t}return o?(en(),k=i.fallback,o=t.mode,P=s.child,ie=P.sibling,i=vl(P,{mode:"hidden",children:i.children}),i.subtreeFlags=P.subtreeFlags&65011712,ie!==null?k=vl(ie,k):(k=Rn(k,o,n,null),k.flags|=2),k.return=t,i.return=t,i.sibling=k,t.child=i,ki(null,i),i=t.child,k=s.child.memoizedState,k===null?k=Du(n):(o=k.cachePool,o!==null?(P=$t._currentValue,o=o.parent!==P?{parent:P,pool:P}:o):o=Rh(),k={baseLanes:k.baseLanes|n,cachePool:o}),i.memoizedState=k,i.childLanes=Ou(s,v,n),t.memoizedState=Ru,ki(s.child,i)):(Wl(t),n=s.child,s=n.sibling,n=vl(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,s!==null&&(v=t.deletions,v===null?(t.deletions=[s],t.flags|=16):v.push(s)),t.child=n,t.memoizedState=null,n)}function Lu(s,t){return t=to({mode:"visible",children:t},s.mode),t.return=s,s.child=t}function to(s,t){return s=Ta(22,s,null,t),s.lanes=0,s}function Uu(s,t,n){return Pn(t,s.child,null,n),s=Lu(t,t.pendingProps.children),s.flags|=2,t.memoizedState=null,s}function Kf(s,t,n){s.lanes|=t;var i=s.alternate;i!==null&&(i.lanes|=t),Zd(s.return,t,n)}function $u(s,t,n,i,o,x){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o,treeForkCount:x}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=i,v.tail=n,v.tailMode=o,v.treeForkCount=x)}function Qf(s,t,n){var i=t.pendingProps,o=i.revealOrder,x=i.tail;i=i.children;var v=Dt.current,k=(v&2)!==0;if(k?(v=v&1|2,t.flags|=128):v&=1,Te(Dt,v),sa(s,t,i,n),i=Us?xi:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=t.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Kf(s,n,t);else if(s.tag===19)Kf(s,n,t);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(o){case"forwards":for(n=t.child,o=null;n!==null;)s=n.alternate,s!==null&&qc(s)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),$u(t,!1,o,n,x,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(s=o.alternate,s!==null&&qc(s)===null){t.child=o;break}s=o.sibling,o.sibling=n,n=o,o=s}$u(t,!0,n,null,x,i);break;case"together":$u(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function Sl(s,t,n){if(s!==null&&(t.dependencies=s.dependencies),an|=t.lanes,(n&t.childLanes)===0)if(s!==null){if(Nr(s,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(s!==null&&t.child!==s.child)throw Error(c(153));if(t.child!==null){for(s=t.child,n=vl(s,s.pendingProps),t.child=n,n.return=t;s.sibling!==null;)s=s.sibling,n=n.sibling=vl(s,s.pendingProps),n.return=t;n.sibling=null}return t.child}function Bu(s,t){return(s.lanes&t)!==0?!0:(s=s.dependencies,!!(s!==null&&Lc(s)))}function Jy(s,t,n){switch(t.tag){case 3:De(t,t.stateNode.containerInfo),Yl(t,$t,s.memoizedState.cache),Dn();break;case 27:case 5:Le(t);break;case 4:De(t,t.stateNode.containerInfo);break;case 10:Yl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,du(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Wl(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Gf(s,t,n):(Wl(t),s=Sl(s,t,n),s!==null?s.sibling:null);Wl(t);break;case 19:var o=(s.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Nr(s,t,n,!1),i=(n&t.childLanes)!==0),o){if(i)return Qf(s,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Te(Dt,Dt.current),i)break;return null;case 22:return t.lanes=0,Pf(s,t,n,t.pendingProps);case 24:Yl(t,$t,s.memoizedState.cache)}return Sl(s,t,n)}function Yf(s,t,n){if(s!==null)if(s.memoizedProps!==t.pendingProps)Pt=!0;else{if(!Bu(s,n)&&(t.flags&128)===0)return Pt=!1,Jy(s,t,n);Pt=(s.flags&131072)!==0}else Pt=!1,Us&&(t.flags&1048576)!==0&&kh(t,xi,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(s=$n(t.elementType),t.type=s,typeof s=="function")qd(s)?(i=Fn(s,i),t.tag=1,t=qf(null,t,s,i,n)):(t.tag=0,t=zu(null,t,s,i,n));else{if(s!=null){var o=s.$$typeof;if(o===C){t.tag=11,t=Uf(null,t,s,i,n);break e}else if(o===O){t.tag=14,t=$f(null,t,s,i,n);break e}}throw t=ge(s)||s,Error(c(306,t,""))}}return t;case 0:return zu(s,t,t.type,t.pendingProps,n);case 1:return i=t.type,o=Fn(i,t.pendingProps),qf(s,t,i,o,n);case 3:e:{if(De(t,t.stateNode.containerInfo),s===null)throw Error(c(387));i=t.pendingProps;var x=t.memoizedState;o=x.element,nu(s,t),bi(t,i,null,n);var v=t.memoizedState;if(i=v.cache,Yl(t,$t,i),i!==x.cache&&Wd(t,[$t],n,!0),Ni(),i=v.element,x.isDehydrated)if(x={element:i,isDehydrated:!1,cache:v.cache},t.updateQueue.baseState=x,t.memoizedState=x,t.flags&256){t=Vf(s,t,i,n);break e}else if(i!==o){o=Va(Error(c(424)),t),hi(o),t=Vf(s,t,i,n);break e}else{switch(s=t.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Nt=Ja(s.firstChild),Wt=t,Us=!0,Kl=null,Qa=!0,n=Bh(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Dn(),i===o){t=Sl(s,t,n);break e}sa(s,t,i,n)}t=t.child}return t;case 26:return so(s,t),s===null?(n=rg(t.type,null,t.pendingProps,null))?t.memoizedState=n:Us||(n=t.type,s=t.pendingProps,i=vo(z.current).createElement(n),i[_s]=t,i[ms]=s,ta(i,n,s),Kt(i),t.stateNode=i):t.memoizedState=rg(t.type,s.memoizedProps,t.pendingProps,s.memoizedState),null;case 27:return Le(t),s===null&&Us&&(i=t.stateNode=ag(t.type,t.pendingProps,z.current),Wt=t,Qa=!0,o=Nt,on(t.type)?(jm=o,Nt=Ja(i.firstChild)):Nt=o),sa(s,t,t.pendingProps.children,n),so(s,t),s===null&&(t.flags|=4194304),t.child;case 5:return s===null&&Us&&((o=i=Nt)&&(i=k0(i,t.type,t.pendingProps,Qa),i!==null?(t.stateNode=i,Wt=t,Nt=Ja(i.firstChild),Qa=!1,o=!0):o=!1),o||Ql(t)),Le(t),o=t.type,x=t.pendingProps,v=s!==null?s.memoizedProps:null,i=x.children,xm(o,x)?i=null:v!==null&&xm(o,v)&&(t.flags|=32),t.memoizedState!==null&&(o=mu(s,t,Iy,null,null,n),Ii._currentValue=o),so(s,t),sa(s,t,i,n),t.child;case 6:return s===null&&Us&&((s=n=Nt)&&(n=C0(n,t.pendingProps,Qa),n!==null?(t.stateNode=n,Wt=t,Nt=null,s=!0):s=!1),s||Ql(t)),null;case 13:return Gf(s,t,n);case 4:return De(t,t.stateNode.containerInfo),i=t.pendingProps,s===null?t.child=Pn(t,null,i,n):sa(s,t,i,n),t.child;case 11:return Uf(s,t,t.type,t.pendingProps,n);case 7:return sa(s,t,t.pendingProps,n),t.child;case 8:return sa(s,t,t.pendingProps.children,n),t.child;case 12:return sa(s,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,Yl(t,t.type,i.value),sa(s,t,i.children,n),t.child;case 9:return o=t.type._context,i=t.pendingProps.children,Ln(t),o=ea(o),i=i(o),t.flags|=1,sa(s,t,i,n),t.child;case 14:return $f(s,t,t.type,t.pendingProps,n);case 15:return Bf(s,t,t.type,t.pendingProps,n);case 19:return Qf(s,t,n);case 31:return Yy(s,t,n);case 22:return Pf(s,t,n,t.pendingProps);case 24:return Ln(t),i=ea($t),s===null?(o=tu(),o===null&&(o=xt,x=eu(),o.pooledCache=x,x.refCount++,x!==null&&(o.pooledCacheLanes|=n),o=x),t.memoizedState={parent:i,cache:o},lu(t),Yl(t,$t,o)):((s.lanes&n)!==0&&(nu(s,t),bi(t,null,null,n),Ni()),o=s.memoizedState,x=t.memoizedState,o.parent!==i?(o={parent:i,cache:i},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),Yl(t,$t,i)):(i=x.cache,Yl(t,$t,i),i!==o.cache&&Wd(t,[$t],n,!0))),sa(s,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(c(156,t.tag))}function kl(s){s.flags|=4}function Pu(s,t,n,i,o){if((t=(s.mode&32)!==0)&&(t=!1),t){if(s.flags|=16777216,(o&335544128)===o)if(s.stateNode.complete)s.flags|=8192;else if(yp())s.flags|=8192;else throw Bn=Pc,au}else s.flags&=-16777217}function Jf(s,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!ug(t))if(yp())s.flags|=8192;else throw Bn=Pc,au}function ao(s,t){t!==null&&(s.flags|=4),s.flags&16384&&(t=s.tag!==22?te():536870912,s.lanes|=t,zr|=t)}function Ci(s,t){if(!Us)switch(s.tailMode){case"hidden":t=s.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?s.tail=null:n.sibling=null;break;case"collapsed":n=s.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||s.tail===null?s.tail=null:s.tail.sibling=null:i.sibling=null}}function bt(s){var t=s.alternate!==null&&s.alternate.child===s.child,n=0,i=0;if(t)for(var o=s.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&65011712,i|=o.flags&65011712,o.return=s,o=o.sibling;else for(o=s.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=s,o=o.sibling;return s.subtreeFlags|=i,s.childLanes=n,t}function Xy(s,t,n){var i=t.pendingProps;switch(Qd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(t),null;case 1:return bt(t),null;case 3:return n=t.stateNode,i=null,s!==null&&(i=s.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),yl($t),se(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(s===null||s.child===null)&&(vr(t)?kl(t):s===null||s.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Jd())),bt(t),null;case 26:var o=t.type,x=t.memoizedState;return s===null?(kl(t),x!==null?(bt(t),Jf(t,x)):(bt(t),Pu(t,o,null,i,n))):x?x!==s.memoizedState?(kl(t),bt(t),Jf(t,x)):(bt(t),t.flags&=-16777217):(s=s.memoizedProps,s!==i&&kl(t),bt(t),Pu(t,o,s,i,n)),null;case 27:if(rs(t),n=z.current,o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&kl(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return bt(t),null}s=G.current,vr(t)?Th(t):(s=ag(o,i,n),t.stateNode=s,kl(t))}return bt(t),null;case 5:if(rs(t),o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&kl(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return bt(t),null}if(x=G.current,vr(t))Th(t);else{var v=vo(z.current);switch(x){case 1:x=v.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:x=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":x=v.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":x=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":x=v.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof i.is=="string"?v.createElement("select",{is:i.is}):v.createElement("select"),i.multiple?x.multiple=!0:i.size&&(x.size=i.size);break;default:x=typeof i.is=="string"?v.createElement(o,{is:i.is}):v.createElement(o)}}x[_s]=t,x[ms]=i;e:for(v=t.child;v!==null;){if(v.tag===5||v.tag===6)x.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}t.stateNode=x;e:switch(ta(x,o,i),o){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&kl(t)}}return bt(t),Pu(t,t.type,s===null?null:s.memoizedProps,t.pendingProps,n),null;case 6:if(s&&t.stateNode!=null)s.memoizedProps!==i&&kl(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(c(166));if(s=z.current,vr(t)){if(s=t.stateNode,n=t.memoizedProps,i=null,o=Wt,o!==null)switch(o.tag){case 27:case 5:i=o.memoizedProps}s[_s]=t,s=!!(s.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Gp(s.nodeValue,n)),s||Ql(t,!0)}else s=vo(s).createTextNode(i),s[_s]=t,t.stateNode=s}return bt(t),null;case 31:if(n=t.memoizedState,s===null||s.memoizedState!==null){if(i=vr(t),n!==null){if(s===null){if(!i)throw Error(c(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(557));s[_s]=t}else Dn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;bt(t),s=!1}else n=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=n),s=!0;if(!s)return t.flags&256?(Ma(t),t):(Ma(t),null);if((t.flags&128)!==0)throw Error(c(558))}return bt(t),null;case 13:if(i=t.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(o=vr(t),i!==null&&i.dehydrated!==null){if(s===null){if(!o)throw Error(c(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(c(317));o[_s]=t}else Dn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;bt(t),o=!1}else o=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(Ma(t),t):(Ma(t),null)}return Ma(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,s=s!==null&&s.memoizedState!==null,n&&(i=t.child,o=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(o=i.alternate.memoizedState.cachePool.pool),x=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(x=i.memoizedState.cachePool.pool),x!==o&&(i.flags|=2048)),n!==s&&n&&(t.child.flags|=8192),ao(t,t.updateQueue),bt(t),null);case 4:return se(),s===null&&cm(t.stateNode.containerInfo),bt(t),null;case 10:return yl(t.type),bt(t),null;case 19:if(he(Dt),i=t.memoizedState,i===null)return bt(t),null;if(o=(t.flags&128)!==0,x=i.rendering,x===null)if(o)Ci(i,!1);else{if(Mt!==0||s!==null&&(s.flags&128)!==0)for(s=t.child;s!==null;){if(x=qc(s),x!==null){for(t.flags|=128,Ci(i,!1),s=x.updateQueue,t.updateQueue=s,ao(t,s),t.subtreeFlags=0,s=n,n=t.child;n!==null;)wh(n,s),n=n.sibling;return Te(Dt,Dt.current&1|2),Us&&Nl(t,i.treeForkCount),t.child}s=s.sibling}i.tail!==null&&$s()>co&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304)}else{if(!o)if(s=qc(x),s!==null){if(t.flags|=128,o=!0,s=s.updateQueue,t.updateQueue=s,ao(t,s),Ci(i,!0),i.tail===null&&i.tailMode==="hidden"&&!x.alternate&&!Us)return bt(t),null}else 2*$s()-i.renderingStartTime>co&&n!==536870912&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304);i.isBackwards?(x.sibling=t.child,t.child=x):(s=i.last,s!==null?s.sibling=x:t.child=x,i.last=x)}return i.tail!==null?(s=i.tail,i.rendering=s,i.tail=s.sibling,i.renderingStartTime=$s(),s.sibling=null,n=Dt.current,Te(Dt,o?n&1|2:n&1),Us&&Nl(t,i.treeForkCount),s):(bt(t),null);case 22:case 23:return Ma(t),ou(),i=t.memoizedState!==null,s!==null?s.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(bt(t),t.subtreeFlags&6&&(t.flags|=8192)):bt(t),n=t.updateQueue,n!==null&&ao(t,n.retryQueue),n=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),s!==null&&he(Un),null;case 24:return n=null,s!==null&&(n=s.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),yl($t),bt(t),null;case 25:return null;case 30:return null}throw Error(c(156,t.tag))}function Zy(s,t){switch(Qd(t),t.tag){case 1:return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 3:return yl($t),se(),s=t.flags,(s&65536)!==0&&(s&128)===0?(t.flags=s&-65537|128,t):null;case 26:case 27:case 5:return rs(t),null;case 31:if(t.memoizedState!==null){if(Ma(t),t.alternate===null)throw Error(c(340));Dn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 13:if(Ma(t),s=t.memoizedState,s!==null&&s.dehydrated!==null){if(t.alternate===null)throw Error(c(340));Dn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 19:return he(Dt),null;case 4:return se(),null;case 10:return yl(t.type),null;case 22:case 23:return Ma(t),ou(),s!==null&&he(Un),s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 24:return yl($t),null;case 25:return null;default:return null}}function Xf(s,t){switch(Qd(t),t.tag){case 3:yl($t),se();break;case 26:case 27:case 5:rs(t);break;case 4:se();break;case 31:t.memoizedState!==null&&Ma(t);break;case 13:Ma(t);break;case 19:he(Dt);break;case 10:yl(t.type);break;case 22:case 23:Ma(t),ou(),s!==null&&he(Un);break;case 24:yl($t)}}function Ti(s,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var o=i.next;n=o;do{if((n.tag&s)===s){i=void 0;var x=n.create,v=n.inst;i=x(),v.destroy=i}n=n.next}while(n!==o)}}catch(k){et(t,t.return,k)}}function sn(s,t,n){try{var i=t.updateQueue,o=i!==null?i.lastEffect:null;if(o!==null){var x=o.next;i=x;do{if((i.tag&s)===s){var v=i.inst,k=v.destroy;if(k!==void 0){v.destroy=void 0,o=t;var P=n,ie=k;try{ie()}catch(ve){et(o,P,ve)}}}i=i.next}while(i!==x)}}catch(ve){et(t,t.return,ve)}}function Zf(s){var t=s.updateQueue;if(t!==null){var n=s.stateNode;try{Ih(t,n)}catch(i){et(s,s.return,i)}}}function Wf(s,t,n){n.props=Fn(s.type,s.memoizedProps),n.state=s.memoizedState;try{n.componentWillUnmount()}catch(i){et(s,t,i)}}function Ei(s,t){try{var n=s.ref;if(n!==null){switch(s.tag){case 26:case 27:case 5:var i=s.stateNode;break;case 30:i=s.stateNode;break;default:i=s.stateNode}typeof n=="function"?s.refCleanup=n(i):n.current=i}}catch(o){et(s,t,o)}}function ml(s,t){var n=s.ref,i=s.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(o){et(s,t,o)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(o){et(s,t,o)}else n.current=null}function ep(s){var t=s.type,n=s.memoizedProps,i=s.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(o){et(s,s.return,o)}}function Iu(s,t,n){try{var i=s.stateNode;N0(i,s.type,n,t),i[ms]=t}catch(o){et(s,s.return,o)}}function sp(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&on(s.type)||s.tag===4}function Fu(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||sp(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&on(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Hu(s,t,n){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(s,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(s),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=gl));else if(i!==4&&(i===27&&on(s.type)&&(n=s.stateNode,t=null),s=s.child,s!==null))for(Hu(s,t,n),s=s.sibling;s!==null;)Hu(s,t,n),s=s.sibling}function lo(s,t,n){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?n.insertBefore(s,t):n.appendChild(s);else if(i!==4&&(i===27&&on(s.type)&&(n=s.stateNode),s=s.child,s!==null))for(lo(s,t,n),s=s.sibling;s!==null;)lo(s,t,n),s=s.sibling}function tp(s){var t=s.stateNode,n=s.memoizedProps;try{for(var i=s.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);ta(t,i,n),t[_s]=s,t[ms]=n}catch(x){et(s,s.return,x)}}var Cl=!1,It=!1,qu=!1,ap=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function Wy(s,t){if(s=s.containerInfo,um=ko,s=hh(s),Ud(s)){if("selectionStart"in s)var n={start:s.selectionStart,end:s.selectionEnd};else e:{n=(n=s.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,x=i.focusNode;i=i.focusOffset;try{n.nodeType,x.nodeType}catch{n=null;break e}var v=0,k=-1,P=-1,ie=0,ve=0,we=s,oe=null;s:for(;;){for(var xe;we!==n||o!==0&&we.nodeType!==3||(k=v+o),we!==x||i!==0&&we.nodeType!==3||(P=v+i),we.nodeType===3&&(v+=we.nodeValue.length),(xe=we.firstChild)!==null;)oe=we,we=xe;for(;;){if(we===s)break s;if(oe===n&&++ie===o&&(k=v),oe===x&&++ve===i&&(P=v),(xe=we.nextSibling)!==null)break;we=oe,oe=we.parentNode}we=xe}n=k===-1||P===-1?null:{start:k,end:P}}else n=null}n=n||{start:0,end:0}}else n=null;for(mm={focusedElem:s,selectionRange:n},ko=!1,Qt=t;Qt!==null;)if(t=Qt,s=t.child,(t.subtreeFlags&1028)!==0&&s!==null)s.return=t,Qt=s;else for(;Qt!==null;){switch(t=Qt,x=t.alternate,s=t.flags,t.tag){case 0:if((s&4)!==0&&(s=t.updateQueue,s=s!==null?s.events:null,s!==null))for(n=0;n<s.length;n++)o=s[n],o.ref.impl=o.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,n=t,o=x.memoizedProps,x=x.memoizedState,i=n.stateNode;try{var qe=Fn(n.type,o);s=i.getSnapshotBeforeUpdate(qe,x),i.__reactInternalSnapshotBeforeUpdate=s}catch(ls){et(n,n.return,ls)}}break;case 3:if((s&1024)!==0){if(s=t.stateNode.containerInfo,n=s.nodeType,n===9)fm(s);else if(n===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(c(163))}if(s=t.sibling,s!==null){s.return=t.return,Qt=s;break}Qt=t.return}}function lp(s,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:El(s,n),i&4&&Ti(5,n);break;case 1:if(El(s,n),i&4)if(s=n.stateNode,t===null)try{s.componentDidMount()}catch(v){et(n,n.return,v)}else{var o=Fn(n.type,t.memoizedProps);t=t.memoizedState;try{s.componentDidUpdate(o,t,s.__reactInternalSnapshotBeforeUpdate)}catch(v){et(n,n.return,v)}}i&64&&Zf(n),i&512&&Ei(n,n.return);break;case 3:if(El(s,n),i&64&&(s=n.updateQueue,s!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Ih(s,t)}catch(v){et(n,n.return,v)}}break;case 27:t===null&&i&4&&tp(n);case 26:case 5:El(s,n),t===null&&i&4&&ep(n),i&512&&Ei(n,n.return);break;case 12:El(s,n);break;case 31:El(s,n),i&4&&ip(s,n);break;case 13:El(s,n),i&4&&cp(s,n),i&64&&(s=n.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(n=c0.bind(null,n),T0(s,n))));break;case 22:if(i=n.memoizedState!==null||Cl,!i){t=t!==null&&t.memoizedState!==null||It,o=Cl;var x=It;Cl=i,(It=t)&&!x?Ml(s,n,(n.subtreeFlags&8772)!==0):El(s,n),Cl=o,It=x}break;case 30:break;default:El(s,n)}}function np(s){var t=s.alternate;t!==null&&(s.alternate=null,np(t)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(t=s.stateNode,t!==null&&Nd(t)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var St=null,ja=!1;function Tl(s,t,n){for(n=n.child;n!==null;)rp(s,t,n),n=n.sibling}function rp(s,t,n){if(ds&&typeof ds.onCommitFiberUnmount=="function")try{ds.onCommitFiberUnmount(Is,n)}catch{}switch(n.tag){case 26:It||ml(n,t),Tl(s,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:It||ml(n,t);var i=St,o=ja;on(n.type)&&(St=n.stateNode,ja=!1),Tl(s,t,n),$i(n.stateNode),St=i,ja=o;break;case 5:It||ml(n,t);case 6:if(i=St,o=ja,St=null,Tl(s,t,n),St=i,ja=o,St!==null)if(ja)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(n.stateNode)}catch(x){et(n,t,x)}else try{St.removeChild(n.stateNode)}catch(x){et(n,t,x)}break;case 18:St!==null&&(ja?(s=St,Zp(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,n.stateNode),Pr(s)):Zp(St,n.stateNode));break;case 4:i=St,o=ja,St=n.stateNode.containerInfo,ja=!0,Tl(s,t,n),St=i,ja=o;break;case 0:case 11:case 14:case 15:sn(2,n,t),It||sn(4,n,t),Tl(s,t,n);break;case 1:It||(ml(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Wf(n,t,i)),Tl(s,t,n);break;case 21:Tl(s,t,n);break;case 22:It=(i=It)||n.memoizedState!==null,Tl(s,t,n),It=i;break;default:Tl(s,t,n)}}function ip(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Pr(s)}catch(n){et(t,t.return,n)}}}function cp(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Pr(s)}catch(n){et(t,t.return,n)}}function e0(s){switch(s.tag){case 31:case 13:case 19:var t=s.stateNode;return t===null&&(t=s.stateNode=new ap),t;case 22:return s=s.stateNode,t=s._retryCache,t===null&&(t=s._retryCache=new ap),t;default:throw Error(c(435,s.tag))}}function no(s,t){var n=e0(s);t.forEach(function(i){if(!n.has(i)){n.add(i);var o=o0.bind(null,s,i);i.then(o,o)}})}function va(s,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i],x=s,v=t,k=v;e:for(;k!==null;){switch(k.tag){case 27:if(on(k.type)){St=k.stateNode,ja=!1;break e}break;case 5:St=k.stateNode,ja=!1;break e;case 3:case 4:St=k.stateNode.containerInfo,ja=!0;break e}k=k.return}if(St===null)throw Error(c(160));rp(x,v,o),St=null,ja=!1,x=o.alternate,x!==null&&(x.return=null),o.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)op(t,s),t=t.sibling}var ll=null;function op(s,t){var n=s.alternate,i=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:va(t,s),Na(s),i&4&&(sn(3,s,s.return),Ti(3,s),sn(5,s,s.return));break;case 1:va(t,s),Na(s),i&512&&(It||n===null||ml(n,n.return)),i&64&&Cl&&(s=s.updateQueue,s!==null&&(i=s.callbacks,i!==null&&(n=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var o=ll;if(va(t,s),Na(s),i&512&&(It||n===null||ml(n,n.return)),i&4){var x=n!==null?n.memoizedState:null;if(i=s.memoizedState,n===null)if(i===null)if(s.stateNode===null){e:{i=s.type,n=s.memoizedProps,o=o.ownerDocument||o;s:switch(i){case"title":x=o.getElementsByTagName("title")[0],(!x||x[Cn]||x[_s]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=o.createElement(i),o.head.insertBefore(x,o.querySelector("head > title"))),ta(x,i,n),x[_s]=s,Kt(x),i=x;break e;case"link":var v=og("link","href",o).get(i+(n.href||""));if(v){for(var k=0;k<v.length;k++)if(x=v[k],x.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&x.getAttribute("rel")===(n.rel==null?null:n.rel)&&x.getAttribute("title")===(n.title==null?null:n.title)&&x.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){v.splice(k,1);break s}}x=o.createElement(i),ta(x,i,n),o.head.appendChild(x);break;case"meta":if(v=og("meta","content",o).get(i+(n.content||""))){for(k=0;k<v.length;k++)if(x=v[k],x.getAttribute("content")===(n.content==null?null:""+n.content)&&x.getAttribute("name")===(n.name==null?null:n.name)&&x.getAttribute("property")===(n.property==null?null:n.property)&&x.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&x.getAttribute("charset")===(n.charSet==null?null:n.charSet)){v.splice(k,1);break s}}x=o.createElement(i),ta(x,i,n),o.head.appendChild(x);break;default:throw Error(c(468,i))}x[_s]=s,Kt(x),i=x}s.stateNode=i}else dg(o,s.type,s.stateNode);else s.stateNode=cg(o,i,s.memoizedProps);else x!==i?(x===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):x.count--,i===null?dg(o,s.type,s.stateNode):cg(o,i,s.memoizedProps)):i===null&&s.stateNode!==null&&Iu(s,s.memoizedProps,n.memoizedProps)}break;case 27:va(t,s),Na(s),i&512&&(It||n===null||ml(n,n.return)),n!==null&&i&4&&Iu(s,s.memoizedProps,n.memoizedProps);break;case 5:if(va(t,s),Na(s),i&512&&(It||n===null||ml(n,n.return)),s.flags&32){o=s.stateNode;try{or(o,"")}catch(qe){et(s,s.return,qe)}}i&4&&s.stateNode!=null&&(o=s.memoizedProps,Iu(s,o,n!==null?n.memoizedProps:o)),i&1024&&(qu=!0);break;case 6:if(va(t,s),Na(s),i&4){if(s.stateNode===null)throw Error(c(162));i=s.memoizedProps,n=s.stateNode;try{n.nodeValue=i}catch(qe){et(s,s.return,qe)}}break;case 3:if(yo=null,o=ll,ll=No(t.containerInfo),va(t,s),ll=o,Na(s),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Pr(t.containerInfo)}catch(qe){et(s,s.return,qe)}qu&&(qu=!1,dp(s));break;case 4:i=ll,ll=No(s.stateNode.containerInfo),va(t,s),Na(s),ll=i;break;case 12:va(t,s),Na(s);break;case 31:va(t,s),Na(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 13:va(t,s),Na(s),s.child.flags&8192&&s.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(io=$s()),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 22:o=s.memoizedState!==null;var P=n!==null&&n.memoizedState!==null,ie=Cl,ve=It;if(Cl=ie||o,It=ve||P,va(t,s),It=ve,Cl=ie,Na(s),i&8192)e:for(t=s.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(n===null||P||Cl||It||Hn(s)),n=null,t=s;;){if(t.tag===5||t.tag===26){if(n===null){P=n=t;try{if(x=P.stateNode,o)v=x.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{k=P.stateNode;var we=P.memoizedProps.style,oe=we!=null&&we.hasOwnProperty("display")?we.display:null;k.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(qe){et(P,P.return,qe)}}}else if(t.tag===6){if(n===null){P=t;try{P.stateNode.nodeValue=o?"":P.memoizedProps}catch(qe){et(P,P.return,qe)}}}else if(t.tag===18){if(n===null){P=t;try{var xe=P.stateNode;o?Wp(xe,!0):Wp(P.stateNode,!1)}catch(qe){et(P,P.return,qe)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===s)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=s.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,no(s,n))));break;case 19:va(t,s),Na(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 30:break;case 21:break;default:va(t,s),Na(s)}}function Na(s){var t=s.flags;if(t&2){try{for(var n,i=s.return;i!==null;){if(sp(i)){n=i;break}i=i.return}if(n==null)throw Error(c(160));switch(n.tag){case 27:var o=n.stateNode,x=Fu(s);lo(s,x,o);break;case 5:var v=n.stateNode;n.flags&32&&(or(v,""),n.flags&=-33);var k=Fu(s);lo(s,k,v);break;case 3:case 4:var P=n.stateNode.containerInfo,ie=Fu(s);Hu(s,ie,P);break;default:throw Error(c(161))}}catch(ve){et(s,s.return,ve)}s.flags&=-3}t&4096&&(s.flags&=-4097)}function dp(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var t=s;dp(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),s=s.sibling}}function El(s,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)lp(s,t.alternate,t),t=t.sibling}function Hn(s){for(s=s.child;s!==null;){var t=s;switch(t.tag){case 0:case 11:case 14:case 15:sn(4,t,t.return),Hn(t);break;case 1:ml(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Wf(t,t.return,n),Hn(t);break;case 27:$i(t.stateNode);case 26:case 5:ml(t,t.return),Hn(t);break;case 22:t.memoizedState===null&&Hn(t);break;case 30:Hn(t);break;default:Hn(t)}s=s.sibling}}function Ml(s,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,o=s,x=t,v=x.flags;switch(x.tag){case 0:case 11:case 15:Ml(o,x,n),Ti(4,x);break;case 1:if(Ml(o,x,n),i=x,o=i.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(ie){et(i,i.return,ie)}if(i=x,o=i.updateQueue,o!==null){var k=i.stateNode;try{var P=o.shared.hiddenCallbacks;if(P!==null)for(o.shared.hiddenCallbacks=null,o=0;o<P.length;o++)Ph(P[o],k)}catch(ie){et(i,i.return,ie)}}n&&v&64&&Zf(x),Ei(x,x.return);break;case 27:tp(x);case 26:case 5:Ml(o,x,n),n&&i===null&&v&4&&ep(x),Ei(x,x.return);break;case 12:Ml(o,x,n);break;case 31:Ml(o,x,n),n&&v&4&&ip(o,x);break;case 13:Ml(o,x,n),n&&v&4&&cp(o,x);break;case 22:x.memoizedState===null&&Ml(o,x,n),Ei(x,x.return);break;case 30:break;default:Ml(o,x,n)}t=t.sibling}}function Vu(s,t){var n=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(s!=null&&s.refCount++,n!=null&&fi(n))}function Gu(s,t){s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s))}function nl(s,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)up(s,t,n,i),t=t.sibling}function up(s,t,n,i){var o=t.flags;switch(t.tag){case 0:case 11:case 15:nl(s,t,n,i),o&2048&&Ti(9,t);break;case 1:nl(s,t,n,i);break;case 3:nl(s,t,n,i),o&2048&&(s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s)));break;case 12:if(o&2048){nl(s,t,n,i),s=t.stateNode;try{var x=t.memoizedProps,v=x.id,k=x.onPostCommit;typeof k=="function"&&k(v,t.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(P){et(t,t.return,P)}}else nl(s,t,n,i);break;case 31:nl(s,t,n,i);break;case 13:nl(s,t,n,i);break;case 23:break;case 22:x=t.stateNode,v=t.alternate,t.memoizedState!==null?x._visibility&2?nl(s,t,n,i):Mi(s,t):x._visibility&2?nl(s,t,n,i):(x._visibility|=2,Er(s,t,n,i,(t.subtreeFlags&10256)!==0||!1)),o&2048&&Vu(v,t);break;case 24:nl(s,t,n,i),o&2048&&Gu(t.alternate,t);break;default:nl(s,t,n,i)}}function Er(s,t,n,i,o){for(o=o&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var x=s,v=t,k=n,P=i,ie=v.flags;switch(v.tag){case 0:case 11:case 15:Er(x,v,k,P,o),Ti(8,v);break;case 23:break;case 22:var ve=v.stateNode;v.memoizedState!==null?ve._visibility&2?Er(x,v,k,P,o):Mi(x,v):(ve._visibility|=2,Er(x,v,k,P,o)),o&&ie&2048&&Vu(v.alternate,v);break;case 24:Er(x,v,k,P,o),o&&ie&2048&&Gu(v.alternate,v);break;default:Er(x,v,k,P,o)}t=t.sibling}}function Mi(s,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=s,i=t,o=i.flags;switch(i.tag){case 22:Mi(n,i),o&2048&&Vu(i.alternate,i);break;case 24:Mi(n,i),o&2048&&Gu(i.alternate,i);break;default:Mi(n,i)}t=t.sibling}}var Ai=8192;function Mr(s,t,n){if(s.subtreeFlags&Ai)for(s=s.child;s!==null;)mp(s,t,n),s=s.sibling}function mp(s,t,n){switch(s.tag){case 26:Mr(s,t,n),s.flags&Ai&&s.memoizedState!==null&&P0(n,ll,s.memoizedState,s.memoizedProps);break;case 5:Mr(s,t,n);break;case 3:case 4:var i=ll;ll=No(s.stateNode.containerInfo),Mr(s,t,n),ll=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Ai,Ai=16777216,Mr(s,t,n),Ai=i):Mr(s,t,n));break;default:Mr(s,t,n)}}function xp(s){var t=s.alternate;if(t!==null&&(s=t.child,s!==null)){t.child=null;do t=s.sibling,s.sibling=null,s=t;while(s!==null)}}function zi(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Qt=i,fp(i,s)}xp(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)hp(s),s=s.sibling}function hp(s){switch(s.tag){case 0:case 11:case 15:zi(s),s.flags&2048&&sn(9,s,s.return);break;case 3:zi(s);break;case 12:zi(s);break;case 22:var t=s.stateNode;s.memoizedState!==null&&t._visibility&2&&(s.return===null||s.return.tag!==13)?(t._visibility&=-3,ro(s)):zi(s);break;default:zi(s)}}function ro(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Qt=i,fp(i,s)}xp(s)}for(s=s.child;s!==null;){switch(t=s,t.tag){case 0:case 11:case 15:sn(8,t,t.return),ro(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,ro(t));break;default:ro(t)}s=s.sibling}}function fp(s,t){for(;Qt!==null;){var n=Qt;switch(n.tag){case 0:case 11:case 15:sn(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:fi(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,Qt=i;else e:for(n=s;Qt!==null;){i=Qt;var o=i.sibling,x=i.return;if(np(i),i===n){Qt=null;break e}if(o!==null){o.return=x,Qt=o;break e}Qt=x}}}var s0={getCacheForType:function(s){var t=ea($t),n=t.data.get(s);return n===void 0&&(n=s(),t.data.set(s,n)),n},cacheSignal:function(){return ea($t).controller.signal}},t0=typeof WeakMap=="function"?WeakMap:Map,Ys=0,xt=null,As=null,Ds=0,Ws=0,Aa=null,tn=!1,Ar=!1,Ku=!1,Al=0,Mt=0,an=0,qn=0,Qu=0,za=0,zr=0,Ri=null,ba=null,Yu=!1,io=0,pp=0,co=1/0,oo=null,ln=null,qt=0,nn=null,Rr=null,zl=0,Ju=0,Xu=null,gp=null,Di=0,Zu=null;function Ra(){return(Ys&2)!==0&&Ds!==0?Ds&-Ds:D.T!==null?lm():ne()}function jp(){if(za===0)if((Ds&536870912)===0||Us){var s=Ls;Ls<<=1,(Ls&3932160)===0&&(Ls=262144),za=s}else za=536870912;return s=Ea.current,s!==null&&(s.flags|=32),za}function ya(s,t,n){(s===xt&&(Ws===2||Ws===9)||s.cancelPendingCommit!==null)&&(Dr(s,0),rn(s,Ds,za,!1)),U(s,n),((Ys&2)===0||s!==xt)&&(s===xt&&((Ys&2)===0&&(qn|=n),Mt===4&&rn(s,Ds,za,!1)),xl(s))}function vp(s,t,n){if((Ys&6)!==0)throw Error(c(327));var i=!n&&(t&127)===0&&(t&s.expiredLanes)===0||Ia(s,t),o=i?n0(s,t):em(s,t,!0),x=i;do{if(o===0){Ar&&!i&&rn(s,t,0,!1);break}else{if(n=s.current.alternate,x&&!a0(n)){o=em(s,t,!1),x=!1;continue}if(o===2){if(x=t,s.errorRecoveryDisabledLanes&x)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){t=v;e:{var k=s;o=Ri;var P=k.current.memoizedState.isDehydrated;if(P&&(Dr(k,v).flags|=256),v=em(k,v,!1),v!==2){if(Ku&&!P){k.errorRecoveryDisabledLanes|=x,qn|=x,o=4;break e}x=ba,ba=o,x!==null&&(ba===null?ba=x:ba.push.apply(ba,x))}o=v}if(x=!1,o!==2)continue}}if(o===1){Dr(s,0),rn(s,t,0,!0);break}e:{switch(i=s,x=o,x){case 0:case 1:throw Error(c(345));case 4:if((t&4194048)!==t)break;case 6:rn(i,t,za,!tn);break e;case 2:ba=null;break;case 3:case 5:break;default:throw Error(c(329))}if((t&62914560)===t&&(o=io+300-$s(),10<o)){if(rn(i,t,za,!tn),da(i,0,!0)!==0)break e;zl=t,i.timeoutHandle=Jp(Np.bind(null,i,n,ba,oo,Yu,t,za,qn,zr,tn,x,"Throttled",-0,0),o);break e}Np(i,n,ba,oo,Yu,t,za,qn,zr,tn,x,null,-0,0)}}break}while(!0);xl(s)}function Np(s,t,n,i,o,x,v,k,P,ie,ve,we,oe,xe){if(s.timeoutHandle=-1,we=t.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:gl},mp(t,x,we);var qe=(x&62914560)===x?io-$s():(x&4194048)===x?pp-$s():0;if(qe=I0(we,qe),qe!==null){zl=x,s.cancelPendingCommit=qe(Tp.bind(null,s,t,x,n,i,o,v,k,P,ve,we,null,oe,xe)),rn(s,x,v,!ie);return}}Tp(s,t,x,n,i,o,v,k,P)}function a0(s){for(var t=s;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var o=n[i],x=o.getSnapshot;o=o.value;try{if(!Ca(x(),o))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rn(s,t,n,i){t&=~Qu,t&=~qn,s.suspendedLanes|=t,s.pingedLanes&=~t,i&&(s.warmLanes|=t),i=s.expirationTimes;for(var o=t;0<o;){var x=31-ws(o),v=1<<x;i[x]=-1,o&=~v}n!==0&&Xe(s,n,t)}function uo(){return(Ys&6)===0?(Oi(0),!1):!0}function Wu(){if(As!==null){if(Ws===0)var s=As.return;else s=As,bl=On=null,fu(s),_r=null,gi=0,s=As;for(;s!==null;)Xf(s.alternate,s),s=s.return;As=null}}function Dr(s,t){var n=s.timeoutHandle;n!==-1&&(s.timeoutHandle=-1,w0(n)),n=s.cancelPendingCommit,n!==null&&(s.cancelPendingCommit=null,n()),zl=0,Wu(),xt=s,As=n=vl(s.current,null),Ds=t,Ws=0,Aa=null,tn=!1,Ar=Ia(s,t),Ku=!1,zr=za=Qu=qn=an=Mt=0,ba=Ri=null,Yu=!1,(t&8)!==0&&(t|=t&32);var i=s.entangledLanes;if(i!==0)for(s=s.entanglements,i&=t;0<i;){var o=31-ws(i),x=1<<o;t|=s[o],i&=~x}return Al=t,Ac(),n}function bp(s,t){Ss=null,D.H=Si,t===wr||t===Bc?(t=Lh(),Ws=3):t===au?(t=Lh(),Ws=4):Ws=t===Au?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Aa=t,As===null&&(Mt=1,Wc(s,Va(t,s.current)))}function yp(){var s=Ea.current;return s===null?!0:(Ds&4194048)===Ds?Ya===null:(Ds&62914560)===Ds||(Ds&536870912)!==0?s===Ya:!1}function wp(){var s=D.H;return D.H=Si,s===null?Si:s}function _p(){var s=D.A;return D.A=s0,s}function mo(){Mt=4,tn||(Ds&4194048)!==Ds&&Ea.current!==null||(Ar=!0),(an&134217727)===0&&(qn&134217727)===0||xt===null||rn(xt,Ds,za,!1)}function em(s,t,n){var i=Ys;Ys|=2;var o=wp(),x=_p();(xt!==s||Ds!==t)&&(oo=null,Dr(s,t)),t=!1;var v=Mt;e:do try{if(Ws!==0&&As!==null){var k=As,P=Aa;switch(Ws){case 8:Wu(),v=6;break e;case 3:case 2:case 9:case 6:Ea.current===null&&(t=!0);var ie=Ws;if(Ws=0,Aa=null,Or(s,k,P,ie),n&&Ar){v=0;break e}break;default:ie=Ws,Ws=0,Aa=null,Or(s,k,P,ie)}}l0(),v=Mt;break}catch(ve){bp(s,ve)}while(!0);return t&&s.shellSuspendCounter++,bl=On=null,Ys=i,D.H=o,D.A=x,As===null&&(xt=null,Ds=0,Ac()),v}function l0(){for(;As!==null;)Sp(As)}function n0(s,t){var n=Ys;Ys|=2;var i=wp(),o=_p();xt!==s||Ds!==t?(oo=null,co=$s()+500,Dr(s,t)):Ar=Ia(s,t);e:do try{if(Ws!==0&&As!==null){t=As;var x=Aa;s:switch(Ws){case 1:Ws=0,Aa=null,Or(s,t,x,1);break;case 2:case 9:if(Dh(x)){Ws=0,Aa=null,kp(t);break}t=function(){Ws!==2&&Ws!==9||xt!==s||(Ws=7),xl(s)},x.then(t,t);break e;case 3:Ws=7;break e;case 4:Ws=5;break e;case 7:Dh(x)?(Ws=0,Aa=null,kp(t)):(Ws=0,Aa=null,Or(s,t,x,7));break;case 5:var v=null;switch(As.tag){case 26:v=As.memoizedState;case 5:case 27:var k=As;if(v?ug(v):k.stateNode.complete){Ws=0,Aa=null;var P=k.sibling;if(P!==null)As=P;else{var ie=k.return;ie!==null?(As=ie,xo(ie)):As=null}break s}}Ws=0,Aa=null,Or(s,t,x,5);break;case 6:Ws=0,Aa=null,Or(s,t,x,6);break;case 8:Wu(),Mt=6;break e;default:throw Error(c(462))}}r0();break}catch(ve){bp(s,ve)}while(!0);return bl=On=null,D.H=i,D.A=o,Ys=n,As!==null?0:(xt=null,Ds=0,Ac(),Mt)}function r0(){for(;As!==null&&!pa();)Sp(As)}function Sp(s){var t=Yf(s.alternate,s,Al);s.memoizedProps=s.pendingProps,t===null?xo(s):As=t}function kp(s){var t=s,n=t.alternate;switch(t.tag){case 15:case 0:t=Hf(n,t,t.pendingProps,t.type,void 0,Ds);break;case 11:t=Hf(n,t,t.pendingProps,t.type.render,t.ref,Ds);break;case 5:fu(t);default:Xf(n,t),t=As=wh(t,Al),t=Yf(n,t,Al)}s.memoizedProps=s.pendingProps,t===null?xo(s):As=t}function Or(s,t,n,i){bl=On=null,fu(t),_r=null,gi=0;var o=t.return;try{if(Qy(s,o,t,n,Ds)){Mt=1,Wc(s,Va(n,s.current)),As=null;return}}catch(x){if(o!==null)throw As=o,x;Mt=1,Wc(s,Va(n,s.current)),As=null;return}t.flags&32768?(Us||i===1?s=!0:Ar||(Ds&536870912)!==0?s=!1:(tn=s=!0,(i===2||i===9||i===3||i===6)&&(i=Ea.current,i!==null&&i.tag===13&&(i.flags|=16384))),Cp(t,s)):xo(t)}function xo(s){var t=s;do{if((t.flags&32768)!==0){Cp(t,tn);return}s=t.return;var n=Xy(t.alternate,t,Al);if(n!==null){As=n;return}if(t=t.sibling,t!==null){As=t;return}As=t=s}while(t!==null);Mt===0&&(Mt=5)}function Cp(s,t){do{var n=Zy(s.alternate,s);if(n!==null){n.flags&=32767,As=n;return}if(n=s.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(s=s.sibling,s!==null)){As=s;return}As=s=n}while(s!==null);Mt=6,As=null}function Tp(s,t,n,i,o,x,v,k,P){s.cancelPendingCommit=null;do ho();while(qt!==0);if((Ys&6)!==0)throw Error(c(327));if(t!==null){if(t===s.current)throw Error(c(177));if(x=t.lanes|t.childLanes,x|=Fd,Me(s,n,x,v,k,P),s===xt&&(As=xt=null,Ds=0),Rr=t,nn=s,zl=n,Ju=x,Xu=o,gp=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,d0(Ze,function(){return Rp(),null})):(s.callbackNode=null,s.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=D.T,D.T=null,o=Q.p,Q.p=2,v=Ys,Ys|=4;try{Wy(s,t,n)}finally{Ys=v,Q.p=o,D.T=i}}qt=1,Ep(),Mp(),Ap()}}function Ep(){if(qt===1){qt=0;var s=nn,t=Rr,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=D.T,D.T=null;var i=Q.p;Q.p=2;var o=Ys;Ys|=4;try{op(t,s);var x=mm,v=hh(s.containerInfo),k=x.focusedElem,P=x.selectionRange;if(v!==k&&k&&k.ownerDocument&&xh(k.ownerDocument.documentElement,k)){if(P!==null&&Ud(k)){var ie=P.start,ve=P.end;if(ve===void 0&&(ve=ie),"selectionStart"in k)k.selectionStart=ie,k.selectionEnd=Math.min(ve,k.value.length);else{var we=k.ownerDocument||document,oe=we&&we.defaultView||window;if(oe.getSelection){var xe=oe.getSelection(),qe=k.textContent.length,ls=Math.min(P.start,qe),ut=P.end===void 0?ls:Math.min(P.end,qe);!xe.extend&&ls>ut&&(v=ut,ut=ls,ls=v);var ee=mh(k,ls),V=mh(k,ut);if(ee&&V&&(xe.rangeCount!==1||xe.anchorNode!==ee.node||xe.anchorOffset!==ee.offset||xe.focusNode!==V.node||xe.focusOffset!==V.offset)){var re=we.createRange();re.setStart(ee.node,ee.offset),xe.removeAllRanges(),ls>ut?(xe.addRange(re),xe.extend(V.node,V.offset)):(re.setEnd(V.node,V.offset),xe.addRange(re))}}}}for(we=[],xe=k;xe=xe.parentNode;)xe.nodeType===1&&we.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<we.length;k++){var be=we[k];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}ko=!!um,mm=um=null}finally{Ys=o,Q.p=i,D.T=n}}s.current=t,qt=2}}function Mp(){if(qt===2){qt=0;var s=nn,t=Rr,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=D.T,D.T=null;var i=Q.p;Q.p=2;var o=Ys;Ys|=4;try{lp(s,t.alternate,t)}finally{Ys=o,Q.p=i,D.T=n}}qt=3}}function Ap(){if(qt===4||qt===3){qt=0,rt();var s=nn,t=Rr,n=zl,i=gp;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?qt=5:(qt=0,Rr=nn=null,zp(s,s.pendingLanes));var o=s.pendingLanes;if(o===0&&(ln=null),Bs(n),t=t.stateNode,ds&&typeof ds.onCommitFiberRoot=="function")try{ds.onCommitFiberRoot(Is,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=D.T,o=Q.p,Q.p=2,D.T=null;try{for(var x=s.onRecoverableError,v=0;v<i.length;v++){var k=i[v];x(k.value,{componentStack:k.stack})}}finally{D.T=t,Q.p=o}}(zl&3)!==0&&ho(),xl(s),o=s.pendingLanes,(n&261930)!==0&&(o&42)!==0?s===Zu?Di++:(Di=0,Zu=s):Di=0,Oi(0)}}function zp(s,t){(s.pooledCacheLanes&=t)===0&&(t=s.pooledCache,t!=null&&(s.pooledCache=null,fi(t)))}function ho(){return Ep(),Mp(),Ap(),Rp()}function Rp(){if(qt!==5)return!1;var s=nn,t=Ju;Ju=0;var n=Bs(zl),i=D.T,o=Q.p;try{Q.p=32>n?32:n,D.T=null,n=Xu,Xu=null;var x=nn,v=zl;if(qt=0,Rr=nn=null,zl=0,(Ys&6)!==0)throw Error(c(331));var k=Ys;if(Ys|=4,hp(x.current),up(x,x.current,v,n),Ys=k,Oi(0,!1),ds&&typeof ds.onPostCommitFiberRoot=="function")try{ds.onPostCommitFiberRoot(Is,x)}catch{}return!0}finally{Q.p=o,D.T=i,zp(s,t)}}function Dp(s,t,n){t=Va(n,t),t=Mu(s.stateNode,t,2),s=Zl(s,t,2),s!==null&&(U(s,2),xl(s))}function et(s,t,n){if(s.tag===3)Dp(s,s,n);else for(;t!==null;){if(t.tag===3){Dp(t,s,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ln===null||!ln.has(i))){s=Va(n,s),n=Of(2),i=Zl(t,n,2),i!==null&&(Lf(n,i,t,s),U(i,2),xl(i));break}}t=t.return}}function sm(s,t,n){var i=s.pingCache;if(i===null){i=s.pingCache=new t0;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(n)||(Ku=!0,o.add(n),s=i0.bind(null,s,t,n),t.then(s,s))}function i0(s,t,n){var i=s.pingCache;i!==null&&i.delete(t),s.pingedLanes|=s.suspendedLanes&n,s.warmLanes&=~n,xt===s&&(Ds&n)===n&&(Mt===4||Mt===3&&(Ds&62914560)===Ds&&300>$s()-io?(Ys&2)===0&&Dr(s,0):Qu|=n,zr===Ds&&(zr=0)),xl(s)}function Op(s,t){t===0&&(t=te()),s=zn(s,t),s!==null&&(U(s,t),xl(s))}function c0(s){var t=s.memoizedState,n=0;t!==null&&(n=t.retryLane),Op(s,n)}function o0(s,t){var n=0;switch(s.tag){case 31:case 13:var i=s.stateNode,o=s.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=s.stateNode;break;case 22:i=s.stateNode._retryCache;break;default:throw Error(c(314))}i!==null&&i.delete(t),Op(s,n)}function d0(s,t){return Js(s,t)}var fo=null,Lr=null,tm=!1,po=!1,am=!1,cn=0;function xl(s){s!==Lr&&s.next===null&&(Lr===null?fo=Lr=s:Lr=Lr.next=s),po=!0,tm||(tm=!0,m0())}function Oi(s,t){if(!am&&po){am=!0;do for(var n=!1,i=fo;i!==null;){if(s!==0){var o=i.pendingLanes;if(o===0)var x=0;else{var v=i.suspendedLanes,k=i.pingedLanes;x=(1<<31-ws(42|s)+1)-1,x&=o&~(v&~k),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(n=!0,Bp(i,x))}else x=Ds,x=da(i,i===xt?x:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(x&3)===0||Ia(i,x)||(n=!0,Bp(i,x));i=i.next}while(n);am=!1}}function u0(){Lp()}function Lp(){po=tm=!1;var s=0;cn!==0&&y0()&&(s=cn);for(var t=$s(),n=null,i=fo;i!==null;){var o=i.next,x=Up(i,t);x===0?(i.next=null,n===null?fo=o:n.next=o,o===null&&(Lr=n)):(n=i,(s!==0||(x&3)!==0)&&(po=!0)),i=o}qt!==0&&qt!==5||Oi(s),cn!==0&&(cn=0)}function Up(s,t){for(var n=s.suspendedLanes,i=s.pingedLanes,o=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var v=31-ws(x),k=1<<v,P=o[v];P===-1?((k&n)===0||(k&i)!==0)&&(o[v]=Xt(k,t)):P<=t&&(s.expiredLanes|=k),x&=~k}if(t=xt,n=Ds,n=da(s,s===t?n:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i=s.callbackNode,n===0||s===t&&(Ws===2||Ws===9)||s.cancelPendingCommit!==null)return i!==null&&i!==null&&kt(i),s.callbackNode=null,s.callbackPriority=0;if((n&3)===0||Ia(s,n)){if(t=n&-n,t===s.callbackPriority)return t;switch(i!==null&&kt(i),Bs(n)){case 2:case 8:n=Ke;break;case 32:n=Ze;break;case 268435456:n=as;break;default:n=Ze}return i=$p.bind(null,s),n=Js(n,i),s.callbackPriority=t,s.callbackNode=n,t}return i!==null&&i!==null&&kt(i),s.callbackPriority=2,s.callbackNode=null,2}function $p(s,t){if(qt!==0&&qt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var n=s.callbackNode;if(ho()&&s.callbackNode!==n)return null;var i=Ds;return i=da(s,s===xt?i:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i===0?null:(vp(s,i,t),Up(s,$s()),s.callbackNode!=null&&s.callbackNode===n?$p.bind(null,s):null)}function Bp(s,t){if(ho())return null;vp(s,t,!0)}function m0(){_0(function(){(Ys&6)!==0?Js(He,u0):Lp()})}function lm(){if(cn===0){var s=br;s===0&&(s=Ge,Ge<<=1,(Ge&261888)===0&&(Ge=256)),cn=s}return cn}function Pp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:wc(""+s)}function Ip(s,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,s.id&&n.setAttribute("form",s.id),t.parentNode.insertBefore(n,t),s=new FormData(s),n.parentNode.removeChild(n),s}function x0(s,t,n,i,o){if(t==="submit"&&n&&n.stateNode===o){var x=Pp((o[ms]||null).action),v=i.submitter;v&&(t=(t=v[ms]||null)?Pp(t.formAction):v.getAttribute("formAction"),t!==null&&(x=t,v=null));var k=new Cc("action","action",null,i,o);s.push({event:k,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(cn!==0){var P=v?Ip(o,v):new FormData(o);_u(n,{pending:!0,data:P,method:o.method,action:x},null,P)}}else typeof x=="function"&&(k.preventDefault(),P=v?Ip(o,v):new FormData(o),_u(n,{pending:!0,data:P,method:o.method,action:x},x,P))},currentTarget:o}]})}}for(var nm=0;nm<Id.length;nm++){var rm=Id[nm],h0=rm.toLowerCase(),f0=rm[0].toUpperCase()+rm.slice(1);al(h0,"on"+f0)}al(gh,"onAnimationEnd"),al(jh,"onAnimationIteration"),al(vh,"onAnimationStart"),al("dblclick","onDoubleClick"),al("focusin","onFocus"),al("focusout","onBlur"),al(Ay,"onTransitionRun"),al(zy,"onTransitionStart"),al(Ry,"onTransitionCancel"),al(Nh,"onTransitionEnd"),ir("onMouseEnter",["mouseout","mouseover"]),ir("onMouseLeave",["mouseout","mouseover"]),ir("onPointerEnter",["pointerout","pointerover"]),ir("onPointerLeave",["pointerout","pointerover"]),Tn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Tn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Tn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Tn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Tn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Tn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Li));function Fp(s,t){t=(t&4)!==0;for(var n=0;n<s.length;n++){var i=s[n],o=i.event;i=i.listeners;e:{var x=void 0;if(t)for(var v=i.length-1;0<=v;v--){var k=i[v],P=k.instance,ie=k.currentTarget;if(k=k.listener,P!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=ie;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=P}else for(v=0;v<i.length;v++){if(k=i[v],P=k.instance,ie=k.currentTarget,k=k.listener,P!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=ie;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=P}}}}function zs(s,t){var n=t[ua];n===void 0&&(n=t[ua]=new Set);var i=s+"__bubble";n.has(i)||(Hp(t,s,2,!1),n.add(i))}function im(s,t,n){var i=0;t&&(i|=4),Hp(n,s,i,t)}var go="_reactListening"+Math.random().toString(36).slice(2);function cm(s){if(!s[go]){s[go]=!0,Ox.forEach(function(n){n!=="selectionchange"&&(p0.has(n)||im(n,!1,s),im(n,!0,s))});var t=s.nodeType===9?s:s.ownerDocument;t===null||t[go]||(t[go]=!0,im("selectionchange",!1,t))}}function Hp(s,t,n,i){switch(jg(t)){case 2:var o=q0;break;case 8:o=V0;break;default:o=wm}n=o.bind(null,t,n,s),o=void 0,!Td||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?s.addEventListener(t,n,{capture:!0,passive:o}):s.addEventListener(t,n,!0):o!==void 0?s.addEventListener(t,n,{passive:o}):s.addEventListener(t,n,!1)}function om(s,t,n,i,o){var x=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var v=i.tag;if(v===3||v===4){var k=i.stateNode.containerInfo;if(k===o)break;if(v===4)for(v=i.return;v!==null;){var P=v.tag;if((P===3||P===4)&&v.stateNode.containerInfo===o)return;v=v.return}for(;k!==null;){if(v=lr(k),v===null)return;if(P=v.tag,P===5||P===6||P===26||P===27){i=x=v;continue e}k=k.parentNode}}i=i.return}Kx(function(){var ie=x,ve=kd(n),we=[];e:{var oe=bh.get(s);if(oe!==void 0){var xe=Cc,qe=s;switch(s){case"keypress":if(Sc(n)===0)break e;case"keydown":case"keyup":xe=oy;break;case"focusin":qe="focus",xe=zd;break;case"focusout":qe="blur",xe=zd;break;case"beforeblur":case"afterblur":xe=zd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Jx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=Xb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=my;break;case gh:case jh:case vh:xe=ey;break;case Nh:xe=hy;break;case"scroll":case"scrollend":xe=Yb;break;case"wheel":xe=py;break;case"copy":case"cut":case"paste":xe=ty;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Zx;break;case"toggle":case"beforetoggle":xe=jy}var ls=(t&4)!==0,ut=!ls&&(s==="scroll"||s==="scrollend"),ee=ls?oe!==null?oe+"Capture":null:oe;ls=[];for(var V=ie,re;V!==null;){var be=V;if(re=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||re===null||ee===null||(be=li(V,ee),be!=null&&ls.push(Ui(V,be,re))),ut)break;V=V.return}0<ls.length&&(oe=new xe(oe,qe,null,n,ve),we.push({event:oe,listeners:ls}))}}if((t&7)===0){e:{if(oe=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",oe&&n!==Sd&&(qe=n.relatedTarget||n.fromElement)&&(lr(qe)||qe[_t]))break e;if((xe||oe)&&(oe=ve.window===ve?ve:(oe=ve.ownerDocument)?oe.defaultView||oe.parentWindow:window,xe?(qe=n.relatedTarget||n.toElement,xe=ie,qe=qe?lr(qe):null,qe!==null&&(ut=m(qe),ls=qe.tag,qe!==ut||ls!==5&&ls!==27&&ls!==6)&&(qe=null)):(xe=null,qe=ie),xe!==qe)){if(ls=Jx,be="onMouseLeave",ee="onMouseEnter",V="mouse",(s==="pointerout"||s==="pointerover")&&(ls=Zx,be="onPointerLeave",ee="onPointerEnter",V="pointer"),ut=xe==null?oe:ai(xe),re=qe==null?oe:ai(qe),oe=new ls(be,V+"leave",xe,n,ve),oe.target=ut,oe.relatedTarget=re,be=null,lr(ve)===ie&&(ls=new ls(ee,V+"enter",qe,n,ve),ls.target=re,ls.relatedTarget=ut,be=ls),ut=be,xe&&qe)s:{for(ls=g0,ee=xe,V=qe,re=0,be=ee;be;be=ls(be))re++;be=0;for(var We=V;We;We=ls(We))be++;for(;0<re-be;)ee=ls(ee),re--;for(;0<be-re;)V=ls(V),be--;for(;re--;){if(ee===V||V!==null&&ee===V.alternate){ls=ee;break s}ee=ls(ee),V=ls(V)}ls=null}else ls=null;xe!==null&&qp(we,oe,xe,ls,!1),qe!==null&&ut!==null&&qp(we,ut,qe,ls,!0)}}e:{if(oe=ie?ai(ie):window,xe=oe.nodeName&&oe.nodeName.toLowerCase(),xe==="select"||xe==="input"&&oe.type==="file")var Gs=rh;else if(lh(oe))if(ih)Gs=Ty;else{Gs=ky;var Qe=Sy}else xe=oe.nodeName,!xe||xe.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ie&&_d(ie.elementType)&&(Gs=rh):Gs=Cy;if(Gs&&(Gs=Gs(s,ie))){nh(we,Gs,n,ve);break e}Qe&&Qe(s,oe,ie),s==="focusout"&&ie&&oe.type==="number"&&ie.memoizedProps.value!=null&&wd(oe,"number",oe.value)}switch(Qe=ie?ai(ie):window,s){case"focusin":(lh(Qe)||Qe.contentEditable==="true")&&(xr=Qe,$d=ie,mi=null);break;case"focusout":mi=$d=xr=null;break;case"mousedown":Bd=!0;break;case"contextmenu":case"mouseup":case"dragend":Bd=!1,fh(we,n,ve);break;case"selectionchange":if(My)break;case"keydown":case"keyup":fh(we,n,ve)}var ks;if(Dd)e:{switch(s){case"compositionstart":var Os="onCompositionStart";break e;case"compositionend":Os="onCompositionEnd";break e;case"compositionupdate":Os="onCompositionUpdate";break e}Os=void 0}else mr?th(s,n)&&(Os="onCompositionEnd"):s==="keydown"&&n.keyCode===229&&(Os="onCompositionStart");Os&&(Wx&&n.locale!=="ko"&&(mr||Os!=="onCompositionStart"?Os==="onCompositionEnd"&&mr&&(ks=Qx()):(Vl=ve,Ed="value"in Vl?Vl.value:Vl.textContent,mr=!0)),Qe=jo(ie,Os),0<Qe.length&&(Os=new Xx(Os,s,null,n,ve),we.push({event:Os,listeners:Qe}),ks?Os.data=ks:(ks=ah(n),ks!==null&&(Os.data=ks)))),(ks=Ny?by(s,n):yy(s,n))&&(Os=jo(ie,"onBeforeInput"),0<Os.length&&(Qe=new Xx("onBeforeInput","beforeinput",null,n,ve),we.push({event:Qe,listeners:Os}),Qe.data=ks)),x0(we,s,ie,n,ve)}Fp(we,t)})}function Ui(s,t,n){return{instance:s,listener:t,currentTarget:n}}function jo(s,t){for(var n=t+"Capture",i=[];s!==null;){var o=s,x=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||x===null||(o=li(s,n),o!=null&&i.unshift(Ui(s,o,x)),o=li(s,t),o!=null&&i.push(Ui(s,o,x))),s.tag===3)return i;s=s.return}return[]}function g0(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function qp(s,t,n,i,o){for(var x=t._reactName,v=[];n!==null&&n!==i;){var k=n,P=k.alternate,ie=k.stateNode;if(k=k.tag,P!==null&&P===i)break;k!==5&&k!==26&&k!==27||ie===null||(P=ie,o?(ie=li(n,x),ie!=null&&v.unshift(Ui(n,ie,P))):o||(ie=li(n,x),ie!=null&&v.push(Ui(n,ie,P)))),n=n.return}v.length!==0&&s.push({event:t,listeners:v})}var j0=/\r\n?/g,v0=/\u0000|\uFFFD/g;function Vp(s){return(typeof s=="string"?s:""+s).replace(j0,`
`).replace(v0,"")}function Gp(s,t){return t=Vp(t),Vp(s)===t}function dt(s,t,n,i,o,x){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||or(s,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&or(s,""+i);break;case"className":bc(s,"class",i);break;case"tabIndex":bc(s,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":bc(s,n,i);break;case"style":Vx(s,i,x);break;case"data":if(t!=="object"){bc(s,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){s.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(n);break}i=wc(""+i),s.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){s.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(n==="formAction"?(t!=="input"&&dt(s,t,"name",o.name,o,null),dt(s,t,"formEncType",o.formEncType,o,null),dt(s,t,"formMethod",o.formMethod,o,null),dt(s,t,"formTarget",o.formTarget,o,null)):(dt(s,t,"encType",o.encType,o,null),dt(s,t,"method",o.method,o,null),dt(s,t,"target",o.target,o,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(n);break}i=wc(""+i),s.setAttribute(n,i);break;case"onClick":i!=null&&(s.onclick=gl);break;case"onScroll":i!=null&&zs("scroll",s);break;case"onScrollEnd":i!=null&&zs("scrollend",s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(n=i.__html,n!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=n}}break;case"multiple":s.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":s.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){s.removeAttribute("xlink:href");break}n=wc(""+i),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,""+i):s.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,""):s.removeAttribute(n);break;case"capture":case"download":i===!0?s.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,i):s.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?s.setAttribute(n,i):s.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?s.removeAttribute(n):s.setAttribute(n,i);break;case"popover":zs("beforetoggle",s),zs("toggle",s),Nc(s,"popover",i);break;case"xlinkActuate":pl(s,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":pl(s,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":pl(s,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":pl(s,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":pl(s,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":pl(s,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":pl(s,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":pl(s,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":pl(s,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Nc(s,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Kb.get(n)||n,Nc(s,n,i))}}function dm(s,t,n,i,o,x){switch(n){case"style":Vx(s,i,x);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(n=i.__html,n!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=n}}break;case"children":typeof i=="string"?or(s,i):(typeof i=="number"||typeof i=="bigint")&&or(s,""+i);break;case"onScroll":i!=null&&zs("scroll",s);break;case"onScrollEnd":i!=null&&zs("scrollend",s);break;case"onClick":i!=null&&(s.onclick=gl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lx.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),x=s[ms]||null,x=x!=null?x[n]:null,typeof x=="function"&&s.removeEventListener(t,x,o),typeof i=="function")){typeof x!="function"&&x!==null&&(n in s?s[n]=null:s.hasAttribute(n)&&s.removeAttribute(n)),s.addEventListener(t,i,o);break e}n in s?s[n]=i:i===!0?s.setAttribute(n,""):Nc(s,n,i)}}}function ta(s,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zs("error",s),zs("load",s);var i=!1,o=!1,x;for(x in n)if(n.hasOwnProperty(x)){var v=n[x];if(v!=null)switch(x){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:dt(s,t,x,v,n,null)}}o&&dt(s,t,"srcSet",n.srcSet,n,null),i&&dt(s,t,"src",n.src,n,null);return;case"input":zs("invalid",s);var k=x=v=o=null,P=null,ie=null;for(i in n)if(n.hasOwnProperty(i)){var ve=n[i];if(ve!=null)switch(i){case"name":o=ve;break;case"type":v=ve;break;case"checked":P=ve;break;case"defaultChecked":ie=ve;break;case"value":x=ve;break;case"defaultValue":k=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(c(137,t));break;default:dt(s,t,i,ve,n,null)}}Ix(s,x,k,P,ie,v,o,!1);return;case"select":zs("invalid",s),i=v=x=null;for(o in n)if(n.hasOwnProperty(o)&&(k=n[o],k!=null))switch(o){case"value":x=k;break;case"defaultValue":v=k;break;case"multiple":i=k;default:dt(s,t,o,k,n,null)}t=x,n=v,s.multiple=!!i,t!=null?cr(s,!!i,t,!1):n!=null&&cr(s,!!i,n,!0);return;case"textarea":zs("invalid",s),x=o=i=null;for(v in n)if(n.hasOwnProperty(v)&&(k=n[v],k!=null))switch(v){case"value":i=k;break;case"defaultValue":o=k;break;case"children":x=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(c(91));break;default:dt(s,t,v,k,n,null)}Hx(s,i,o,x);return;case"option":for(P in n)if(n.hasOwnProperty(P)&&(i=n[P],i!=null))switch(P){case"selected":s.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:dt(s,t,P,i,n,null)}return;case"dialog":zs("beforetoggle",s),zs("toggle",s),zs("cancel",s),zs("close",s);break;case"iframe":case"object":zs("load",s);break;case"video":case"audio":for(i=0;i<Li.length;i++)zs(Li[i],s);break;case"image":zs("error",s),zs("load",s);break;case"details":zs("toggle",s);break;case"embed":case"source":case"link":zs("error",s),zs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in n)if(n.hasOwnProperty(ie)&&(i=n[ie],i!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:dt(s,t,ie,i,n,null)}return;default:if(_d(t)){for(ve in n)n.hasOwnProperty(ve)&&(i=n[ve],i!==void 0&&dm(s,t,ve,i,n,void 0));return}}for(k in n)n.hasOwnProperty(k)&&(i=n[k],i!=null&&dt(s,t,k,i,n,null))}function N0(s,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,x=null,v=null,k=null,P=null,ie=null,ve=null;for(xe in n){var we=n[xe];if(n.hasOwnProperty(xe)&&we!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":P=we;default:i.hasOwnProperty(xe)||dt(s,t,xe,null,i,we)}}for(var oe in i){var xe=i[oe];if(we=n[oe],i.hasOwnProperty(oe)&&(xe!=null||we!=null))switch(oe){case"type":x=xe;break;case"name":o=xe;break;case"checked":ie=xe;break;case"defaultChecked":ve=xe;break;case"value":v=xe;break;case"defaultValue":k=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(c(137,t));break;default:xe!==we&&dt(s,t,oe,xe,i,we)}}yd(s,v,k,P,ie,ve,x,o);return;case"select":xe=v=k=oe=null;for(x in n)if(P=n[x],n.hasOwnProperty(x)&&P!=null)switch(x){case"value":break;case"multiple":xe=P;default:i.hasOwnProperty(x)||dt(s,t,x,null,i,P)}for(o in i)if(x=i[o],P=n[o],i.hasOwnProperty(o)&&(x!=null||P!=null))switch(o){case"value":oe=x;break;case"defaultValue":k=x;break;case"multiple":v=x;default:x!==P&&dt(s,t,o,x,i,P)}t=k,n=v,i=xe,oe!=null?cr(s,!!n,oe,!1):!!i!=!!n&&(t!=null?cr(s,!!n,t,!0):cr(s,!!n,n?[]:"",!1));return;case"textarea":xe=oe=null;for(k in n)if(o=n[k],n.hasOwnProperty(k)&&o!=null&&!i.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:dt(s,t,k,null,i,o)}for(v in i)if(o=i[v],x=n[v],i.hasOwnProperty(v)&&(o!=null||x!=null))switch(v){case"value":oe=o;break;case"defaultValue":xe=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(c(91));break;default:o!==x&&dt(s,t,v,o,i,x)}Fx(s,oe,xe);return;case"option":for(var qe in n)if(oe=n[qe],n.hasOwnProperty(qe)&&oe!=null&&!i.hasOwnProperty(qe))switch(qe){case"selected":s.selected=!1;break;default:dt(s,t,qe,null,i,oe)}for(P in i)if(oe=i[P],xe=n[P],i.hasOwnProperty(P)&&oe!==xe&&(oe!=null||xe!=null))switch(P){case"selected":s.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:dt(s,t,P,oe,i,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ls in n)oe=n[ls],n.hasOwnProperty(ls)&&oe!=null&&!i.hasOwnProperty(ls)&&dt(s,t,ls,null,i,oe);for(ie in i)if(oe=i[ie],xe=n[ie],i.hasOwnProperty(ie)&&oe!==xe&&(oe!=null||xe!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(c(137,t));break;default:dt(s,t,ie,oe,i,xe)}return;default:if(_d(t)){for(var ut in n)oe=n[ut],n.hasOwnProperty(ut)&&oe!==void 0&&!i.hasOwnProperty(ut)&&dm(s,t,ut,void 0,i,oe);for(ve in i)oe=i[ve],xe=n[ve],!i.hasOwnProperty(ve)||oe===xe||oe===void 0&&xe===void 0||dm(s,t,ve,oe,i,xe);return}}for(var ee in n)oe=n[ee],n.hasOwnProperty(ee)&&oe!=null&&!i.hasOwnProperty(ee)&&dt(s,t,ee,null,i,oe);for(we in i)oe=i[we],xe=n[we],!i.hasOwnProperty(we)||oe===xe||oe==null&&xe==null||dt(s,t,we,oe,i,xe)}function Kp(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function b0(){if(typeof performance.getEntriesByType=="function"){for(var s=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var o=n[i],x=o.transferSize,v=o.initiatorType,k=o.duration;if(x&&k&&Kp(v)){for(v=0,k=o.responseEnd,i+=1;i<n.length;i++){var P=n[i],ie=P.startTime;if(ie>k)break;var ve=P.transferSize,we=P.initiatorType;ve&&Kp(we)&&(P=P.responseEnd,v+=ve*(P<k?1:(k-ie)/(P-ie)))}if(--i,t+=8*(x+v)/(o.duration/1e3),s++,10<s)break}}if(0<s)return t/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var um=null,mm=null;function vo(s){return s.nodeType===9?s:s.ownerDocument}function Qp(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Yp(s,t){if(s===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&t==="foreignObject"?0:s}function xm(s,t){return s==="textarea"||s==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hm=null;function y0(){var s=window.event;return s&&s.type==="popstate"?s===hm?!1:(hm=s,!0):(hm=null,!1)}var Jp=typeof setTimeout=="function"?setTimeout:void 0,w0=typeof clearTimeout=="function"?clearTimeout:void 0,Xp=typeof Promise=="function"?Promise:void 0,_0=typeof queueMicrotask=="function"?queueMicrotask:typeof Xp<"u"?function(s){return Xp.resolve(null).then(s).catch(S0)}:Jp;function S0(s){setTimeout(function(){throw s})}function on(s){return s==="head"}function Zp(s,t){var n=t,i=0;do{var o=n.nextSibling;if(s.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"||n==="/&"){if(i===0){s.removeChild(o),Pr(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")$i(s.ownerDocument.documentElement);else if(n==="head"){n=s.ownerDocument.head,$i(n);for(var x=n.firstChild;x;){var v=x.nextSibling,k=x.nodeName;x[Cn]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&x.rel.toLowerCase()==="stylesheet"||n.removeChild(x),x=v}}else n==="body"&&$i(s.ownerDocument.body);n=o}while(n);Pr(t)}function Wp(s,t){var n=s;s=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(s===0)break;s--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||s++;n=i}while(n)}function fm(s){var t=s.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":fm(n),Nd(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}s.removeChild(n)}}function k0(s,t,n,i){for(;s.nodeType===1;){var o=n;if(s.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(i){if(!s[Cn])switch(t){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==o.rel||s.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||s.getAttribute("title")!==(o.title==null?null:o.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(o.src==null?null:o.src)||s.getAttribute("type")!==(o.type==null?null:o.type)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(t==="input"&&s.type==="hidden"){var x=o.name==null?null:""+o.name;if(o.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=Ja(s.nextSibling),s===null)break}return null}function C0(s,t,n){if(t==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!n||(s=Ja(s.nextSibling),s===null))return null;return s}function eg(s,t){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!t||(s=Ja(s.nextSibling),s===null))return null;return s}function pm(s){return s.data==="$?"||s.data==="$~"}function gm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function T0(s,t){var n=s.ownerDocument;if(s.data==="$~")s._reactRetry=t;else if(s.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),s._reactRetry=i}}function Ja(s){for(;s!=null;s=s.nextSibling){var t=s.nodeType;if(t===1||t===3)break;if(t===8){if(t=s.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return s}var jm=null;function sg(s){s=s.nextSibling;for(var t=0;s;){if(s.nodeType===8){var n=s.data;if(n==="/$"||n==="/&"){if(t===0)return Ja(s.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}s=s.nextSibling}return null}function tg(s){s=s.previousSibling;for(var t=0;s;){if(s.nodeType===8){var n=s.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return s;t--}else n!=="/$"&&n!=="/&"||t++}s=s.previousSibling}return null}function ag(s,t,n){switch(t=vo(n),s){case"html":if(s=t.documentElement,!s)throw Error(c(452));return s;case"head":if(s=t.head,!s)throw Error(c(453));return s;case"body":if(s=t.body,!s)throw Error(c(454));return s;default:throw Error(c(451))}}function $i(s){for(var t=s.attributes;t.length;)s.removeAttributeNode(t[0]);Nd(s)}var Xa=new Map,lg=new Set;function No(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Rl=Q.d;Q.d={f:E0,r:M0,D:A0,C:z0,L:R0,m:D0,X:L0,S:O0,M:U0};function E0(){var s=Rl.f(),t=uo();return s||t}function M0(s){var t=nr(s);t!==null&&t.tag===5&&t.type==="form"?bf(t):Rl.r(s)}var Ur=typeof document>"u"?null:document;function ng(s,t,n){var i=Ur;if(i&&typeof t=="string"&&t){var o=Ha(t);o='link[rel="'+s+'"][href="'+o+'"]',typeof n=="string"&&(o+='[crossorigin="'+n+'"]'),lg.has(o)||(lg.add(o),s={rel:s,crossOrigin:n,href:t},i.querySelector(o)===null&&(t=i.createElement("link"),ta(t,"link",s),Kt(t),i.head.appendChild(t)))}}function A0(s){Rl.D(s),ng("dns-prefetch",s,null)}function z0(s,t){Rl.C(s,t),ng("preconnect",s,t)}function R0(s,t,n){Rl.L(s,t,n);var i=Ur;if(i&&s&&t){var o='link[rel="preload"][as="'+Ha(t)+'"]';t==="image"&&n&&n.imageSrcSet?(o+='[imagesrcset="'+Ha(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(o+='[imagesizes="'+Ha(n.imageSizes)+'"]')):o+='[href="'+Ha(s)+'"]';var x=o;switch(t){case"style":x=$r(s);break;case"script":x=Br(s)}Xa.has(x)||(s=j({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:s,as:t},n),Xa.set(x,s),i.querySelector(o)!==null||t==="style"&&i.querySelector(Bi(x))||t==="script"&&i.querySelector(Pi(x))||(t=i.createElement("link"),ta(t,"link",s),Kt(t),i.head.appendChild(t)))}}function D0(s,t){Rl.m(s,t);var n=Ur;if(n&&s){var i=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ha(i)+'"][href="'+Ha(s)+'"]',x=o;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Br(s)}if(!Xa.has(x)&&(s=j({rel:"modulepreload",href:s},t),Xa.set(x,s),n.querySelector(o)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Pi(x)))return}i=n.createElement("link"),ta(i,"link",s),Kt(i),n.head.appendChild(i)}}}function O0(s,t,n){Rl.S(s,t,n);var i=Ur;if(i&&s){var o=rr(i).hoistableStyles,x=$r(s);t=t||"default";var v=o.get(x);if(!v){var k={loading:0,preload:null};if(v=i.querySelector(Bi(x)))k.loading=5;else{s=j({rel:"stylesheet",href:s,"data-precedence":t},n),(n=Xa.get(x))&&vm(s,n);var P=v=i.createElement("link");Kt(P),ta(P,"link",s),P._p=new Promise(function(ie,ve){P.onload=ie,P.onerror=ve}),P.addEventListener("load",function(){k.loading|=1}),P.addEventListener("error",function(){k.loading|=2}),k.loading|=4,bo(v,t,i)}v={type:"stylesheet",instance:v,count:1,state:k},o.set(x,v)}}}function L0(s,t){Rl.X(s,t);var n=Ur;if(n&&s){var i=rr(n).hoistableScripts,o=Br(s),x=i.get(o);x||(x=n.querySelector(Pi(o)),x||(s=j({src:s,async:!0},t),(t=Xa.get(o))&&Nm(s,t),x=n.createElement("script"),Kt(x),ta(x,"link",s),n.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function U0(s,t){Rl.M(s,t);var n=Ur;if(n&&s){var i=rr(n).hoistableScripts,o=Br(s),x=i.get(o);x||(x=n.querySelector(Pi(o)),x||(s=j({src:s,async:!0,type:"module"},t),(t=Xa.get(o))&&Nm(s,t),x=n.createElement("script"),Kt(x),ta(x,"link",s),n.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function rg(s,t,n,i){var o=(o=z.current)?No(o):null;if(!o)throw Error(c(446));switch(s){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=$r(n.href),n=rr(o).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){s=$r(n.href);var x=rr(o).hoistableStyles,v=x.get(s);if(v||(o=o.ownerDocument||o,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,v),(x=o.querySelector(Bi(s)))&&!x._p&&(v.instance=x,v.state.loading=5),Xa.has(s)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Xa.set(s,n),x||$0(o,s,n,v.state))),t&&i===null)throw Error(c(528,""));return v}if(t&&i!==null)throw Error(c(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Br(n),n=rr(o).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,s))}}function $r(s){return'href="'+Ha(s)+'"'}function Bi(s){return'link[rel="stylesheet"]['+s+"]"}function ig(s){return j({},s,{"data-precedence":s.precedence,precedence:null})}function $0(s,t,n,i){s.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=s.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),ta(t,"link",n),Kt(t),s.head.appendChild(t))}function Br(s){return'[src="'+Ha(s)+'"]'}function Pi(s){return"script[async]"+s}function cg(s,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=s.querySelector('style[data-href~="'+Ha(n.href)+'"]');if(i)return t.instance=i,Kt(i),i;var o=j({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(s.ownerDocument||s).createElement("style"),Kt(i),ta(i,"style",o),bo(i,n.precedence,s),t.instance=i;case"stylesheet":o=$r(n.href);var x=s.querySelector(Bi(o));if(x)return t.state.loading|=4,t.instance=x,Kt(x),x;i=ig(n),(o=Xa.get(o))&&vm(i,o),x=(s.ownerDocument||s).createElement("link"),Kt(x);var v=x;return v._p=new Promise(function(k,P){v.onload=k,v.onerror=P}),ta(x,"link",i),t.state.loading|=4,bo(x,n.precedence,s),t.instance=x;case"script":return x=Br(n.src),(o=s.querySelector(Pi(x)))?(t.instance=o,Kt(o),o):(i=n,(o=Xa.get(x))&&(i=j({},n),Nm(i,o)),s=s.ownerDocument||s,o=s.createElement("script"),Kt(o),ta(o,"link",i),s.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(c(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,bo(i,n.precedence,s));return t.instance}function bo(s,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=i.length?i[i.length-1]:null,x=o,v=0;v<i.length;v++){var k=i[v];if(k.dataset.precedence===t)x=k;else if(x!==o)break}x?x.parentNode.insertBefore(s,x.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(s,t.firstChild))}function vm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.title==null&&(s.title=t.title)}function Nm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.integrity==null&&(s.integrity=t.integrity)}var yo=null;function og(s,t,n){if(yo===null){var i=new Map,o=yo=new Map;o.set(n,i)}else o=yo,i=o.get(n),i||(i=new Map,o.set(n,i));if(i.has(s))return i;for(i.set(s,null),n=n.getElementsByTagName(s),o=0;o<n.length;o++){var x=n[o];if(!(x[Cn]||x[_s]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var v=x.getAttribute(t)||"";v=s+v;var k=i.get(v);k?k.push(x):i.set(v,[x])}}return i}function dg(s,t,n){s=s.ownerDocument||s,s.head.insertBefore(n,t==="title"?s.querySelector("head > title"):null)}function B0(s,t,n){if(n===1||t.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return s=t.disabled,typeof t.precedence=="string"&&s==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ug(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function P0(s,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var o=$r(i.href),x=t.querySelector(Bi(o));if(x){t=x._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(s.count++,s=wo.bind(s),t.then(s,s)),n.state.loading|=4,n.instance=x,Kt(x);return}x=t.ownerDocument||t,i=ig(i),(o=Xa.get(o))&&vm(i,o),x=x.createElement("link"),Kt(x);var v=x;v._p=new Promise(function(k,P){v.onload=k,v.onerror=P}),ta(x,"link",i),n.instance=x}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(s.count++,n=wo.bind(s),t.addEventListener("load",n),t.addEventListener("error",n))}}var bm=0;function I0(s,t){return s.stylesheets&&s.count===0&&So(s,s.stylesheets),0<s.count||0<s.imgCount?function(n){var i=setTimeout(function(){if(s.stylesheets&&So(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4+t);0<s.imgBytes&&bm===0&&(bm=62500*b0());var o=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&So(s,s.stylesheets),s.unsuspend)){var x=s.unsuspend;s.unsuspend=null,x()}},(s.imgBytes>bm?50:800)+t);return s.unsuspend=n,function(){s.unsuspend=null,clearTimeout(i),clearTimeout(o)}}:null}function wo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)So(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var _o=null;function So(s,t){s.stylesheets=null,s.unsuspend!==null&&(s.count++,_o=new Map,t.forEach(F0,s),_o=null,wo.call(s))}function F0(s,t){if(!(t.state.loading&4)){var n=_o.get(s);if(n)var i=n.get(null);else{n=new Map,_o.set(s,n);for(var o=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<o.length;x++){var v=o[x];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(n.set(v.dataset.precedence,v),i=v)}i&&n.set(null,i)}o=t.instance,v=o.getAttribute("data-precedence"),x=n.get(v)||i,x===i&&n.set(null,o),n.set(v,o),this.count++,i=wo.bind(this),o.addEventListener("load",i),o.addEventListener("error",i),x?x.parentNode.insertBefore(o,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(o,s.firstChild)),t.state.loading|=4}}var Ii={$$typeof:E,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function H0(s,t,n,i,o,x,v,k,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ye(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ye(0),this.hiddenUpdates=ye(null),this.identifierPrefix=i,this.onUncaughtError=o,this.onCaughtError=x,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function mg(s,t,n,i,o,x,v,k,P,ie,ve,we){return s=new H0(s,t,n,v,P,ie,ve,we,k),t=1,x===!0&&(t|=24),x=Ta(3,null,null,t),s.current=x,x.stateNode=s,t=eu(),t.refCount++,s.pooledCache=t,t.refCount++,x.memoizedState={element:i,isDehydrated:n,cache:t},lu(x),s}function xg(s){return s?(s=pr,s):pr}function hg(s,t,n,i,o,x){o=xg(o),i.context===null?i.context=o:i.pendingContext=o,i=Xl(t),i.payload={element:n},x=x===void 0?null:x,x!==null&&(i.callback=x),n=Zl(s,i,t),n!==null&&(ya(n,s,t),vi(n,s,t))}function fg(s,t){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var n=s.retryLane;s.retryLane=n!==0&&n<t?n:t}}function ym(s,t){fg(s,t),(s=s.alternate)&&fg(s,t)}function pg(s){if(s.tag===13||s.tag===31){var t=zn(s,67108864);t!==null&&ya(t,s,67108864),ym(s,67108864)}}function gg(s){if(s.tag===13||s.tag===31){var t=Ra();t=Ct(t);var n=zn(s,t);n!==null&&ya(n,s,t),ym(s,t)}}var ko=!0;function q0(s,t,n,i){var o=D.T;D.T=null;var x=Q.p;try{Q.p=2,wm(s,t,n,i)}finally{Q.p=x,D.T=o}}function V0(s,t,n,i){var o=D.T;D.T=null;var x=Q.p;try{Q.p=8,wm(s,t,n,i)}finally{Q.p=x,D.T=o}}function wm(s,t,n,i){if(ko){var o=_m(i);if(o===null)om(s,t,i,Co,n),vg(s,i);else if(K0(o,s,t,n,i))i.stopPropagation();else if(vg(s,i),t&4&&-1<G0.indexOf(s)){for(;o!==null;){var x=nr(o);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var v=Ht(x.pendingLanes);if(v!==0){var k=x;for(k.pendingLanes|=2,k.entangledLanes|=2;v;){var P=1<<31-ws(v);k.entanglements[1]|=P,v&=~P}xl(x),(Ys&6)===0&&(co=$s()+500,Oi(0))}}break;case 31:case 13:k=zn(x,2),k!==null&&ya(k,x,2),uo(),ym(x,2)}if(x=_m(i),x===null&&om(s,t,i,Co,n),x===o)break;o=x}o!==null&&i.stopPropagation()}else om(s,t,i,null,n)}}function _m(s){return s=kd(s),Sm(s)}var Co=null;function Sm(s){if(Co=null,s=lr(s),s!==null){var t=m(s);if(t===null)s=null;else{var n=t.tag;if(n===13){if(s=h(t),s!==null)return s;s=null}else if(n===31){if(s=f(t),s!==null)return s;s=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;s=null}else t!==s&&(s=null)}}return Co=s,null}function jg(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(q()){case He:return 2;case Ke:return 8;case Ze:case Ts:return 32;case as:return 268435456;default:return 32}default:return 32}}var km=!1,dn=null,un=null,mn=null,Fi=new Map,Hi=new Map,xn=[],G0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vg(s,t){switch(s){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":un=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":Fi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hi.delete(t.pointerId)}}function qi(s,t,n,i,o,x){return s===null||s.nativeEvent!==x?(s={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:x,targetContainers:[o]},t!==null&&(t=nr(t),t!==null&&pg(t)),s):(s.eventSystemFlags|=i,t=s.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),s)}function K0(s,t,n,i,o){switch(t){case"focusin":return dn=qi(dn,s,t,n,i,o),!0;case"dragenter":return un=qi(un,s,t,n,i,o),!0;case"mouseover":return mn=qi(mn,s,t,n,i,o),!0;case"pointerover":var x=o.pointerId;return Fi.set(x,qi(Fi.get(x)||null,s,t,n,i,o)),!0;case"gotpointercapture":return x=o.pointerId,Hi.set(x,qi(Hi.get(x)||null,s,t,n,i,o)),!0}return!1}function Ng(s){var t=lr(s.target);if(t!==null){var n=m(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){s.blockedOn=t,fe(s.priority,function(){gg(n)});return}}else if(t===31){if(t=f(n),t!==null){s.blockedOn=t,fe(s.priority,function(){gg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){s.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}s.blockedOn=null}function To(s){if(s.blockedOn!==null)return!1;for(var t=s.targetContainers;0<t.length;){var n=_m(s.nativeEvent);if(n===null){n=s.nativeEvent;var i=new n.constructor(n.type,n);Sd=i,n.target.dispatchEvent(i),Sd=null}else return t=nr(n),t!==null&&pg(t),s.blockedOn=n,!1;t.shift()}return!0}function bg(s,t,n){To(s)&&n.delete(t)}function Q0(){km=!1,dn!==null&&To(dn)&&(dn=null),un!==null&&To(un)&&(un=null),mn!==null&&To(mn)&&(mn=null),Fi.forEach(bg),Hi.forEach(bg)}function Eo(s,t){s.blockedOn===t&&(s.blockedOn=null,km||(km=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Q0)))}var Mo=null;function yg(s){Mo!==s&&(Mo=s,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Mo===s&&(Mo=null);for(var t=0;t<s.length;t+=3){var n=s[t],i=s[t+1],o=s[t+2];if(typeof i!="function"){if(Sm(i||n)===null)continue;break}var x=nr(n);x!==null&&(s.splice(t,3),t-=3,_u(x,{pending:!0,data:o,method:n.method,action:i},i,o))}}))}function Pr(s){function t(P){return Eo(P,s)}dn!==null&&Eo(dn,s),un!==null&&Eo(un,s),mn!==null&&Eo(mn,s),Fi.forEach(t),Hi.forEach(t);for(var n=0;n<xn.length;n++){var i=xn[n];i.blockedOn===s&&(i.blockedOn=null)}for(;0<xn.length&&(n=xn[0],n.blockedOn===null);)Ng(n),n.blockedOn===null&&xn.shift();if(n=(s.ownerDocument||s).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var o=n[i],x=n[i+1],v=o[ms]||null;if(typeof x=="function")v||yg(n);else if(v){var k=null;if(x&&x.hasAttribute("formAction")){if(o=x,v=x[ms]||null)k=v.formAction;else if(Sm(o)!==null)continue}else k=v.action;typeof k=="function"?n[i+1]=k:(n.splice(i,3),i-=3),yg(n)}}}function wg(){function s(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(v){return o=v})},focusReset:"manual",scroll:"manual"})}function t(){o!==null&&(o(),o=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,o=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),o!==null&&(o(),o=null)}}}function Cm(s){this._internalRoot=s}Ao.prototype.render=Cm.prototype.render=function(s){var t=this._internalRoot;if(t===null)throw Error(c(409));var n=t.current,i=Ra();hg(n,i,s,t,null,null)},Ao.prototype.unmount=Cm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var t=s.containerInfo;hg(s.current,2,null,s,null,null),uo(),t[_t]=null}};function Ao(s){this._internalRoot=s}Ao.prototype.unstable_scheduleHydration=function(s){if(s){var t=ne();s={blockedOn:null,target:s,priority:t};for(var n=0;n<xn.length&&t!==0&&t<xn[n].priority;n++);xn.splice(n,0,s),n===0&&Ng(s)}};var _g=l.version;if(_g!=="19.2.1")throw Error(c(527,_g,"19.2.1"));Q.findDOMNode=function(s){var t=s._reactInternals;if(t===void 0)throw typeof s.render=="function"?Error(c(188)):(s=Object.keys(s).join(","),Error(c(268,s)));return s=g(t),s=s!==null?N(s):null,s=s===null?null:s.stateNode,s};var Y0={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zo.isDisabled&&zo.supportsFiber)try{Is=zo.inject(Y0),ds=zo}catch{}}return Vi.createRoot=function(s,t){if(!d(s))throw Error(c(299));var n=!1,i="",o=Af,x=zf,v=Rf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(x=t.onCaughtError),t.onRecoverableError!==void 0&&(v=t.onRecoverableError)),t=mg(s,1,!1,null,null,n,i,null,o,x,v,wg),s[_t]=t.current,cm(s),new Cm(t)},Vi.hydrateRoot=function(s,t,n){if(!d(s))throw Error(c(299));var i=!1,o="",x=Af,v=zf,k=Rf,P=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(x=n.onUncaughtError),n.onCaughtError!==void 0&&(v=n.onCaughtError),n.onRecoverableError!==void 0&&(k=n.onRecoverableError),n.formState!==void 0&&(P=n.formState)),t=mg(s,1,!0,t,n??null,i,o,P,x,v,k,wg),t.context=xg(null),n=t.current,i=Ra(),i=Ct(i),o=Xl(i),o.callback=null,Zl(n,o,i),n=i,t.current.lanes=n,U(t,n),xl(t),s[_t]=t.current,cm(s),new Ao(t)},Vi.version="19.2.1",Vi}var zg;function A_(){if(zg)return zm.exports;zg=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(l){console.error(l)}}return a(),zm.exports=M_(),zm.exports}var z_=A_();function F(...a){return cw(ow(a))}const Ce=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("rounded-xl border bg-card text-card-foreground shadow",a),...l}));Ce.displayName="Card";const Oe=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("flex flex-col space-y-1.5 p-6",a),...l}));Oe.displayName="CardHeader";const $e=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("font-semibold leading-none tracking-tight",a),...l}));$e.displayName="CardTitle";const Ns=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("text-sm text-muted-foreground",a),...l}));Ns.displayName="CardDescription";const ze=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("p-6 pt-0",a),...l}));ze.displayName="CardContent";const id=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("flex items-center p-6 pt-0",a),...l}));id.displayName="CardFooter";const Jt=uw,Gt=u.forwardRef(({className:a,...l},r)=>e.jsx(dj,{ref:r,className:F("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...l}));Gt.displayName=dj.displayName;const Ye=u.forwardRef(({className:a,...l},r)=>e.jsx(uj,{ref:r,className:F("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...l}));Ye.displayName=uj.displayName;const Cs=u.forwardRef(({className:a,...l},r)=>e.jsx(mj,{ref:r,className:F("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 data-[state=active]:animate-in data-[state=active]:fade-in data-[state=active]:duration-300",a),...l}));Cs.displayName=mj.displayName;const ts=u.forwardRef(({className:a,children:l,viewportRef:r,...c},d)=>e.jsxs(xj,{ref:d,className:F("relative overflow-hidden",a),...c,children:[e.jsx(mw,{ref:r,className:"h-full w-full rounded-[inherit]",children:l}),e.jsx(Ym,{}),e.jsx(Ym,{orientation:"horizontal"}),e.jsx(xw,{})]}));ts.displayName=xj.displayName;const Ym=u.forwardRef(({className:a,orientation:l="vertical",...r},c)=>e.jsx(hj,{ref:c,orientation:l,className:F("flex touch-none select-none transition-colors",l==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",l==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...r,children:e.jsx(hw,{className:"relative flex-1 rounded-full bg-border"})}));Ym.displayName=hj.displayName;function Ms({className:a,...l}){return e.jsx("div",{className:F("animate-pulse rounded-md bg-primary/10",a),...l})}const er=u.forwardRef(({className:a,value:l,...r},c)=>e.jsx(fj,{ref:c,className:F("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...r,children:e.jsx(fw,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(l||0)}%)`}})}));er.displayName=fj.displayName;async function Se(a,l){const c=l?.body instanceof FormData?{...l?.headers}:{"Content-Type":"application/json",...l?.headers},d={...l,credentials:"include",headers:c},m=await fetch(a,d);if(m.status===401)throw window.location.href="/auth",new Error("");return m}function Zs(){return{"Content-Type":"application/json"}}async function R_(){try{await fetch("/api/webui/auth/logout",{method:"POST",credentials:"include"})}catch(a){console.error(":",a)}window.location.href="/auth"}async function cc(){try{return(await(await fetch("/api/webui/auth/check",{method:"GET",credentials:"include"})).json()).authenticated===!0}catch{return!1}}const D_={light:"",dark:".dark"},Cv=u.createContext(null);function Tv(){const a=u.useContext(Cv);if(!a)throw new Error("useChart must be used within a <ChartContainer />");return a}const Vr=u.forwardRef(({id:a,className:l,children:r,config:c,...d},m)=>{const h=u.useId(),f=`chart-${a||h.replace(/:/g,"")}`;return e.jsx(Cv.Provider,{value:{config:c},children:e.jsxs("div",{"data-chart":f,ref:m,className:F("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...d,children:[e.jsx(O_,{id:f,config:c}),e.jsx(Rj,{children:r})]})})});Vr.displayName="Chart";const O_=({id:a,config:l})=>{const r=Object.entries(l).filter(([,c])=>c.theme||c.color);return r.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(D_).map(([c,d])=>`
${d} [data-chart=${a}] {
${r.map(([m,h])=>{const f=h.theme?.[c]||h.color;return f?`  --color-${m}: ${f};`:null}).join(`
`)}
}
`).join(`
`)}}):null},Gi=Dj,Gr=u.forwardRef(({active:a,payload:l,className:r,indicator:c="dot",hideLabel:d=!1,hideIndicator:m=!1,label:h,labelFormatter:f,labelClassName:p,formatter:g,color:N,nameKey:j,labelKey:b},y)=>{const{config:w}=Tv(),A=u.useMemo(()=>{if(d||!l?.length)return null;const[S]=l,I=`${b||S?.dataKey||S?.name||"value"}`,E=Jm(w,S,I),C=!b&&typeof h=="string"?w[h]?.label||h:E?.label;return f?e.jsx("div",{className:F("font-medium",p),children:f(C,l)}):C?e.jsx("div",{className:F("font-medium",p),children:C}):null},[h,f,l,d,p,w,b]);if(!a||!l?.length)return null;const M=l.length===1&&c!=="dot";return e.jsxs("div",{ref:y,className:F("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[M?null:A,e.jsx("div",{className:"grid gap-1.5",children:l.filter(S=>S.type!=="none").map((S,I)=>{const E=`${j||S.name||S.dataKey||"value"}`,C=Jm(w,S,E),R=N||S.payload.fill||S.color;return e.jsx("div",{className:F("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",c==="dot"&&"items-center"),children:g&&S?.value!==void 0&&S.name?g(S.value,S.name,S,I,S.payload):e.jsxs(e.Fragment,{children:[C?.icon?e.jsx(C.icon,{}):!m&&e.jsx("div",{className:F("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":c==="dot","w-1":c==="line","w-0 border-[1.5px] border-dashed bg-transparent":c==="dashed","my-0.5":M&&c==="dashed"}),style:{"--color-bg":R,"--color-border":R}}),e.jsxs("div",{className:F("flex flex-1 justify-between leading-none",M?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[M?A:null,e.jsx("span",{className:"text-muted-foreground",children:C?.label||S.name})]}),S.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:S.value.toLocaleString()})]})]})},S.dataKey)})})]})});Gr.displayName="ChartTooltip";const L_=Kw,Ev=u.forwardRef(({className:a,hideIcon:l=!1,payload:r,verticalAlign:c="bottom",nameKey:d},m)=>{const{config:h}=Tv();return r?.length?e.jsx("div",{ref:m,className:F("flex items-center justify-center gap-4",c==="top"?"pb-3":"pt-3",a),children:r.filter(f=>f.type!=="none").map(f=>{const p=`${d||f.dataKey||"value"}`,g=Jm(h,f,p);return e.jsxs("div",{className:F("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[g?.icon&&!l?e.jsx(g.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:f.color}}),g?.label]},f.value)})}):null});Ev.displayName="ChartLegend";function Jm(a,l,r){if(typeof l!="object"||l===null)return;const c="payload"in l&&typeof l.payload=="object"&&l.payload!==null?l.payload:void 0;let d=r;return r in l&&typeof l[r]=="string"?d=l[r]:c&&r in c&&typeof c[r]=="string"&&(d=c[r]),d in a?a[d]:a[r]}const Wr=ei("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_=u.forwardRef(({className:a,variant:l,size:r,asChild:c=!1,...d},m)=>{const h=c?Ww:"button";return e.jsx(h,{className:F(Wr({variant:l,size:r,className:a})),ref:m,...d})});_.displayName="Button";const U_=ei("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ke({className:a,variant:l,...r}){return e.jsx("div",{className:F(U_({variant:l}),a),...r})}async function $_(){const a=await Se("/api/webui/system/restart",{method:"POST",headers:Zs()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return await a.json()}async function B_(){const a=await Se("/api/webui/system/status",{method:"GET",headers:Zs()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return await a.json()}const Ir={INITIAL_DELAY:3e3,CHECK_INTERVAL:2e3,CHECK_TIMEOUT:3e3,MAX_ATTEMPTS:60,PROGRESS_INTERVAL:200,SUCCESS_REDIRECT_DELAY:1500},Mv=u.createContext(null);function tr({children:a,onRestartComplete:l,onRestartFailed:r,healthCheckUrl:c="/api/webui/system/status",maxAttempts:d=Ir.MAX_ATTEMPTS}){const[m,h]=u.useState({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),f=u.useRef({}),p=u.useCallback(()=>{const A=f.current;A.progress&&(clearInterval(A.progress),A.progress=void 0),A.elapsed&&(clearInterval(A.elapsed),A.elapsed=void 0),A.check&&(clearTimeout(A.check),A.check=void 0)},[]),g=u.useCallback(()=>{p(),h({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d})},[p,d]),N=u.useCallback(async()=>{try{const A=new AbortController,M=setTimeout(()=>A.abort(),Ir.CHECK_TIMEOUT),S=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include",signal:A.signal});return clearTimeout(M),S.ok}catch{return!1}},[c]),j=u.useCallback(()=>{let A=0;const M=async()=>{if(A++,h(I=>({...I,status:"checking",checkAttempts:A})),await N())p(),h(I=>({...I,status:"success",progress:100})),setTimeout(()=>{l?.(),window.location.href="/auth"},Ir.SUCCESS_REDIRECT_DELAY);else if(A>=d){p();const I=` (${A}/${d})`;h(E=>({...E,status:"failed",error:I})),r?.(I)}else{const I=setTimeout(M,Ir.CHECK_INTERVAL);f.current.check=I}};M()},[N,p,d,l,r]),b=u.useCallback(()=>{h(A=>({...A,status:"checking",checkAttempts:0,error:void 0})),j()},[j]),y=u.useCallback(async A=>{const{delay:M=0,skipApiCall:S=!1}=A??{};if(m.status!=="idle"&&m.status!=="failed")return;if(p(),h({status:"requesting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),M>0&&await new Promise(C=>setTimeout(C,M)),S)h(C=>({...C,status:"restarting"}));else try{h(C=>({...C,status:"restarting"})),await Promise.race([$_(),new Promise(C=>setTimeout(C,5e3))])}catch{}const I=setInterval(()=>{h(C=>({...C,progress:C.progress>=90?C.progress:C.progress+1}))},Ir.PROGRESS_INTERVAL),E=setInterval(()=>{h(C=>({...C,elapsedTime:C.elapsedTime+1}))},1e3);f.current.progress=I,f.current.elapsed=E,setTimeout(()=>{j()},Ir.INITIAL_DELAY)},[m.status,p,d,j]),w={state:m,isRestarting:m.status!=="idle",triggerRestart:y,resetState:g,retryHealthCheck:b};return e.jsx(Mv.Provider,{value:w,children:a})}function _n(){const a=u.useContext(Mv);if(!a)throw new Error("useRestart must be used within a RestartProvider");return a}function P_(){try{return _n()}catch{return null}}const I_=(a,l,r,c,d)=>({idle:{icon:null,title:"",description:"",tip:""},requesting:{icon:e.jsx(Fs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},restarting:{icon:e.jsx(Fs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},checking:{icon:e.jsx(Fs,{className:"h-16 w-16 text-primary animate-spin"}),title:"",description:`... (${l}/${r})`,tip:" ..."},success:{icon:e.jsx(st,{className:"h-16 w-16 text-green-500"}),title:"",description:"...",tip:" "},failed:{icon:e.jsx(Rt,{className:"h-16 w-16 text-destructive"}),title:"",description:"",tip:" "}})[a];function ar({visible:a,onComplete:l,onFailed:r,title:c,description:d,showAnimation:m=!0,className:h}){const f=P_();return(f?f.isRestarting:a)?f?e.jsx(Av,{state:f.state,onRetry:f.retryHealthCheck,onComplete:l,onFailed:r,title:c,description:d,showAnimation:m,className:h}):e.jsx(F_,{onComplete:l,onFailed:r,title:c,description:d,showAnimation:m,className:h}):null}function Av({state:a,onRetry:l,onComplete:r,onFailed:c,title:d,description:m,showAnimation:h,className:f}){const{status:p,progress:g,elapsedTime:N,checkAttempts:j,maxAttempts:b}=a;u.useEffect(()=>{p==="success"&&r?r():p==="failed"&&c&&c()},[p,r,c]);const y=I_(p,j,b,d,m),w=A=>{const M=Math.floor(A/60),S=A%60;return`${M}:${S.toString().padStart(2,"0")}`};return e.jsxs("div",{className:F("fixed inset-0 bg-background/95 backdrop-blur-sm z-50 flex items-center justify-center",f),children:[h&&e.jsx(H_,{}),e.jsxs("div",{className:"max-w-md w-full mx-4 space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[y.icon,(p==="restarting"||p==="checking")&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/20 animate-ping"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:y.title}),e.jsx("p",{className:"text-muted-foreground text-center",children:y.description})]}),p!=="failed"&&p!=="idle"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(er,{value:g,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[g,"%"]}),e.jsxs("span",{children:[": ",w(N)]})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:y.tip})}),p==="failed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{onClick:()=>window.location.reload(),variant:"default",className:"flex-1",children:[e.jsx(mt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:l,variant:"secondary",className:"flex-1",children:[e.jsx(lc,{className:"mr-2 h-4 w-4"}),""]})]})]})]})}function F_({onComplete:a,onFailed:l,title:r,description:c,showAnimation:d,className:m}){const[h,f]=u.useState({status:"restarting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:60}),p=u.useCallback(()=>{let g=0;const N=60,j=async()=>{g++,f(b=>({...b,status:"checking",checkAttempts:g}));try{if((await fetch("/api/webui/system/status",{method:"GET",signal:AbortSignal.timeout(3e3)})).ok){f(y=>({...y,status:"success",progress:100})),setTimeout(()=>{a?.(),window.location.href="/auth"},1500);return}}catch{}g>=N?(f(b=>({...b,status:"failed"})),l?.()):setTimeout(j,2e3)};j()},[a,l]);return u.useEffect(()=>{const g=setInterval(()=>{f(b=>({...b,progress:b.progress>=90?b.progress:b.progress+1}))},200),N=setInterval(()=>{f(b=>({...b,elapsedTime:b.elapsedTime+1}))},1e3),j=setTimeout(()=>{p()},3e3);return()=>{clearInterval(g),clearInterval(N),clearTimeout(j)}},[p]),e.jsx(Av,{state:h,onRetry:p,onComplete:a,onFailed:l,title:r,description:c,showAnimation:d,className:m})}function H_(){return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite]"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_0.5s]"}),e.jsx("div",{className:"absolute inset-16 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_1s]"})]}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-bounce"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-primary/15 rounded-full animate-bounce delay-150"}),e.jsx("div",{className:"absolute top-1/2 right-1/3 w-2 h-2 bg-primary/20 rounded-full animate-bounce delay-300"})]})}const Qs=t1,cd=a1,q_=e1,zv=u.forwardRef(({className:a,...l},r)=>e.jsx(Oj,{ref:r,className:F("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l}));zv.displayName=Oj.displayName;const Hs=u.forwardRef(({className:a,children:l,preventOutsideClose:r=!1,hideCloseButton:c=!1,...d},m)=>e.jsxs(q_,{children:[e.jsx(zv,{}),e.jsxs(Lj,{ref:m,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),onPointerDownOutside:r?h=>h.preventDefault():void 0,onInteractOutside:r?h=>h.preventDefault():void 0,...d,children:[l,!c&&e.jsxs(s1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Sa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Hs.displayName=Lj.displayName;const qs=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col space-y-1.5 text-center sm:text-left",a),...l});qs.displayName="DialogHeader";const ft=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...l});ft.displayName="DialogFooter";const Vs=u.forwardRef(({className:a,...l},r)=>e.jsx(Uj,{ref:r,className:F("text-lg font-semibold leading-none tracking-tight",a),...l}));Vs.displayName=Uj.displayName;const at=u.forwardRef(({className:a,...l},r)=>e.jsx($j,{ref:r,className:F("text-sm text-muted-foreground",a),...l}));at.displayName=$j.displayName;const le=u.forwardRef(({className:a,type:l,...r},c)=>e.jsx("input",{type:l,className:F("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:c,...r}));le.displayName="Input";const tt=u.forwardRef(({className:a,...l},r)=>e.jsx(Bj,{ref:r,className:F("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:e.jsx(l1,{className:F("grid place-content-center text-current"),children:e.jsx(Lt,{className:"h-4 w-4"})})}));tt.displayName=Bj.displayName;const Ie=d1,Fe=u1,Be=u.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(Pj,{ref:c,className:F("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[l,e.jsx(n1,{asChild:!0,children:e.jsx($a,{className:"h-4 w-4 opacity-50"})})]}));Be.displayName=Pj.displayName;const Rv=u.forwardRef(({className:a,...l},r)=>e.jsx(Ij,{ref:r,className:F("flex cursor-default items-center justify-center py-1",a),...l,children:e.jsx(Yr,{className:"h-4 w-4"})}));Rv.displayName=Ij.displayName;const Dv=u.forwardRef(({className:a,...l},r)=>e.jsx(Fj,{ref:r,className:F("flex cursor-default items-center justify-center py-1",a),...l,children:e.jsx($a,{className:"h-4 w-4"})}));Dv.displayName=Fj.displayName;const Pe=u.forwardRef(({className:a,children:l,position:r="popper",...c},d)=>e.jsx(r1,{children:e.jsxs(Hj,{ref:d,className:F("relative z-[100] max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-hidden rounded-md border border-border bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...c,children:[e.jsx(Rv,{}),e.jsx(i1,{className:F("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),e.jsx(Dv,{})]})}));Pe.displayName=Hj.displayName;const V_=u.forwardRef(({className:a,...l},r)=>e.jsx(qj,{ref:r,className:F("px-2 py-1.5 text-sm font-semibold",a),...l}));V_.displayName=qj.displayName;const Z=u.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(Vj,{ref:c,className:F("relative flex w-full cursor-default select-none items-center rounded-sm py-2 pl-2 pr-8 text-sm outline-none bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-gray-100 dark:focus:bg-gray-800 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(c1,{children:e.jsx(Lt,{className:"h-4 w-4"})})}),e.jsx(o1,{children:l})]}));Z.displayName=Vj.displayName;const G_=u.forwardRef(({className:a,...l},r)=>e.jsx(Gj,{ref:r,className:F("-mx-1 my-1 h-px bg-muted",a),...l}));G_.displayName=Gj.displayName;const mx=({className:a,...l})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:F("mx-auto flex w-full justify-center",a),...l});mx.displayName="Pagination";const xx=u.forwardRef(({className:a,...l},r)=>e.jsx("ul",{ref:r,className:F("flex flex-row items-center gap-1",a),...l}));xx.displayName="PaginationContent";const Yn=u.forwardRef(({className:a,...l},r)=>e.jsx("li",{ref:r,className:F("",a),...l}));Yn.displayName="PaginationItem";const pc=({className:a,isActive:l,size:r="icon",...c})=>e.jsx("a",{"aria-current":l?"page":void 0,className:F(Wr({variant:l?"outline":"ghost",size:r}),a),...c});pc.displayName="PaginationLink";const Ov=({className:a,...l})=>e.jsxs(pc,{"aria-label":"Go to previous page",size:"default",className:F("gap-1 pl-2.5",a),...l,children:[e.jsx(Pa,{className:"h-4 w-4"}),e.jsx("span",{children:""})]});Ov.displayName="PaginationPrevious";const Lv=({className:a,...l})=>e.jsxs(pc,{"aria-label":"Go to next page",size:"default",className:F("gap-1 pr-2.5",a),...l,children:[e.jsx("span",{children:""}),e.jsx(ia,{className:"h-4 w-4"})]});Lv.displayName="PaginationNext";const Uv=({className:a,...l})=>e.jsxs("span",{"aria-hidden":!0,className:F("flex h-9 w-9 items-center justify-center",a),...l,children:[e.jsx(y1,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});Uv.displayName="PaginationEllipsis";const K_=5,Q_=5e3;let Om=0;function Y_(){return Om=(Om+1)%Number.MAX_SAFE_INTEGER,Om.toString()}const Lm=new Map,Rg=a=>{if(Lm.has(a))return;const l=setTimeout(()=>{Lm.delete(a),sc({type:"REMOVE_TOAST",toastId:a})},Q_);Lm.set(a,l)},J_=(a,l)=>{switch(l.type){case"ADD_TOAST":return{...a,toasts:[l.toast,...a.toasts].slice(0,K_)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(r=>r.id===l.toast.id?{...r,...l.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=l;return r?Rg(r):a.toasts.forEach(c=>{Rg(c.id)}),{...a,toasts:a.toasts.map(c=>c.id===r||r===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return l.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(r=>r.id!==l.toastId)}}},Po=[];let Io={toasts:[]};function sc(a){Io=J_(Io,a),Po.forEach(l=>{l(Io)})}function la({...a}){const l=Y_(),r=d=>sc({type:"UPDATE_TOAST",toast:{...d,id:l}}),c=()=>sc({type:"DISMISS_TOAST",toastId:l});return sc({type:"ADD_TOAST",toast:{...a,id:l,open:!0,onOpenChange:d=>{d||c()}}}),{id:l,dismiss:c,update:r}}function nt(){const[a,l]=u.useState(Io);return u.useEffect(()=>(Po.push(l),()=>{const r=Po.indexOf(l);r>-1&&Po.splice(r,1)}),[a]),{...a,toast:la,dismiss:r=>sc({type:"DISMISS_TOAST",toastId:r})}}const cl="/api/webui/expression";async function hx(){const a=await Se(`${cl}/chats`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function X_(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id);const r=await Se(`${cl}/list?${l}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function Z_(a){const l=await Se(`${cl}/${a}`,{});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function W_(a){const l=await Se(`${cl}/`,{method:"POST",body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function e2(a,l){const r=await Se(`${cl}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function s2(a){const l=await Se(`${cl}/${a}`,{method:"DELETE"});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function t2(a){const l=await Se(`${cl}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function a2(){const a=await Se(`${cl}/stats/summary`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function fx(){const a=await Se(`${cl}/review/stats`);if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function Dg(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.filter_type&&l.append("filter_type",a.filter_type),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id);const r=await Se(`${cl}/review/list?${l}`);if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function Um(a){const l=await Se(`${cl}/review/batch`,{method:"POST",body:JSON.stringify({items:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function $v({open:a,onOpenChange:l}){const[r,c]=u.useState("list"),[d,m]=u.useState(null),[h,f]=u.useState([]),[p,g]=u.useState("unchecked"),[N,j]=u.useState([]),[b,y]=u.useState(0),[w,A]=u.useState(!1),[M,S]=u.useState(0),[I,E]=u.useState(1),[C,R]=u.useState(null),[H,O]=u.useState(0),[X,L]=u.useState(!1),[me,Ne]=u.useState(null),je=u.useRef(null),ce=u.useRef(null),ge=u.useRef(!1),[pe,D]=u.useState(!1),[Q,B]=u.useState(!1),[ue,Y]=u.useState(0),[_e,he]=u.useState(1),[Te,G]=u.useState(20),[$,z]=u.useState(""),[K,De]=u.useState("unchecked"),[se,Le]=u.useState(""),[rs,J]=u.useState(""),[W,Ue]=u.useState(new Set),[ae,Ee]=u.useState(new Set),[de,Re]=u.useState(new Map),{toast:ys}=nt(),Js=u.useCallback(async()=>{try{B(!0);const U=await fx();m(U)}catch(U){console.error(":",U)}finally{B(!1)}},[]),kt=u.useCallback(async()=>{try{D(!0);const U=await Dg({page:_e,page_size:Te,filter_type:K,search:se||void 0});f(U.data),Y(U.total)}catch(U){ys({title:"",description:U instanceof Error?U.message:"",variant:"destructive"})}finally{D(!1)}},[_e,Te,K,se,ys]),pa=u.useCallback(async()=>{try{const U=await hx();if(U?.data){const Me=new Map;U.data.forEach(Xe=>{Me.set(Xe.chat_id,Xe.chat_name)}),Re(Me)}}catch(U){console.error(":",U)}},[]),rt=u.useCallback(async(U=!0,Me=!1)=>{try{A(!0);const Xe=Me?I+1:I,us=await Dg({page:Xe,page_size:20,filter_type:p});Me?(j(cs=>[...cs,...us.data]),E(Xe)):j(us.data),S(us.total),U&&y(0)}catch(Xe){ys({title:"",description:Xe instanceof Error?Xe.message:"",variant:"destructive"})}finally{A(!1)}},[I,p,ys]);u.useEffect(()=>{r==="quick"&&(E(1),y(0))},[p,r]),u.useEffect(()=>{a&&r==="quick"&&(rt(),Js())},[a,r,I,p,rt,Js]);const $s=u.useCallback(U=>U?p==="unchecked"?{left:!0,right:!0}:p==="passed"?{left:!0,right:!1}:p==="rejected"?{left:!1,right:!0}:U.checked?U.rejected?{left:!1,right:!0}:{left:!0,right:!1}:{left:!0,right:!0}:{left:!1,right:!1},[p]),q=u.useCallback(async U=>{const Me=N[b];if(!Me||X)return;const Xe=$s(Me);if(!(U&&!Xe.left||!U&&!Xe.right)){L(!0),R(U?"left":"right"),O(U?-400:400);try{(await Um([{id:Me.id,rejected:U,require_unchecked:p==="unchecked"}])).results[0]?.success?(ys({title:U?"":"",description:` #${Me.id} ${U?"":""}`}),setTimeout(()=>{j(cs=>cs.filter((Ct,Bs)=>Bs!==b)),S(cs=>cs-1),b>=N.length-1&&y(Math.max(0,b-1)),R(null),O(0),L(!1),Js(),N.length<=1&&M>1&&rt(!1)},300)):(Ne(Me.id),ys({title:"",description:"...",variant:"destructive"}),setTimeout(()=>{Ne(null),R(null),O(0),L(!1),rt(!1),Js()},1500))}catch(us){ys({title:"",description:us instanceof Error?us.message:"",variant:"destructive"}),R(null),O(0),L(!1)}}},[N,b,X,$s,p,ys,Js,M,rt]),He=u.useCallback((U,Me)=>{X||(ce.current={x:U,y:Me},ge.current=!1)},[X]),Ke=u.useCallback(U=>{X||(L(!0),O(U==="left"?-30:30),setTimeout(()=>{O(0),setTimeout(()=>L(!1),300)},150))},[X]),Ze=u.useCallback(U=>{if(!ce.current||X)return;const Me=U-ce.current.x,Xe=N[b],us=$s(Xe);if(Me<0&&!us.left){O(Me*.2),R(null);return}if(Me>0&&!us.right){O(Me*.2),R(null);return}ge.current=!0,O(Me),Math.abs(Me)>50?R(Me>0?"right":"left"):R(null)},[N,b,$s,X]),Ts=u.useCallback(()=>{if(!ce.current)return;Math.abs(H)>100&&C?q(C==="left"):(O(0),R(null)),ce.current=null,ge.current=!1},[H,C,q]),as=u.useCallback(U=>{He(U.clientX,U.clientY)},[He]),Es=u.useCallback(U=>{ce.current&&(U.preventDefault(),Ze(U.clientX))},[Ze]),es=u.useCallback(()=>{Ts()},[Ts]),Is=u.useCallback(()=>{ce.current&&Ts()},[Ts]),ds=u.useCallback(U=>{const Me=U.touches[0];He(Me.clientX,Me.clientY)},[He]),is=u.useCallback(U=>{const Me=U.touches[0];Ze(Me.clientX)},[Ze]),ws=u.useCallback(()=>{Ts()},[Ts]);u.useEffect(()=>{if(!a||r!=="quick")return;const U=Me=>{if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(Me.key)||(Me.preventDefault(),Me.stopPropagation(),Me.stopImmediatePropagation(),X||w))return;const Xe=N[b],us=$s(Xe);Me.key==="ArrowLeft"?us.left?q(!0):Ke("left"):Me.key==="ArrowRight"?us.right?q(!1):Ke("right"):Me.key==="ArrowDown"?b<N.length-1&&y(cs=>cs+1):Me.key==="ArrowUp"&&b>0&&y(cs=>cs-1)};return window.addEventListener("keydown",U,!0),()=>window.removeEventListener("keydown",U,!0)},[a,r,N,b,X,w,$s,q,Ke]),u.useEffect(()=>{if(!a||r!=="quick"||w)return;const U=N.length-b-1,Me=N.length<M;U<=5&&Me&&rt(!1,!0)},[a,r,b,N.length,M,w,rt]),u.useEffect(()=>{a&&(Js(),kt(),pa())},[a,Js,kt,pa]),u.useEffect(()=>{he(1),Ue(new Set)},[K,se]),u.useEffect(()=>{Ue(new Set)},[h]);const it=()=>{Le(rs),he(1)},vt=U=>de.get(U)||U,Ae=async(U,Me)=>{try{Ee(us=>new Set(us).add(U));const Xe=await Um([{id:U,rejected:Me,require_unchecked:K==="unchecked"}]);Xe.results[0]?.success?(ys({title:Me?"":"",description:` #${U} ${Me?"":""}`}),kt(),Js()):ys({title:"",description:Xe.results[0]?.message||"",variant:"destructive"})}catch(Xe){ys({title:"",description:Xe instanceof Error?Xe.message:"",variant:"destructive"})}finally{Ee(Xe=>{const us=new Set(Xe);return us.delete(U),us})}},Ge=async U=>{if(W.size===0){ys({title:"",description:"",variant:"destructive"});return}try{D(!0);const Me=Array.from(W).map(us=>({id:us,rejected:U,require_unchecked:K==="unchecked"})),Xe=await Um(Me);ys({title:"",description:` ${Xe.succeeded}  ${Xe.failed} `,variant:Xe.failed>0?"destructive":"default"}),Ue(new Set),kt(),Js()}catch(Me){ys({title:"",description:Me instanceof Error?Me.message:"",variant:"destructive"})}finally{D(!1)}},Ls=()=>{W.size===h.length?Ue(new Set):Ue(new Set(h.map(U=>U.id)))},ct=U=>{Ue(Me=>{const Xe=new Set(Me);return Xe.has(U)?Xe.delete(U):Xe.add(U),Xe})},Ht=U=>U?new Date(U*1e3).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",da=U=>U.checked?U.rejected?e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(aa,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"default",className:"gap-1 bg-green-600",children:[e.jsx(st,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(ca,{className:"h-3 w-3"}),""]}),Ia=U=>U?U==="ai"?e.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(Kn,{className:"h-3 w-3"}),"AI"]}):e.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx($l,{className:"h-3 w-3"}),""]}):null,Xt=Math.ceil(ue/Te),te=()=>{const U=[];if(Xt<=7)for(let Me=1;Me<=Xt;Me++)U.push(Me);else{U.push(1),_e>3&&U.push("ellipsis");const Me=Math.max(2,_e-1),Xe=Math.min(Xt-1,_e+1);for(let us=Me;us<=Xe;us++)U.push(us);_e<Xt-2&&U.push("ellipsis"),Xt>1&&U.push(Xt)}return U},ye=()=>{const U=parseInt($,10);!isNaN(U)&&U>=1&&U<=Xt&&(he(U),z(""))};return e.jsx(Qs,{open:a,onOpenChange:l,children:e.jsxs(Hs,{className:"max-w-5xl w-[95vw] sm:w-full h-[90vh] sm:h-[85vh] flex flex-col p-0",hideCloseButton:!0,children:[e.jsxs("div",{className:"flex items-end bg-muted/30 px-2 pt-2 shrink-0",children:[e.jsxs("button",{onClick:()=>c("list"),className:F("group relative flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-t-lg transition-all","hover:bg-background/50",r==="list"?"bg-background text-foreground shadow-sm border border-b-0 border-border":"text-muted-foreground hover:text-foreground"),children:[e.jsx(tv,{className:"h-4 w-4"}),e.jsx("span",{children:""}),r==="list"&&e.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-background"})]}),e.jsxs("button",{onClick:()=>c("quick"),className:F("group relative flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-t-lg transition-all","hover:bg-background/50",r==="quick"?"bg-background text-foreground shadow-sm border border-b-0 border-border":"text-muted-foreground hover:text-foreground"),children:[e.jsx(el,{className:"h-4 w-4"}),e.jsx("span",{children:""}),e.jsx(ke,{variant:"secondary",className:"ml-1 h-5 px-1.5 text-xs",children:""}),r==="quick"&&e.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-background"})]}),e.jsx("div",{className:"flex-1 border-b border-border"}),e.jsx("button",{onClick:()=>l(!1),className:"mb-[1px] p-2 text-muted-foreground hover:text-foreground hover:bg-muted rounded-lg transition-colors",children:e.jsx(Sa,{className:"h-4 w-4"})})]}),r==="list"&&e.jsxs(e.Fragment,{children:[e.jsxs(qs,{className:"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b shrink-0",children:[e.jsx(Vs,{className:"text-lg sm:text-xl",children:""}),e.jsx(at,{className:"text-xs sm:text-sm",children:""}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mt-4",children:[e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-orange-500",children:Q?"-":d?.unchecked??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-500",children:Q?"-":d?.passed??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-500",children:Q?"-":d?.rejected??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-500",children:Q?"-":d?.total??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b shrink-0 space-y-3",children:[e.jsx(Jt,{value:K,onValueChange:U=>De(U),className:"w-full",children:e.jsxs(Gt,{className:"grid w-full grid-cols-4",children:[e.jsxs(Ye,{value:"unchecked",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(ca,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.unchecked??0,")"]})]}),e.jsxs(Ye,{value:"passed",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(st,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.passed??0,")"]})]}),e.jsxs(Ye,{value:"rejected",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(aa,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.rejected??0,")"]})]}),e.jsxs(Ye,{value:"all",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx("span",{children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.total??0,")"]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:rs,onChange:U=>J(U.target.value),onKeyDown:U=>U.key==="Enter"&&it(),className:"pl-9"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:it,children:e.jsx(Ut,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"icon",onClick:()=>{kt(),Js()},disabled:pe,children:e.jsx(mt,{className:F("h-4 w-4",pe&&"animate-spin")})})]}),W.size>0&&e.jsx("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:K==="unchecked"?e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>Ge(!1),disabled:pe,children:[e.jsx(st,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",W.size,")"]}),e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>Ge(!0),disabled:pe,children:[e.jsx(aa,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",W.size,")"]})]}):K==="passed"?e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>Ge(!0),disabled:pe,children:[e.jsx(aa,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",W.size,")"]}):K==="rejected"?e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>Ge(!1),disabled:pe,children:[e.jsx(st,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",W.size,")"]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>Ge(!1),disabled:pe,children:[e.jsx(st,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",W.size,")"]}),e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>Ge(!0),disabled:pe,children:[e.jsx(aa,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",W.size,")"]})]})})]})]}),e.jsx(ts,{className:"flex-1 px-4 sm:px-6",children:pe&&h.length===0?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(mt,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):h.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-muted-foreground",children:[e.jsx(Rt,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:""})]}):e.jsxs("div",{className:"space-y-2 py-2",children:[h.length>0&&e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{checked:W.size===h.length&&h.length>0,onCheckedChange:Ls}),e.jsx("span",{className:"text-sm text-muted-foreground",children:W.size===h.length&&h.length>0?` (${h.length} )`:` (${h.length} )`})]}),W.size>0&&e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>Ue(new Set),className:"h-7 text-xs",children:""})]}),h.map(U=>e.jsx("div",{className:F("rounded-lg border p-3 sm:p-4 space-y-2 sm:space-y-3 transition-colors",W.has(U.id)&&"bg-accent border-primary",ae.has(U.id)&&"opacity-50"),children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx(tt,{checked:W.has(U.id),onCheckedChange:()=>ct(U.id),disabled:ae.has(U.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm font-medium break-words",children:U.situation})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground break-words",children:U.style})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["#",U.id]}),e.jsx("span",{children:""}),e.jsx("span",{title:vt(U.chat_id),className:"truncate max-w-24 sm:max-w-32",children:vt(U.chat_id)}),e.jsx("span",{children:""}),e.jsx("span",{children:Ht(U.create_date)}),e.jsxs("div",{className:"flex items-center gap-1",children:[da(U),Ia(U.modified_by)]})]})]}),e.jsx("div",{className:"flex flex-col gap-1 sm:gap-2 shrink-0",children:K==="unchecked"?e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(st,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]}):K==="passed"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):K==="rejected"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(st,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsx(e.Fragment,{children:U.rejected?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(st,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):U.checked?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(st,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>Ae(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})})})]})},U.id))]})}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-t shrink-0 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs(Ie,{value:Te.toString(),onValueChange:U=>{G(parseInt(U,10)),he(1)},children:[e.jsx(Be,{className:"w-[70px] h-8",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs("span",{className:"text-muted-foreground",children:[" ",ue," "]})]}),e.jsx(mx,{className:"mx-0 w-auto",children:e.jsxs(xx,{children:[e.jsx(Yn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>he(U=>Math.max(1,U-1)),disabled:_e<=1||pe,children:e.jsx(Pa,{className:"h-4 w-4"})})}),te().map((U,Me)=>e.jsx(Yn,{children:U==="ellipsis"?e.jsx(Uv,{}):e.jsx(pc,{href:"#",isActive:U===_e,onClick:Xe=>{Xe.preventDefault(),he(U)},className:"h-8 w-8 cursor-pointer",children:U})},Me)),e.jsx(Yn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>he(U=>Math.min(Xt,U+1)),disabled:_e>=Xt||pe,children:e.jsx(ia,{className:"h-4 w-4"})})})]})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(le,{type:"number",min:1,max:Xt,value:$,onChange:U=>z(U.target.value),onKeyDown:U=>U.key==="Enter"&&ye(),className:"w-16 h-8 text-center",placeholder:_e.toString()}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(_,{variant:"outline",size:"sm",className:"h-8",onClick:ye,disabled:pe,children:""})]})]})]}),r==="quick"&&e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b shrink-0 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium text-orange-500",children:d?.unchecked??0})]}),e.jsxs("span",{className:"text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium text-green-500",children:d?.passed??0})]}),e.jsxs("span",{className:"text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium text-red-500",children:d?.rejected??0})]})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>{rt(),Js()},disabled:w,children:[e.jsx(mt,{className:F("h-4 w-4 mr-1",w&&"animate-spin")}),""]})]}),e.jsx(Jt,{value:p,onValueChange:U=>g(U),className:"w-full",children:e.jsxs(Gt,{className:"grid w-full grid-cols-4",children:[e.jsxs(Ye,{value:"unchecked",className:"gap-1 text-xs sm:text-sm",children:[e.jsx(ca,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"passed",className:"gap-1 text-xs sm:text-sm",children:[e.jsx(st,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"rejected",className:"gap-1 text-xs sm:text-sm",children:[e.jsx(aa,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(Ye,{value:"all",className:"gap-1 text-xs sm:text-sm",children:""})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-4 sm:p-8 relative overflow-hidden",children:w&&N.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(mt,{className:"h-8 w-8 animate-spin text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]}):N.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-muted/50 flex items-center justify-center mb-6",children:e.jsx(st,{className:"h-10 w-10 text-green-500"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 text-sm text-muted-foreground z-50",children:[b+1," / ",N.length,M>N.length&&e.jsxs("span",{className:"ml-1",children:[" ",M," "]})]}),e.jsx("div",{className:"absolute inset-x-4 top-1/2 -translate-y-1/2 flex justify-between pointer-events-none z-40",children:(()=>{const U=N[b],Me=$s(U);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:F("flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-300",C==="left"?"bg-red-500/20 text-red-500 scale-110":"bg-muted/50 text-muted-foreground opacity-0",!Me.left&&"invisible"),children:[e.jsx(aa,{className:"h-8 w-8"}),e.jsx("span",{className:"font-bold text-lg hidden sm:inline",children:""})]}),e.jsxs("div",{className:F("flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-300",C==="right"?"bg-green-500/20 text-green-500 scale-110":"bg-muted/50 text-muted-foreground opacity-0",!Me.right&&"invisible"),children:[e.jsx("span",{className:"font-bold text-lg hidden sm:inline",children:""}),e.jsx(st,{className:"h-8 w-8"})]})]})})()}),e.jsx("div",{className:"relative w-full max-w-md h-[400px] flex items-center justify-center",children:N.slice(b,b+5).reverse().map((U,Me,Xe)=>{const us=Xe.length-1-Me,cs=us===0;let Ct={zIndex:5-us,position:"absolute",width:"100%",transition:cs&&!ge.current?"all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)":"none"};if(cs)Ct={...Ct,transform:`translateX(${H}px) rotate(${H*.05}deg)`,opacity:Math.max(0,1-Math.abs(H)/500),cursor:"grab"};else{const Bs=Math.min(Math.abs(H)/200,1),ne=Zt=>{const ql=Zt*7%5,kn=Zt*13%7;return{scale:1-Zt*.05,translateY:Zt*12,rotate:(Zt%2===0?1:-1)*(Zt*2)+ql,translateX:(Zt%2===0?-1:1)*(Zt*4)+kn}},fe=ne(us),ss=ne(us-1),_s=fe.scale+(ss.scale-fe.scale)*Bs,ms=fe.translateY+(ss.translateY-fe.translateY)*Bs,_t=fe.rotate+(ss.rotate-fe.rotate)*Bs,ua=fe.translateX+(ss.translateX-fe.translateX)*Bs;Ct={...Ct,transform:`translate3d(${ua}px, ${ms}px, 0) scale(${_s}) rotate(${_t}deg)`,opacity:1-us*.15,filter:`blur(${Math.max(0,us*1-Bs)}px)`,pointerEvents:"none"}}return e.jsxs("div",{ref:cs?je:void 0,className:F("bg-card border rounded-xl shadow-xl p-6 select-none h-full flex flex-col",cs&&"active:cursor-grabbing shadow-2xl ring-1 ring-border/50",cs&&me===U.id&&"ring-4 ring-orange-500/50 bg-orange-50/10"),style:Ct,onMouseDown:cs?as:void 0,onMouseMove:cs?Es:void 0,onMouseUp:cs?es:void 0,onMouseLeave:cs?Is:void 0,onTouchStart:cs?ds:void 0,onTouchMove:cs?is:void 0,onTouchEnd:cs?ws:void 0,children:[cs&&me===U.id&&e.jsxs("div",{className:"absolute inset-0 z-50 flex flex-col items-center justify-center bg-background/80 backdrop-blur-sm animate-in fade-in duration-300 rounded-xl",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-orange-500/20 rounded-full animate-ping"}),e.jsx(mt,{className:"relative h-16 w-16 text-orange-500 mb-4 animate-spin duration-1000"})]}),e.jsx("h3",{className:"text-xl font-bold text-foreground animate-in slide-in-from-bottom-2 fade-in duration-500",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2 animate-in slide-in-from-bottom-3 fade-in duration-700",children:""})]}),cs&&e.jsx("div",{className:F("absolute inset-0 flex items-center justify-center z-20 pointer-events-none transition-opacity duration-200",H<-10&&!$s(U).left||H>10&&!$s(U).right?"opacity-100":"opacity-0"),children:e.jsx("div",{className:"bg-background/80 backdrop-blur-sm p-4 rounded-full shadow-lg border border-border",children:e.jsx(av,{className:"h-12 w-12 text-muted-foreground"})})}),e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground font-mono",children:["#",U.id]}),e.jsxs("div",{className:"flex items-center gap-2",children:[da(U),Ia(U.modified_by)]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:""}),e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg border border-border/50",children:e.jsx("p",{className:"text-lg font-medium leading-relaxed",children:U.situation})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:U.style.split(/[,]/).map((Bs,ne)=>e.jsx(ke,{variant:"secondary",className:"font-normal",children:Bs.trim()},ne))})]})]}),e.jsxs("div",{className:"mt-auto pt-4 border-t flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary",children:e.jsx($l,{className:"h-3 w-3"})}),e.jsx("span",{title:vt(U.chat_id),className:"truncate max-w-[120px] font-medium",children:vt(U.chat_id)})]}),e.jsx("span",{className:"font-mono",children:Ht(U.create_date)})]})]},U.id)})}),e.jsx("div",{className:"flex items-center gap-8 mt-8 sm:hidden z-50",children:(()=>{const U=N[b],Me=$s(U);return e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"lg",className:F("w-16 h-16 rounded-full border-2 shadow-lg transition-all active:scale-95",Me.left?"hover:bg-red-50 hover:text-red-600 hover:border-red-200":"opacity-30 cursor-not-allowed"),onClick:()=>Me.left&&q(!0),disabled:!Me.left||X,children:e.jsx(aa,{className:"h-8 w-8"})}),e.jsx(_,{variant:"outline",size:"lg",className:F("w-16 h-16 rounded-full border-2 shadow-lg transition-all active:scale-95",Me.right?"hover:bg-green-50 hover:text-green-600 hover:border-green-200":"opacity-30 cursor-not-allowed"),onClick:()=>Me.right&&q(!1),disabled:!Me.right||X,children:e.jsx(st,{className:"h-8 w-8"})})]})})()})]})}),e.jsxs("div",{className:"hidden sm:flex items-center justify-center gap-6 px-6 py-3 border-t text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsx("span",{className:"text-muted-foreground/50",children:"|"}),e.jsx("span",{children:""})]})]})]})})}function l2(){return e.jsx(tr,{children:e.jsx(r2,{})})}const n2=a=>{const l=[];for(let r=0;r<a;r++){const c=r*137.508%360;l.push(`hsl(${c}, 70%, 55%)`)}return l};function r2(){const[a,l]=u.useState(null),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(24),[p,g]=u.useState(!0),[N,j]=u.useState(null),[b,y]=u.useState(!0),[w,A]=u.useState(null),[M,S]=u.useState(!1),[I,E]=u.useState(0),{triggerRestart:C,isRestarting:R}=_n(),H=u.useRef(!0),O=u.useRef(null);u.useEffect(()=>(H.current=!0,()=>{H.current=!1,O.current&&(clearInterval(O.current),O.current=null)}),[]);const X=u.useCallback(async()=>{try{const z=await fx();H.current&&E(z.unchecked)}catch(z){console.error(":",z)}},[]),L=u.useCallback(async()=>{try{y(!0);const z=await dw.get("https://v1.hitokoto.cn/?c=a&c=b&c=c&c=d&c=h&c=i&c=k");H.current&&j({hitokoto:z.data.hitokoto,from:z.data.from||z.data.from_who||""})}catch(z){console.error(":",z),H.current&&j({hitokoto:"",from:""})}finally{H.current&&y(!1)}},[]),me=u.useCallback(async()=>{try{const z=await Se("/api/webui/system/status");if(!H.current)return;if(z.ok){const K=await z.json();A(K)}else A(null)}catch(z){console.error(":",z),H.current&&A(null)}},[]),Ne=async()=>{await C()},je=u.useCallback(async()=>{try{const z=await Se(`/api/webui/statistics/dashboard?hours=${h}`);if(!H.current)return;if(z.ok){const K=await z.json();l(K)}c(!1),m(100)}catch(z){console.error("Failed to fetch dashboard data:",z),H.current&&(c(!1),m(100))}},[h]);if(u.useEffect(()=>{if(!r)return;m(0);const z=setTimeout(()=>m(15),200),K=setTimeout(()=>m(30),800),De=setTimeout(()=>m(45),2e3),se=setTimeout(()=>m(60),4e3),Le=setTimeout(()=>m(75),6500),rs=setTimeout(()=>m(85),9e3),J=setTimeout(()=>m(92),11e3);return()=>{clearTimeout(z),clearTimeout(K),clearTimeout(De),clearTimeout(se),clearTimeout(Le),clearTimeout(rs),clearTimeout(J)}},[r]),u.useEffect(()=>{je(),L(),me(),X()},[je,L,me,X]),u.useEffect(()=>{if(O.current&&(clearInterval(O.current),O.current=null),!!p)return O.current=setInterval(()=>{H.current&&(je(),me())},3e4),()=>{O.current&&(clearInterval(O.current),O.current=null)}},[p,je,me]),r||!a)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"text-center space-y-6 w-full max-w-md px-4",children:[e.jsx(mt,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(er,{value:d,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d,"%"]})]})]})});const{summary:ce,model_stats:ge=[],hourly_data:pe=[],daily_data:D=[],recent_activity:Q=[]}=a,B=ce??{total_requests:0,total_cost:0,total_tokens:0,online_time:0,total_messages:0,total_replies:0,avg_response_time:0,cost_per_hour:0,tokens_per_hour:0},ue=z=>{const K=Math.floor(z/3600),De=Math.floor(z%3600/60);return`${K}${De}`},Y=z=>{const K=z.toLocaleString("zh-CN");return z>=1e9?{display:`${(z/1e9).toFixed(2)}B`,exact:K,needsExact:!0}:z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:K,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:K,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:K,needsExact:!0}:{display:K,exact:K,needsExact:!1}},_e=z=>{const K=`${z.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:K,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:K,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:K,needsExact:!0}:{display:K,exact:K,needsExact:!1}},he=z=>new Date(z).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Te=n2(ge.length),G=ge.map((z,K)=>({name:z.model_name,value:z.request_count,fill:Te[K]})),$={requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"},tokens:{label:"Tokens",color:"hsl(var(--chart-3))"}};return e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Jt,{value:h.toString(),onValueChange:z=>f(Number(z)),children:e.jsxs(Gt,{className:"grid grid-cols-3 w-full sm:w-auto",children:[e.jsx(Ye,{value:"24",children:"24"}),e.jsx(Ye,{value:"168",children:"7"}),e.jsx(Ye,{value:"720",children:"30"})]})}),e.jsxs(_,{variant:p?"default":"outline",size:"sm",onClick:()=>g(!p),className:"gap-2",children:[e.jsx(mt,{className:`h-4 w-4 ${p?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:je,children:e.jsx(mt,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg border border-dashed border-muted-foreground/30 bg-muted/20",children:[b?e.jsx(Ms,{className:"h-5 flex-1"}):N?e.jsxs("p",{className:"flex-1 text-sm text-muted-foreground italic truncate",children:['"',N.hitokoto,'"  ',N.from]}):null,e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:L,disabled:b,children:e.jsx(mt,{className:`h-3.5 w-3.5 ${b?"animate-spin":""}`})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-3",children:[e.jsxs(Ce,{className:"lg:col-span-1",children:[e.jsx(Oe,{className:"pb-3",children:e.jsxs($e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hc,{className:"h-4 w-4"}),""]})}),e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:w?.running?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500 animate-pulse"}),e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[e.jsx(st,{className:"h-3 w-3 mr-1"}),""]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500"}),e.jsxs(ke,{variant:"outline",className:"text-red-600 border-red-300 bg-red-50",children:[e.jsx(Rt,{className:"h-3 w-3 mr-1"}),""]})]})}),w&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{children:["v",w.version]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{children:[" ",ue(w.uptime)]})]})]})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{className:"pb-3",children:e.jsxs($e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]})}),e.jsx(ze,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:Ne,disabled:R,className:"gap-2",children:[e.jsx(lc,{className:`h-4 w-4 ${R?"animate-spin":""}`}),R?"...":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>S(!0),className:"gap-2",children:[e.jsx(lv,{className:"h-4 w-4"}),"",I>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:I>99?"99+":I})]}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/logs",children:[e.jsx(La,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/plugins",children:[e.jsx(w1,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/settings",children:[e.jsx(bn,{className:"h-4 w-4"}),""]})})]})})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"pb-3",children:[e.jsxs($e,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(_1,{className:"h-4 w-4"}),""]}),e.jsx(Ns,{className:"text-xs",children:""})]}),e.jsx(ze,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/survey/webui-feedback",children:[e.jsx(La,{className:"h-4 w-4"}),"WebUI "]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/survey/maibot-feedback",children:[e.jsx(Ba,{className:"h-4 w-4"}),""]})})]})})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(ax,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ze,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Y(B.total_requests).display,Y(B.total_requests).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",Y(B.total_requests).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["",h<48?h+"":Math.floor(h/24)+""]})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(S1,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ze,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[_e(B.total_cost).display,_e(B.total_cost).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",_e(B.total_cost).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:B.cost_per_hour>0?`${B.cost_per_hour.toFixed(2)}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:"Token"}),e.jsx(Jr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ze,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Y(B.total_tokens).display,Y(B.total_tokens).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",Y(B.total_tokens).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:B.tokens_per_hour>0?`${Y(B.tokens_per_hour).display}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(el,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ze,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[B.avg_response_time.toFixed(2),"s"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"API"})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(ca,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(ze,{children:e.jsxs("div",{className:"text-xl font-bold",children:[ue(B.online_time),e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",B.online_time.toLocaleString(),")"]})]})})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ze,{children:[e.jsxs("div",{className:"text-xl font-bold",children:[Y(B.total_messages).display,Y(B.total_messages).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",Y(B.total_messages).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",Y(B.total_replies).display,Y(B.total_replies).needsExact&&e.jsxs("span",{children:["(",Y(B.total_replies).exact,")"]})," "]})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(lx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ze,{children:[e.jsx("div",{className:"text-xl font-bold",children:B.total_messages>0?`${(B.total_cost/B.total_messages*100).toFixed(2)}`:"0.00"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"100"})]})]})]}),e.jsxs(Jt,{defaultValue:"trends",className:"space-y-4",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[e.jsx(Ye,{value:"trends",children:""}),e.jsx(Ye,{value:"models",children:""}),e.jsx(Ye,{value:"activity",children:""}),e.jsx(Ye,{value:"daily",children:""})]}),e.jsxs(Cs,{value:"trends",className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsxs(Ns,{children:["",h,""]})]}),e.jsx(ze,{children:e.jsx(Vr,{config:$,className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Qw,{data:pe,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>he(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>he(z)})}),e.jsx(Yw,{type:"monotone",dataKey:"requests",stroke:"var(--color-requests)",strokeWidth:2})]})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:"API"})]}),e.jsx(ze,{children:e.jsx(Vr,{config:$,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:pe,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>he(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>he(z)})}),e.jsx(Ji,{dataKey:"cost",fill:"var(--color-cost)"})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:"Token"}),e.jsx(Ns,{children:"Token"})]}),e.jsx(ze,{children:e.jsx(Vr,{config:$,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:pe,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>he(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>he(z)})}),e.jsx(Ji,{dataKey:"tokens",fill:"var(--color-tokens)"})]})})})]})]})]}),e.jsx(Cs,{value:"models",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsxs(Ns,{children:[" ( ",ge.length," )"]})]}),e.jsx(ze,{children:e.jsx(Vr,{config:Object.fromEntries(ge.map((z,K)=>[z.model_name,{label:z.model_name,color:Te[K]}])),className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Jw,{children:[e.jsx(Gi,{content:e.jsx(Gr,{})}),e.jsx(Xw,{data:G,cx:"50%",cy:"50%",labelLine:!1,label:({name:z,percent:K})=>K&&K<.05?"":`${z} ${K?(K*100).toFixed(0):0}%`,outerRadius:100,dataKey:"value",children:G.map((z,K)=>e.jsx(Zw,{fill:z.fill},`cell-${K}`))})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:e.jsx(ts,{className:"h-[300px] sm:h-[400px]",children:e.jsx("div",{className:"space-y-3",children:ge.map((z,K)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm truncate flex-1 min-w-0",children:z.model_name}),e.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:`hsl(var(--chart-${K%5+1}))`}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-1 font-medium",children:z.request_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:["",z.total_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[(z.total_tokens/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:[z.avg_response_time.toFixed(2),"s"]})]})]})]},K))})})})]})]})}),e.jsx(Cs,{value:"activity",children:e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:"API"})]}),e.jsx(ze,{children:e.jsx(ts,{className:"h-[400px] sm:h-[500px]",children:e.jsx("div",{className:"space-y-2",children:Q.map((z,K)=>e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:z.model}),e.jsx("div",{className:"text-xs text-muted-foreground",children:z.request_type})]}),e.jsx("div",{className:"text-xs text-muted-foreground flex-shrink-0",children:he(z.timestamp)})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsx("span",{className:"ml-1",children:z.tokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:["",z.cost.toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:[z.time_cost.toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:`ml-1 ${z.status==="success"?"text-green-600":"text-red-600"}`,children:z.status})]})]})]},K))})})})]})}),e.jsx(Cs,{value:"daily",children:e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:"7"})]}),e.jsx(ze,{children:e.jsx(Vr,{config:{requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"}},className:"h-[400px] sm:h-[500px] w-full aspect-auto",children:e.jsxs(Uo,{data:D,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>{const K=new Date(z);return`${K.getMonth()+1}/${K.getDate()}`},stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{yAxisId:"left",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{yAxisId:"right",orientation:"right",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>new Date(z).toLocaleDateString("zh-CN")})}),e.jsx(L_,{content:e.jsx(Ev,{})}),e.jsx(Ji,{yAxisId:"left",dataKey:"requests",fill:"var(--color-requests)"}),e.jsx(Ji,{yAxisId:"right",dataKey:"cost",fill:"var(--color-cost)"})]})})})]})})]}),e.jsx(ar,{}),e.jsx($v,{open:M,onOpenChange:z=>{S(z),z||X()}})]})})}const i2={theme:"system",setTheme:()=>null},Bv=u.createContext(i2),px=()=>{const a=u.useContext(Bv);if(a===void 0)throw new Error("useTheme must be used within a ThemeProvider");return a},c2=(a,l,r)=>{const c=document.documentElement.classList.contains("no-animations");if(!document.startViewTransition||c){l(a);return}const d=r.clientX,m=r.clientY,h=Math.hypot(Math.max(d,innerWidth-d),Math.max(m,innerHeight-m));document.startViewTransition(()=>{l(a)}).ready.then(()=>{document.documentElement.animate({clipPath:[`circle(0px at ${d}px ${m}px)`,`circle(${h}px at ${d}px ${m}px)`]},{duration:500,easing:"ease-in-out",pseudoElement:"::view-transition-new(root)"})})},Pv=u.createContext(void 0),Iv=()=>{const a=u.useContext(Pv);if(a===void 0)throw new Error("useAnimation must be used within an AnimationProvider");return a},Ve=u.forwardRef(({className:a,...l},r)=>e.jsx(pj,{className:F("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...l,ref:r,children:e.jsx(pw,{className:F("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ve.displayName=pj.displayName;const o2=ei("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),T=u.forwardRef(({className:a,...l},r)=>e.jsx(Kj,{ref:r,className:F(o2(),a),...l}));T.displayName=Kj.displayName;const d2=[{id:"minLength",label:" 10 ",description:"Token  10 ",validate:a=>a.length>=10},{id:"hasUppercase",label:"",description:" (A-Z)",validate:a=>/[A-Z]/.test(a)},{id:"hasLowercase",label:"",description:" (a-z)",validate:a=>/[a-z]/.test(a)},{id:"hasSpecialChar",label:"",description:" (!@#$%^&*()_+-=[]{}|;:,.<>?/)",validate:a=>/[!@#$%^&*()_+\-=[\]{}|;:,.<>?/]/.test(a)}];function u2(a){const l=d2.map(c=>({id:c.id,label:c.label,description:c.description,passed:c.validate(a)}));return{isValid:l.every(c=>c.passed),rules:l}}const od="0.12.2",gx="MaiBot Dashboard",m2=`${gx} v${od}`,x2=(a="v")=>`${a}${od}`,wa={THEME:"maibot-ui-theme",ACCENT_COLOR:"accent-color",ENABLE_ANIMATIONS:"maibot-animations",ENABLE_WAVES_BACKGROUND:"maibot-waves-background",LOG_CACHE_SIZE:"maibot-log-cache-size",LOG_AUTO_SCROLL:"maibot-log-auto-scroll",LOG_FONT_SIZE:"maibot-log-font-size",LOG_LINE_SPACING:"maibot-log-line-spacing",DATA_SYNC_INTERVAL:"maibot-data-sync-interval",WS_RECONNECT_INTERVAL:"maibot-ws-reconnect-interval",WS_MAX_RECONNECT_ATTEMPTS:"maibot-ws-max-reconnect-attempts",COMPLETED_TOURS:"maibot-completed-tours"},fl={theme:"system",accentColor:"blue",enableAnimations:!0,enableWavesBackground:!0,logCacheSize:1e3,logAutoScroll:!0,logFontSize:"xs",logLineSpacing:4,dataSyncInterval:30,wsReconnectInterval:3e3,wsMaxReconnectAttempts:10};function zt(a){const l=Fv(a),r=localStorage.getItem(l);if(r===null)return fl[a];const c=fl[a];if(typeof c=="boolean")return r==="true";if(typeof c=="number"){const d=parseFloat(r);return isNaN(d)?c:d}return r}function Kr(a,l){const r=Fv(a);localStorage.setItem(r,String(l)),window.dispatchEvent(new CustomEvent("maibot-settings-change",{detail:{key:a,value:l}}))}function h2(){return{theme:zt("theme"),accentColor:zt("accentColor"),enableAnimations:zt("enableAnimations"),enableWavesBackground:zt("enableWavesBackground"),logCacheSize:zt("logCacheSize"),logAutoScroll:zt("logAutoScroll"),logFontSize:zt("logFontSize"),logLineSpacing:zt("logLineSpacing"),dataSyncInterval:zt("dataSyncInterval"),wsReconnectInterval:zt("wsReconnectInterval"),wsMaxReconnectAttempts:zt("wsMaxReconnectAttempts")}}function f2(){const a=h2(),l=localStorage.getItem(wa.COMPLETED_TOURS),r=l?JSON.parse(l):[];return{...a,completedTours:r}}function p2(a){const l=[],r=[];for(const[c,d]of Object.entries(a)){if(c==="completedTours"){Array.isArray(d)?(localStorage.setItem(wa.COMPLETED_TOURS,JSON.stringify(d)),l.push("completedTours")):r.push("completedTours");continue}if(c in fl){const m=c,h=fl[m];if(typeof d==typeof h){if(m==="theme"&&!["light","dark","system"].includes(d)){r.push(c);continue}if(m==="logFontSize"&&!["xs","sm","base"].includes(d)){r.push(c);continue}Kr(m,d),l.push(c)}else r.push(c)}else r.push(c)}return{success:l.length>0,imported:l,skipped:r}}function g2(){for(const a of Object.keys(fl))Kr(a,fl[a]);localStorage.removeItem(wa.COMPLETED_TOURS),window.dispatchEvent(new CustomEvent("maibot-settings-reset"))}function j2(){const a=[],l=[],r=[];for(let c=0;c<localStorage.length;c++){const d=localStorage.key(c);d&&(d.startsWith("maibot")||d.startsWith("accent-color")||d==="access-token")&&r.push(d)}for(const c of r)localStorage.removeItem(c),a.push(c);return{clearedKeys:a,preservedKeys:l}}function Og(){let a=0;const l=[];for(let r=0;r<localStorage.length;r++){const c=localStorage.key(r);if(c){const d=localStorage.getItem(c)||"",m=(c.length+d.length)*2;a+=m,l.push({key:c,size:m})}}return l.sort((r,c)=>c.size-r.size),{used:a,items:localStorage.length,details:l}}function v2(a){if(a===0)return"0 B";const l=1024,r=["B","KB","MB"],c=Math.floor(Math.log(a)/Math.log(l));return parseFloat((a/Math.pow(l,c)).toFixed(2))+" "+r[c]}function Fv(a){return{theme:wa.THEME,accentColor:wa.ACCENT_COLOR,enableAnimations:wa.ENABLE_ANIMATIONS,enableWavesBackground:wa.ENABLE_WAVES_BACKGROUND,logCacheSize:wa.LOG_CACHE_SIZE,logAutoScroll:wa.LOG_AUTO_SCROLL,logFontSize:wa.LOG_FONT_SIZE,logLineSpacing:wa.LOG_LINE_SPACING,dataSyncInterval:wa.DATA_SYNC_INTERVAL,wsReconnectInterval:wa.WS_RECONNECT_INTERVAL,wsMaxReconnectAttempts:wa.WS_MAX_RECONNECT_ATTEMPTS}[a]}const Wa=u.forwardRef(({className:a,...l},r)=>e.jsxs(gj,{ref:r,className:F("relative flex w-full touch-none select-none items-center",a),...l,children:[e.jsx(gw,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(jw,{className:"absolute h-full bg-primary"})}),e.jsx(vw,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Wa.displayName=gj.displayName;class N2{ws=null;reconnectTimeout=null;reconnectAttempts=0;heartbeatInterval=null;logCallbacks=new Set;connectionCallbacks=new Set;isConnected=!1;logCache=[];getMaxCacheSize(){return zt("logCacheSize")}getMaxReconnectAttempts(){return zt("wsMaxReconnectAttempts")}getReconnectInterval(){return zt("wsReconnectInterval")}getWebSocketUrl(l){let r;{const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host;r=`${c}//${d}/ws/logs`}return l?`${r}?token=${encodeURIComponent(l)}`:r}async getWsToken(){try{const l=await Se("/api/webui/ws-token",{method:"GET",credentials:"include"});if(!l.ok)return console.error(" WebSocket token :",l.status),null;const r=await l.json();return r.success&&r.token?r.token:null}catch(l){return console.error(" WebSocket token :",l),null}}async connect(){if(this.ws?.readyState===WebSocket.OPEN||this.ws?.readyState===WebSocket.CONNECTING)return;if(window.location.pathname==="/auth"){console.log("  WebSocket ");return}if(!await cc()){console.log("  WebSocket ");return}const r=await this.getWsToken();if(!r){console.log("  WebSocket token");return}const c=this.getWebSocketUrl(r);try{this.ws=new WebSocket(c),this.ws.onopen=()=>{this.isConnected=!0,this.reconnectAttempts=0,this.notifyConnection(!0),this.startHeartbeat()},this.ws.onmessage=d=>{try{if(d.data==="pong")return;const m=JSON.parse(d.data);this.notifyLog(m)}catch(m){console.error(":",m)}},this.ws.onerror=d=>{console.error(" WebSocket :",d),this.isConnected=!1,this.notifyConnection(!1)},this.ws.onclose=()=>{this.isConnected=!1,this.notifyConnection(!1),this.stopHeartbeat(),this.attemptReconnect()}}catch(d){console.error(" WebSocket :",d),this.attemptReconnect()}}attemptReconnect(){const l=this.getMaxReconnectAttempts();if(this.reconnectAttempts>=l)return;this.reconnectAttempts+=1;const r=this.getReconnectInterval(),c=Math.min(r*this.reconnectAttempts,3e4);this.reconnectTimeout=window.setTimeout(()=>{this.connect()},c)}startHeartbeat(){this.heartbeatInterval=window.setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.ws.send("ping")},3e4)}stopHeartbeat(){this.heartbeatInterval!==null&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}disconnect(){this.reconnectTimeout!==null&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.stopHeartbeat(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.reconnectAttempts=0}onLog(l){return this.logCallbacks.add(l),()=>this.logCallbacks.delete(l)}onConnectionChange(l){return this.connectionCallbacks.add(l),l(this.isConnected),()=>this.connectionCallbacks.delete(l)}notifyLog(l){if(!this.logCache.some(c=>c.id===l.id)){this.logCache.push(l);const c=this.getMaxCacheSize();this.logCache.length>c&&(this.logCache=this.logCache.slice(-c)),this.logCallbacks.forEach(d=>{try{d(l)}catch(m){console.error(":",m)}})}}notifyConnection(l){this.connectionCallbacks.forEach(r=>{try{r(l)}catch(c){console.error(":",c)}})}getAllLogs(){return[...this.logCache]}clearLogs(){this.logCache=[]}getConnectionStatus(){return this.isConnected}}const Gn=new N2;typeof window<"u"&&setTimeout(()=>{Gn.connect()},100);const bs=bw,yt=yw,b2=Nw,Hv=u.forwardRef(({className:a,...l},r)=>e.jsx(jj,{className:F("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:r}));Hv.displayName=jj.displayName;const xs=u.forwardRef(({className:a,...l},r)=>e.jsxs(b2,{children:[e.jsx(Hv,{}),e.jsx(vj,{ref:r,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]}));xs.displayName=vj.displayName;const hs=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col space-y-2 text-center sm:text-left",a),...l});hs.displayName="AlertDialogHeader";const fs=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...l});fs.displayName="AlertDialogFooter";const ps=u.forwardRef(({className:a,...l},r)=>e.jsx(Nj,{ref:r,className:F("text-lg font-semibold",a),...l}));ps.displayName=Nj.displayName;const gs=u.forwardRef(({className:a,...l},r)=>e.jsx(bj,{ref:r,className:F("text-sm text-muted-foreground",a),...l}));gs.displayName=bj.displayName;const js=u.forwardRef(({className:a,variant:l,...r},c)=>e.jsx(yj,{ref:c,className:F(Wr({variant:l}),a),...r}));js.displayName=yj.displayName;const vs=u.forwardRef(({className:a,...l},r)=>e.jsx(wj,{ref:r,className:F(Wr({variant:"outline"}),"mt-2 sm:mt-0",a),...l}));vs.displayName=wj.displayName;function y2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]})}),e.jsxs(Jt,{defaultValue:"appearance",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2 sm:grid-cols-4 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Ye,{value:"appearance",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(k1,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"security",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(nv,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"other",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(bn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"about",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Yt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(ts,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(Cs,{value:"appearance",className:"mt-0",children:e.jsx(w2,{})}),e.jsx(Cs,{value:"security",className:"mt-0",children:e.jsx(_2,{})}),e.jsx(Cs,{value:"other",className:"mt-0",children:e.jsx(S2,{})}),e.jsx(Cs,{value:"about",className:"mt-0",children:e.jsx(k2,{})})]})]})]})}function Lg(a){const l=document.documentElement,c={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[a];if(c)l.style.setProperty("--primary",c.hsl),c.gradient?(l.style.setProperty("--primary-gradient",c.gradient),l.classList.add("has-gradient")):(l.style.removeProperty("--primary-gradient"),l.classList.remove("has-gradient"));else if(a.startsWith("#")){const d=m=>{m=m.replace("#","");const h=parseInt(m.substring(0,2),16)/255,f=parseInt(m.substring(2,4),16)/255,p=parseInt(m.substring(4,6),16)/255,g=Math.max(h,f,p),N=Math.min(h,f,p);let j=0,b=0;const y=(g+N)/2;if(g!==N){const w=g-N;switch(b=y>.5?w/(2-g-N):w/(g+N),g){case h:j=((f-p)/w+(f<p?6:0))/6;break;case f:j=((p-h)/w+2)/6;break;case p:j=((h-f)/w+4)/6;break}}return`${Math.round(j*360)} ${Math.round(b*100)}% ${Math.round(y*100)}%`};l.style.setProperty("--primary",d(a)),l.style.removeProperty("--primary-gradient"),l.classList.remove("has-gradient")}}function w2(){const{theme:a,setTheme:l}=px(),{enableAnimations:r,setEnableAnimations:c,enableWavesBackground:d,setEnableWavesBackground:m}=Iv(),[h,f]=u.useState(()=>localStorage.getItem("accent-color")||"blue");u.useEffect(()=>{const g=localStorage.getItem("accent-color")||"blue";Lg(g)},[]);const p=g=>{f(g),localStorage.setItem("accent-color",g),Lg(g)};return e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx($m,{value:"light",current:a,onChange:l,label:"",description:""}),e.jsx($m,{value:"dark",current:a,onChange:l,label:"",description:""}),e.jsx($m,{value:"system",current:a,onChange:l,label:"",description:""})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Za,{value:"blue",current:h,onChange:p,label:"",colorClass:"bg-blue-500"}),e.jsx(Za,{value:"purple",current:h,onChange:p,label:"",colorClass:"bg-purple-500"}),e.jsx(Za,{value:"green",current:h,onChange:p,label:"",colorClass:"bg-green-500"}),e.jsx(Za,{value:"orange",current:h,onChange:p,label:"",colorClass:"bg-orange-500"}),e.jsx(Za,{value:"pink",current:h,onChange:p,label:"",colorClass:"bg-pink-500"}),e.jsx(Za,{value:"red",current:h,onChange:p,label:"",colorClass:"bg-red-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Za,{value:"gradient-sunset",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-orange-500 to-pink-500"}),e.jsx(Za,{value:"gradient-ocean",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-500"}),e.jsx(Za,{value:"gradient-forest",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-green-500 to-emerald-500"}),e.jsx(Za,{value:"gradient-aurora",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-purple-500 to-pink-500"}),e.jsx(Za,{value:"gradient-fire",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-red-500 to-orange-500"}),e.jsx(Za,{value:"gradient-twilight",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"color",value:h.startsWith("#")?h:"#3b82f6",onChange:g=>p(g.target.value),className:"h-10 sm:h-12 w-full rounded-lg border-2 border-border cursor-pointer",title:""})}),e.jsx("div",{className:"flex-1",children:e.jsx(le,{type:"text",value:h,onChange:g=>p(g.target.value),placeholder:"#3b82f6",className:"font-mono text-sm"})})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-2",children:" HEX "})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"animations",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"animations",checked:r,onCheckedChange:c})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"waves-background",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"waves-background",checked:d,onCheckedChange:m})]})})]})]})]})}function _2(){const a=ha(),[l,r]=u.useState(""),[c,d]=u.useState(""),[m,h]=u.useState(!1),[f,p]=u.useState(!1),[g,N]=u.useState(!1),[j,b]=u.useState(!1),[y,w]=u.useState(!1),[A,M]=u.useState(!1),[S,I]=u.useState(""),[E,C]=u.useState(!1),{toast:R}=nt(),H=u.useMemo(()=>u2(c),[c]),O=async ce=>{if(!l){R({title:"",description:"Token  Cookie  Token",variant:"destructive"});return}try{await navigator.clipboard.writeText(ce),w(!0),R({title:"",description:"Token "}),setTimeout(()=>w(!1),2e3)}catch{R({title:"",description:" Token",variant:"destructive"})}},X=async()=>{if(!c.trim()){R({title:"",description:" Token",variant:"destructive"});return}if(!H.isValid){const ce=H.rules.filter(ge=>!ge.passed).map(ge=>ge.label).join(", ");R({title:"",description:`Token : ${ce}`,variant:"destructive"});return}N(!0);try{const ce=await fetch("/api/webui/auth/update",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({new_token:c.trim()})}),ge=await ce.json();ce.ok&&ge.success?(d(""),r(c.trim()),R({title:"",description:"Access Token "}),setTimeout(()=>{a({to:"/auth"})},1500)):R({title:"",description:ge.message||" Token",variant:"destructive"})}catch(ce){console.error(" Token :",ce),R({title:"",description:"",variant:"destructive"})}finally{N(!1)}},L=async()=>{b(!0);try{const ce=await fetch("/api/webui/auth/regenerate",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),ge=await ce.json();ce.ok&&ge.success?(r(ge.token),I(ge.token),M(!0),C(!1),R({title:"",description:" Access Token "})):R({title:"",description:ge.message||" Token",variant:"destructive"})}catch(ce){console.error(" Token :",ce),R({title:"",description:"",variant:"destructive"})}finally{b(!1)}},me=async()=>{try{await navigator.clipboard.writeText(S),C(!0),R({title:"",description:"Token "})}catch{R({title:"",description:" Token",variant:"destructive"})}},Ne=()=>{M(!1),setTimeout(()=>{I(""),C(!1)},300),setTimeout(()=>{a({to:"/auth"})},500)},je=ce=>{ce||Ne()};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(Qs,{open:A,onOpenChange:je,children:e.jsxs(Hs,{className:"sm:max-w-md",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-yellow-500"})," Access Token"]}),e.jsx(at,{children:" Token"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-2 border-primary/20 bg-primary/5 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-2 block",children:" Token (64)"}),e.jsx("div",{className:"font-mono text-sm break-all select-all bg-background p-3 rounded border",children:S})]}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ft,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token "}),e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:" Token "})]})]})]})})]}),e.jsxs(ft,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:me,className:"gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"h-4 w-4"})," Token"]})}),e.jsx(_,{onClick:Ne,children:""})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"current-token",className:"text-sm",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(le,{id:"current-token",type:m?"text":"password",value:l||"",readOnly:!0,className:"pr-10 font-mono text-sm",placeholder:"Token  Cookie "}),e.jsx("button",{onClick:()=>{l?h(!m):R({title:"",description:'Token  Cookie  Token ""'})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:m?"":"",children:m?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:()=>O(l),title:"",className:"flex-shrink-0",disabled:!l,children:y?e.jsx(Lt,{className:"h-4 w-4 text-green-500"}):e.jsx(Fo,{className:"h-4 w-4"})}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:j,className:"gap-2 flex-1 sm:flex-none",children:[e.jsx(mt,{className:F("h-4 w-4",j&&"animate-spin")}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:" Token"}),e.jsx(gs,{children:" 64  Token   Token "})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:L,children:""})]})]})]})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:" Access Token"})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"new-token",className:"text-sm",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{id:"new-token",type:f?"text":"password",value:c,onChange:ce=>d(ce.target.value),className:"pr-10 font-mono text-sm",placeholder:" Token"}),e.jsx("button",{onClick:()=>p(!f),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:f?"":"",children:f?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})})]}),c&&e.jsxs("div",{className:"mt-3 space-y-2 p-3 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Token :"}),e.jsx("div",{className:"space-y-1.5",children:H.rules.map(ce=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[ce.passed?e.jsx(st,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(aa,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:F(ce.passed?"text-green-600 dark:text-green-400":"text-muted-foreground"),children:ce.label})]},ce.id))}),H.isValid&&e.jsx("div",{className:"mt-2 pt-2 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Token "})]})})]})]}),e.jsx(_,{onClick:X,disabled:g||!H.isValid||!c,className:"w-full sm:w-auto",children:g?"...":" Token"})]})]}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3 sm:p-4",children:[e.jsx("h4",{className:"text-sm sm:text-base font-semibold text-yellow-900 dark:text-yellow-200 mb-2",children:""}),e.jsxs("ul",{className:"text-xs sm:text-sm text-yellow-800 dark:text-yellow-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:" Token  64 "}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token  Token "}),e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token "})]})]})]})}function S2(){const a=ha(),{toast:l}=nt(),[r,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(()=>zt("logCacheSize")),[p,g]=u.useState(()=>zt("wsReconnectInterval")),[N,j]=u.useState(()=>zt("wsMaxReconnectAttempts")),[b,y]=u.useState(()=>zt("dataSyncInterval")),[w,A]=u.useState(()=>Og()),[M,S]=u.useState(!1),[I,E]=u.useState(!1),C=u.useRef(null);if(d)throw new Error("");const R=()=>{A(Og())},H=D=>{const Q=D[0];f(Q),Kr("logCacheSize",Q)},O=D=>{const Q=D[0];g(Q),Kr("wsReconnectInterval",Q)},X=D=>{const Q=D[0];j(Q),Kr("wsMaxReconnectAttempts",Q)},L=D=>{const Q=D[0];y(Q),Kr("dataSyncInterval",Q)},me=()=>{Gn.clearLogs(),l({title:"",description:""})},Ne=()=>{const D=j2();R(),l({title:"",description:` ${D.clearedKeys.length} `})},je=()=>{S(!0);try{const D=f2(),Q=JSON.stringify(D,null,2),B=new Blob([Q],{type:"application/json"}),ue=URL.createObjectURL(B),Y=document.createElement("a");Y.href=ue,Y.download=`maibot-webui-settings-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(ue),l({title:"",description:" JSON "})}catch(D){console.error(":",D),l({title:"",description:"",variant:"destructive"})}finally{S(!1)}},ce=D=>{const Q=D.target.files?.[0];if(!Q)return;E(!0);const B=new FileReader;B.onload=ue=>{try{const Y=ue.target?.result,_e=JSON.parse(Y),he=p2(_e);he.success?(f(zt("logCacheSize")),g(zt("wsReconnectInterval")),j(zt("wsMaxReconnectAttempts")),y(zt("dataSyncInterval")),R(),l({title:"",description:` ${he.imported.length} ${he.skipped.length>0?` ${he.skipped.length} `:""}`}),(he.imported.includes("theme")||he.imported.includes("accentColor"))&&l({title:"",description:""})):l({title:"",description:"",variant:"destructive"})}catch(Y){console.error(":",Y),l({title:"",description:"",variant:"destructive"})}finally{E(!1),C.current&&(C.current.value="")}},B.readAsText(Q)},ge=()=>{g2(),f(fl.logCacheSize),g(fl.wsReconnectInterval),j(fl.wsMaxReconnectAttempts),y(fl.dataSyncInterval),R(),l({title:"",description:""})},pe=async()=>{c(!0);try{const D=await Se("/api/webui/setup/reset",{method:"POST"}),Q=await D.json();D.ok&&Q.success?(l({title:"",description:""}),setTimeout(()=>{a({to:"/setup"})},1e3)):l({title:"",description:Q.message||"",variant:"destructive"})}catch(D){console.error(":",D),l({title:"",description:"",variant:"destructive"})}finally{c(!1)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Jr,{className:"h-5 w-5"}),""]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(C1,{className:"h-4 w-4"}),""]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:R,className:"h-7 px-2",children:e.jsx(mt,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:v2(w.used)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[w.items," "]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h," "]})]}),e.jsx(Wa,{value:[h],onValueChange:H,min:100,max:5e3,step:100,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[b," "]})]}),e.jsx(Wa,{value:[b],onValueChange:L,min:10,max:120,step:5,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p/1e3," "]})]}),e.jsx(Wa,{value:[p],onValueChange:O,min:1e3,max:1e4,step:500,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" WebSocket "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[N," "]})]}),e.jsx(Wa,{value:[N],onValueChange:X,min:3,max:30,step:1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:me,className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),""]}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{children:" "})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:Ne,children:""})]})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(ra,{className:"h-5 w-5"}),"/"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",onClick:je,disabled:M,className:"gap-2",children:[e.jsx(ra,{className:"h-4 w-4"}),M?"...":""]}),e.jsx("input",{ref:C,type:"file",accept:".json",onChange:ce,className:"hidden"}),e.jsxs(_,{variant:"outline",onClick:()=>C.current?.click(),disabled:I,className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),I?"...":""]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2 text-destructive hover:text-destructive",children:[e.jsx(lc,{className:"h-4 w-4"}),""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{children:" "})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:ge,children:""})]})]})]})})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:r,className:"gap-2",children:[e.jsx(lc,{className:F("h-4 w-4",r&&"animate-spin")}),""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{children:""})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:pe,children:""})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-dashed border-yellow-500/50 bg-yellow-500/5 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-yellow-500"}),""]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{variant:"destructive",className:"gap-2",children:[e.jsx(Ft,{className:"h-4 w-4"}),""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{children:" React  "})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>m(!0),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})]})]})]})]})}function k2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"rounded-lg border-2 border-primary/30 bg-gradient-to-r from-primary/5 to-primary/10 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-shrink-0 rounded-lg bg-primary/10 p-2 sm:p-3",children:e.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3",children:" GitHub  Star  "}),e.jsxs("a",{href:"https://github.com/Mai-with-u/MaiBot-Dashboard",target:"_blank",rel:"noopener noreferrer",className:F("inline-flex items-center gap-2 px-4 py-2 rounded-lg","bg-primary text-primary-foreground font-medium text-sm","hover:bg-primary/90 transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})," GitHub",e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:[" ",gx]}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("p",{children:[": ",od]}),e.jsx("p",{children:"MaiBot Web "})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"MaiBot "}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Mai-with-u"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"WebUI"}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Mai-with-u ",e.jsx("a",{href:"https://github.com/DrSmoothl",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"@MotricSeven"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"React 19.2.0"}),e.jsx("li",{children:"TypeScript 5.7.2"}),e.jsx("li",{children:"Vite 6.0.7"}),e.jsx("li",{children:"TanStack Router 1.94.2"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:"UI "}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"shadcn/ui"}),e.jsx("li",{children:"Radix UI"}),e.jsx("li",{children:"Tailwind CSS 3.4.17"}),e.jsx("li",{children:"Lucide Icons"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Python 3.12+"}),e.jsx("li",{children:"FastAPI"}),e.jsx("li",{children:"Uvicorn"}),e.jsx("li",{children:"WebSocket"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Bun / npm"}),e.jsx("li",{children:"ESLint 9.17.0"}),e.jsx("li",{children:"PostCSS"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-3",children:""}),e.jsx(ts,{className:"h-[300px] sm:h-[400px]",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"UI "}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Tt,{name:"React",description:"",license:"MIT"}),e.jsx(Tt,{name:"shadcn/ui",description:" React ",license:"MIT"}),e.jsx(Tt,{name:"Radix UI",description:"",license:"MIT"}),e.jsx(Tt,{name:"Tailwind CSS",description:" CSS ",license:"MIT"}),e.jsx(Tt,{name:"Lucide React",description:"",license:"ISC"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Tt,{name:"TanStack Router",description:"",license:"MIT"}),e.jsx(Tt,{name:"Zustand",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Tt,{name:"React Hook Form",description:"",license:"MIT"}),e.jsx(Tt,{name:"Zod",description:"TypeScript  schema ",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Tt,{name:"clsx",description:" className ",license:"MIT"}),e.jsx(Tt,{name:"tailwind-merge",description:"Tailwind ",license:"MIT"}),e.jsx(Tt,{name:"class-variance-authority",description:"",license:"Apache-2.0"}),e.jsx(Tt,{name:"date-fns",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Tt,{name:"Framer Motion",description:"React ",license:"MIT"}),e.jsx(Tt,{name:"vaul",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Tt,{name:"FastAPI",description:" Python Web ",license:"MIT"}),e.jsx(Tt,{name:"Uvicorn",description:"ASGI ",license:"BSD-3-Clause"}),e.jsx(Tt,{name:"Pydantic",description:"",license:"MIT"}),e.jsx(Tt,{name:"python-multipart",description:"",license:"Apache-2.0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Tt,{name:"TypeScript",description:"JavaScript ",license:"Apache-2.0"}),e.jsx(Tt,{name:"Vite",description:"",license:"MIT"}),e.jsx(Tt,{name:"ESLint",description:"JavaScript ",license:"MIT"}),e.jsx(Tt,{name:"PostCSS",description:"CSS ",license:"MIT"})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/5 border border-primary/20 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:"rounded-md bg-primary/10 px-2 py-1",children:e.jsx("span",{className:"text-xs sm:text-sm font-bold text-primary",children:"GPLv3"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm sm:text-base font-semibold text-foreground mb-1",children:"MaiBot WebUI"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" GNU General Public License v3.0  "})]})]})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"MITApache-2.0BSD  "})]})]})]})}function Tt({name:a,description:l,license:r}){return e.jsxs("div",{className:"flex items-start justify-between gap-2 rounded-lg border bg-muted/30 p-2.5 sm:p-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:a}),e.jsx("p",{className:"text-muted-foreground text-xs mt-0.5",children:l})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary flex-shrink-0",children:r})]})}function $m({value:a,current:l,onChange:r,label:c,description:d}){const m=l===a;return e.jsxs("button",{onClick:()=>r(a),className:F("relative rounded-lg border-2 p-3 sm:p-4 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",m?"border-primary bg-accent":"border-border"),children:[m&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3 h-2 w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm sm:text-base font-medium",children:c}),e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:d})]}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex gap-1",children:[a==="light"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-200"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-400"})]}),a==="dark"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"})]}),a==="system"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-200 to-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-300 to-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-400 to-slate-900"})]})]})]})}function Za({value:a,current:l,onChange:r,label:c,colorClass:d}){const m=l===a;return e.jsxs("button",{onClick:()=>r(a),className:F("relative rounded-lg border-2 p-2 sm:p-3 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",m?"border-primary bg-accent":"border-border"),children:[m&&e.jsx("div",{className:"absolute top-1.5 right-1.5 sm:top-2 sm:right-2 h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"flex flex-col items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:F("h-8 w-8 sm:h-10 sm:w-10 rounded-full",d)}),e.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-center",children:c})]})]})}const C2=Date.now()%1e6;class T2{grad3;p;perm;constructor(l=0){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];for(let r=0;r<256;r++)this.p[r]=Math.floor(Math.random()*256);this.perm=[];for(let r=0;r<512;r++)this.perm[r]=this.p[r&255]}dot(l,r,c){return l[0]*r+l[1]*c}mix(l,r,c){return(1-c)*l+c*r}fade(l){return l*l*l*(l*(l*6-15)+10)}perlin2(l,r){const c=Math.floor(l)&255,d=Math.floor(r)&255;l-=Math.floor(l),r-=Math.floor(r);const m=this.fade(l),h=this.fade(r),f=this.perm[c]+d,p=this.perm[f],g=this.perm[f+1],N=this.perm[c+1]+d,j=this.perm[N],b=this.perm[N+1];return this.mix(this.mix(this.dot(this.grad3[p%12],l,r),this.dot(this.grad3[j%12],l-1,r),m),this.mix(this.dot(this.grad3[g%12],l,r-1),this.dot(this.grad3[b%12],l-1,r-1),m),h)}}function Ug(){const a=u.useRef(null),l=u.useRef(null),r=u.useRef(void 0),[c]=u.useState(()=>new T2(C2)),d=u.useRef({mouse:{x:-10,y:0,lx:0,ly:0,sx:0,sy:0,v:0,vs:0,a:0,set:!1},lines:[],paths:[],noise:c,bounding:null});return u.useEffect(()=>{const m=l.current,h=a.current;if(!m||!h)return;const f=d.current;f.noise=c;const p=()=>{const M=m.getBoundingClientRect();f.bounding=M,h.style.width=`${M.width}px`,h.style.height=`${M.height}px`},g=()=>{if(!f.bounding)return;const{width:M,height:S}=f.bounding;f.lines=[],f.paths.forEach(me=>me.remove()),f.paths=[];const I=10,E=32,C=M+200,R=S+30,H=Math.ceil(C/I),O=Math.ceil(R/E),X=(M-I*H)/2,L=(S-E*O)/2;for(let me=0;me<=H;me++){const Ne=[];for(let ce=0;ce<=O;ce++){const ge={x:X+I*me,y:L+E*ce,wave:{x:0,y:0},cursor:{x:0,y:0,vx:0,vy:0}};Ne.push(ge)}const je=document.createElementNS("http://www.w3.org/2000/svg","path");h.appendChild(je),f.paths.push(je),f.lines.push(Ne)}},N=M=>{const{lines:S,mouse:I,noise:E}=f;S.forEach(C=>{C.forEach(R=>{const H=E.perlin2((R.x+M*.0125)*.002,(R.y+M*.005)*.0015)*12;R.wave.x=Math.cos(H)*32,R.wave.y=Math.sin(H)*16;const O=R.x-I.sx,X=R.y-I.sy,L=Math.hypot(O,X),me=Math.max(175,I.vs);if(L<me){const Ne=1-L/me,je=Math.cos(L*.001)*Ne;R.cursor.vx+=Math.cos(I.a)*je*me*I.vs*65e-5,R.cursor.vy+=Math.sin(I.a)*je*me*I.vs*65e-5}R.cursor.vx+=(0-R.cursor.x)*.005,R.cursor.vy+=(0-R.cursor.y)*.005,R.cursor.vx*=.925,R.cursor.vy*=.925,R.cursor.x+=R.cursor.vx*2,R.cursor.y+=R.cursor.vy*2,R.cursor.x=Math.min(100,Math.max(-100,R.cursor.x)),R.cursor.y=Math.min(100,Math.max(-100,R.cursor.y))})})},j=(M,S=!0)=>{const I={x:M.x+M.wave.x+(S?M.cursor.x:0),y:M.y+M.wave.y+(S?M.cursor.y:0)};return I.x=Math.round(I.x*10)/10,I.y=Math.round(I.y*10)/10,I},b=()=>{const{lines:M,paths:S}=f;M.forEach((I,E)=>{let C=j(I[0],!1),R=`M ${C.x} ${C.y}`;I.forEach((H,O)=>{const X=O===I.length-1;C=j(H,!X),R+=`L ${C.x} ${C.y}`}),S[E].setAttribute("d",R)})},y=M=>{const{mouse:S}=f;S.sx+=(S.x-S.sx)*.1,S.sy+=(S.y-S.sy)*.1;const I=S.x-S.lx,E=S.y-S.ly,C=Math.hypot(I,E);S.v=C,S.vs+=(C-S.vs)*.1,S.vs=Math.min(100,S.vs),S.lx=S.x,S.ly=S.y,S.a=Math.atan2(E,I),m&&(m.style.setProperty("--x",`${S.sx}px`),m.style.setProperty("--y",`${S.sy}px`)),N(M),b(),r.current=requestAnimationFrame(y)},w=M=>{if(!f.bounding)return;const{mouse:S}=f;S.x=M.pageX-f.bounding.left,S.y=M.pageY-f.bounding.top+window.scrollY,S.set||(S.sx=S.x,S.sy=S.y,S.lx=S.x,S.ly=S.y,S.set=!0)},A=()=>{p(),g()};return p(),g(),window.addEventListener("resize",A),window.addEventListener("mousemove",w),r.current=requestAnimationFrame(y),()=>{window.removeEventListener("resize",A),window.removeEventListener("mousemove",w),r.current&&cancelAnimationFrame(r.current)}},[c]),e.jsxs("div",{ref:l,className:"waves-background",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},children:[e.jsx("div",{className:"waves-cursor",style:{position:"absolute",top:0,left:0,width:"0.5rem",height:"0.5rem",background:"hsl(var(--primary) / 0.3)",borderRadius:"50%",transform:"translate3d(calc(var(--x, -0.5rem) - 50%), calc(var(--y, 50%) - 50%), 0)",willChange:"transform",pointerEvents:"none"}}),e.jsx("svg",{ref:a,style:{display:"block",width:"100%",height:"100%"},children:e.jsx("style",{children:`
          path {
            fill: none;
            stroke: hsl(var(--primary) / 0.20);
            stroke-width: 1px;
          }
        `})})]})}function E2(){const[a,l]=u.useState(""),[r,c]=u.useState(!1),[d,m]=u.useState(""),[h,f]=u.useState(!0),p=ha(),{enableWavesBackground:g,setEnableWavesBackground:N}=Iv(),{theme:j,setTheme:b}=px();u.useEffect(()=>{(async()=>{try{await cc()&&p({to:"/"})}catch{}finally{f(!1)}})()},[p]);const w=j==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":j,A=()=>{b(w==="dark"?"light":"dark")},M=async S=>{if(S.preventDefault(),m(""),!a.trim()){m(" Access Token");return}c(!0),console.log(" token...");try{const I=await fetch("/api/webui/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:a.trim()})});console.log("Token :",I.status);const E=await I.json();if(console.log("Token :",E),I.ok&&E.valid){console.log("Token ..."),console.log("is_first_setup:",E.is_first_setup),await new Promise(R=>setTimeout(R,100));const C=await cc();console.log(":",C),E.is_first_setup?(console.log(""),p({to:"/setup"})):(console.log(""),p({to:"/"}))}else console.error("Token :",E.message),m(E.message||"Token ")}catch(I){console.error("Token :",I),m("")}finally{c(!1)}};return h?e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Ug,{}),e.jsx("div",{className:"text-muted-foreground",children:"..."})]}):e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Ug,{}),e.jsxs(Ce,{className:"relative z-10 w-full max-w-md shadow-2xl backdrop-blur-xl bg-card/80 border-border/50",children:[e.jsx("button",{onClick:A,className:"absolute right-4 top-4 rounded-lg p-2 hover:bg-accent transition-colors z-10 text-foreground",title:w==="dark"?"":"",children:w==="dark"?e.jsx(nx,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"}):e.jsx(ec,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"})}),e.jsxs(Oe,{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(Sg,{className:"h-8 w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($e,{className:"text-2xl font-bold",children:" MaiBot"}),e.jsx(Ns,{className:"text-base",children:" Access Token "})]})]}),e.jsx(ze,{children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"token",className:"text-sm font-medium",children:"Access Token"}),e.jsxs("div",{className:"relative",children:[e.jsx(rx,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground",strokeWidth:2,fill:"none"}),e.jsx(le,{id:"token",type:"password",placeholder:" Access Token",value:a,onChange:S=>l(S.target.value),className:F("pl-10",d&&"border-red-500 focus-visible:ring-red-500"),disabled:r,autoFocus:!0,autoComplete:"off"})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-red-50 p-3 text-sm text-red-600 dark:bg-red-950/50 dark:text-red-400",children:[e.jsx(Rt,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{children:d})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):""}),e.jsxs(Qs,{children:[e.jsx(cd,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-primary hover:text-primary/80 transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(rv,{className:"h-4 w-4",strokeWidth:2,fill:"none"})," Token Token"]})}),e.jsxs(Hs,{className:"sm:max-w-md",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(Sg,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"})," Access Token"]}),e.jsx(at,{children:"Access Token  MaiBot WebUI "})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T1,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" MaiBot  WebUI Access Token"}),e.jsxs("div",{className:"rounded bg-background p-2 font-mono text-xs",children:[e.jsx("p",{className:"text-muted-foreground",children:" WebUI Access Token: abc123..."}),e.jsx("p",{className:"text-muted-foreground",children:"  Token  WebUI"})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(La,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Token "}),e.jsx("div",{className:"rounded bg-background p-2 font-mono text-xs break-all",children:e.jsx("code",{className:"text-primary",children:"data/webui.json"})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",e.jsx("code",{className:"px-1 py-0.5 bg-background rounded",children:"access_token"})," "]})]})]})}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Rt,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token"})]})]})]})})]})]})]}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(el,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsxs(ps,{className:"flex items-center gap-2",children:[e.jsx(el,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"}),""]}),e.jsx(gs,{children:""})]}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>N(!1),children:""})]})]})]})]})})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:m2})})]})}const ht=u.forwardRef(({className:a,autoResize:l=!0,minHeight:r=60,maxHeight:c,value:d,onChange:m,...h},f)=>{const p=u.useRef(null),[g,N]=u.useState(!1);u.useImperativeHandle(f,()=>p.current),u.useEffect(()=>{if(a){const y=/\b(h-\d+|h-\[[\d.]+(?:px|rem|em)\]|min-h-\[[\d.]+(?:px|rem|em)\])\b/.test(a);N(y)}},[a]);const j=u.useCallback(()=>{const y=p.current;if(!y||!l||g)return;y.style.height="auto";const w=y.scrollHeight;let A=Math.max(w,r);c&&c>0&&(A=Math.min(A,c)),y.style.height=`${A}px`,c&&c>0&&w>c?y.style.overflowY="auto":y.style.overflowY="hidden"},[l,g,r,c]);u.useEffect(()=>{j()},[d,j]),u.useEffect(()=>{j()},[j]);const b=u.useCallback(y=>{m?.(y),requestAnimationFrame(()=>{j()})},[m,j]);return e.jsx("textarea",{className:F("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","custom-scrollbar",l&&!g&&"resize-none overflow-hidden",a),ref:p,value:d,onChange:b,style:{minHeight:l&&!g?`${r}px`:void 0},...h})});ht.displayName="Textarea";const na=u.forwardRef(({className:a,orientation:l="horizontal",decorative:r=!0,...c},d)=>e.jsx(_j,{ref:d,decorative:r,orientation:l,className:F("shrink-0 bg-border",l==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",a),...c}));na.displayName=_j.displayName;function M2({config:a,onChange:l}){const r=d=>{d.trim()&&!a.alias_names.includes(d.trim())&&l({...a,alias_names:[...a.alias_names,d.trim()]})},c=d=>{l({...a,alias_names:a.alias_names.filter((m,h)=>h!==d)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ *"}),e.jsx(le,{id:"qq_account",type:"number",placeholder:"QQ",value:a.qq_account||"",onChange:d=>l({...a,qq_account:Number(d.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"QQ"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"nickname",children:" *"}),e.jsx(le,{id:"nickname",placeholder:"",value:a.nickname,onChange:d=>l({...a,nickname:d.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{children:""}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:a.alias_names.map((d,m)=>e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[d,e.jsx("button",{type:"button",onClick:()=>c(m),className:"ml-1 hover:text-destructive",children:e.jsx(Sa,{className:"h-3 w-3"})})]},m))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{id:"alias_input",placeholder:"",onKeyPress:d=>{d.key==="Enter"&&(r(d.target.value),d.target.value="")}}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>{const d=document.getElementById("alias_input");d&&(r(d.value),d.value="")},children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function A2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"personality",children:" *"}),e.jsx(ht,{id:"personality",placeholder:"120",value:a.personality,onChange:r=>l({...a,personality:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"reply_style",children:" *"}),e.jsx(ht,{id:"reply_style",placeholder:"",value:a.reply_style,onChange:r=>l({...a,reply_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"interest",children:" *"}),e.jsx(ht,{id:"interest",placeholder:"",value:a.interest,onChange:r=>l({...a,interest:r.target.value}),rows:2}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"plan_style",children:" *"}),e.jsx(ht,{id:"plan_style",placeholder:"",value:a.plan_style,onChange:r=>l({...a,plan_style:r.target.value}),rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"private_plan_style",children:" *"}),e.jsx(ht,{id:"private_plan_style",placeholder:"",value:a.private_plan_style,onChange:r=>l({...a,private_plan_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function z2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[(a.emoji_chance*100).toFixed(0),"%"]})]}),e.jsx(le,{id:"emoji_chance",type:"range",min:"0",max:"1",step:"0.1",value:a.emoji_chance,onChange:r=>l({...a,emoji_chance:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(le,{id:"max_reg_num",type:"number",min:"1",max:"200",value:a.max_reg_num,onChange:r=>l({...a,max_reg_num:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"do_replace",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"do_replace",checked:a.do_replace,onCheckedChange:r=>l({...a,do_replace:r})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(le,{id:"check_interval",type:"number",min:"1",max:"120",value:a.check_interval,onChange:r=>l({...a,check_interval:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(na,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"steal_emoji",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"steal_emoji",checked:a.steal_emoji,onCheckedChange:r=>l({...a,steal_emoji:r})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"content_filtration",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"content_filtration",checked:a.content_filtration,onCheckedChange:r=>l({...a,content_filtration:r})})]}),a.content_filtration&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(le,{id:"filtration_prompt",placeholder:"",value:a.filtration_prompt,onChange:r=>l({...a,filtration_prompt:r.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function R2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"enable_tool",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"enable_tool",checked:a.enable_tool,onCheckedChange:r=>l({...a,enable_tool:r})})]}),e.jsx(na,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"all_global",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"all_global",checked:a.all_global,onCheckedChange:r=>l({...a,all_global:r})})]})]})}function D2({config:a,onChange:l}){const[r,c]=u.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:" (SiliconFlow)"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 mb-2",children:" DeepSeek V3Qwen  API Key "}),e.jsxs("a",{href:"https://cloud.siliconflow.cn",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:underline font-medium",children:[" API Key",e.jsx($o,{className:"h-3 w-3"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"siliconflow_api_key",children:"SiliconFlow API Key *"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{id:"siliconflow_api_key",type:r?"text":"password",placeholder:"sk-...",value:a.api_key,onChange:d=>l({api_key:d.target.value}),className:"font-mono pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!r),children:r?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" API "})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground ml-2",children:[e.jsx("li",{children:"DeepSeek V3 - "}),e.jsx("li",{children:"Qwen3 30B - "}),e.jsx("li",{children:"Qwen3 VL 30B - "}),e.jsx("li",{children:"SenseVoice - "}),e.jsx("li",{children:"BGE-M3 - "}),e.jsx("li",{children:" (LPMM)"})]})]}),e.jsx("div",{className:"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 p-4",children:e.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-medium",children:" "}),'"  " API ']})})]})}async function O2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Zs()});if(!a.ok)throw new Error("Bot");const r=(await a.json()).config.bot||{};return{qq_account:r.qq_account||0,nickname:r.nickname||"",alias_names:r.alias_names||[]}}async function L2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Zs()});if(!a.ok)throw new Error("");const r=(await a.json()).config.personality||{};return{personality:r.personality||"",reply_style:r.reply_style||"",interest:r.interest||"",plan_style:r.plan_style||"",private_plan_style:r.private_plan_style||""}}async function U2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Zs()});if(!a.ok)throw new Error("");const r=(await a.json()).config.emoji||{};return{emoji_chance:r.emoji_chance??.4,max_reg_num:r.max_reg_num??40,do_replace:r.do_replace??!0,check_interval:r.check_interval??10,steal_emoji:r.steal_emoji??!0,content_filtration:r.content_filtration??!1,filtration_prompt:r.filtration_prompt||""}}async function $2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Zs()});if(!a.ok)throw new Error("");const r=(await a.json()).config,c=r.tool||{},d=r.expression||{};return{enable_tool:c.enable_tool??!0,all_global:d.all_global_jargon??!0}}async function B2(){const a=await Se("/api/webui/config/model",{method:"GET",headers:Zs()});if(!a.ok)throw new Error("");return{api_key:((await a.json()).config.api_providers||[]).find(m=>m.name==="SiliconFlow")?.api_key||""}}async function P2(a){const l=await Se("/api/webui/config/bot/section/bot",{method:"POST",headers:Zs(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"Bot")}return await l.json()}async function I2(a){const l=await Se("/api/webui/config/bot/section/personality",{method:"POST",headers:Zs(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function F2(a){const l=await Se("/api/webui/config/bot/section/emoji",{method:"POST",headers:Zs(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function H2(a){const l=[];l.push(Se("/api/webui/config/bot/section/tool",{method:"POST",headers:Zs(),body:JSON.stringify({enable_tool:a.enable_tool})})),l.push(Se("/api/webui/config/bot/section/expression",{method:"POST",headers:Zs(),body:JSON.stringify({all_global_jargon:a.all_global})}));const r=await Promise.all(l);for(const c of r)if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return{success:!0}}async function q2(a){const l=await Se("/api/webui/config/model",{method:"GET",headers:Zs()});if(!l.ok)throw new Error("");const c=(await l.json()).config,d=c.api_providers||[],m=d.findIndex(p=>p.name==="SiliconFlow");m>=0?d[m]={...d[m],api_key:a.api_key}:d.push({name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",api_key:a.api_key,client_type:"openai",max_retry:3,timeout:120,retry_interval:5});const h={...c,api_providers:d},f=await Se("/api/webui/config/model",{method:"POST",headers:Zs(),body:JSON.stringify(h)});if(!f.ok){const p=await f.json();throw new Error(p.detail||"")}return await f.json()}async function $g(){const a=await Se("/api/webui/setup/complete",{method:"POST"});if(!a.ok){const l=await a.json();throw new Error(l.message||"")}return await a.json()}function V2(){return e.jsx(tr,{children:e.jsx(G2,{})})}function G2(){const a=ha(),{toast:l}=nt(),{triggerRestart:r}=_n(),[c,d]=u.useState(0),[m,h]=u.useState(!1),[f,p]=u.useState(!1),[g,N]=u.useState(!0),[j,b]=u.useState({qq_account:0,nickname:"",alias_names:[]}),[y,w]=u.useState({personality:"",reply_style:"",interest:"",plan_style:`1.****action****
2.
3.
4.
5.`,private_plan_style:`1.****action****
2.
3.`}),[A,M]=u.useState({emoji_chance:.4,max_reg_num:40,do_replace:!0,check_interval:10,steal_emoji:!0,content_filtration:!1,filtration_prompt:""}),[S,I]=u.useState({enable_tool:!0,all_global:!0}),[E,C]=u.useState({api_key:""}),R=[{id:"bot-basic",title:"Bot",description:"",icon:Kn},{id:"personality",title:"",description:"",icon:$l},{id:"emoji",title:"",description:"",icon:ld},{id:"other",title:"",description:"",icon:bn},{id:"siliconflow",title:"API",description:"API",icon:rx}],H=(c+1)/R.length*100;u.useEffect(()=>{(async()=>{try{N(!0);const[ge,pe,D,Q,B]=await Promise.all([O2(),L2(),U2(),$2(),B2()]);b(ge),w(pe),M(D),I(Q),C(B)}catch(ge){l({title:"",description:ge instanceof Error?ge.message:"",variant:"destructive"})}finally{N(!1)}})()},[l]);const O=async()=>{p(!0);try{switch(c){case 0:await P2(j);break;case 1:await I2(y);break;case 2:await F2(A);break;case 3:await H2(S);break;case 4:await q2(E);break}return l({title:"",description:`${R[c].title}`}),!0}catch(ce){return l({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"}),!1}finally{p(!1)}},X=async()=>{await O()&&c<R.length-1&&d(c+1)},L=()=>{c>0&&d(c-1)},me=async()=>{h(!0);try{if(!await O()){h(!1);return}await $g(),l({title:"",description:"..."}),await r()}catch(ce){l({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{h(!1)}},Ne=async()=>{try{await $g(),a({to:"/"})}catch(ce){l({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}},je=()=>{switch(c){case 0:return e.jsx(M2,{config:j,onChange:b});case 1:return e.jsx(A2,{config:y,onChange:w});case 2:return e.jsx(z2,{config:A,onChange:M});case 3:return e.jsx(R2,{config:S,onChange:I});case 4:return e.jsx(D2,{config:E,onChange:C});default:return null}};return e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center justify-center overflow-hidden bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4 md:p-6",children:[e.jsx(ar,{}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute left-1/4 top-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-primary/5 blur-3xl"}),e.jsx("div",{className:"absolute right-1/4 bottom-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-secondary/5 blur-3xl"})]}),g?e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center",children:e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative z-10 w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6 md:mb-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 md:h-16 md:w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(E1,{className:"h-6 w-6 md:h-8 md:w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsx("h1",{className:"mb-2 text-2xl md:text-3xl font-bold",children:""}),e.jsxs("p",{className:"text-sm md:text-base text-muted-foreground",children:[" ",gx," "]})]}),e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs md:text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[" ",c+1," / ",R.length]}),e.jsxs("span",{className:"font-medium text-primary",children:[Math.round(H),"%"]})]}),e.jsx(er,{value:H,className:"h-2"})]}),e.jsx("div",{className:"mb-6 md:mb-8 flex justify-between",children:R.map((ce,ge)=>{const pe=ce.icon;return e.jsxs("div",{className:F("flex flex-1 flex-col items-center gap-1 md:gap-2",ge<R.length-1&&"relative"),children:[ge<R.length-1&&e.jsx("div",{className:F("absolute left-1/2 top-3 md:top-4 h-0.5 w-full",ge<c?"bg-primary":"bg-border")}),e.jsx("div",{className:F("relative z-10 flex h-6 w-6 md:h-8 md:w-8 items-center justify-center rounded-full border-2 transition-all",ge===c||ge<c?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-muted-foreground"),children:ge<c?e.jsx(st,{className:"h-3 w-3 md:h-4 md:w-4",strokeWidth:2.5,fill:"none"}):e.jsx(pe,{className:"h-3 w-3 md:h-4 md:w-4"})}),e.jsx("span",{className:F("text-[10px] md:text-xs text-center max-w-[60px] md:max-w-none truncate md:whitespace-normal",ge===c?"font-medium text-foreground":"text-muted-foreground"),title:ce.title,children:ce.title})]},ce.id)})}),e.jsx(Ce,{className:"mb-6 md:mb-8 shadow-lg",children:e.jsx(ze,{className:"p-4 md:p-8",children:e.jsxs("div",{className:"min-h-[300px] md:min-h-[400px]",children:[e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsx("h2",{className:"mb-2 text-xl md:text-2xl font-semibold",children:R[c].title}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:R[c].description})]}),e.jsx(ts,{className:"h-[400px] md:h-[500px]",children:e.jsx("div",{className:"pr-2",children:je()})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:L,disabled:c===0||f,className:"w-full sm:w-auto order-2 sm:order-1",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto order-1 sm:order-2",children:[e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"flex-1 sm:flex-none gap-2",disabled:f||m,children:[e.jsx(M1,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{children:""})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:Ne,children:""})]})]})]}),c===R.length-1?e.jsx(_,{onClick:me,disabled:m||f,className:"flex-1 sm:flex-none",children:m||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),f?"...":"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(st,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})}):e.jsx(_,{onClick:X,disabled:f,className:"flex-1 sm:flex-none",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(A1,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})})]})]})]}),e.jsx("div",{className:"relative z-10 mt-6 md:mt-8 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:""})})]})]})}function qv(){const a=ha();return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("h1",{className:"text-[150px] font-black leading-none text-primary/10 select-none sm:text-[200px]",children:"404"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Ut,{className:"h-20 w-20 text-primary/30 sm:h-24 sm:w-24"})})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground sm:text-3xl",children:""}),e.jsx("p",{className:"text-base text-muted-foreground sm:text-lg max-w-md mx-auto",children:" URL "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs(_,{size:"lg",onClick:()=>a({to:"/"}),className:"gap-2 w-full sm:w-auto",children:[e.jsx(nd,{className:"h-4 w-4"}),""]}),e.jsxs(_,{size:"lg",variant:"outline",onClick:()=>window.history.back(),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Ua,{className:"h-4 w-4"}),""]})]}),e.jsx("div",{className:"mt-12 pt-8 border-t border-border",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})})]})})}const K2=Ps.memo(function({config:l,onChange:r}){const c=l.platforms||[],d=l.alias_names||[],m=()=>{r({...l,platforms:[...c,""]})},h=j=>{r({...l,platforms:c.filter((b,y)=>y!==j)})},f=(j,b)=>{const y=[...c];y[j]=b,r({...l,platforms:y})},p=()=>{r({...l,alias_names:[...d,""]})},g=j=>{r({...l,alias_names:d.filter((b,y)=>y!==j)})},N=(j,b)=>{const y=[...d];y[j]=b,r({...l,alias_names:y})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"platform",children:""}),e.jsx(le,{id:"platform",value:l.platform,onChange:j=>r({...l,platform:j.target.value}),placeholder:"qq"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ"}),e.jsx(le,{id:"qq_account",value:l.qq_account,onChange:j=>r({...l,qq_account:j.target.value}),placeholder:"123456789"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(le,{id:"nickname",value:l.nickname,onChange:j=>r({...l,nickname:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:p,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[d.map((j,b)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:j,onChange:y=>N(b,y.target.value),placeholder:""}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',j||"()",'" ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>g(b),children:""})]})]})]})]},b)),d.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:m,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((j,b)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:j,onChange:y=>f(b,y.target.value),placeholder:"wx:114514"}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',j||"()",'" ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>h(b),children:""})]})]})]})]},b)),c.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})]})})}),Q2=Ps.memo(function({config:l,onChange:r}){const c=()=>{r({...l,states:[...l.states,""]})},d=h=>{r({...l,states:l.states.filter((f,p)=>p!==h)})},m=(h,f)=>{const p=[...l.states];p[h]=f,r({...l,states:p})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"personality",children:""}),e.jsx(ht,{id:"personality",value:l.personality,onChange:h=>r({...l,personality:h.target.value}),placeholder:"120",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"120"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"space-y-2",children:l.states.map((h,f)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ht,{value:h,onChange:p=>m(f,p.target.value),placeholder:"",rows:2}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{children:""})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>d(f),children:""})]})]})]})]},f))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"state_probability",children:""}),e.jsx(le,{id:"state_probability",type:"number",step:"0.1",min:"0",max:"1",value:l.state_probability,onChange:h=>r({...l,state_probability:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.0-1.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"reply_style",children:""}),e.jsx(ht,{id:"reply_style",value:l.reply_style,onChange:h=>r({...l,reply_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_style",children:""}),e.jsx(ht,{id:"plan_style",value:l.plan_style,onChange:h=>r({...l,plan_style:h.target.value}),placeholder:"",rows:5})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"visual_style",children:""}),e.jsx(ht,{id:"visual_style",value:l.visual_style,onChange:h=>r({...l,visual_style:h.target.value}),placeholder:"",rows:3})]})]})]})})}),rl=_w,il=Sw,sl=u.forwardRef(({className:a,align:l="center",sideOffset:r=4,...c},d)=>e.jsx(ww,{children:e.jsx(Sj,{ref:d,align:l,sideOffset:r,className:F("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...c})}));sl.displayName=Sj.displayName;const Y2=Ps.memo(function({value:l,onChange:r}){const c=u.useMemo(()=>{const y=l.split("-");if(y.length===2){const[w,A]=y,[M,S]=w.split(":"),[I,E]=A.split(":");return{startHour:M?M.padStart(2,"0"):"00",startMinute:S?S.padStart(2,"0"):"00",endHour:I?I.padStart(2,"0"):"23",endMinute:E?E.padStart(2,"0"):"59"}}return{startHour:"00",startMinute:"00",endHour:"23",endMinute:"59"}},[l]),[d,m]=u.useState(c.startHour),[h,f]=u.useState(c.startMinute),[p,g]=u.useState(c.endHour),[N,j]=u.useState(c.endMinute);u.useEffect(()=>{m(c.startHour),f(c.startMinute),g(c.endHour),j(c.endMinute)},[c]);const b=(y,w,A,M)=>{const S=`${y}:${w}-${A}:${M}`;r(S)};return e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"w-full justify-start font-mono text-sm",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),l||""]})}),e.jsx(sl,{className:"w-72 sm:w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:d,onValueChange:y=>{m(y),b(y,h,p,N)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:Array.from({length:24},(y,w)=>w).map(y=>e.jsx(Z,{value:y.toString().padStart(2,"0"),children:y.toString().padStart(2,"0")},y))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:h,onValueChange:y=>{f(y),b(d,y,p,N)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:Array.from({length:60},(y,w)=>w).map(y=>e.jsx(Z,{value:y.toString().padStart(2,"0"),children:y.toString().padStart(2,"0")},y))})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:p,onValueChange:y=>{g(y),b(d,h,y,N)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:Array.from({length:24},(y,w)=>w).map(y=>e.jsx(Z,{value:y.toString().padStart(2,"0"),children:y.toString().padStart(2,"0")},y))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:N,onValueChange:y=>{j(y),b(d,h,p,y)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:Array.from({length:60},(y,w)=>w).map(y=>e.jsx(Z,{value:y.toString().padStart(2,"0"),children:y.toString().padStart(2,"0")},y))})]})]})]})]})]})})]})}),J2=Ps.memo(function({rule:l}){const r=`{ target = "${l.target}", time = "${l.time}", value = ${l.value.toFixed(1)} }`;return e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(oa,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})}),X2=Ps.memo(function({config:l,onChange:r}){const c=()=>{r({...l,talk_value_rules:[...l.talk_value_rules,{target:"",time:"00:00-23:59",value:1}]})},d=h=>{r({...l,talk_value_rules:l.talk_value_rules.filter((f,p)=>p!==h)})},m=(h,f,p)=>{const g=[...l.talk_value_rules];g[h]={...g[h],[f]:p},r({...l,talk_value_rules:g})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"talk_value",children:""}),e.jsx(le,{id:"talk_value",type:"number",step:"0.1",min:"0",max:"1",value:l.talk_value,onChange:h=>r({...l,talk_value:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"think_mode",children:""}),e.jsxs(Ie,{value:l.think_mode||"classic",onValueChange:h=>r({...l,think_mode:h}),children:[e.jsx(Be,{id:"think_mode",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"classic",children:" - "}),e.jsx(Z,{value:"deep",children:" - "}),e.jsx(Z,{value:"dynamic",children:" - "})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"mentioned_bot_reply",checked:l.mentioned_bot_reply,onCheckedChange:h=>r({...l,mentioned_bot_reply:h})}),e.jsx(T,{htmlFor:"mentioned_bot_reply",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_context_size",children:""}),e.jsx(le,{id:"max_context_size",type:"number",min:"1",value:l.max_context_size,onChange:h=>r({...l,max_context_size:parseInt(h.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"planner_smooth",children:""}),e.jsx(le,{id:"planner_smooth",type:"number",step:"1",min:"0",value:l.planner_smooth,onChange:h=>r({...l,planner_smooth:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" planner  1-50 "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_reply_log_max_per_chat",children:""}),e.jsx(le,{id:"plan_reply_log_max_per_chat",type:"number",step:"1",min:"100",value:l.plan_reply_log_max_per_chat??1024,onChange:h=>r({...l,plan_reply_log_max_per_chat:parseInt(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Plan/Reply "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"llm_quote",checked:l.llm_quote??!1,onCheckedChange:h=>r({...l,llm_quote:h})}),e.jsx(T,{htmlFor:"llm_quote",className:"cursor-pointer",children:" LLM "})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2 ml-10",children:"LLM "}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_talk_value_rules",checked:l.enable_talk_value_rules,onCheckedChange:h=>r({...l,enable_talk_value_rules:h})}),e.jsx(T,{htmlFor:"enable_talk_value_rules",className:"cursor-pointer",children:""})]})]})]}),l.enable_talk_value_rules&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ID"})]}),e.jsxs(_,{onClick:c,size:"sm",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),l.talk_value_rules&&l.talk_value_rules.length>0?e.jsx("div",{className:"space-y-4",children:l.talk_value_rules.map((h,f)=>e.jsxs("div",{className:"rounded-lg border p-4 bg-muted/50 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[" #",f+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J2,{rule:h}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(os,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" #",f+1," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>d(f),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:h.target===""?"global":"specific",onValueChange:p=>{p==="global"?m(f,"target",""):m(f,"target","qq::group")},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"global",children:""}),e.jsx(Z,{value:"specific",children:""})]})]})]}),h.target!==""&&(()=>{const p=h.target.split(":"),g=p[0]||"qq",N=p[1]||"",j=p[2]||"group";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:g,onValueChange:b=>{m(f,"target",`${b}:${N}:${j}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(le,{value:N,onChange:b=>{m(f,"target",`${g}:${b.target.value}:${j}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:j,onValueChange:b=>{m(f,"target",`${g}:${N}:${b}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"group",children:"group"}),e.jsx(Z,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",h.target||""]})]})})(),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" (Time)"}),e.jsx(Y2,{value:h.time,onChange:p=>m(f,"time",p)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00-02:00"})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:`rule-value-${f}`,className:"text-xs font-medium",children:" (Value)"}),e.jsx(le,{id:`rule-value-${f}`,type:"number",step:"0.01",min:"0.01",max:"1",value:h.value,onChange:p=>{const g=parseFloat(p.target.value);isNaN(g)||m(f,"value",Math.max(.01,Math.min(1,g)))},className:"w-20 h-8 text-xs"})]}),e.jsx(Wa,{value:[h.value],onValueChange:p=>m(f,"value",p[0]),min:.01,max:1,step:.01,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0.01 ()"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0 ()"})]})]})]})]},f))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:'""'})}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),"platform:id:type"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 23:00-02:00 112"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 0-10 1 "]})]})]})]})]})}),Z2=Ps.memo(function({config:l,onChange:r}){const c=S=>{if(!S||!S.includes(":"))return{platform:"qq",userId:""};const[I,E]=S.split(":");return{platform:I,userId:E}},{platform:d,userId:m}=c(l.dream_send),[h,f]=u.useState(d),[p,g]=u.useState(m),N=S=>{const[I,E]=S.split("-");return{startTime:I||"09:00",endTime:E||"22:00"}},j=(S,I)=>{const E=I?`${S}:${I}`:"";r({...l,dream_send:E})},b=S=>{f(S),j(S,p)},y=S=>{g(S),j(h,S)},w=()=>{r({...l,dream_time_ranges:[...l.dream_time_ranges,"09:00-22:00"]})},A=S=>{r({...l,dream_time_ranges:l.dream_time_ranges.filter((I,E)=>E!==S)})},M=(S,I,E)=>{const C=[...l.dream_time_ranges],R=N(C[S]);I==="startTime"?R.startTime=E:R.endTime=E,C[S]=`${R.startTime}-${R.endTime}`,r({...l,dream_time_ranges:C})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"interval_minutes",children:""}),e.jsx(le,{id:"interval_minutes",type:"number",min:"1",value:l.interval_minutes,onChange:S=>r({...l,interval_minutes:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"max_iterations",children:""}),e.jsx(le,{id:"max_iterations",type:"number",min:"1",value:l.max_iterations,onChange:S=>r({...l,max_iterations:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"first_delay_seconds",children:""}),e.jsx(le,{id:"first_delay_seconds",type:"number",min:"0",value:l.first_delay_seconds,onChange:S=>r({...l,first_delay_seconds:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ie,{value:h,onValueChange:b,children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""}),e.jsx(Z,{value:"webui",children:"WebUI"})]})]}),e.jsx(le,{type:"text",placeholder:"ID (: 123456)",value:p,onChange:S=>y(S.target.value),className:"flex-1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IDID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(_,{type:"button",size:"sm",onClick:w,children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00  02:00"}),e.jsxs("div",{className:"space-y-2",children:[l.dream_time_ranges.map((S,I)=>{const{startTime:E,endTime:C}=N(S);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"time",value:E,onChange:R=>M(I,"startTime",R.target.value),className:"w-[140px]"}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(le,{type:"time",value:C,onChange:R=>M(I,"endTime",R.target.value),className:"w-[140px]"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:()=>A(I),children:e.jsx(Sa,{className:"h-4 w-4"})})]},I)}),l.dream_time_ranges.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"dream_visible",checked:l.dream_visible,onCheckedChange:S=>r({...l,dream_visible:S})}),e.jsx(T,{htmlFor:"dream_visible",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}),W2=Ps.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:l.enable,onCheckedChange:c=>r({...l,enable:c})}),e.jsx(T,{className:"cursor-pointer",children:" LPMM "})]}),l.enable&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"LPMM "}),e.jsxs(Ie,{value:l.lpmm_mode,onValueChange:c=>r({...l,lpmm_mode:c}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:" LPMM "})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"classic",children:""}),e.jsx(Z,{value:"agent",children:"Agent "})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" TopK"}),e.jsx(le,{type:"number",min:"1",value:l.rag_synonym_search_top_k,onChange:c=>r({...l,rag_synonym_search_top_k:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",step:"0.1",min:"0",max:"1",value:l.rag_synonym_threshold,onChange:c=>r({...l,rag_synonym_threshold:parseFloat(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",min:"1",value:l.info_extraction_workers,onChange:c=>r({...l,info_extraction_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",min:"1",value:l.embedding_dimension,onChange:c=>r({...l,embedding_dimension:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",min:"1",value:l.max_embedding_workers,onChange:c=>r({...l,max_embedding_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",min:"1",value:l.embedding_chunk_size,onChange:c=>r({...l,embedding_chunk_size:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",min:"1",value:l.max_synonym_entities,onChange:c=>r({...l,max_synonym_entities:parseInt(c.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:l.enable_ppr,onCheckedChange:c=>r({...l,enable_ppr:c})}),e.jsx(T,{className:"cursor-pointer",children:" PPR ()"})]})]})]})]})}),eS=Ps.memo(function({config:l,onChange:r}){const[c,d]=u.useState(""),[m,h]=u.useState("WARNING"),f=()=>{c&&!l.suppress_libraries.includes(c)&&(r({...l,suppress_libraries:[...l.suppress_libraries,c]}),d(""))},p=w=>{r({...l,suppress_libraries:l.suppress_libraries.filter(A=>A!==w)})},g=()=>{c&&!l.library_log_levels[c]&&(r({...l,library_log_levels:{...l.library_log_levels,[c]:m}}),d(""),h("WARNING"))},N=w=>{const A={...l.library_log_levels};delete A[w],r({...l,library_log_levels:A})},j=["DEBUG","INFO","WARNING","ERROR","CRITICAL"],b=["FULL","compact","lite"],y=["none","title","full"];return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{value:l.date_style,onChange:w=>r({...l,date_style:w.target.value}),placeholder:": m-d H:i:s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"m=, d=, H=, i=, s="})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:l.log_level_style,onValueChange:w=>r({...l,log_level_style:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:b.map(w=>e.jsx(Z,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:l.color_text,onValueChange:w=>r({...l,color_text:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:y.map(w=>e.jsx(Z,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:l.log_level,onValueChange:w=>r({...l,log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:j.map(w=>e.jsx(Z,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:l.console_log_level,onValueChange:w=>r({...l,console_log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:j.map(w=>e.jsx(Z,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:l.file_log_level,onValueChange:w=>r({...l,file_log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Pe,{children:j.map(w=>e.jsx(Z,{value:w,children:w},w))})]})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:c,onChange:w=>d(w.target.value),placeholder:"",className:"flex-1",onKeyDown:w=>{w.key==="Enter"&&(w.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",className:"flex-shrink-0",children:e.jsx(Xs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.suppress_libraries.map(w=>e.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-3 py-1 rounded-md",children:[e.jsx("span",{className:"text-sm",children:w}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>p(w),children:e.jsx(os,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},w))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:c,onChange:w=>d(w.target.value),placeholder:"",className:"flex-1"}),e.jsxs(Ie,{value:m,onValueChange:h,children:[e.jsx(Be,{className:"w-32",children:e.jsx(Fe,{})}),e.jsx(Pe,{children:j.map(w=>e.jsx(Z,{value:w,children:w},w))})]}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(Xs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(l.library_log_levels).map(([w,A])=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-medium",children:w}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:A}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(w),children:e.jsx(os,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]})]},w))})]})]})}),sS=Ps.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:l.show_prompt,onCheckedChange:c=>r({...l,show_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:l.show_replyer_prompt,onCheckedChange:c=>r({...l,show_replyer_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:l.show_replyer_reasoning,onCheckedChange:c=>r({...l,show_replyer_reasoning:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Jargon Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:l.show_jargon_prompt,onCheckedChange:c=>r({...l,show_jargon_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:l.show_memory_prompt,onCheckedChange:c=>r({...l,show_memory_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Planner Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Planner "})]}),e.jsx(Ve,{checked:l.show_planner_prompt,onCheckedChange:c=>r({...l,show_planner_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" LPMM "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LPMM "})]}),e.jsx(Ve,{checked:l.show_lpmm_paragraph,onCheckedChange:c=>r({...l,show_lpmm_paragraph:c})})]})]})]})}),tS=Ps.memo(function({config:l,onChange:r}){const c=g=>{const N=g.split(":");if(N.length>=4){const j=N[0],b=N[1],y=N[2],w=N.slice(3).join(":");return{platform:j,id:b,type:y,prompt:w}}return{platform:"qq",id:"",type:"group",prompt:""}},d=g=>`${g.platform}:${g.id}:${g.type}:${g.prompt}`,m=()=>{r({...l,chat_prompts:[...l.chat_prompts,"qq::group:"]})},h=g=>{r({...l,chat_prompts:l.chat_prompts.filter((N,j)=>j!==g)})},f=(g,N)=>{const b={...c(l.chat_prompts[g]),...N},y=[...l.chat_prompts];y[g]=d(b),r({...l,chat_prompts:y})},p=({promptStr:g})=>e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(oa,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsxs("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:['"',g,'"']}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]});return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-orange-500/10 border border-orange-500/20",children:[e.jsx(Ft,{className:"h-5 w-5 text-orange-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium text-orange-500",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"private_plan_style",children:""}),e.jsx(ht,{id:"private_plan_style",value:l.private_plan_style,onChange:g=>r({...l,private_plan_style:g.target.value}),placeholder:"",rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" "})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{children:" Prompt "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" prompt"})]}),e.jsxs(_,{onClick:m,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[l.chat_prompts.map((g,N)=>{const j=c(g);return e.jsxs("div",{className:"rounded-lg border p-4 space-y-4 bg-card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Prompt  ",N+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{promptStr:g}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{children:" prompt "})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>h(N),children:""})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:j.platform,onValueChange:b=>f(N,{platform:b}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""}),e.jsx(Z,{value:"webui",children:"WebUI"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:j.type==="group"?"":"ID"}),e.jsx(le,{value:j.id,onChange:b=>f(N,{id:b.target.value}),placeholder:j.type==="group"?"":"ID",className:"font-mono"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:j.type,onValueChange:b=>f(N,{type:b}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"group",children:" (group)"}),e.jsx(Z,{value:"private",children:" (private)"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"Prompt "}),e.jsx(ht,{value:j.prompt,onChange:b=>f(N,{prompt:b.target.value}),placeholder:" prompt ",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-md bg-muted/50 p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ix,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:""})]}),e.jsx("code",{className:"text-xs font-mono text-muted-foreground break-all",children:g||"()"})]})]})]},N)}),l.chat_prompts.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:" prompt "}),e.jsx("p",{className:"text-xs mt-1",children:'""'})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-2 p-4 rounded-lg bg-muted/30 border",children:[e.jsx("p",{className:"font-medium text-foreground",children:" "}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 pl-2",children:[e.jsx("li",{children:""}),e.jsx("li",{children:"QQWebUI"}),e.jsx("li",{children:""}),e.jsx("li",{children:"Prompt "})]}),e.jsx("p",{className:"font-medium text-foreground mt-3",children:" "}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 pl-2",children:[e.jsxs("li",{children:["",e.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:""})]}),e.jsxs("li",{children:["",e.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:""})]}),e.jsxs("li",{children:["",e.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:""})]})]})]})]})]})]})]})}),aS=Ps.memo(function({config:l,onChange:r}){const[c,d]=u.useState(""),[m,h]=u.useState(""),f=()=>{c&&!l.auth_token.includes(c)&&(r({...l,auth_token:[...l.auth_token,c]}),d(""))},p=j=>{r({...l,auth_token:l.auth_token.filter((b,y)=>y!==j)})},g=()=>{m&&!l.api_server_allowed_api_keys.includes(m)&&(r({...l,api_server_allowed_api_keys:[...l.api_server_allowed_api_keys,m]}),h(""))},N=j=>{r({...l,api_server_allowed_api_keys:l.api_server_allowed_api_keys.filter((b,y)=>y!==j)})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:" API "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:" API "}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:c,onChange:j=>d(j.target.value),placeholder:"",onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",children:e.jsx(Xs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:l.auth_token.map((j,b)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:j}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>p(b),children:e.jsx(os,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},b))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:" API Server "}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" API Server"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" API Server"})]}),e.jsx(Ve,{checked:l.enable_api_server,onCheckedChange:j=>r({...l,enable_api_server:j})})]}),l.enable_api_server&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{value:l.api_server_host,onChange:j=>r({...l,api_server_host:j.target.value}),placeholder:"0.0.0.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",value:l.api_server_port,onChange:j=>r({...l,api_server_port:parseInt(j.target.value)}),placeholder:"8090"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:l.api_server_use_wss,onCheckedChange:j=>r({...l,api_server_use_wss:j})}),e.jsx(T,{children:" WSS "})]}),l.api_server_use_wss&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(le,{value:l.api_server_cert_file,onChange:j=>r({...l,api_server_cert_file:j.target.value}),placeholder:"cert.pem"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(le,{value:l.api_server_key_file,onChange:j=>r({...l,api_server_key_file:j.target.value}),placeholder:"key.pem"})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:" API Key "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:m,onChange:j=>h(j.target.value),placeholder:" API Key",onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),g())}}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(Xs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:l.api_server_allowed_api_keys.map((j,b)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:j}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(b),children:e.jsx(os,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},b))})]})]})]})]})]})}),lS=Ps.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{checked:l.enable,onCheckedChange:c=>r({...l,enable:c})})]})]})}),nS=Ps.memo(function({emojiConfig:l,memoryConfig:r,toolConfig:c,voiceConfig:d,onEmojiChange:m,onMemoryChange:h,onToolChange:f,onVoiceChange:p}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_tool",checked:c.enable_tool,onCheckedChange:g=>f({...c,enable_tool:g})}),e.jsx(T,{htmlFor:"enable_tool",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(Ve,{id:"enable_asr",checked:d.enable_asr,onCheckedChange:g=>p({...d,enable_asr:g})}),e.jsx(T,{htmlFor:"enable_asr",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_agent_iterations",children:""}),e.jsx(le,{id:"max_agent_iterations",type:"number",min:"1",value:r.max_agent_iterations,onChange:g=>h({...r,max_agent_iterations:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"agent_timeout_seconds",children:""}),e.jsx(le,{id:"agent_timeout_seconds",type:"number",min:"1",step:"0.1",value:r.agent_timeout_seconds??120,onChange:g=>h({...r,agent_timeout_seconds:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_jargon_detection",checked:r.enable_jargon_detection??!0,onCheckedChange:g=>h({...r,enable_jargon_detection:g})}),e.jsx(T,{htmlFor:"enable_jargon_detection",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"global_memory",checked:r.global_memory??!1,onCheckedChange:g=>h({...r,global_memory:g})}),e.jsx(T,{htmlFor:"global_memory",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsx(le,{id:"emoji_chance",type:"number",step:"0.1",min:"0",max:"1",value:l.emoji_chance,onChange:g=>m({...l,emoji_chance:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(le,{id:"max_reg_num",type:"number",min:"1",value:l.max_reg_num,onChange:g=>m({...l,max_reg_num:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(le,{id:"check_interval",type:"number",min:"1",value:l.check_interval,onChange:g=>m({...l,check_interval:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"do_replace",checked:l.do_replace,onCheckedChange:g=>m({...l,do_replace:g})}),e.jsx(T,{htmlFor:"do_replace",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"steal_emoji",checked:l.steal_emoji,onCheckedChange:g=>m({...l,steal_emoji:g})}),e.jsx(T,{htmlFor:"steal_emoji",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"content_filtration",checked:l.content_filtration,onCheckedChange:g=>m({...l,content_filtration:g})}),e.jsx(T,{htmlFor:"content_filtration",className:"cursor-pointer",children:""})]}),l.content_filtration&&e.jsxs("div",{className:"grid gap-2 pl-6 border-l-2 border-primary/20",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(le,{id:"filtration_prompt",value:l.filtration_prompt,onChange:g=>m({...l,filtration_prompt:g.target.value}),placeholder:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})})]})}),rS=Ps.memo(function({member:l,groupIndex:r,memberIndex:c,availableChatIds:d,onUpdate:m,onRemove:h}){const f=d.includes(l)||l==="*",[p,g]=u.useState(!f);return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 flex gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx(le,{value:l,onChange:N=>m(r,c,N.target.value),placeholder:' "*"  "qq:123456:group"',className:"flex-1"}),d.length>0&&e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!1),title:"",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{value:l,onValueChange:N=>m(r,c,N),children:[e.jsx(Be,{className:"flex-1",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"*",children:"* ()"}),d.map((N,j)=>e.jsx(Z,{value:N,children:N},j))]})]}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!0),title:"",children:""})]})}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',l||"()",'" ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>h(r,c),children:""})]})]})]})]})}),iS=Ps.memo(function({config:l,onChange:r}){const c=()=>{r({...l,learning_list:[...l.learning_list,["","enable","enable","1.0"]]})},d=b=>{r({...l,learning_list:l.learning_list.filter((y,w)=>w!==b)})},m=(b,y,w)=>{const A=[...l.learning_list];A[b][y]=w,r({...l,learning_list:A})},h=({rule:b})=>{const y=`["${b[0]}", "${b[1]}", "${b[2]}", "${b[3]}"]`;return e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(oa,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:y}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},f=()=>{r({...l,expression_groups:[...l.expression_groups,[]]})},p=b=>{r({...l,expression_groups:l.expression_groups.filter((y,w)=>w!==b)})},g=b=>{const y=[...l.expression_groups];y[b]=[...y[b],""],r({...l,expression_groups:y})},N=(b,y)=>{const w=[...l.expression_groups];w[b]=w[b].filter((A,M)=>M!==y),r({...l,expression_groups:w})},j=(b,y,w)=>{const A=[...l.expression_groups];A[b][y]=w,r({...l,expression_groups:A})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"all_global_jargon",checked:l.all_global_jargon??!1,onCheckedChange:b=>r({...l,all_global_jargon:b})}),e.jsx(T,{htmlFor:"all_global_jargon",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_jargon_explanation",checked:l.enable_jargon_explanation??!0,onCheckedChange:b=>r({...l,enable_jargon_explanation:b})}),e.jsx(T,{htmlFor:"enable_jargon_explanation",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"LLM"})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"jargon_mode",children:""}),e.jsxs(Ie,{value:l.jargon_mode??"context",onValueChange:b=>r({...l,jargon_mode:b}),children:[e.jsx(Be,{id:"jargon_mode",className:"mt-2",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"context",children:""}),e.jsx(Z,{value:"planner",children:"Plannerunknown_words"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["",e.jsx("br",{}),"PlannerPlannerreplyunknown_words"]})]})]}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[l.learning_list.map((b,y)=>{const w=l.learning_list.some((C,R)=>R!==y&&C[0]===""),A=b[0]==="",M=b[0].split(":"),S=M[0]||"qq",I=M[1]||"",E=M[2]||"group";return e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",y+1," ",A&&""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{rule:b}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",y+1," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>d(y),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:A?"global":"specific",onValueChange:C=>{C==="global"?m(y,0,""):m(y,0,"qq::group")},disabled:w&&!A,children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"global",children:""}),e.jsx(Z,{value:"specific",disabled:w&&!A,children:""})]})]}),w&&!A&&e.jsx("p",{className:"text-xs text-amber-600",children:""})]}),!A&&e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:S,onValueChange:C=>{m(y,0,`${C}:${I}:${E}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(le,{value:I,onChange:C=>{m(y,0,`${S}:${C.target.value}:${E}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:E,onValueChange:C=>{m(y,0,`${S}:${I}:${C}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"group",children:"group"}),e.jsx(Z,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",b[0]||""]})]}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:b[1]==="enable",onCheckedChange:C=>m(y,1,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:b[2]==="enable",onCheckedChange:C=>m(y,2,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:b[3]==="true"||b[3]==="enable",onCheckedChange:C=>m(y,3,C?"true":"false")})]})})]})]},y)}),l.learning_list.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_self_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"expression_self_reflect",checked:l.expression_self_reflect??!1,onCheckedChange:b=>r({...l,expression_self_reflect:b})})]}),l.expression_self_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_interval",children:""}),e.jsx(le,{id:"expression_auto_check_interval",type:"number",min:"60",value:l.expression_auto_check_interval??3600,onChange:b=>r({...l,expression_auto_check_interval:parseInt(b.target.value)||3600})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"36001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_count",children:""}),e.jsx(le,{id:"expression_auto_check_count",type:"number",min:"1",max:"100",value:l.expression_auto_check_count??10,onChange:b=>r({...l,expression_auto_check_count:parseInt(b.target.value)||10})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"10"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:()=>{r({...l,expression_auto_check_custom_criteria:[...l.expression_auto_check_custom_criteria||[],""]})},size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(l.expression_auto_check_custom_criteria||[]).map((b,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:b,onChange:w=>{const A=[...l.expression_auto_check_custom_criteria||[]];A[y]=w.target.value,r({...l,expression_auto_check_custom_criteria:A})},placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>{r({...l,expression_auto_check_custom_criteria:(l.expression_auto_check_custom_criteria||[]).filter((w,A)=>A!==y)})},size:"icon",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})]},y)),(!l.expression_auto_check_custom_criteria||l.expression_auto_check_custom_criteria.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:'""'})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_checked_only",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"expression_checked_only",checked:l.expression_checked_only??!1,onCheckedChange:b=>r({...l,expression_checked_only:b})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_manual_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"expression_manual_reflect",checked:l.expression_manual_reflect??!1,onCheckedChange:b=>r({...l,expression_manual_reflect:b})})]}),l.expression_manual_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-sm font-medium",children:""})}),e.jsx("div",{className:"space-y-4",children:(()=>{const y=(l.manual_reflect_operator_id||"").split(":"),w=y[0]||"qq",A=y[1]||"",M=y[2]||"private";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:w,onValueChange:S=>{r({...l,manual_reflect_operator_id:`${S}:${A}:${M}`})},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"/ ID"}),e.jsx(le,{value:A,onChange:S=>{r({...l,manual_reflect_operator_id:`${w}:${S.target.value}:${M}`})},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:M,onValueChange:S=>{r({...l,manual_reflect_operator_id:`${w}:${A}:${S}`})},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"private",children:"private"}),e.jsx(Z,{value:"group",children:"group"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",l.manual_reflect_operator_id||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'IDplatform:id:type ( "qq:123456:private"  "qq:654321:group")'})]})})()})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>{r({...l,allow_reflect:[...l.allow_reflect||[],"qq::group"]})},size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(l.allow_reflect||[]).map((b,y)=>{const w=b.split(":"),A=w[0]||"qq",M=w[1]||"",S=w[2]||"group";return e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-muted/50",children:[e.jsxs(Ie,{value:A,onValueChange:I=>{const E=[...l.allow_reflect];E[y]=`${I}:${M}:${S}`,r({...l,allow_reflect:E})},children:[e.jsx(Be,{className:"w-24",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"qq",children:"QQ"}),e.jsx(Z,{value:"wx",children:""})]})]}),e.jsx(le,{value:M,onChange:I=>{const E=[...l.allow_reflect];E[y]=`${A}:${I.target.value}:${S}`,r({...l,allow_reflect:E})},placeholder:"ID",className:"flex-1 font-mono text-sm"}),e.jsxs(Ie,{value:S,onValueChange:I=>{const E=[...l.allow_reflect];E[y]=`${A}:${M}:${I}`,r({...l,allow_reflect:E})},children:[e.jsx(Be,{className:"w-32",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"group",children:""}),e.jsx(Z,{value:"private",children:""})]})]}),e.jsx(_,{onClick:()=>{r({...l,allow_reflect:l.allow_reflect.filter((I,E)=>E!==y)})},size:"sm",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})]},y)}),(!l.allow_reflect||l.allow_reflect.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:""})]})]})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:f,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[l.expression_groups.map((b,y)=>{const w=l.learning_list.map(A=>A[0]).filter(A=>A!=="");return e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",y+1,b.length===1&&b[0]==="*"&&""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:()=>g(y),size:"sm",variant:"outline",children:e.jsx(Xs,{className:"h-4 w-4"})}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",y+1," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>p(y),children:""})]})]})]})]})]}),e.jsx("div",{className:"space-y-2",children:b.map((A,M)=>e.jsx(rS,{member:A,groupIndex:y,memberIndex:M,availableChatIds:w,onUpdate:j,onRemove:N},`${y}-${M}`))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' "*" '})]},y)}),l.expression_groups.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})})]})});function cS({regex:a,reaction:l,onRegexChange:r,onReactionChange:c}){const[d,m]=u.useState(!1),[h,f]=u.useState(""),[p,g]=u.useState(null),[N,j]=u.useState(""),[b,y]=u.useState({}),[w,A]=u.useState(""),M=u.useRef(null),[S,I]=u.useState("build"),E=O=>O.replace(/\(\?P<([^>]+)>/g,"(?<$1>"),C=(O,X=0)=>{const L=M.current;if(!L)return;const me=L.selectionStart||0,Ne=L.selectionEnd||0,je=a.substring(0,me)+O+a.substring(Ne);r(je),setTimeout(()=>{const ce=me+O.length+X;L.setSelectionRange(ce,ce),L.focus()},0)};u.useEffect(()=>{if(!a||!h){p!==null&&g(null),Object.keys(b).length>0&&y({}),w!==l&&A(l),N!==""&&j("");return}try{const O=E(a),X=new RegExp(O,"g"),L=h.match(X);g(L),j("");const Ne=new RegExp(O).exec(h);if(Ne&&Ne.groups){y(Ne.groups);let je=l;Object.entries(Ne.groups).forEach(([ce,ge])=>{je=je.replace(new RegExp(`\\[${ce}\\]`,"g"),ge||"")}),A(je)}else y({}),A(l)}catch(O){j(O.message),g(null),y({}),A(l)}},[a,h,l,p,b,w,N]);const R=()=>{if(!h||!p||p.length===0)return e.jsx("span",{className:"text-muted-foreground",children:h||""});try{const O=E(a),X=new RegExp(O,"g");let L=0;const me=[];let Ne;for(;(Ne=X.exec(h))!==null;)Ne.index>L&&me.push(e.jsx("span",{children:h.substring(L,Ne.index)},`text-${L}`)),me.push(e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-900 font-semibold",children:Ne[0]},`match-${Ne.index}`)),L=Ne.index+Ne[0].length;return L<h.length&&me.push(e.jsx("span",{children:h.substring(L)},`text-${L}`)),e.jsx(e.Fragment,{children:me})}catch{return e.jsx("span",{children:h})}},H=[{category:"",items:[{label:"",pattern:".",desc:""},{label:"",pattern:"\\d",desc:" 0-9"},{label:"",pattern:"\\D",desc:""},{label:"",pattern:"\\w",desc:""},{label:"",pattern:"\\W",desc:""},{label:"",pattern:"\\s",desc:""},{label:"",pattern:"\\S",desc:""}]},{category:"",items:[{label:"",pattern:"^",desc:""},{label:"",pattern:"$",desc:""},{label:"",pattern:"\\b",desc:""}]},{category:"",items:[{label:"0",pattern:"*",desc:"0"},{label:"1",pattern:"+",desc:"1"},{label:"01",pattern:"?",desc:"01"},{label:"",pattern:"{n}",desc:"nn"},{label:"",pattern:"{m,n}",desc:"mn"}]},{category:"",items:[{label:"",pattern:"()",desc:"",moveCursor:-1},{label:"",pattern:"(?P<name>)",desc:"Python",moveCursor:-1},{label:"",pattern:"(?:)",desc:"",moveCursor:-1}]},{category:"",items:[{label:"",pattern:"[]",desc:"",moveCursor:-1},{label:"",pattern:"[^]",desc:"",moveCursor:-1},{label:"",pattern:"[a-z]",desc:"az"},{label:"",pattern:"[\\u4e00-\\u9fa5]",desc:""}]},{category:"",items:[{label:"",pattern:"(?P<word>\\S+)",desc:""},{label:"",pattern:"(?P<sentence>.+)",desc:""},{label:"",pattern:"(?P<num>\\d+)",desc:""},{label:"",pattern:"(?:1|2)",desc:""}]}];return e.jsxs(Qs,{open:d,onOpenChange:m,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(cx,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Hs,{className:"max-w-[95vw] sm:max-w-[900px] max-h-[90vh]",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{className:"text-sm",children:""})]}),e.jsx(ts,{className:"max-h-[calc(90vh-120px)]",children:e.jsxs(Jt,{value:S,onValueChange:O=>I(O),className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2",children:[e.jsx(Ye,{value:"build",children:" "}),e.jsx(Ye,{value:"test",children:" "})]}),e.jsxs(Cs,{value:"build",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(le,{ref:M,value:a,onChange:O=>r(O.target.value),className:"font-mono text-sm",placeholder:"..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(ht,{value:l,onChange:O=>c(O.target.value),placeholder:" [] ...",rows:3,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[H.map(O=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:O.category}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:O.items.map(X=>e.jsx(_,{variant:"outline",size:"sm",className:"justify-start h-auto py-2 px-3",onClick:()=>C(X.pattern,X.moveCursor||0),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("span",{className:"text-xs font-medium",children:X.label}),e.jsx("code",{className:"ml-auto text-xs bg-muted px-1.5 py-0.5 rounded font-mono",children:X.pattern})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:X.desc})]})},X.label))})]},O.category)),e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("^(?P<n>\\S{1,20})$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:["^(?P<n>\\S","{1,20}",")$"]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?P<subject>.+?)(?:||)"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?P<subject>.+?)(?:||)"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})})]})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsxs("li",{children:["",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"(?P<>)"})]}),e.jsxs("li",{children:[" reaction  ",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"[]"})," "]}),e.jsx("li",{children:""})]})]})]}),e.jsxs(Cs,{value:"test",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:a||"()"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"test-text",className:"text-sm font-medium",children:""}),e.jsx(ht,{id:"test-text",value:h,onChange:O=>f(O.target.value),placeholder:`...
`,className:"min-h-[100px] text-sm"})]}),N&&e.jsxs("div",{className:"rounded-md bg-destructive/10 border border-destructive/20 p-3",children:[e.jsx("p",{className:"text-sm text-destructive font-medium",children:""}),e.jsx("p",{className:"text-xs text-destructive/80 mt-1",children:N})]}),!N&&h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:p&&p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[" (",p.length," )"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:""})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ts,{className:"h-40 rounded-md bg-muted p-3",children:e.jsx("div",{className:"text-sm break-words",children:R()})})]}),Object.keys(b).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ts,{className:"h-32 rounded-md border p-3",children:e.jsx("div",{className:"space-y-2",children:Object.entries(b).map(([O,X])=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsxs("span",{className:"font-mono font-semibold text-primary min-w-[80px]",children:["[",O,"]"]}),e.jsx("span",{className:"text-muted-foreground",children:"="}),e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded",children:X})]},O))})})]}),Object.keys(b).length>0&&l&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(ts,{className:"h-48 rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3",children:e.jsx("div",{className:"text-sm break-words",children:w})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"reaction  [name] "})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:"Reaction "}),e.jsx("li",{children:""})]})]})]})]})})]})]})}const oS=Ps.memo(function({keywordReactionConfig:l,responsePostProcessConfig:r,chineseTypoConfig:c,responseSplitterConfig:d,onKeywordReactionChange:m,onResponsePostProcessChange:h,onChineseTypoChange:f,onResponseSplitterChange:p}){const g=()=>{m({...l,regex_rules:[...l.regex_rules,{regex:[""],reaction:""}]})},N=C=>{m({...l,regex_rules:l.regex_rules.filter((R,H)=>H!==C)})},j=(C,R,H)=>{const O=[...l.regex_rules];R==="regex"&&typeof H=="string"?O[C]={...O[C],regex:[H]}:R==="reaction"&&typeof H=="string"&&(O[C]={...O[C],reaction:H}),m({...l,regex_rules:O})},b=()=>{m({...l,keyword_rules:[...l.keyword_rules,{keywords:[],reaction:""}]})},y=C=>{m({...l,keyword_rules:l.keyword_rules.filter((R,H)=>H!==C)})},w=(C,R,H)=>{const O=[...l.keyword_rules];typeof H=="string"&&(O[C]={...O[C],reaction:H}),m({...l,keyword_rules:O})},A=C=>{const R=[...l.keyword_rules];R[C]={...R[C],keywords:[...R[C].keywords||[],""]},m({...l,keyword_rules:R})},M=(C,R)=>{const H=[...l.keyword_rules];H[C]={...H[C],keywords:(H[C].keywords||[]).filter((O,X)=>X!==R)},m({...l,keyword_rules:H})},S=(C,R,H)=>{const O=[...l.keyword_rules],X=[...O[C].keywords||[]];X[R]=H,O[C]={...O[C],keywords:X},m({...l,keyword_rules:O})},I=({rule:C})=>{const R=`{ regex = [${(C.regex||[]).map(H=>`"${H}"`).join(", ")}], reaction = "${C.reaction}" }`;return e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(oa,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(ts,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs break-all",children:R})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},E=({rule:C})=>{const R=`[[keyword_reaction.keyword_rules]]
keywords = [${(C.keywords||[]).map(H=>`"${H}"`).join(", ")}]
reaction = "${C.reaction}"`;return e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(oa,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(ts,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-all",children:R})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:g,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[l.regex_rules.map((C,R)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",R+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cS,{regex:C.regex&&C.regex[0]||"",reaction:C.reaction,onRegexChange:H=>j(R,"regex",H),onReactionChange:H=>j(R,"reaction",H)}),e.jsx(I,{rule:C}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",R+1," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>N(R),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"Python "}),e.jsx(le,{value:C.regex&&C.regex[0]||"",onChange:H=>j(R,"regex",H.target.value),placeholder:"^(?P<n>\\\\S{1,20})$ ",className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' (?P<name>pattern) reaction  [name] ""'})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(ht,{value:C.reaction,onChange:H=>j(R,"reaction",H.target.value),placeholder:`...
 [] `,rows:3,className:"text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" []  [n] "})]})]})]},R)),l.regex_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:b,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[l.keyword_rules.map((C,R)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",R+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{rule:C}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",R+1," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>y(R),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(_,{onClick:()=>A(R),size:"sm",variant:"ghost",children:[e.jsx(Xs,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(C.keywords||[]).map((H,O)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{value:H,onChange:X=>S(R,O,X.target.value),placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>M(R,O),size:"sm",variant:"ghost",children:e.jsx(os,{className:"h-4 w-4"})})]},O)),(!C.keywords||C.keywords.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-2",children:'""'})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(ht,{value:C.reaction,onChange:H=>w(R,"reaction",H.target.value),placeholder:"...",rows:3,className:"text-sm"})]})]})]},R)),l.keyword_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_response_post_process",checked:r.enable_response_post_process,onCheckedChange:C=>h({...r,enable_response_post_process:C})}),e.jsx(T,{htmlFor:"enable_response_post_process",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),r.enable_response_post_process&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ve,{id:"enable_chinese_typo",checked:c.enable,onCheckedChange:C=>f({...c,enable:C})}),e.jsx(T,{htmlFor:"enable_chinese_typo",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),c.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"error_rate",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"error_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.error_rate,onChange:C=>f({...c,error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"min_freq",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"min_freq",type:"number",min:"0",value:c.min_freq,onChange:C=>f({...c,min_freq:parseInt(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"tone_error_rate",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"tone_error_rate",type:"number",step:"0.01",min:"0",max:"1",value:c.tone_error_rate,onChange:C=>f({...c,tone_error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"word_replace_rate",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"word_replace_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.word_replace_rate,onChange:C=>f({...c,word_replace_rate:parseFloat(C.target.value)})})]})]})]})}),e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ve,{id:"enable_response_splitter",checked:d.enable,onCheckedChange:C=>p({...d,enable:C})}),e.jsx(T,{htmlFor:"enable_response_splitter",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),d.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_length",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"max_length",type:"number",min:"1",value:d.max_length,onChange:C=>p({...d,max_length:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_sentence_num",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"max_sentence_num",type:"number",min:"1",value:d.max_sentence_num,onChange:C=>p({...d,max_sentence_num:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_kaomoji_protection",checked:d.enable_kaomoji_protection,onCheckedChange:C=>p({...d,enable_kaomoji_protection:C})}),e.jsx(T,{htmlFor:"enable_kaomoji_protection",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"enable_overflow_return_all",checked:d.enable_overflow_return_all,onCheckedChange:C=>p({...d,enable_overflow_return_all:C})}),e.jsx(T,{htmlFor:"enable_overflow_return_all",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})})]})]})]})});function dS({config:a,onChange:l}){const[r,c]=u.useState(""),[d,m]=u.useState(""),h=()=>{const b=r.trim();b&&!a.ban_words.includes(b)&&(l({...a,ban_words:[...a.ban_words,b]}),c(""))},f=b=>{l({...a,ban_words:a.ban_words.filter((y,w)=>w!==b)})},p=b=>{b.key==="Enter"&&(b.preventDefault(),h())},g=()=>{const b=d.trim();if(b&&!a.ban_msgs_regex.includes(b))try{new RegExp(b),l({...a,ban_msgs_regex:[...a.ban_msgs_regex,b]}),m("")}catch(y){alert(`${y.message}`)}},N=b=>{l({...a,ban_msgs_regex:a.ban_msgs_regex.filter((y,w)=>w!==b)})},j=b=>{b.key==="Enter"&&(b.preventDefault(),g())};return e.jsx("div",{className:"space-y-6",children:e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:e.jsxs(Jt,{defaultValue:"ban_words",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2",children:[e.jsx(Ye,{value:"ban_words",children:""}),e.jsx(Ye,{value:"ban_regex",children:""})]}),e.jsx(Cs,{value:"ban_words",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ft,{className:"h-4 w-4 text-yellow-500 mt-1 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bot "})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{placeholder:"",value:r,onChange:b=>c(b.target.value),onKeyDown:p}),e.jsx(_,{onClick:h,size:"icon",children:e.jsx(Xs,{className:"h-4 w-4"})})]}),a.ban_words.length===0?e.jsx("div",{className:"rounded-md border border-dashed p-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}):e.jsx("div",{className:"space-y-2",children:a.ban_words.map((b,y)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsx("code",{className:"text-sm",children:b}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",children:e.jsx(os,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",e.jsxs("code",{children:['"',b,'"']})," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>f(y),children:""})]})]})]})]},y))})]})}),e.jsx(Cs,{value:"ban_regex",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ft,{className:"h-4 w-4 text-yellow-500 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("p",{children:""}),e.jsx("p",{className:"text-xs",children:" "})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ht,{placeholder:`
https?://[^\\s]+ `,value:d,onChange:b=>m(b.target.value),onKeyDown:j,className:"min-h-[60px] font-mono text-sm"}),e.jsx(_,{onClick:g,size:"icon",children:e.jsx(Xs,{className:"h-4 w-4"})})]}),a.ban_msgs_regex.length===0?e.jsx("div",{className:"rounded-md border border-dashed p-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}):e.jsx("div",{className:"space-y-2",children:a.ban_msgs_regex.map((b,y)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsx("code",{className:"text-sm font-mono flex-1 break-all",children:b}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",className:"ml-2 flex-shrink-0",children:e.jsx(os,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",e.jsxs("code",{children:['"',b,'"']})," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>N(y),children:""})]})]})]})]},y))})]})})]})})]})})}const uS=Ps.memo(function({config:l,onChange:r}){const[c,d]=u.useState(""),[m,h]=u.useState(""),[f,p]=u.useState(!1),g=l.allowed_ips?l.allowed_ips.split(",").map(S=>S.trim()).filter(S=>S):[],N=l.trusted_proxies?l.trusted_proxies.split(",").map(S=>S.trim()).filter(S=>S):[],j=()=>{if(!c.trim())return;const S=[...g,c.trim()];r({...l,allowed_ips:S.join(",")}),d("")},b=S=>{const I=g.filter((E,C)=>C!==S);r({...l,allowed_ips:I.join(",")})},y=()=>{if(!m.trim())return;const S=[...N,m.trim()];r({...l,trusted_proxies:S.join(",")}),h("")},w=S=>{const I=N.filter((E,C)=>C!==S);r({...l,trusted_proxies:I.join(",")})},A=S=>{!S&&l.enabled?p(!0):r({...l,enabled:S})},M=()=>{r({...l,enabled:!1}),p(!1)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"WebUI "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:l.enabled,onCheckedChange:A}),e.jsx(T,{className:"cursor-pointer",children:" WebUI"})]}),l.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:l.mode,onValueChange:S=>r({...l,mode:S}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"development",children:""}),e.jsx(Z,{value:"production",children:""})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": WebUI  .env  WEBUI_HOST  WEBUI_PORT"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:l.anti_crawler_mode,onValueChange:S=>r({...l,anti_crawler_mode:S}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"false",children:""}),e.jsx(Z,{value:"basic",children:""}),e.jsx(Z,{value:"loose",children:""}),e.jsx(Z,{value:"strict",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:"IP "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:c,onChange:S=>d(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),j())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:j,disabled:!c.trim(),children:e.jsx(Xs,{className:"h-4 w-4"})})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:g.map((S,I)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>b(I),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Sa,{className:"h-3 w-3"})})]},I))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPCIDR127.0.0.1192.168.1.0/24"})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:" IP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:m,onChange:S=>h(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),y())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:y,disabled:!m.trim(),children:e.jsx(Xs,{className:"h-4 w-4"})})]}),N.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:N.map((S,I)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>w(I),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Sa,{className:"h-3 w-3"})})]},I))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPX-Forwarded-For"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:l.trust_xff,onCheckedChange:S=>r({...l,trust_xff:S})}),e.jsx(T,{className:"cursor-pointer",children:" X-Forwarded-For "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{checked:l.secure_cookie,onCheckedChange:S=>r({...l,secure_cookie:S})}),e.jsx(T,{className:"cursor-pointer",children:" Cookie HTTPS"})]})]})]}),e.jsx(bs,{open:f,onOpenChange:p,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:" WebUI"}),e.jsxs(gs,{children:[" WebUI WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{variant:"destructive",onClick:M,children:""})]})]})})]})}),Sn="/api/webui/config";async function Bg(){const l=await(await Se(`${Sn}/bot`)).json();if(!l.success)throw new Error("");return l.config}async function pn(){const l=await(await Se(`${Sn}/model`)).json();if(!l.success)throw new Error("");return l.config}async function Pg(a){const r=await(await Se(`${Sn}/bot`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function mS(){const l=await(await Se(`${Sn}/bot/raw`)).json();if(!l.success)throw new Error("");return l.content}async function xS(a){const r=await(await Se(`${Sn}/bot/raw`,{method:"POST",body:JSON.stringify({raw_content:a})})).json();if(!r.success)throw new Error(r.message||"")}async function tc(a){const r=await(await Se(`${Sn}/model`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function hS(a,l){const c=await(await Se(`${Sn}/bot/section/${a}`,{method:"POST",body:JSON.stringify(l)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function Xm(a,l){const c=await(await Se(`${Sn}/model/section/${a}`,{method:"POST",body:JSON.stringify(l)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function fS(a,l="openai",r="/models"){const c=new URLSearchParams({provider_name:a,parser:l,endpoint:r}),d=await Se(`/api/webui/models/list?${c}`);if(!d.ok){const h=await d.json().catch(()=>({}));throw new Error(h.detail||` (${d.status})`)}const m=await d.json();if(!m.success)throw new Error("");return m.models}async function pS(a){const l=new URLSearchParams({provider_name:a}),r=await Se(`/api/webui/models/test-connection-by-name?${l}`,{method:"POST"});if(!r.ok){const c=await r.json().catch(()=>({}));throw new Error(c.detail||` (${r.status})`)}return await r.json()}const gS=ei("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),pt=u.forwardRef(({className:a,variant:l,...r},c)=>e.jsx("div",{ref:c,role:"alert",className:F(gS({variant:l}),a),...r}));pt.displayName="Alert";const Qn=u.forwardRef(({className:a,...l},r)=>e.jsx("h5",{ref:r,className:F("mb-1 font-medium leading-none tracking-tight",a),...l}));Qn.displayName="AlertTitle";const gt=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("text-sm [&_p]:leading-relaxed",a),...l}));gt.displayName="AlertDescription";const jS={name:"toml",startState:function(){return{inString:!1,stringType:"",lhs:!0,inArray:0}},token:function(a,l){let r;if(!l.inString&&(r=a.match(/^('''|"""|'|")/))&&(l.stringType=r[0],l.inString=!0),a.sol()&&!l.inString&&l.inArray===0&&(l.lhs=!0),l.inString){for(;l.inString;)if(a.match(l.stringType))l.inString=!1;else if(a.peek()==="\\")a.next(),a.next();else{if(a.eol())break;a.match(/^.[^\\\"\']*/)}return l.lhs?"property":"string"}else{if(l.inArray&&a.peek()==="]")return a.next(),l.inArray--,"bracket";if(l.lhs&&a.peek()==="["&&a.skipTo("]"))return a.next(),a.peek()==="]"&&a.next(),"atom";if(a.peek()==="#")return a.skipToEnd(),"comment";if(a.eatSpace())return null;if(l.lhs&&a.eatWhile(function(c){return c!="="&&c!=" "}))return"property";if(l.lhs&&a.peek()==="=")return a.next(),l.lhs=!1,null;if(!l.lhs&&a.match(/^\d\d\d\d[\d\-\:\.T]*Z/))return"atom";if(!l.lhs&&(a.match("true")||a.match("false")))return"atom";if(!l.lhs&&a.peek()==="[")return l.inArray++,a.next(),"bracket";if(!l.lhs&&a.match(/^\-?\d+(?:\.\d+)?/))return"number";a.eatSpace()||a.next()}return null},languageData:{commentTokens:{line:"#"}}},vS={python:[l_()],json:[n_(),r_()],toml:[a_.define(jS)],text:[]};function Vv({value:a,onChange:l,language:r="text",readOnly:c=!1,height:d="400px",minHeight:m,maxHeight:h,placeholder:f,theme:p="dark",className:g=""}){const[N,j]=u.useState(!1);if(u.useEffect(()=>{j(!0)},[]),!N)return e.jsx("div",{className:`rounded-md border bg-muted animate-pulse ${g}`,style:{height:d,minHeight:m,maxHeight:h}});const b=[...vS[r]||[],Am.lineWrapping,Am.theme({"&":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-content":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-gutters":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-scroller":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'}})];return c&&b.push(Am.editable.of(!1)),e.jsx("div",{className:`rounded-md overflow-hidden border custom-scrollbar ${g}`,children:e.jsx(i_,{value:a,height:d,minHeight:m,maxHeight:h,theme:p==="dark"?c_:void 0,extensions:b,onChange:l,placeholder:f,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightSpecialChars:!0,history:!0,foldGutter:!0,drawSelection:!0,dropCursor:!0,allowMultipleSelections:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:!0,crosshairCursor:!0,highlightActiveLine:!0,highlightSelectionMatches:!0,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:!0,historyKeymap:!0,foldKeymap:!0,completionKeymap:!0,lintKeymap:!0}})})}function NS({id:a,index:l,itemType:r,itemFields:c,value:d,onChange:m,onRemove:h,disabled:f,canRemove:p,placeholder:g}){const{attributes:N,listeners:j,setNodeRef:b,transform:y,transition:w,isDragging:A}=_v({id:a,disabled:f}),M={transform:Sv.Transform.toString(y),transition:w};return e.jsxs("div",{ref:b,style:M,className:F("flex items-start gap-2 group",A&&"opacity-50 z-50"),children:[e.jsx("button",{type:"button",className:F("flex-shrink-0 p-2 cursor-grab active:cursor-grabbing","text-muted-foreground hover:text-foreground transition-colors","opacity-0 group-hover:opacity-100 focus:opacity-100",f&&"cursor-not-allowed opacity-30"),...N,...j,children:e.jsx(iv,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1 min-w-0",children:r==="object"&&c?e.jsx(bS,{value:d,onChange:m,fields:c,disabled:f}):r==="number"?e.jsx(le,{type:"number",value:d??"",onChange:S=>m(parseFloat(S.target.value)||0),placeholder:g??` ${l+1} `,disabled:f,className:"font-mono"}):e.jsx(le,{type:"text",value:d??"",onChange:S=>m(S.target.value),placeholder:g??` ${l+1} `,disabled:f})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:h,disabled:f||!p,className:F("flex-shrink-0 text-muted-foreground hover:text-destructive","opacity-0 group-hover:opacity-100 focus:opacity-100 transition-opacity"),children:e.jsx(os,{className:"h-4 w-4"})})]})}function bS({value:a,onChange:l,fields:r,disabled:c}){const d=u.useCallback((h,f)=>{l({...a,[h]:f})},[a,l]),m=(h,f)=>{const p=a?.[h];if(f.type==="boolean"||f.type==="switch")return e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(Ve,{checked:!!(p??f.default),onCheckedChange:g=>d(h,g),disabled:c})]});if(f.type==="slider"||f.type==="number"&&f.min!=null&&f.max!=null){const g=p??f.default??f.min??0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g})]}),e.jsx(Wa,{value:[g],onValueChange:N=>d(h,N[0]),min:f.min??0,max:f.max??100,step:f.step??1,disabled:c,className:"py-1"})]})}return f.type==="select"&&f.choices?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsxs(Ie,{value:String(p??f.default??""),onValueChange:g=>d(h,g),disabled:c,children:[e.jsx(Be,{className:"h-8 text-sm",children:e.jsx(Fe,{placeholder:f.placeholder??""})}),e.jsx(Pe,{children:f.choices.map(g=>e.jsx(Z,{value:String(g),children:String(g)},String(g)))})]})]}):f.type==="number"?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(le,{type:"number",value:p??f.default??"",onChange:g=>d(h,parseFloat(g.target.value)||0),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(le,{type:"text",value:p??f.default??"",onChange:g=>d(h,g.target.value),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]})};return e.jsx(Ce,{className:"p-3 space-y-2 bg-muted/30",children:Object.entries(r).map(([h,f])=>e.jsx("div",{children:m(h,f)},h))})}function yS({value:a,onChange:l,itemType:r="string",itemFields:c,minItems:d,maxItems:m,disabled:h,placeholder:f}){const p=u.useMemo(()=>Array.isArray(a)?a:typeof a=="string"&&a.trim()?a.split(",").map(E=>E.trim()):[],[a]),[g]=u.useState(()=>new Map),N=u.useCallback(E=>(g.has(E)||g.set(E,`item-${Date.now()}-${E}-${Math.random().toString(36).slice(2)}`),g.get(E)),[g]),j=u.useMemo(()=>{const E=[];for(let C=0;C<p.length;C++)E.push(N(C));return E},[p.length,N]),b=pv(Go(vv,{activationConstraint:{distance:8}}),Go(jv,{coordinateGetter:gv})),y=u.useCallback(E=>{const{active:C,over:R}=E;if(R&&C.id!==R.id){const H=j.indexOf(C.id),O=j.indexOf(R.id),X=Nv(p,H,O);l(X)}},[p,j,l]),w=u.useCallback(()=>{if(m!=null&&p.length>=m)return;let E;r==="object"&&c?E=Object.fromEntries(Object.entries(c).map(([C,R])=>[C,R.default??""])):r==="number"?E=0:E="",l([...p,E])},[p,m,r,c,l]),A=u.useCallback((E,C)=>{const R=[...p];R[E]=C,l(R)},[p,l]),M=u.useCallback(E=>{if(d!=null&&p.length<=d)return;const C=p.filter((R,H)=>H!==E);g.delete(E),l(C)},[p,d,g,l]),S=m==null||p.length<m,I=d==null||p.length>d;return e.jsxs("div",{className:"space-y-2",children:[p.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-4 justify-center border border-dashed rounded-md",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}):e.jsx(bv,{sensors:b,collisionDetection:yv,onDragEnd:y,children:e.jsx(wv,{items:j,strategy:o_,children:e.jsx("div",{className:"space-y-2",children:p.map((E,C)=>e.jsx(NS,{id:j[C],index:C,itemType:r,itemFields:c,value:E,onChange:R=>A(C,R),onRemove:()=>M(C),disabled:h,canRemove:I,placeholder:f},j[C]))})})}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:w,disabled:h||!S,className:"w-full",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),"",m!==void 0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",p.length,"/",m,")"]})]}),(d!=null||m!=null)&&(d!==null||m!==null)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:d!=null&&m!=null?` ${d} - ${m} `:d!=null?` ${d} `:` ${m} `})]})}function jx({content:a,className:l=""}){return e.jsx("div",{className:`prose prose-sm dark:prose-invert max-w-none ${l}`,children:e.jsx(f_,{remarkPlugins:[g_,j_],rehypePlugins:[p_],components:{code({inline:r,className:c,children:d,...m}){return r?e.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded text-sm font-mono",...m,children:d}):e.jsx("code",{className:`${c} block bg-muted p-4 rounded-lg overflow-x-auto`,...m,children:d})},table({children:r,...c}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"border-collapse border border-border",...c,children:r})})},th({children:r,...c}){return e.jsx("th",{className:"border border-border bg-muted px-4 py-2 text-left font-semibold",...c,children:r})},td({children:r,...c}){return e.jsx("td",{className:"border border-border px-4 py-2",...c,children:r})},a({children:r,...c}){return e.jsx("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...c,children:r})},blockquote({children:r,...c}){return e.jsx("blockquote",{className:"border-l-4 border-primary pl-4 italic text-muted-foreground",...c,children:r})},h1({children:r,...c}){return e.jsx("h1",{className:"text-3xl font-bold mt-6 mb-4",...c,children:r})},h2({children:r,...c}){return e.jsx("h2",{className:"text-2xl font-bold mt-5 mb-3",...c,children:r})},h3({children:r,...c}){return e.jsx("h3",{className:"text-xl font-bold mt-4 mb-2",...c,children:r})},h4({children:r,...c}){return e.jsx("h4",{className:"text-lg font-semibold mt-3 mb-2",...c,children:r})},ul({children:r,...c}){return e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",...c,children:r})},ol({children:r,...c}){return e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",...c,children:r})},p({children:r,...c}){return e.jsx("p",{className:"my-2 leading-relaxed",...c,children:r})},hr({...r}){return e.jsx("hr",{className:"my-4 border-border",...r})}},children:a})})}function wS(a,l){let r=a.slice(0,l).split(/\r\n|\n|\r/g);return[r.length,r.pop().length+1]}function _S(a,l,r){let c=a.split(/\r\n|\n|\r/g),d="",m=(Math.log10(l+1)|0)+1;for(let h=l-1;h<=l+1;h++){let f=c[h-1];f&&(d+=h.toString().padEnd(m," "),d+=":  ",d+=f,d+=`
`,h===l&&(d+=" ".repeat(m+r+2),d+=`^
`))}return d}class Rs extends Error{line;column;codeblock;constructor(l,r){const[c,d]=wS(r.toml,r.ptr),m=_S(r.toml,c,d);super(`Invalid TOML document: ${l}

${m}`,r),this.line=c,this.column=d,this.codeblock=m}}function SS(a,l){let r=0;for(;a[l-++r]==="\\";);return--r&&r%2}function Yo(a,l=0,r=a.length){let c=a.indexOf(`
`,l);return a[c-1]==="\r"&&c--,c<=r?c:-1}function vx(a,l){for(let r=l;r<a.length;r++){let c=a[r];if(c===`
`)return r;if(c==="\r"&&a[r+1]===`
`)return r+1;if(c<" "&&c!=="	"||c==="")throw new Rs("control characters are not allowed in comments",{toml:a,ptr:l})}return a.length}function Ul(a,l,r,c){let d;for(;(d=a[l])===" "||d==="	"||!r&&(d===`
`||d==="\r"&&a[l+1]===`
`);)l++;return c||d!=="#"?l:Ul(a,vx(a,l),r)}function Ig(a,l,r,c,d=!1){if(!c)return l=Yo(a,l),l<0?a.length:l;for(let m=l;m<a.length;m++){let h=a[m];if(h==="#")m=Yo(a,m);else{if(h===r)return m+1;if(h===c||d&&(h===`
`||h==="\r"&&a[m+1]===`
`))return m}}throw new Rs("cannot find end of structure",{toml:a,ptr:l})}function Gv(a,l){let r=a[l],c=r===a[l+1]&&a[l+1]===a[l+2]?a.slice(l,l+3):r;l+=c.length-1;do l=a.indexOf(c,++l);while(l>-1&&r!=="'"&&SS(a,l));return l>-1&&(l+=c.length,c.length>1&&(a[l]===r&&l++,a[l]===r&&l++)),l}let kS=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i;class Qr extends Date{#s=!1;#t=!1;#e=null;constructor(l){let r=!0,c=!0,d="Z";if(typeof l=="string"){let m=l.match(kS);m?(m[1]||(r=!1,l=`0000-01-01T${l}`),c=!!m[2],c&&l[10]===" "&&(l=l.replace(" ","T")),m[2]&&+m[2]>23?l="":(d=m[3]||null,l=l.toUpperCase(),!d&&c&&(l+="Z"))):l=""}super(l),isNaN(this.getTime())||(this.#s=r,this.#t=c,this.#e=d)}isDateTime(){return this.#s&&this.#t}isLocal(){return!this.#s||!this.#t||!this.#e}isDate(){return this.#s&&!this.#t}isTime(){return this.#t&&!this.#s}isValid(){return this.#s||this.#t}toISOString(){let l=super.toISOString();if(this.isDate())return l.slice(0,10);if(this.isTime())return l.slice(11,23);if(this.#e===null)return l.slice(0,-1);if(this.#e==="Z")return l;let r=+this.#e.slice(1,3)*60+ +this.#e.slice(4,6);return r=this.#e[0]==="-"?r:-r,new Date(this.getTime()-r*6e4).toISOString().slice(0,-1)+this.#e}static wrapAsOffsetDateTime(l,r="Z"){let c=new Qr(l);return c.#e=r,c}static wrapAsLocalDateTime(l){let r=new Qr(l);return r.#e=null,r}static wrapAsLocalDate(l){let r=new Qr(l);return r.#t=!1,r.#e=null,r}static wrapAsLocalTime(l){let r=new Qr(l);return r.#s=!1,r.#e=null,r}}let CS=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,TS=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,ES=/^[+-]?0[0-9_]/,MS=/^[0-9a-f]{4,8}$/i,Fg={b:"\b",t:"	",n:`
`,f:"\f",r:"\r",'"':'"',"\\":"\\"};function Kv(a,l=0,r=a.length){let c=a[l]==="'",d=a[l++]===a[l]&&a[l]===a[l+1];d&&(r-=2,a[l+=2]==="\r"&&l++,a[l]===`
`&&l++);let m=0,h,f="",p=l;for(;l<r-1;){let g=a[l++];if(g===`
`||g==="\r"&&a[l]===`
`){if(!d)throw new Rs("newlines are not allowed in strings",{toml:a,ptr:l-1})}else if(g<" "&&g!=="	"||g==="")throw new Rs("control characters are not allowed in strings",{toml:a,ptr:l-1});if(h){if(h=!1,g==="u"||g==="U"){let N=a.slice(l,l+=g==="u"?4:8);if(!MS.test(N))throw new Rs("invalid unicode escape",{toml:a,ptr:m});try{f+=String.fromCodePoint(parseInt(N,16))}catch{throw new Rs("invalid unicode escape",{toml:a,ptr:m})}}else if(d&&(g===`
`||g===" "||g==="	"||g==="\r")){if(l=Ul(a,l-1,!0),a[l]!==`
`&&a[l]!=="\r")throw new Rs("invalid escape: only line-ending whitespace may be escaped",{toml:a,ptr:m});l=Ul(a,l)}else if(g in Fg)f+=Fg[g];else throw new Rs("unrecognized escape sequence",{toml:a,ptr:m});p=l}else!c&&g==="\\"&&(m=l-1,h=!0,f+=a.slice(p,m))}return f+a.slice(p,r-1)}function AS(a,l,r,c){if(a==="true")return!0;if(a==="false")return!1;if(a==="-inf")return-1/0;if(a==="inf"||a==="+inf")return 1/0;if(a==="nan"||a==="+nan"||a==="-nan")return NaN;if(a==="-0")return c?0n:0;let d=CS.test(a);if(d||TS.test(a)){if(ES.test(a))throw new Rs("leading zeroes are not allowed",{toml:l,ptr:r});a=a.replace(/_/g,"");let h=+a;if(isNaN(h))throw new Rs("invalid number",{toml:l,ptr:r});if(d){if((d=!Number.isSafeInteger(h))&&!c)throw new Rs("integer value cannot be represented losslessly",{toml:l,ptr:r});(d||c===!0)&&(h=BigInt(a))}return h}const m=new Qr(a);if(!m.isValid())throw new Rs("invalid value",{toml:l,ptr:r});return m}function zS(a,l,r,c){let d=a.slice(l,r),m=d.indexOf("#");m>-1&&(vx(a,m),d=d.slice(0,m));let h=d.trimEnd();if(!c){let f=d.indexOf(`
`,h.length);if(f>-1)throw new Rs("newlines are not allowed in inline tables",{toml:a,ptr:l+f})}return[h,m]}function Nx(a,l,r,c,d){if(c===0)throw new Rs("document contains excessively nested structures. aborting.",{toml:a,ptr:l});let m=a[l];if(m==="["||m==="{"){let[p,g]=m==="["?OS(a,l,c,d):DS(a,l,c,d),N=r?Ig(a,g,",",r):g;if(g-N&&r==="}"){let j=Yo(a,g,N);if(j>-1)throw new Rs("newlines are not allowed in inline tables",{toml:a,ptr:j})}return[p,N]}let h;if(m==='"'||m==="'"){h=Gv(a,l);let p=Kv(a,l,h);if(r){if(h=Ul(a,h,r!=="]"),a[h]&&a[h]!==","&&a[h]!==r&&a[h]!==`
`&&a[h]!=="\r")throw new Rs("unexpected character encountered",{toml:a,ptr:h});h+=+(a[h]===",")}return[p,h]}h=Ig(a,l,",",r);let f=zS(a,l,h-+(a[h-1]===","),r==="]");if(!f[0])throw new Rs("incomplete key-value declaration: no value specified",{toml:a,ptr:l});return r&&f[1]>-1&&(h=Ul(a,l+f[1]),h+=+(a[h]===",")),[AS(f[0],a,l,d),h]}let RS=/^[a-zA-Z0-9-_]+[ \t]*$/;function Zm(a,l,r="="){let c=l-1,d=[],m=a.indexOf(r,l);if(m<0)throw new Rs("incomplete key-value: cannot find end of key",{toml:a,ptr:l});do{let h=a[l=++c];if(h!==" "&&h!=="	")if(h==='"'||h==="'"){if(h===a[l+1]&&h===a[l+2])throw new Rs("multiline strings are not allowed in keys",{toml:a,ptr:l});let f=Gv(a,l);if(f<0)throw new Rs("unfinished string encountered",{toml:a,ptr:l});c=a.indexOf(".",f);let p=a.slice(f,c<0||c>m?m:c),g=Yo(p);if(g>-1)throw new Rs("newlines are not allowed in keys",{toml:a,ptr:l+c+g});if(p.trimStart())throw new Rs("found extra tokens after the string part",{toml:a,ptr:f});if(m<f&&(m=a.indexOf(r,f),m<0))throw new Rs("incomplete key-value: cannot find end of key",{toml:a,ptr:l});d.push(Kv(a,l,f))}else{c=a.indexOf(".",l);let f=a.slice(l,c<0||c>m?m:c);if(!RS.test(f))throw new Rs("only letter, numbers, dashes and underscores are allowed in keys",{toml:a,ptr:l});d.push(f.trimEnd())}}while(c+1&&c<m);return[d,Ul(a,m+1,!0,!0)]}function DS(a,l,r,c){let d={},m=new Set,h,f=0;for(l++;(h=a[l++])!=="}"&&h;){let p={toml:a,ptr:l-1};if(h===`
`)throw new Rs("newlines are not allowed in inline tables",p);if(h==="#")throw new Rs("inline tables cannot contain comments",p);if(h===",")throw new Rs("expected key-value, found comma",p);if(h!==" "&&h!=="	"){let g,N=d,j=!1,[b,y]=Zm(a,l-1);for(let M=0;M<b.length;M++){if(M&&(N=j?N[g]:N[g]={}),g=b[M],(j=Object.hasOwn(N,g))&&(typeof N[g]!="object"||m.has(N[g])))throw new Rs("trying to redefine an already defined value",{toml:a,ptr:l});!j&&g==="__proto__"&&Object.defineProperty(N,g,{enumerable:!0,configurable:!0,writable:!0})}if(j)throw new Rs("trying to redefine an already defined value",{toml:a,ptr:l});let[w,A]=Nx(a,y,"}",r-1,c);m.add(w),N[g]=w,l=A,f=a[l-1]===","?l-1:0}}if(f)throw new Rs("trailing commas are not allowed in inline tables",{toml:a,ptr:f});if(!h)throw new Rs("unfinished table encountered",{toml:a,ptr:l});return[d,l]}function OS(a,l,r,c){let d=[],m;for(l++;(m=a[l++])!=="]"&&m;){if(m===",")throw new Rs("expected value, found comma",{toml:a,ptr:l-1});if(m==="#")l=vx(a,l);else if(m!==" "&&m!=="	"&&m!==`
`&&m!=="\r"){let h=Nx(a,l-1,"]",r-1,c);d.push(h[0]),l=h[1]}}if(!m)throw new Rs("unfinished array encountered",{toml:a,ptr:l});return[d,l]}function Hg(a,l,r,c){let d=l,m=r,h,f=!1,p;for(let g=0;g<a.length;g++){if(g){if(d=f?d[h]:d[h]={},m=(p=m[h]).c,c===0&&(p.t===1||p.t===2))return null;if(p.t===2){let N=d.length-1;d=d[N],m=m[N].c}}if(h=a[g],(f=Object.hasOwn(d,h))&&m[h]?.t===0&&m[h]?.d)return null;f||(h==="__proto__"&&(Object.defineProperty(d,h,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(m,h,{enumerable:!0,configurable:!0,writable:!0})),m[h]={t:g<a.length-1&&c===2?3:c,d:!1,i:0,c:{}})}if(p=m[h],p.t!==c&&!(c===1&&p.t===3)||(c===2&&(p.d||(p.d=!0,d[h]=[]),d[h].push(d={}),p.c[p.i++]=p={t:1,d:!1,i:0,c:{}}),p.d))return null;if(p.d=!0,c===1)d=f?d[h]:d[h]={};else if(c===0&&f)return null;return[h,d,p.c]}function bx(a,{maxDepth:l=1e3,integersAsBigInt:r}={}){let c={},d={},m=c,h=d;for(let f=Ul(a,0);f<a.length;){if(a[f]==="["){let p=a[++f]==="[",g=Zm(a,f+=+p,"]");if(p){if(a[g[1]-1]!=="]")throw new Rs("expected end of table declaration",{toml:a,ptr:g[1]-1});g[1]++}let N=Hg(g[0],c,d,p?2:1);if(!N)throw new Rs("trying to redefine an already defined table or value",{toml:a,ptr:f});h=N[2],m=N[1],f=g[1]}else{let p=Zm(a,f),g=Hg(p[0],m,h,0);if(!g)throw new Rs("trying to redefine an already defined table or value",{toml:a,ptr:f});let N=Nx(a,p[1],void 0,l,r);g[1][g[0]]=N[0],f=N[1]}if(f=Ul(a,f,!0),a[f]&&a[f]!==`
`&&a[f]!=="\r")throw new Rs("each key-value declaration must be followed by an end-of-line",{toml:a,ptr:f});f=Ul(a,f)}return c}let Qv=/^[a-z0-9-_]+$/i;function gc(a){let l=typeof a;if(l==="object"){if(Array.isArray(a))return"array";if(a instanceof Date)return"date"}return l}function LS(a){for(let l=0;l<a.length;l++)if(gc(a[l])!=="object")return!1;return a.length!=0}function yx(a){return JSON.stringify(a).replace(/\x7f/g,"\\u007f")}function wx(a,l,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");if(l==="number")return isNaN(a)?"nan":a===1/0?"inf":a===-1/0?"-inf":c&&Number.isInteger(a)?a.toFixed(1):a.toString();if(l==="bigint"||l==="boolean")return a.toString();if(l==="string")return yx(a);if(l==="date"){if(isNaN(a.getTime()))throw new TypeError("cannot serialize invalid date");return a.toISOString()}if(l==="object")return US(a,r,c);if(l==="array")return $S(a,r,c)}function US(a,l,r){let c=Object.keys(a);if(c.length===0)return"{}";let d="{ ";for(let m=0;m<c.length;m++){let h=c[m];m&&(d+=", "),d+=Qv.test(h)?h:yx(h),d+=" = ",d+=wx(a[h],gc(a[h]),l-1,r)}return d+" }"}function $S(a,l,r){if(a.length===0)return"[]";let c="[ ";for(let d=0;d<a.length;d++){if(d&&(c+=", "),a[d]===null||a[d]===void 0)throw new TypeError("arrays cannot contain null or undefined values");c+=wx(a[d],gc(a[d]),l-1,r)}return c+" ]"}function BS(a,l,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let d="";for(let m=0;m<a.length;m++)d+=`${d&&`
`}[[${l}]]
`,d+=_x(0,a[m],l,r,c);return d}function _x(a,l,r,c,d){if(c===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let m="",h="",f=Object.keys(l);for(let p=0;p<f.length;p++){let g=f[p];if(l[g]!==null&&l[g]!==void 0){let N=gc(l[g]);if(N==="symbol"||N==="function")throw new TypeError(`cannot serialize values of type '${N}'`);let j=Qv.test(g)?g:yx(g);if(N==="array"&&LS(l[g]))h+=(h&&`
`)+BS(l[g],r?`${r}.${j}`:j,c-1,d);else if(N==="object"){let b=r?`${r}.${j}`:j;h+=(h&&`
`)+_x(b,l[g],b,c-1,d)}else m+=j,m+=" = ",m+=wx(l[g],N,c,d),m+=`
`}}return a&&(m||!h)&&(m=m?`[${a}]
${m}`:`[${a}]`),m&&h?`${m}
${h}`:m||h}function PS(a,{maxDepth:l=1e3,numbersAsFloat:r=!1}={}){if(gc(a)!=="object")throw new TypeError("stringify can only be called with an object");let c=_x(0,a,"",l,r);return c[c.length-1]!==`
`?c+`
`:c}function IS(a,l,r,c={}){const{debounceMs:d=2e3,onSaveSuccess:m,onSaveError:h}=c,f=u.useRef(null),p=u.useCallback(async(b,y)=>{try{l(!0),await hS(b,y),r(!1),m?.()}catch(w){console.error(` ${b} :`,w),r(!0),h?.(w instanceof Error?w:new Error(String(w)))}finally{l(!1)}},[l,r,m,h]),g=u.useCallback((b,y)=>{a||(r(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(b,y)},d))},[a,r,p,d]),N=u.useCallback(async(b,y)=>{f.current&&(clearTimeout(f.current),f.current=null),await p(b,y)},[p]),j=u.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);return u.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),{triggerAutoSave:g,saveNow:N,cancelPendingAutoSave:j}}function Vt(a,l,r,c){u.useEffect(()=>{a&&!r&&c(l,a)},[a])}const FS=500;function HS(){return e.jsx(tr,{children:e.jsx(qS,{})})}function qS(){const[a,l]=u.useState(!0),[r,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(!1),[p,g]=u.useState("visual"),[N,j]=u.useState(""),[b,y]=u.useState(!1),[w,A]=u.useState(""),{toast:M}=nt(),{triggerRestart:S,isRestarting:I}=_n(),[E,C]=u.useState(null),[R,H]=u.useState(null),[O,X]=u.useState(null),[L,me]=u.useState(null),[Ne,je]=u.useState(null),[ce,ge]=u.useState(null),[pe,D]=u.useState(null),[Q,B]=u.useState(null),[ue,Y]=u.useState(null),[_e,he]=u.useState(null),[Te,G]=u.useState(null),[$,z]=u.useState(null),[K,De]=u.useState(null),[se,Le]=u.useState(null),[rs,J]=u.useState(null),[W,Ue]=u.useState(null),[ae,Ee]=u.useState(null),[de,Re]=u.useState(null),[ys,Js]=u.useState(null),[kt,pa]=u.useState(null),[rt,$s]=u.useState(null),q=u.useRef(!0),He=u.useRef({}),Ke=Ae=>{const Ge=Ae.split(`
`);let Ls=Ge[0];Ls=Ls.replace(/^Error:\s*/,"");const ct=[[/Invalid TOML document: unrecognized escape sequence/,"TOML  \\\\ "],[/Invalid TOML document: only letter, numbers, dashes and underscores are allowed in keys/,"TOML "],[/Invalid TOML document: (.+)/,"TOML $1"],[/Unexpected character.*at line (\d+), column (\d+)/," $1  $2 "],[/Expected.*at line (\d+), column (\d+)/," $1  $2 "],[/Invalid.*at line (\d+), column (\d+)/," $1  $2 "],[/Unterminated string at line (\d+)/," $1 "],[/Duplicate key.*at line (\d+)/," $1 "],[/Invalid escape sequence at line (\d+)/," $1  \\\\ "],[/Expected.*but got.*at line (\d+)/," $1 "],[/line (\d+), column (\d+)/," $1  $2 "],[/Unexpected end of input/,""],[/Unexpected token/,""],[/Invalid number/,""],[/Invalid date/,""],[/Invalid boolean/," true  false"],[/Unexpected character/,""],[/unrecognized escape sequence/,""]];for(const[Ht,da]of ct)if(Ht.test(Ls)){Ls=Ls.replace(Ht,da);break}return Ge.length>1?(Ge[0]=Ls,Ge.join(`
`)):Ls},Ze=u.useCallback(Ae=>{He.current=Ae,C(Ae.bot),H(Ae.personality);const Ge=Ae.chat;Ge.talk_value_rules||(Ge.talk_value_rules=[]),X(Ge),me(Ae.expression),je(Ae.emoji),ge(Ae.memory),D(Ae.tool),B(Ae.voice),Y(Ae.message_receive),he(Ae.dream),G(Ae.lpmm_knowledge),z(Ae.keyword_reaction),De(Ae.response_post_process),Le(Ae.chinese_typo),J(Ae.response_splitter),Ue(Ae.log),Ee(Ae.debug),Re(Ae.experimental),Js(Ae.maim_message),pa(Ae.telemetry),$s(Ae.webui)},[]),Ts=u.useCallback(()=>({...He.current,bot:E,personality:R,chat:O,expression:L,emoji:Ne,memory:ce,tool:pe,voice:Q,message_receive:ue,dream:_e,lpmm_knowledge:Te,keyword_reaction:$,response_post_process:K,chinese_typo:se,response_splitter:rs,log:W,debug:ae,experimental:de,maim_message:ys,telemetry:kt,webui:rt}),[E,R,O,L,Ne,ce,pe,Q,ue,_e,Te,$,K,se,rs,W,ae,de,ys,kt,rt]),as=u.useCallback(async()=>{try{const Ge=(await mS()).replace(/"([^"]*)"/g,(Ls,ct)=>`"${ct.replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\"/g,'"').replace(/\\\\/g,"\\")}"`);j(Ge),y(!1)}catch(Ae){M({variant:"destructive",title:"",description:Ae instanceof Error?Ae.message:""})}},[M]),Es=u.useCallback(async()=>{try{l(!0);const Ae=await Bg();Ze(Ae),f(!1),q.current=!1,await as()}catch(Ae){console.error(":",Ae),M({title:"",description:"",variant:"destructive"})}finally{l(!1)}},[M,as,Ze]);u.useEffect(()=>{Es()},[Es]);const{triggerAutoSave:es,cancelPendingAutoSave:Is}=IS(q.current,m,f);Vt(E,"bot",q.current,es),Vt(R,"personality",q.current,es),Vt(O,"chat",q.current,es),Vt(L,"expression",q.current,es),Vt(Ne,"emoji",q.current,es),Vt(ce,"memory",q.current,es),Vt(pe,"tool",q.current,es),Vt(Q,"voice",q.current,es),Vt(_e,"dream",q.current,es),Vt(Te,"lpmm_knowledge",q.current,es),Vt($,"keyword_reaction",q.current,es),Vt(K,"response_post_process",q.current,es),Vt(se,"chinese_typo",q.current,es),Vt(rs,"response_splitter",q.current,es),Vt(W,"log",q.current,es),Vt(ae,"debug",q.current,es),Vt(ys,"maim_message",q.current,es),Vt(kt,"telemetry",q.current,es),Vt(rt,"webui",q.current,es);const ds=async()=>{try{c(!0);try{bx(N)}catch(Ge){const Ls=Ge instanceof Error?Ge.message:"TOML ",ct=Ke(Ls);y(!0),A(ct),M({variant:"destructive",title:"TOML ",description:ct}),c(!1);return}const Ae=N.replace(/"([^"]*)"/g,(Ge,Ls)=>`"${Ls.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}"`);await xS(Ae),f(!1),y(!1),A(""),M({title:"",description:""}),await Es()}catch(Ae){y(!0);const Ge=Ae instanceof Error?Ae.message:"";A(Ge),M({variant:"destructive",title:"",description:Ge})}finally{c(!1)}},is=async Ae=>{if(h){M({variant:"destructive",title:"",description:""});return}if(g(Ae),Ae==="source")await as();else try{const Ge=await Bg();Ze(Ge),f(!1)}catch(Ge){console.error(":",Ge),M({title:"",description:"",variant:"destructive"})}},ws=async()=>{try{c(!0),Is(),await Pg(Ts()),f(!1),M({title:"",description:""})}catch(Ae){console.error(":",Ae),M({title:"",description:Ae.message,variant:"destructive"})}finally{c(!1)}},it=async()=>{await S()},vt=async()=>{try{c(!0),Is(),await Pg(Ts()),f(!1),M({title:"",description:"..."}),await new Promise(Ae=>setTimeout(Ae,FS)),await it()}catch(Ae){console.error(":",Ae),M({title:"",description:Ae.message,variant:"destructive"})}finally{c(!1)}};return a?e.jsx(ts,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs sm:text-sm",children:""})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(_,{onClick:p==="visual"?ws:ds,disabled:r||d||!h||I,size:"sm",variant:"outline",className:"w-20 sm:w-24",children:[e.jsx(fc,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:r?"":d?"":h?"":""})]}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{disabled:r||d||I,size:"sm",className:"w-20 sm:w-28",children:[e.jsx(hc,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:I?"":h?"":""})]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:h?",":","})})})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:h?vt:it,children:h?"":""})]})]})]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(Jt,{value:p,onValueChange:Ae=>is(Ae),className:"w-full",children:e.jsxs(Gt,{className:"h-8 sm:h-9 w-full grid grid-cols-2",children:[e.jsxs(Ye,{value:"visual",className:"text-xs sm:text-sm",children:[e.jsx(cv,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]}),e.jsxs(Ye,{value:"source",className:"text-xs sm:text-sm",children:[e.jsx(ix,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]})]})})})]}),e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""}),'""']})]}),p==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(gt,{children:[e.jsx("strong",{children:""})," TOML  TOML ",b&&w&&e.jsxs("div",{className:"text-destructive font-semibold mt-3 p-3 bg-destructive/10 rounded-md",children:[e.jsx("div",{className:"font-bold mb-2",children:" TOML "}),e.jsx("pre",{className:"text-sm font-mono whitespace-pre-wrap break-words",children:w})]})]})]}),e.jsx(Vv,{value:N,onChange:Ae=>{j(Ae),f(!0),b&&(y(!1),A(""))},language:"toml",theme:"dark",height:"calc(100vh - 280px)",minHeight:"500px",placeholder:"TOML "})]}),p==="visual"&&e.jsx(e.Fragment,{children:e.jsxs(Jt,{defaultValue:"bot",className:"w-full",children:[e.jsxs(Gt,{className:"flex flex-wrap h-auto gap-1 p-1 sm:grid sm:grid-cols-5 lg:grid-cols-10",children:[e.jsx(Ye,{value:"bot",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"personality",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"chat",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"expression",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"features",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"processing",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"dream",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"lpmm",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"webui",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:"WebUI"}),e.jsx(Ye,{value:"other",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""})]}),e.jsx(Cs,{value:"bot",className:"space-y-4",children:E&&e.jsx(K2,{config:E,onChange:C})}),e.jsx(Cs,{value:"personality",className:"space-y-4",children:R&&e.jsx(Q2,{config:R,onChange:H})}),e.jsx(Cs,{value:"chat",className:"space-y-4",children:O&&e.jsx(X2,{config:O,onChange:X})}),e.jsx(Cs,{value:"expression",className:"space-y-4",children:L&&e.jsx(iS,{config:L,onChange:me})}),e.jsx(Cs,{value:"features",className:"space-y-4",children:Ne&&ce&&pe&&Q&&e.jsx(nS,{emojiConfig:Ne,memoryConfig:ce,toolConfig:pe,voiceConfig:Q,onEmojiChange:je,onMemoryChange:ge,onToolChange:D,onVoiceChange:B})}),e.jsxs(Cs,{value:"processing",className:"space-y-4",children:[$&&K&&se&&rs&&e.jsx(oS,{keywordReactionConfig:$,responsePostProcessConfig:K,chineseTypoConfig:se,responseSplitterConfig:rs,onKeywordReactionChange:z,onResponsePostProcessChange:De,onChineseTypoChange:Le,onResponseSplitterChange:J}),ue&&e.jsx(dS,{config:ue,onChange:Y})]}),e.jsx(Cs,{value:"dream",className:"space-y-4",children:_e&&e.jsx(Z2,{config:_e,onChange:he})}),e.jsx(Cs,{value:"lpmm",className:"space-y-4",children:Te&&e.jsx(W2,{config:Te,onChange:G})}),e.jsx(Cs,{value:"webui",className:"space-y-4",children:rt&&e.jsx(uS,{config:rt,onChange:$s})}),e.jsxs(Cs,{value:"other",className:"space-y-4",children:[W&&e.jsx(eS,{config:W,onChange:Ue}),ae&&e.jsx(sS,{config:ae,onChange:Ee}),de&&e.jsx(tS,{config:de,onChange:Re}),ys&&e.jsx(aS,{config:ys,onChange:Js}),kt&&e.jsx(lS,{config:kt,onChange:pa})]})]})}),e.jsx(ar,{})]})})}const Pl=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:F("w-full caption-bottom text-sm",a),...l})}));Pl.displayName="Table";const Il=u.forwardRef(({className:a,...l},r)=>e.jsx("thead",{ref:r,className:F("[&_tr]:border-b",a),...l}));Il.displayName="TableHeader";const Fl=u.forwardRef(({className:a,...l},r)=>e.jsx("tbody",{ref:r,className:F("[&_tr:last-child]:border-0",a),...l}));Fl.displayName="TableBody";const VS=u.forwardRef(({className:a,...l},r)=>e.jsx("tfoot",{ref:r,className:F("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...l}));VS.displayName="TableFooter";const wt=u.forwardRef(({className:a,...l},r)=>e.jsx("tr",{ref:r,className:F("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...l}));wt.displayName="TableRow";const ns=u.forwardRef(({className:a,...l},r)=>e.jsx("th",{ref:r,className:F("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...l}));ns.displayName="TableHead";const Je=u.forwardRef(({className:a,...l},r)=>e.jsx("td",{ref:r,className:F("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...l}));Je.displayName="TableCell";const GS=u.forwardRef(({className:a,...l},r)=>e.jsx("caption",{ref:r,className:F("mt-4 text-sm text-muted-foreground",a),...l}));GS.displayName="TableCaption";const dd=u.forwardRef(({className:a,...l},r)=>e.jsx(ka,{ref:r,className:F("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...l}));dd.displayName=ka.displayName;const ud=u.forwardRef(({className:a,...l},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Ut,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(ka.Input,{ref:r,className:F("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...l})]}));ud.displayName=ka.Input.displayName;const md=u.forwardRef(({className:a,...l},r)=>e.jsx(ka.List,{ref:r,className:F("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...l}));md.displayName=ka.List.displayName;const xd=u.forwardRef((a,l)=>e.jsx(ka.Empty,{ref:l,className:"py-6 text-center text-sm",...a}));xd.displayName=ka.Empty.displayName;const oc=u.forwardRef(({className:a,...l},r)=>e.jsx(ka.Group,{ref:r,className:F("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...l}));oc.displayName=ka.Group.displayName;const KS=u.forwardRef(({className:a,...l},r)=>e.jsx(ka.Separator,{ref:r,className:F("-mx-1 h-px bg-border",a),...l}));KS.displayName=ka.Separator.displayName;const dc=u.forwardRef(({className:a,...l},r)=>e.jsx(ka.Item,{ref:r,className:F("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...l}));dc.displayName=ka.Item.displayName;const Yv=u.createContext(null),Jv="maibot-completed-tours";function QS(){try{const a=localStorage.getItem(Jv);return a?new Set(JSON.parse(a)):new Set}catch{return new Set}}function qg(a){localStorage.setItem(Jv,JSON.stringify([...a]))}function YS({children:a}){const[l,r]=u.useState({activeTourId:null,stepIndex:0,isRunning:!1}),[c]=u.useState(()=>new Map),[d,m]=u.useState(QS),[,h]=u.useState(0),f=u.useCallback((E,C)=>{c.set(E,C),h(R=>R+1)},[c]),p=u.useCallback(E=>{c.delete(E),r(C=>C.activeTourId===E?{...C,activeTourId:null,isRunning:!1,stepIndex:0}:C)},[c]),g=u.useCallback((E,C=0)=>{c.has(E)&&r({activeTourId:E,stepIndex:C,isRunning:!0})},[c]),N=u.useCallback(()=>{r(E=>({...E,isRunning:!1}))},[]),j=u.useCallback(E=>{r(C=>({...C,stepIndex:E}))},[]),b=u.useCallback(()=>{r(E=>({...E,stepIndex:E.stepIndex+1}))},[]),y=u.useCallback(()=>{r(E=>({...E,stepIndex:Math.max(0,E.stepIndex-1)}))},[]),w=u.useCallback(()=>l.activeTourId?c.get(l.activeTourId)||[]:[],[l.activeTourId,c]),A=u.useCallback(E=>{m(C=>{const R=new Set(C);return R.add(E),qg(R),R})},[]),M=u.useCallback(E=>{const{action:C,index:R,status:H,type:O}=E,X=["finished","skipped"];if(C==="close"){r(L=>({...L,isRunning:!1,stepIndex:0}));return}X.includes(H)?r(L=>(H==="finished"&&L.activeTourId&&setTimeout(()=>A(L.activeTourId),0),{...L,isRunning:!1,stepIndex:0})):O==="step:after"&&(C==="next"?r(L=>({...L,stepIndex:R+1})):C==="prev"&&r(L=>({...L,stepIndex:R-1})))},[A]),S=u.useCallback(E=>d.has(E),[d]),I=u.useCallback(E=>{m(C=>{const R=new Set(C);return R.delete(E),qg(R),R})},[]);return e.jsx(Yv.Provider,{value:{state:l,tours:c,registerTour:f,unregisterTour:p,startTour:g,stopTour:N,goToStep:j,nextStep:b,prevStep:y,getCurrentSteps:w,handleJoyrideCallback:M,isTourCompleted:S,markTourCompleted:A,resetTourCompleted:I},children:a})}function Sx(){const a=u.useContext(Yv);if(!a)throw new Error("useTour must be used within a TourProvider");return a}const JS={options:{zIndex:1e4,primaryColor:"hsl(var(--primary))",textColor:"hsl(var(--foreground))",backgroundColor:"hsl(var(--background))",arrowColor:"hsl(var(--background))",overlayColor:"rgba(0, 0, 0, 0.5)"},tooltip:{borderRadius:"var(--radius)",padding:"1rem"},tooltipContainer:{textAlign:"left"},tooltipTitle:{fontSize:"1rem",fontWeight:600,marginBottom:"0.5rem"},tooltipContent:{fontSize:"0.875rem",padding:"0.5rem 0"},buttonNext:{backgroundColor:"hsl(var(--primary))",color:"hsl(var(--primary-foreground))",borderRadius:"calc(var(--radius) - 2px)",fontSize:"0.875rem",padding:"0.5rem 1rem"},buttonBack:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem",marginRight:"0.5rem"},buttonSkip:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem"},buttonClose:{color:"hsl(var(--muted-foreground))"},spotlight:{borderRadius:"var(--radius)"}},XS={back:"",close:"",last:"",next:"",nextLabelWithProgress:" ({step}/{steps})",open:"",skip:""};function ZS(){const{state:a,getCurrentSteps:l,handleJoyrideCallback:r}=Sx(),c=l(),[d,m]=u.useState(!1),h=u.useRef(a.stepIndex),f=u.useRef(null);u.useEffect(()=>{h.current!==a.stepIndex&&(m(!1),h.current=a.stepIndex)},[a.stepIndex]),u.useEffect(()=>{if(!a.isRunning||c.length===0){m(!1);return}const j=c[a.stepIndex];if(!j){m(!1);return}const b=j.target;if(b==="body"){m(!0);return}m(!1);const y=setTimeout(()=>{const w=()=>{const I=document.querySelector(b);if(I){const E=I.getBoundingClientRect();if(E.width>0&&E.height>0)return!0}return!1};if(w()){setTimeout(()=>m(!0),100);return}const A=setInterval(()=>{w()&&(clearInterval(A),setTimeout(()=>m(!0),100))},100),M=setTimeout(()=>{clearInterval(A),m(!0)},5e3),S=()=>{clearInterval(A),clearTimeout(M)};f.current=S},150);return()=>{clearTimeout(y),f.current&&(f.current(),f.current=null)}},[a.isRunning,a.stepIndex,c]);const[p,g]=u.useState(null);if(u.useEffect(()=>{let j=document.getElementById("tour-portal-container");return j||(j=document.createElement("div"),j.id="tour-portal-container",j.style.cssText="position: fixed; top: 0; left: 0; z-index: 99999; pointer-events: none;",document.body.appendChild(j)),g(j),()=>{}},[]),!a.isRunning||c.length===0||!d)return null;const N=e.jsx(u_,{steps:c,stepIndex:a.stepIndex,run:a.isRunning,continuous:!0,showSkipButton:!0,showProgress:!0,disableOverlayClose:!0,disableScrolling:!1,disableScrollParentFix:!1,callback:r,styles:JS,locale:XS,scrollOffset:80,scrollToFirstStep:!0,floaterProps:{styles:{floater:{zIndex:99999}},disableAnimation:!0}},`tour-step-${a.stepIndex}`);return p?X0.createPortal(N,p):N}const hl="model-assignment-tour",Xv=[{target:"body",content:"",placement:"center",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="sidebar-model-provider"]',content:' DeepSeek Siliconflow""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-provider-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="provider-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-apikey-input"]',content:" API  API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-url-input"]',content:" API API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-template-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="sidebar-model-management"]',content:'""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-model-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="model-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-provider-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-identifier-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="tasks-tab-trigger"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="task-model-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1}],Zv={0:"/config/model",1:"/config/model",2:"/config/modelProvider",3:"/config/modelProvider",4:"/config/modelProvider",5:"/config/modelProvider",6:"/config/modelProvider",7:"/config/modelProvider",8:"/config/modelProvider",9:"/config/modelProvider",10:"/config/modelProvider",11:"/config/model",12:"/config/model",13:"/config/model",14:"/config/model",15:"/config/model",16:"/config/model",17:"/config/model",18:"/config/model",19:"/config/model"},Xi=[{id:"siliconflow",name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",client_type:"openai",display_name:" (SiliconFlow)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"deepseek",name:"DeepSeek",base_url:"https://api.deepseek.com",client_type:"openai",display_name:"DeepSeek",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"rinkoai",name:"RinkoAI",base_url:"https://rinkoai.com/v1",client_type:"openai",display_name:"RinkoAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"zhipu",name:"ZhipuAI",base_url:"https://open.bigmodel.cn/api/paas/v4",client_type:"openai",display_name:" AI (ZhipuAI / GLM)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"moonshot",name:"Moonshot",base_url:"https://api.moonshot.cn/v1",client_type:"openai",display_name:" (Moonshot / Kimi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"doubao",name:"Doubao",base_url:"https://ark.cn-beijing.volces.com/api/v3",client_type:"openai",display_name:" (Doubao)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"alibaba",name:"Alibaba",base_url:"https://dashscope.aliyuncs.com/compatible-mode/v1",client_type:"openai",display_name:" (Alibaba Qwen)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"baichuan",name:"Baichuan",base_url:"https://api.baichuan-ai.com/v1",client_type:"openai",display_name:" (Baichuan)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"minimax",name:"MiniMax",base_url:"https://api.minimax.chat/v1",client_type:"openai",display_name:"MiniMax ( AI)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"stepfun",name:"StepFun",base_url:"https://api.stepfun.com/v1",client_type:"openai",display_name:" (StepFun)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"lingyi",name:"Lingyi",base_url:"https://api.lingyiwanwu.com/v1",client_type:"openai",display_name:" (Lingyi / Yi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"openai",name:"OpenAI",base_url:"https://api.openai.com/v1",client_type:"openai",display_name:"OpenAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"xai",name:"xAI",base_url:"https://api.x.ai/v1",client_type:"openai",display_name:"xAI (Grok)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"anthropic",name:"Anthropic",base_url:"https://api.anthropic.com/v1",client_type:"openai",display_name:"Anthropic (Claude)"},{id:"gemini",name:"Gemini",base_url:"https://generativelanguage.googleapis.com/v1beta",client_type:"gemini",display_name:"Google Gemini",modelFetcher:{endpoint:"/models",parser:"gemini"}},{id:"cohere",name:"Cohere",base_url:"https://api.cohere.ai/v1",client_type:"openai",display_name:"Cohere"},{id:"groq",name:"Groq",base_url:"https://api.groq.com/openai/v1",client_type:"openai",display_name:"Groq",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"together",name:"Together AI",base_url:"https://api.together.xyz/v1",client_type:"openai",display_name:"Together AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"fireworks",name:"Fireworks",base_url:"https://api.fireworks.ai/inference/v1",client_type:"openai",display_name:"Fireworks AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"mistral",name:"Mistral",base_url:"https://api.mistral.ai/v1",client_type:"openai",display_name:"Mistral AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"perplexity",name:"Perplexity",base_url:"https://api.perplexity.ai",client_type:"openai",display_name:"Perplexity AI"},{id:"custom",name:"",base_url:"",client_type:"openai",display_name:""}];function Vg(a){return a?a.replace(/\/+$/,"").toLowerCase():""}function WS(a){if(!a)return null;const l=Vg(a);return Xi.find(r=>r.id!=="custom"&&Vg(r.base_url)===l)||null}const Do=a=>({...a,max_retry:a.max_retry??2,timeout:a.timeout??30,retry_interval:a.retry_interval??10}),e4=(a,l=[],r=null)=>{const c={};return a?(a.name?.trim()?l.some((m,h)=>r!==null&&h===r?!1:m.name.trim().toLowerCase()===a.name.trim().toLowerCase())&&(c.name=""):c.name="",a.base_url?.trim()||(c.base_url=" URL"),a.api_key?.trim()||(c.api_key=" API Key"),{isValid:Object.keys(c).length===0,errors:c}):{isValid:!1,errors:{name:""}}};function s4(){return e.jsx(tr,{children:e.jsx(t4,{})})}function t4(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(!1),[h,f]=u.useState(!1),[p,g]=u.useState(!1),[N,j]=u.useState(!1),[b,y]=u.useState(null),[w,A]=u.useState(null),[M,S]=u.useState("custom"),[I,E]=u.useState(!1),[C,R]=u.useState(!1),[H,O]=u.useState(null),[X,L]=u.useState(!1),[me,Ne]=u.useState(""),[je,ce]=u.useState(new Set),[ge,pe]=u.useState(!1),[D,Q]=u.useState(1),[B,ue]=u.useState(20),[Y,_e]=u.useState(""),[he,Te]=u.useState({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),[G,$]=u.useState({}),[z,K]=u.useState(new Set),[De,se]=u.useState(new Map),{toast:Le}=nt(),rs=ha(),{state:J,goToStep:W,registerTour:Ue}=Sx(),{triggerRestart:ae,isRestarting:Ee}=_n(),de=u.useRef(null),Re=u.useRef(!0);u.useEffect(()=>{Ue(hl,Xv)},[Ue]),u.useEffect(()=>{if(J.activeTourId===hl&&J.isRunning){const te=Zv[J.stepIndex];te&&!window.location.pathname.endsWith(te.replace("/config/",""))&&rs({to:te})}},[J.stepIndex,J.activeTourId,J.isRunning,rs]);const ys=u.useRef(J.stepIndex);u.useEffect(()=>{if(J.activeTourId===hl&&J.isRunning){const te=ys.current,ye=J.stepIndex;te>=3&&te<=9&&ye<3&&j(!1),te>=10&&ye>=3&&ye<=9&&($({}),S("custom"),y({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10}),A(null),L(!1),j(!0)),ys.current=ye}},[J.stepIndex,J.activeTourId,J.isRunning]),u.useEffect(()=>{if(J.activeTourId!==hl||!J.isRunning)return;const te=ye=>{const U=ye.target,Me=J.stepIndex;Me===2&&U.closest('[data-tour="add-provider-button"]')?setTimeout(()=>W(3),300):Me===9&&U.closest('[data-tour="provider-cancel-button"]')&&setTimeout(()=>W(10),300)};return document.addEventListener("click",te,!0),()=>document.removeEventListener("click",te,!0)},[J,W]),u.useEffect(()=>{Js()},[]);const Js=async()=>{try{c(!0);const te=await pn();l(te.api_providers||[]),g(!1),Re.current=!1}catch(te){console.error(":",te)}finally{c(!1)}},kt=async()=>{await ae()},pa=async()=>{try{m(!0),de.current&&clearTimeout(de.current);const te=a.map(cs=>({...cs,max_retry:cs.max_retry??2,timeout:cs.timeout??30,retry_interval:cs.retry_interval??10})),{shouldProceed:ye}=await rt(te,"restart");if(!ye){m(!1);return}const U=await pn(),Me=new Set(te.map(cs=>cs.name)),us=(U.models||[]).filter(cs=>Me.has(cs.api_provider));U.api_providers=te,U.models=us,await tc(U),g(!1),Le({title:"",description:"..."}),await kt()}catch(te){console.error(":",te),Le({title:"",description:te.message,variant:"destructive"}),m(!1)}},rt=u.useCallback(async(te,ye="auto")=>{try{const U=await pn(),Me=new Set(a.map(Bs=>Bs.name)),Xe=new Set(te.map(Bs=>Bs.name)),us=Array.from(Me).filter(Bs=>!Xe.has(Bs));if(us.length===0)return{shouldProceed:!0,providers:te};const Ct=(U.models||[]).filter(Bs=>us.includes(Bs.api_provider));return Ct.length===0?{shouldProceed:!0,providers:te}:(Te({isOpen:!0,providersToDelete:us,affectedModels:Ct,pendingProviders:te,context:ye,oldProviders:[...a]}),{shouldProceed:!1,providers:te})}catch(U){return console.error(":",U),{shouldProceed:!0,providers:te}}},[a]),$s=async()=>{try{(he.context==="auto"?f:m)(!0),Te(Bs=>({...Bs,isOpen:!1}));const ye=await pn(),U=he.pendingProviders.map(Do),Me=new Set(U.map(Bs=>Bs.name)),us=(ye.models||[]).filter(Bs=>Me.has(Bs.api_provider)),cs=new Set(he.affectedModels.map(Bs=>Bs.name)),Ct=ye.model_task_config;Ct&&Object.keys(Ct).forEach(Bs=>{const ne=Ct[Bs];ne&&Array.isArray(ne.model_list)&&(ne.model_list=ne.model_list.filter(fe=>!cs.has(fe)))}),ye.api_providers=U,ye.models=us,ye.model_task_config=Ct,await tc(ye),l(he.pendingProviders),g(!1),Le({title:"",description:` ${he.providersToDelete.length}  ${he.affectedModels.length} `}),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),ce(new Set),he.context==="restart"&&await kt()}catch(te){console.error(":",te),Le({title:"",description:te.message,variant:"destructive"})}finally{he.context==="auto"?f(!1):m(!1)}},q=()=>{he.oldProviders.length>0&&l(he.oldProviders),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),g(!1)},He=u.useCallback(async te=>{if(Re.current)return;const{shouldProceed:ye}=await rt(te,"auto");if(!ye){g(!0);return}try{f(!0);const U=te.map(Do);await Xm("api_providers",U),g(!1)}catch(U){console.error(":",U),Le({title:"",description:U.message,variant:"destructive"}),g(!0)}finally{f(!1)}},[a,rt]);u.useEffect(()=>{if(!Re.current)return g(!0),de.current&&clearTimeout(de.current),de.current=setTimeout(()=>{He(a)},2e3),()=>{de.current&&clearTimeout(de.current)}},[a,He]);const Ke=async()=>{try{m(!0),de.current&&clearTimeout(de.current);const te=a.map(Do),{shouldProceed:ye}=await rt(te,"manual");if(!ye){m(!1);return}const U=await pn(),Me=new Set(te.map(cs=>cs.name)),Xe=U.models||[],us=Xe.filter(cs=>{const Ct=Me.has(cs.api_provider);return Ct||console.warn(` "${cs.name}"  "${cs.api_provider}"`),Ct});if(Xe.length!==us.length){const cs=Xe.length-us.length;Le({title:"",description:` ${cs} `,variant:"default"})}console.log(" providers :",te),U.api_providers=te,U.models=us,console.log(":",U),await tc(U),g(!1),Le({title:"",description:""})}catch(te){console.error(":",te),Le({title:"",description:te.message,variant:"destructive"})}finally{m(!1)}},Ze=(te,ye)=>{if($({}),te){const U=Xi.find(Me=>Me.base_url===te.base_url&&Me.client_type===te.client_type);S(U?.id||"custom"),y(te)}else S("custom"),y({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10});A(ye),L(!1),j(!0)},Ts=u.useCallback(te=>{S(te),E(!1);const ye=Xi.find(U=>U.id===te);ye&&ye.id!=="custom"?y(U=>({...U,name:ye.name,base_url:ye.base_url,client_type:ye.client_type})):ye?.id==="custom"&&y(U=>({...U,name:"",base_url:"",client_type:"openai"}))},[]),as=u.useMemo(()=>M!=="custom",[M]),Es=u.useCallback(async()=>{if(b?.api_key)try{await navigator.clipboard.writeText(b.api_key),Le({title:"",description:"API Key "})}catch{Le({title:"",description:"",variant:"destructive"})}},[b?.api_key,Le]),es=()=>{if(!b)return;const{isValid:te,errors:ye}=e4(b,a,w);if(!te){$(ye);return}$({});const U=Do(b);if(w!==null){const Me=[...a];Me[w]=U,l(Me)}else l([...a,U]);j(!1),y(null),A(null)},Is=te=>{if(!te&&b){const ye={...b,max_retry:b.max_retry??2,timeout:b.timeout??30,retry_interval:b.retry_interval??10};y(ye)}j(te)},ds=te=>{O(te),R(!0)},is=async()=>{if(H!==null){const te=a.filter((U,Me)=>Me!==H),{shouldProceed:ye}=await rt(te,"manual");ye&&(l(te),Le({title:"",description:""}))}R(!1),O(null)},ws=te=>{const ye=new Set(je);ye.has(te)?ye.delete(te):ye.add(te),ce(ye)},it=()=>{if(je.size===Ge.length)ce(new Set);else{const te=Ge.map((ye,U)=>a.findIndex(Me=>Me===Ge[U]));ce(new Set(te))}},vt=()=>{if(je.size===0){Le({title:"",description:"",variant:"default"});return}pe(!0)},Ae=async()=>{const te=a.filter((U,Me)=>!je.has(Me)),{shouldProceed:ye}=await rt(te,"manual");ye&&(l(te),ce(new Set),Le({title:"",description:` ${je.size} `})),pe(!1)},Ge=u.useMemo(()=>{if(!me)return a;const te=me.toLowerCase();return a.filter(ye=>ye.name.toLowerCase().includes(te)||ye.base_url.toLowerCase().includes(te)||ye.client_type.toLowerCase().includes(te))},[a,me]),{totalPages:Ls,paginatedProviders:ct}=u.useMemo(()=>{const te=Math.ceil(Ge.length/B),ye=Ge.slice((D-1)*B,D*B);return{totalPages:te,paginatedProviders:ye}},[Ge,D,B]),Ht=u.useCallback(()=>{const te=parseInt(Y);te>=1&&te<=Ls&&(Q(te),_e(""))},[Y,Ls]),da=async te=>{K(ye=>new Set(ye).add(te));try{const ye=await pS(te);se(U=>new Map(U).set(te,ye)),ye.network_ok?ye.api_key_valid===!0?Le({title:"",description:`${te} API Key  (${ye.latency_ms}ms)`}):ye.api_key_valid===!1?Le({title:" Key ",description:`${te}  API Key `,variant:"destructive"}):Le({title:"",description:`${te}  (${ye.latency_ms}ms)`}):Le({title:"",description:ye.error||"",variant:"destructive"})}catch(ye){Le({title:"",description:ye.message,variant:"destructive"})}finally{K(ye=>{const U=new Set(ye);return U.delete(te),U})}},Ia=async()=>{for(const te of a)await da(te.name)},Xt=te=>{const ye=z.has(te),U=De.get(te);return ye?e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[e.jsx(Fs,{className:"h-3 w-3 animate-spin"}),""]}):U?U.network_ok?U.api_key_valid===!0?e.jsxs(ke,{className:"gap-1 bg-green-600 hover:bg-green-700",children:[e.jsx(st,{className:"h-3 w-3"}),""]}):U.api_key_valid===!1?e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(Rt,{className:"h-3 w-3"}),"Key"]}):e.jsxs(ke,{className:"gap-1 bg-blue-600 hover:bg-blue-700",children:[e.jsx(st,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(aa,{className:"h-3 w-3"}),""]}):null};return r?e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"AI"}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" AI  API "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[je.size>0&&e.jsxs(_,{onClick:vt,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(os,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",je.size,")"]}),e.jsxs(_,{onClick:Ia,size:"sm",variant:"outline",className:"w-full sm:w-auto",disabled:a.length===0||z.size>0,children:[e.jsx(el,{className:"mr-2 h-4 w-4"}),z.size>0?` (${z.size})`:""]}),e.jsxs(_,{onClick:()=>Ze(null,null),size:"sm",className:"w-full sm:w-auto","data-tour":"add-provider-button",children:[e.jsx(Xs,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{onClick:Ke,disabled:d||h||!p||Ee,size:"sm",variant:"outline",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),d?"...":h?"...":p?"":""]}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{disabled:d||h||Ee,size:"sm",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Ee?"...":p?"":""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:p?",":","})})})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:p?pa:kt,children:p?"":""})]})]})]})]})]}),e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""}),'""']})]}),e.jsxs(ts,{className:"h-[calc(100vh-260px)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"URL ...",value:me,onChange:te=>Ne(te.target.value),className:"pl-9"})]}),me&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Ge.length," "]})]}),e.jsx("div",{className:"md:hidden space-y-3",children:Ge.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8 rounded-lg border bg-card",children:me?"":'""'}):ct.map((te,ye)=>{const U=a.findIndex(Me=>Me===te);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-base truncate",children:te.name}),Xt(te.name)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 break-all",children:te.base_url})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>da(te.name),disabled:z.has(te.name),title:"",children:z.has(te.name)?e.jsx(Fs,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsx(_,{variant:"default",size:"sm",onClick:()=>Ze(te,U),children:e.jsx(Jn,{className:"h-4 w-4",strokeWidth:2,fill:"none"})}),e.jsx(_,{size:"sm",onClick:()=>ds(U),className:"bg-red-600 hover:bg-red-700 text-white",children:e.jsx(os,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:te.client_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:te.max_retry})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:te.timeout})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:te.retry_interval})]})]})]},ye)})}),e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{className:"w-12",children:e.jsx(tt,{checked:je.size===Ge.length&&Ge.length>0,onCheckedChange:it})}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:"URL"}),e.jsx(ns,{children:""}),e.jsx(ns,{className:"text-right",children:""}),e.jsx(ns,{className:"text-right",children:"()"}),e.jsx(ns,{className:"text-right",children:"()"}),e.jsx(ns,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:ct.length===0?e.jsx(wt,{children:e.jsx(Je,{colSpan:9,className:"text-center text-muted-foreground py-8",children:me?"":'""'})}):ct.map((te,ye)=>{const U=a.findIndex(Me=>Me===te);return e.jsxs(wt,{children:[e.jsx(Je,{children:e.jsx(tt,{checked:je.has(U),onCheckedChange:()=>ws(U)})}),e.jsx(Je,{children:Xt(te.name)||e.jsx(ke,{variant:"outline",className:"text-muted-foreground",children:""})}),e.jsx(Je,{className:"font-medium",children:te.name}),e.jsx(Je,{className:"max-w-xs truncate",title:te.base_url,children:te.base_url}),e.jsx(Je,{children:te.client_type}),e.jsx(Je,{className:"text-right",children:te.max_retry}),e.jsx(Je,{className:"text-right",children:te.timeout}),e.jsx(Je,{className:"text-right",children:te.retry_interval}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>da(te.name),disabled:z.has(te.name),title:"",children:z.has(te.name)?e.jsx(Fs,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>Ze(te,U),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>ds(U),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(os,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},ye)})})]})})}),Ge.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-provider",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:B.toString(),onValueChange:te=>{ue(parseInt(te)),Q(1),ce(new Set)},children:[e.jsx(Be,{id:"page-size-provider",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(D-1)*B+1," "," ",Math.min(D*B,Ge.length),"  ",Ge.length," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Q(1),disabled:D===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Q(te=>Math.max(1,te-1)),disabled:D===1,children:[e.jsx(Pa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:Y,onChange:te=>_e(te.target.value),onKeyDown:te=>te.key==="Enter"&&Ht(),placeholder:D.toString(),className:"w-16 h-8 text-center",min:1,max:Ls}),e.jsx(_,{variant:"outline",size:"sm",onClick:Ht,disabled:!Y,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Q(te=>te+1),disabled:D>=Ls,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ia,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Q(Ls),disabled:D>=Ls,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]}),e.jsx(Qs,{open:N,onOpenChange:Is,children:e.jsxs(Hs,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"provider-dialog",preventOutsideClose:J.isRunning,children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:w!==null?"":""}),e.jsx(at,{children:" API "})]}),e.jsxs("form",{onSubmit:te=>{te.preventDefault(),es()},autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"provider-template-select",children:[e.jsx(T,{htmlFor:"template",children:""}),e.jsxs(rl,{open:I,onOpenChange:E,children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":I,className:"w-full justify-between",children:[M?Xi.find(te=>te.id===M)?.display_name:"...",e.jsx(ox,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(sl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(ts,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:""}),e.jsx(oc,{children:Xi.map(te=>e.jsxs(dc,{value:te.display_name,onSelect:()=>Ts(te.id),children:[e.jsx(Lt,{className:`mr-2 h-4 w-4 ${M===te.id?"opacity-100":"opacity-0"}`}),te.display_name]},te.id))})]})})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" URL ,"})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-name-input",children:[e.jsx(T,{htmlFor:"name",className:G.name?"text-destructive":"",children:" *"}),e.jsx(le,{id:"name",value:b?.name||"",onChange:te=>{y(ye=>ye?{...ye,name:te.target.value}:null),G.name&&$(ye=>({...ye,name:void 0}))},placeholder:": DeepSeek, SiliconFlow",className:G.name?"border-destructive focus-visible:ring-destructive":""}),G.name&&e.jsx("p",{className:"text-xs text-destructive",children:G.name})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-url-input",children:[e.jsx(T,{htmlFor:"base_url",className:G.base_url?"text-destructive":"",children:" URL *"}),e.jsx(le,{id:"base_url",value:b?.base_url||"",onChange:te=>{y(ye=>ye?{...ye,base_url:te.target.value}:null),G.base_url&&$(ye=>({...ye,base_url:void 0}))},placeholder:"https://api.example.com/v1",disabled:as,className:`${as?"bg-muted cursor-not-allowed":""} ${G.base_url?"border-destructive focus-visible:ring-destructive":""}`}),G.base_url&&e.jsx("p",{className:"text-xs text-destructive",children:G.base_url}),as&&!G.base_url&&e.jsx("p",{className:"text-xs text-muted-foreground",children:' URL ,""'})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-apikey-input",children:[e.jsx(T,{htmlFor:"api_key",className:G.api_key?"text-destructive":"",children:"API Key *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{id:"api_key",type:X?"text":"password",value:b?.api_key||"",onChange:te=>{y(ye=>ye?{...ye,api_key:te.target.value}:null),G.api_key&&$(ye=>({...ye,api_key:void 0}))},placeholder:"sk-...",className:`flex-1 ${G.api_key?"border-destructive focus-visible:ring-destructive":""}`}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:()=>L(!X),title:X?"":"",children:X?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(oa,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:Es,title:"",children:e.jsx(Fo,{className:"h-4 w-4"})})]}),G.api_key&&e.jsx("p",{className:"text-xs text-destructive",children:G.api_key})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"client_type",children:""}),e.jsxs(Ie,{value:b?.client_type||"openai",onValueChange:te=>y(ye=>ye?{...ye,client_type:te}:null),disabled:as,children:[e.jsx(Be,{id:"client_type",className:as?"bg-muted cursor-not-allowed":"",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"openai",children:"OpenAI"}),e.jsx(Z,{value:"gemini",children:"Gemini"})]})]}),as&&e.jsx("p",{className:"text-xs text-muted-foreground",children:',""'})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_retry",children:""}),e.jsx(le,{id:"max_retry",type:"number",min:"0",value:b?.max_retry??"",onChange:te=>{const ye=te.target.value===""?null:parseInt(te.target.value);y(U=>U?{...U,max_retry:ye}:null)},placeholder:": 2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"timeout",children:"()"}),e.jsx(le,{id:"timeout",type:"number",min:"1",value:b?.timeout??"",onChange:te=>{const ye=te.target.value===""?null:parseInt(te.target.value);y(U=>U?{...U,timeout:ye}:null)},placeholder:": 30"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"retry_interval",children:"()"}),e.jsx(le,{id:"retry_interval",type:"number",min:"1",value:b?.retry_interval??"",onChange:te=>{const ye=te.target.value===""?null:parseInt(te.target.value);y(U=>U?{...U,retry_interval:ye}:null)},placeholder:": 10"})]})]})]}),e.jsxs(ft,{children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>j(!1),"data-tour":"provider-cancel-button",children:""}),e.jsx(_,{type:"submit","data-tour":"provider-save-button",children:""})]})]})]})}),e.jsx(bs,{open:C,onOpenChange:R,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',H!==null?a[H]?.name:"",'"  ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:is,children:""})]})]})}),e.jsx(bs,{open:ge,onOpenChange:pe,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",je.size,"  "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:Ae,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(bs,{open:he.isOpen,onOpenChange:te=>Te(ye=>({...ye,isOpen:te})),children:e.jsxs(xs,{className:"max-w-2xl",children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:["",e.jsx("strong",{className:"text-foreground ml-1",children:he.providersToDelete.join(", ")})]}),e.jsxs("p",{className:"text-yellow-600 dark:text-yellow-500 font-medium",children:["  ",he.affectedModels.length," "]}),e.jsx(ts,{className:"h-32 w-full rounded border p-3",children:e.jsx("div",{className:"space-y-1",children:he.affectedModels.map((te,ye)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-mono text-muted-foreground",children:""}),e.jsx("span",{className:"ml-2 font-medium",children:te.name}),e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",te.model_identifier,")"]})]},ye))})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})})]}),e.jsxs(fs,{children:[e.jsx(vs,{onClick:q,children:""}),e.jsx(js,{onClick:$s,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(ar,{})]})}function ac(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,11)}`}function Bm(a){return a===null?"null":Array.isArray(a)?"array":typeof a=="object"?"object":typeof a=="boolean"?"boolean":typeof a=="number"?"number":"string"}function Wm(a){return Object.entries(a).map(([l,r])=>{const c=Bm(r),d={id:ac(),key:l,value:r,type:c,expanded:!0};return c==="object"&&r&&typeof r=="object"?d.children=Wm(r):c==="array"&&Array.isArray(r)&&(d.children=r.map((m,h)=>{const f=Bm(m),p={id:ac(),key:String(h),value:m,type:f,expanded:!0};return f==="object"&&m&&typeof m=="object"?p.children=Wm(m):f==="array"&&Array.isArray(m)&&(p.children=m.map((g,N)=>({id:ac(),key:String(N),value:g,type:Bm(g),expanded:!0}))),p})),d})}function ex(a){const l={};for(const r of a)r.key.trim()&&(r.type==="object"&&r.children?l[r.key]=ex(r.children):r.type==="array"&&r.children?l[r.key]=r.children.map(c=>c.type==="object"&&c.children?ex(c.children):c.type==="array"&&c.children?c.children.map(d=>d.value):c.value):r.type==="null"?l[r.key]=null:l[r.key]=r.value);return l}function Gg(a,l){switch(l){case"boolean":return a==="true";case"number":{const r=parseFloat(a);return isNaN(r)?0:r}case"null":return null;default:return a}}function Wv({node:a,level:l,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:m}){const h=a.type==="object"||a.type==="array",f=a.children&&a.children.length>0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 items-center",style:{gridTemplateColumns:h?"32px 1fr 90px 64px":"32px 1fr 1fr 90px 32px",paddingLeft:`${l*20}px`},children:[e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>m(a.id),disabled:!h||!f,children:h&&f?a.expanded?e.jsx($a,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"}):e.jsx("span",{className:"w-4"})}),e.jsx(le,{value:a.key,onChange:p=>r(a.id,"key",p.target.value),placeholder:"key",className:"h-8 text-sm"}),!h&&e.jsx(e.Fragment,{children:a.type==="boolean"?e.jsxs("div",{className:"flex items-center h-8 px-3 border rounded-md bg-background",children:[e.jsx(Ve,{checked:a.value===!0,onCheckedChange:p=>r(a.id,"value",p)}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:a.value?"true":"false"})]}):a.type==="null"?e.jsx("div",{className:"flex items-center h-8 px-3 border rounded-md bg-muted text-sm text-muted-foreground",children:"null"}):e.jsx(le,{type:a.type==="number"?"number":"text",value:a.value,onChange:p=>r(a.id,"value",p.target.value),placeholder:"value",className:"h-8 text-sm",step:a.type==="number"?"any":void 0})}),e.jsxs(Ie,{value:a.type,onValueChange:p=>r(a.id,"type",p),children:[e.jsx(Be,{className:"h-8 text-xs",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"string",children:""}),e.jsx(Z,{value:"number",children:""}),e.jsx(Z,{value:"boolean",children:""}),e.jsx(Z,{value:"null",children:"Null"}),e.jsx(Z,{value:"object",children:""}),e.jsx(Z,{value:"array",children:""})]})]}),e.jsxs("div",{className:"flex gap-1 justify-end",children:[h&&e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>d(a.id),title:"",children:e.jsx(Xs,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>c(a.id),title:"",children:e.jsx(os,{className:"h-4 w-4"})})]})]}),h&&a.expanded&&a.children&&a.children.length>0&&e.jsx("div",{className:"space-y-1",children:a.children.map(p=>e.jsx(Wv,{node:p,level:l+1,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:m},p.id))})]})}function a4({value:a,onChange:l,placeholder:r="..."}){const[c,d]=u.useState(()=>Wm(a||{})),m=u.useCallback(j=>{d(j),l(ex(j))},[l]),h=u.useCallback(()=>{const j={id:ac(),key:"",value:"",type:"string",expanded:!1};m([...c,j])},[c,m]),f=u.useCallback((j,b,y)=>{const w=A=>A.map(M=>{if(M.id===j)if(b==="type"){const S=y;if(S==="object")return{...M,type:S,value:{},children:[]};if(S==="array")return{...M,type:S,value:[],children:[]};if(S==="null")return{...M,type:S,value:null};{const I=Gg(String(M.value),S);return{...M,type:S,value:I,children:void 0}}}else if(b==="value"){const S=Gg(String(y),M.type);return{...M,value:S}}else return{...M,[b]:String(y)};return M.children?{...M,children:w(M.children)}:M});m(w(c))},[c,m]),p=u.useCallback(j=>{const b=y=>y.filter(w=>w.id!==j).map(w=>w.children?{...w,children:b(w.children)}:w);m(b(c))},[c,m]),g=u.useCallback(j=>{const b=y=>y.map(w=>{if(w.id===j){const A={id:ac(),key:w.type==="array"?String(w.children?.length||0):"",value:"",type:"string",expanded:!0};return{...w,children:[...w.children||[],A]}}return w.children?{...w,children:b(w.children)}:w});m(b(c))},[c,m]),N=u.useCallback(j=>{const b=y=>y.map(w=>w.id===j?{...w,expanded:!w.expanded}:w.children?{...w,children:b(w.children)}:w);d(b(c))},[c]);return e.jsxs("div",{className:"h-full flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c.length," "]}),e.jsxs(_,{type:"button",size:"sm",variant:"outline",onClick:h,className:"h-7 text-xs",children:[e.jsx(Xs,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",children:c.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border border-dashed rounded-md",children:r}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 text-xs text-muted-foreground px-1 sticky top-0 bg-background z-10",style:{gridTemplateColumns:"32px 1fr 1fr 90px 32px"},children:[e.jsx("span",{}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{})]}),c.map(j=>e.jsx(Wv,{node:j,level:0,onUpdate:f,onRemove:p,onAddChild:g,onToggleExpand:N},j.id))]})})]})}function Kg(a){if(!a.trim())return{valid:!0,parsed:{}};try{const l=JSON.parse(a);return typeof l!="object"||l===null||Array.isArray(l)?{valid:!1,error:" JSON  {}"}:{valid:!0,parsed:l}}catch{return{valid:!1,error:"JSON "}}}function l4({value:a,onChange:l,className:r,placeholder:c="..."}){const[d,m]=u.useState("list"),h=u.useMemo(()=>Object.keys(a||{}).length>0?JSON.stringify(a,null,2):"",[a]),[f,p]=u.useState(h),[g,N]=u.useState(null);u.useEffect(()=>{p(h)},[h]);const j=u.useMemo(()=>{const w=Kg(f);return w.valid&&w.parsed?{success:!0,data:w.parsed}:{success:!1,data:{}}},[f]),b=u.useCallback(w=>{const A=w;A==="json"&&d==="list"&&(p(Object.keys(a).length>0?JSON.stringify(a,null,2):""),N(null)),m(A)},[d,a]),y=u.useCallback(w=>{p(w);const A=Kg(w);A.valid&&A.parsed?(N(null),l(A.parsed)):N(A.error||"JSON ")},[l]);return e.jsx("div",{className:F("h-full flex flex-col",r),children:e.jsxs(Jt,{value:d,onValueChange:b,className:"w-full flex-1 flex flex-col",children:[e.jsxs(Gt,{className:"h-8 p-0.5 bg-muted/60 w-fit",children:[e.jsx(Ye,{value:"list",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"json",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"JSON "})]}),e.jsx(Cs,{value:"list",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsx(a4,{value:a,onChange:l,placeholder:c})}),e.jsx(Cs,{value:"json",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),g?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-destructive",children:[e.jsx(Rt,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:g})]}):f.trim()&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Lt,{className:"h-3 w-3"}),e.jsx("span",{children:""})]})]}),e.jsx(ht,{value:f,onChange:w=>y(w.target.value),placeholder:`{
  "key": "value"
}`,className:F("font-mono text-sm flex-1 resize-none",g&&"border-destructive focus-visible:ring-destructive")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" JSON "})]}),e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"flex-1 rounded-md border bg-muted/30 p-3 overflow-auto",children:j.success&&Object.keys(j.data).length>0?e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-words",children:JSON.stringify(j.data,null,2)}):j.success?e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:""}):e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-destructive",children:"JSON "})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})})]})})}function n4({open:a,onOpenChange:l,value:r,onChange:c}){const[d,m]=u.useState(r),h=g=>{g&&m(r),l(g)},f=()=>{c(d),l(!1)},p=()=>{m(r),l(!1)};return e.jsx(Qs,{open:a,onOpenChange:h,children:e.jsxs(Hs,{className:"max-w-3xl h-[70vh] flex flex-col",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:e.jsx(l4,{value:d,onChange:m,placeholder:" thinkingtop_p ..."})}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:p,children:""}),e.jsx(_,{onClick:f,children:""})]})]})})}const si="https://maibot-plugin-stats.maibot-webui.workers.dev";async function r4(a){const l=new URLSearchParams;a?.status&&l.set("status",a.status),a?.page&&l.set("page",a.page.toString()),a?.page_size&&l.set("page_size",a.page_size.toString()),a?.search&&l.set("search",a.search),a?.sort_by&&l.set("sort_by",a.sort_by),a?.sort_order&&l.set("sort_order",a.sort_order);const r=await fetch(`${si}/pack?${l.toString()}`);if(!r.ok)throw new Error(` Pack : ${r.status}`);return r.json()}async function i4(a){const l=await fetch(`${si}/pack/${a}`);if(!l.ok)throw new Error(` Pack : ${l.status}`);const r=await l.json();if(!r.success)throw new Error(r.error||" Pack ");return r.pack}async function c4(a){const r=await(await fetch(`${si}/pack`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.error||" Pack ");return r}async function o4(a,l){await fetch(`${si}/pack/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:l})})}async function eN(a,l){const c=await(await fetch(`${si}/pack/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:l})})).json();if(!c.success)throw new Error(c.error||"");return{likes:c.likes,liked:c.liked}}async function sN(a,l){return(await(await fetch(`${si}/pack/like/check?pack_id=${a}&user_id=${l}`)).json()).liked||!1}async function d4(a){const l=await Se("/api/webui/config/model");if(!l.ok)throw new Error("");const r=await l.json(),c=r.config||r;console.log("=== Pack Conflict Detection ==="),console.log("Pack providers:",a.providers),console.log("Local providers:",c.api_providers);const d={existing_providers:[],new_providers:[],conflicting_models:[]},m=c.api_providers||[];for(const f of a.providers){console.log(`
Checking pack provider: ${f.name}`),console.log(`  Pack URL: ${f.base_url}`),console.log(`  Normalized: ${Pm(f.base_url)}`);const p=m.filter(g=>{const N=Pm(g.base_url),j=Pm(f.base_url);return console.log(`  Comparing with local "${g.name}": ${g.base_url}`),console.log(`    Local normalized: ${N}`),console.log(`    Match: ${N===j}`),N===j});p.length>0?(console.log(`   Matched with ${p.length} local provider(s):`,p.map(g=>g.name).join(", ")),d.existing_providers.push({pack_provider:f,local_providers:p.map(g=>({name:g.name,base_url:g.base_url}))})):(console.log("   No match found - will need API key"),d.new_providers.push(f))}const h=c.models||[];console.log(`
=== Model Conflict Detection ===`);for(const f of a.models){const p=h.find(g=>g.name===f.name);p&&(console.log(`Model conflict: ${f.name}`),d.conflicting_models.push({pack_model:f.name,local_model:p.name}))}return console.log(`
=== Detection Summary ===`),console.log(`Existing providers: ${d.existing_providers.length}`),console.log(`New providers: ${d.new_providers.length}`),console.log(`Conflicting models: ${d.conflicting_models.length}`),console.log(`===========================
`),d}async function u4(a,l,r,c){const d=await Se("/api/webui/config/model");if(!d.ok)throw new Error("");const m=await d.json(),h=m.config||m;if(l.apply_providers){const p=l.selected_providers?a.providers.filter(g=>l.selected_providers.includes(g.name)):a.providers;for(const g of p){if(r[g.name])continue;const N=c[g.name];if(!N)throw new Error(` "${g.name}"  API Key`);const j={...g,api_key:N},b=h.api_providers.findIndex(y=>y.name===g.name);b>=0?h.api_providers[b]=j:h.api_providers.push(j)}}if(l.apply_models){const p=l.selected_models?a.models.filter(g=>l.selected_models.includes(g.name)):a.models;for(const g of p){const N=r[g.api_provider]||g.api_provider,j={...g,api_provider:N},b=h.models.findIndex(y=>y.name===g.name);b>=0?h.models[b]=j:h.models.push(j)}}if(l.apply_task_config){const p=l.selected_tasks||Object.keys(a.task_config);for(const g of p){const N=a.task_config[g];if(!N)continue;const j=new Set(l.selected_models||a.models.map(w=>w.name)),b=N.model_list.filter(w=>j.has(w));if(b.length===0)continue;const y={...N,model_list:b};if(l.task_mode==="replace")h.model_task_config[g]=y;else{const w=h.model_task_config[g];if(w){const A=[...new Set([...w.model_list,...b])];h.model_task_config[g]={...w,model_list:A}}else h.model_task_config[g]=y}}}if(!(await Se("/api/webui/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("")}async function m4(a){const l=await Se("/api/webui/config/model");if(!l.ok)throw new Error("");const r=await l.json();if(!r.success||!r.config)throw new Error("");const c=r.config;let d=(c.api_providers||[]).map(g=>({name:g.name,base_url:g.base_url,client_type:g.client_type,max_retry:g.max_retry,timeout:g.timeout,retry_interval:g.retry_interval}));a.selectedProviders&&(d=d.filter(g=>a.selectedProviders.includes(g.name)));let m=c.models||[];a.selectedModels&&(m=m.filter(g=>a.selectedModels.includes(g.name)));const h={},f=c.model_task_config||{},p=a.selectedTasks||Object.keys(f);for(const g of p)f[g]&&(h[g]=f[g]);return{providers:d,models:m,task_config:h}}function Pm(a){try{const l=new URL(a);return`${l.protocol}//${l.host}${l.pathname}`.replace(/\/$/,"").toLowerCase()}catch{return a.toLowerCase().replace(/\/$/,"")}}function tN(){const a="maibot_pack_user_id";let l=localStorage.getItem(a);return l||(l="pack_user_"+Math.random().toString(36).substring(2,15),localStorage.setItem(a,l)),l}const x4={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""},h4=["","","","","","","OpenAI","Claude","Gemini","","",""];function f4({trigger:a}){const[l,r]=u.useState(!1),[c,d]=u.useState(1),[m,h]=u.useState(!1),[f,p]=u.useState(!1),[g,N]=u.useState([]),[j,b]=u.useState([]),[y,w]=u.useState({}),[A,M]=u.useState(new Set),[S,I]=u.useState(new Set),[E,C]=u.useState(new Set),[R,H]=u.useState(""),[O,X]=u.useState(""),[L,me]=u.useState(""),[Ne,je]=u.useState([]);u.useEffect(()=>{l&&c===1&&ce()},[l,c]);const ce=async()=>{h(!0);try{const G=await m4({name:"",description:"",author:""});N(G.providers),b(G.models),w(G.task_config),M(new Set(G.providers.map($=>$.name))),I(new Set(G.models.map($=>$.name))),C(new Set(Object.keys(G.task_config)))}catch(G){console.error(":",G),la({title:"",variant:"destructive"})}finally{h(!1)}},ge=G=>{const $=new Set(A),z=new Set(S),K=new Set(E);$.has(G)?($.delete(G),j.filter(se=>se.api_provider===G).forEach(se=>z.delete(se.name)),Object.entries(y).forEach(([se,Le])=>{Le.model_list&&(Le.model_list.some(J=>z.has(J))||K.delete(se))})):($.add(G),j.filter(se=>se.api_provider===G).forEach(se=>z.add(se.name)),Object.entries(y).forEach(([se,Le])=>{Le.model_list&&Le.model_list.some(J=>{const W=j.find(Ue=>Ue.name===J);return W&&W.api_provider===G})&&K.add(se)})),M($),I(z),C(K)},pe=G=>{const $=new Set(S),z=new Set(E);$.has(G)?($.delete(G),Object.entries(y).forEach(([K,De])=>{De.model_list&&(De.model_list.some(Le=>$.has(Le))||z.delete(K))})):($.add(G),Object.entries(y).forEach(([K,De])=>{De.model_list&&De.model_list.includes(G)&&z.add(K)})),I($),C(z)},D=G=>{const $=new Set(E);$.has(G)?$.delete(G):$.add(G),C($)},Q=G=>{Ne.includes(G)?je(Ne.filter($=>$!==G)):Ne.length<5?je([...Ne,G]):la({title:" 5 ",variant:"destructive"})},B=()=>{A.size===g.length?M(new Set):M(new Set(g.map(G=>G.name)))},ue=()=>{S.size===j.length?I(new Set):I(new Set(j.map(G=>G.name)))},Y=()=>{const G=Object.keys(y);E.size===G.length?C(new Set):C(new Set(G))},_e=async()=>{if(!R.trim()){la({title:"",variant:"destructive"});return}if(!O.trim()){la({title:"",variant:"destructive"});return}if(!L.trim()){la({title:"",variant:"destructive"});return}if(A.size===0&&S.size===0&&E.size===0){la({title:"",variant:"destructive"});return}p(!0);try{const G=g.filter(K=>A.has(K.name)),$=j.filter(K=>S.has(K.name)),z={};for(const[K,De]of Object.entries(y))E.has(K)&&(z[K]=De);await c4({name:R.trim(),description:O.trim(),author:L.trim(),tags:Ne,providers:G,models:$,task_config:z}),la({title:""}),r(!1),he()}catch(G){console.error(":",G),la({title:G instanceof Error?G.message:"",variant:"destructive"})}finally{p(!1)}},he=()=>{d(1),H(""),X(""),me(""),je([]),M(new Set),I(new Set),C(new Set)},Te=2;return e.jsxs(Qs,{open:l,onOpenChange:r,children:[e.jsx(cd,{asChild:!0,children:a||e.jsxs(_,{variant:"outline",children:[e.jsx(ov,{className:"w-4 h-4 mr-2"}),""]})}),e.jsxs(Hs,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(xa,{className:"w-5 h-5"}),""]}),e.jsxs(at,{children:[" ",c," / ",Te,"",c===1&&"",c===2&&""]})]}),e.jsx(ts,{className:"h-[calc(85vh-220px)] pr-4",children:m?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Fs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""})," API Key"]})]}),e.jsxs(Jt,{defaultValue:"providers",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ye,{value:"providers",children:[e.jsx(Bl,{className:"w-4 h-4 mr-2"}),"API ",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[A.size,"/",g.length]})]}),e.jsxs(Ye,{value:"models",children:[e.jsx(Xn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[S.size,"/",j.length]})]}),e.jsxs(Ye,{value:"tasks",children:[e.jsx(Zn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[E.size,"/",Object.keys(y).length]})]})]}),e.jsx(Cs,{value:"providers",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:B,children:A.size===g.length?"":""})}),g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):g.map(G=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(tt,{id:`provider-${G.name}`,checked:A.has(G.name),onCheckedChange:()=>ge(G.name)}),e.jsxs(T,{htmlFor:`provider-${G.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:G.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:G.base_url})]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:G.client_type})]},G.name))]})}),e.jsx(Cs,{value:"models",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:ue,children:S.size===j.length?"":""})}),j.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):j.map(G=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(tt,{id:`model-${G.name}`,checked:S.has(G.name),onCheckedChange:()=>pe(G.name)}),e.jsxs(T,{htmlFor:`model-${G.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:G.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:G.model_identifier})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:G.api_provider})]},G.name))]})}),e.jsx(Cs,{value:"tasks",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:Y,children:E.size===Object.keys(y).length?"":""})}),Object.keys(y).length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):Object.entries(y).map(([G,$])=>e.jsxs("div",{className:"space-y-2 p-2 rounded hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:`task-${G}`,checked:E.has(G),onCheckedChange:()=>D(G)}),e.jsx(T,{htmlFor:`task-${G}`,className:"flex-1 cursor-pointer",children:e.jsx("span",{className:"font-medium",children:x4[G]||G})}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[$.model_list.length," "]})]}),$.model_list&&$.model_list.length>0&&e.jsx("div",{className:"ml-6 flex flex-wrap gap-1",children:$.model_list.map(z=>{const K=j.find(se=>se.name===z),De=S.has(z);return e.jsxs(ke,{variant:De?"default":"outline",className:"text-xs cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>pe(z),children:[z,K&&e.jsxs("span",{className:"ml-1 opacity-70",children:["(",K.api_provider,")"]})]},z)})})]},G))]})})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm p-3 bg-muted rounded-lg",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Bl,{className:"w-4 h-4"}),A.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xn,{className:"w-4 h-4"}),S.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Zn,{className:"w-4 h-4"}),E.size," "]})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-name",children:" *"}),e.jsx(le,{id:"pack-name",placeholder:"",value:R,onChange:G=>H(G.target.value),maxLength:50}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[R.length,"/50"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-description",children:" *"}),e.jsx(ht,{id:"pack-description",placeholder:"...",value:O,onChange:G=>X(G.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[O.length,"/500"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-author",children:" *"}),e.jsx(le,{id:"pack-author",placeholder:" ID",value:L,onChange:G=>me(G.target.value),maxLength:30})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" 5 "}),e.jsx("div",{className:"flex flex-wrap gap-2",children:h4.map(G=>e.jsxs(ke,{variant:Ne.includes(G)?"default":"outline",className:"cursor-pointer transition-colors",onClick:()=>Q(G),children:[Ne.includes(G)&&e.jsx(Lt,{className:"w-3 h-3 mr-1"}),e.jsx(rd,{className:"w-3 h-3 mr-1"}),G]},G))})]})]}),e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:" 1-3 "})]})]})]})}),e.jsxs(ft,{className:"flex justify-between pt-4 border-t",children:[e.jsx("div",{children:c>1&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>{r(!1),he()},disabled:f,children:""}),c<Te?e.jsx(_,{onClick:()=>d(c+1),disabled:m||A.size===0&&S.size===0&&E.size===0,children:""}):e.jsxs(_,{onClick:_e,disabled:f,children:[f&&e.jsx(Fs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})]})}function p4({value:a,label:l,onRemove:r}){const{attributes:c,listeners:d,setNodeRef:m,transform:h,transition:f,isDragging:p}=_v({id:a}),g={transform:Sv.Transform.toString(h),transition:f,opacity:p?.5:1},N=b=>{b.preventDefault(),b.stopPropagation(),r(a)},j=b=>{b.stopPropagation()};return e.jsx("div",{ref:m,style:g,className:F("inline-flex items-center gap-1",p&&"shadow-lg"),children:e.jsxs(ke,{variant:"secondary",className:"cursor-move hover:bg-secondary/80 flex items-center gap-1",children:[e.jsx("div",{...c,...d,className:"cursor-grab active:cursor-grabbing flex items-center",children:e.jsx(iv,{className:"h-3 w-3 text-muted-foreground"})}),e.jsx("span",{children:l}),e.jsx("span",{role:"button",tabIndex:0,className:"ml-1 rounded-sm hover:bg-destructive/20 focus:outline-none focus:ring-1 focus:ring-destructive cursor-pointer",onClick:N,onPointerDown:j,onMouseDown:b=>b.stopPropagation(),onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),N(b))},children:e.jsx(Sa,{className:"h-3 w-3 hover:text-destructive",strokeWidth:2,fill:"none"})})]})})}function g4({options:a,selected:l,onChange:r,placeholder:c="...",emptyText:d="",className:m}){const[h,f]=u.useState(!1),p=pv(Go(vv,{activationConstraint:{distance:8}}),Go(jv,{coordinateGetter:gv})),g=b=>{l.includes(b)?r(l.filter(y=>y!==b)):r([...l,b])},N=b=>{r(l.filter(y=>y!==b))},j=b=>{const{active:y,over:w}=b;if(w&&y.id!==w.id){const A=l.indexOf(y.id),M=l.indexOf(w.id);r(Nv(l,A,M))}};return e.jsxs(rl,{open:h,onOpenChange:f,children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":h,className:F("w-full justify-between min-h-10 h-auto",m),children:[e.jsx(bv,{sensors:p,collisionDetection:yv,onDragEnd:j,children:e.jsx(wv,{items:l,strategy:d_,children:e.jsx("div",{className:"flex gap-1 flex-wrap flex-1",children:l.length===0?e.jsx("span",{className:"text-muted-foreground",children:c}):l.map(b=>{const y=a.find(w=>w.value===b);return e.jsx(p4,{value:b,label:y?.label||b,onRemove:N},b)})})})}),e.jsx(ox,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:2,fill:"none"})]})}),e.jsx(sl,{className:"w-full p-0",align:"start",children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"...",className:"h-9"}),e.jsxs(md,{children:[e.jsx(xd,{children:d}),e.jsx(oc,{children:a.map(b=>{const y=l.includes(b.value);return e.jsxs(dc,{value:b.value,onSelect:()=>g(b.value),children:[e.jsx("div",{className:F("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",y?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Lt,{className:"h-3 w-3",strokeWidth:2,fill:"none"})}),e.jsx("span",{children:b.label})]},b.value)})})]})]})})]})}const Dl=Ps.memo(function({title:l,description:r,taskConfig:c,modelNames:d,onChange:m,hideTemperature:h=!1,hideMaxTokens:f=!1,dataTour:p}){const g=N=>{m("model_list",N)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-base sm:text-lg",children:l}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:r})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":p,children:[e.jsx(T,{children:""}),e.jsx(g4,{options:d.map(N=>({label:N,value:N})),selected:c.model_list||[],onChange:g,placeholder:"...",emptyText:""})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!h&&e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(le,{type:"number",step:"0.1",min:"0",max:"1",value:c.temperature??.3,onChange:N=>{const j=parseFloat(N.target.value);!isNaN(j)&&j>=0&&j<=1&&m("temperature",j)},className:"w-20 h-8 text-sm"})]}),e.jsx(Wa,{value:[c.temperature??.3],onValueChange:N=>m("temperature",N[0]),min:0,max:1,step:.1,className:"w-full"})]}),!f&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" Token"}),e.jsx(le,{type:"number",step:"1",min:"1",value:c.max_tokens??1024,onChange:N=>m("max_tokens",parseInt(N.target.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:" ()"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(le,{type:"number",step:"1",min:"1",value:c.slow_threshold??15,onChange:N=>{const j=parseInt(N.target.value);!isNaN(j)&&j>=1&&m("slow_threshold",j)},placeholder:"15"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:c.selection_strategy??"balance",onValueChange:N=>m("selection_strategy",N),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"balance",children:"balance"}),e.jsx(Z,{value:"random",children:"random"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})}),j4=Ps.memo(function({paginatedModels:l,allModels:r,onEdit:c,onDelete:d,isModelUsed:m,searchQuery:h}){return l.length===0?e.jsx("div",{className:"md:hidden text-center text-muted-foreground py-8 rounded-lg border bg-card",children:h?"":""}):e.jsx("div",{className:"md:hidden space-y-3",children:l.map((f,p)=>{const g=r.findIndex(j=>j===f),N=m(f.name);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:f.name}),e.jsx(ke,{variant:N?"default":"secondary",className:N?"bg-green-600 hover:bg-green-700":"",children:N?"":""})]}),e.jsx("p",{className:"text-xs text-muted-foreground break-all",title:f.model_identifier,children:f.model_identifier})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>c(f,g),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>d(g),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(os,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.api_provider})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.temperature!=null?f.temperature:e.jsx("span",{className:"text-muted-foreground",children:""})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_in,"/M"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_out,"/M"]})]})]})]},p)})})}),v4=Ps.memo(function({paginatedModels:l,allModels:r,filteredModels:c,selectedModels:d,onEdit:m,onDelete:h,onToggleSelection:f,onToggleSelectAll:p,isModelUsed:g,searchQuery:N}){return e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{className:"w-12",children:e.jsx(tt,{checked:d.size===c.length&&c.length>0,onCheckedChange:p})}),e.jsx(ns,{className:"w-24",children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{className:"text-center",children:""}),e.jsx(ns,{className:"text-right",children:""}),e.jsx(ns,{className:"text-right",children:""}),e.jsx(ns,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:l.length===0?e.jsx(wt,{children:e.jsx(Je,{colSpan:9,className:"text-center text-muted-foreground py-8",children:N?"":""})}):l.map((j,b)=>{const y=r.findIndex(A=>A===j),w=g(j.name);return e.jsxs(wt,{children:[e.jsx(Je,{children:e.jsx(tt,{checked:d.has(y),onCheckedChange:()=>f(y)})}),e.jsx(Je,{children:e.jsx(ke,{variant:w?"default":"secondary",className:w?"bg-green-600 hover:bg-green-700":"",children:w?"":""})}),e.jsx(Je,{className:"font-medium",children:j.name}),e.jsx(Je,{className:"max-w-xs truncate",title:j.model_identifier,children:j.model_identifier}),e.jsx(Je,{children:j.api_provider}),e.jsx(Je,{className:"text-center",children:j.temperature!=null?j.temperature:e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(Je,{className:"text-right",children:["",j.price_in,"/M"]}),e.jsxs(Je,{className:"text-right",children:["",j.price_out,"/M"]}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>m(j,y),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>h(y),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(os,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},b)})})]})})})}),N4=300*1e3,Qg=new Map,b4=[10,20,50,100],y4=Ps.memo(function({page:l,pageSize:r,totalItems:c,jumpToPage:d,onPageChange:m,onPageSizeChange:h,onJumpToPageChange:f,onJumpToPage:p,onSelectionClear:g}){const N=Math.ceil(c/r),j=y=>{h(parseInt(y)),m(1),g?.()},b=y=>{y.key==="Enter"&&p()};return c===0?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-model",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:r.toString(),onValueChange:j,children:[e.jsx(Be,{id:"page-size-model",className:"w-20",children:e.jsx(Fe,{})}),e.jsx(Pe,{children:b4.map(y=>e.jsx(Z,{value:y.toString(),children:y},y))})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(l-1)*r+1," "," ",Math.min(l*r,c),"  ",c," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>m(1),disabled:l===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>m(Math.max(1,l-1)),disabled:l===1,children:[e.jsx(Pa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:d,onChange:y=>f(y.target.value),onKeyDown:b,placeholder:l.toString(),className:"w-16 h-8 text-center",min:1,max:N}),e.jsx(_,{variant:"outline",size:"sm",onClick:p,disabled:!d,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>m(l+1),disabled:l>=N,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ia,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>m(N),disabled:l>=N,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})});function w4(a){const{models:l,taskConfig:r,debounceMs:c=2e3,onSavingChange:d,onUnsavedChange:m}=a,h=u.useRef(null),f=u.useRef(null),p=u.useRef(!0),g=u.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current&&(clearTimeout(f.current),f.current=null)},[]),N=u.useCallback(y=>{const w={model_identifier:y.model_identifier,name:y.name,api_provider:y.api_provider,price_in:y.price_in??0,price_out:y.price_out??0,force_stream_mode:y.force_stream_mode??!1,extra_params:y.extra_params??{}};return y.temperature!=null&&(w.temperature=y.temperature),y.max_tokens!=null&&(w.max_tokens=y.max_tokens),w},[]),j=u.useCallback(async y=>{try{d?.(!0);const w=y.map(N);await Xm("models",w),m?.(!1)}catch(w){console.error(":",w),m?.(!0)}finally{d?.(!1)}},[d,m,N]),b=u.useCallback(async y=>{try{d?.(!0),await Xm("model_task_config",y),m?.(!1)}catch(w){console.error(":",w),m?.(!0)}finally{d?.(!1)}},[d,m]);return u.useEffect(()=>{if(!p.current)return m?.(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{j(l)},c),()=>{h.current&&clearTimeout(h.current)}},[l,j,c,m]),u.useEffect(()=>{if(!(p.current||!r))return m?.(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{b(r)},c),()=>{f.current&&clearTimeout(f.current)}},[r,b,c,m]),u.useEffect(()=>()=>{g()},[g]),{clearTimers:g,initialLoadRef:p}}function _4(a={}){const{onCloseEditDialog:l}=a,r=ha(),{registerTour:c,startTour:d,state:m,goToStep:h}=Sx(),f=u.useRef(m.stepIndex);return u.useEffect(()=>{c(hl,Xv)},[c]),u.useEffect(()=>{if(m.activeTourId===hl&&m.isRunning){const g=Zv[m.stepIndex];g&&!window.location.pathname.endsWith(g.replace("/config/",""))&&r({to:g})}},[m.stepIndex,m.activeTourId,m.isRunning,r]),u.useEffect(()=>{if(m.activeTourId===hl&&m.isRunning){const g=f.current,N=m.stepIndex;g>=12&&g<=17&&N<12&&l?.(),f.current=N}},[m.stepIndex,m.activeTourId,m.isRunning,l]),u.useEffect(()=>{if(m.activeTourId!==hl||!m.isRunning)return;const g=N=>{const j=N.target,b=m.stepIndex;b===2&&j.closest('[data-tour="add-provider-button"]')?setTimeout(()=>h(3),300):b===9&&j.closest('[data-tour="provider-cancel-button"]')?setTimeout(()=>h(10),300):b===11&&j.closest('[data-tour="add-model-button"]')?setTimeout(()=>h(12),300):b===17&&j.closest('[data-tour="model-cancel-button"]')?setTimeout(()=>h(18),300):b===18&&j.closest('[data-tour="tasks-tab-trigger"]')&&setTimeout(()=>h(19),300)};return document.addEventListener("click",g,!0),()=>document.removeEventListener("click",g,!0)},[m,h]),{startTour:u.useCallback(()=>{d(hl)},[d]),isRunning:m.isRunning&&m.activeTourId===hl,stepIndex:m.stepIndex}}function S4(a){const{getProviderConfig:l}=a,[r,c]=u.useState([]),[d,m]=u.useState(!1),[h,f]=u.useState(null),[p,g]=u.useState(null),N=u.useCallback(()=>{c([]),f(null),g(null)},[]),j=u.useCallback(async(b,y=!1)=>{const w=l(b);if(!w?.base_url){c([]),g(null),f('""');return}if(!w.api_key){c([]),g(null),f(' API Key""');return}const A=WS(w.base_url);if(g(A),!A?.modelFetcher){c([]),f(null);return}const M=`${b}:${w.base_url}`,S=Qg.get(M);if(!y&&S&&Date.now()-S.timestamp<N4){c(S.models),f(null);return}m(!0),f(null);try{const I=await fS(b,A.modelFetcher.parser,A.modelFetcher.endpoint);c(I),Qg.set(M,{models:I,timestamp:Date.now()})}catch(I){console.error(":",I);const E=I.message||"";E.includes("")||E.includes("")||E.includes("API Key")?f('API Key ""'):E.includes("")?f(" API Key "):E.includes("timeout")||E.includes("")?f(""):E.includes("")?f(""):f(E),c([])}finally{m(!1)}},[l]);return{availableModels:r,fetchingModels:d,modelFetchError:h,matchedTemplate:p,fetchModelsForProvider:j,clearModels:N}}function k4(){return e.jsx(tr,{children:e.jsx(C4,{})})}function C4(){const[a,l]=u.useState([]),[r,c]=u.useState([]),[d,m]=u.useState([]),[h,f]=u.useState([]),[p,g]=u.useState(null),[N,j]=u.useState(!0),[b,y]=u.useState(!1),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[I,E]=u.useState(!1),[C,R]=u.useState(null),[H,O]=u.useState(null),[X,L]=u.useState(!1),[me,Ne]=u.useState(!1),[je,ce]=u.useState(null),[ge,pe]=u.useState(""),[D,Q]=u.useState(new Set),[B,ue]=u.useState(!1),[Y,_e]=u.useState(1),[he,Te]=u.useState(20),[G,$]=u.useState(""),[z,K]=u.useState(!1),[De,se]=u.useState(!1),Le=u.useRef([]),rs=u.useRef(null),[J,W]=u.useState([]),[Ue,ae]=u.useState([]),[Ee,de]=u.useState({}),{toast:Re}=nt(),{triggerRestart:ys,isRestarting:Js}=_n(),{startTour:kt,isRunning:pa}=_4({onCloseEditDialog:()=>E(!1)}),{clearTimers:rt,initialLoadRef:$s}=w4({models:a,taskConfig:p,onSavingChange:A,onUnsavedChange:S}),q=u.useCallback((ne,fe)=>{if(!ne)return;const ss=new Set(fe.map(ua=>ua.name)),_s=[],ms=[],_t=[{key:"utils",label:""},{key:"tool_use",label:""},{key:"replyer",label:""},{key:"planner",label:""},{key:"vlm",label:""},{key:"voice",label:""},{key:"embedding",label:""},{key:"lpmm_entity_extract",label:"LPMM"},{key:"lpmm_rdf_build",label:"LPMM"}];for(const{key:ua,label:Zt}of _t){const ql=ne[ua];if(!ql)continue;if(!ql.model_list||ql.model_list.length===0){ms.push(Zt);continue}const kn=ql.model_list.filter(Cn=>!ss.has(Cn));kn.length>0&&_s.push({taskName:Zt,invalidModels:kn})}W(_s),ae(ms)},[]),He=u.useCallback(async()=>{try{j(!0);const ne=await pn(),fe=ne.models||[];l(fe),f(fe.map(_t=>_t.name));const ss=ne.api_providers||[];c(ss.map(_t=>_t.name)),m(ss);const _s=ne.model_task_config||null;g(_s),q(_s,fe);const ms=_s?.embedding?.model_list||[];Le.current=[...ms],S(!1),$s.current=!1}catch(ne){console.error(":",ne)}finally{j(!1)}},[$s,q]);u.useEffect(()=>{He()},[He]);const Ke=u.useCallback(ne=>d.find(fe=>fe.name===ne),[d]),{availableModels:Ze,fetchingModels:Ts,modelFetchError:as,matchedTemplate:Es,fetchModelsForProvider:es,clearModels:Is}=S4({getProviderConfig:Ke});u.useEffect(()=>{I&&C?.api_provider&&es(C.api_provider)},[I,C?.api_provider,es]);const ds=async()=>{await ys()},is=u.useCallback(()=>{if(!p)return;const ne=new Set(a.map(_s=>_s.name)),fe={...p},ss=Object.keys(fe);for(const _s of ss){const ms=fe[_s];ms&&ms.model_list&&(ms.model_list=ms.model_list.filter(_t=>ne.has(_t)))}g(fe),W([]),Re({title:"",description:""})},[p,a,Re]),ws=ne=>{const fe={model_identifier:ne.model_identifier,name:ne.name,api_provider:ne.api_provider,price_in:ne.price_in??0,price_out:ne.price_out??0,force_stream_mode:ne.force_stream_mode??!1,extra_params:ne.extra_params??{}};return ne.temperature!=null&&(fe.temperature=ne.temperature),ne.max_tokens!=null&&(fe.max_tokens=ne.max_tokens),fe},it=async()=>{try{y(!0),rt();const ne=await pn();ne.models=a.map(ws),ne.model_task_config=p,await tc(ne),S(!1),Re({title:"",description:"..."}),await ds()}catch(ne){console.error(":",ne),Re({title:"",description:ne.message,variant:"destructive"}),y(!1)}},vt=async()=>{try{y(!0),rt();const ne=await pn();ne.models=a.map(ws),ne.model_task_config=p,await tc(ne),S(!1),Re({title:"",description:""}),await He()}catch(ne){console.error(":",ne),Re({title:"",description:ne.message,variant:"destructive"})}finally{y(!1)}},Ae=(ne,fe)=>{de({}),R(ne||{model_identifier:"",name:"",api_provider:r[0]||"",price_in:0,price_out:0,temperature:null,max_tokens:null,force_stream_mode:!1,extra_params:{}}),O(fe),E(!0)},Ge=()=>{if(!C)return;const ne={};if(C.name?.trim()?a.some((_t,ua)=>H!==null&&ua===H?!1:_t.name.trim().toLowerCase()===C.name.trim().toLowerCase())&&(ne.name=""):ne.name="",C.api_provider?.trim()||(ne.api_provider=" API "),C.model_identifier?.trim()||(ne.model_identifier=""),Object.keys(ne).length>0){de(ne);return}de({});const fe={model_identifier:C.model_identifier,name:C.name,api_provider:C.api_provider,price_in:C.price_in??0,price_out:C.price_out??0,force_stream_mode:C.force_stream_mode??!1,extra_params:C.extra_params??{}};C.temperature!=null&&(fe.temperature=C.temperature),C.max_tokens!=null&&(fe.max_tokens=C.max_tokens);let ss,_s=null;if(H!==null?(_s=a[H].name,ss=[...a],ss[H]=fe):ss=[...a,fe],l(ss),f(ss.map(ms=>ms.name)),_s&&_s!==fe.name&&p){const ms=_t=>_t.map(ua=>ua===_s?fe.name:ua);g({...p,utils:{...p.utils,model_list:ms(p.utils?.model_list||[])},tool_use:{...p.tool_use,model_list:ms(p.tool_use?.model_list||[])},replyer:{...p.replyer,model_list:ms(p.replyer?.model_list||[])},planner:{...p.planner,model_list:ms(p.planner?.model_list||[])},vlm:{...p.vlm,model_list:ms(p.vlm?.model_list||[])},voice:{...p.voice,model_list:ms(p.voice?.model_list||[])},embedding:{...p.embedding,model_list:ms(p.embedding?.model_list||[])},lpmm_entity_extract:{...p.lpmm_entity_extract,model_list:ms(p.lpmm_entity_extract?.model_list||[])},lpmm_rdf_build:{...p.lpmm_rdf_build,model_list:ms(p.lpmm_rdf_build?.model_list||[])}})}E(!1),R(null),O(null),Re({title:H!==null?"":"",description:' 2 ""'})},Ls=ne=>{if(!ne&&C){const fe={...C,price_in:C.price_in??0,price_out:C.price_out??0};R(fe)}E(ne)},ct=ne=>{ce(ne),Ne(!0)},Ht=()=>{if(je!==null){const ne=a.filter((fe,ss)=>ss!==je);l(ne),f(ne.map(fe=>fe.name)),q(p,ne),Re({title:"",description:' 2 ""'})}Ne(!1),ce(null)},da=ne=>{const fe=new Set(D);fe.has(ne)?fe.delete(ne):fe.add(ne),Q(fe)},Ia=()=>{if(D.size===Xe.length)Q(new Set);else{const ne=Xe.map((fe,ss)=>a.findIndex(_s=>_s===Xe[ss]));Q(new Set(ne))}},Xt=()=>{if(D.size===0){Re({title:"",description:"",variant:"default"});return}ue(!0)},te=()=>{const ne=D.size,fe=a.filter((ss,_s)=>!D.has(_s));l(fe),f(fe.map(ss=>ss.name)),q(p,fe),Q(new Set),ue(!1),Re({title:"",description:` ${ne}  2 `})},ye=(ne,fe,ss)=>{if(!p)return;if(ne==="embedding"&&fe==="model_list"&&Array.isArray(ss)){const ms=Le.current,_t=ss;if((ms.length!==_t.length||ms.some(Zt=>!_t.includes(Zt))||_t.some(Zt=>!ms.includes(Zt)))&&ms.length>0){rs.current={field:fe,value:ss},se(!0);return}}const _s={...p,[ne]:{...p[ne],[fe]:ss}};g(_s),q(_s,a),ne==="embedding"&&fe==="model_list"&&Array.isArray(ss)&&(Le.current=[...ss])},U=()=>{if(!p||!rs.current)return;const{field:ne,value:fe}=rs.current,ss={...p,embedding:{...p.embedding,[ne]:fe}};g(ss),q(ss,a),ne==="model_list"&&Array.isArray(fe)&&(Le.current=[...fe]),rs.current=null,se(!1),Re({title:"",description:""})},Me=()=>{rs.current=null,se(!1)},Xe=a.filter(ne=>{if(!ge)return!0;const fe=ge.toLowerCase();return ne.name.toLowerCase().includes(fe)||ne.model_identifier.toLowerCase().includes(fe)||ne.api_provider.toLowerCase().includes(fe)}),us=Math.ceil(Xe.length/he),cs=Xe.slice((Y-1)*he,Y*he),Ct=()=>{const ne=parseInt(G);ne>=1&&ne<=us&&(_e(ne),$(""))},Bs=ne=>p?[p.utils?.model_list||[],p.tool_use?.model_list||[],p.replyer?.model_list||[],p.planner?.model_list||[],p.vlm?.model_list||[],p.voice?.model_list||[],p.embedding?.model_list||[],p.lpmm_entity_extract?.model_list||[],p.lpmm_rdf_build?.model_list||[]].some(ss=>ss.includes(ne)):!1;return N?e.jsx(ts,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(f4,{trigger:e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(ov,{className:"mr-2 h-4 w-4"}),""]})}),e.jsxs(_,{onClick:vt,disabled:b||w||!M||Js,size:"sm",variant:"outline",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),b?"...":w?"...":M?"":""]}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsxs(_,{disabled:b||w||Js,size:"sm",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Js?"...":M?"":""]})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsx(gs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:M?",":","})})})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:M?it:ds,children:M?"":""})]})]})]})]})]}),e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""}),'""']})]}),J.length>0&&e.jsxs(pt,{variant:"destructive",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(gt,{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:J.map(({taskName:ne,invalidModels:fe})=>e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:ne})," : ",fe.join(", ")]},ne))})]}),e.jsx(_,{variant:"outline",size:"sm",className:"shrink-0 bg-background hover:bg-accent",onClick:is,children:""})]})]}),Ue.length>0&&e.jsxs(pt,{variant:"default",className:"border-yellow-500/50 bg-yellow-500/10",children:[e.jsx(Ft,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(gt,{children:[e.jsx("strong",{className:"text-yellow-600",children:""}),e.jsxs("div",{className:"mt-2 text-sm",children:[Ue.join("")," "]})]})]}),e.jsxs(pt,{className:"hidden lg:flex border-primary/30 bg-primary/5 cursor-pointer hover:bg-primary/10 transition-colors",onClick:kt,children:[e.jsx(z1,{className:"h-4 w-4 text-primary"}),e.jsxs(gt,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[e.jsx("strong",{className:"text-primary",children:""}),""]}),e.jsx(_,{variant:"outline",size:"sm",className:"ml-4 shrink-0",children:""})]})]}),e.jsxs(Jt,{defaultValue:"models",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full max-w-full sm:max-w-md grid-cols-2",children:[e.jsx(Ye,{value:"models",children:""}),e.jsx(Ye,{value:"tasks","data-tour":"tasks-tab-trigger",children:""})]}),e.jsxs(Cs,{value:"models",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[D.size>0&&e.jsxs(_,{onClick:Xt,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(os,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",D.size,")"]}),e.jsxs(_,{onClick:()=>Ae(null,null),size:"sm",variant:"outline",className:"w-full sm:w-auto","data-tour":"add-model-button",children:[e.jsx(Xs,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:ge,onChange:ne=>pe(ne.target.value),className:"pl-9"})]}),ge&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Xe.length," "]})]}),e.jsx(j4,{paginatedModels:cs,allModels:a,onEdit:Ae,onDelete:ct,isModelUsed:Bs,searchQuery:ge}),e.jsx(v4,{paginatedModels:cs,allModels:a,filteredModels:Xe,selectedModels:D,onEdit:Ae,onDelete:ct,onToggleSelection:da,onToggleSelectAll:Ia,isModelUsed:Bs,searchQuery:ge}),e.jsx(y4,{page:Y,pageSize:he,totalItems:Xe.length,jumpToPage:G,onPageChange:_e,onPageSizeChange:Te,onJumpToPageChange:$,onJumpToPage:Ct,onSelectionClear:()=>Q(new Set)})]}),e.jsxs(Cs,{value:"tasks",className:"space-y-6 mt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),p&&e.jsxs("div",{className:"grid gap-4 sm:gap-6",children:[e.jsx(Dl,{title:" (utils)",description:"",taskConfig:p.utils,modelNames:h,onChange:(ne,fe)=>ye("utils",ne,fe),dataTour:"task-model-select"}),e.jsx(Dl,{title:" (tool_use)",description:"",taskConfig:p.tool_use,modelNames:h,onChange:(ne,fe)=>ye("tool_use",ne,fe)}),e.jsx(Dl,{title:" (replyer)",description:"",taskConfig:p.replyer,modelNames:h,onChange:(ne,fe)=>ye("replyer",ne,fe)}),e.jsx(Dl,{title:" (planner)",description:"",taskConfig:p.planner,modelNames:h,onChange:(ne,fe)=>ye("planner",ne,fe)}),e.jsx(Dl,{title:" (vlm)",description:"",taskConfig:p.vlm,modelNames:h,onChange:(ne,fe)=>ye("vlm",ne,fe),hideTemperature:!0}),e.jsx(Dl,{title:" (voice)",description:"",taskConfig:p.voice,modelNames:h,onChange:(ne,fe)=>ye("voice",ne,fe),hideTemperature:!0,hideMaxTokens:!0}),e.jsx(Dl,{title:" (embedding)",description:"",taskConfig:p.embedding,modelNames:h,onChange:(ne,fe)=>ye("embedding",ne,fe),hideTemperature:!0,hideMaxTokens:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsx(Dl,{title:" (lpmm_entity_extract)",description:"",taskConfig:p.lpmm_entity_extract,modelNames:h,onChange:(ne,fe)=>ye("lpmm_entity_extract",ne,fe)}),e.jsx(Dl,{title:"RDF  (lpmm_rdf_build)",description:"",taskConfig:p.lpmm_rdf_build,modelNames:h,onChange:(ne,fe)=>ye("lpmm_rdf_build",ne,fe)})]})]})]})]}),e.jsx(Qs,{open:I,onOpenChange:Ls,children:e.jsxs(Hs,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"model-dialog",preventOutsideClose:pa,children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:H!==null?"":""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"model-name-input",children:[e.jsx(T,{htmlFor:"model_name",className:Ee.name?"text-destructive":"",children:" *"}),e.jsx(le,{id:"model_name",value:C?.name||"",onChange:ne=>{R(fe=>fe?{...fe,name:ne.target.value}:null),Ee.name&&de(fe=>({...fe,name:void 0}))},placeholder:": qwen3-30b",className:Ee.name?"border-destructive focus-visible:ring-destructive":""}),Ee.name?e.jsx("p",{className:"text-xs text-destructive",children:Ee.name}):e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-provider-select",children:[e.jsx(T,{htmlFor:"api_provider",className:Ee.api_provider?"text-destructive":"",children:"API  *"}),e.jsxs(Ie,{value:C?.api_provider||"",onValueChange:ne=>{R(fe=>fe?{...fe,api_provider:ne}:null),Is(),Ee.api_provider&&de(fe=>({...fe,api_provider:void 0}))},children:[e.jsx(Be,{id:"api_provider",className:Ee.api_provider?"border-destructive focus-visible:ring-destructive":"",children:e.jsx(Fe,{placeholder:""})}),e.jsx(Pe,{children:r.map(ne=>e.jsx(Z,{value:ne,children:ne},ne))})]}),Ee.api_provider&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.api_provider})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-identifier-input",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"model_identifier",className:Ee.model_identifier?"text-destructive":"",children:" *"}),Es?.modelFetcher&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{variant:"secondary",className:"text-xs",children:Es.display_name}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>C?.api_provider&&es(C.api_provider,!0),disabled:Ts,children:Ts?e.jsx(Fs,{className:"h-3 w-3 animate-spin"}):e.jsx(mt,{className:"h-3 w-3"})})]})]}),Es?.modelFetcher?e.jsxs(rl,{open:z,onOpenChange:K,children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":z,className:"w-full justify-between font-normal",disabled:Ts||!!as,children:[Ts?e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Fs,{className:"h-4 w-4 animate-spin"}),"..."]}):as?e.jsx("span",{className:"text-muted-foreground text-sm",children:""}):C?.model_identifier?e.jsx("span",{className:"truncate",children:C.model_identifier}):e.jsx("span",{className:"text-muted-foreground",children:"..."}),e.jsx(ox,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(sl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(ts,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:as?e.jsxs("div",{className:"py-4 px-2 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:as}),!as.includes("API Key")&&e.jsx(_,{variant:"link",size:"sm",onClick:()=>C?.api_provider&&es(C.api_provider,!0),children:""})]}):""}),e.jsx(oc,{heading:"",children:Ze.map(ne=>e.jsxs(dc,{value:ne.id,onSelect:()=>{R(fe=>fe?{...fe,model_identifier:ne.id}:null),K(!1)},children:[e.jsx(Lt,{className:`mr-2 h-4 w-4 ${C?.model_identifier===ne.id?"opacity-100":"opacity-0"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:ne.id}),ne.name!==ne.id&&e.jsx("span",{className:"text-xs text-muted-foreground",children:ne.name})]})]},ne.id))}),e.jsx(oc,{heading:"",children:e.jsxs(dc,{value:"__manual_input__",onSelect:()=>{K(!1)},children:[e.jsx(Jn,{className:"mr-2 h-4 w-4"}),"..."]})})]})})]})})]}):e.jsx(le,{id:"model_identifier",value:C?.model_identifier||"",onChange:ne=>{R(fe=>fe?{...fe,model_identifier:ne.target.value}:null),Ee.model_identifier&&de(fe=>({...fe,model_identifier:void 0}))},placeholder:"Qwen/Qwen3-30B-A3B-Instruct-2507",className:Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}),Ee.model_identifier&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.model_identifier}),as&&Es?.modelFetcher&&!Ee.model_identifier&&e.jsxs(pt,{variant:"destructive",className:"mt-2 py-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(gt,{className:"text-xs",children:as})]}),Es?.modelFetcher&&e.jsx(le,{value:C?.model_identifier||"",onChange:ne=>{R(fe=>fe?{...fe,model_identifier:ne.target.value}:null),Ee.model_identifier&&de(fe=>({...fe,model_identifier:void 0}))},placeholder:"",className:`mt-2 ${Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}`}),!Ee.model_identifier&&e.jsx("p",{className:"text-xs text-muted-foreground",children:as?'"" API Key':Es?.modelFetcher?` ${Es.display_name}`:"API  ID"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_in",children:" (/M token)"}),e.jsx(le,{id:"price_in",type:"number",step:"0.1",min:"0",value:C?.price_in??"",onChange:ne=>{const fe=ne.target.value===""?null:parseFloat(ne.target.value);R(ss=>ss?{...ss,price_in:fe}:null)},placeholder:": 0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_out",children:" (/M token)"}),e.jsx(le,{id:"price_out",type:"number",step:"0.1",min:"0",value:C?.price_out??"",onChange:ne=>{const fe=ne.target.value===""?null:parseFloat(ne.target.value);R(ss=>ss?{...ss,price_out:fe}:null)},placeholder:": 0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_temperature",className:"cursor-pointer",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"enable_model_temperature",checked:C?.temperature!=null,onCheckedChange:ne=>{R(ne?fe=>fe?{...fe,temperature:.5}:null:fe=>fe?{...fe,temperature:null}:null)}})]}),C?.temperature!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:""}),e.jsx("span",{className:"text-sm font-medium tabular-nums",children:C.temperature.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"0"}),e.jsx(Wa,{value:[C.temperature],onValueChange:ne=>R(fe=>fe?{...fe,temperature:ne[0]}:null),min:0,max:1,step:.1,className:"flex-1"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.1-0.30.7-1.0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_max_tokens",className:"cursor-pointer",children:" Token"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Token "})]}),e.jsx(Ve,{id:"enable_model_max_tokens",checked:C?.max_tokens!=null,onCheckedChange:ne=>{R(ne?fe=>fe?{...fe,max_tokens:2048}:null:fe=>fe?{...fe,max_tokens:null}:null)}})]}),C?.max_tokens!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:" Token "}),e.jsx(le,{type:"number",min:"1",max:"128000",value:C.max_tokens,onChange:ne=>{const fe=parseInt(ne.target.value);!isNaN(fe)&&fe>=1&&R(ss=>ss?{...ss,max_tokens:fe}:null)},className:"w-28 h-8 text-sm"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" token "})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"force_stream_mode",checked:C?.force_stream_mode||!1,onCheckedChange:ne=>R(fe=>fe?{...fe,force_stream_mode:ne}:null)}),e.jsx(T,{htmlFor:"force_stream_mode",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(_,{type:"button",variant:"outline",size:"sm",className:"flex-1 justify-start h-9",onClick:()=>L(!0),children:[e.jsx(bn,{className:"h-4 w-4 mr-2"}),Object.keys(C?.extra_params||{}).length>0?e.jsxs("span",{children:[" ",Object.keys(C?.extra_params||{}).length," "]}):e.jsx("span",{className:"text-muted-foreground",children:""})]})}),Object.keys(C?.extra_params||{}).length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:[Object.keys(C?.extra_params||{}).slice(0,3).map(ne=>e.jsx("span",{className:"inline-block mr-2",children:e.jsx("code",{className:"px-1.5 py-0.5 bg-muted rounded",children:ne})},ne)),Object.keys(C?.extra_params||{}).length>3&&e.jsx("span",{children:"..."})]})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>E(!1),"data-tour":"model-cancel-button",children:""}),e.jsx(_,{onClick:Ge,"data-tour":"model-save-button",children:""})]})]})}),e.jsx(bs,{open:me,onOpenChange:Ne,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',je!==null?a[je]?.name:"",'"  ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:Ht,children:""})]})]})}),e.jsx(bs,{open:B,onOpenChange:ue,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",D.size,"  "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:te,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(bs,{open:De,onOpenChange:se,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsxs(ps,{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-amber-500"}),""]}),e.jsx(gs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-foreground",children:""}),""]}),e.jsxs("ul",{className:"space-y-2 ml-4 list-disc text-muted-foreground",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"text-foreground font-medium",children:""})]})})]}),e.jsxs(fs,{children:[e.jsx(vs,{onClick:Me,children:""}),e.jsx(js,{onClick:U,className:"bg-amber-600 hover:bg-amber-700",children:""})]})]})}),e.jsx(n4,{open:X,onOpenChange:L,value:C?.extra_params||{},onChange:ne=>R(fe=>fe?{...fe,extra_params:ne}:null)}),e.jsx(ar,{})]})})}const uc=kj,mc=kw,xc=Cw,hd="/api/webui/config";async function T4(){const l=await(await Se(`${hd}/adapter-config/path`)).json();return!l.success||!l.path?null:{path:l.path,lastModified:l.lastModified}}async function Yg(a){const r=await(await Se(`${hd}/adapter-config/path`,{method:"POST",headers:Zs(),body:JSON.stringify({path:a})})).json();if(!r.success)throw new Error(r.message||"")}async function Jg(a){const r=await(await Se(`${hd}/adapter-config?path=${encodeURIComponent(a)}`)).json();if(!r.success)throw new Error("");return r.content}async function Xg(a,l){const c=await(await Se(`${hd}/adapter-config`,{method:"POST",headers:Zs(),body:JSON.stringify({path:a,content:l})})).json();if(!c.success)throw new Error(c.message||"")}const At={inner:{version:"0.1.2"},nickname:{nickname:""},napcat_server:{host:"localhost",port:8095,token:"",heartbeat_interval:30},maibot_server:{host:"localhost",port:8e3},chat:{group_list_type:"whitelist",group_list:[],private_list_type:"whitelist",private_list:[],ban_user_id:[],ban_qq_bot:!1,enable_poke:!0},voice:{use_tts:!1},debug:{level:"INFO"}},Im={oneclick:{name:"",description:"",path:"../MaiBot-Napcat-Adapter/config.toml",icon:xa},docker:{name:"Docker",description:"Docker Compose ",path:"/MaiMBot/adapters-config/config.toml",icon:R1}};function Fm(a){try{const l=bx(a);return{inner:{...At.inner,...l.inner},nickname:{...At.nickname,...l.nickname},napcat_server:{...At.napcat_server,...l.napcat_server},maibot_server:{...At.maibot_server,...l.maibot_server},chat:{...At.chat,...l.chat},voice:{...At.voice,...l.voice},debug:{...At.debug,...l.debug}}}catch(l){throw console.error("TOML :",l),new Error(` TOML : ${l instanceof Error?l.message:""}`)}}function Hm(a){try{const l=(d,m)=>d===""||d===null||d===void 0?m:d,r={inner:{version:l(a.inner.version,At.inner.version)},nickname:{nickname:l(a.nickname.nickname,At.nickname.nickname)},napcat_server:{host:l(a.napcat_server.host,At.napcat_server.host),port:l(a.napcat_server.port||0,At.napcat_server.port),token:l(a.napcat_server.token,At.napcat_server.token),heartbeat_interval:l(a.napcat_server.heartbeat_interval||0,At.napcat_server.heartbeat_interval)},maibot_server:{host:l(a.maibot_server.host,At.maibot_server.host),port:l(a.maibot_server.port||0,At.maibot_server.port)},chat:{group_list_type:l(a.chat.group_list_type,At.chat.group_list_type),group_list:a.chat.group_list||[],private_list_type:l(a.chat.private_list_type,At.chat.private_list_type),private_list:a.chat.private_list||[],ban_user_id:a.chat.ban_user_id||[],ban_qq_bot:a.chat.ban_qq_bot??At.chat.ban_qq_bot,enable_poke:a.chat.enable_poke??At.chat.enable_poke},voice:{use_tts:a.voice.use_tts??At.voice.use_tts},debug:{level:l(a.debug.level,At.debug.level)}};let c=PS(r);return c=E4(c),c}catch(l){throw console.error("TOML :",l),new Error(` TOML : ${l instanceof Error?l.message:""}`)}}function E4(a){const l=a.split(`
`),r=[];for(let c=0;c<l.length;c++){const d=l[c];if(d==="[inner]"){r.push(d);continue}if(d.startsWith("version = ")){r.push(`${d} # `),r.push("# ");continue}if(d==="[nickname]"){r.push("[nickname] # ");continue}if(d==="[napcat_server]"){r.push("[napcat_server] # Napcatws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[napcat_server]")){r.push(`${d}      # Napcat`);continue}if(d.startsWith("port = ")&&l[c-1]?.includes("host")){r.push(`${d}             # Napcat`);continue}if(d.startsWith("token = ")){r.push(`${d}              # Napcat`);continue}if(d.startsWith("heartbeat_interval = ")){r.push(`${d} # Napcat`);continue}if(d==="[maibot_server]"){r.push("[maibot_server] # ws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[maibot_server]")){r.push(`${d} # .envHOST`);continue}if(d.startsWith("port = ")&&r[r.length-1]?.includes(".env")){r.push(`${d}        # .envPORT`);continue}if(d==="[chat]"){r.push("[chat] # ");continue}if(d.startsWith("group_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("group_list = ")){r.push(`${d}               # `),r.push("# group_list_typewhitelist"),r.push("# group_list_typeblacklist");continue}if(d.startsWith("private_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("private_list = ")){r.push(`${d}               # `),r.push("# private_list_typewhitelist"),r.push("# private_list_typeblacklist");continue}if(d.startsWith("ban_user_id = ")){r.push(`${d}   # `);continue}if(d.startsWith("ban_qq_bot = ")){r.push(`${d} # QQ`);continue}if(d.startsWith("enable_poke = ")){r.push(`${d} # `);continue}if(d==="[voice]"){r.push("[voice] # ");continue}if(d.startsWith("use_tts = ")){r.push(`${d} # ttsttsadapter`);continue}if(d.startsWith("level = ")&&r[r.length-1]==="[debug]"){r.push(`${d} # DEBUG, INFO, WARNING, ERROR, CRITICAL`);continue}r.push(d)}return r.join(`
`)}function qm(a){if(!a.trim())return{valid:!1,error:""};if(!a.toLowerCase().endsWith(".toml"))return{valid:!1,error:" .toml "};const l=/^([a-zA-Z]:\\|\\\\[^\\]+\\[^\\]+\\).+\.toml$/i,r=/^(\/|~\/).+\.toml$/i,c=/^(\.{1,2}[\\/]|[^:\\/]).+\.toml$/i,d=l.test(a),m=r.test(a),h=c.test(a);return!d&&!m&&!h?{valid:!1,error:""}:/[<>"|?*\x00-\x1F]/.test(a)?{valid:!1,error:""}:{valid:!0,error:""}}function M4(){const[a,l]=u.useState("upload"),[r,c]=u.useState(null),[d,m]=u.useState(""),[h,f]=u.useState(""),[p,g]=u.useState("oneclick"),[N,j]=u.useState(""),[b,y]=u.useState(!1),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[I,E]=u.useState(!1),[C,R]=u.useState(null),[H,O]=u.useState(!1),X=u.useRef(null),{toast:L}=nt(),me=u.useRef(null),Ne=z=>{if(f(z),z.trim()){const K=qm(z);j(K.error)}else j("")},je=u.useCallback(async z=>{const K=Im[z];A(!0);try{const De=await Jg(K.path),se=Fm(De);c(se),g(z),f(K.path),await Yg(K.path),L({title:"",description:`${K.name}`})}catch(De){console.error(":",De),L({title:"",description:De instanceof Error?De.message:"",variant:"destructive"})}finally{A(!1)}},[L]),ce=u.useCallback(async z=>{const K=qm(z);if(!K.valid){j(K.error),L({title:"",description:K.error,variant:"destructive"});return}j(""),A(!0);try{const De=await Jg(z),se=Fm(De);c(se),f(z),await Yg(z),L({title:"",description:""})}catch(De){console.error(":",De),L({title:"",description:De instanceof Error?De.message:"",variant:"destructive"})}finally{A(!1)}},[L]);u.useEffect(()=>{(async()=>{try{const K=await T4();if(K&&K.path){f(K.path);const De=Object.entries(Im).find(([,se])=>se.path===K.path);De?(l("preset"),g(De[0]),await je(De[0])):(l("path"),await ce(K.path))}}catch(K){console.error(":",K)}})()},[ce,je]);const ge=u.useCallback(z=>{a!=="path"&&a!=="preset"||!h||(me.current&&clearTimeout(me.current),me.current=setTimeout(async()=>{y(!0);try{const K=Hm(z);await Xg(h,K),L({title:"",description:""})}catch(K){console.error(":",K),L({title:"",description:K instanceof Error?K.message:"",variant:"destructive"})}finally{y(!1)}},1e3))},[a,h,L]),pe=async()=>{if(!r||!h)return;const z=qm(h);if(!z.valid){L({title:"",description:z.error,variant:"destructive"});return}y(!0);try{const K=Hm(r);await Xg(h,K),L({title:"",description:""})}catch(K){console.error(":",K),L({title:"",description:K instanceof Error?K.message:"",variant:"destructive"})}finally{y(!1)}},D=async()=>{h&&await ce(h)},Q=z=>{if(z!==a){if(r){R(z),S(!0);return}B(z)}},B=z=>{c(null),m(""),j(""),l(z),z==="preset"&&je("oneclick"),L({title:"",description:{upload:"",path:"",preset:""}[z]})},ue=()=>{C&&(B(C),R(null)),S(!1)},Y=()=>{if(r){E(!0);return}_e()},_e=()=>{f(""),c(null),j(""),L({title:"",description:""})},he=()=>{_e(),E(!1)},Te=z=>{const K=z.target.files?.[0];if(!K)return;const De=new FileReader;De.onload=se=>{try{const Le=se.target?.result,rs=Fm(Le);c(rs),m(K.name),L({title:"",description:`${K.name}`})}catch(Le){console.error(":",Le),L({title:"",description:"",variant:"destructive"})}},De.readAsText(K)},G=()=>{if(!r)return;const z=Hm(r),K=new Blob([z],{type:"text/plain;charset=utf-8"}),De=URL.createObjectURL(K),se=document.createElement("a");se.href=De,se.download=d||"config.toml",document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(De),L({title:"",description:""})},$=()=>{c(JSON.parse(JSON.stringify(At))),m("config.toml"),L({title:"",description:""})};return e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" QQ "})]})}),e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg border border-amber-500/50 bg-amber-500/10 text-amber-700 dark:text-amber-400",children:[e.jsx(Rt,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:" WebUI "})]}),e.jsx(uc,{open:H,onOpenChange:O,children:e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx($a,{className:`h-4 w-4 transition-transform duration-200 ${H?"transform rotate-180":""}`}),e.jsx("span",{className:"sr-only",children:""})]})})]})}),e.jsx(xc,{children:e.jsxs(ze,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="preset"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("preset"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(xa,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="upload"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("upload"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(rc,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="path"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("path"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(D1,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})})]}),a==="preset"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(Im).map(([z,K])=>{const De=K.icon,se=p===z;return e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-all ${se?"border-primary bg-primary/5":"border-muted hover:border-primary/50"}`,onClick:()=>{g(z),je(z)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(De,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:K.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:K.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 font-mono break-all",children:K.path})]})]})},z)})})]}),a==="path"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"config-path",className:"text-sm md:text-base",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(le,{id:"config-path",value:h,onChange:z=>Ne(z.target.value),placeholder:": C:\\Adapter\\config.toml",className:`text-sm ${N?"border-destructive":""}`}),N&&e.jsx("p",{className:"text-xs text-destructive",children:N})]}),e.jsx(_,{onClick:()=>ce(h),disabled:w||!h||!!N,className:"w-full sm:w-auto",children:w?e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sm:hidden",children:""}),e.jsx("span",{className:"hidden sm:inline",children:""})]})})]})]}),e.jsxs("details",{className:"rounded-lg bg-muted/50 p-3 group",children:[e.jsxs("summary",{className:"text-xs font-medium cursor-pointer select-none list-none flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx("svg",{className:"h-4 w-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Windows"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"C:\\Adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"D:\\MaiBot\\adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"\\\\server\\share\\config.toml"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Linux"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"/opt/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"/home/user/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"~/adapter/config.toml"})]})]}),e.jsx("p",{className:"pt-1 border-t text-[10px] md:text-xs",children:"  1 "})]})]})]})]})})]})}),e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(gt,{children:a==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",b&&" (...)"]}):a==="upload"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""}),"      "]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",b&&" (...)"]})})]}),a==="upload"&&!r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx("input",{ref:X,type:"file",accept:".toml",className:"hidden",onChange:Te}),e.jsxs(_,{onClick:()=>X.current?.click(),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(rc,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:$,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),""]})]}),a==="upload"&&r&&e.jsx("div",{className:"flex gap-2",children:e.jsxs(_,{onClick:G,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(ra,{className:"mr-2 h-4 w-4"}),""]})}),(a==="preset"||a==="path")&&r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(_,{onClick:pe,size:"sm",disabled:b||!!N,className:"w-full sm:w-auto",children:[e.jsx(fc,{className:"mr-2 h-4 w-4"}),b?"...":""]}),e.jsxs(_,{onClick:D,size:"sm",variant:"outline",disabled:w,className:"w-full sm:w-auto",children:[e.jsx(mt,{className:`mr-2 h-4 w-4 ${w?"animate-spin":""}`}),""]}),a==="path"&&e.jsxs(_,{onClick:Y,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(os,{className:"mr-2 h-4 w-4"}),""]})]}),r?e.jsxs(Jt,{defaultValue:"napcat",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Gt,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:grid-cols-5",children:[e.jsxs(Ye,{value:"napcat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Napcat "}),e.jsx("span",{className:"sm:hidden",children:"Napcat"})]}),e.jsxs(Ye,{value:"maibot",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"chat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"voice",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(Ye,{value:"debug",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:""})]})}),e.jsx(Cs,{value:"napcat",className:"space-y-4",children:e.jsx(A4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Cs,{value:"maibot",className:"space-y-4",children:e.jsx(z4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Cs,{value:"chat",className:"space-y-4",children:e.jsx(R4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Cs,{value:"voice",className:"space-y-4",children:e.jsx(D4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Cs,{value:"debug",className:"space-y-4",children:e.jsx(O4,{config:r,onChange:z=>{c(z),ge(z)}})})]}):e.jsx("div",{className:"rounded-lg border bg-card p-6 md:p-12",children:e.jsxs("div",{className:"text-center space-y-3 md:space-y-4",children:[e.jsx(La,{className:"h-12 w-12 md:h-16 md:w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-2 px-4",children:a==="preset"?"":a==="upload"?"":""})]})]})}),e.jsx(bs,{open:M,onOpenChange:S,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-destructive font-medium",children:""})]})]}),e.jsxs(fs,{children:[e.jsx(vs,{onClick:()=>{S(!1),R(null)},children:""}),e.jsx(js,{onClick:ue,children:""})]})]})}),e.jsx(bs,{open:I,onOpenChange:E,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground text-sm",children:""})]})]}),e.jsxs(fs,{children:[e.jsx(vs,{onClick:()=>E(!1),children:""}),e.jsx(js,{onClick:he,className:"bg-destructive hover:bg-destructive/90",children:""})]})]})})]})})}function A4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:"Napcat WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-host",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"napcat-host",value:a.napcat_server.host,onChange:r=>l({...a,napcat_server:{...a.napcat_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-port",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"napcat-port",type:"number",value:a.napcat_server.port||"",onChange:r=>l({...a,napcat_server:{...a.napcat_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8095",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat  8095"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-token",className:"text-sm md:text-base",children:"Token"}),e.jsx(le,{id:"napcat-token",type:"password",value:a.napcat_server.token,onChange:r=>l({...a,napcat_server:{...a.napcat_server,token:r.target.value}}),placeholder:"",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-heartbeat",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"napcat-heartbeat",type:"number",value:a.napcat_server.heartbeat_interval||"",onChange:r=>l({...a,napcat_server:{...a.napcat_server,heartbeat_interval:r.target.value?parseInt(r.target.value):0}}),placeholder:"30",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Napcat  30"})]})]})]})})}function z4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:" WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-host",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"maibot-host",value:a.maibot_server.host,onChange:r=>l({...a,maibot_server:{...a.maibot_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  HOST "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-port",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"maibot-port",type:"number",value:a.maibot_server.port||"",onChange:r=>l({...a,maibot_server:{...a.maibot_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8000",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  PORT  8000"})]})]})]})})}function R4({config:a,onChange:l}){const r=m=>{const h={...a};m==="group"?h.chat.group_list=[...h.chat.group_list,0]:m==="private"?h.chat.private_list=[...h.chat.private_list,0]:h.chat.ban_user_id=[...h.chat.ban_user_id,0],l(h)},c=(m,h)=>{const f={...a};m==="group"?f.chat.group_list=f.chat.group_list.filter((p,g)=>g!==h):m==="private"?f.chat.private_list=f.chat.private_list.filter((p,g)=>g!==h):f.chat.ban_user_id=f.chat.ban_user_id.filter((p,g)=>g!==h),l(f)},d=(m,h,f)=>{const p={...a};m==="group"?p.chat.group_list[h]=f:m==="private"?p.chat.private_list[h]=f:p.chat.ban_user_id[h]=f,l(p)};return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"grid gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:a.chat.group_list_type,onValueChange:m=>l({...a,chat:{...a.chat,group_list_type:m}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"whitelist",children:""}),e.jsx(Z,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("group"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.group_list.map((m,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{type:"number",value:m,onChange:f=>d("group",h,parseInt(f.target.value)||0),placeholder:"",className:"text-sm md:text-base"}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",m," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>c("group",h),children:""})]})]})]})]},h)),a.chat.group_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:a.chat.private_list_type,onValueChange:m=>l({...a,chat:{...a.chat,private_list_type:m}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"whitelist",children:""}),e.jsx(Z,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("private"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.private_list.map((m,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{type:"number",value:m,onChange:f=>d("private",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",m," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>c("private",h),children:""})]})]})]})]},h)),a.chat.private_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>r("ban"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.ban_user_id.map((m,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{type:"number",value:m,onChange:f=>d("ban",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(bs,{children:[e.jsx(yt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",m," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>c("ban",h),children:""})]})]})]})]},h)),a.chat.ban_user_id.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:"QQ"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"QQ"})]}),e.jsx(Ve,{checked:a.chat.ban_qq_bot,onCheckedChange:m=>l({...a,chat:{...a.chat,ban_qq_bot:m}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ve,{checked:a.chat.enable_poke,onCheckedChange:m=>l({...a,chat:{...a.chat,enable_poke:m}})})]})]})]})})}function D4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:" TTS "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" TTS "})]}),e.jsx(Ve,{checked:a.voice.use_tts,onCheckedChange:r=>l({...a,voice:{use_tts:r}})})]})]})})}function O4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:a.debug.level,onValueChange:r=>l({...a,debug:{level:r}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"DEBUG",children:"DEBUG"}),e.jsx(Z,{value:"INFO",children:"INFO"}),e.jsx(Z,{value:"WARNING",children:"WARNING"}),e.jsx(Z,{value:"ERROR",children:"ERROR"}),e.jsx(Z,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})})]})})}const L4=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],U4=/^(aria-|data-)/,aN=a=>Object.fromEntries(Object.entries(a).filter(([l])=>U4.test(l)||L4.includes(l)));function $4(a,l){const r=aN(a);return Object.keys(a).some(c=>!Object.hasOwn(r,c)&&a[c]!==l[c])}class B4 extends u.Component{container;plugin;componentDidMount(){this.installPlugin()}componentDidUpdate(l){if(l.uppy!==this.props.uppy)this.uninstallPlugin(l),this.installPlugin();else if($4(this.props,l)){const{uppy:r,...c}={...this.props,target:this.container};this.plugin.setOptions(c)}}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{uppy:l,...r}={id:"Dashboard",...this.props,inline:!0,target:this.container};l.use(x_,r),this.plugin=l.getPlugin(r.id)}uninstallPlugin(l=this.props){const{uppy:r}=l;r.removePlugin(this.plugin)}render(){return u.createElement("div",{className:"uppy-Container",ref:l=>{this.container=l},...aN(this.props)})}}function P4({src:a,alt:l="",className:r,maxRetries:c=5,retryInterval:d=1500}){const[m,h]=u.useState("loading"),[f,p]=u.useState(0),[g,N]=u.useState(null),[j,b]=u.useState(a);a!==j&&(h("loading"),p(0),N(null),b(a));const y=u.useCallback(async()=>{try{const w=await fetch(a,{credentials:"include"});if(w.status===202){h("generating"),f<c?setTimeout(()=>{p(S=>S+1)},d):h("error");return}if(!w.ok){h("error");return}const A=await w.blob(),M=URL.createObjectURL(A);N(M),h("loaded")}catch(w){console.error(":",w),h("error")}},[a,f,c,d]);return u.useEffect(()=>{y()},[y]),u.useEffect(()=>()=>{g&&URL.revokeObjectURL(g)},[g]),m==="loading"||m==="generating"?e.jsx(Ms,{className:F("w-full h-full",r)}):m==="error"||!g?e.jsx("div",{className:F("w-full h-full flex items-center justify-center bg-muted",r),children:e.jsx(dx,{className:"h-8 w-8 text-muted-foreground"})}):e.jsx("img",{src:g,alt:l,className:F("w-full h-full object-contain",r)})}function I4({children:a,className:l}){return e.jsx(jx,{content:a,className:l})}const tl="/api/webui/emoji";async function F4(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.is_registered!==void 0&&l.append("is_registered",a.is_registered.toString()),a.is_banned!==void 0&&l.append("is_banned",a.is_banned.toString()),a.format&&l.append("format",a.format),a.sort_by&&l.append("sort_by",a.sort_by),a.sort_order&&l.append("sort_order",a.sort_order);const r=await Se(`${tl}/list?${l}`,{});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function H4(a){const l=await Se(`${tl}/${a}`,{});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function q4(a,l){const r=await Se(`${tl}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function V4(a){const l=await Se(`${tl}/${a}`,{method:"DELETE"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function G4(){const a=await Se(`${tl}/stats/summary`,{});if(!a.ok)throw new Error(`: ${a.statusText}`);return a.json()}async function K4(a){const l=await Se(`${tl}/${a}/register`,{method:"POST"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function Q4(a){const l=await Se(`${tl}/${a}/ban`,{method:"POST"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}function Y4(a,l=!1){return l?`${tl}/${a}/thumbnail?original=true`:`${tl}/${a}/thumbnail`}function J4(a){return`${tl}/${a}/thumbnail?original=true`}async function X4(a){const l=await Se(`${tl}/batch/delete`,{method:"POST",body:JSON.stringify({emoji_ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function Z4(){return`${tl}/upload`}function W4(){const[a,l]=u.useState([]),[r,c]=u.useState(null),[d,m]=u.useState(!1),[h,f]=u.useState(1),[p,g]=u.useState(0),[N,j]=u.useState(20),[b,y]=u.useState("all"),[w,A]=u.useState("all"),[M,S]=u.useState("all"),[I,E]=u.useState("usage_count"),[C,R]=u.useState("desc"),[H,O]=u.useState(null),[X,L]=u.useState(!1),[me,Ne]=u.useState(!1),[je,ce]=u.useState(!1),[ge,pe]=u.useState(new Set),[D,Q]=u.useState(!1),[B,ue]=u.useState(""),[Y,_e]=u.useState("medium"),[he,Te]=u.useState(!1),{toast:G}=nt(),$=u.useCallback(async()=>{try{m(!0);const de=await F4({page:h,page_size:N,is_registered:b==="all"?void 0:b==="registered",is_banned:w==="all"?void 0:w==="banned",format:M==="all"?void 0:M,sort_by:I,sort_order:C});l(de.data),g(de.total)}catch(de){const Re=de instanceof Error?de.message:"";G({title:"",description:Re,variant:"destructive"})}finally{m(!1)}},[h,N,b,w,M,I,C,G]),z=async()=>{try{const de=await G4();c(de.data)}catch(de){console.error(":",de)}};u.useEffect(()=>{$()},[$]),u.useEffect(()=>{z()},[]);const K=async de=>{try{const Re=await H4(de.id);O(Re.data),L(!0)}catch(Re){const ys=Re instanceof Error?Re.message:"";G({title:"",description:ys,variant:"destructive"})}},De=de=>{O(de),Ne(!0)},se=de=>{O(de),ce(!0)},Le=async()=>{if(H)try{await V4(H.id),G({title:"",description:""}),ce(!1),O(null),$(),z()}catch(de){const Re=de instanceof Error?de.message:"";G({title:"",description:Re,variant:"destructive"})}},rs=async de=>{try{await K4(de.id),G({title:"",description:""}),$(),z()}catch(Re){const ys=Re instanceof Error?Re.message:"";G({title:"",description:ys,variant:"destructive"})}},J=async de=>{try{await Q4(de.id),G({title:"",description:""}),$(),z()}catch(Re){const ys=Re instanceof Error?Re.message:"";G({title:"",description:ys,variant:"destructive"})}},W=de=>{const Re=new Set(ge);Re.has(de)?Re.delete(de):Re.add(de),pe(Re)},Ue=async()=>{try{const de=await X4(Array.from(ge));G({title:"",description:de.message}),pe(new Set),Q(!1),$(),z()}catch(de){G({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}},ae=()=>{const de=parseInt(B),Re=Math.ceil(p/N);de>=1&&de<=Re?(f(de),ue("")):G({title:"",description:`1-${Re}`,variant:"destructive"})},Ee=r?.formats?Object.keys(r.formats):[];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>Te(!0),className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),""]})]}),e.jsx(ts,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[r&&e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ce,{children:e.jsxs(Oe,{className:"pb-2",children:[e.jsx(Ns,{children:""}),e.jsx($e,{className:"text-2xl",children:r.total})]})}),e.jsx(Ce,{children:e.jsxs(Oe,{className:"pb-2",children:[e.jsx(Ns,{children:""}),e.jsx($e,{className:"text-2xl text-green-600",children:r.registered})]})}),e.jsx(Ce,{children:e.jsxs(Oe,{className:"pb-2",children:[e.jsx(Ns,{children:""}),e.jsx($e,{className:"text-2xl text-red-600",children:r.banned})]})}),e.jsx(Ce,{children:e.jsxs(Oe,{className:"pb-2",children:[e.jsx(Ns,{children:""}),e.jsx($e,{className:"text-2xl text-gray-600",children:r.unregistered})]})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsxs($e,{className:"flex items-center gap-2",children:[e.jsx(Bo,{className:"h-5 w-5"}),""]})}),e.jsxs(ze,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:`${I}-${C}`,onValueChange:de=>{const[Re,ys]=de.split("-");E(Re),R(ys),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"usage_count-desc",children:" ()"}),e.jsx(Z,{value:"usage_count-asc",children:" ()"}),e.jsx(Z,{value:"register_time-desc",children:" ()"}),e.jsx(Z,{value:"register_time-asc",children:" ()"}),e.jsx(Z,{value:"record_time-desc",children:" ()"}),e.jsx(Z,{value:"record_time-asc",children:" ()"}),e.jsx(Z,{value:"last_used_time-desc",children:" ()"}),e.jsx(Z,{value:"last_used_time-asc",children:" ()"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:b,onValueChange:de=>{y(de),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"registered",children:""}),e.jsx(Z,{value:"unregistered",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:w,onValueChange:de=>{A(de),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"banned",children:""}),e.jsx(Z,{value:"unbanned",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:M,onValueChange:de=>{S(de),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),Ee.map(de=>e.jsxs(Z,{value:de,children:[de.toUpperCase()," (",r?.formats[de],")"]},de))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[ge.size>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",ge.size," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:Y,onValueChange:de=>_e(de),children:[e.jsx(Be,{className:"w-24",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"small",children:""}),e.jsx(Z,{value:"medium",children:""}),e.jsx(Z,{value:"large",children:""})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"emoji-page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:N.toString(),onValueChange:de=>{j(parseInt(de)),f(1),pe(new Set)},children:[e.jsx(Be,{id:"emoji-page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"40",children:"40"}),e.jsx(Z,{value:"60",children:"60"}),e.jsx(Z,{value:"100",children:"100"})]})]}),ge.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>pe(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>Q(!0),children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs(_,{variant:"outline",size:"sm",onClick:$,disabled:d,children:[e.jsx(mt,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]})})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsxs(Ns,{children:[" ",p,"  ",h," "]})]}),e.jsxs(ze,{children:[a.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""}):e.jsx("div",{className:`grid gap-3 ${Y==="small"?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10":Y==="medium"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8":"grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"}`,children:a.map(de=>e.jsxs("div",{className:`group relative rounded-lg border bg-card overflow-hidden hover:ring-2 hover:ring-primary transition-all cursor-pointer ${ge.has(de.id)?"ring-2 ring-primary bg-primary/5":""}`,onClick:()=>W(de.id),children:[e.jsx("div",{className:`absolute top-1 left-1 z-10 transition-opacity ${ge.has(de.id)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${ge.has(de.id)?"bg-primary border-primary text-primary-foreground":"bg-background/80 border-muted-foreground/50"}`,children:ge.has(de.id)&&e.jsx(st,{className:"h-3 w-3"})})}),e.jsxs("div",{className:"absolute top-1 right-1 z-10 flex flex-col gap-0.5",children:[de.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600 text-[10px] px-1 py-0",children:""}),de.is_banned&&e.jsx(ke,{variant:"destructive",className:"text-[10px] px-1 py-0",children:""})]}),e.jsx("div",{className:`aspect-square bg-muted flex items-center justify-center overflow-hidden ${Y==="small"?"p-1":Y==="medium"?"p-2":"p-3"}`,children:e.jsx(P4,{src:Y4(de.id),alt:""})}),e.jsxs("div",{className:`border-t bg-card ${Y==="small"?"p-1":"p-2"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-1 text-xs text-muted-foreground mb-1",children:[e.jsx(ke,{variant:"outline",className:"text-[10px] px-1 py-0",children:de.format.toUpperCase()}),e.jsxs("span",{className:"font-mono",children:[de.usage_count,""]})]}),e.jsxs("div",{className:`flex gap-1 justify-center opacity-0 group-hover:opacity-100 transition-opacity ${Y==="small"?"flex-wrap":""}`,children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Re=>{Re.stopPropagation(),De(de)},title:"",children:e.jsx(Wn,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Re=>{Re.stopPropagation(),K(de)},title:"",children:e.jsx(Yt,{className:"h-3 w-3"})}),!de.is_registered&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-green-700",onClick:Re=>{Re.stopPropagation(),rs(de)},title:"",children:e.jsx(st,{className:"h-3 w-3"})}),!de.is_banned&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-orange-600 hover:text-orange-700",onClick:Re=>{Re.stopPropagation(),J(de)},title:"",children:e.jsx(av,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600 hover:text-red-700",onClick:Re=>{Re.stopPropagation(),se(de)},title:"",children:e.jsx(os,{className:"h-3 w-3"})})]})]})]},de.id))}),p>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(h-1)*N+1," "," ",Math.min(h*N,p),"  ",p," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(de=>Math.max(1,de-1)),disabled:h===1,children:[e.jsx(Pa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:B,onChange:de=>ue(de.target.value),onKeyDown:de=>de.key==="Enter"&&ae(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(p/N)}),e.jsx(_,{variant:"outline",size:"sm",onClick:ae,disabled:!B,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(de=>de+1),disabled:h>=Math.ceil(p/N),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ia,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(p/N)),disabled:h>=Math.ceil(p/N),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(ek,{emoji:H,open:X,onOpenChange:L}),e.jsx(sk,{emoji:H,open:me,onOpenChange:Ne,onSuccess:()=>{$(),z()}}),e.jsx(tk,{open:he,onOpenChange:Te,onSuccess:()=>{$(),z()}})]})}),e.jsx(bs,{open:D,onOpenChange:Q,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",ge.size," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:Ue,children:""})]})]})}),e.jsx(Qs,{open:je,onOpenChange:ce,children:e.jsxs(Hs,{children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>ce(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:Le,children:""})]})]})})]})}function ek({emoji:a,open:l,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[90vh]",children:[e.jsx(qs,{children:e.jsx(Vs,{children:""})}),e.jsx(ts,{className:"max-h-[calc(90vh-8rem)] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:J4(a.id),alt:a.description||"",className:"w-full h-full object-cover",onError:d=>{const m=d.target;m.style.display="none";const h=m.parentElement;h&&(h.innerHTML='<svg class="h-16 w-16 text-muted-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>')}})})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:"ID"}),e.jsx("div",{className:"mt-1 font-mono",children:a.id})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",children:a.format.toUpperCase()})})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.full_path})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.emoji_hash})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),a.description?e.jsx("div",{className:"mt-1 rounded-lg border bg-muted/50 p-3",children:e.jsx(I4,{className:"prose-sm",children:a.description})}):e.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:"-"})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:a.emotion?e.jsx("span",{className:"text-sm",children:a.emotion}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),a.is_banned&&e.jsx(ke,{variant:"destructive",children:""}),!a.is_registered&&!a.is_banned&&e.jsx(ke,{variant:"outline",children:""})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-lg",children:a.usage_count})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.record_time)})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.register_time)})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.last_used_time)})]})]})})]})})}function sk({emoji:a,open:l,onOpenChange:r,onSuccess:c}){const[d,m]=u.useState(""),[h,f]=u.useState(!1),[p,g]=u.useState(!1),[N,j]=u.useState(!1),{toast:b}=nt();u.useEffect(()=>{a&&(m(a.emotion||""),f(a.is_registered),g(a.is_banned))},[a]);const y=async()=>{if(a)try{j(!0);const w=d.split(/[,,]/).map(A=>A.trim()).filter(Boolean).join(",");await q4(a.id,{emotion:w||void 0,is_registered:h,is_banned:p}),b({title:"",description:""}),r(!1),c()}catch(w){const A=w instanceof Error?w.message:"";b({title:"",description:A,variant:"destructive"})}finally{j(!1)}};return a?e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:""}),e.jsx(ht,{value:d,onChange:w=>m(w.target.value),placeholder:"...",rows:2,className:"mt-1"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"is_registered",checked:h,onCheckedChange:w=>{w===!0?(f(!0),g(!1)):f(!1)}}),e.jsx(T,{htmlFor:"is_registered",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"is_banned",checked:p,onCheckedChange:w=>{w===!0?(g(!0),f(!1)):g(!1)}}),e.jsx(T,{htmlFor:"is_banned",className:"cursor-pointer",children:""})]})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:y,disabled:N,children:N?"...":""})]})]})}):null}function tk({open:a,onOpenChange:l,onSuccess:r}){const[c,d]=u.useState("select"),[m,h]=u.useState([]),[f,p]=u.useState(null),[g,N]=u.useState(!1),{toast:j}=nt(),b=u.useMemo(()=>new h_({id:"emoji-uploader",autoProceed:!1,restrictions:{maxFileSize:10485760,allowedFileTypes:["image/jpeg","image/png","image/gif","image/webp"],maxNumberOfFiles:20},locale:{pluralize:()=>0,strings:{addMoreFiles:"",addingMoreFiles:"",allowedFileTypes:"%{types}",cancel:"",closeModal:"",complete:"",connectedToInternet:"",copyLink:"",copyLinkToClipboardFallback:"",copyLinkToClipboardSuccess:"",dashboardTitle:"",dashboardWindowTitle:" ESC ",done:"",dropHereOr:" %{browse}",dropHint:"",dropPasteFiles:" %{browseFiles}",dropPasteFolders:" %{browseFolders}",dropPasteBoth:"%{browseFiles}  %{browseFolders}",dropPasteImportFiles:"%{browseFiles} ",dropPasteImportFolders:"%{browseFolders} ",dropPasteImportBoth:"%{browseFiles}%{browseFolders} ",editFile:"",editing:" %{file}",emptyFolderAdded:"",exceedsSize:"%{file}  %{size}",failedToUpload:" %{file} ",fileSource:"%{name}",filesUploadedOfTotal:{0:" %{complete} / %{smart_count} ",1:" %{complete} / %{smart_count} "},filter:"",finishEditingFile:"",folderAdded:{0:" %{folder}  %{smart_count} ",1:" %{folder}  %{smart_count} "},generatingThumbnails:"...",import:"",importFiles:"",importFrom:" %{name} ",loading:"...",logOut:"",myDevice:"",noFilesFound:"",noInternetConnection:"",openFolderNamed:" %{name}",pause:"",pauseUpload:"",paused:"",poweredBy:"%{uppy}",processingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},recording:"",removeFile:"",resetFilter:"",resume:"",resumeUpload:"",retry:"",retryUpload:"",save:"",saveChanges:"",selectFileNamed:" %{name}",selectX:{0:" %{smart_count}",1:" %{smart_count}"},smile:"",startRecording:"",stopRecording:"",takePicture:"",timedOut:" %{seconds} ",upload:"",uploadComplete:"",uploadFailed:"",uploadPaused:"",uploadXFiles:{0:"%{smart_count} ",1:"%{smart_count} "},uploadXNewFiles:{0:"+%{smart_count} ",1:"+%{smart_count} "},uploading:"",uploadingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},xFilesSelected:{0:" %{smart_count} ",1:" %{smart_count} "},xMoreFilesAdded:{0:" %{smart_count} ",1:" %{smart_count} "},xTimeLeft:" %{time}",youCanOnlyUploadFileTypes:"%{types}",youCanOnlyUploadX:{0:" %{smart_count} ",1:" %{smart_count} "},youHaveToAtLeastSelectX:{0:" %{smart_count} ",1:" %{smart_count} "},browseFiles:"",browseFolders:"",cancelUpload:"",addMore:"",back:"",editFileWithFilename:" %{file}"}}}),[]);u.useEffect(()=>{const H=()=>{const O=b.getFiles();if(O.length===0)return;const X=O.map(L=>({id:L.id,name:L.name,previewUrl:L.preview||URL.createObjectURL(L.data),emotion:"",description:"",isRegistered:!0,file:L.data}));h(X),O.length===1?(p(X[0].id),d("edit-single")):d("edit-multiple")};return b.on("upload",H),()=>{b.off("upload",H)}},[b]),u.useEffect(()=>{a||(b.cancelAll(),d("select"),h([]),p(null),N(!1))},[a,b]);const y=u.useCallback((H,O)=>{h(X=>X.map(L=>L.id===H?{...L,...O}:L))},[]),w=u.useCallback(H=>H.emotion.trim().length>0,[]),A=u.useMemo(()=>m.length>0&&m.every(w),[m,w]),M=u.useMemo(()=>m.find(H=>H.id===f)||null,[m,f]),S=u.useCallback(()=>{(c==="edit-single"||c==="edit-multiple")&&(d("select"),h([]),p(null))},[c]),I=u.useCallback(async()=>{if(!A){j({title:"",description:"",variant:"destructive"});return}N(!0);let H=0,O=0;try{for(const X of m){const L=new FormData;L.append("file",X.file),L.append("emotion",X.emotion),L.append("description",X.description),L.append("is_registered",X.isRegistered.toString());try{(await Se(Z4(),{method:"POST",body:L})).ok?H++:O++}catch{O++}}O===0?(j({title:"",description:` ${H} `}),l(!1),r()):(j({title:"",description:` ${H}  ${O} `,variant:"destructive"}),r())}finally{N(!1)}},[A,m,j,l,r]),E=()=>e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"border rounded-lg overflow-hidden w-full",children:e.jsx(B4,{uppy:b,proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!0,height:350,width:"100%",theme:"auto",note:" JPGPNGGIFWebP  20 "})})}),C=()=>{const H=m[0];return H?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ua,{className:"h-4 w-4 mr-1"}),""]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"w-32 h-32 rounded-lg border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:H.previewUrl,alt:H.name,className:"max-w-full max-h-full object-contain"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center truncate max-w-32",children:H.name})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"single-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"single-emotion",value:H.emotion,onChange:O=>y(H.id,{emotion:O.target.value}),placeholder:",",className:H.emotion.trim()?"":"border-destructive"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"single-description",children:""}),e.jsx(le,{id:"single-description",value:H.description,onChange:O=>y(H.id,{description:O.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"single-is-registered",checked:H.isRegistered,onCheckedChange:O=>y(H.id,{isRegistered:O===!0})}),e.jsx(T,{htmlFor:"single-is-registered",className:"cursor-pointer",children:""})]})]})]}),e.jsx(ft,{children:e.jsx(_,{onClick:I,disabled:!A||g,children:g?"...":""})})]}):null},R=()=>{const H=m.filter(w).length,O=m.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ua,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["",H,"/",O," "]})]}),e.jsx(ke,{variant:A?"default":"secondary",children:A?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Sa,{className:"h-3 w-3 mr-1"}),""]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ts,{className:"h-[350px] pr-2",children:e.jsx("div",{className:"space-y-2",children:m.map(X=>{const L=w(X),me=f===X.id;return e.jsxs("div",{onClick:()=>p(X.id),className:`
                      flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all
                      ${me?"ring-2 ring-primary":""}
                      ${L?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-border hover:border-muted-foreground/50"}
                    `,children:[e.jsx("div",{className:"w-12 h-12 rounded border overflow-hidden bg-muted flex-shrink-0 flex items-center justify-center",children:e.jsx("img",{src:X.previewUrl,alt:X.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:X.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:X.emotion||""})]}),L?e.jsx(st,{className:"h-5 w-5 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-muted-foreground/30 flex-shrink-0"})]},X.id)})})}),e.jsx("div",{className:"border rounded-lg p-4",children:M?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:M.previewUrl,alt:M.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:M.name}),w(M)&&e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(Lt,{className:"h-3 w-3 mr-1"}),""]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"multi-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"multi-emotion",value:M.emotion,onChange:X=>y(M.id,{emotion:X.target.value}),placeholder:",",className:M.emotion.trim()?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"multi-description",children:""}),e.jsx(le,{id:"multi-description",value:M.description,onChange:X=>y(M.id,{description:X.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"multi-is-registered",checked:M.isRegistered,onCheckedChange:X=>y(M.id,{isRegistered:X===!0})}),e.jsx(T,{htmlFor:"multi-is-registered",className:"cursor-pointer text-sm",children:""})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(dx,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:""})]})})})]}),e.jsx(ft,{children:e.jsx(_,{onClick:I,disabled:!A||g,children:g?"...":` (${O})`})})]})};return e.jsx(Qs,{open:a,onOpenChange:l,children:e.jsxs(Hs,{className:"max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(rc,{className:"h-5 w-5"}),c==="select"&&" - ",c==="edit-single"&&" - ",c==="edit-multiple"&&" - "]}),e.jsxs(at,{children:[c==="select"&&" JPGPNGGIFWebP  10MB",c==="edit-single"&&"",c==="edit-multiple"&&""]})]}),e.jsxs("div",{className:"overflow-y-auto pr-1",children:[c==="select"&&E(),c==="edit-single"&&C(),c==="edit-multiple"&&R()]})]})})}function ak(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(1),[p,g]=u.useState(20),[N,j]=u.useState(""),[b,y]=u.useState(null),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[I,E]=u.useState(!1),[C,R]=u.useState(null),[H,O]=u.useState(new Set),[X,L]=u.useState(!1),[me,Ne]=u.useState(""),[je,ce]=u.useState({total:0,recent_7days:0,chat_count:0,top_chats:{}}),[ge,pe]=u.useState([]),[D,Q]=u.useState(new Map),[B,ue]=u.useState(!1),[Y,_e]=u.useState(0),{toast:he}=nt(),Te=async()=>{try{c(!0);const ae=await X_({page:h,page_size:p,search:N||void 0});l(ae.data),m(ae.total)}catch(ae){he({title:"",description:ae instanceof Error?ae.message:"",variant:"destructive"})}finally{c(!1)}},G=async()=>{try{const ae=await a2();ae?.data&&ce(ae.data)}catch(ae){console.error(":",ae)}},$=async()=>{try{const ae=await fx();_e(ae.unchecked)}catch(ae){console.error(":",ae)}},z=async()=>{try{const ae=await hx();if(ae?.data){pe(ae.data);const Ee=new Map;ae.data.forEach(de=>{Ee.set(de.chat_id,de.chat_name)}),Q(Ee)}}catch(ae){console.error(":",ae)}},K=ae=>D.get(ae)||ae;u.useEffect(()=>{Te(),$(),G(),z()},[h,p,N]);const De=async ae=>{try{const Ee=await Z_(ae.id);y(Ee.data),A(!0)}catch(Ee){he({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},se=ae=>{y(ae),S(!0)},Le=async ae=>{try{await s2(ae.id),he({title:"",description:`: ${ae.situation}`}),R(null),Te(),G()}catch(Ee){he({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},rs=ae=>{const Ee=new Set(H);Ee.has(ae)?Ee.delete(ae):Ee.add(ae),O(Ee)},J=()=>{H.size===a.length&&a.length>0?O(new Set):O(new Set(a.map(ae=>ae.id)))},W=async()=>{try{await t2(Array.from(H)),he({title:"",description:` ${H.size} `}),O(new Set),L(!1),Te(),G()}catch(ae){he({title:"",description:ae instanceof Error?ae.message:"",variant:"destructive"})}},Ue=()=>{const ae=parseInt(me),Ee=Math.ceil(d/p);ae>=1&&ae<=Ee?(f(ae),Ne("")):he({title:"",description:`1-${Ee}`,variant:"destructive"})};return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ba,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>ue(!0),className:"gap-2",children:[e.jsx(lv,{className:"h-4 w-4"}),"",Y>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:Y>99?"99+":Y})]}),e.jsxs(_,{onClick:()=>E(!0),className:"gap-2",children:[e.jsx(Xs,{className:"h-4 w-4"}),""]})]})]})}),e.jsx(ts,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:je.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"7"}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:je.recent_7days})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-blue-600",children:je.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 mt-1.5",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ut,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(le,{id:"search",placeholder:"...",value:N,onChange:ae=>j(ae.target.value),className:"pl-9"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:H.size>0&&e.jsxs("span",{children:[" ",H.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:ae=>{g(parseInt(ae)),f(1),O(new Set)},children:[e.jsx(Be,{id:"page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),H.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>O(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>L(!0),children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{className:"w-12",children:e.jsx(tt,{checked:H.size===a.length&&a.length>0,onCheckedChange:J})}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r?e.jsx(wt,{children:e.jsx(Je,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(wt,{children:e.jsx(Je,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(ae=>e.jsxs(wt,{children:[e.jsx(Je,{children:e.jsx(tt,{checked:H.has(ae.id),onCheckedChange:()=>rs(ae.id)})}),e.jsx(Je,{className:"font-medium max-w-xs truncate",children:ae.situation}),e.jsx(Je,{className:"max-w-xs truncate",children:ae.style}),e.jsx(Je,{className:"max-w-[200px] truncate",title:K(ae.chat_id),style:{wordBreak:"keep-all"},children:e.jsx("span",{className:"whitespace-nowrap overflow-hidden text-ellipsis block",children:K(ae.chat_id)})}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>se(ae),children:[e.jsx(Wn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>De(ae),title:"",children:e.jsx(oa,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>R(ae),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]})]})})]},ae.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(ae=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(tt,{checked:H.has(ae.id),onCheckedChange:()=>rs(ae.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 overflow-hidden space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 w-full break-all",title:ae.situation,children:ae.situation})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm line-clamp-2 w-full break-all",title:ae.style,children:ae.style})]})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm truncate",title:K(ae.chat_id),style:{wordBreak:"keep-all"},children:K(ae.chat_id)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>se(ae),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Wn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>De(ae),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:e.jsx(oa,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>R(ae),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(os,{className:"h-3 w-3 mr-1"}),""]})]})]},ae.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Pa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:me,onChange:ae=>Ne(ae.target.value),onKeyDown:ae=>ae.key==="Enter"&&Ue(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:Ue,disabled:!me,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ia,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(lk,{expression:b,open:w,onOpenChange:A,chatNameMap:D}),e.jsx(nk,{open:I,onOpenChange:E,chatList:ge,onSuccess:()=>{Te(),G(),E(!1)}}),e.jsx(rk,{expression:b,open:M,onOpenChange:S,chatList:ge,onSuccess:()=>{Te(),G(),S(!1)}}),e.jsx(bs,{open:!!C,onOpenChange:()=>R(null),children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',C?.situation,'"  ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>C&&Le(C),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(ik,{open:X,onOpenChange:L,onConfirm:W,count:H.size}),e.jsx($v,{open:B,onOpenChange:ae=>{ue(ae),ae||(Te(),G(),$())}})]})}function lk({expression:a,open:l,onOpenChange:r,chatNameMap:c}){if(!a)return null;const d=h=>h?new Date(h*1e3).toLocaleString("zh-CN"):"-",m=h=>c.get(h)||h;return e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ki,{label:"",value:a.situation}),e.jsx(Ki,{label:"",value:a.style}),e.jsx(Ki,{label:"",value:m(a.chat_id)}),e.jsx(Ki,{icon:Xr,label:"ID",value:a.id.toString(),mono:!0})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(Ki,{icon:ca,label:"",value:d(a.create_date)})}),e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-3 block",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("flex h-8 w-8 items-center justify-center rounded-full",a.checked?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.checked?e.jsx(st,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.checked?"":""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("flex h-8 w-8 items-center justify-center rounded-full",a.rejected?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.rejected?e.jsx(aa,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.rejected?"":""})]})]})]})]})]}),e.jsx(ft,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Ki({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function nk({open:a,onOpenChange:l,chatList:r,onSuccess:c}){const[d,m]=u.useState({situation:"",style:"",chat_id:""}),[h,f]=u.useState(!1),{toast:p}=nt(),g=async()=>{if(!d.situation||!d.style||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await W_(d),p({title:"",description:""}),m({situation:"",style:"",chat_id:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Qs,{open:a,onOpenChange:l,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"situation",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"situation",value:d.situation,onChange:N=>m({...d,situation:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"style",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"style",value:d.style,onChange:N=>m({...d,style:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Ie,{value:d.chat_id,onValueChange:N=>m({...d,chat_id:N}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Pe,{children:r.map(N=>e.jsx(Z,{value:N.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[N.chat_name,N.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},N.chat_id))})]})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function rk({expression:a,open:l,onOpenChange:r,chatList:c,onSuccess:d}){const[m,h]=u.useState({}),[f,p]=u.useState(!1),{toast:g}=nt();u.useEffect(()=>{a&&h({situation:a.situation,style:a.style,chat_id:a.chat_id,checked:a.checked,rejected:a.rejected})},[a]);const N=async()=>{if(a)try{p(!0),await e2(a.id,m),g({title:"",description:""}),d()}catch(j){g({title:"",description:j instanceof Error?j.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_situation",children:""}),e.jsx(le,{id:"edit_situation",value:m.situation||"",onChange:j=>h({...m,situation:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_style",children:""}),e.jsx(le,{id:"edit_style",value:m.style||"",onChange:j=>h({...m,style:j.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Ie,{value:m.chat_id||"",onValueChange:j=>h({...m,chat_id:j}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Pe,{children:c.map(j=>e.jsx(Z,{value:j.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[j.chat_name,j.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},j.chat_id))})]})]}),e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(gt,{className:"text-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:""})}),e.jsx("p",{children:" AI"}),e.jsx("p",{children:" "}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:['""',e.jsx("br",{})," ",e.jsx("br",{})," "]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_checked",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"edit_checked",checked:m.checked??!1,onCheckedChange:j=>h({...m,checked:j})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_rejected",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"edit_rejected",checked:m.rejected??!1,onCheckedChange:j=>h({...m,rejected:j})})]})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}function ik({open:a,onOpenChange:l,onConfirm:r,count:c}){return e.jsx(bs,{open:a,onOpenChange:l,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",c," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:r,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})}const Hl="/api/webui/jargon";async function ck(){const a=await Se(`${Hl}/chats`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function ok(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id),a.is_jargon!==void 0&&a.is_jargon!==null&&l.append("is_jargon",a.is_jargon.toString()),a.is_global!==void 0&&l.append("is_global",a.is_global.toString());const r=await Se(`${Hl}/list?${l}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function dk(a){const l=await Se(`${Hl}/${a}`,{});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function uk(a){const l=await Se(`${Hl}/`,{method:"POST",body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function mk(a,l){const r=await Se(`${Hl}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function xk(a){const l=await Se(`${Hl}/${a}`,{method:"DELETE"});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function hk(a){const l=await Se(`${Hl}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function fk(){const a=await Se(`${Hl}/stats/summary`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function pk(a,l){const r=new URLSearchParams;a.forEach(d=>r.append("ids",d.toString())),r.append("is_jargon",l.toString());const c=await Se(`${Hl}/batch/set-jargon?${r}`,{method:"POST"});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return c.json()}function gk(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(1),[p,g]=u.useState(20),[N,j]=u.useState(""),[b,y]=u.useState("all"),[w,A]=u.useState("all"),[M,S]=u.useState(null),[I,E]=u.useState(!1),[C,R]=u.useState(!1),[H,O]=u.useState(!1),[X,L]=u.useState(null),[me,Ne]=u.useState(new Set),[je,ce]=u.useState(!1),[ge,pe]=u.useState(""),[D,Q]=u.useState({total:0,confirmed_jargon:0,confirmed_not_jargon:0,pending:0,global_count:0,complete_count:0,chat_count:0,top_chats:{}}),[B,ue]=u.useState([]),{toast:Y}=nt(),_e=async()=>{try{c(!0);const W=await ok({page:h,page_size:p,search:N||void 0,chat_id:b==="all"?void 0:b,is_jargon:w==="all"?void 0:w==="true"?!0:w==="false"?!1:void 0});l(W.data),m(W.total)}catch(W){Y({title:"",description:W instanceof Error?W.message:"",variant:"destructive"})}finally{c(!1)}},he=async()=>{try{const W=await fk();W?.data&&Q(W.data)}catch(W){console.error(":",W)}},Te=async()=>{try{const W=await ck();W?.data&&ue(W.data)}catch(W){console.error(":",W)}};u.useEffect(()=>{_e(),he(),Te()},[h,p,N,b,w]);const G=async W=>{try{const Ue=await dk(W.id);S(Ue.data),E(!0)}catch(Ue){Y({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},$=W=>{S(W),R(!0)},z=async W=>{try{await xk(W.id),Y({title:"",description:`: ${W.content}`}),L(null),_e(),he()}catch(Ue){Y({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},K=W=>{const Ue=new Set(me);Ue.has(W)?Ue.delete(W):Ue.add(W),Ne(Ue)},De=()=>{me.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(W=>W.id)))},se=async()=>{try{await hk(Array.from(me)),Y({title:"",description:` ${me.size} `}),Ne(new Set),ce(!1),_e(),he()}catch(W){Y({title:"",description:W instanceof Error?W.message:"",variant:"destructive"})}},Le=async W=>{try{await pk(Array.from(me),W),Y({title:"",description:` ${me.size} ${W?"":""}`}),Ne(new Set),_e(),he()}catch(Ue){Y({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},rs=()=>{const W=parseInt(ge),Ue=Math.ceil(d/p);W>=1&&W<=Ue?(f(W),pe("")):Y({title:"",description:`1-${Ue}`,variant:"destructive"})},J=W=>W===!0?e.jsxs(ke,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Lt,{className:"h-3 w-3 mr-1"}),""]}):W===!1?e.jsxs(ke,{variant:"secondary",children:[e.jsx(Sa,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"outline",children:[e.jsx(rv,{className:"h-3 w-3 mr-1"}),""]});return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(O1,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs(_,{onClick:()=>O(!0),className:"gap-2",children:[e.jsx(Xs,{className:"h-4 w-4"}),""]})]})}),e.jsx(ts,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:D.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-green-600",children:D.confirmed_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-gray-500",children:D.confirmed_not_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-yellow-600",children:D.pending})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-blue-600",children:D.global_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-purple-600",children:D.complete_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:D.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(le,{id:"search",placeholder:"...",value:N,onChange:W=>j(W.target.value),className:"pl-9"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:b,onValueChange:y,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),B.map(W=>e.jsx(Z,{value:W.chat_id,children:W.chat_name},W.chat_id))]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:w,onValueChange:A,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"true",children:""}),e.jsx(Z,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"page-size",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:W=>{g(parseInt(W)),f(1),Ne(new Set)},children:[e.jsx(Be,{id:"page-size",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]})]})]}),me.size>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",me.size," "]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Le(!0),children:[e.jsx(Lt,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Le(!1),children:[e.jsx(Sa,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>ce(!0),children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{className:"w-12",children:e.jsx(tt,{checked:me.size===a.length&&a.length>0,onCheckedChange:De})}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{className:"text-center",children:""}),e.jsx(ns,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r?e.jsx(wt,{children:e.jsx(Je,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(wt,{children:e.jsx(Je,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(W=>e.jsxs(wt,{children:[e.jsx(Je,{children:e.jsx(tt,{checked:me.has(W.id),onCheckedChange:()=>K(W.id)})}),e.jsx(Je,{className:"font-medium max-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[W.is_global&&e.jsx("span",{title:"",children:e.jsx(qo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"})}),e.jsx("span",{className:"truncate",title:W.content,children:W.content})]})}),e.jsx(Je,{className:"max-w-[200px] truncate",title:W.meaning||"",children:W.meaning||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Je,{className:"max-w-[150px] truncate",title:W.chat_name||W.chat_id,children:W.chat_name||W.chat_id}),e.jsx(Je,{children:J(W.is_jargon)}),e.jsx(Je,{className:"text-center",children:W.count}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>$(W),children:[e.jsx(Wn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>G(W),title:"",children:e.jsx(oa,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>L(W),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]})]})})]},W.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(W=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(tt,{checked:me.has(W.id),onCheckedChange:()=>K(W.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[W.is_global&&e.jsx(qo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),e.jsx("h3",{className:"font-semibold text-sm break-all",children:W.content})]}),W.meaning&&e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:W.meaning}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[J(W.is_jargon),e.jsxs("span",{className:"text-muted-foreground",children:[": ",W.count]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[": ",W.chat_name||W.chat_id]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>$(W),className:"text-xs px-2 py-1 h-auto",children:[e.jsx(Wn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>G(W),className:"text-xs px-2 py-1 h-auto",children:e.jsx(oa,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>L(W),className:"text-xs px-2 py-1 h-auto text-destructive hover:text-destructive",children:[e.jsx(os,{className:"h-3 w-3 mr-1"}),""]})]})]},W.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Pa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:ge,onChange:W=>pe(W.target.value),onKeyDown:W=>W.key==="Enter"&&rs(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:rs,disabled:!ge,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ia,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(jk,{jargon:M,open:I,onOpenChange:E}),e.jsx(vk,{open:H,onOpenChange:O,chatList:B,onSuccess:()=>{_e(),he(),O(!1)}}),e.jsx(Nk,{jargon:M,open:C,onOpenChange:R,chatList:B,onSuccess:()=>{_e(),he(),R(!1)}}),e.jsx(bs,{open:!!X,onOpenChange:()=>L(null),children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',X?.content,'" ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>X&&z(X),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(bs,{open:je,onOpenChange:ce,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",me.size," "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:se,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function jk({jargon:a,open:l,onOpenChange:r}){return a?e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsx(ts,{className:"h-full pr-4",children:e.jsxs("div",{className:"space-y-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Vm,{icon:Xr,label:"ID",value:a.id.toString(),mono:!0}),e.jsx(Vm,{label:"",value:a.count.toString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all whitespace-pre-wrap",children:a.content})]}),a.raw_content&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:(()=>{try{const c=JSON.parse(a.raw_content);return Array.isArray(c)?c.map((d,m)=>e.jsxs("div",{children:[m>0&&e.jsx("hr",{className:"my-3 border-border"}),e.jsx("div",{className:"whitespace-pre-wrap",children:d})]},m)):e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}catch{return e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}})()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:a.meaning?e.jsx(jx,{content:a.meaning}):"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Vm,{label:"",value:a.chat_name||a.chat_id}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.is_jargon===!0&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),a.is_jargon===!1&&e.jsx(ke,{variant:"secondary",children:""}),a.is_jargon===null&&e.jsx(ke,{variant:"outline",children:""}),a.is_global&&e.jsx(ke,{variant:"outline",className:"border-blue-500 text-blue-500",children:""}),a.is_complete&&e.jsx(ke,{variant:"outline",className:"border-purple-500 text-purple-500",children:""})]})]})]}),a.inference_with_context&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_with_context})]}),a.inference_content_only&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_content_only})]})]})}),e.jsx(ft,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})}):null}function Vm({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function vk({open:a,onOpenChange:l,chatList:r,onSuccess:c}){const[d,m]=u.useState({content:"",meaning:"",chat_id:"",is_global:!1}),[h,f]=u.useState(!1),{toast:p}=nt(),g=async()=>{if(!d.content||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await uk(d),p({title:"",description:""}),m({content:"",meaning:"",chat_id:"",is_global:!1}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Qs,{open:a,onOpenChange:l,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"content",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"content",value:d.content,onChange:N=>m({...d,content:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"meaning",children:""}),e.jsx(ht,{id:"meaning",value:d.meaning||"",onChange:N=>m({...d,meaning:N.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Ie,{value:d.chat_id,onValueChange:N=>m({...d,chat_id:N}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Pe,{children:r.map(N=>e.jsx(Z,{value:N.chat_id,children:N.chat_name},N.chat_id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"is_global",checked:d.is_global,onCheckedChange:N=>m({...d,is_global:N})}),e.jsx(T,{htmlFor:"is_global",children:""})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function Nk({jargon:a,open:l,onOpenChange:r,chatList:c,onSuccess:d}){const[m,h]=u.useState({}),[f,p]=u.useState(!1),{toast:g}=nt();u.useEffect(()=>{a&&h({content:a.content,meaning:a.meaning||"",chat_id:a.stream_id||a.chat_id,is_global:a.is_global,is_jargon:a.is_jargon})},[a]);const N=async()=>{if(a)try{p(!0),await mk(a.id,m),g({title:"",description:""}),d()}catch(j){g({title:"",description:j instanceof Error?j.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_content",children:""}),e.jsx(le,{id:"edit_content",value:m.content||"",onChange:j=>h({...m,content:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_meaning",children:""}),e.jsx(ht,{id:"edit_meaning",value:m.meaning||"",onChange:j=>h({...m,meaning:j.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Ie,{value:m.chat_id||"",onValueChange:j=>h({...m,chat_id:j}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Pe,{children:c.map(j=>e.jsx(Z,{value:j.chat_id,children:j.chat_name},j.chat_id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:m.is_jargon===null?"null":m.is_jargon?.toString()||"null",onValueChange:j=>h({...m,is_jargon:j==="null"?null:j==="true"}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"null",children:""}),e.jsx(Z,{value:"true",children:""}),e.jsx(Z,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"edit_is_global",checked:m.is_global,onCheckedChange:j=>h({...m,is_global:j})}),e.jsx(T,{htmlFor:"edit_is_global",children:""})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}const ti="/api/webui/person";async function bk(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.is_known!==void 0&&l.append("is_known",a.is_known.toString()),a.platform&&l.append("platform",a.platform);const r=await Se(`${ti}/list?${l}`,{headers:Zs()});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function yk(a){const l=await Se(`${ti}/${a}`,{headers:Zs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function wk(a,l){const r=await Se(`${ti}/${a}`,{method:"PATCH",headers:Zs(),body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function _k(a){const l=await Se(`${ti}/${a}`,{method:"DELETE",headers:Zs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function Sk(){const a=await Se(`${ti}/stats/summary`,{headers:Zs()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function kk(a){const l=await Se(`${ti}/batch/delete`,{method:"POST",headers:Zs(),body:JSON.stringify({person_ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function Ck(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(1),[p,g]=u.useState(20),[N,j]=u.useState(""),[b,y]=u.useState(void 0),[w,A]=u.useState(void 0),[M,S]=u.useState(null),[I,E]=u.useState(!1),[C,R]=u.useState(!1),[H,O]=u.useState(null),[X,L]=u.useState({total:0,known:0,unknown:0,platforms:{}}),[me,Ne]=u.useState(new Set),[je,ce]=u.useState(!1),[ge,pe]=u.useState(""),{toast:D}=nt(),Q=async()=>{try{c(!0);const se=await bk({page:h,page_size:p,search:N||void 0,is_known:b,platform:w});l(se.data),m(se.total)}catch(se){D({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{c(!1)}},B=async()=>{try{const se=await Sk();se?.data&&L(se.data)}catch(se){console.error(":",se)}};u.useEffect(()=>{Q(),B()},[h,p,N,b,w]);const ue=async se=>{try{const Le=await yk(se.person_id);S(Le.data),E(!0)}catch(Le){D({title:"",description:Le instanceof Error?Le.message:"",variant:"destructive"})}},Y=se=>{S(se),R(!0)},_e=async se=>{try{await _k(se.person_id),D({title:"",description:`: ${se.person_name||se.nickname||se.user_id}`}),O(null),Q(),B()}catch(Le){D({title:"",description:Le instanceof Error?Le.message:"",variant:"destructive"})}},he=u.useMemo(()=>Object.keys(X.platforms),[X.platforms]),Te=se=>{const Le=new Set(me);Le.has(se)?Le.delete(se):Le.add(se),Ne(Le)},G=()=>{me.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(se=>se.person_id)))},$=()=>{if(me.size===0){D({title:"",description:"",variant:"destructive"});return}ce(!0)},z=async()=>{try{const se=await kk(Array.from(me));D({title:"",description:se.message}),Ne(new Set),ce(!1),Q(),B()}catch(se){D({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}},K=()=>{const se=parseInt(ge),Le=Math.ceil(d/p);se>=1&&se<=Le?(f(se),pe("")):D({title:"",description:`1-${Le}`,variant:"destructive"})},De=se=>se?new Date(se*1e3).toLocaleString("zh-CN"):"-";return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ic,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(ts,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:X.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:X.known})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-muted-foreground",children:X.unknown})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative mt-1.5",children:[e.jsx(Ut,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(le,{id:"search",placeholder:"ID...",value:N,onChange:se=>j(se.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-known",children:""}),e.jsxs(Ie,{value:b===void 0?"all":b.toString(),onValueChange:se=>{y(se==="all"?void 0:se==="true"),f(1)},children:[e.jsx(Be,{id:"filter-known",className:"mt-1.5",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"true",children:""}),e.jsx(Z,{value:"false",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-platform",children:""}),e.jsxs(Ie,{value:w||"all",onValueChange:se=>{A(se==="all"?void 0:se),f(1)},children:[e.jsx(Be,{id:"filter-platform",className:"mt-1.5",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),he.map(se=>e.jsxs(Z,{value:se,children:[se," (",X.platforms[se],")"]},se))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:me.size>0&&e.jsxs("span",{children:[" ",me.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:se=>{g(parseInt(se)),f(1),Ne(new Set)},children:[e.jsx(Be,{id:"page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"10",children:"10"}),e.jsx(Z,{value:"20",children:"20"}),e.jsx(Z,{value:"50",children:"50"}),e.jsx(Z,{value:"100",children:"100"})]})]}),me.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:$,children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{className:"w-12",children:e.jsx(tt,{checked:a.length>0&&me.size===a.length,onCheckedChange:G,"aria-label":""})}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:"ID"}),e.jsx(ns,{children:""}),e.jsx(ns,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r?e.jsx(wt,{children:e.jsx(Je,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(wt,{children:e.jsx(Je,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(se=>e.jsxs(wt,{children:[e.jsx(Je,{children:e.jsx(tt,{checked:me.has(se.person_id),onCheckedChange:()=>Te(se.person_id),"aria-label":` ${se.person_name||se.nickname||se.user_id}`})}),e.jsx(Je,{children:e.jsx("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",se.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:se.is_known?"":""})}),e.jsx(Je,{className:"font-medium",children:se.person_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Je,{children:se.nickname||"-"}),e.jsx(Je,{children:se.platform}),e.jsx(Je,{className:"font-mono text-sm",children:se.user_id}),e.jsx(Je,{className:"text-sm text-muted-foreground",children:De(se.last_know)}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>ue(se),children:[e.jsx(oa,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>Y(se),children:[e.jsx(Wn,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>O(se),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]})]})})]},se.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(se=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(tt,{checked:me.has(se.person_id),onCheckedChange:()=>Te(se.person_id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium mb-2",se.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:se.is_known?"":""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-1 w-full break-all",children:se.person_name||e.jsx("span",{className:"text-muted-foreground",children:""})}),se.nickname&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1 w-full break-all",children:[": ",se.nickname]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"font-medium text-xs",children:se.platform})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ID"}),e.jsx("p",{className:"font-mono text-xs truncate",title:se.user_id,children:se.user_id})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-xs",children:De(se.last_know)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>ue(se),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(oa,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Y(se),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Wn,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>O(se),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(os,{className:"h-3 w-3 mr-1"}),""]})]})]},se.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Pa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:ge,onChange:se=>pe(se.target.value),onKeyDown:se=>se.key==="Enter"&&K(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:K,disabled:!ge,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ia,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(Tk,{person:M,open:I,onOpenChange:E}),e.jsx(Ek,{person:M,open:C,onOpenChange:R,onSuccess:()=>{Q(),B(),R(!1)}}),e.jsx(bs,{open:!!H,onOpenChange:()=>O(null),children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[' "',H?.person_name||H?.nickname||H?.user_id,'"  ']})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:()=>H&&_e(H),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(bs,{open:je,onOpenChange:ce,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:[" ",me.size,"  "]})]}),e.jsxs(fs,{children:[e.jsx(vs,{children:""}),e.jsx(js,{onClick:z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function Tk({person:a,open:l,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsxs(at,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ol,{icon:$l,label:"",value:a.person_name}),e.jsx(Ol,{icon:Ba,label:"",value:a.nickname}),e.jsx(Ol,{icon:Xr,label:"ID",value:a.user_id,mono:!0}),e.jsx(Ol,{icon:Xr,label:"ID",value:a.person_id,mono:!0}),e.jsx(Ol,{label:"",value:a.platform}),e.jsx(Ol,{label:"",value:a.is_known?"":""})]}),a.name_reason&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm",children:a.name_reason})]}),a.memory_points&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:a.memory_points})]}),a.group_nick_name&&a.group_nick_name.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:a.group_nick_name.map((d,m)=>e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:d.group_id}),e.jsx("span",{children:""}),e.jsx("span",{children:d.group_nick_name})]},m))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Ol,{icon:ca,label:"",value:c(a.know_times)}),e.jsx(Ol,{icon:ca,label:"",value:c(a.know_since)}),e.jsx(Ol,{icon:ca,label:"",value:c(a.last_know)})]})]}),e.jsx(ft,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Ol({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function Ek({person:a,open:l,onOpenChange:r,onSuccess:c}){const[d,m]=u.useState({}),[h,f]=u.useState(!1),{toast:p}=nt();u.useEffect(()=>{a&&m({person_name:a.person_name||"",name_reason:a.name_reason||"",nickname:a.nickname||"",is_known:a.is_known})},[a]);const g=async()=>{if(a)try{f(!0),await wk(a.person_id,d),p({title:"",description:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return a?e.jsx(Qs,{open:l,onOpenChange:r,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsxs(at,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"person_name",children:""}),e.jsx(le,{id:"person_name",value:d.person_name||"",onChange:N=>m({...d,person_name:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(le,{id:"nickname",value:d.nickname||"",onChange:N=>m({...d,nickname:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"name_reason",children:""}),e.jsx(ht,{id:"name_reason",value:d.name_reason||"",onChange:N=>m({...d,name_reason:N.target.value}),placeholder:"",rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"is_known",className:"text-base font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ve,{id:"is_known",checked:d.is_known,onCheckedChange:N=>m({...d,is_known:N})})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})}):null}var Mk=v_();const Zg=iw(Mk),kx="/api/webui";async function Ak(a=100,l="all"){const r=`${kx}/knowledge/graph?limit=${a}&node_type=${l}`,c=await fetch(r);if(!c.ok)throw new Error(`: ${c.status}`);return c.json()}async function zk(){const a=await fetch(`${kx}/knowledge/stats`);if(!a.ok)throw new Error("");return a.json()}async function Rk(a){const l=await fetch(`${kx}/knowledge/search?query=${encodeURIComponent(a)}`);if(!l.ok)throw new Error("");return l.json()}const lN=u.memo(({data:a})=>e.jsxs("div",{className:"px-4 py-2 shadow-md rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700 min-w-[120px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-semibold text-white text-sm truncate max-w-[200px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));lN.displayName="EntityNode";const nN=u.memo(({data:a})=>e.jsxs("div",{className:"px-3 py-2 shadow-md rounded-md bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700 min-w-[100px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-medium text-white text-xs truncate max-w-[150px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));nN.displayName="ParagraphNode";const Dk={entity:lN,paragraph:nN};function Ok(a,l){const r=new Zg.graphlib.Graph;r.setDefaultEdgeLabel(()=>({})),r.setGraph({rankdir:"TB",ranksep:100,nodesep:80});const c=[],d=[];return a.forEach(m=>{r.setNode(m.id,{width:150,height:50})}),l.forEach(m=>{r.setEdge(m.source,m.target)}),Zg.layout(r),a.forEach(m=>{const h=r.node(m.id);c.push({id:m.id,type:m.type,position:{x:h.x-75,y:h.y-25},data:{label:m.content.slice(0,20)+(m.content.length>20?"...":""),content:m.content}})}),l.forEach((m,h)=>{const f={id:`edge-${h}`,source:m.source,target:m.target,animated:a.length<=200&&m.weight>5,style:{strokeWidth:Math.min(m.weight/2,5),opacity:.6}};m.weight>10&&a.length<100&&(f.label=`${m.weight.toFixed(0)}`),d.push(f)}),{nodes:c,edges:d}}function Lk(){const a=ha(),[l,r]=u.useState(!1),[c,d]=u.useState(null),[m,h]=u.useState(""),[f,p]=u.useState("all"),[g,N]=u.useState(50),[j,b]=u.useState("50"),[y,w]=u.useState(!1),[A,M]=u.useState(!0),[S,I]=u.useState(!1),[E,C]=u.useState(!1),[R,H,O]=N_([]),[X,L,me]=b_([]),[Ne,je]=u.useState(0),[ce,ge]=u.useState(null),[pe,D]=u.useState(null),{toast:Q}=nt(),B=u.useCallback(z=>z.type==="entity"?"#6366f1":z.type==="paragraph"?"#10b981":"#6b7280",[]),ue=u.useCallback(async(z=!1)=>{try{if(!z&&g>200){C(!0);return}r(!0);const[K,De]=await Promise.all([Ak(g,f),zk()]);if(d(De),K.nodes.length===0){Q({title:"",description:""}),H([]),L([]);return}const{nodes:se,edges:Le}=Ok(K.nodes,K.edges);H(se),L(Le),je(se.length),De&&De.total_nodes>g&&Q({title:"",description:` ${De.total_nodes}  ${se.length} `}),Q({title:"",description:` ${se.length} ${Le.length} `})}catch(K){console.error(":",K),Q({title:"",description:K instanceof Error?K.message:"",variant:"destructive"})}finally{r(!1)}},[g,f,Q]),Y=u.useCallback(async()=>{if(!m.trim()){Q({title:"",description:""});return}try{const z=await Rk(m);if(z.length===0){Q({title:"",description:""});return}const K=new Set(z.map(De=>De.id));H(De=>De.map(se=>({...se,style:{...se.style,opacity:K.has(se.id)?1:.3,filter:K.has(se.id)?"brightness(1.2)":"brightness(0.8)"}}))),Q({title:"",description:` ${z.length} `})}catch(z){console.error(":",z),Q({title:"",description:z instanceof Error?z.message:"",variant:"destructive"})}},[m,Q]),_e=u.useCallback(()=>{H(z=>z.map(K=>({...K,style:{...K.style,opacity:1,filter:"brightness(1)"}})))},[]),he=u.useCallback(()=>{M(!1),I(!0),ue()},[ue]),Te=u.useCallback(()=>{C(!1),setTimeout(()=>{ue(!0)},0)},[ue]),G=u.useCallback((z,K)=>{R.find(se=>se.id===K.id)&&ge({id:K.id,type:K.type,content:K.data.content})},[R]);u.useEffect(()=>{A||S&&ue()},[g,f,A,S]);const $=u.useCallback((z,K)=>{const De=R.find(rs=>rs.id===K.source),se=R.find(rs=>rs.id===K.target),Le=X.find(rs=>rs.id===K.id);De&&se&&Le&&D({source:{id:De.id,type:De.type,content:De.data.content},target:{id:se.id,type:se.type,content:se.data.content},edge:{source:K.source,target:K.target,weight:parseFloat(K.label||"0")}})},[R,X]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b bg-background",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1",children:""})]}),c&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Jr,{className:"h-3 w-3"}),": ",c.total_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(dv,{className:"h-3 w-3"}),": ",c.total_edges]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Yt,{className:"h-3 w-3"}),": ",c.entity_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(La,{className:"h-3 w-3"}),": ",c.paragraph_nodes]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(le,{placeholder:"...",value:m,onChange:z=>h(z.target.value),onKeyDown:z=>z.key==="Enter"&&Y(),className:"flex-1"}),e.jsx(_,{onClick:Y,size:"sm",children:e.jsx(Ut,{className:"h-4 w-4"})}),e.jsx(_,{onClick:_e,variant:"outline",size:"sm",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ie,{value:f,onValueChange:z=>p(z),children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"entity",children:""}),e.jsx(Z,{value:"paragraph",children:""})]})]}),e.jsxs(Ie,{value:g===1e4?"all":y?"custom":g.toString(),onValueChange:z=>{z==="custom"?(w(!0),b(g.toString())):z==="all"?(w(!1),N(1e4)):(w(!1),N(Number(z)))},children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"50",children:"50 "}),e.jsx(Z,{value:"100",children:"100 "}),e.jsx(Z,{value:"200",children:"200 "}),e.jsx(Z,{value:"500",children:"500 "}),e.jsx(Z,{value:"1000",children:"1000 "}),e.jsx(Z,{value:"all",children:" (10000)"}),e.jsx(Z,{value:"custom",children:"..."})]})]}),y&&e.jsx(le,{type:"number",min:"50",value:j,onChange:z=>b(z.target.value),onBlur:()=>{const z=parseInt(j);!isNaN(z)&&z>=50?N(z):(b("50"),N(50))},onKeyDown:z=>{if(z.key==="Enter"){const K=parseInt(j);!isNaN(K)&&K>=50?N(K):(b("50"),N(50))}},placeholder:"50",className:"w-[120px]"}),e.jsx(_,{onClick:()=>ue(),variant:"outline",size:"sm",disabled:l,children:e.jsx(mt,{className:F("h-4 w-4",l&&"animate-spin")})})]})]})]}),e.jsx("div",{className:"flex-1 relative",children:l?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(mt,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):R.length===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]})}):e.jsxs(y_,{nodes:R,edges:X,onNodesChange:O,onEdgesChange:me,onNodeClick:G,onEdgeClick:$,nodeTypes:Dk,fitView:!0,minZoom:.05,maxZoom:1.5,defaultViewport:{x:0,y:0,zoom:.5},elevateNodesOnSelect:Ne<=500,nodesDraggable:Ne<=1e3,attributionPosition:"bottom-left",children:[e.jsx(w_,{variant:__.Dots,gap:12,size:1}),e.jsx(S_,{}),Ne<=500&&e.jsx(k_,{nodeColor:B,nodeBorderRadius:8,pannable:!0,zoomable:!0}),e.jsxs(C_,{position:"top-right",className:"bg-background/95 backdrop-blur-sm rounded-lg border p-3 shadow-lg",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:""}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700"}),e.jsx("span",{children:""})]}),Ne>200&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-yellow-600 dark:text-yellow-500",children:[e.jsx("div",{className:"font-semibold",children:""}),e.jsx("div",{children:""}),Ne>500&&e.jsx("div",{children:""})]})]})]})]})}),e.jsx(Qs,{open:!!ce,onOpenChange:z=>!z&&ge(null),children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(qs,{children:e.jsx(Vs,{children:""})}),ce&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:ce.type==="entity"?"default":"secondary",children:ce.type==="entity"?" ":" "})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ID"}),e.jsx("code",{className:"mt-1 block p-2 bg-muted rounded text-xs break-all",children:ce.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx(ts,{className:"mt-1 h-40 p-3 bg-muted rounded",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:ce.content})})]})]})]})}),e.jsx(Qs,{open:!!pe,onOpenChange:z=>!z&&D(null),children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx(qs,{children:e.jsx(Vs,{children:""})}),pe&&e.jsx(ts,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-blue-50 dark:bg-blue-950 rounded border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:pe.source.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[pe.source.id.slice(0,40),"..."]})]}),e.jsx("div",{className:"text-2xl text-muted-foreground flex-shrink-0",children:""}),e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-green-50 dark:bg-green-950 rounded border-2 border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:pe.target.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[pe.target.id.slice(0,40),"..."]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",className:"text-base font-mono",children:pe.edge.weight.toFixed(4)})})]})]})})]})}),e.jsx(bs,{open:A,onOpenChange:M,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:""}),e.jsxs(gs,{children:["",e.jsx("br",{}),"?"]})]}),e.jsxs(fs,{children:[e.jsx(vs,{onClick:()=>a({to:"/"}),children:" ()"}),e.jsx(js,{onClick:he,children:""})]})]})}),e.jsx(bs,{open:E,onOpenChange:C,children:e.jsxs(xs,{children:[e.jsxs(hs,{children:[e.jsx(ps,{children:" "}),e.jsx(gs,{asChild:!0,children:e.jsxs("div",{children:[e.jsxs("p",{children:[" ",e.jsx("strong",{className:"text-orange-600",children:g>=1e4?" (10000)":g})," "]}),e.jsx("p",{className:"mt-4",children:":"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"mt-4",children:" (50-200 )"})]})})]}),e.jsxs(fs,{children:[e.jsx(vs,{onClick:()=>{C(!1),g>200&&(N(50),w(!1))},children:""}),e.jsx(js,{onClick:Te,className:"bg-orange-600 hover:bg-orange-700",children:""})]})]})})]})}function Uk(){return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-none border-b bg-card/50 px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:""})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"mx-auto max-w-4xl",children:e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Jr,{className:"h-10 w-10 text-primary"})}),e.jsx($e,{className:"text-2xl",children:""}),e.jsx(Ns,{className:"text-base",children:""})]}),e.jsx(ze,{className:"text-center text-sm text-muted-foreground",children:e.jsx("p",{children:""})})]})})})]})}function Wg({className:a,classNames:l,showOutsideDays:r=!0,captionLayout:c="label",buttonVariant:d="ghost",formatters:m,components:h,...f}){const p=kv();return e.jsx(m_,{showOutsideDays:r,className:F("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,a),captionLayout:c,formatters:{formatMonthDropdown:g=>g.toLocaleString("default",{month:"short"}),...m},classNames:{root:F("w-fit",p.root),months:F("relative flex flex-col gap-4 md:flex-row",p.months),month:F("flex w-full flex-col gap-4",p.month),nav:F("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",p.nav),button_previous:F(Wr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_previous),button_next:F(Wr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_next),month_caption:F("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",p.month_caption),dropdowns:F("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",p.dropdowns),dropdown_root:F("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",p.dropdown_root),dropdown:F("bg-popover absolute inset-0 opacity-0",p.dropdown),caption_label:F("select-none font-medium",c==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",p.caption_label),table:"w-full border-collapse",weekdays:F("flex",p.weekdays),weekday:F("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",p.weekday),week:F("mt-2 flex w-full",p.week),week_number_header:F("w-[--cell-size] select-none",p.week_number_header),week_number:F("text-muted-foreground select-none text-[0.8rem]",p.week_number),day:F("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",p.day),range_start:F("bg-accent rounded-l-md",p.range_start),range_middle:F("rounded-none",p.range_middle),range_end:F("bg-accent rounded-r-md",p.range_end),today:F("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",p.today),outside:F("text-muted-foreground aria-selected:text-muted-foreground",p.outside),disabled:F("text-muted-foreground opacity-50",p.disabled),hidden:F("invisible",p.hidden),...l},components:{Root:({className:g,rootRef:N,...j})=>e.jsx("div",{"data-slot":"calendar",ref:N,className:F(g),...j}),Chevron:({className:g,orientation:N,...j})=>N==="left"?e.jsx(Pa,{className:F("size-4",g),...j}):N==="right"?e.jsx(ia,{className:F("size-4",g),...j}):e.jsx($a,{className:F("size-4",g),...j}),DayButton:$k,WeekNumber:({children:g,...N})=>e.jsx("td",{...N,children:e.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:g})}),...h},...f})}function $k({className:a,day:l,modifiers:r,...c}){const d=kv(),m=u.useRef(null);return u.useEffect(()=>{r.focused&&m.current?.focus()},[r.focused]),e.jsx(_,{ref:m,variant:"ghost",size:"icon","data-day":l.date.toLocaleDateString(),"data-selected-single":r.selected&&!r.range_start&&!r.range_end&&!r.range_middle,"data-range-start":r.range_start,"data-range-end":r.range_end,"data-range-middle":r.range_middle,className:F("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",d.day,a),...c})}const Oo={xs:{label:"",rowHeight:28,class:"text-[10px] sm:text-xs"},sm:{label:"",rowHeight:36,class:"text-xs sm:text-sm"},base:{label:"",rowHeight:44,class:"text-sm sm:text-base"}};function Bk(){const[a,l]=u.useState([]),[r,c]=u.useState(""),[d,m]=u.useState("all"),[h,f]=u.useState("all"),[p,g]=u.useState(void 0),[N,j]=u.useState(void 0),[b,y]=u.useState(!0),[w,A]=u.useState(!1),[M,S]=u.useState("xs"),[I,E]=u.useState(4),[C,R]=u.useState(!1),H=u.useRef(null);u.useEffect(()=>{const Y=Gn.getAllLogs();l(Y);const _e=Gn.onLog(()=>{l(Gn.getAllLogs())}),he=Gn.onConnectionChange(Te=>{A(Te)});return()=>{_e(),he()}},[]);const O=u.useMemo(()=>{const Y=new Set(a.map(_e=>_e.module).filter(_e=>_e&&_e.trim()!==""));return Array.from(Y).sort()},[a]),X=Y=>{switch(Y){case"DEBUG":return"text-muted-foreground";case"INFO":return"text-blue-500 dark:text-blue-400";case"WARNING":return"text-yellow-600 dark:text-yellow-500";case"ERROR":return"text-red-600 dark:text-red-500";case"CRITICAL":return"text-red-700 dark:text-red-400 font-bold";default:return"text-foreground"}},L=Y=>{switch(Y){case"DEBUG":return"bg-gray-800/30 dark:bg-gray-800/50";case"INFO":return"bg-blue-900/20 dark:bg-blue-500/20";case"WARNING":return"bg-yellow-900/20 dark:bg-yellow-500/20";case"ERROR":return"bg-red-900/20 dark:bg-red-500/20";case"CRITICAL":return"bg-red-900/30 dark:bg-red-600/30";default:return"bg-gray-800/20 dark:bg-gray-800/30"}},me=()=>{window.location.reload()},Ne=()=>{Gn.clearLogs(),l([])},je=()=>{const Y=pe.map(G=>`${G.timestamp} [${G.level.padEnd(8)}] [${G.module}] ${G.message}`).join(`
`),_e=new Blob([Y],{type:"text/plain;charset=utf-8"}),he=URL.createObjectURL(_e),Te=document.createElement("a");Te.href=he,Te.download=`logs-${Tm(new Date,"yyyy-MM-dd-HHmmss")}.txt`,Te.click(),URL.revokeObjectURL(he)},ce=()=>{y(!b)},ge=()=>{g(void 0),j(void 0)},pe=u.useMemo(()=>a.filter(Y=>{const _e=r===""||Y.message.toLowerCase().includes(r.toLowerCase())||Y.module.toLowerCase().includes(r.toLowerCase()),he=d==="all"||Y.level===d,Te=h==="all"||Y.module===h;let G=!0;if(p||N){const $=new Date(Y.timestamp);if(p){const z=new Date(p);z.setHours(0,0,0,0),G=G&&$>=z}if(N){const z=new Date(N);z.setHours(23,59,59,999),G=G&&$<=z}}return _e&&he&&Te&&G}),[a,r,d,h,p,N]),D=Oo[M].rowHeight+I,Q=Z0({count:pe.length,getScrollElement:()=>H.current,estimateSize:()=>D,overscan:50}),B=u.useRef(!1),ue=u.useRef(pe.length);return u.useEffect(()=>{const Y=H.current;if(!Y)return;const _e=()=>{if(B.current)return;const{scrollTop:he,scrollHeight:Te,clientHeight:G}=Y,$=Te-he-G;$>100&&b?y(!1):$<50&&!b&&y(!0)};return Y.addEventListener("scroll",_e,{passive:!0}),()=>Y.removeEventListener("scroll",_e)},[b]),u.useEffect(()=>{const Y=pe.length>ue.current;ue.current=pe.length,b&&pe.length>0&&Y&&(B.current=!0,Q.scrollToIndex(pe.length-1,{align:"end",behavior:"auto"}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{B.current=!1})}))},[pe.length,b,Q]),e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 space-y-2 sm:space-y-3 p-2 sm:p-3 lg:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 hidden sm:block",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("h-2 w-2 sm:h-2.5 sm:w-2.5 rounded-full",w?"bg-green-500 animate-pulse":"bg-red-500")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:w?"":""})]})]}),e.jsx(Ce,{className:"p-2 sm:p-3",children:e.jsx(uc,{open:C,onOpenChange:R,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(Ut,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:r,onChange:Y=>c(Y.target.value),className:"pl-8 h-8 text-xs sm:text-sm"})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:b?"default":"outline",size:"sm",onClick:ce,className:"h-8 px-2",title:b?"":"",children:[b?e.jsx(L1,{className:"h-3.5 w-3.5"}):e.jsx(U1,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden sm:inline",children:b?"":""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:Ne,className:"h-8 px-2",title:"",children:[e.jsx(os,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden md:inline",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"h-8 px-2 hidden sm:flex",title:"",children:[e.jsx(ra,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden lg:inline",children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"h-8 px-2",title:C?"":"",children:[e.jsx(Bo,{className:"h-3.5 w-3.5"}),C?e.jsx(Yr,{className:"h-3.5 w-3.5 ml-1"}):e.jsx($a,{className:"h-3.5 w-3.5 ml-1"})]})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center sm:text-right -mt-1",children:[e.jsxs("span",{className:"font-mono",children:[pe.length," / ",a.length]}),e.jsx("span",{className:"ml-1",children:""})]}),e.jsxs(xc,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(Ie,{value:d,onValueChange:m,children:[e.jsxs(Be,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Fe,{placeholder:""})]}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"DEBUG",children:"DEBUG"}),e.jsx(Z,{value:"INFO",children:"INFO"}),e.jsx(Z,{value:"WARNING",children:"WARNING"}),e.jsx(Z,{value:"ERROR",children:"ERROR"}),e.jsx(Z,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsxs(Ie,{value:h,onValueChange:f,children:[e.jsxs(Be,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Fe,{placeholder:""})]}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),O.map(Y=>e.jsx(Z,{value:Y,children:Y},Y))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:F("w-full sm:flex-1 justify-start text-left font-normal h-8",!p&&"text-muted-foreground"),children:[e.jsx(Vo,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:p?Tm(p,"PP",{locale:Ro}):""})]})}),e.jsx(sl,{className:"w-auto p-0",align:"start",children:e.jsx(Wg,{mode:"single",selected:p,onSelect:g,initialFocus:!0,locale:Ro})})]}),e.jsxs(rl,{children:[e.jsx(il,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:F("w-full sm:flex-1 justify-start text-left font-normal h-8",!N&&"text-muted-foreground"),children:[e.jsx(Vo,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:N?Tm(N,"PP",{locale:Ro}):""})]})}),e.jsx(sl,{className:"w-auto p-0",align:"start",children:e.jsx(Wg,{mode:"single",selected:N,onSelect:j,initialFocus:!0,locale:Ro})})]}),(p||N)&&e.jsxs(_,{variant:"outline",size:"sm",onClick:ge,className:"w-full sm:w-auto h-8",children:[e.jsx(Sa,{className:"h-3.5 w-3.5 sm:mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3 pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx($1,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:""})]}),e.jsx("div",{className:"flex gap-1",children:Object.keys(Oo).map(Y=>e.jsx(_,{variant:M===Y?"default":"outline",size:"sm",onClick:()=>S(Y),className:"h-6 px-2 text-xs",children:Oo[Y].label},Y))})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:""}),e.jsx(Wa,{value:[I],onValueChange:([Y])=>E(Y),min:0,max:12,step:2,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-7",children:[I,"px"]})]}),e.jsxs("div",{className:"flex gap-2 sm:hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:me,className:"flex-1 h-8",children:[e.jsx(mt,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"flex-1 h-8",children:[e.jsx(ra,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]})]})]})]})})})]}),e.jsx("div",{className:"flex-1 min-h-0 px-2 sm:px-3 lg:px-4 pb-2 sm:pb-3 lg:pb-4",children:e.jsx(Ce,{className:"bg-black dark:bg-gray-950 border-gray-800 dark:border-gray-900 h-full overflow-hidden",children:e.jsx("div",{ref:H,className:F("h-full overflow-auto","[&::-webkit-scrollbar]:w-2.5","[&::-webkit-scrollbar-track]:bg-transparent","[&::-webkit-scrollbar-thumb]:bg-border [&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-thumb:hover]:bg-border/80"),children:e.jsx("div",{className:F("p-2 sm:p-3 font-mono relative",Oo[M].class),style:{height:`${Q.getTotalSize()}px`},children:pe.length===0?e.jsx("div",{className:"text-gray-500 dark:text-gray-600 text-center py-8 text-xs sm:text-sm",children:""}):Q.getVirtualItems().map(Y=>{const _e=pe[Y.index];return e.jsxs("div",{"data-index":Y.index,ref:Q.measureElement,className:F("absolute top-0 left-0 w-full px-2 sm:px-3 rounded hover:bg-white/5 transition-colors",L(_e.level)),style:{transform:`translateY(${Y.start}px)`,paddingTop:`${I/2}px`,paddingBottom:`${I/2}px`},children:[e.jsxs("div",{className:"flex flex-col gap-0.5 sm:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 text-[10px]",children:_e.timestamp}),e.jsxs("span",{className:F("font-semibold text-[10px]",X(_e.level)),children:["[",_e.level,"]"]})]}),e.jsx("div",{className:"text-cyan-400 dark:text-cyan-500 truncate text-[10px]",children:_e.module}),e.jsx("div",{className:"text-gray-300 dark:text-gray-400 whitespace-pre-wrap break-words text-[10px]",children:_e.message})]}),e.jsxs("div",{className:"hidden sm:flex gap-2 items-start",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 flex-shrink-0 w-[130px] lg:w-[160px]",children:_e.timestamp}),e.jsxs("span",{className:F("flex-shrink-0 w-[65px] lg:w-[75px] font-semibold",X(_e.level)),children:["[",_e.level,"]"]}),e.jsx("span",{className:"text-cyan-400 dark:text-cyan-500 flex-shrink-0 w-[100px] lg:w-[130px] truncate",children:_e.module}),e.jsx("span",{className:"text-gray-300 dark:text-gray-400 flex-1 whitespace-pre-wrap break-words",children:_e.message})]})]},Y.key)})})})})})]})}async function Pk(){return(await Se("/api/planner/overview")).json()}async function Ik(a,l=1,r=20,c){const d=new URLSearchParams({page:l.toString(),page_size:r.toString()});return c&&d.append("search",c),(await Se(`/api/planner/chat/${a}/logs?${d}`)).json()}async function Fk(a,l){return(await Se(`/api/planner/log/${a}/${l}`)).json()}async function Hk(){return(await Se("/api/replier/overview")).json()}async function qk(a,l=1,r=20,c){const d=new URLSearchParams({page:l.toString(),page_size:r.toString()});return c&&d.append("search",c),(await Se(`/api/replier/chat/${a}/logs?${d}`)).json()}async function Vk(a,l){return(await Se(`/api/replier/log/${a}/${l}`)).json()}function rN(){const[a,l]=u.useState(new Map),[r,c]=u.useState(!0),d=u.useCallback(async()=>{try{c(!0);const h=await hx();if(h?.data){const f=new Map;h.data.forEach(p=>{f.set(p.chat_id,p.chat_name)}),l(f)}}catch(h){console.error(":",h)}finally{c(!1)}},[]);u.useEffect(()=>{d()},[d]);const m=u.useCallback(h=>a.get(h)||h,[a]);return{chatNameMap:a,getChatName:m,loading:r,reload:d}}function Jo(a){return new Date(a*1e3).toLocaleString("zh-CN")}function iN(a){const r=Date.now()/1e3-a;return r<60?"":r<3600?`${Math.floor(r/60)} `:r<86400?`${Math.floor(r/3600)} `:`${Math.floor(r/86400)} `}function cN(a,l,r=1e4){u.useEffect(()=>{if(!a)return;const c=setInterval(l,r);return()=>clearInterval(c)},[a,l,r])}function Gk({autoRefresh:a,refreshKey:l}){const[r,c]=u.useState("overview"),[d,m]=u.useState(null),{getChatName:h}=rN(),[f,p]=u.useState(null),[g,N]=u.useState(!0),[j,b]=u.useState(null),[y,w]=u.useState(!1),[A,M]=u.useState(1),[S,I]=u.useState(20),[E,C]=u.useState(""),[R,H]=u.useState(""),[O,X]=u.useState(""),[L,me]=u.useState(null),[Ne,je]=u.useState(!1),[ce,ge]=u.useState(!1),pe=u.useCallback(async()=>{try{N(!0);const $=await Pk();p($)}catch($){console.error(":",$)}finally{N(!1)}},[]),D=u.useCallback(async()=>{if(d)try{w(!0);const $=await Ik(d.chat_id,A,S,R||void 0);b($)}catch($){console.error(":",$)}finally{w(!1)}},[d,A,S,R]);u.useEffect(()=>{pe()},[pe]),u.useEffect(()=>{l>0&&(r==="overview"?pe():D())},[l,r,pe,D]),u.useEffect(()=>{r==="chat-logs"&&d&&D()},[r,d,D]),cN(a,u.useCallback(()=>{r==="overview"?pe():D()},[r,pe,D]));const Q=$=>{m($),M(1),H(""),X(""),c("chat-logs")},B=()=>{c("overview"),m(null),b(null),H(""),X("")},ue=()=>{H(O),M(1)},Y=()=>{X(""),H(""),M(1)},_e=async($,z)=>{try{ge(!0),je(!0);const K=await Fk($,z);me(K)}catch(K){console.error(":",K)}finally{ge(!1)}},he=$=>{I(Number($)),M(1)},Te=()=>{const $=parseInt(E),z=j?Math.ceil(j.total/j.page_size):0;!isNaN($)&&$>=1&&$<=z&&(M($),C(""))},G=j?Math.ceil(j.total/j.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(ze,{children:g?e.jsx(Ms,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(lx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(ze,{children:g?e.jsx(Ms,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_plans||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map(($,z)=>e.jsx(Ms,{className:"h-24 w-full"},z))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map($=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Q($),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h($.chat_id),children:h($.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:$.plan_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",iN($.latest_timestamp)]})]},$.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(Ua,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",j?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{placeholder:"...",value:O,onChange:$=>X($.target.value),onKeyDown:$=>$.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(Ut,{className:"h-4 w-4"})}),R&&e.jsx(_,{variant:"ghost",size:"sm",onClick:Y,children:""})]}),e.jsxs(Ie,{value:S.toString(),onValueChange:he,children:[e.jsx(Be,{className:"w-full sm:w-32",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"10",children:"10/"}),e.jsx(Z,{value:"20",children:"20/"}),e.jsx(Z,{value:"50",children:"50/"}),e.jsx(Z,{value:"100",children:"100/"})]})]})]})]}),R&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',R,'"']})]})]}),e.jsx(ze,{children:y?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map(($,z)=>e.jsx(Ms,{className:"h-20 w-full"},z))}):j?.data&&j.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:j.data.map($=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e($.chat_id,$.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo($.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[$.action_count," "]}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[$.total_plan_ms.toFixed(0),"ms"]})]})]}),$.action_types&&$.action_types.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:$.action_types.map((z,K)=>e.jsx(ke,{variant:"outline",className:"text-xs bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800",children:z},K))}),e.jsx("p",{className:"text-sm line-clamp-2",children:$.reasoning_preview||""})]},$.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",j.total,"  ",A," / ",G," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(1),disabled:A===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.max(1,$-1)),disabled:A===1,children:e.jsx(Pa,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(le,{type:"number",min:1,max:G,value:E,onChange:$=>C($.target.value),onKeyDown:$=>$.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[A,"/",G]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.min(G,$+1)),disabled:A===G,children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(G),disabled:A===G,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Qs,{open:Ne,onOpenChange:je,children:e.jsxs(Hs,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(La,{className:"h-5 w-5"}),""]}),e.jsx(at,{children:""})]}),e.jsx(ts,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:ce?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map(($,z)=>e.jsx(Ms,{className:"h-24 w-full"},z))}):L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ca,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:L.chat_id,children:h(L.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(L.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx(ke,{variant:"outline",children:L.type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{children:[L.actions.length," "]})]})]})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(Oe,{className:"p-4 pb-2",children:e.jsx($e,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(ze,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.prompt_build_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{className:"p-4 pb-2",children:e.jsx($e,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(ze,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.llm_duration_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{className:"p-4 pb-2",children:e.jsx($e,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(ze,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.total_plan_ms?.toFixed(2)||0,"ms"]})})]})]})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ux,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.reasoning||""})})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(tv,{className:"h-4 w-4"})," (",L.actions.length,")"]}),e.jsx("div",{className:"space-y-3",children:L.actions.map(($,z)=>e.jsxs(Ce,{children:[e.jsx(Oe,{className:"p-4 pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ke,{variant:"default",children:[" ",z+1]}),e.jsx(ke,{variant:"outline",children:$.action_type})]})})}),e.jsxs(ze,{className:"p-4 pt-0 space-y-3",children:[$.reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof $.reasoning=="string"?$.reasoning:JSON.stringify($.reasoning)})]}),$.action_message&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),typeof $.action_message=="string"?e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded break-all whitespace-pre-wrap",children:$.action_message}):e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify($.action_message,null,2)})]}),$.action_data&&Object.keys($.action_data).length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto",children:JSON.stringify($.action_data,null,2)})]}),$.action_reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof $.action_reasoning=="string"?$.action_reasoning:JSON.stringify($.action_reasoning)})]})]})]},z))})]}),e.jsx(na,{}),L.raw_output&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.raw_output})})]})]}),L.prompt&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.prompt})})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(ft,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function Kk({autoRefresh:a,refreshKey:l}){const[r,c]=u.useState("overview"),[d,m]=u.useState(null),{getChatName:h}=rN(),[f,p]=u.useState(null),[g,N]=u.useState(!0),[j,b]=u.useState(null),[y,w]=u.useState(!1),[A,M]=u.useState(1),[S,I]=u.useState(20),[E,C]=u.useState(""),[R,H]=u.useState(""),[O,X]=u.useState(""),[L,me]=u.useState(null),[Ne,je]=u.useState(!1),[ce,ge]=u.useState(!1),pe=u.useCallback(async()=>{try{N(!0);const $=await Hk();p($)}catch($){console.error(":",$)}finally{N(!1)}},[]),D=u.useCallback(async()=>{if(d)try{w(!0);const $=await qk(d.chat_id,A,S,R||void 0);b($)}catch($){console.error(":",$)}finally{w(!1)}},[d,A,S,R]);u.useEffect(()=>{pe()},[pe]),u.useEffect(()=>{l>0&&(r==="overview"?pe():D())},[l,r,pe,D]),u.useEffect(()=>{r==="chat-logs"&&d&&D()},[r,d,D]),cN(a,u.useCallback(()=>{r==="overview"?pe():D()},[r,pe,D]));const Q=$=>{m($),M(1),H(""),X(""),c("chat-logs")},B=()=>{c("overview"),m(null),b(null),H(""),X("")},ue=()=>{H(O),M(1)},Y=()=>{X(""),H(""),M(1)},_e=async($,z)=>{try{ge(!0),je(!0);const K=await Vk($,z);me(K)}catch(K){console.error(":",K)}finally{ge(!1)}},he=$=>{I(Number($)),M(1)},Te=()=>{const $=parseInt(E),z=j?Math.ceil(j.total/j.page_size):0;!isNaN($)&&$>=1&&$<=z&&(M($),C(""))},G=j?Math.ceil(j.total/j.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(ze,{children:g?e.jsx(Ms,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(lx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(ze,{children:g?e.jsx(Ms,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_replies||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map(($,z)=>e.jsx(Ms,{className:"h-24 w-full"},z))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map($=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Q($),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h($.chat_id),children:h($.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:$.reply_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",iN($.latest_timestamp)]})]},$.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(Ua,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",j?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{placeholder:"...",value:O,onChange:$=>X($.target.value),onKeyDown:$=>$.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(Ut,{className:"h-4 w-4"})}),R&&e.jsx(_,{variant:"ghost",size:"sm",onClick:Y,children:""})]}),e.jsxs(Ie,{value:S.toString(),onValueChange:he,children:[e.jsx(Be,{className:"w-full sm:w-32",children:e.jsx(Fe,{})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"10",children:"10/"}),e.jsx(Z,{value:"20",children:"20/"}),e.jsx(Z,{value:"50",children:"50/"}),e.jsx(Z,{value:"100",children:"100/"})]})]})]})]}),R&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',R,'"']})]})]}),e.jsx(ze,{children:y?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map(($,z)=>e.jsx(Ms,{className:"h-20 w-full"},z))}):j?.data&&j.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:j.data.map($=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e($.chat_id,$.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo($.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[$.success?e.jsxs(ke,{variant:"default",className:"text-xs bg-green-600",children:[e.jsx(kg,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",className:"text-xs",children:[e.jsx(aa,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:$.model}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[$.overall_ms.toFixed(0),"ms"]})]})]}),e.jsx("p",{className:"text-sm line-clamp-2",children:$.output_preview||""})]},$.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",j.total,"  ",A," / ",G," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(1),disabled:A===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.max(1,$-1)),disabled:A===1,children:e.jsx(Pa,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(le,{type:"number",min:1,max:G,value:E,onChange:$=>C($.target.value),onKeyDown:$=>$.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[A,"/",G]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.min(G,$+1)),disabled:A===G,children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(G),disabled:A===G,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Qs,{open:Ne,onOpenChange:je,children:e.jsxs(Hs,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(La,{className:"h-5 w-5"}),""]}),e.jsx(at,{children:""})]}),e.jsx(ts,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:ce?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map(($,z)=>e.jsx(Ms,{className:"h-24 w-full"},z))}):L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ca,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:L.chat_id,children:h(L.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(L.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),L.success?e.jsxs(ke,{variant:"default",className:"bg-green-600",children:[e.jsx(kg,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",children:[e.jsx(aa,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{variant:"outline",children:["Level ",L.think_level]})]})]})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(B1,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx(ke,{variant:"secondary",className:"text-sm",children:L.model})})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(Oe,{className:"p-4 pb-2",children:e.jsx($e,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(ze,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.prompt_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{className:"p-4 pb-2",children:e.jsx($e,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(ze,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.llm_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{className:"p-4 pb-2",children:e.jsx($e,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(ze,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.overall_ms?.toFixed(2)||0,"ms"]})})]})]}),L.timing.timing_logs&&L.timing.timing_logs.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"space-y-1",children:L.timing.timing_logs.map(($,z)=>e.jsx("div",{className:"text-xs text-muted-foreground",children:$},z))})]}),L.timing.almost_zero&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),L.timing.almost_zero]})]}),e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ux,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.output||""})})]}),L.processed_output&&L.processed_output.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-2",children:L.processed_output.map(($,z)=>e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:$})},z))})]})]}),L.reasoning&&e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.reasoning})})]})]}),L.error&&e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-destructive",children:""}),e.jsx("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:e.jsx("p",{className:"text-sm text-destructive whitespace-pre-wrap",children:L.error})})]})]}),L.prompt&&e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.prompt})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(ft,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function Qk(){const[a,l]=u.useState("planner"),[r,c]=u.useState(!1),[d,m]=u.useState(0),h=u.useCallback(()=>{m(f=>f+1)},[]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:" & "}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:r?"default":"outline",size:"sm",onClick:()=>c(!r),children:[e.jsx(mt,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),r?"":""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:h,children:e.jsx(mt,{className:"h-4 w-4"})})]})]}),e.jsxs(Jt,{value:a,onValueChange:f=>l(f),className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Ye,{value:"planner",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(ax,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"replier",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(P1,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(ts,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(Cs,{value:"planner",className:"mt-0",children:e.jsx(Gk,{autoRefresh:r,refreshKey:d})}),e.jsx(Cs,{value:"replier",className:"mt-0",children:e.jsx(Kk,{autoRefresh:r,refreshKey:d})})]})]})]})}const Yk="Mai-with-u",Jk="plugin-repo",Xk="main",Zk="plugin_details.json";async function Wk(){try{const a=await Se("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:Yk,repo:Jk,branch:Xk,file_path:Zk})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(!l.success||!l.data)throw new Error(l.error||"");return JSON.parse(l.data).filter(d=>!d?.id||!d?.manifest?(console.warn(":",d),!1):!d.manifest.name||!d.manifest.version?(console.warn(":",d.id),!1):!0).map(d=>({id:d.id,manifest:{manifest_version:d.manifest.manifest_version||1,name:d.manifest.name,version:d.manifest.version,description:d.manifest.description||"",author:d.manifest.author||{name:"Unknown"},license:d.manifest.license||"Unknown",host_application:d.manifest.host_application||{min_version:"0.0.0"},homepage_url:d.manifest.homepage_url,repository_url:d.manifest.repository_url,keywords:d.manifest.keywords||[],categories:d.manifest.categories||[],default_locale:d.manifest.default_locale||"zh-CN",locales_path:d.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()}))}catch(a){throw console.error("Failed to fetch plugin list:",a),a}}async function oN(){try{const a=await Se("/api/webui/plugins/git-status");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to check Git status:",a),{installed:!1,error:" Git "}}}async function dN(){try{const a=await Se("/api/webui/plugins/version");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to get Maimai version:",a),{version:"0.0.0",version_major:0,version_minor:0,version_patch:0}}}function uN(a,l,r){const c=a.split(".").map(f=>parseInt(f)||0),d=c[0]||0,m=c[1]||0,h=c[2]||0;if(r.version_major<d||r.version_major===d&&r.version_minor<m||r.version_major===d&&r.version_minor===m&&r.version_patch<h)return!1;if(l){const f=l.split(".").map(j=>parseInt(j)||0),p=f[0]||0,g=f[1]||0,N=f[2]||0;if(r.version_major>p||r.version_major===p&&r.version_minor>g||r.version_major===p&&r.version_minor===g&&r.version_patch>N)return!1}return!0}async function eC(){try{const a=await Se("/api/webui/ws-token");if(!a.ok)return console.error(" WebSocket token :",a.status),null;const l=await a.json();return l.success&&l.token?l.token:null}catch(a){return console.error(" WebSocket token :",a),null}}async function sC(a,l){const r=await eC();if(!r)return console.warn(" WebSocket token"),null;const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host,m=`${c}//${d}/api/webui/ws/plugin-progress?token=${encodeURIComponent(r)}`;try{const h=new WebSocket(m);return h.onopen=()=>{console.log("Plugin progress WebSocket connected");const f=setInterval(()=>{h.readyState===WebSocket.OPEN?h.send("ping"):clearInterval(f)},3e4)},h.onmessage=f=>{try{if(f.data==="pong")return;const p=JSON.parse(f.data);a(p)}catch(p){console.error("Failed to parse progress data:",p)}},h.onerror=f=>{console.error("Plugin progress WebSocket error:",f),l?.(f)},h.onclose=()=>{console.log("Plugin progress WebSocket disconnected")},h}catch(h){return console.error(" WebSocket :",h),null}}async function Ll(){try{const a=await Se("/api/webui/plugins/installed",{headers:Zs()});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(!l.success)throw new Error(l.message||"");return l.plugins||[]}catch(a){return console.error("Failed to get installed plugins:",a),[]}}function gn(a,l){return l.some(r=>r.id===a)}function jn(a,l){const r=l.find(c=>c.id===a);if(r)return r.manifest?.version||r.version}async function mN(a,l,r="main"){const c=await Se("/api/webui/plugins/install",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:l,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function xN(a){const l=await Se("/api/webui/plugins/uninstall",{method:"POST",body:JSON.stringify({plugin_id:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function hN(a,l,r="main"){const c=await Se("/api/webui/plugins/update",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:l,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function tC(a){const l=await Se(`/api/webui/plugins/config/${a}/schema`,{headers:Zs()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||" Schema ")}catch{throw new Error(` Schema  (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||" Schema ");return r.schema}async function aC(a){const l=await Se(`/api/webui/plugins/config/${a}`,{headers:Zs()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||"");return r.config}async function lC(a){const l=await Se(`/api/webui/plugins/config/${a}/raw`,{headers:Zs()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||"");return r.config}async function nC(a,l){const r=await Se(`/api/webui/plugins/config/${a}`,{method:"PUT",headers:Zs(),body:JSON.stringify({config:l})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function rC(a,l){const r=await Se(`/api/webui/plugins/config/${a}/raw`,{method:"PUT",headers:Zs(),body:JSON.stringify({config:l})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function iC(a){const l=await Se(`/api/webui/plugins/config/${a}/reset`,{method:"POST",headers:Zs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function cC(a){const l=await Se(`/api/webui/plugins/config/${a}/toggle`,{method:"POST",headers:Zs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}const jc="https://maibot-plugin-stats.maibot-webui.workers.dev";async function fN(a){try{const l=await fetch(`${jc}/stats/${a}`);return l.ok?await l.json():(console.error("Failed to fetch plugin stats:",l.statusText),null)}catch(l){return console.error("Error fetching plugin stats:",l),null}}async function oC(a,l){try{const r=l||Cx(),c=await fetch(`${jc}/stats/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error liking plugin:",r),{success:!1,error:""}}}async function dC(a,l){try{const r=l||Cx(),c=await fetch(`${jc}/stats/dislike`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error disliking plugin:",r),{success:!1,error:""}}}async function uC(a,l,r,c){if(l<1||l>5)return{success:!1,error:" 1-5 "};try{const d=c||Cx(),m=await fetch(`${jc}/stats/rate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,rating:l,comment:r,user_id:d})}),h=await m.json();return m.status===429?{success:!1,error:" 3 "}:m.ok?{success:!0,...h}:{success:!1,error:h.error||""}}catch(d){return console.error("Error rating plugin:",d),{success:!1,error:""}}}async function pN(a){try{const l=await fetch(`${jc}/stats/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a})}),r=await l.json();return l.status===429?(console.warn("Download recording rate limited"),{success:!0}):l.ok?{success:!0,...r}:(console.error("Failed to record download:",r.error),{success:!1,error:r.error})}catch(l){return console.error("Error recording download:",l),{success:!1,error:""}}}function mC(){const a=navigator,l=[navigator.userAgent,navigator.language,navigator.languages?.join(",")||"",navigator.platform,navigator.hardwareConcurrency||0,screen.width,screen.height,screen.colorDepth,screen.pixelDepth,new Date().getTimezoneOffset(),Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.maxTouchPoints||0,a.deviceMemory||0].join("|");let r=0;for(let c=0;c<l.length;c++){const d=l.charCodeAt(c);r=(r<<5)-r+d,r=r&r}return`fp_${Math.abs(r).toString(36)}`}function Cx(){const a="maibot_user_id";let l=localStorage.getItem(a);if(!l){const r=mC(),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,15);l=`${r}_${c}_${d}`,localStorage.setItem(a,l)}return l}const xC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function hC(){return e.jsx(tr,{children:e.jsx(fC,{})})}function fC(){const a=ha(),{triggerRestart:l,isRestarting:r}=_n(),[c,d]=u.useState(""),[m,h]=u.useState("all"),[f,p]=u.useState("all"),[g,N]=u.useState(!0),[j,b]=u.useState([]),[y,w]=u.useState(!0),[A,M]=u.useState(null),[S,I]=u.useState(null),[E,C]=u.useState(null),[R,H]=u.useState(null),[,O]=u.useState([]),[X,L]=u.useState({}),[me,Ne]=u.useState(!1),[je,ce]=u.useState(null),[ge,pe]=u.useState("main"),[D,Q]=u.useState(""),[B,ue]=u.useState("preset"),[Y,_e]=u.useState(!1),{toast:he}=nt(),Te=async J=>{const W=J.map(async Ee=>{try{const de=await fN(Ee.id);return{id:Ee.id,stats:de}}catch(de){return console.warn(`Failed to load stats for ${Ee.id}:`,de),{id:Ee.id,stats:null}}}),Ue=await Promise.all(W),ae={};Ue.forEach(({id:Ee,stats:de})=>{de&&(ae[Ee]=de)}),L(ae)};u.useEffect(()=>{let J=null,W=!1;return(async()=>{if(J=await sC(ae=>{W||(C(ae),ae.stage==="success"?setTimeout(()=>{W||C(null)},2e3):ae.stage==="error"&&(w(!1),M(ae.error||"")))},ae=>{console.error("WebSocket error:",ae),W||he({title:"WebSocket ",description:"",variant:"destructive"})}),await new Promise(ae=>{if(!J){ae();return}const Ee=()=>{J&&J.readyState===WebSocket.OPEN?(console.log("WebSocket connected, starting to load plugins"),ae()):J&&J.readyState===WebSocket.CLOSED?(console.warn("WebSocket closed before loading plugins"),ae()):setTimeout(Ee,100)};Ee()}),!W){const ae=await oN();I(ae),ae.installed||he({title:"Git ",description:ae.error||" Git ",variant:"destructive"})}if(!W){const ae=await dN();H(ae)}if(!W)try{w(!0),M(null);const ae=await Wk();if(!W){const Ee=await Ll();O(Ee);const de=ae.map(Re=>{const ys=gn(Re.id,Ee),Js=jn(Re.id,Ee);return{...Re,installed:ys,installed_version:Js}});for(const Re of Ee)!de.some(Js=>Js.id===Re.id)&&Re.manifest&&de.push({id:Re.id,manifest:{manifest_version:Re.manifest.manifest_version||1,name:Re.manifest.name,version:Re.manifest.version,description:Re.manifest.description||"",author:Re.manifest.author,license:Re.manifest.license||"Unknown",host_application:Re.manifest.host_application,homepage_url:Re.manifest.homepage_url,repository_url:Re.manifest.repository_url,keywords:Re.manifest.keywords||[],categories:Re.manifest.categories||[],default_locale:Re.manifest.default_locale||"zh-CN",locales_path:Re.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!0,installed_version:Re.manifest.version,published_at:new Date().toISOString(),updated_at:new Date().toISOString()});b(de),Te(de)}}catch(ae){if(!W){const Ee=ae instanceof Error?ae.message:"";M(Ee),he({title:"",description:Ee,variant:"destructive"})}}finally{W||w(!1)}})(),()=>{W=!0,J&&J.close()}},[he]);const G=J=>{if(!J.installed&&R&&!$(J))return e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(Rt,{className:"h-3 w-3"}),""]});if(J.installed){const W=J.installed_version?.trim(),Ue=J.manifest.version?.trim();if(W!==Ue){const ae=W?.split(".").map(Number)||[0,0,0],Ee=Ue?.split(".").map(Number)||[0,0,0];for(let de=0;de<3;de++){if((Ee[de]||0)>(ae[de]||0))return e.jsxs(ke,{variant:"outline",className:"gap-1 text-orange-600 border-orange-600",children:[e.jsx(Rt,{className:"h-3 w-3"}),""]});if((Ee[de]||0)<(ae[de]||0))break}}return e.jsxs(ke,{variant:"default",className:"gap-1",children:[e.jsx(st,{className:"h-3 w-3"}),""]})}return null},$=J=>!R||!J.manifest?.host_application?!0:uN(J.manifest.host_application.min_version,J.manifest.host_application.max_version,R),z=J=>{if(!J.installed||!J.installed_version||!J.manifest?.version)return!1;const W=J.installed_version.trim(),Ue=J.manifest.version.trim();if(W===Ue)return!1;const ae=W.split(".").map(Number),Ee=Ue.split(".").map(Number);for(let de=0;de<3;de++){if((Ee[de]||0)>(ae[de]||0))return!0;if((Ee[de]||0)<(ae[de]||0))return!1}return!1},K=j.filter(J=>{if(!J.manifest)return console.warn("[]  manifest :",J.id),!1;const W=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(de=>de.toLowerCase().includes(c.toLowerCase())),Ue=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m);let ae=!0;f==="installed"?ae=J.installed===!0:f==="updates"&&(ae=J.installed===!0&&z(J));const Ee=!g||!R||$(J);return W&&Ue&&ae&&Ee}),De=J=>{if(!S?.installed){he({title:"",description:"Git ",variant:"destructive"});return}if(R&&!$(J)){he({title:"",description:"",variant:"destructive"});return}ce(J),pe("main"),Q(""),ue("preset"),_e(!1),Ne(!0)},se=async()=>{if(!je)return;const J=B==="custom"?D:ge;if(!J||J.trim()===""){he({title:"",variant:"destructive"});return}try{Ne(!1),await mN(je.id,je.manifest.repository_url||"",J),pN(je.id).catch(Ue=>{console.warn("Failed to record download:",Ue)}),he({title:"",description:`${je.manifest.name} `});const W=await Ll();O(W),b(Ue=>Ue.map(ae=>{if(ae.id===je.id){const Ee=gn(ae.id,W),de=jn(ae.id,W);return{...ae,installed:Ee,installed_version:de}}return ae}))}catch(W){he({title:"",description:W instanceof Error?W.message:"",variant:"destructive"})}finally{ce(null)}},Le=async J=>{try{await xN(J.id),he({title:"",description:`${J.manifest.name} `});const W=await Ll();O(W),b(Ue=>Ue.map(ae=>{if(ae.id===J.id){const Ee=gn(ae.id,W),de=jn(ae.id,W);return{...ae,installed:Ee,installed_version:de}}return ae}))}catch(W){he({title:"",description:W instanceof Error?W.message:"",variant:"destructive"})}},rs=async J=>{if(!S?.installed){he({title:"",description:"Git ",variant:"destructive"});return}try{const W=await hN(J.id,J.manifest.repository_url||"","main");he({title:"",description:`${J.manifest.name}  ${W.old_version}  ${W.new_version}`});const Ue=await Ll();O(Ue),b(ae=>ae.map(Ee=>{if(Ee.id===J.id){const de=gn(Ee.id,Ue),Re=jn(Ee.id,Ue);return{...Ee,installed:de,installed_version:Re}}return Ee}))}catch(W){he({title:"",description:W instanceof Error?W.message:"",variant:"destructive"})}};return e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>l(),disabled:r,children:[e.jsx(uv,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]}),e.jsxs(_,{onClick:()=>a({to:"/plugin-mirrors"}),children:[e.jsx(I1,{className:"h-4 w-4 mr-2"}),""]})]})]}),e.jsx(Ce,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900",children:e.jsx(ze,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yt,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["",e.jsx("span",{className:"font-semibold",children:""}),""]})]})})}),S&&!S.installed&&e.jsxs(Ce,{className:"border-orange-600 bg-orange-50 dark:bg-orange-950/20",children:[e.jsx(Oe,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx($e,{className:"text-lg text-orange-900 dark:text-orange-100",children:"Git "}),e.jsx(Ns,{className:"text-orange-800 dark:text-orange-200",children:S.error||" Git "})]})]})}),e.jsx(ze,{children:e.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[" ",e.jsx("a",{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer",className:"underline font-medium",children:"git-scm.com"}),"  Git "]})})]}),e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:c,onChange:J=>d(J.target.value),className:"pl-9"})]}),e.jsxs(Ie,{value:m,onValueChange:h,children:[e.jsx(Be,{className:"w-full sm:w-[200px]",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"all",children:""}),e.jsx(Z,{value:"Group Management",children:""}),e.jsx(Z,{value:"Entertainment & Interaction",children:""}),e.jsx(Z,{value:"Utility Tools",children:""}),e.jsx(Z,{value:"Content Generation",children:""}),e.jsx(Z,{value:"Multimedia",children:""}),e.jsx(Z,{value:"External Integration",children:""}),e.jsx(Z,{value:"Data Analysis & Insights",children:""}),e.jsx(Z,{value:"Other",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"compatible-only",checked:g,onCheckedChange:J=>N(J===!0)}),e.jsx("label",{htmlFor:"compatible-only",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:""})]})]})}),e.jsx(Jt,{value:f,onValueChange:p,className:"w-full",children:e.jsxs(Gt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ye,{value:"all",children:[" (",j.filter(J=>{if(!J.manifest)return!1;const W=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m),ae=!g||!R||$(J);return W&&Ue&&ae}).length,")"]}),e.jsxs(Ye,{value:"installed",children:[" (",j.filter(J=>{if(!J.manifest)return!1;const W=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m),ae=!g||!R||$(J);return J.installed&&W&&Ue&&ae}).length,")"]}),e.jsxs(Ye,{value:"updates",children:[" (",j.filter(J=>{if(!J.manifest)return!1;const W=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m),ae=!g||!R||$(J);return J.installed&&z(J)&&W&&Ue&&ae}).length,")"]})]})}),E&&E.stage==="loading"&&E.operation==="fetch"&&e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:""})]}),e.jsxs("span",{className:"text-sm font-medium",children:[E.progress,"%"]})]}),e.jsx(er,{value:E.progress,className:"h-2"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:E.message}),E.total_plugins>0&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[" ",E.loaded_plugins," / ",E.total_plugins," "]})]})}),E&&E.stage==="error"&&E.error&&e.jsx(Ce,{className:"border-destructive bg-destructive/10",children:e.jsx(Oe,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx($e,{className:"text-lg text-destructive",children:""}),e.jsx(Ns,{className:"text-destructive/80",children:E.error})]})]})})}),y?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]}):A?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Ft,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:A}),e.jsx(_,{onClick:()=>window.location.reload(),children:""})]})}):K.length===0?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Ut,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||m!=="all"?"":""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:K.map(J=>e.jsxs(Ce,{className:"flex flex-col hover:shadow-lg transition-shadow h-full",children:[e.jsxs(Oe,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx($e,{className:"text-xl",children:J.manifest?.name||J.id}),e.jsxs("div",{className:"flex flex-col gap-1",children:[J.manifest?.categories&&J.manifest.categories[0]&&e.jsx(ke,{variant:"secondary",className:"text-xs whitespace-nowrap",children:xC[J.manifest.categories[0]]||J.manifest.categories[0]}),G(J)]})]}),e.jsx(Ns,{className:"line-clamp-2",children:J.manifest?.description||""})]}),e.jsx(ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ra,{className:"h-4 w-4"}),e.jsx("span",{children:(X[J.id]?.downloads??J.downloads??0).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:(X[J.id]?.rating??J.rating??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[J.manifest?.keywords&&J.manifest.keywords.slice(0,3).map(W=>e.jsx(ke,{variant:"outline",className:"text-xs",children:W},W)),J.manifest?.keywords&&J.manifest.keywords.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",J.manifest.keywords.length-3]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t space-y-1",children:[e.jsxs("div",{children:["v",J.manifest?.version||"unknown","  ",J.manifest?.author?.name||"Unknown"]}),J.manifest?.host_application&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:":"}),e.jsxs("span",{className:"font-medium",children:[J.manifest.host_application.min_version,J.manifest.host_application.max_version?` - ${J.manifest.host_application.max_version}`:" - "]})]})]})]})}),e.jsx(id,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>a({to:"/plugin-detail",search:{pluginId:J.id}}),children:""}),J.installed?z(J)?e.jsxs(_,{size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>rs(J),children:[e.jsx(mt,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{variant:"destructive",size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>Le(J),children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{size:"sm",disabled:!S?.installed||E?.operation==="install"||R!==null&&!$(J),title:S?.installed?R!==null&&!$(J)?` ( ${J.manifest?.host_application?.min_version||""}${J.manifest?.host_application?.max_version?` - ${J.manifest.host_application.max_version}`:"+"} ${R?.version})`:void 0:"Git ",onClick:()=>De(J),children:[e.jsx(ra,{className:"h-4 w-4 mr-1"}),E?.operation==="install"&&E?.plugin_id===J.id?"...":""]})]})}),E&&(E.stage==="loading"||E.stage==="success"||E.stage==="error")&&E.operation!=="fetch"&&E.plugin_id===J.id&&e.jsx("div",{className:"px-6 pb-4 -mt-2",children:e.jsxs("div",{className:`space-y-2 p-3 rounded-lg border ${E.stage==="success"?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-900":E.stage==="error"?"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-900":"bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[E.stage==="loading"?e.jsx(Fs,{className:"h-3 w-3 animate-spin"}):E.stage==="success"?e.jsx(st,{className:"h-3 w-3 text-green-600"}):e.jsx(Rt,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":E.stage==="error"?"text-red-700 dark:text-red-300":""}`,children:E.stage==="loading"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):E.stage==="success"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]})})]}),E.stage!=="error"&&e.jsxs("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":""}`,children:[E.progress,"%"]})]}),E.stage!=="error"&&e.jsx(er,{value:E.progress,className:`h-1.5 ${E.stage==="success"?"[&>div]:bg-green-500":""}`}),e.jsx("div",{className:`text-xs ${E.stage==="success"?"text-green-600 dark:text-green-400 truncate":E.stage==="error"?"text-red-600 dark:text-red-400":"text-muted-foreground truncate"}`,children:E.stage==="error"?E.error||E.message||"":E.message})]})})]},J.id))}),e.jsx(Qs,{open:me,onOpenChange:Ne,children:e.jsxs(Hs,{children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsxs(at,{children:[" ",je?.manifest.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",je?.manifest.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",typeof je?.manifest.author=="string"?je.manifest.author:je?.manifest.author?.name]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"advanced-options",checked:Y,onCheckedChange:J=>_e(J)}),e.jsx("label",{htmlFor:"advanced-options",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:""})]}),Y&&e.jsx("div",{className:"space-y-4 p-4 border rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:""}),e.jsxs(Jt,{value:B,onValueChange:J=>ue(J),children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2",children:[e.jsx(Ye,{value:"preset",className:"text-xs",children:""}),e.jsx(Ye,{value:"custom",className:"text-xs",children:""})]}),B==="preset"&&e.jsx("div",{className:"mt-3",children:e.jsxs(Ie,{value:ge,onValueChange:pe,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Pe,{children:[e.jsx(Z,{value:"main",children:"main ()"}),e.jsx(Z,{value:"master",children:"master"}),e.jsx(Z,{value:"dev",children:"dev ()"}),e.jsx(Z,{value:"develop",children:"develop"}),e.jsx(Z,{value:"beta",children:"beta ()"}),e.jsx(Z,{value:"stable",children:"stable ()"})]})]})}),B==="custom"&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:": feature/new-feature",value:D,onChange:J=>Q(J.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Git "})]})]})]})}),!Y&&e.jsx("p",{className:"text-sm text-muted-foreground",children:" (main) "})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>Ne(!1),children:""}),e.jsxs(_,{onClick:se,children:[e.jsx(ra,{className:"h-4 w-4 mr-2"}),""]})]})]})}),e.jsx(ar,{})]})})}function pC(){return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(mv,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(ts,{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)]",children:e.jsxs(Ce,{className:"max-w-2xl w-full border-dashed",children:[e.jsxs(Oe,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(xa,{className:"h-16 w-16 text-muted-foreground"})}),e.jsx($e,{className:"text-2xl",children:""}),e.jsx(Ns,{className:"text-base",children:""})]}),e.jsx(ze,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:" "}),e.jsxs("ul",{className:"space-y-2 ml-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]})]})]})})]})})})]})}function gC({field:a,value:l,onChange:r}){const[c,d]=u.useState(!1);switch(a.ui_type){case"switch":return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:a.label}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]}),e.jsx(Ve,{checked:!!l,onCheckedChange:r,disabled:a.disabled})]});case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(le,{type:"number",value:l??a.default,onChange:m=>r(parseFloat(m.target.value)||0),min:a.min,max:a.max,step:a.step??1,placeholder:a.placeholder,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"slider":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:a.label}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l??a.default})]}),e.jsx(Wa,{value:[l??a.default],onValueChange:m=>r(m[0]),min:a.min??0,max:a.max??100,step:a.step??1,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs(Ie,{value:String(l??a.default),onValueChange:r,disabled:a.disabled,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:a.placeholder??""})}),e.jsx(Pe,{children:a.choices?.map(m=>e.jsx(Z,{value:String(m),children:String(m)},String(m)))})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ht,{value:l??a.default,onChange:m=>r(m.target.value),placeholder:a.placeholder,rows:a.rows??3,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"password":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{type:c?"text":"password",value:l??"",onChange:m=>r(m.target.value),placeholder:a.placeholder,disabled:a.disabled,className:"pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>d(!c),children:c?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(oa,{className:"h-4 w-4"})})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"list":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(yS,{value:Array.isArray(l)?l:[],onChange:m=>r(m),itemType:a.item_type??"string",itemFields:a.item_fields,minItems:a.min_items,maxItems:a.max_items,disabled:a.disabled,placeholder:a.placeholder}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"text":default:return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(le,{type:"text",value:l??a.default??"",onChange:m=>r(m.target.value),placeholder:a.placeholder,maxLength:a.max_length,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]})}}function ej({section:a,config:l,onChange:r}){const[c,d]=u.useState(!a.collapsed),m=Object.entries(a.fields).filter(([,h])=>!h.hidden).sort(([,h],[,f])=>h.order-f.order);return e.jsx(uc,{open:c,onOpenChange:d,children:e.jsxs(Ce,{children:[e.jsx(mc,{asChild:!0,children:e.jsxs(Oe,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx($a,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"}),e.jsx($e,{className:"text-lg",children:a.title})]}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[m.length," "]})]}),a.description&&e.jsx(Ns,{className:"ml-6",children:a.description})]})}),e.jsx(xc,{children:e.jsx(ze,{className:"space-y-4 pt-0",children:m.map(([h,f])=>e.jsx(gC,{field:f,value:l[a.name]?.[h],onChange:p=>r(a.name,h,p),sectionName:a.name},h))})})]})})}function jC({plugin:a,onBack:l}){const{toast:r}=nt(),{triggerRestart:c,isRestarting:d}=_n(),[m,h]=u.useState("visual"),[f,p]=u.useState(null),[g,N]=u.useState({}),[j,b]=u.useState({}),[y,w]=u.useState(""),[A,M]=u.useState(""),[S,I]=u.useState(!0),[E,C]=u.useState(!1),[R,H]=u.useState(!1),[O,X]=u.useState(!1),[L,me]=u.useState(!1),Ne=u.useCallback(async()=>{I(!0);try{const[B,ue,Y]=await Promise.all([tC(a.id),aC(a.id),lC(a.id)]);p(B),N(ue),b(JSON.parse(JSON.stringify(ue))),w(Y),M(Y)}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}finally{I(!1)}},[a.id,r]);u.useEffect(()=>{Ne()},[Ne]),u.useEffect(()=>{H(m==="visual"?JSON.stringify(g)!==JSON.stringify(j):y!==A)},[g,j,y,A,m]);const je=(B,ue,Y)=>{N(_e=>({..._e,[B]:{..._e[B]||{},[ue]:Y}}))},ce=async()=>{C(!0);try{if(m==="source"){try{bx(y)}catch(B){X(!0),r({title:"TOML ",description:B instanceof Error?B.message:" TOML ",variant:"destructive"}),C(!1);return}await rC(a.id,y),M(y),X(!1)}else await nC(a.id,g),b(JSON.parse(JSON.stringify(g)));r({title:"",description:""})}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}finally{C(!1)}},ge=async()=>{try{await iC(a.id),r({title:"",description:""}),me(!1),Ne()}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}},pe=async()=>{try{const B=await cC(a.id);r({title:B.message,description:B.note}),Ne()}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}};if(S)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!f)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx(Rt,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsxs(_,{onClick:l,variant:"outline",children:[e.jsx(Ua,{className:"h-4 w-4 mr-2"}),""]})]});const D=Object.values(f.sections).sort((B,ue)=>B.order-ue.order),Q=g.plugin?.enabled!==!1;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:l,children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:f.plugin_info.name||a.manifest.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ke,{variant:Q?"default":"secondary",children:Q?"":""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["v",f.plugin_info.version||a.manifest.version]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-10 sm:ml-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>h(m==="visual"?"source":"visual"),children:m==="visual"?e.jsxs(e.Fragment,{children:[e.jsx(ix,{className:"h-4 w-4 mr-2"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(cv,{className:"h-4 w-4 mr-2"}),""]})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>c(),disabled:d,children:[e.jsx(uv,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:pe,children:[e.jsx(hc,{className:"h-4 w-4 mr-2"}),Q?"":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>me(!0),children:[e.jsx(lc,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs(_,{size:"sm",onClick:ce,disabled:!R||E,children:[E?e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(fc,{className:"h-4 w-4 mr-2"}),""]})]})]}),R&&e.jsx(Ce,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20 dark:border-orange-900",children:e.jsx(ze,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yt,{className:"h-4 w-4 text-orange-600"}),e.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:""})]})})}),m==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsxs(gt,{children:[e.jsx("strong",{children:""})," TOML ",O&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(Vv,{value:y,onChange:B=>{w(B),O&&X(!1)},language:"toml",theme:"dark",height:"calc(100vh - 350px)",minHeight:"500px",placeholder:"TOML "})]}),m==="visual"&&e.jsxs(e.Fragment,{children:[e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(gt,{children:[e.jsx("strong",{children:""}),"WebUI  "]})]}),f.layout.type==="tabs"&&f.layout.tabs.length>0?e.jsxs(Jt,{defaultValue:f.layout.tabs[0]?.id,children:[e.jsx(Gt,{children:f.layout.tabs.map(B=>e.jsxs(Ye,{value:B.id,children:[B.title,B.badge&&e.jsx(ke,{variant:"secondary",className:"ml-2 text-xs",children:B.badge})]},B.id))}),f.layout.tabs.map(B=>e.jsx(Cs,{value:B.id,className:"space-y-4 mt-4",children:B.sections.map(ue=>{const Y=f.sections[ue];return Y?e.jsx(ej,{section:Y,config:g,onChange:je},ue):null})},B.id))]}):e.jsx("div",{className:"space-y-4",children:D.map(B=>e.jsx(ej,{section:B,config:g,onChange:je},B.name))})]}),e.jsx(Qs,{open:L,onOpenChange:me,children:e.jsxs(Hs,{children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>me(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:ge,children:""})]})]})})]})}function vC(){return e.jsx(tr,{children:e.jsx(NC,{})})}function NC(){const{toast:a}=nt(),[l,r]=u.useState([]),[c,d]=u.useState(!0),[m,h]=u.useState(""),[f,p]=u.useState(null),g=async()=>{d(!0);try{const w=await Ll();r(w)}catch(w){a({title:"",description:w instanceof Error?w.message:"",variant:"destructive"})}finally{d(!1)}};u.useEffect(()=>{g()},[]);const j=l.filter(w=>{const A=m.toLowerCase();return w.id.toLowerCase().includes(A)||w.manifest.name.toLowerCase().includes(A)||w.manifest.description?.toLowerCase().includes(A)}).filter((w,A,M)=>A===M.findIndex(S=>S.id===w.id)),b=l.length,y=0;return f?e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"h-full",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(jC,{plugin:f,onBack:()=>p(null)})})}),e.jsx(ar,{})]}):e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:g,children:[e.jsx(mt,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),""]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(xa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ze,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c?"...":""})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(st,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(ze,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:""}),e.jsx(Rt,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(ze,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:m,onChange:w=>h(w.target.value),className:"pl-9"})]}),e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):j.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(xa,{className:"h-16 w-16 text-muted-foreground/50"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:m?"":""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m?"":""})]})]}):e.jsx("div",{className:"space-y-2",children:j.map(w=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>p(w),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(xa,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:w.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs flex-shrink-0",children:["v",w.manifest.version]})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:w.manifest.description||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(bn,{className:"h-4 w-4"})}),e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})]})]},w.id))})})]})]})})}function bC(){const a=ha(),{toast:l}=nt(),[r,c]=u.useState([]),[d,m]=u.useState(!0),[h,f]=u.useState(null),[p,g]=u.useState(null),[N,j]=u.useState(!1),[b,y]=u.useState(!1),[w,A]=u.useState({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),M=u.useCallback(async()=>{try{m(!0),f(null);const O=await Se("/api/webui/plugins/mirrors");if(!O.ok)throw new Error("");const X=await O.json();c(X.mirrors||[])}catch(O){const X=O instanceof Error?O.message:"";f(X),l({title:"",description:X,variant:"destructive"})}finally{m(!1)}},[l]);u.useEffect(()=>{M()},[M]);const S=async()=>{try{const O=await Se("/api/webui/plugins/mirrors",{method:"POST",body:JSON.stringify(w)});if(!O.ok){const X=await O.json();throw new Error(X.detail||"")}l({title:"",description:""}),j(!1),A({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),M()}catch(O){l({title:"",description:O instanceof Error?O.message:"",variant:"destructive"})}},I=async()=>{if(p)try{if(!(await Se(`/api/webui/plugins/mirrors/${p.id}`,{method:"PUT",body:JSON.stringify({name:w.name,raw_prefix:w.raw_prefix,clone_prefix:w.clone_prefix,enabled:w.enabled,priority:w.priority})})).ok)throw new Error("");l({title:"",description:""}),y(!1),g(null),M()}catch(O){l({title:"",description:O instanceof Error?O.message:"",variant:"destructive"})}},E=async O=>{if(confirm(""))try{if(!(await Se(`/api/webui/plugins/mirrors/${O}`,{method:"DELETE"})).ok)throw new Error("");l({title:"",description:""}),M()}catch(X){l({title:"",description:X instanceof Error?X.message:"",variant:"destructive"})}},C=async O=>{try{if(!(await Se(`/api/webui/plugins/mirrors/${O.id}`,{method:"PUT",body:JSON.stringify({enabled:!O.enabled})})).ok)throw new Error("");M()}catch(X){l({title:"",description:X instanceof Error?X.message:"",variant:"destructive"})}},R=O=>{g(O),A({id:O.id,name:O.name,raw_prefix:O.raw_prefix,clone_prefix:O.clone_prefix,enabled:O.enabled,priority:O.priority}),y(!0)},H=async(O,X)=>{const L=X==="up"?O.priority-1:O.priority+1;if(!(L<1))try{if(!(await Se(`/api/webui/plugins/mirrors/${O.id}`,{method:"PUT",body:JSON.stringify({priority:L})})).ok)throw new Error("");M()}catch(me){l({title:"",description:me instanceof Error?me.message:"",variant:"destructive"})}};return e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:" Git "})]})]}),e.jsxs(_,{onClick:()=>j(!0),children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),""]})]}),d?e.jsx(Ce,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-primary"})})}):h?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Ft,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h}),e.jsx(_,{onClick:M,children:""})]})}):e.jsxs(Ce,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:"ID"}),e.jsx(ns,{children:""}),e.jsx(ns,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r.map(O=>e.jsxs(wt,{children:[e.jsx(Je,{children:e.jsx(Ve,{checked:O.enabled,onCheckedChange:()=>C(O)})}),e.jsx(Je,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:O.name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Raw: ",O.raw_prefix]})]})}),e.jsx(Je,{children:e.jsx(ke,{variant:"outline",children:O.id})}),e.jsx(Je,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono",children:O.priority}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>H(O,"up"),disabled:O.priority===1,children:e.jsx(Yr,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>H(O,"down"),children:e.jsx($a,{className:"h-3 w-3"})})]})]})}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>R(O),children:e.jsx(Jn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>E(O.id),children:e.jsx(os,{className:"h-4 w-4 text-destructive"})})]})})]},O.id))})]})}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:r.map(O=>e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:O.name}),O.enabled&&e.jsx(ke,{variant:"default",className:"text-xs",children:""})]}),e.jsx(ke,{variant:"outline",className:"mt-1 text-xs",children:O.id})]}),e.jsx(Ve,{checked:O.enabled,onCheckedChange:()=>C(O)})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Raw: "}),e.jsx("span",{className:"break-all",children:O.raw_prefix})]}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),e.jsx("span",{className:"font-mono",children:O.priority})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>R(O),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>H(O,"up"),disabled:O.priority===1,children:e.jsx(Yr,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>H(O,"down"),children:e.jsx($a,{className:"h-4 w-4"})}),e.jsx(_,{variant:"destructive",size:"sm",onClick:()=>E(O.id),children:e.jsx(os,{className:"h-4 w-4"})})]})]})},O.id))})]}),e.jsx(Qs,{open:N,onOpenChange:j,children:e.jsxs(Hs,{className:"max-w-lg",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:" Git "})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-id",children:" ID *"}),e.jsx(le,{id:"add-id",placeholder:": my-mirror",value:w.id,onChange:O=>A({...w,id:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-name",children:" *"}),e.jsx(le,{id:"add-name",placeholder:": ",value:w.name,onChange:O=>A({...w,name:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-raw",children:"Raw  *"}),e.jsx(le,{id:"add-raw",placeholder:"https://example.com/raw",value:w.raw_prefix,onChange:O=>A({...w,raw_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-clone",children:" *"}),e.jsx(le,{id:"add-clone",placeholder:"https://example.com/clone",value:w.clone_prefix,onChange:O=>A({...w,clone_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-priority",children:""}),e.jsx(le,{id:"add-priority",type:"number",min:"1",value:w.priority,onChange:O=>A({...w,priority:parseInt(O.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"add-enabled",checked:w.enabled,onCheckedChange:O=>A({...w,enabled:O})}),e.jsx(T,{htmlFor:"add-enabled",children:""})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:""}),e.jsx(_,{onClick:S,children:""})]})]})}),e.jsx(Qs,{open:b,onOpenChange:y,children:e.jsxs(Hs,{className:"max-w-lg",children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" ID"}),e.jsx(le,{value:w.id,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-name",children:" *"}),e.jsx(le,{id:"edit-name",value:w.name,onChange:O=>A({...w,name:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-raw",children:"Raw  *"}),e.jsx(le,{id:"edit-raw",value:w.raw_prefix,onChange:O=>A({...w,raw_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-clone",children:" *"}),e.jsx(le,{id:"edit-clone",value:w.clone_prefix,onChange:O=>A({...w,clone_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-priority",children:""}),e.jsx(le,{id:"edit-priority",type:"number",min:"1",value:w.priority,onChange:O=>A({...w,priority:parseInt(O.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ve,{id:"edit-enabled",checked:w.enabled,onCheckedChange:O=>A({...w,enabled:O})}),e.jsx(T,{htmlFor:"edit-enabled",children:""})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>y(!1),children:""}),e.jsx(_,{onClick:I,children:""})]})]})})]})})}function yC({pluginId:a,compact:l=!1}){const[r,c]=u.useState(null),[d,m]=u.useState(!0),[h,f]=u.useState(0),[p,g]=u.useState(""),[N,j]=u.useState(!1),{toast:b}=nt(),y=async()=>{m(!0);const S=await fN(a);S&&c(S),m(!1)};u.useEffect(()=>{y()},[a]);const w=async()=>{const S=await oC(a);S.success?(b({title:"",description:""}),y()):b({title:"",description:S.error||"",variant:"destructive"})},A=async()=>{const S=await dC(a);S.success?(b({title:"",description:""}),y()):b({title:"",description:S.error||"",variant:"destructive"})},M=async()=>{if(h===0){b({title:"",description:" 1 ",variant:"destructive"});return}const S=await uC(a,h,p||void 0);S.success?(b({title:"",description:""}),j(!1),f(0),g(""),y()):b({title:"",description:S.error||"",variant:"destructive"})};return d?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ra,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]})]}):r?l?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.downloads.toLocaleString()}`,children:[e.jsx(ra,{className:"h-4 w-4"}),e.jsx("span",{children:r.downloads.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.rating.toFixed(1)} (${r.rating_count} )`,children:[e.jsx(fn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:r.rating.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.likes}`,children:[e.jsx(Em,{className:"h-4 w-4"}),e.jsx("span",{children:r.likes})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(ra,{className:"h-5 w-5 text-muted-foreground mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.downloads.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(fn,{className:"h-5 w-5 text-yellow-400 mb-1 fill-yellow-400"}),e.jsx("span",{className:"text-2xl font-bold",children:r.rating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.rating_count," "]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Em,{className:"h-5 w-5 text-green-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.likes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Cg,{className:"h-5 w-5 text-red-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.dislikes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(Em,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:A,children:[e.jsx(Cg,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(Qs,{open:N,onOpenChange:j,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"default",size:"sm",children:[e.jsx(fn,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Hs,{children:[e.jsxs(qs,{children:[e.jsx(Vs,{children:""}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(S=>e.jsx("button",{onClick:()=>f(S),className:"focus:outline-none",children:e.jsx(fn,{className:`h-8 w-8 transition-colors ${S<=h?"fill-yellow-400 text-yellow-400":"text-muted-foreground hover:text-yellow-300"}`})},S))}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h===0&&"",h===1&&"",h===2&&"",h===3&&"",h===4&&"",h===5&&""]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),e.jsx(ht,{value:p,onChange:S=>g(S.target.value),placeholder:"...",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[p.length," / 500"]})]})]}),e.jsxs(ft,{children:[e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:""}),e.jsx(_,{onClick:M,disabled:h===0,children:""})]})]})]})]}),r.recent_ratings&&r.recent_ratings.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-3",children:r.recent_ratings.map((S,I)=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>e.jsx(fn,{className:`h-3 w-3 ${E<=S.rating?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`},E))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(S.created_at).toLocaleDateString()})]}),S.comment&&e.jsx("p",{className:"text-sm text-muted-foreground",children:S.comment})]},I))})]})]}):null}const wC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function _C(){const a=ha(),l=W0({strict:!1}),{toast:r}=nt(),[c,d]=u.useState(null),[m,h]=u.useState(""),[f,p]=u.useState(!0),[g,N]=u.useState(!0),[j,b]=u.useState(null),[y,w]=u.useState(null),[A,M]=u.useState(null),[S,I]=u.useState(!1),[E,C]=u.useState(),[R,H]=u.useState(!1);u.useEffect(()=>{(async()=>{if(!l.pluginId){b(" ID"),p(!1);return}try{p(!0),b(null);const ge=await Se("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:"Mai-with-u",repo:"plugin-repo",branch:"main",file_path:"plugin_details.json"})});if(!ge.ok)throw new Error("");const pe=await ge.json();if(!pe.success||!pe.data)throw new Error(pe.error||"");const Q=JSON.parse(pe.data).find(he=>he.id===l.pluginId);if(!Q)throw new Error("");const B={id:Q.id,manifest:Q.manifest,downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()};d(B);const[ue,Y,_e]=await Promise.all([oN(),dN(),Ll()]);w(ue),M(Y),I(gn(l.pluginId,_e)),C(jn(l.pluginId,_e))}catch(ge){b(ge instanceof Error?ge.message:"")}finally{p(!1)}})()},[l.pluginId]),u.useEffect(()=>{(async()=>{if(!c?.manifest?.repository_url){N(!1);return}try{if(N(!0),S&&l.pluginId)try{const Y=await Se(`/api/webui/plugins/local-readme/${l.pluginId}`);if(Y.ok){const _e=await Y.json();if(_e.success&&_e.data){h(_e.data),N(!1);return}}}catch(Y){console.log(" README :",Y)}const ge=c.manifest.repository_url.match(/github\.com\/([^/]+)\/([^/\s]+)/);if(!ge){h("");return}const[,pe,D]=ge,Q=D.replace(/\.git$/,""),B=await Se("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:pe,repo:Q,branch:"main",file_path:"README.md"})});if(!B.ok)throw new Error(" README ");const ue=await B.json();ue.success&&ue.data?h(ue.data):h(" README ")}catch(ge){console.error(" README :",ge),h(" README ")}finally{N(!1)}})()},[c,S,l.pluginId]);const O=()=>!c||!S||!E?!1:E!==c.manifest.version,X=()=>!c||!A?!0:uN(c.manifest.host_application.min_version,c.manifest.host_application.max_version,A),L=async()=>{if(!(!c||!y?.installed))try{H(!0),await mN(c.id,c.manifest.repository_url||"","main"),pN(c.id).catch(ge=>{console.warn("Failed to record download:",ge)}),r({title:"",description:`${c.manifest.name} `});const ce=await Ll();I(gn(c.id,ce)),C(jn(c.id,ce))}catch(ce){r({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{H(!1)}},me=async()=>{if(c)try{H(!0),await xN(c.id),r({title:"",description:`${c.manifest.name} `});const ce=await Ll();I(gn(c.id,ce)),C(jn(c.id,ce))}catch(ce){r({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{H(!1)}},Ne=async()=>{if(!(!c||!y?.installed))try{H(!0);const ce=await hN(c.id,c.manifest.repository_url||"","main");r({title:"",description:`${c.manifest.name}  ${ce.old_version}  ${ce.new_version}`});const ge=await Ll();I(gn(c.id,ge)),C(jn(c.id,ge))}catch(ce){r({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{H(!1)}};if(f)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]})]});if(j||!c)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Rt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:j}),e.jsx(_,{onClick:()=>a({to:"/plugins"}),children:""})]})})]});const je=X();return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),className:"shrink-0",children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:c.manifest.name})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S?e.jsxs(e.Fragment,{children:[O()?e.jsx(_,{disabled:!y?.installed||R,onClick:Ne,title:y?.installed?void 0:"Git ",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),""]})}):null,e.jsx(_,{variant:"destructive",disabled:!y?.installed||R,onClick:me,title:y?.installed?void 0:"Git ",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),""]})})]}):e.jsx(_,{disabled:!y?.installed||!je||R,onClick:L,title:y?.installed?je?void 0:` ( ${c.manifest.host_application.min_version}${c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:"+"} ${A?.version})`:"Git ",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ra,{className:"h-4 w-4 mr-2"}),""]})})})]}),e.jsx(ts,{className:"h-[calc(100vh-200px)] sm:h-[calc(100vh-220px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsx(Ce,{children:e.jsx(Oe,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx($e,{className:"text-2xl",children:c.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-sm",children:["v",c.manifest.version]}),S&&e.jsxs(ke,{variant:"default",className:"text-sm",children:[e.jsx(st,{className:"h-3 w-3 mr-1"})," ",E&&`(v${E})`]}),O()&&e.jsxs(ke,{variant:"outline",className:"text-sm border-orange-500 text-orange-500",children:[e.jsx(mt,{className:"h-3 w-3 mr-1"}),""]}),!je&&e.jsxs(ke,{variant:"destructive",className:"text-sm",children:[e.jsx(Rt,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx(Ns,{className:"text-base",children:c.manifest.description})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsx($e,{className:"text-lg",children:""})}),e.jsx(ze,{children:e.jsx(yC,{pluginId:c.id})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsx($e,{className:"text-lg",children:""})}),e.jsx(ze,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx($l,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.author?.name||"Unknown"}),c.manifest.author?.url&&e.jsx("a",{href:c.manifest.author.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:e.jsx($o,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(xa,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-medium",children:["v",c.manifest.version]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(nv,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.license})]}),c.manifest.homepage_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(qo,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.homepage_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["",e.jsx($o,{className:"h-3 w-3"})]})]}),c.manifest.repository_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(F1,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.repository_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["GitHub",e.jsx($o,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx(Yt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"})]}),e.jsxs("div",{className:"text-sm pl-6 font-medium",children:[c.manifest.host_application.min_version,c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:" - "]})]})]})})]}),(c.manifest.categories||c.manifest.keywords)&&e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsx($e,{className:"text-lg",children:""})}),e.jsxs(ze,{className:"space-y-4",children:[c.manifest.categories&&c.manifest.categories.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.categories.map(ce=>e.jsx(ke,{variant:"secondary",children:wC[ce]||ce},ce))})]}),c.manifest.keywords&&c.manifest.keywords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.keywords.map(ce=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"h-3 w-3 mr-1"}),ce]},ce))})]})]})]})]}),e.jsxs(Ce,{className:"lg:col-span-2",children:[e.jsx(Oe,{children:e.jsx($e,{className:"text-lg",children:""})}),e.jsx(ze,{children:e.jsx(ts,{className:"h-[600px] pr-4",children:g?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Fs,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-sm text-muted-foreground",children:"..."})]}):m?e.jsx(jx,{content:m}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:""})})})]})]})]})})]})}const Zi=u.forwardRef(({className:a,...l},r)=>e.jsx(Cj,{ref:r,className:F("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...l}));Zi.displayName=Cj.displayName;const SC=u.forwardRef(({className:a,...l},r)=>e.jsx(Tj,{ref:r,className:F("aspect-square h-full w-full",a),...l}));SC.displayName=Tj.displayName;const Wi=u.forwardRef(({className:a,...l},r)=>e.jsx(Ej,{ref:r,className:F("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...l}));Wi.displayName=Ej.displayName;function kC(){return"webui_"+Math.random().toString(36).substr(2,9)+"_"+Date.now().toString(36)}function CC(){const a="maibot_webui_user_id";let l=localStorage.getItem(a);return l||(l=kC(),localStorage.setItem(a,l)),l}function TC(){return localStorage.getItem("maibot_webui_user_name")||"WebUI"}function EC(a){localStorage.setItem("maibot_webui_user_name",a)}const gN="maibot_webui_virtual_tabs";function MC(){try{const a=localStorage.getItem(gN);if(a)return JSON.parse(a)}catch(a){console.error("[Chat] :",a)}return[]}function sj(a){try{localStorage.setItem(gN,JSON.stringify(a))}catch(l){console.error("[Chat] :",l)}}function AC({segment:a}){switch(a.type){case"text":return e.jsx("span",{className:"whitespace-pre-wrap",children:String(a.data)});case"image":case"emoji":return e.jsx("img",{src:String(a.data),alt:a.type==="emoji"?"":"",className:F("rounded-lg max-w-full",a.type==="emoji"?"max-h-32":"max-h-64"),loading:"lazy",onError:l=>{const r=l.target;r.style.display="none",r.parentElement?.insertAdjacentHTML("beforeend",`<span class="text-muted-foreground text-xs">[${a.type==="emoji"?"":""}]</span>`)}});case"voice":return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("audio",{controls:!0,src:String(a.data),className:"max-w-[200px] h-8",children:""})});case"video":return e.jsx("video",{controls:!0,src:String(a.data),className:"rounded-lg max-w-full max-h-64",children:""});case"face":return e.jsxs("span",{className:"text-muted-foreground",children:["[:",String(a.data),"]"]});case"music":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"file":return e.jsxs("span",{className:"text-muted-foreground",children:["[: ",String(a.data),"]"]});case"reply":return e.jsx("span",{className:"text-muted-foreground text-xs",children:"[]"});case"forward":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"unknown":default:return e.jsxs("span",{className:"text-muted-foreground",children:["[",a.original_type||"","]"]})}}function zC({message:a,isBot:l}){return a.message_type==="rich"&&a.segments&&a.segments.length>0?e.jsx("div",{className:"flex flex-col gap-2",children:a.segments.map((r,c)=>e.jsx(AC,{segment:r},c))}):e.jsx("span",{className:"whitespace-pre-wrap",children:a.content})}function RC(){const a={id:"webui-default",type:"webui",label:"WebUI",messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}},l=()=>{const He=MC().map(Ke=>{const Ze=Ke.virtualConfig;return!Ze.groupId&&Ze.platform&&Ze.userId&&(Ze.groupId=`webui_virtual_group_${Ze.platform}_${Ze.userId}`),{id:Ke.id,type:"virtual",label:Ke.label,virtualConfig:Ze,messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}}});return[a,...He]},[r,c]=u.useState(l),[d,m]=u.useState("webui-default"),h=r.find(q=>q.id===d)||r[0],[f,p]=u.useState(""),[g,N]=u.useState(!1),[j,b]=u.useState(!0),[y,w]=u.useState(TC()),[A,M]=u.useState(!1),[S,I]=u.useState(""),[E,C]=u.useState(!1),[R,H]=u.useState([]),[O,X]=u.useState([]),[L,me]=u.useState(!1),[Ne,je]=u.useState(!1),[ce,ge]=u.useState(""),[pe,D]=u.useState({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),Q=u.useRef(CC()),B=u.useRef(new Map),ue=u.useRef(null),Y=u.useRef(new Map),_e=u.useRef(0),he=u.useRef(new Map),{toast:Te}=nt(),G=q=>(_e.current+=1,`${q}-${Date.now()}-${_e.current}-${Math.random().toString(36).substr(2,9)}`),$=u.useCallback((q,He)=>{c(Ke=>Ke.map(Ze=>Ze.id===q?{...Ze,...He}:Ze))},[]),z=u.useCallback((q,He)=>{c(Ke=>Ke.map(Ze=>Ze.id===q?{...Ze,messages:[...Ze.messages,He]}:Ze))},[]),K=u.useCallback(()=>{ue.current?.scrollIntoView({behavior:"smooth"})},[]);u.useEffect(()=>{K()},[h?.messages,K]);const De=u.useCallback(async()=>{me(!0);try{const q=await Se("/api/chat/platforms");if(console.log("[Chat] :",q.status,q.headers.get("content-type")),q.ok){const He=q.headers.get("content-type");if(He&&He.includes("application/json")){const Ke=await q.json();console.log("[Chat] :",Ke),H(Ke.platforms||[])}else{const Ke=await q.text();console.error("[Chat] :  JSON :",Ke.substring(0,200)),Te({title:"",description:" MaiBot ",variant:"destructive"})}}else console.error("[Chat] : HTTP",q.status),Te({title:"",description:`: ${q.status}`,variant:"destructive"})}catch(q){console.error("[Chat] :",q),Te({title:"",description:"",variant:"destructive"})}finally{me(!1)}},[Te]),se=u.useCallback(async(q,He)=>{je(!0);try{const Ke=new URLSearchParams;q&&Ke.append("platform",q),He&&Ke.append("search",He),Ke.append("limit","50");const Ze=await Se(`/api/chat/persons?${Ke.toString()}`);if(Ze.ok){const Ts=Ze.headers.get("content-type");if(Ts&&Ts.includes("application/json")){const as=await Ze.json();X(as.persons||[])}else console.error("[Chat] :  JSON ")}}catch(Ke){console.error("[Chat] :",Ke)}finally{je(!1)}},[]);u.useEffect(()=>{pe.platform&&se(pe.platform,ce)},[pe.platform,ce,se]);const Le=u.useCallback(async(q,He)=>{b(!0);try{const Ke=new URLSearchParams;Ke.append("user_id",Q.current),Ke.append("limit","50"),He&&Ke.append("group_id",He);const Ze=`/api/chat/history?${Ke.toString()}`;console.log("[Chat] :",Ze);const Ts=await Se(Ze);if(Ts.ok){const as=await Ts.text();try{const Es=JSON.parse(as);if(Es.messages&&Es.messages.length>0){const es=Es.messages.map(ds=>({id:ds.id,type:ds.type,content:ds.content,timestamp:ds.timestamp,sender:{name:ds.sender_name||(ds.is_bot?"":"WebUI"),user_id:ds.user_id,is_bot:ds.is_bot}}));$(q,{messages:es});const Is=he.current.get(q)||new Set;es.forEach(ds=>{if(ds.type==="bot"){const is=`bot-${ds.content}-${Math.floor(ds.timestamp*1e3)}`;Is.add(is)}}),he.current.set(q,Is)}}catch(Es){console.error("[Chat] JSON :",Es)}}}catch(Ke){console.error("[Chat] :",Ke)}finally{b(!1)}},[$]),rs=u.useCallback(async(q,He,Ke)=>{const Ze=B.current.get(q);if(Ze?.readyState===WebSocket.OPEN||Ze?.readyState===WebSocket.CONNECTING){console.log(`[Tab ${q}] WebSocket `);return}N(!0);let Ts=null;try{const Is=await Se("/api/webui/ws-token");if(Is.ok){const ds=await Is.json();if(ds.success&&ds.token)Ts=ds.token;else{console.warn(`[Tab ${q}]  WebSocket token : ${ds.message||""}`),N(!1);return}}}catch(Is){console.error(`[Tab ${q}]  WebSocket token :`,Is),N(!1);return}if(!Ts){N(!1);return}const as=window.location.protocol==="https:"?"wss:":"ws:",Es=new URLSearchParams;Es.append("token",Ts),He==="virtual"&&Ke?(Es.append("user_id",Ke.userId),Es.append("user_name",Ke.userName),Es.append("platform",Ke.platform),Es.append("person_id",Ke.personId),Es.append("group_name",Ke.groupName||"WebUI"),Ke.groupId&&Es.append("group_id",Ke.groupId)):(Es.append("user_id",Q.current),Es.append("user_name",y));const es=`${as}//${window.location.host}/api/chat/ws?${Es.toString()}`;console.log(`[Tab ${q}]  WebSocket:`,es);try{const Is=new WebSocket(es);B.current.set(q,Is),Is.onopen=()=>{$(q,{isConnected:!0}),N(!1),console.log(`[Tab ${q}] WebSocket `)},Is.onmessage=ds=>{try{const is=JSON.parse(ds.data);switch(is.type){case"session_info":$(q,{sessionInfo:{session_id:is.session_id,user_id:is.user_id,user_name:is.user_name,bot_name:is.bot_name}});break;case"system":z(q,{id:G("sys"),type:"system",content:is.content||"",timestamp:is.timestamp||Date.now()/1e3});break;case"user_message":{const ws=is.sender?.user_id,it=He==="virtual"&&Ke?Ke.userId:Q.current;console.log(`[Tab ${q}]  user_message, sender: ${ws}, current: ${it}`);const vt=ws?ws.replace(/^webui_user_/,""):"",Ae=it?it.replace(/^webui_user_/,""):"";if(vt&&Ae&&vt===Ae){console.log(`[Tab ${q}] user_id `);break}const Ge=he.current.get(q)||new Set,Ls=`user-${is.content}-${Math.floor((is.timestamp||0)*1e3)}`;if(Ge.has(Ls)){console.log(`[Tab ${q}] `);break}if(Ge.add(Ls),he.current.set(q,Ge),Ge.size>100){const ct=Ge.values().next().value;ct&&Ge.delete(ct)}z(q,{id:is.message_id||G("user"),type:"user",content:is.content||"",timestamp:is.timestamp||Date.now()/1e3,sender:is.sender});break}case"bot_message":{$(q,{isTyping:!1});const ws=he.current.get(q)||new Set,it=`bot-${is.content}-${Math.floor((is.timestamp||0)*1e3)}`;if(ws.has(it))break;if(ws.add(it),he.current.set(q,ws),ws.size>100){const vt=ws.values().next().value;vt&&ws.delete(vt)}c(vt=>vt.map(Ae=>{if(Ae.id!==q)return Ae;const Ge=Ae.messages.filter(ct=>ct.type!=="thinking"),Ls={id:G("bot"),type:"bot",content:is.content||"",message_type:is.message_type==="rich"?"rich":"text",segments:is.segments,timestamp:is.timestamp||Date.now()/1e3,sender:is.sender};return{...Ae,messages:[...Ge,Ls]}}));break}case"typing":$(q,{isTyping:is.is_typing||!1});break;case"error":c(ws=>ws.map(it=>{if(it.id!==q)return it;const vt=it.messages.filter(Ae=>Ae.type!=="thinking");return{...it,messages:[...vt,{id:G("error"),type:"error",content:is.content||"",timestamp:is.timestamp||Date.now()/1e3}]}})),Te({title:"",description:is.content,variant:"destructive"});break;case"pong":break;case"history":{const ws=is.messages||[];if(ws.length>0){const it=he.current.get(q)||new Set,vt=ws.map(Ae=>{const Ge=Ae.is_bot||!1,Ls=Ae.id||G(Ge?"bot":"user"),ct=`${Ge?"bot":"user"}-${Ae.content}-${Math.floor(Ae.timestamp*1e3)}`;return it.add(ct),{id:Ls,type:Ge?"bot":"user",content:Ae.content,timestamp:Ae.timestamp,sender:{name:Ae.sender_name||(Ge?"":""),user_id:Ae.sender_id,is_bot:Ge}}});he.current.set(q,it),$(q,{messages:vt}),console.log(`[Tab ${q}]  ${vt.length} `)}break}default:console.log(":",is.type)}}catch(is){console.error(":",is)}},Is.onclose=()=>{$(q,{isConnected:!1}),N(!1),B.current.delete(q),console.log(`[Tab ${q}] WebSocket `);const ds=Y.current.get(q);ds&&clearTimeout(ds);const is=window.setTimeout(()=>{if(!J.current){const ws=r.find(it=>it.id===q);ws&&rs(q,ws.type,ws.virtualConfig)}},5e3);Y.current.set(q,is)},Is.onerror=ds=>{console.error(`[Tab ${q}] WebSocket :`,ds),N(!1)}}catch(Is){console.error(`[Tab ${q}]  WebSocket :`,Is),N(!1)}},[y,$,z,Te,r]),J=u.useRef(!1);u.useEffect(()=>{J.current=!1;const q=B.current,He=Y.current,Ke=he.current;Le("webui-default");const Ze=setTimeout(()=>{J.current||(rs("webui-default","webui"),r.forEach(as=>{as.type==="virtual"&&as.virtualConfig&&(Ke.set(as.id,new Set),setTimeout(()=>{J.current||rs(as.id,"virtual",as.virtualConfig)},200))}))},100),Ts=setInterval(()=>{q.forEach(as=>{as.readyState===WebSocket.OPEN&&as.send(JSON.stringify({type:"ping"}))})},3e4);return()=>{J.current=!0,clearTimeout(Ze),clearInterval(Ts),He.forEach(as=>{clearTimeout(as)}),He.clear(),q.forEach(as=>{as.close()}),q.clear()}},[]);const W=u.useCallback(()=>{const q=B.current.get(d);if(!f.trim()||!q||q.readyState!==WebSocket.OPEN)return;const He=h?.type==="virtual"&&h.virtualConfig?.userName||y,Ke=f.trim(),Ze=Date.now()/1e3;q.send(JSON.stringify({type:"message",content:Ke,user_name:He}));const Ts=he.current.get(d)||new Set,as=`user-${Ke}-${Math.floor(Ze*1e3)}`;if(Ts.add(as),he.current.set(d,Ts),Ts.size>100){const Is=Ts.values().next().value;Is&&Ts.delete(Is)}const Es={id:G("user"),type:"user",content:Ke,timestamp:Ze,sender:{name:He,is_bot:!1}};z(d,Es);const es={id:G("thinking"),type:"thinking",content:"",timestamp:Ze+.001,sender:{name:h?.sessionInfo.bot_name||"",is_bot:!0}};z(d,es),p("")},[f,y,d,h,z]),Ue=q=>{q.key==="Enter"&&!q.shiftKey&&(q.preventDefault(),W())},ae=()=>{I(y),M(!0)},Ee=()=>{const q=S.trim()||"WebUI";w(q),EC(q),M(!1);const He=B.current.get(d);He?.readyState===WebSocket.OPEN&&He.send(JSON.stringify({type:"update_nickname",user_name:q}))},de=()=>{I(""),M(!1)},Re=q=>new Date(q*1e3).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),ys=()=>{const q=B.current.get(d);q&&(q.close(),B.current.delete(d)),rs(d,h?.type||"webui",h?.virtualConfig)},Js=()=>{D({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),ge(""),De(),C(!0)},kt=()=>{if(!pe.platform||!pe.personId){Te({title:"",description:"",variant:"destructive"});return}const q=`webui_virtual_group_${pe.platform}_${pe.userId}`,He=`virtual-${pe.platform}-${pe.userId}-${Date.now()}`,Ke=pe.userName||pe.userId,Ze={id:He,type:"virtual",label:Ke,virtualConfig:{...pe,groupId:q},messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}};c(Ts=>{const as=[...Ts,Ze],Es=as.filter(es=>es.type==="virtual"&&es.virtualConfig).map(es=>({id:es.id,label:es.label,virtualConfig:es.virtualConfig,createdAt:Date.now()}));return sj(Es),as}),m(He),C(!1),he.current.set(He,new Set),setTimeout(()=>{rs(He,"virtual",pe)},100),Te({title:"",description:` ${Ke} `})},pa=(q,He)=>{if(He?.stopPropagation(),q==="webui-default")return;const Ke=B.current.get(q);Ke&&(Ke.close(),B.current.delete(q));const Ze=Y.current.get(q);Ze&&(clearTimeout(Ze),Y.current.delete(q)),he.current.delete(q),c(Ts=>{const as=Ts.filter(es=>es.id!==q),Es=as.filter(es=>es.type==="virtual"&&es.virtualConfig).map(es=>({id:es.id,label:es.label,virtualConfig:es.virtualConfig,createdAt:Date.now()}));return sj(Es),as}),d===q&&m("webui-default")},rt=q=>{m(q)},$s=q=>{D(He=>({...He,personId:q.person_id,userId:q.user_id,userName:q.nickname||q.person_name}))};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(Qs,{open:E,onOpenChange:C,children:e.jsxs(Hs,{className:"sm:max-w-[500px] max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(Mm,{className:"h-5 w-5"}),""]}),e.jsx(at,{children:""})]}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(qo,{className:"h-4 w-4"}),""]}),e.jsxs(Ie,{value:pe.platform,onValueChange:q=>{D(He=>({...He,platform:q,personId:"",userId:"",userName:""})),X([])},children:[e.jsx(Be,{disabled:L,children:e.jsx(Fe,{placeholder:L?"...":""})}),e.jsx(Pe,{children:R.map(q=>e.jsxs(Z,{value:q.platform,children:[q.platform," (",q.count," )"]},q.platform))})]})]}),pe.platform&&e.jsxs("div",{className:"space-y-2 flex-1 overflow-hidden flex flex-col",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:ce,onChange:q=>ge(q.target.value),className:"pl-9"})]}),e.jsx(ts,{className:"h-[250px] border rounded-md",children:e.jsx("div",{className:"p-2",children:Ne?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Fs,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):O.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ic,{className:"h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:""})]}):e.jsx("div",{className:"space-y-1",children:O.map(q=>e.jsxs("button",{onClick:()=>$s(q),className:F("w-full flex items-center gap-3 p-2 rounded-md text-left transition-colors",pe.personId===q.person_id?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(Zi,{className:"h-8 w-8 shrink-0",children:e.jsx(Wi,{className:F("text-xs",pe.personId===q.person_id?"bg-primary-foreground/20":"bg-muted"),children:(q.nickname||q.person_name||"?").charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate",children:q.nickname||q.person_name}),e.jsxs("div",{className:F("text-xs truncate",pe.personId===q.person_id?"text-primary-foreground/70":"text-muted-foreground"),children:["ID: ",q.user_id,q.is_known&&"  "]})]})]},q.person_id))})})})]}),pe.personId&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsx(le,{placeholder:"WebUI",value:pe.groupName,onChange:q=>D(He=>({...He,groupName:q.target.value}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs(ft,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:()=>C(!1),children:""}),e.jsx(_,{onClick:kt,disabled:!pe.platform||!pe.personId,children:""})]})]})}),e.jsx("div",{className:"shrink-0 border-b bg-muted/30",children:e.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto py-1.5 scrollbar-thin",children:[r.map(q=>e.jsxs("div",{className:F("flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm whitespace-nowrap transition-colors cursor-pointer","hover:bg-muted",d===q.id?"bg-background shadow-sm border":"text-muted-foreground"),onClick:()=>rt(q.id),children:[q.type==="webui"?e.jsx(Ba,{className:"h-3.5 w-3.5"}):e.jsx(Mm,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"max-w-[100px] truncate",children:q.label}),e.jsx("span",{className:F("w-1.5 h-1.5 rounded-full",q.isConnected?"bg-green-500":"bg-muted-foreground/50")}),q.id!=="webui-default"&&e.jsx("span",{onClick:He=>pa(q.id,He),className:"ml-0.5 p-0.5 rounded hover:bg-muted-foreground/20 cursor-pointer",role:"button",tabIndex:0,onKeyDown:He=>{(He.key==="Enter"||He.key===" ")&&(He.preventDefault(),pa(q.id,He))},children:e.jsx(Sa,{className:"h-3 w-3"})})]},q.id)),e.jsx("button",{onClick:Js,className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-sm text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",title:"",children:e.jsx(Xs,{className:"h-3.5 w-3.5"})})]})})}),e.jsx("div",{className:"shrink-0 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(Zi,{className:"h-8 w-8 sm:h-10 sm:w-10 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Kn,{className:"h-4 w-4 sm:h-5 sm:w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:h?.sessionInfo.bot_name||""}),e.jsx("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:h?.isConnected?e.jsxs(e.Fragment,{children:[e.jsx(H1,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:""})]}):g?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(q1,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:""})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[j&&e.jsx(Fs,{className:"h-4 w-4 animate-spin text-muted-foreground"}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:ys,disabled:g,title:"",children:e.jsx(mt,{className:F("h-4 w-4",g&&"animate-spin")})})]})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:h?.type==="virtual"&&h.virtualConfig?e.jsxs(e.Fragment,{children:[e.jsx(Mm,{className:"h-3 w-3 text-primary"}),e.jsx("span",{children:""}),e.jsx("span",{className:"font-medium text-primary",children:h.virtualConfig.userName}),e.jsxs("span",{className:"text-xs",children:["(",h.virtualConfig.platform,")"]}),h.virtualConfig.groupName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:""}),e.jsxs("span",{className:"text-xs",children:["",h.virtualConfig.groupName]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx($l,{className:"h-3 w-3"}),e.jsx("span",{children:""}),A?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{value:S,onChange:q=>I(q.target.value),onKeyDown:q=>{q.key==="Enter"&&Ee(),q.key==="Escape"&&de()},className:"h-7 w-32",placeholder:"",autoFocus:!0}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:Ee,children:""}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:de,children:""})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:y}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:ae,title:"",children:e.jsx(V1,{className:"h-3 w-3"})})]})]})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ts,{className:"h-full",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto space-y-3 sm:space-y-4",children:[h?.messages.length===0&&!j&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(Kn,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsxs("p",{className:"text-sm",children:[" ",h?.sessionInfo.bot_name||""," "]})]}),h?.messages.map(q=>e.jsxs("div",{className:F("flex gap-2 sm:gap-3",q.type==="user"&&"flex-row-reverse",q.type==="system"&&"justify-center",q.type==="error"&&"justify-center"),children:[q.type==="system"&&e.jsx("div",{className:"text-xs text-muted-foreground bg-muted/50 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="error"&&e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="thinking"&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Kn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:"flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",children:[e.jsx("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||h?.sessionInfo.bot_name})}),e.jsx("div",{className:"bg-muted rounded-2xl rounded-tl-sm px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"..."})]})})]})]}),(q.type==="user"||q.type==="bot")&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:F("text-xs",q.type==="bot"?"bg-primary/10 text-primary":"bg-secondary text-secondary-foreground"),children:q.type==="bot"?e.jsx(Kn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):e.jsx($l,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:F("flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",q.type==="user"&&"items-end"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||(q.type==="bot"?h?.sessionInfo.bot_name:y)}),e.jsx("span",{children:Re(q.timestamp)})]}),e.jsx("div",{className:F("rounded-2xl px-3 py-2 text-sm break-words",q.type==="bot"?"bg-muted rounded-tl-sm":"bg-primary text-primary-foreground rounded-tr-sm"),children:e.jsx(zC,{message:q,isBot:q.type==="bot"})})]})]})]},q.id)),e.jsx("div",{ref:ue})]})})}),e.jsx("div",{className:"shrink-0 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:f,onChange:q=>p(q.target.value),onKeyDown:Ue,placeholder:h?.isConnected?"...":"...",disabled:!h?.isConnected,className:"flex-1 h-10 sm:h-10"}),e.jsx(_,{onClick:W,disabled:!h?.isConnected||!f.trim(),size:"icon",className:"h-10 w-10 shrink-0",children:e.jsx(G1,{className:"h-4 w-4"})})]})})})]})}var Tx="Radio",[DC,jN]=td(Tx),[OC,LC]=DC(Tx),vN=u.forwardRef((a,l)=>{const{__scopeRadio:r,name:c,checked:d=!1,required:m,disabled:h,value:f="on",onCheck:p,form:g,...N}=a,[j,b]=u.useState(null),y=ad(l,M=>b(M)),w=u.useRef(!1),A=j?g||!!j.closest("form"):!0;return e.jsxs(OC,{scope:r,checked:d,disabled:h,children:[e.jsx(sr.button,{type:"button",role:"radio","aria-checked":d,"data-state":wN(d),"data-disabled":h?"":void 0,disabled:h,value:f,...N,ref:y,onClick:Nn(a.onClick,M=>{d||p?.(),A&&(w.current=M.isPropagationStopped(),w.current||M.stopPropagation())})}),A&&e.jsx(yN,{control:j,bubbles:!w.current,name:c,value:f,checked:d,required:m,disabled:h,form:g,style:{transform:"translateX(-100%)"}})]})});vN.displayName=Tx;var NN="RadioIndicator",bN=u.forwardRef((a,l)=>{const{__scopeRadio:r,forceMount:c,...d}=a,m=LC(NN,r);return e.jsx(m1,{present:c||m.checked,children:e.jsx(sr.span,{"data-state":wN(m.checked),"data-disabled":m.disabled?"":void 0,...d,ref:l})})});bN.displayName=NN;var UC="RadioBubbleInput",yN=u.forwardRef(({__scopeRadio:a,control:l,checked:r,bubbles:c=!0,...d},m)=>{const h=u.useRef(null),f=ad(h,m),p=x1(r),g=h1(l);return u.useEffect(()=>{const N=h.current;if(!N)return;const j=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(j,"checked").set;if(p!==r&&y){const w=new Event("click",{bubbles:c});y.call(N,r),N.dispatchEvent(w)}},[p,r,c]),e.jsx(sr.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...d,tabIndex:-1,ref:f,style:{...d.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});yN.displayName=UC;function wN(a){return a?"checked":"unchecked"}var $C=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],fd="RadioGroup",[BC]=td(fd,[Mj,jN]),_N=Mj(),SN=jN(),[PC,IC]=BC(fd),kN=u.forwardRef((a,l)=>{const{__scopeRadioGroup:r,name:c,defaultValue:d,value:m,required:h=!1,disabled:f=!1,orientation:p,dir:g,loop:N=!0,onValueChange:j,...b}=a,y=_N(r),w=Qj(g),[A,M]=sd({prop:m,defaultProp:d??null,onChange:j,caller:fd});return e.jsx(PC,{scope:r,name:c,required:h,disabled:f,value:A,onValueChange:M,children:e.jsx(Tw,{asChild:!0,...y,orientation:p,dir:w,loop:N,children:e.jsx(sr.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":f?"":void 0,dir:w,...b,ref:l})})})});kN.displayName=fd;var CN="RadioGroupItem",TN=u.forwardRef((a,l)=>{const{__scopeRadioGroup:r,disabled:c,...d}=a,m=IC(CN,r),h=m.disabled||c,f=_N(r),p=SN(r),g=u.useRef(null),N=ad(l,g),j=m.value===d.value,b=u.useRef(!1);return u.useEffect(()=>{const y=A=>{$C.includes(A.key)&&(b.current=!0)},w=()=>b.current=!1;return document.addEventListener("keydown",y),document.addEventListener("keyup",w),()=>{document.removeEventListener("keydown",y),document.removeEventListener("keyup",w)}},[]),e.jsx(Ew,{asChild:!0,...f,focusable:!h,active:j,children:e.jsx(vN,{disabled:h,required:m.required,checked:j,...p,...d,name:m.name,ref:N,onCheck:()=>m.onValueChange(d.value),onKeyDown:Nn(y=>{y.key==="Enter"&&y.preventDefault()}),onFocus:Nn(d.onFocus,()=>{b.current&&g.current?.click()})})})});TN.displayName=CN;var FC="RadioGroupIndicator",EN=u.forwardRef((a,l)=>{const{__scopeRadioGroup:r,...c}=a,d=SN(r);return e.jsx(bN,{...d,...c,ref:l})});EN.displayName=FC;var MN=kN,AN=TN,HC=EN;const Ex=u.forwardRef(({className:a,...l},r)=>e.jsx(MN,{className:F("grid gap-2",a),...l,ref:r}));Ex.displayName=MN.displayName;const Xo=u.forwardRef(({className:a,...l},r)=>e.jsx(AN,{ref:r,className:F("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),...l,children:e.jsx(HC,{className:"flex items-center justify-center",children:e.jsx(Ho,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Xo.displayName=AN.displayName;function qC({question:a,value:l,onChange:r,error:c,disabled:d=!1}){const[m,h]=u.useState(null),f=d||a.readOnly,p=()=>{switch(a.type){case"single":return e.jsx(Ex,{value:l||"",onValueChange:r,disabled:f,className:"space-y-2",children:a.options?.map(g=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:g.value,id:`${a.id}-${g.id}`}),e.jsx(T,{htmlFor:`${a.id}-${g.id}`,className:"cursor-pointer font-normal",children:g.label})]},g.id))});case"multiple":{const g=l||[];return e.jsxs("div",{className:"space-y-2",children:[a.options?.map(N=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:`${a.id}-${N.id}`,checked:g.includes(N.value),disabled:f||a.maxSelections!==void 0&&g.length>=a.maxSelections&&!g.includes(N.value),onCheckedChange:j=>{r(j?[...g,N.value]:g.filter(b=>b!==N.value))}}),e.jsx(T,{htmlFor:`${a.id}-${N.id}`,className:"cursor-pointer font-normal",children:N.label})]},N.id)),a.maxSelections&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",a.maxSelections," "]})]})}case"text":return e.jsx(le,{value:l||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,className:F(a.readOnly&&"bg-muted cursor-not-allowed")});case"textarea":return e.jsxs("div",{className:"space-y-1",children:[e.jsx(ht,{value:l||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,rows:4,className:F(a.readOnly&&"bg-muted cursor-not-allowed")}),a.maxLength&&e.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[(l||"").length," / ",a.maxLength]})]});case"rating":{const g=l||0,N=m!==null?m:g;return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(j=>e.jsx("button",{type:"button",disabled:f,className:F("p-1 transition-colors focus:outline-none focus:ring-2 focus:ring-ring rounded",f&&"cursor-not-allowed opacity-50"),onMouseEnter:()=>!f&&h(j),onMouseLeave:()=>h(null),onClick:()=>!f&&r(j),children:e.jsx(fn,{className:F("h-6 w-6 transition-colors",j<=N?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},j)),g>0&&e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:[g," / 5"]})]})}case"scale":{const g=a.min??1,N=a.max??10,j=a.step??1,b=l??g;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Wa,{value:[b],onValueChange:([y])=>r(y),min:g,max:N,step:j,disabled:f}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:a.minLabel||g}),e.jsx("span",{className:"font-medium text-foreground",children:b}),e.jsx("span",{children:a.maxLabel||N})]})]})}case"dropdown":return e.jsxs(Ie,{value:l||"",onValueChange:r,disabled:f,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:a.placeholder||"..."})}),e.jsx(Pe,{children:a.options?.map(g=>e.jsx(Z,{value:g.value,children:g.label},g.id))})]});default:return e.jsx("div",{className:"text-muted-foreground",children:""})}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-base font-medium",children:[a.title,a.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),p(),c&&e.jsx("p",{className:"text-sm text-destructive",children:c})]})}const zN="https://maibot-plugin-stats.maibot-webui.workers.dev";function RN(){const a="maibot_user_id";let l=localStorage.getItem(a);if(!l){const r=Math.random().toString(36).substring(2,10),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,10);l=`fp_${r}_${c}_${d}`,localStorage.setItem(a,l)}return l}async function VC(a,l,r,c){try{const d=c?.userId||RN(),m={surveyId:a,surveyVersion:l,userId:d,answers:r,submittedAt:new Date().toISOString(),allowMultiple:c?.allowMultiple,metadata:{userAgent:navigator.userAgent,language:navigator.language}},h=await fetch(`${zN}/survey/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),f=await h.json();return h.status===429?{success:!1,error:""}:h.status===409?{success:!1,error:f.error||""}:h.ok?{success:!0,submissionId:f.submissionId,message:f.message}:{success:!1,error:f.error||""}}catch(d){return console.error("Error submitting survey:",d),{success:!1,error:""}}}async function GC(a,l){try{const r=l||RN(),c=new URLSearchParams({user_id:r,survey_id:a}),d=await fetch(`${zN}/survey/check?${c}`);return d.ok?{success:!0,hasSubmitted:(await d.json()).hasSubmitted}:{success:!1,error:(await d.json()).error||""}}catch(r){return console.error("Error checking submission:",r),{success:!1,error:""}}}function DN({config:a,initialAnswers:l,onSubmitSuccess:r,onSubmitError:c,showProgress:d=!0,paginateQuestions:m=!1,className:h}){const f=u.useCallback(()=>!l||l.length===0?{}:l.reduce((B,ue)=>(B[ue.questionId]=ue.value,B),{}),[l]),[p,g]=u.useState(()=>f()),[N,j]=u.useState({}),[b,y]=u.useState(0),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[I,E]=u.useState(null),[C,R]=u.useState(null),[H,O]=u.useState(!1),[X,L]=u.useState(!0);u.useEffect(()=>{l&&l.length>0&&g(B=>({...B,...f()}))},[l,f]),u.useEffect(()=>{(async()=>{if(!a.settings?.allowMultiple){const ue=await GC(a.id);ue.success&&ue.hasSubmitted&&O(!0)}L(!1)})()},[a.id,a.settings?.allowMultiple]);const me=u.useCallback(()=>{const B=new Date;return!(a.settings?.startTime&&new Date(a.settings.startTime)>B||a.settings?.endTime&&new Date(a.settings.endTime)<B)},[a.settings?.startTime,a.settings?.endTime]),Ne=a.questions.filter(B=>{const ue=p[B.id];return ue==null?!1:Array.isArray(ue)?ue.length>0:typeof ue=="string"?ue.trim()!=="":!0}).length,je=Ne/a.questions.length*100,ce=u.useCallback((B,ue)=>{g(Y=>({...Y,[B]:ue})),j(Y=>{const _e={...Y};return delete _e[B],_e})},[]),ge=u.useCallback(()=>{const B={};for(const ue of a.questions){if(ue.required){const Y=p[ue.id];if(Y==null){B[ue.id]="";continue}if(Array.isArray(Y)&&Y.length===0){B[ue.id]="";continue}if(typeof Y=="string"&&Y.trim()===""){B[ue.id]="";continue}}ue.minLength&&typeof p[ue.id]=="string"&&p[ue.id].length<ue.minLength&&(B[ue.id]=` ${ue.minLength} `)}return j(B),Object.keys(B).length===0},[a.questions,p]),pe=u.useCallback(async()=>{if(!ge()){if(m){const B=a.questions.findIndex(ue=>N[ue.id]);B>=0&&y(B)}return}A(!0),E(null);try{const B=a.questions.filter(Y=>p[Y.id]!==void 0).map(Y=>({questionId:Y.id,value:p[Y.id]})),ue=await VC(a.id,a.version,B,{allowMultiple:a.settings?.allowMultiple});if(ue.success&&ue.submissionId)S(!0),R(ue.submissionId),r?.(ue.submissionId);else{const Y=ue.error||"";E(Y),c?.(Y)}}catch(B){const ue=B instanceof Error?B.message:"";E(ue),c?.(ue)}finally{A(!1)}},[ge,m,a,p,N,r,c]),D=u.useCallback(B=>{B>=0&&B<a.questions.length&&y(B)},[a.questions.length]);if(X)return e.jsx(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:e.jsx(ze,{className:"py-12 flex items-center justify-center",children:e.jsx(Fs,{className:"h-6 w-6 animate-spin text-muted-foreground"})})});if(H&&!a.settings?.allowMultiple)return e.jsxs(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(Oe,{children:e.jsx($e,{children:a.title})}),e.jsx(ze,{className:"py-8",children:e.jsxs(pt,{children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]})})]});if(!me())return e.jsxs(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(Oe,{children:e.jsx($e,{children:a.title})}),e.jsx(ze,{className:"py-8",children:e.jsxs(pt,{variant:"destructive",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]})})]});if(M)return e.jsxs(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(Oe,{children:e.jsxs($e,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(st,{className:"h-6 w-6"}),""]})}),e.jsxs(ze,{className:"py-8",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:a.settings?.thankYouMessage||""}),C&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["",C]})]})]});const Q=m?[a.questions[b]]:a.questions;return e.jsxs("div",{className:F("h-full flex flex-col",h),children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 mb-4 shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:a.title}),a.description&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a.description}),d&&e.jsxs("div",{className:"space-y-1 pt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[Ne," / ",a.questions.length]})]}),e.jsx(er,{value:je,className:"h-2"})]})]}),e.jsx(ts,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[Q.map((B,ue)=>e.jsxs("div",{className:F("p-4 rounded-lg border bg-card",N[B.id]?"border-destructive bg-destructive/5":"border-border"),children:[m&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[" ",b+1," / ",a.questions.length]}),!m&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[ue+1,"."]}),e.jsx(qC,{question:B,value:p[B.id],onChange:Y=>ce(B.id,Y),error:N[B.id],disabled:w})]},B.id)),I&&e.jsxs(pt,{variant:"destructive",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:I})]}),e.jsx("div",{className:"flex justify-between items-center py-4",children:m?e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"outline",onClick:()=>D(b-1),disabled:b===0||w,children:[e.jsx(Pa,{className:"h-4 w-4 mr-1"}),""]}),b===a.questions.length-1?e.jsxs(_,{onClick:pe,disabled:w,children:[w&&e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),""]}):e.jsxs(_,{onClick:()=>D(b+1),disabled:w,children:["",e.jsx(ia,{className:"h-4 w-4 ml-1"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Object.keys(N).length>0&&e.jsxs("span",{className:"text-destructive",children:[" ",Object.keys(N).length," "]})}),e.jsxs(_,{onClick:pe,disabled:w,size:"lg",children:[w&&e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),""]})]})})]})})]})}const KC={id:"webui-feedback-v1",version:"1.0.0",title:" WebUI ",description:" WebUI",questions:[{id:"webui_version",type:"text",title:" WebUI ",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"ui_design_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"problems_encountered",type:"multiple",title:" WebUI ",description:"",required:!0,options:[{id:"lag",label:"",value:"lag"},{id:"incomplete",label:"",value:"incomplete"},{id:"complex",label:"",value:"complex"},{id:"bugs",label:" Bug",value:"bugs"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"useful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:" WebUI ",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}},QC={id:"maibot-feedback-v1",version:"1.0.0",title:"",description:" AI ",questions:[{id:"maibot_version",type:"text",title:"",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"improvement_areas",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"problems_encountered",type:"multiple",title:"",description:"",required:!0,options:[{id:"incomplete",label:"",value:"incomplete"},{id:"slow_response",label:"",value:"slow_response"},{id:"complex",label:"",value:"complex"},{id:"unstable",label:"",value:"unstable"},{id:"config_difficult",label:"",value:"config_difficult"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"helpful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:"",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:"",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}};function YC(){const[a,l]=u.useState(!0),r=u.useMemo(()=>JSON.parse(JSON.stringify(KC)),[]);u.useEffect(()=>{l(!1)},[]);const c=u.useMemo(()=>[{questionId:"webui_version",value:`v${od}`}],[]),d=u.useCallback(h=>{console.log("WebUI Survey submitted:",h)},[]),m=u.useCallback(h=>{console.error("WebUI Survey submission error:",h)},[]);return a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):r?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(xv,{className:"h-8 w-8",strokeWidth:2}),"WebUI "]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(DN,{config:r,initialAnswers:c,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:d,onSubmitError:m})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(pt,{variant:"destructive",className:"max-w-md",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}function JC(){const[a,l]=u.useState(null),[r,c]=u.useState(!0),[d,m]=u.useState("");u.useEffect(()=>{(async()=>{try{const j=await B_();m(j.version||"")}catch(j){console.error("Failed to get MaiBot version:",j),m("")}const N=JSON.parse(JSON.stringify(QC));l(N),c(!1)})()},[]);const h=u.useMemo(()=>[{questionId:"maibot_version",value:d}],[d]),f=u.useCallback(g=>{console.log("MaiBot Survey submitted:",g)},[]),p=u.useCallback(g=>{console.error("MaiBot Survey submission error:",g)},[]);return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(xv,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" AI "})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(DN,{config:a,initialAnswers:h,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:f,onSubmitError:p})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(pt,{variant:"destructive",className:"max-w-md",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}async function XC(a=2025){const l=await Se(`/api/webui/annual-report/full?year=${a}`);if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function ZC(a,l){if(a.match(/^[a-z]+:\/\//i))return a;if(a.match(/^\/\//))return window.location.protocol+a;if(a.match(/^[a-z]+:/i))return a;const r=document.implementation.createHTMLDocument(),c=r.createElement("base"),d=r.createElement("a");return r.head.appendChild(c),r.body.appendChild(d),l&&(c.href=l),d.href=a,d.href}const WC=(()=>{let a=0;const l=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(a+=1,`u${l()}${a}`)})();function vn(a){const l=[];for(let r=0,c=a.length;r<c;r++)l.push(a[r]);return l}let Fr=null;function ON(a={}){return Fr||(a.includeStyleProperties?(Fr=a.includeStyleProperties,Fr):(Fr=vn(window.getComputedStyle(document.documentElement)),Fr))}function Zo(a,l){const c=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(l);return c?parseFloat(c.replace("px","")):0}function e3(a){const l=Zo(a,"border-left-width"),r=Zo(a,"border-right-width");return a.clientWidth+l+r}function s3(a){const l=Zo(a,"border-top-width"),r=Zo(a,"border-bottom-width");return a.clientHeight+l+r}function LN(a,l={}){const r=l.width||e3(a),c=l.height||s3(a);return{width:r,height:c}}function t3(){let a,l;try{l=process}catch{}const r=l&&l.env?l.env.devicePixelRatio:null;return r&&(a=parseInt(r,10),Number.isNaN(a)&&(a=1)),a||window.devicePixelRatio||1}const Da=16384;function a3(a){(a.width>Da||a.height>Da)&&(a.width>Da&&a.height>Da?a.width>a.height?(a.height*=Da/a.width,a.width=Da):(a.width*=Da/a.height,a.height=Da):a.width>Da?(a.height*=Da/a.width,a.width=Da):(a.width*=Da/a.height,a.height=Da))}function Wo(a){return new Promise((l,r)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>l(c))})},c.onerror=r,c.crossOrigin="anonymous",c.decoding="async",c.src=a})}async function l3(a){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(a)).then(encodeURIComponent).then(l=>`data:image/svg+xml;charset=utf-8,${l}`)}async function n3(a,l,r){const c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg"),m=document.createElementNS(c,"foreignObject");return d.setAttribute("width",`${l}`),d.setAttribute("height",`${r}`),d.setAttribute("viewBox",`0 0 ${l} ${r}`),m.setAttribute("width","100%"),m.setAttribute("height","100%"),m.setAttribute("x","0"),m.setAttribute("y","0"),m.setAttribute("externalResourcesRequired","true"),d.appendChild(m),m.appendChild(a),l3(d)}const _a=(a,l)=>{if(a instanceof l)return!0;const r=Object.getPrototypeOf(a);return r===null?!1:r.constructor.name===l.name||_a(r,l)};function r3(a){const l=a.getPropertyValue("content");return`${a.cssText} content: '${l.replace(/'|"/g,"")}';`}function i3(a,l){return ON(l).map(r=>{const c=a.getPropertyValue(r),d=a.getPropertyPriority(r);return`${r}: ${c}${d?" !important":""};`}).join(" ")}function c3(a,l,r,c){const d=`.${a}:${l}`,m=r.cssText?r3(r):i3(r,c);return document.createTextNode(`${d}{${m}}`)}function tj(a,l,r,c){const d=window.getComputedStyle(a,r),m=d.getPropertyValue("content");if(m===""||m==="none")return;const h=WC();try{l.className=`${l.className} ${h}`}catch{return}const f=document.createElement("style");f.appendChild(c3(h,r,d,c)),l.appendChild(f)}function o3(a,l,r){tj(a,l,":before",r),tj(a,l,":after",r)}const aj="application/font-woff",lj="image/jpeg",d3={woff:aj,woff2:aj,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:lj,jpeg:lj,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function u3(a){const l=/\.([^./]*?)$/g.exec(a);return l?l[1]:""}function Mx(a){const l=u3(a).toLowerCase();return d3[l]||""}function m3(a){return a.split(/,/)[1]}function sx(a){return a.search(/^(data:)/)!==-1}function x3(a,l){return`data:${l};base64,${a}`}async function UN(a,l,r){const c=await fetch(a,l);if(c.status===404)throw new Error(`Resource "${c.url}" not found`);const d=await c.blob();return new Promise((m,h)=>{const f=new FileReader;f.onerror=h,f.onloadend=()=>{try{m(r({res:c,result:f.result}))}catch(p){h(p)}},f.readAsDataURL(d)})}const Gm={};function h3(a,l,r){let c=a.replace(/\?.*/,"");return r&&(c=a),/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,"")),l?`[${l}]${c}`:c}async function Ax(a,l,r){const c=h3(a,l,r.includeQueryParams);if(Gm[c]!=null)return Gm[c];r.cacheBust&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());let d;try{const m=await UN(a,r.fetchRequestInit,({res:h,result:f})=>(l||(l=h.headers.get("Content-Type")||""),m3(f)));d=x3(m,l)}catch(m){d=r.imagePlaceholder||"";let h=`Failed to fetch resource: ${a}`;m&&(h=typeof m=="string"?m:m.message),h&&console.warn(h)}return Gm[c]=d,d}async function f3(a){const l=a.toDataURL();return l==="data:,"?a.cloneNode(!1):Wo(l)}async function p3(a,l){if(a.currentSrc){const m=document.createElement("canvas"),h=m.getContext("2d");m.width=a.clientWidth,m.height=a.clientHeight,h?.drawImage(a,0,0,m.width,m.height);const f=m.toDataURL();return Wo(f)}const r=a.poster,c=Mx(r),d=await Ax(r,c,l);return Wo(d)}async function g3(a,l){var r;try{if(!((r=a?.contentDocument)===null||r===void 0)&&r.body)return await pd(a.contentDocument.body,l,!0)}catch{}return a.cloneNode(!1)}async function j3(a,l){return _a(a,HTMLCanvasElement)?f3(a):_a(a,HTMLVideoElement)?p3(a,l):_a(a,HTMLIFrameElement)?g3(a,l):a.cloneNode($N(a))}const v3=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SLOT",$N=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SVG";async function N3(a,l,r){var c,d;if($N(l))return l;let m=[];return v3(a)&&a.assignedNodes?m=vn(a.assignedNodes()):_a(a,HTMLIFrameElement)&&(!((c=a.contentDocument)===null||c===void 0)&&c.body)?m=vn(a.contentDocument.body.childNodes):m=vn(((d=a.shadowRoot)!==null&&d!==void 0?d:a).childNodes),m.length===0||_a(a,HTMLVideoElement)||await m.reduce((h,f)=>h.then(()=>pd(f,r)).then(p=>{p&&l.appendChild(p)}),Promise.resolve()),l}function b3(a,l,r){const c=l.style;if(!c)return;const d=window.getComputedStyle(a);d.cssText?(c.cssText=d.cssText,c.transformOrigin=d.transformOrigin):ON(r).forEach(m=>{let h=d.getPropertyValue(m);m==="font-size"&&h.endsWith("px")&&(h=`${Math.floor(parseFloat(h.substring(0,h.length-2)))-.1}px`),_a(a,HTMLIFrameElement)&&m==="display"&&h==="inline"&&(h="block"),m==="d"&&l.getAttribute("d")&&(h=`path(${l.getAttribute("d")})`),c.setProperty(m,h,d.getPropertyPriority(m))})}function y3(a,l){_a(a,HTMLTextAreaElement)&&(l.innerHTML=a.value),_a(a,HTMLInputElement)&&l.setAttribute("value",a.value)}function w3(a,l){if(_a(a,HTMLSelectElement)){const c=Array.from(l.children).find(d=>a.value===d.getAttribute("value"));c&&c.setAttribute("selected","")}}function _3(a,l,r){return _a(l,Element)&&(b3(a,l,r),o3(a,l,r),y3(a,l),w3(a,l)),l}async function S3(a,l){const r=a.querySelectorAll?a.querySelectorAll("use"):[];if(r.length===0)return a;const c={};for(let m=0;m<r.length;m++){const f=r[m].getAttribute("xlink:href");if(f){const p=a.querySelector(f),g=document.querySelector(f);!p&&g&&!c[f]&&(c[f]=await pd(g,l,!0))}}const d=Object.values(c);if(d.length){const m="http://www.w3.org/1999/xhtml",h=document.createElementNS(m,"svg");h.setAttribute("xmlns",m),h.style.position="absolute",h.style.width="0",h.style.height="0",h.style.overflow="hidden",h.style.display="none";const f=document.createElementNS(m,"defs");h.appendChild(f);for(let p=0;p<d.length;p++)f.appendChild(d[p]);a.appendChild(h)}return a}async function pd(a,l,r){return!r&&l.filter&&!l.filter(a)?null:Promise.resolve(a).then(c=>j3(c,l)).then(c=>N3(a,c,l)).then(c=>_3(a,c,l)).then(c=>S3(c,l))}const BN=/url\((['"]?)([^'"]+?)\1\)/g,k3=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,C3=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function T3(a){const l=a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${l})(['"]?\\))`,"g")}function E3(a){const l=[];return a.replace(BN,(r,c,d)=>(l.push(d),r)),l.filter(r=>!sx(r))}async function M3(a,l,r,c,d){try{const m=r?ZC(l,r):l,h=Mx(l);let f;return d||(f=await Ax(m,h,c)),a.replace(T3(l),`$1${f}$3`)}catch{}return a}function A3(a,{preferredFontFormat:l}){return l?a.replace(C3,r=>{for(;;){const[c,,d]=k3.exec(r)||[];if(!d)return"";if(d===l)return`src: ${c};`}}):a}function PN(a){return a.search(BN)!==-1}async function IN(a,l,r){if(!PN(a))return a;const c=A3(a,r);return E3(c).reduce((m,h)=>m.then(f=>M3(f,h,l,r)),Promise.resolve(c))}async function Hr(a,l,r){var c;const d=(c=l.style)===null||c===void 0?void 0:c.getPropertyValue(a);if(d){const m=await IN(d,null,r);return l.style.setProperty(a,m,l.style.getPropertyPriority(a)),!0}return!1}async function z3(a,l){await Hr("background",a,l)||await Hr("background-image",a,l),await Hr("mask",a,l)||await Hr("-webkit-mask",a,l)||await Hr("mask-image",a,l)||await Hr("-webkit-mask-image",a,l)}async function R3(a,l){const r=_a(a,HTMLImageElement);if(!(r&&!sx(a.src))&&!(_a(a,SVGImageElement)&&!sx(a.href.baseVal)))return;const c=r?a.src:a.href.baseVal,d=await Ax(c,Mx(c),l);await new Promise((m,h)=>{a.onload=m,a.onerror=l.onImageErrorHandler?(...p)=>{try{m(l.onImageErrorHandler(...p))}catch(g){h(g)}}:h;const f=a;f.decode&&(f.decode=m),f.loading==="lazy"&&(f.loading="eager"),r?(a.srcset="",a.src=d):a.href.baseVal=d})}async function D3(a,l){const c=vn(a.childNodes).map(d=>FN(d,l));await Promise.all(c).then(()=>a)}async function FN(a,l){_a(a,Element)&&(await z3(a,l),await R3(a,l),await D3(a,l))}function O3(a,l){const{style:r}=a;l.backgroundColor&&(r.backgroundColor=l.backgroundColor),l.width&&(r.width=`${l.width}px`),l.height&&(r.height=`${l.height}px`);const c=l.style;return c!=null&&Object.keys(c).forEach(d=>{r[d]=c[d]}),a}const nj={};async function rj(a){let l=nj[a];if(l!=null)return l;const c=await(await fetch(a)).text();return l={url:a,cssText:c},nj[a]=l,l}async function ij(a,l){let r=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,m=(r.match(/url\([^)]+\)/g)||[]).map(async h=>{let f=h.replace(c,"$1");return f.startsWith("https://")||(f=new URL(f,a.url).href),UN(f,l.fetchRequestInit,({result:p})=>(r=r.replace(h,`url(${p})`),[h,p]))});return Promise.all(m).then(()=>r)}function cj(a){if(a==null)return[];const l=[],r=/(\/\*[\s\S]*?\*\/)/gi;let c=a.replace(r,"");const d=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=d.exec(c);if(p===null)break;l.push(p[0])}c=c.replace(d,"");const m=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,h="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",f=new RegExp(h,"gi");for(;;){let p=m.exec(c);if(p===null){if(p=f.exec(c),p===null)break;m.lastIndex=f.lastIndex}else f.lastIndex=m.lastIndex;l.push(p[0])}return l}async function L3(a,l){const r=[],c=[];return a.forEach(d=>{if("cssRules"in d)try{vn(d.cssRules||[]).forEach((m,h)=>{if(m.type===CSSRule.IMPORT_RULE){let f=h+1;const p=m.href,g=rj(p).then(N=>ij(N,l)).then(N=>cj(N).forEach(j=>{try{d.insertRule(j,j.startsWith("@import")?f+=1:d.cssRules.length)}catch(b){console.error("Error inserting rule from remote css",{rule:j,error:b})}})).catch(N=>{console.error("Error loading remote css",N.toString())});c.push(g)}})}catch(m){const h=a.find(f=>f.href==null)||document.styleSheets[0];d.href!=null&&c.push(rj(d.href).then(f=>ij(f,l)).then(f=>cj(f).forEach(p=>{h.insertRule(p,h.cssRules.length)})).catch(f=>{console.error("Error loading remote stylesheet",f)})),console.error("Error inlining remote css file",m)}}),Promise.all(c).then(()=>(a.forEach(d=>{if("cssRules"in d)try{vn(d.cssRules||[]).forEach(m=>{r.push(m)})}catch(m){console.error(`Error while reading CSS rules from ${d.href}`,m)}}),r))}function U3(a){return a.filter(l=>l.type===CSSRule.FONT_FACE_RULE).filter(l=>PN(l.style.getPropertyValue("src")))}async function $3(a,l){if(a.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=vn(a.ownerDocument.styleSheets),c=await L3(r,l);return U3(c)}function HN(a){return a.trim().replace(/["']/g,"")}function B3(a){const l=new Set;function r(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(m=>{l.add(HN(m))}),Array.from(c.children).forEach(m=>{m instanceof HTMLElement&&r(m)})}return r(a),l}async function P3(a,l){const r=await $3(a,l),c=B3(a);return(await Promise.all(r.filter(m=>c.has(HN(m.style.fontFamily))).map(m=>{const h=m.parentStyleSheet?m.parentStyleSheet.href:null;return IN(m.cssText,h,l)}))).join(`
`)}async function I3(a,l){const r=l.fontEmbedCSS!=null?l.fontEmbedCSS:l.skipFonts?null:await P3(a,l);if(r){const c=document.createElement("style"),d=document.createTextNode(r);c.appendChild(d),a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}}async function F3(a,l={}){const{width:r,height:c}=LN(a,l),d=await pd(a,l,!0);return await I3(d,l),await FN(d,l),O3(d,l),await n3(d,r,c)}async function H3(a,l={}){const{width:r,height:c}=LN(a,l),d=await F3(a,l),m=await Wo(d),h=document.createElement("canvas"),f=h.getContext("2d"),p=l.pixelRatio||t3(),g=l.canvasWidth||r,N=l.canvasHeight||c;return h.width=g*p,h.height=N*p,l.skipAutoScale||a3(h),h.style.width=`${g}`,h.style.height=`${N}`,l.backgroundColor&&(f.fillStyle=l.backgroundColor,f.fillRect(0,0,h.width,h.height)),f.drawImage(m,0,0,h.width,h.height),h}async function q3(a,l={}){return(await H3(a,l)).toDataURL()}const Lo=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"];function V3(a){return a>=8760?"7x24":a>=5e3?"":a>=2e3?" 1000 ":a>=1e3?" 80 ":a>=500?" 100 ":a>=100?" 25 ":""}function G3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":""}function K3(a){const l=a/1e6;return l>=100?"":l>=50?"":l>=10?"":l>=1?"":""}function Q3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":a>=10?"":""}function Y3(a){return a>=80?"":a>=60?"":a>=40?"":a>=20?"":""}function J3(a){return a>=1e4?"":a>=5e3?"":a>=1e3?"":a>=500?"":a>=100?"":""}function X3(a){return a>=500?"":a>=200?"":a>=100?"":a>=50?"":a>=10?"":""}function Z3(a){return a>=1?"":a>=.5?"":a>=.1?"":a>=.01?"":""}function W3(a,l){return a>=100?"":a>=50?"":a>=20?`${l}`:a>=10?"":""}function e5(a,l){return a?l>=1e3?"":l>=500?"":l>=100?"":"":l<=10?"":l<=50?"":""}function s5(a){return a>=1e3?"":a>=500?"":a>=200?"":a>=100?"":a>=50?"":""}function t5(){const[a]=u.useState(2025),[l,r]=u.useState(null),[c,d]=u.useState(!0),[m,h]=u.useState(!1),[f,p]=u.useState(null),g=u.useRef(null),{toast:N}=nt(),j=u.useCallback(async()=>{try{d(!0),p(null);const y=await XC(a);r(y)}catch(y){p(y instanceof Error?y:new Error(""))}finally{d(!1)}},[a]),b=u.useCallback(async()=>{if(!(!g.current||!l)){h(!0),N({title:"",description:"..."});try{const y=g.current,w=getComputedStyle(document.documentElement),A=w.getPropertyValue("--background").trim()?`hsl(${w.getPropertyValue("--background").trim()})`:document.documentElement.classList.contains("dark")?"#0a0a0a":"#ffffff",M=y.style.width,S=y.style.maxWidth;y.style.width="1024px",y.style.maxWidth="1024px";const I=await q3(y,{quality:1,pixelRatio:2,backgroundColor:A,cacheBust:!0,filter:C=>!(C instanceof HTMLElement&&C.hasAttribute("data-export-btn"))});y.style.width=M,y.style.maxWidth=S;const E=document.createElement("a");E.download=`${l.bot_name}_${l.year}_.png`,E.href=I,E.click(),N({title:"",description:""})}catch(y){console.error(":",y),N({title:"",description:"",variant:"destructive"})}finally{h(!1)}}},[l,N]);return u.useEffect(()=>{j()},[j]),c?e.jsx(a5,{}):f?e.jsxs("div",{className:"flex h-screen items-center justify-center text-red-500",children:[": ",f.message]}):l?e.jsx(ts,{className:"h-[calc(100vh-4rem)]",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/50 p-4 md:p-8 print:p-0",ref:g,children:e.jsxs("div",{className:"mx-auto max-w-5xl space-y-8 print:space-y-4",children:[e.jsxs("header",{className:"relative overflow-hidden rounded-3xl bg-primary p-8 text-primary-foreground shadow-2xl print:rounded-none print:shadow-none",children:[e.jsx("div",{className:"absolute right-4 top-4 z-20 print:hidden","data-export-btn":!0,children:e.jsx(_,{variant:"secondary",size:"sm",onClick:b,disabled:m,className:"gap-2 bg-white/20 hover:bg-white/30 text-white border-white/30",children:m?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ra,{className:"h-4 w-4"}),""]})})}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx(Kn,{className:"mb-4 h-16 w-16 animate-bounce"}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tighter sm:text-6xl",children:[l.bot_name," ",l.year," "]}),e.jsx("p",{className:"mt-4 max-w-2xl text-lg opacity-90",children:"  Connection & Growth"}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-sm opacity-75",children:[e.jsx(Vo,{className:"h-4 w-4"}),e.jsxs("span",{children:[": ",l.generated_at]})]})]}),e.jsx("div",{className:"absolute -right-20 -top-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ca,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Oa,{title:"",value:`${l.time_footprint.total_online_hours} `,description:V3(l.time_footprint.total_online_hours),icon:e.jsx(ca,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.time_footprint.busiest_day||"N/A",description:s5(l.time_footprint.busiest_day_count),icon:e.jsx(Vo,{className:"h-4 w-4"})}),e.jsx(Oa,{title:" (0-4)",value:`${l.time_footprint.midnight_chat_count} `,description:G3(l.time_footprint.midnight_chat_count),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.time_footprint.is_night_owl?"":"",description:e5(l.time_footprint.is_night_owl,l.time_footprint.midnight_chat_count),icon:l.time_footprint.is_night_owl?e.jsx(ec,{className:"h-4 w-4"}):e.jsx(nx,{className:"h-4 w-4"})})]}),e.jsxs(Ce,{className:"overflow-hidden",children:[e.jsxs(Oe,{children:[e.jsx($e,{children:"24"}),e.jsxs(Ns,{children:[l.bot_name,""]})]}),e.jsx(ze,{className:"h-[300px]",children:e.jsx(Rj,{width:"100%",height:"100%",children:e.jsxs(Uo,{data:l.time_footprint.hourly_distribution.map((y,w)=>({hour:`${w}`,count:y})),children:[e.jsx(Qi,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Yi,{dataKey:"hour"}),e.jsx(qr,{}),e.jsx(Dj,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},cursor:{fill:"transparent"}}),e.jsx(Ji,{dataKey:"count",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),l.time_footprint.first_message_time&&e.jsx(Ce,{className:"bg-muted/30 border-dashed",children:e.jsxs(ze,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"2025"}),e.jsx("div",{className:"text-xl font-bold text-primary mb-1",children:l.time_footprint.first_message_time}),e.jsxs("p",{className:"text-lg",children:[e.jsx("span",{className:"font-semibold text-foreground",children:l.time_footprint.first_message_user})," ",e.jsxs("span",{className:"italic text-muted-foreground",children:['"',l.time_footprint.first_message_content,'"']})]})]})})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ic,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(Oa,{title:"",value:`${l.social_network.total_groups} `,description:`${l.bot_name}`,icon:e.jsx(ic,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:`${l.social_network.at_count+l.social_network.mentioned_count} `,description:"",icon:e.jsx(K1,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.social_network.longest_companion_user||"N/A",description:` ${l.social_network.longest_companion_days} `,icon:e.jsx(Zr,{className:"h-4 w-4 text-red-500"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsx($e,{children:" TOP5"})}),e.jsx(ze,{children:e.jsx("div",{className:"space-y-3",children:l.social_network.top_groups.length>0?l.social_network.top_groups.map((y,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:w===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:w+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:y.group_name}),y.is_webui&&e.jsx(ke,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[y.message_count," "]})]},y.group_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]}),e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsx($e,{children:" TOP5"})}),e.jsx(ze,{children:e.jsx("div",{className:"space-y-3",children:l.social_network.top_users.length>0?l.social_network.top_users.map((y,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:w===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:w+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:y.user_nickname}),y.is_webui&&e.jsx(ke,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[y.message_count," "]})]},y.user_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ux,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Oa,{title:" Token ",value:(l.brain_power.total_tokens/1e6).toFixed(2)+" M",description:K3(l.brain_power.total_tokens),icon:e.jsx(el,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:`$${l.brain_power.total_cost.toFixed(2)}`,description:Q3(l.brain_power.total_cost),icon:e.jsx("span",{className:"font-bold",children:"$"})}),e.jsx(Oa,{title:"",value:`${l.brain_power.silence_rate}%`,description:Y3(l.brain_power.silence_rate),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.brain_power.max_interest_value??"N/A",description:l.brain_power.max_interest_time?` ${l.brain_power.max_interest_time}`:"",icon:e.jsx(Zr,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(Oe,{children:e.jsx($e,{children:""})}),e.jsx(ze,{children:e.jsx("div",{className:"space-y-3",children:l.brain_power.model_distribution.slice(0,5).map((y,w)=>{const A=l.brain_power.model_distribution[0]?.count||1,M=Math.round(y.count/A*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:y.model}),e.jsxs("span",{className:"text-muted-foreground",children:[y.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${M}%`,backgroundColor:Lo[w%Lo.length]}})})]},y.model)})})})]}),l.brain_power.top_reply_models&&l.brain_power.top_reply_models.length>0&&e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:" TOP5"}),e.jsxs(Ns,{children:[l.bot_name,""]})]}),e.jsx(ze,{children:e.jsx("div",{className:"space-y-3",children:l.brain_power.top_reply_models.map((y,w)=>{const A=l.brain_power.top_reply_models[0]?.count||1,M=Math.round(y.count/A*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:y.model}),e.jsxs("span",{className:"text-muted-foreground",children:[y.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${M}%`,backgroundColor:Lo[w%Lo.length]}})})]},y.model)})})})]}),l.brain_power.top_token_consumers&&l.brain_power.top_token_consumers.length>0&&e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:" TOP3"}),e.jsx(Ns,{children:" API "})]}),e.jsx(ze,{children:e.jsx("div",{className:"space-y-6",children:l.brain_power.top_token_consumers.map(y=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsxs("span",{children:[" ",y.user_id]}),e.jsxs("span",{children:["$",y.cost.toFixed(2)]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-500",style:{width:`${y.cost/(l.brain_power.top_token_consumers[0]?.cost||1)*100}%`}})})]},y.user_id))})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20",children:[e.jsx(Oe,{children:e.jsxs($e,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(ze,{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-amber-600 dark:text-amber-400",children:["$",l.brain_power.most_expensive_cost.toFixed(4)]}),l.brain_power.most_expensive_time&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[" ",l.brain_power.most_expensive_time]}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:Z3(l.brain_power.most_expensive_cost)})]})]}),e.jsxs(Ce,{className:"bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-950/20 dark:to-blue-950/20",children:[e.jsx(Oe,{children:e.jsxs($e,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(ze,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:l.brain_power.avg_reasoning_length?.toFixed(0)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:l.brain_power.max_reasoning_length?.toLocaleString()||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]}),l.brain_power.max_reasoning_time&&e.jsxs("p",{className:"mt-4 text-center text-xs text-muted-foreground",children:[" ",l.brain_power.max_reasoning_time]})]})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ld,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),(l.expression_vibe.late_night_reply||l.expression_vibe.favorite_reply)&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[l.expression_vibe.late_night_reply&&e.jsxs(Ce,{className:"bg-gradient-to-br from-indigo-50 to-violet-50 dark:from-indigo-950/20 dark:to-violet-950/20",children:[e.jsxs(Oe,{children:[e.jsxs($e,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(Ns,{children:[" ",l.expression_vibe.late_night_reply.time,"",l.bot_name,"..."]})]}),e.jsxs(ze,{className:"text-center",children:[e.jsxs("p",{className:"text-lg italic text-muted-foreground",children:['"',l.expression_vibe.late_night_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:""})]})]}),l.expression_vibe.favorite_reply&&e.jsxs(Ce,{className:"bg-gradient-to-br from-rose-50 to-pink-50 dark:from-rose-950/20 dark:to-pink-950/20",children:[e.jsxs(Oe,{children:[e.jsxs($e,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(Ns,{children:[" ",l.expression_vibe.favorite_reply.count," "]})]}),e.jsxs(ze,{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-medium text-primary",children:['"',l.expression_vibe.favorite_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:W3(l.expression_vibe.favorite_reply.count,l.bot_name)})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/20 dark:to-purple-950/20",children:[e.jsxs(Oe,{children:[e.jsx($e,{children:" TOP3"}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:l.expression_vibe.top_emojis&&l.expression_vibe.top_emojis.length>0?e.jsx("div",{className:"flex justify-center gap-4",children:l.expression_vibe.top_emojis.slice(0,3).map((y,w)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/api/webui/emoji/${y.id}/thumbnail?original=true`,alt:`TOP ${w+1}`,className:"h-24 w-24 rounded-lg object-cover shadow-md transition-transform hover:scale-105"}),e.jsx(ke,{className:F("absolute -top-2 -right-2",w===0?"bg-yellow-500":w===1?"bg-gray-400":"bg-amber-700"),children:w+1})]}),e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[y.usage_count," "]})]},y.id))}):e.jsx("div",{className:"flex h-32 items-center justify-center text-muted-foreground",children:""})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsxs(Ns,{children:[l.bot_name,""]})]}),e.jsx(ze,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:l.expression_vibe.top_expressions.map((y,w)=>e.jsxs(ke,{variant:"outline",className:F("px-3 py-1 text-sm",w===0&&"border-primary bg-primary/10 text-primary text-base px-4 py-2"),children:[y.style," (",y.count,")"]},y.style))})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Oa,{title:"",value:`${l.expression_vibe.image_processed_count} `,description:J3(l.expression_vibe.image_processed_count),icon:e.jsx(dx,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:`${l.expression_vibe.rejected_expression_count} `,description:X3(l.expression_vibe.rejected_expression_count),icon:e.jsx(el,{className:"h-4 w-4"})})]})]})]}),l.expression_vibe.action_types.length>0&&e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsxs($e,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:l.expression_vibe.action_types.map(y=>e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2",children:[e.jsx("span",{className:"font-medium text-primary",children:y.action}),e.jsxs(ke,{variant:"secondary",children:[y.count," "]})]},y.action))})})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(Q1,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(Ce,{className:"col-span-1 md:col-span-2",children:[e.jsxs(Oe,{children:[e.jsx($e,{children:'""'}),e.jsxs(Ns,{children:[" ",l.achievements.new_jargon_count," "]})]}),e.jsx(ze,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:l.achievements.sample_jargons.map(y=>e.jsxs("div",{className:"group relative rounded-lg border bg-card p-3 shadow-sm transition-all hover:shadow-md",children:[e.jsx("div",{className:"font-bold text-primary",children:y.content}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2 max-w-[200px]",children:y.meaning||""})]},y.content))})})]}),e.jsx(Ce,{className:"flex flex-col justify-center items-center bg-primary text-primary-foreground",children:e.jsxs(ze,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Ba,{className:"h-12 w-12 mb-4 opacity-80"}),e.jsx("div",{className:"text-4xl font-bold mb-2",children:l.achievements.total_messages.toLocaleString()}),e.jsx("div",{className:"text-sm opacity-80",children:""}),e.jsxs("div",{className:"mt-4 text-xs opacity-60",children:[" ",l.achievements.total_replies.toLocaleString()," "]})]})})]})]}),e.jsxs("footer",{className:"mt-12 text-center text-muted-foreground",children:[e.jsx("p",{children:"MaiBot 2025 Annual Report"}),e.jsx("p",{className:"text-sm",children:"Generated with  by MaiBot Team"})]})]})})}):null}function Oa({title:a,value:l,description:r,icon:c}){return e.jsxs(Ce,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx($e,{className:"text-sm font-medium",children:a}),e.jsx("div",{className:"text-muted-foreground",children:c})]}),e.jsxs(ze,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function a5(){return e.jsxs("div",{className:"container mx-auto space-y-8 p-8",children:[e.jsx(Ms,{className:"h-64 w-full rounded-3xl"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((a,l)=>e.jsx(Ms,{className:"h-32 w-full"},l))}),e.jsx(Ms,{className:"h-96 w-full"})]})}var gd="DropdownMenu",[l5]=td(gd,[Aj]),fa=Aj(),[n5,qN]=l5(gd),VN=a=>{const{__scopeDropdownMenu:l,children:r,dir:c,open:d,defaultOpen:m,onOpenChange:h,modal:f=!0}=a,p=fa(l),g=u.useRef(null),[N,j]=sd({prop:d,defaultProp:m??!1,onChange:h,caller:gd});return e.jsx(n5,{scope:l,triggerId:Qm(),triggerRef:g,contentId:Qm(),open:N,onOpenChange:j,onOpenToggle:u.useCallback(()=>j(b=>!b),[j]),modal:f,children:e.jsx(Pw,{...p,open:N,onOpenChange:j,dir:c,modal:f,children:r})})};VN.displayName=gd;var GN="DropdownMenuTrigger",KN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,disabled:c=!1,...d}=a,m=qN(GN,r),h=fa(r);return e.jsx(Iw,{asChild:!0,...h,children:e.jsx(sr.button,{type:"button",id:m.triggerId,"aria-haspopup":"menu","aria-expanded":m.open,"aria-controls":m.open?m.contentId:void 0,"data-state":m.open?"open":"closed","data-disabled":c?"":void 0,disabled:c,...d,ref:f1(l,m.triggerRef),onPointerDown:Nn(a.onPointerDown,f=>{!c&&f.button===0&&f.ctrlKey===!1&&(m.onOpenToggle(),m.open||f.preventDefault())}),onKeyDown:Nn(a.onKeyDown,f=>{c||(["Enter"," "].includes(f.key)&&m.onOpenToggle(),f.key==="ArrowDown"&&m.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});KN.displayName=GN;var r5="DropdownMenuPortal",QN=a=>{const{__scopeDropdownMenu:l,...r}=a,c=fa(l);return e.jsx(zw,{...c,...r})};QN.displayName=r5;var YN="DropdownMenuContent",JN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=qN(YN,r),m=fa(r),h=u.useRef(!1);return e.jsx(Rw,{id:d.contentId,"aria-labelledby":d.triggerId,...m,...c,ref:l,onCloseAutoFocus:Nn(a.onCloseAutoFocus,f=>{h.current||d.triggerRef.current?.focus(),h.current=!1,f.preventDefault()}),onInteractOutside:Nn(a.onInteractOutside,f=>{const p=f.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,N=p.button===2||g;(!d.modal||N)&&(h.current=!0)}),style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});JN.displayName=YN;var i5="DropdownMenuGroup",c5=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Fw,{...d,...c,ref:l})});c5.displayName=i5;var o5="DropdownMenuLabel",XN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx($w,{...d,...c,ref:l})});XN.displayName=o5;var d5="DropdownMenuItem",ZN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Dw,{...d,...c,ref:l})});ZN.displayName=d5;var u5="DropdownMenuCheckboxItem",WN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Ow,{...d,...c,ref:l})});WN.displayName=u5;var m5="DropdownMenuRadioGroup",x5=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Hw,{...d,...c,ref:l})});x5.displayName=m5;var h5="DropdownMenuRadioItem",eb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Uw,{...d,...c,ref:l})});eb.displayName=h5;var f5="DropdownMenuItemIndicator",sb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Lw,{...d,...c,ref:l})});sb.displayName=f5;var p5="DropdownMenuSeparator",tb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Bw,{...d,...c,ref:l})});tb.displayName=p5;var g5="DropdownMenuArrow",j5=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(qw,{...d,...c,ref:l})});j5.displayName=g5;var v5="DropdownMenuSubTrigger",ab=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Mw,{...d,...c,ref:l})});ab.displayName=v5;var N5="DropdownMenuSubContent",lb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=fa(r);return e.jsx(Aw,{...d,...c,ref:l,style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});lb.displayName=N5;var b5=VN,y5=KN,w5=QN,nb=JN,rb=XN,ib=ZN,cb=WN,ob=eb,db=sb,ub=tb,mb=ab,xb=lb;const _5=b5,S5=y5,k5=u.forwardRef(({className:a,inset:l,children:r,...c},d)=>e.jsxs(mb,{ref:d,className:F("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",a),...c,children:[r,e.jsx(ia,{className:"ml-auto h-4 w-4"})]}));k5.displayName=mb.displayName;const C5=u.forwardRef(({className:a,...l},r)=>e.jsx(xb,{ref:r,className:F("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l}));C5.displayName=xb.displayName;const hb=u.forwardRef(({className:a,sideOffset:l=4,...r},c)=>e.jsx(w5,{children:e.jsx(nb,{ref:c,sideOffset:l,className:F("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}));hb.displayName=nb.displayName;const fb=u.forwardRef(({className:a,inset:l,...r},c)=>e.jsx(ib,{ref:c,className:F("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",a),...r}));fb.displayName=ib.displayName;const T5=u.forwardRef(({className:a,children:l,checked:r,...c},d)=>e.jsxs(cb,{ref:d,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(db,{children:e.jsx(Lt,{className:"h-4 w-4"})})}),l]}));T5.displayName=cb.displayName;const E5=u.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(ob,{ref:c,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(db,{children:e.jsx(Ho,{className:"h-2 w-2 fill-current"})})}),l]}));E5.displayName=ob.displayName;const M5=u.forwardRef(({className:a,inset:l,...r},c)=>e.jsx(rb,{ref:c,className:F("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",a),...r}));M5.displayName=rb.displayName;const A5=u.forwardRef(({className:a,...l},r)=>e.jsx(ub,{ref:r,className:F("-mx-1 my-1 h-px bg-muted",a),...l}));A5.displayName=ub.displayName;const Km=[{value:"created_at",label:"",icon:ca},{value:"downloads",label:"",icon:ra},{value:"likes",label:"",icon:Zr}];function z5(){const a=ha(),[l,r]=u.useState([]),[c,d]=u.useState(!0),[m,h]=u.useState(""),[f,p]=u.useState("downloads"),[g,N]=u.useState(1),[j,b]=u.useState(1),[y,w]=u.useState(0),[A,M]=u.useState(new Set),[S,I]=u.useState(new Set),E=tN(),C=u.useCallback(async()=>{d(!0);try{const L=await r4({status:"approved",page:g,page_size:12,search:m||void 0,sort_by:f,sort_order:"desc"});r(L.packs),b(L.total_pages),w(L.total);const me=new Set;for(const Ne of L.packs)await sN(Ne.id,E)&&me.add(Ne.id);M(me)}catch(L){console.error(" Pack :",L),la({title:" Pack ",variant:"destructive"})}finally{d(!1)}},[g,m,f,E]);u.useEffect(()=>{C()},[C]);const R=L=>{L.preventDefault(),N(1),C()},H=async L=>{if(!S.has(L)){I(me=>new Set(me).add(L));try{const me=await eN(L,E);M(Ne=>{const je=new Set(Ne);return me.liked?je.add(L):je.delete(L),je}),r(Ne=>Ne.map(je=>je.id===L?{...je,likes:me.likes}:je))}catch(me){console.error(":",me),la({title:"",variant:"destructive"})}finally{I(me=>{const Ne=new Set(me);return Ne.delete(L),Ne})}}},O=L=>{a({to:"/config/pack-market/$packId",params:{packId:L}})},X=Km.find(L=>L.value===f)||Km[0];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(xa,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" MaiBot"})]}),e.jsxs(_,{variant:"outline",onClick:C,disabled:c,className:"gap-2",children:[e.jsx(mt,{className:`h-4 w-4 ${c?"animate-spin":""}`}),""]})]})}),e.jsx(ts,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("form",{onSubmit:R,className:"flex-1 min-w-[200px] max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:m,onChange:L=>h(L.target.value),className:"pl-10"})]})}),e.jsxs(_5,{children:[e.jsx(S5,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"min-w-[140px] gap-2",children:[e.jsx(Y1,{className:"w-4 h-4"}),X.label,e.jsx($a,{className:"w-4 h-4 ml-auto"})]})}),e.jsx(hb,{align:"end",children:Km.map(L=>e.jsxs(fb,{onClick:()=>{p(L.value),N(1)},children:[e.jsx(L.icon,{className:"w-4 h-4 mr-2"}),L.label]},L.value))})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",e.jsx("span",{className:"font-medium text-foreground",children:y})," "]}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((L,me)=>e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx(Ms,{className:"h-6 w-3/4"}),e.jsx(Ms,{className:"h-4 w-full mt-2"})]}),e.jsx(ze,{children:e.jsx(Ms,{className:"h-20 w-full"})}),e.jsx(id,{children:e.jsx(Ms,{className:"h-9 w-full"})})]},me))}):l.length===0?e.jsx(Ce,{className:"py-12",children:e.jsxs(ze,{className:"text-center text-muted-foreground",children:[e.jsx(xa,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:""}),e.jsx("p",{className:"mt-1",children:""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(L=>e.jsx(R5,{pack:L,liked:A.has(L.id),liking:S.has(L.id),onLike:()=>H(L.id),onView:()=>O(L.id)},L.id))}),j>1&&e.jsx(mx,{children:e.jsxs(xx,{children:[e.jsx(Yn,{children:e.jsx(Ov,{onClick:()=>N(L=>Math.max(1,L-1)),className:g===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:j},(L,me)=>me+1).filter(L=>L===1||L===j||Math.abs(L-g)<=1).map((L,me,Ne)=>{const je=me>0&&L-Ne[me-1]>1;return e.jsxs(Yn,{children:[je&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(pc,{onClick:()=>N(L),isActive:L===g,className:"cursor-pointer",children:L})]},L)}),e.jsx(Yn,{children:e.jsx(Lv,{onClick:()=>N(L=>Math.min(j,L+1)),className:g===j?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})]})}function R5({pack:a,liked:l,liking:r,onLike:c,onView:d}){const m=h=>new Date(h).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(Ce,{className:"flex flex-col hover:shadow-md transition-shadow",children:[e.jsxs(Oe,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx($e,{className:"text-lg line-clamp-1",children:a.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:["v",a.version]})]}),e.jsx(Ns,{className:"line-clamp-2 min-h-[40px]",children:a.description})]}),e.jsxs(ze,{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($l,{className:"w-3.5 h-3.5"}),a.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ca,{className:"w-3.5 h-3.5"}),m(a.created_at)]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Bl,{className:"w-3.5 h-3.5"}),a.provider_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Xn,{className:"w-3.5 h-3.5"}),a.model_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Zn,{className:"w-3.5 h-3.5"}),a.task_count]})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,3).map(h=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"w-2.5 h-2.5 mr-1"}),h]},h)),a.tags.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",a.tags.length-3]})]})]}),e.jsx(id,{className:"pt-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ra,{className:"w-4 h-4"}),a.downloads]}),e.jsxs("button",{onClick:h=>{h.stopPropagation(),c()},disabled:r,className:`flex items-center gap-1 transition-colors ${l?"text-red-500":"hover:text-red-500"} ${r?"opacity-50":""}`,children:[e.jsx(Zr,{className:`w-4 h-4 ${l?"fill-current":""}`}),a.likes]})]}),e.jsx(_,{size:"sm",onClick:d,children:""})]})})]})}var ol="Accordion",D5=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[zx,O5,L5]=p1(ol),[jd]=td(ol,[L5,zj]),Rx=zj(),pb=Ps.forwardRef((a,l)=>{const{type:r,...c}=a,d=c,m=c;return e.jsx(zx.Provider,{scope:a.__scopeAccordion,children:r==="multiple"?e.jsx(P5,{...m,ref:l}):e.jsx(B5,{...d,ref:l})})});pb.displayName=ol;var[gb,U5]=jd(ol),[jb,$5]=jd(ol,{collapsible:!1}),B5=Ps.forwardRef((a,l)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},collapsible:m=!1,...h}=a,[f,p]=sd({prop:r,defaultProp:c??"",onChange:d,caller:ol});return e.jsx(gb,{scope:a.__scopeAccordion,value:Ps.useMemo(()=>f?[f]:[],[f]),onItemOpen:p,onItemClose:Ps.useCallback(()=>m&&p(""),[m,p]),children:e.jsx(jb,{scope:a.__scopeAccordion,collapsible:m,children:e.jsx(vb,{...h,ref:l})})})}),P5=Ps.forwardRef((a,l)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},...m}=a,[h,f]=sd({prop:r,defaultProp:c??[],onChange:d,caller:ol}),p=Ps.useCallback(N=>f((j=[])=>[...j,N]),[f]),g=Ps.useCallback(N=>f((j=[])=>j.filter(b=>b!==N)),[f]);return e.jsx(gb,{scope:a.__scopeAccordion,value:h,onItemOpen:p,onItemClose:g,children:e.jsx(jb,{scope:a.__scopeAccordion,collapsible:!0,children:e.jsx(vb,{...m,ref:l})})})}),[I5,vd]=jd(ol),vb=Ps.forwardRef((a,l)=>{const{__scopeAccordion:r,disabled:c,dir:d,orientation:m="vertical",...h}=a,f=Ps.useRef(null),p=ad(f,l),g=O5(r),j=Qj(d)==="ltr",b=Nn(a.onKeyDown,y=>{if(!D5.includes(y.key))return;const w=y.target,A=g().filter(X=>!X.ref.current?.disabled),M=A.findIndex(X=>X.ref.current===w),S=A.length;if(M===-1)return;y.preventDefault();let I=M;const E=0,C=S-1,R=()=>{I=M+1,I>C&&(I=E)},H=()=>{I=M-1,I<E&&(I=C)};switch(y.key){case"Home":I=E;break;case"End":I=C;break;case"ArrowRight":m==="horizontal"&&(j?R():H());break;case"ArrowDown":m==="vertical"&&R();break;case"ArrowLeft":m==="horizontal"&&(j?H():R());break;case"ArrowUp":m==="vertical"&&H();break}const O=I%S;A[O].ref.current?.focus()});return e.jsx(I5,{scope:r,disabled:c,direction:d,orientation:m,children:e.jsx(zx.Slot,{scope:r,children:e.jsx(sr.div,{...h,"data-orientation":m,ref:p,onKeyDown:c?void 0:b})})})}),ed="AccordionItem",[F5,Dx]=jd(ed),Nb=Ps.forwardRef((a,l)=>{const{__scopeAccordion:r,value:c,...d}=a,m=vd(ed,r),h=U5(ed,r),f=Rx(r),p=Qm(),g=c&&h.value.includes(c)||!1,N=m.disabled||a.disabled;return e.jsx(F5,{scope:r,open:g,disabled:N,triggerId:p,children:e.jsx(kj,{"data-orientation":m.orientation,"data-state":kb(g),...f,...d,ref:l,disabled:N,open:g,onOpenChange:j=>{j?h.onItemOpen(c):h.onItemClose(c)}})})});Nb.displayName=ed;var bb="AccordionHeader",yb=Ps.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(ol,r),m=Dx(bb,r);return e.jsx(sr.h3,{"data-orientation":d.orientation,"data-state":kb(m.open),"data-disabled":m.disabled?"":void 0,...c,ref:l})});yb.displayName=bb;var tx="AccordionTrigger",wb=Ps.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(ol,r),m=Dx(tx,r),h=$5(tx,r),f=Rx(r);return e.jsx(zx.ItemSlot,{scope:r,children:e.jsx(Vw,{"aria-disabled":m.open&&!h.collapsible||void 0,"data-orientation":d.orientation,id:m.triggerId,...f,...c,ref:l})})});wb.displayName=tx;var _b="AccordionContent",Sb=Ps.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(ol,r),m=Dx(_b,r),h=Rx(r);return e.jsx(Gw,{role:"region","aria-labelledby":m.triggerId,"data-orientation":d.orientation,...h,...c,ref:l,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...a.style}})});Sb.displayName=_b;function kb(a){return a?"open":"closed"}var H5=pb,q5=Nb,V5=yb,Cb=wb,Tb=Sb;const G5=H5,Eb=u.forwardRef(({className:a,...l},r)=>e.jsx(q5,{ref:r,className:F("border-b",a),...l}));Eb.displayName="AccordionItem";const Mb=u.forwardRef(({className:a,children:l,...r},c)=>e.jsx(V5,{className:"flex",children:e.jsxs(Cb,{ref:c,className:F("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...r,children:[l,e.jsx($a,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Mb.displayName=Cb.displayName;const Ab=u.forwardRef(({className:a,children:l,...r},c)=>e.jsx(Tb,{ref:c,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:F("pb-4 pt-0",a),children:l})}));Ab.displayName=Tb.displayName;const K5={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""};function Q5(){const{packId:a}=Lb.useParams(),l=ha(),[r,c]=u.useState(null),[d,m]=u.useState(!0),[h,f]=u.useState(!1),[p,g]=u.useState(!1),[N,j]=u.useState(!1),[b,y]=u.useState(1),[w,A]=u.useState(null),[M,S]=u.useState(!1),[I,E]=u.useState(!1),[C,R]=u.useState({apply_providers:!0,apply_models:!0,apply_task_config:!0,task_mode:"append",selected_providers:void 0,selected_models:void 0,selected_tasks:void 0}),[H,O]=u.useState({}),[X,L]=u.useState({}),me=tN(),Ne=u.useCallback(async()=>{if(a){m(!0);try{const D=await i4(a);c(D);const Q=await sN(a,me);f(Q)}catch(D){console.error(" Pack :",D),la({title:"",variant:"destructive"})}finally{m(!1)}}},[a,me]);u.useEffect(()=>{Ne()},[Ne]);const je=async()=>{if(!(!a||p)){g(!0);try{const D=await eN(a,me);f(D.liked),r&&c({...r,likes:D.likes})}catch(D){console.error(":",D),la({title:"",variant:"destructive"})}finally{g(!1)}}},ce=async()=>{if(r){j(!0),y(1),S(!0);try{const D=await d4(r);A(D);const Q={};for(const ue of D.existing_providers)Q[ue.pack_provider.name]=ue.local_providers[0].name;O(Q);const B={};for(const ue of D.new_providers)B[ue.name]="";L(B)}catch(D){console.error(":",D),la({title:"",variant:"destructive"}),j(!1)}finally{S(!1)}}},ge=async()=>{if(r){if(C.apply_providers&&w){for(const D of w.new_providers)if(!X[D.name]){la({title:` "${D.name}"  API Key`,variant:"destructive"});return}}E(!0);try{await u4(r,C,H,X),await o4(r.id,me),c({...r,downloads:r.downloads+1}),la({title:""}),j(!1)}catch(D){console.error(" Pack :",D),la({title:D instanceof Error?D.message:"",variant:"destructive"})}finally{E(!1)}}},pe=D=>new Date(D).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"});return d?e.jsx(J5,{}):r?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(ts,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>l({to:"/config/pack-market"}),className:"gap-2",children:[e.jsx(Ua,{className:"w-4 h-4"}),""]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xa,{className:"w-10 h-10 text-primary mt-1"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[r.name,e.jsxs(ke,{variant:"secondary",children:["v",r.version]})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:r.description})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($l,{className:"w-4 h-4"}),r.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ca,{className:"w-4 h-4"}),pe(r.created_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ra,{className:"w-4 h-4"}),r.downloads," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Zr,{className:`w-4 h-4 ${h?"fill-red-500 text-red-500":""}`}),r.likes," "]})]}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map(D=>e.jsxs(ke,{variant:"outline",children:[e.jsx(rd,{className:"w-3 h-3 mr-1"}),D]},D))})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsxs(_,{size:"lg",onClick:ce,children:[e.jsx(ra,{className:"w-4 h-4 mr-2"}),""]}),e.jsxs(_,{variant:"outline",onClick:je,disabled:p,className:h?"text-red-500 border-red-200":"",children:[e.jsx(Zr,{className:`w-4 h-4 mr-2 ${h?"fill-current":""}`}),h?"":""]})]})]}),e.jsx(na,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(Ce,{children:e.jsxs(ze,{className:"flex items-center gap-3 py-4",children:[e.jsx(Bl,{className:"w-8 h-8 text-blue-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.providers.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"API "})]})]})}),e.jsx(Ce,{children:e.jsxs(ze,{className:"flex items-center gap-3 py-4",children:[e.jsx(Xn,{className:"w-8 h-8 text-green-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.models.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})}),e.jsx(Ce,{children:e.jsxs(ze,{className:"flex items-center gap-3 py-4",children:[e.jsx(Zn,{className:"w-8 h-8 text-purple-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(r.task_config).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})})]}),e.jsxs(Jt,{defaultValue:"providers",className:"space-y-4",children:[e.jsxs(Gt,{className:"w-full sm:w-auto grid grid-cols-3 sm:flex",children:[e.jsxs(Ye,{value:"providers",className:"gap-1 sm:gap-2",children:[e.jsx(Bl,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.providers.length,")"]})]}),e.jsxs(Ye,{value:"models",className:"gap-1 sm:gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.models.length,")"]})]}),e.jsxs(Ye,{value:"tasks",className:"gap-1 sm:gap-2",children:[e.jsx(Zn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",Object.keys(r.task_config).length,")"]})]})]}),e.jsx(Cs,{value:"providers",children:e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:"API "}),e.jsx(Ns,{children:" API  API Key"})]}),e.jsx(ze,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{children:""}),e.jsx(ns,{children:"Base URL"}),e.jsx(ns,{children:""})]})}),e.jsx(Fl,{children:r.providers.map(D=>e.jsxs(wt,{children:[e.jsx(Je,{className:"font-medium whitespace-nowrap",children:D.name}),e.jsx(Je,{className:"text-muted-foreground font-mono text-sm max-w-[200px] truncate",children:D.base_url}),e.jsx(Je,{children:e.jsx(ke,{variant:"outline",children:D.client_type})})]},D.name))})]})})})]})}),e.jsx(Cs,{value:"models",children:e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pl,{children:[e.jsx(Il,{children:e.jsxs(wt,{children:[e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{children:""}),e.jsx(ns,{className:"text-right",children:" (/)"})]})}),e.jsx(Fl,{children:r.models.map(D=>e.jsxs(wt,{children:[e.jsx(Je,{className:"font-medium whitespace-nowrap",children:D.name}),e.jsx(Je,{className:"text-muted-foreground font-mono text-sm max-w-[150px] truncate",children:D.model_identifier}),e.jsx(Je,{className:"whitespace-nowrap",children:D.api_provider}),e.jsxs(Je,{className:"text-right text-muted-foreground whitespace-nowrap",children:["",D.price_in," / ",D.price_out]})]},D.name))})]})})})]})}),e.jsx(Cs,{value:"tasks",children:e.jsxs(Ce,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:""}),e.jsx(Ns,{children:""})]}),e.jsx(ze,{children:e.jsx(G5,{type:"multiple",className:"w-full",children:Object.entries(r.task_config).map(([D,Q])=>e.jsxs(Eb,{value:D,children:[e.jsx(Mb,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bn,{className:"w-4 h-4"}),K5[D]||D,e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[Q.model_list.length," "]})]})}),e.jsx(Ab,{children:e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.model_list.map(B=>e.jsx(ke,{variant:"outline",children:B},B))}),Q.temperature!==void 0&&e.jsxs("div",{className:"text-sm",children:["Temperature: ",e.jsx("span",{className:"font-mono",children:Q.temperature})]}),Q.max_tokens!==void 0&&e.jsxs("div",{className:"text-sm",children:["Max Tokens: ",e.jsx("span",{className:"font-mono",children:Q.max_tokens})]})]})})]},D))})})]})})]}),e.jsx(Y5,{open:N,onOpenChange:j,pack:r,step:b,setStep:y,conflicts:w,detectingConflicts:M,applying:I,options:C,setOptions:R,_providerMapping:H,_setProviderMapping:O,newProviderApiKeys:X,setNewProviderApiKeys:L,onApply:ge})]})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xa,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-xl font-semibold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""}),e.jsxs(_,{className:"mt-4",onClick:()=>l({to:"/config/pack-market"}),children:[e.jsx(Ua,{className:"w-4 h-4 mr-2"}),""]})]})}function Y5({open:a,onOpenChange:l,pack:r,step:c,setStep:d,conflicts:m,detectingConflicts:h,applying:f,options:p,setOptions:g,_providerMapping:N,_setProviderMapping:j,newProviderApiKeys:b,setNewProviderApiKeys:y,onApply:w}){return e.jsx(Qs,{open:a,onOpenChange:l,children:e.jsxs(Hs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(qs,{children:[e.jsxs(Vs,{className:"flex items-center gap-2",children:[e.jsx(xa,{className:"w-5 h-5"}),""]}),e.jsxs(at,{children:[" ",c," / ",3,"",c===1&&"",c===2&&"",c===3&&""]})]}),h?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Fs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"apply_providers",checked:p.apply_providers,onCheckedChange:M=>g({...p,apply_providers:M})}),e.jsxs(T,{htmlFor:"apply_providers",className:"flex items-center gap-2",children:[e.jsx(Bl,{className:"w-4 h-4"})," (",r.providers.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"apply_models",checked:p.apply_models,onCheckedChange:M=>g({...p,apply_models:M})}),e.jsxs(T,{htmlFor:"apply_models",className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"})," (",r.models.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(tt,{id:"apply_task_config",checked:p.apply_task_config,onCheckedChange:M=>g({...p,apply_task_config:M})}),e.jsxs(T,{htmlFor:"apply_task_config",className:"flex items-center gap-2",children:[e.jsx(Zn,{className:"w-4 h-4"})," (",Object.keys(r.task_config).length," )"]})]})]}),p.apply_task_config&&e.jsxs("div",{className:"pl-6 space-y-2 border-l-2 border-muted",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs(Ex,{value:p.task_mode,onValueChange:M=>g({...p,task_mode:M}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"append",id:"mode_append"}),e.jsx(T,{htmlFor:"mode_append",className:"font-normal",children:" - "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"replace",id:"mode_replace"}),e.jsx(T,{htmlFor:"mode_replace",className:"font-normal",children:" - "})]})]})]})]}),c===2&&m&&e.jsxs("div",{className:"space-y-4",children:[p.apply_providers&&m.existing_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:" URL "})]}),e.jsx("div",{className:"space-y-2",children:m.existing_providers.map(({pack_provider:M,local_providers:S})=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"font-medium flex-shrink-0",children:M.name}),e.jsx(ia,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),S.length===1?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:S[0].name}),e.jsx(ke,{variant:"outline",className:"ml-auto",children:"URL "})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{value:N[M.name]||S[0].name,onValueChange:I=>j({...N,[M.name]:I}),children:[e.jsx(Be,{className:"w-[200px]",children:e.jsx(Fe,{})}),e.jsx(Pe,{children:S.map(I=>e.jsx(Z,{value:I.name,children:I.name},I.name))})]}),e.jsxs(ke,{variant:"outline",className:"ml-auto",children:[S.length," "]})]})]},M.name))})]}),p.apply_providers&&m.new_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(pt,{variant:"destructive",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx(Qn,{children:" API Key"}),e.jsx(gt,{children:" API Key"})]}),e.jsx("div",{className:"space-y-4",children:m.new_providers.map(M=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rx,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"font-medium",children:M.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",M.base_url,")"]})]}),e.jsx(le,{type:"password",placeholder:` ${M.name}  API Key`,value:b[M.name]||"",onChange:S=>y({...b,[M.name]:S.target.value})})]},M.name))})]}),(!p.apply_providers||m.existing_providers.length===0&&m.new_providers.length===0)&&e.jsxs(pt,{children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:""})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:""})]}),e.jsxs("div",{className:"space-y-2",children:[p.apply_providers&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500"}),e.jsx(Bl,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.providers.length," "]})]}),p.apply_models&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500"}),e.jsx(Xn,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.models.length," "]})]}),p.apply_task_config&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500"}),e.jsx(Zn,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.task_mode==="append"?"":""," ",Object.keys(r.task_config).length," "]})]})]}),m&&m.new_providers.length>0&&e.jsxs(pt,{variant:"destructive",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(gt,{children:[" ",m.new_providers.length,"  API Key"]})]})]})]}),e.jsxs(ft,{className:"flex justify-between",children:[e.jsx("div",{children:c>1&&!h&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),disabled:f,children:""}),c<3?e.jsx(_,{onClick:()=>d(c+1),disabled:h,children:""}):e.jsxs(_,{onClick:w,disabled:f,children:[f&&e.jsx(Fs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})})}function J5(){return e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(ts,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(Ms,{className:"h-9 w-24"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ms,{className:"w-10 h-10"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(Ms,{className:"h-8 w-2/3"}),e.jsx(Ms,{className:"h-4 w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(Ms,{className:"h-4 w-24"}),e.jsx(Ms,{className:"h-4 w-32"}),e.jsx(Ms,{className:"h-4 w-28"}),e.jsx(Ms,{className:"h-4 w-20"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Ms,{className:"h-6 w-20"}),e.jsx(Ms,{className:"h-6 w-24"}),e.jsx(Ms,{className:"h-6 w-16"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsx(Ms,{className:"h-10 w-full"}),e.jsx(Ms,{className:"h-10 w-full"})]})]}),e.jsx(Ms,{className:"h-px w-full"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(Ms,{className:"h-24"}),e.jsx(Ms,{className:"h-24"}),e.jsx(Ms,{className:"h-24"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ms,{className:"h-10 w-32"}),e.jsx(Ms,{className:"h-10 w-32"}),e.jsx(Ms,{className:"h-10 w-32"})]}),e.jsx(Ms,{className:"h-96 w-full"})]})]})})})}function X5(){const a=ha(),[l,r]=u.useState(!0);return u.useEffect(()=>{let c=!1;return(async()=>{try{const m=await cc();!c&&!m&&a({to:"/auth"})}catch{c||a({to:"/auth"})}finally{c||r(!1)}})(),()=>{c=!0}},[a]),{checking:l}}async function Z5(){return await cc()}const W5=ei("pointer-events-none inline-flex select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono font-medium opacity-100",{variants:{size:{sm:"h-5 text-[10px]",default:"h-6 text-xs",lg:"h-7 text-sm"}},defaultVariants:{size:"default"}}),zb=u.forwardRef(({className:a,size:l,abbrTitle:r,children:c,...d},m)=>e.jsx("kbd",{className:F(W5({size:l,className:a})),ref:m,...d,children:r?e.jsx("abbr",{title:r,children:c}):c}));zb.displayName="Kbd";const eT=[{icon:nd,title:"",description:"",path:"/",category:""},{icon:La,title:"",description:"",path:"/config/bot",category:""},{icon:Bl,title:"",description:"",path:"/config/modelProvider",category:""},{icon:hv,title:"",description:"",path:"/config/model",category:""},{icon:ld,title:"",description:"",path:"/resource/emoji",category:""},{icon:Ba,title:"",description:"",path:"/resource/expression",category:""},{icon:fv,title:"",description:"",path:"/resource/person",category:""},{icon:Xr,title:"",description:"",path:"/resource/jargon",category:""},{icon:J1,title:"",description:"",path:"/statistics",category:""},{icon:xa,title:"",description:"",path:"/plugins",category:""},{icon:cx,title:"",description:"",path:"/logs",category:""},{icon:bn,title:"",description:"",path:"/settings",category:""}];function sT({open:a,onOpenChange:l}){const[r,c]=u.useState(""),[d,m]=u.useState(0),h=ha(),f=eT.filter(N=>N.title.toLowerCase().includes(r.toLowerCase())||N.description.toLowerCase().includes(r.toLowerCase())||N.category.toLowerCase().includes(r.toLowerCase())),p=u.useCallback(N=>{h({to:N}),l(!1),c(""),m(0)},[h,l]),g=u.useCallback(N=>{N.key==="ArrowDown"?(N.preventDefault(),m(j=>(j+1)%f.length)):N.key==="ArrowUp"?(N.preventDefault(),m(j=>(j-1+f.length)%f.length)):N.key==="Enter"&&f[d]&&(N.preventDefault(),p(f[d].path))},[f,d,p]);return e.jsx(Qs,{open:a,onOpenChange:l,children:e.jsxs(Hs,{className:"max-w-2xl p-0 gap-0",children:[e.jsxs(qs,{className:"px-4 pt-4 pb-0",children:[e.jsx(Vs,{className:"sr-only",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),e.jsx(le,{value:r,onChange:N=>{c(N.target.value),m(0)},onKeyDown:g,placeholder:"...",className:"h-12 pl-11 text-base border-0 focus-visible:ring-0 shadow-none",autoFocus:!0})]})]}),e.jsx("div",{className:"border-t",children:e.jsx(ts,{className:"h-[400px]",children:f.length>0?e.jsx("div",{className:"p-2",children:f.map((N,j)=>{const b=N.icon;return e.jsxs("button",{onClick:()=>p(N.path),onMouseEnter:()=>m(j),className:F("w-full flex items-center gap-3 px-3 py-2.5 rounded-md text-left transition-colors",j===d?"bg-accent text-accent-foreground":"hover:bg-accent/50"),children:[e.jsx(b,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:N.title}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:N.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1 bg-muted rounded",children:N.category})]},N.path)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Ut,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?"":""})]})})}),e.jsx("div",{className:"border-t px-4 py-3 flex items-center justify-between text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Enter"}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Esc"}),""]})]})})]})})}function tT(){const a=window.location.protocol==="http:",l=window.location.hostname.toLowerCase(),r=l==="localhost"||l==="127.0.0.1"||l==="::1",c=sessionStorage.getItem("http-warning-dismissed")==="true",[d,m]=u.useState(a&&!r&&!c),[h,f]=u.useState(!1),p=()=>{f(!0),m(!1),sessionStorage.setItem("http-warning-dismissed","true")};return!d||h?null:e.jsx("div",{className:"relative bg-amber-500/10 border-b border-amber-500/20 backdrop-blur-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Ft,{className:"h-5 w-5 text-amber-600 dark:text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-semibold",children:""})," ",e.jsx("strong",{children:"HTTP"}),"  MaiBot WebUI"]}),e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200 mt-1",children:" Token HTTPS "})]})]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:p,className:"h-8 w-8 text-amber-700 hover:text-amber-900 dark:text-amber-400 dark:hover:text-amber-200 flex-shrink-0","aria-label":"",children:e.jsx(Sa,{className:"h-4 w-4"})})]})})})}function aT(){const[a,l]=u.useState(0),[r,c]=u.useState(!1),d=u.useRef(null);u.useEffect(()=>{const g=N=>{const j=N.target;if(j.scrollHeight>j.clientHeight+100){d.current=j;const b=j.scrollTop,y=j.scrollHeight-j.clientHeight,w=y>0?b/y*100:0;l(w),c(b>300)}};return window.addEventListener("scroll",g,{capture:!0,passive:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})},[]);const m=()=>{d.current?.scrollTo({top:0,behavior:"smooth"})},h=18,f=2*Math.PI*h,p=f-a/100*f;return e.jsx("div",{className:F("fixed bottom-24 right-8 z-50 transition-all duration-500 ease-in-out transform",r?"translate-x-0 opacity-100":"translate-x-32 opacity-0 pointer-events-none"),children:e.jsxs(_,{variant:"outline",size:"icon",className:F("relative h-12 w-12 rounded-full shadow-xl","bg-background/80 backdrop-blur-md border-border/50","hover:bg-accent hover:scale-110 hover:shadow-2xl hover:border-primary/50","transition-all duration-300","group"),onClick:m,"aria-label":"",children:[e.jsxs("svg",{className:"absolute inset-0 h-full w-full -rotate-90 transform p-1",viewBox:"0 0 44 44",children:[e.jsx("circle",{className:"text-muted-foreground/10",strokeWidth:"3",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"}),e.jsx("circle",{className:"text-primary transition-all duration-100 ease-out",strokeWidth:"3",strokeDasharray:f,strokeDashoffset:p,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"})]}),e.jsx(X1,{className:"h-5 w-5 text-primary transition-transform duration-300 group-hover:-translate-y-1 group-hover:scale-110",strokeWidth:2.5}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})})}const lT=j1,nT=v1,rT=N1,Rb=u.forwardRef(({className:a,sideOffset:l=4,...r},c)=>e.jsx(g1,{children:e.jsx(Yj,{ref:c,sideOffset:l,className:F("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...r})}));Rb.displayName=Yj.displayName;function iT({children:a}){const{checking:l}=X5(),[r,c]=u.useState(!0),[d,m]=u.useState(!1),[h,f]=u.useState(!1),[p,g]=u.useState(!1),{theme:N,setTheme:j}=px(),b=ew();if(u.useEffect(()=>{if(r)g(!1);else{const S=setTimeout(()=>{g(!0)},350);return()=>clearTimeout(S)}},[r]),u.useEffect(()=>{const S=I=>{(I.metaKey||I.ctrlKey)&&I.key==="k"&&(I.preventDefault(),f(!0))};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[]),l)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-background",children:e.jsx("div",{className:"text-muted-foreground",children:"..."})});const y=[{title:"",items:[{icon:nd,label:"",path:"/"}]},{title:"",items:[{icon:La,label:"",path:"/config/bot"},{icon:Bl,label:"AI",path:"/config/modelProvider",tourId:"sidebar-model-provider"},{icon:hv,label:"",path:"/config/model",tourId:"sidebar-model-management"},{icon:Tg,label:"",path:"/config/adapter"}]},{title:"",items:[{icon:ld,label:"",path:"/resource/emoji"},{icon:Ba,label:"",path:"/resource/expression"},{icon:Xr,label:"",path:"/resource/jargon"},{icon:fv,label:"",path:"/resource/person"},{icon:dv,label:"",path:"/resource/knowledge-graph"},{icon:Jr,label:"",path:"/resource/knowledge-base"}]},{title:"",items:[{icon:xa,label:"",path:"/plugins"},{icon:mv,label:"",path:"/config/pack-market"},{icon:Tg,label:"",path:"/plugin-config"},{icon:cx,label:"",path:"/logs"},{icon:ax,label:"&",path:"/planner-monitor"},{icon:Ba,label:"",path:"/chat"}]},{title:"",items:[{icon:bn,label:"",path:"/settings"}]}],A=N==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":N,M=async()=>{await R_()};return e.jsx(lT,{delayDuration:300,children:e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsxs("aside",{className:F("fixed inset-y-0 left-0 z-50 flex flex-col border-r bg-card transition-all duration-300 lg:relative lg:z-0","w-64 lg:w-auto",r?"lg:w-64":"lg:w-16",d?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsx("div",{className:"flex h-16 items-center border-b px-4",children:e.jsxs("div",{className:F("relative flex items-center justify-center flex-1 transition-all overflow-hidden","lg:flex-1",!r&&"lg:flex-none lg:w-8"),children:[e.jsxs("div",{className:F("flex items-baseline gap-2",!r&&"lg:hidden"),children:[e.jsx("span",{className:"font-bold text-xl text-primary-gradient whitespace-nowrap",children:"MaiBot WebUI"}),e.jsx("span",{className:"text-xs text-primary/60 whitespace-nowrap",children:x2()})]}),!r&&e.jsx("span",{className:"hidden lg:block font-bold text-primary-gradient text-2xl",children:"M"})]})}),e.jsx(ts,{className:F("flex-1 overflow-x-hidden",!r&&"lg:w-16"),children:e.jsx("nav",{className:F("p-4",!r&&"lg:p-2 lg:w-16"),children:e.jsx("ul",{className:F("space-y-6",!r&&"lg:space-y-3 lg:w-full"),children:y.map((S,I)=>e.jsxs("li",{children:[e.jsx("div",{className:F("px-3 h-[1.25rem]","mb-2",!r&&"lg:mb-1 lg:invisible"),children:e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground/60 whitespace-nowrap",children:S.title})}),!r&&I>0&&e.jsx("div",{className:"hidden lg:block mb-2 border-t border-border"}),e.jsx("ul",{className:"space-y-1",children:S.items.map(E=>{const C=b({to:E.path}),R=E.icon,H=e.jsxs(e.Fragment,{children:[C&&e.jsx("div",{className:"absolute left-0 top-1/2 h-8 w-1 -translate-y-1/2 rounded-r-full bg-primary transition-opacity duration-300"}),e.jsxs("div",{className:F("flex items-center transition-all duration-300",r?"gap-3":"gap-3 lg:gap-0"),children:[e.jsx(R,{className:F("h-5 w-5 flex-shrink-0",C&&"text-primary"),strokeWidth:2,fill:"none"}),e.jsx("span",{className:F("text-sm font-medium whitespace-nowrap transition-all duration-300",C&&"font-semibold",r?"opacity-100 max-w-[200px]":"opacity-100 max-w-[200px] lg:opacity-0 lg:max-w-0 lg:overflow-hidden"),children:E.label})]})]});return e.jsx("li",{className:"relative",children:e.jsxs(nT,{children:[e.jsx(rT,{asChild:!0,children:e.jsx(Vn,{to:E.path,"data-tour":E.tourId,className:F("relative flex items-center rounded-lg py-2 transition-all duration-300","hover:bg-accent hover:text-accent-foreground",C?"bg-accent text-foreground":"text-muted-foreground hover:text-foreground",r?"px-3":"px-3 lg:px-0 lg:justify-center lg:w-12 lg:mx-auto"),onClick:()=>m(!1),children:H})}),p&&e.jsx(Rb,{side:"right",className:"hidden lg:block",children:e.jsx("p",{children:E.label})})]})},E.path)})})]},S.title))})})})]}),d&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>m(!1)}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(tT,{}),e.jsxs("header",{className:"flex h-16 items-center justify-between border-b bg-card/80 backdrop-blur-md px-4 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m(!d),className:"rounded-lg p-2 hover:bg-accent lg:hidden",children:e.jsx(Z1,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>c(!r),className:"hidden rounded-lg p-2 hover:bg-accent lg:block",title:r?"":"",children:e.jsx(Pa,{className:F("h-5 w-5 transition-transform",!r&&"rotate-180")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vn,{to:"/annual-report",children:e.jsxs(_,{variant:"ghost",size:"sm",className:"gap-2 bg-gradient-to-r from-pink-500/10 to-purple-500/10 hover:from-pink-500/20 hover:to-purple-500/20 border border-pink-500/20",title:"",children:[e.jsx(W1,{className:"h-4 w-4 text-pink-500"}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent font-medium",children:"2025 "})]})}),e.jsxs("button",{onClick:()=>f(!0),className:"relative hidden md:flex items-center w-64 h-9 pl-9 pr-16 bg-background/50 border rounded-md hover:bg-accent/50 transition-colors text-left",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"..."}),e.jsxs(zb,{size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2",children:[e.jsx("span",{className:"text-xs",children:""}),"K"]})]}),e.jsx(sT,{open:h,onOpenChange:f}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>window.open("https://docs.mai-mai.org","_blank"),className:"gap-2",title:"",children:[e.jsx(e_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx("button",{onClick:S=>{c2(A==="dark"?"light":"dark",j,S)},className:"rounded-lg p-2 hover:bg-accent",title:A==="dark"?"":"",children:A==="dark"?e.jsx(nx,{className:"h-5 w-5"}):e.jsx(ec,{className:"h-5 w-5"})}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:M,className:"gap-2",title:"",children:[e.jsx(s_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden bg-background",children:a}),e.jsx(aT,{})]})]})})}function cT(a){const l=a.split(`
`).slice(1),r=[];for(const c of l){const d=c.trim();if(!d.startsWith("at "))continue;const m=d.match(/at\s+(?:(.+?)\s+\()?(.+?):(\d+):(\d+)\)?$/);m?r.push({functionName:m[1]||"<anonymous>",fileName:m[2],lineNumber:m[3],columnNumber:m[4],raw:d}):r.push({functionName:"<unknown>",fileName:"",lineNumber:"",columnNumber:"",raw:d})}return r}function oT({error:a,errorInfo:l}){const[r,c]=u.useState(!0),[d,m]=u.useState(!1),[h,f]=u.useState(!1),p=a.stack?cT(a.stack):[],g=async()=>{const N=`
Error: ${a.name}
Message: ${a.message}

Stack Trace:
${a.stack||"No stack trace available"}

Component Stack:
${l?.componentStack||"No component stack available"}

URL: ${window.location.href}
User Agent: ${navigator.userAgent}
Time: ${new Date().toISOString()}
    `.trim();try{await navigator.clipboard.writeText(N),f(!0),setTimeout(()=>f(!1),2e3)}catch(j){console.error("Failed to copy:",j)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{variant:"destructive",className:"border-red-500/50 bg-red-500/10",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs(gt,{className:"font-mono text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[a.name,":"]})," ",a.message]})]}),p.length>0&&e.jsxs(uc,{open:r,onOpenChange:c,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(t_,{className:"h-4 w-4"}),"Stack Trace (",p.length," frames)"]}),r?e.jsx(Yr,{className:"h-4 w-4"}):e.jsx($a,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(ts,{className:"h-[280px] rounded-md border bg-muted/30",children:e.jsx("div",{className:"p-3 space-y-1",children:p.map((N,j)=>e.jsx("div",{className:"font-mono text-xs p-2 rounded hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"text-muted-foreground w-6 text-right flex-shrink-0",children:[j+1,"."]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-primary font-medium",children:N.functionName}),N.fileName&&e.jsxs("div",{className:"text-muted-foreground mt-0.5 break-all",children:[N.fileName,N.lineNumber&&e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:[":",N.lineNumber,":",N.columnNumber]})]})]})]})},j))})})})]}),l?.componentStack&&e.jsxs(uc,{open:d,onOpenChange:m,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(Ft,{className:"h-4 w-4"}),"Component Stack"]}),d?e.jsx(Yr,{className:"h-4 w-4"}):e.jsx($a,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(ts,{className:"h-[200px] rounded-md border bg-muted/30",children:e.jsx("pre",{className:"p-3 font-mono text-xs whitespace-pre-wrap text-muted-foreground",children:l.componentStack})})})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:g,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"mr-2 h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"mr-2 h-4 w-4"}),""]})})]})}function Db({error:a,errorInfo:l}){const r=()=>{window.location.href="/"},c=()=>{window.location.reload()};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(Ce,{className:"w-full max-w-2xl shadow-lg",children:[e.jsxs(Oe,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:e.jsx(Ft,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsx($e,{className:"text-2xl font-bold",children:""}),e.jsx(Ns,{className:"text-base mt-2",children:""})]}),e.jsxs(ze,{className:"space-y-4",children:[e.jsx(oT,{error:a,errorInfo:l}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[e.jsxs(_,{onClick:c,className:"flex-1",children:[e.jsx(mt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:r,variant:"outline",className:"flex-1",children:[e.jsx(nd,{className:"mr-2 h-4 w-4"}),""]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground pt-2",children:""})]})]})})}class dT extends u.Component{constructor(l){super(l),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(l){return{hasError:!0,error:l}}componentDidCatch(l,r){console.error("ErrorBoundary caught an error:",l,r),this.setState({errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError&&this.state.error?this.props.fallback?this.props.fallback:e.jsx(Db,{error:this.state.error,errorInfo:this.state.errorInfo}):this.props.children}}function Ob({error:a}){return e.jsx(Db,{error:a,errorInfo:null})}const vc=sw({component:()=>e.jsxs(e.Fragment,{children:[e.jsx(oj,{}),!1]}),beforeLoad:()=>{if(window.location.pathname==="/"&&!Z5())throw aw({to:"/auth"})}}),uT=lt({getParentRoute:()=>vc,path:"/auth",component:E2}),mT=lt({getParentRoute:()=>vc,path:"/setup",component:V2}),jt=lt({getParentRoute:()=>vc,id:"protected",component:()=>e.jsx(iT,{children:e.jsx(oj,{})}),errorComponent:({error:a})=>e.jsx(Ob,{error:a})}),xT=lt({getParentRoute:()=>jt,path:"/",component:l2}),hT=lt({getParentRoute:()=>jt,path:"/config/bot",component:HS}),fT=lt({getParentRoute:()=>jt,path:"/config/modelProvider",component:s4}),pT=lt({getParentRoute:()=>jt,path:"/config/model",component:k4}),gT=lt({getParentRoute:()=>jt,path:"/config/adapter",component:M4}),jT=lt({getParentRoute:()=>jt,path:"/resource/emoji",component:W4}),vT=lt({getParentRoute:()=>jt,path:"/resource/expression",component:ak}),NT=lt({getParentRoute:()=>jt,path:"/resource/person",component:Ck}),bT=lt({getParentRoute:()=>jt,path:"/resource/jargon",component:gk}),yT=lt({getParentRoute:()=>jt,path:"/resource/knowledge-graph",component:Lk}),wT=lt({getParentRoute:()=>jt,path:"/resource/knowledge-base",component:Uk}),_T=lt({getParentRoute:()=>jt,path:"/logs",component:Bk}),ST=lt({getParentRoute:()=>jt,path:"/planner-monitor",component:Qk}),kT=lt({getParentRoute:()=>jt,path:"/chat",component:RC}),CT=lt({getParentRoute:()=>jt,path:"/plugins",component:hC}),TT=lt({getParentRoute:()=>jt,path:"/plugin-detail",component:_C}),ET=lt({getParentRoute:()=>jt,path:"/model-presets",component:pC}),MT=lt({getParentRoute:()=>jt,path:"/plugin-config",component:vC}),AT=lt({getParentRoute:()=>jt,path:"/plugin-mirrors",component:bC}),zT=lt({getParentRoute:()=>jt,path:"/settings",component:y2}),RT=lt({getParentRoute:()=>jt,path:"/config/pack-market",component:z5}),Lb=lt({getParentRoute:()=>jt,path:"/config/pack-market/$packId",component:Q5}),DT=lt({getParentRoute:()=>jt,path:"/survey/webui-feedback",component:YC}),OT=lt({getParentRoute:()=>jt,path:"/survey/maibot-feedback",component:JC}),LT=lt({getParentRoute:()=>jt,path:"/annual-report",component:t5}),UT=lt({getParentRoute:()=>vc,path:"*",component:qv}),$T=vc.addChildren([uT,mT,jt.addChildren([xT,hT,fT,pT,gT,jT,vT,bT,NT,yT,wT,CT,TT,ET,MT,AT,_T,ST,kT,zT,RT,Lb,DT,OT,LT]),UT]),BT=tw({routeTree:$T,defaultNotFoundComponent:qv,defaultErrorComponent:({error:a})=>e.jsx(Ob,{error:a})});function PT({children:a,defaultTheme:l="system",storageKey:r="ui-theme",...c}){const[d,m]=u.useState(()=>localStorage.getItem(r)||l);u.useEffect(()=>{const f=window.document.documentElement;if(f.classList.remove("light","dark"),d==="system"){const p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";f.classList.add(p);return}f.classList.add(d)},[d]),u.useEffect(()=>{const f=localStorage.getItem("accent-color");if(f){const p=document.documentElement,N={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[f];N&&(p.style.setProperty("--primary",N.hsl),N.gradient?(p.style.setProperty("--primary-gradient",N.gradient),p.classList.add("has-gradient")):(p.style.removeProperty("--primary-gradient"),p.classList.remove("has-gradient")))}},[]);const h={theme:d,setTheme:f=>{localStorage.setItem(r,f),m(f)}};return e.jsx(Bv.Provider,{...c,value:h,children:a})}function IT({children:a,defaultEnabled:l=!0,defaultWavesEnabled:r=!0,storageKey:c="enable-animations",wavesStorageKey:d="enable-waves-background"}){const[m,h]=u.useState(()=>{const N=localStorage.getItem(c);return N!==null?N==="true":l}),[f,p]=u.useState(()=>{const N=localStorage.getItem(d);return N!==null?N==="true":r});u.useEffect(()=>{const N=document.documentElement;m?N.classList.remove("no-animations"):N.classList.add("no-animations"),localStorage.setItem(c,String(m))},[m,c]),u.useEffect(()=>{localStorage.setItem(d,String(f))},[f,d]);const g={enableAnimations:m,setEnableAnimations:h,enableWavesBackground:f,setEnableWavesBackground:p};return e.jsx(Pv.Provider,{value:g,children:a})}const FT=b1,Ub=u.forwardRef(({className:a,...l},r)=>e.jsx(Jj,{ref:r,className:F("fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:max-w-[420px] gap-2",a),...l}));Ub.displayName=Jj.displayName;const HT=ei("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-slide-in-from-right data-[state=open]:animate-fade-in data-[state=closed]:animate-slide-out-to-right data-[state=closed]:animate-fade-out data-[swipe=end]:animate-slide-out-to-right",{variants:{variant:{default:"border bg-primary/5 text-foreground backdrop-blur-sm",destructive:"destructive group border-destructive bg-destructive/10 text-destructive-foreground backdrop-blur-sm"}},defaultVariants:{variant:"default"}}),$b=u.forwardRef(({className:a,variant:l,...r},c)=>e.jsx(Xj,{ref:c,className:F(HT({variant:l}),a),...r}));$b.displayName=Xj.displayName;const qT=u.forwardRef(({className:a,...l},r)=>e.jsx(Zj,{ref:r,className:F("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...l}));qT.displayName=Zj.displayName;const Bb=u.forwardRef(({className:a,...l},r)=>e.jsx(Wj,{ref:r,className:F("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...l,children:e.jsx(Sa,{className:"h-4 w-4"})}));Bb.displayName=Wj.displayName;const Pb=u.forwardRef(({className:a,...l},r)=>e.jsx(ev,{ref:r,className:F("text-sm font-semibold [&+div]:text-xs",a),...l}));Pb.displayName=ev.displayName;const Ib=u.forwardRef(({className:a,...l},r)=>e.jsx(sv,{ref:r,className:F("text-sm opacity-90",a),...l}));Ib.displayName=sv.displayName;function VT(){const{toasts:a}=nt();return e.jsxs(FT,{children:[a.map(function({id:l,title:r,description:c,action:d,...m}){return e.jsxs($b,{...m,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Pb,{children:r}),c&&e.jsx(Ib,{children:c})]}),d,e.jsx(Bb,{})]},l)}),e.jsx(Ub,{})]})}z_.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(dT,{children:e.jsx(PT,{defaultTheme:"system",children:e.jsx(IT,{children:e.jsxs(YS,{children:[e.jsx(lw,{router:BT}),e.jsx(ZS,{}),e.jsx(VT,{})]})})})})}));
