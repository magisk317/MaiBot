import{r as m,j as e,L as Fn,e as ca,R as Ls,b as Q0,f as Y0,g as J0,h as X0,k as Z0,l as Zs,m as W0,n as ew,O as ij,o as sw}from"./router-9vIXuQkh.js";import{a as tw,b as aw,g as lw}from"./react-vendor-BmxF9s7Q.js";import{N as nw,c as rw,O as Wr,P as iw,g as Tm}from"./utils-BqoaXoQ1.js";import{L as cj,T as oj,C as dj,R as cw,a as uj,V as ow,b as dw,S as mj,c as uw,d as xj,I as mw,e as hj,f as xw,g as fj,h as hw,i as fw,j as pw,O as pj,P as gw,k as gj,l as jj,D as vj,A as Nj,m as bj,n as jw,o as vw,p as yj,q as Nw,r as wj,s as bw,t as yw,u as _j,v as ww,w as _w,x as Sj,y as kj,F as Cj,z as Tj,B as Sw,E as kw,G as Ej,H as Cw,J as Tw,K as Ew,M as Mw,N as Aw,Q as zw,U as Rw,W as Dw,X as Ow,Y as Lw,Z as Uw,_ as $w,$ as Bw,a0 as Iw,a1 as Pw,a2 as Mj,a3 as Fw,a4 as Hw}from"./radix-extra-DmmnfeQE.js";import{R as Aj,T as zj,L as Vw,g as Gw,C as Qi,X as Yi,Y as Hr,h as qw,B as Uo,j as Ji,P as Kw,k as Qw,l as Yw}from"./charts-simvewUa.js";import{S as Jw,O as Rj,o as Xw,C as Dj,p as Zw,T as Oj,D as Lj,R as Ww,q as e_,H as Uj,I as s_,J as $j,K as t_,L as Bj,M as Ij,N as a_,Q as Pj,V as l_,U as Fj,X as Hj,Y as n_,Z as r_,_ as Vj,$ as i_,a0 as c_,a1 as Gj,e as qj,f as sd,c as td,P as Zn,d as ad,b as gn,h as o_,l as d_,m as u_,u as Km,r as m_,a as x_,a2 as h_,a3 as Kj,a4 as f_,a5 as p_,a6 as g_,a7 as Qj,a8 as Yj,a9 as Jj,aa as Xj,ab as Zj,ac as Wj,ad as j_}from"./radix-core-DyJi0yyw.js";import{R as xt,a as lc,C as Ct,b as bt,L as Os,X as Aa,c as Mt,d as za,e as Qr,f as Da,g as sa,E as v_,h as na,i as Ka,S as At,B as Vn,U as jn,P as hc,Z as el,j as ev,F as Ea,k as N_,l as vn,m as b_,M as Ra,A as tx,D as y_,n as Yr,T as ax,o as w_,p as sv,I as Vt,q as It,r as Fo,s as nc,t as ia,H as __,u as ls,v as Wt,w as rc,x as lx,y as ec,z as wg,K as nx,G as tv,J as S_,N as $o,O as k_,Q as ld,V as C_,W as T_,Y as nd,_ as Ma,$ as Ys,a0 as rx,a1 as av,a2 as fc,a3 as lv,a4 as nv,a5 as Kn,a6 as Nn,a7 as bn,a8 as ix,a9 as rv,aa as ra,ab as Ll,ac as Qn,ad as Yn,ae as rd,af as E_,ag as M_,ah as A_,ai as cx,aj as Bo,ak as Jn,al as z_,am as Jr,an as Ho,ao as R_,ap as Vo,aq as ic,ar as iv,as as D_,at as O_,au as Go,av as L_,aw as ox,ax as U_,ay as _g,az as $_,aA as B_,aB as cv,aC as I_,aD as mn,aE as ov,aF as Em,aG as Sg,aH as P_,aI as Mm,aJ as F_,aK as H_,aL as V_,aM as G_,aN as dv,aO as q_,aP as Xr,aQ as K_,aR as Q_,aS as uv,aT as mv,aU as Y_,aV as J_,aW as kg,aX as X_,aY as Z_,aZ as W_,a_ as e1,a$ as s1}from"./icons-9Z4kBNLK.js";import{S as t1,p as a1,j as l1,a as n1,E as Am,R as r1,o as i1}from"./codemirror-TZqPU532.js";import{u as xv,a as qo,s as hv,K as fv,P as pv,b as gv,D as jv,c as vv,S as Nv,v as c1,d as bv,C as yv,h as o1}from"./dnd-BiPfFtVp.js";import{_ as ja,c as d1,g as wv,D as u1,z as Ro}from"./misc-CJqnlRwD.js";import{D as m1,U as x1}from"./uppy-DFP_VzYR.js";import{M as h1,r as f1,a as p1,b as g1}from"./markdown-CKA5gBQ9.js";import{c as j1,H as Ko,P as Qo,u as v1,d as N1,R as b1,B as y1,e as w1,C as _1,M as S1,f as k1}from"./reactflow-DtsZHOR4.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const u of d)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function r(d){const u={};return d.integrity&&(u.integrity=d.integrity),d.referrerPolicy&&(u.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?u.credentials="include":d.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function c(d){if(d.ep)return;d.ep=!0;const u=r(d);fetch(d.href,u)}})();var zm={exports:{}},Gi={},Rm={exports:{}},Dm={};var Cg;function C1(){return Cg||(Cg=1,(function(a){function l(R,Q){var $=R.length;R.push(Q);e:for(;0<$;){var ue=$-1>>>1,G=R[ue];if(0<d(G,Q))R[ue]=Q,R[$]=G,$=ue;else break e}}function r(R){return R.length===0?null:R[0]}function c(R){if(R.length===0)return null;var Q=R[0],$=R.pop();if($!==Q){R[0]=$;e:for(var ue=0,G=R.length,Se=G>>>1;ue<Se;){var fe=2*(ue+1)-1,Te=R[fe],q=fe+1,B=R[q];if(0>d(Te,$))q<G&&0>d(B,Te)?(R[ue]=B,R[q]=$,ue=q):(R[ue]=Te,R[fe]=$,ue=fe);else if(q<G&&0>d(B,$))R[ue]=B,R[q]=$,ue=q;else break e}}return Q}function d(R,Q){var $=R.sortIndex-Q.sortIndex;return $!==0?$:R.id-Q.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;a.unstable_now=function(){return u.now()}}else{var h=Date,f=h.now();a.unstable_now=function(){return h.now()-f}}var p=[],g=[],b=1,j=null,y=3,N=!1,w=!1,M=!1,A=!1,S=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(R){for(var Q=r(g);Q!==null;){if(Q.callback===null)c(g);else if(Q.startTime<=R)c(g),Q.sortIndex=Q.expirationTime,l(p,Q);else break;Q=r(g)}}function D(R){if(M=!1,C(R),!w)if(r(p)!==null)w=!0,P||(P=!0,je());else{var Q=r(g);Q!==null&&ge(D,Q.startTime-R)}}var P=!1,O=-1,J=5,L=-1;function oe(){return A?!0:!(a.unstable_now()-L<J)}function Ne(){if(A=!1,P){var R=a.unstable_now();L=R;var Q=!0;try{e:{w=!1,M&&(M=!1,U(O),O=-1),N=!0;var $=y;try{s:{for(C(R),j=r(p);j!==null&&!(j.expirationTime>R&&oe());){var ue=j.callback;if(typeof ue=="function"){j.callback=null,y=j.priorityLevel;var G=ue(j.expirationTime<=R);if(R=a.unstable_now(),typeof G=="function"){j.callback=G,C(R),Q=!0;break s}j===r(p)&&c(p),C(R)}else c(p);j=r(p)}if(j!==null)Q=!0;else{var Se=r(g);Se!==null&&ge(D,Se.startTime-R),Q=!1}}break e}finally{j=null,y=$,N=!1}Q=void 0}}finally{Q?je():P=!1}}}var je;if(typeof E=="function")je=function(){E(Ne)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,he=de.port2;de.port1.onmessage=Ne,je=function(){he.postMessage(null)}}else je=function(){S(Ne,0)};function ge(R,Q){O=S(function(){R(a.unstable_now())},Q)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(R){R.callback=null},a.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<R?Math.floor(1e3/R):5},a.unstable_getCurrentPriorityLevel=function(){return y},a.unstable_next=function(R){switch(y){case 1:case 2:case 3:var Q=3;break;default:Q=y}var $=y;y=Q;try{return R()}finally{y=$}},a.unstable_requestPaint=function(){A=!0},a.unstable_runWithPriority=function(R,Q){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var $=y;y=R;try{return Q()}finally{y=$}},a.unstable_scheduleCallback=function(R,Q,$){var ue=a.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?ue+$:ue):$=ue,R){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=$+G,R={id:b++,callback:Q,priorityLevel:R,startTime:$,expirationTime:G,sortIndex:-1},$>ue?(R.sortIndex=$,l(g,R),r(p)===null&&R===r(g)&&(M?(U(O),O=-1):M=!0,ge(D,$-ue))):(R.sortIndex=G,l(p,R),w||N||(w=!0,P||(P=!0,je()))),R},a.unstable_shouldYield=oe,a.unstable_wrapCallback=function(R){var Q=y;return function(){var $=y;y=Q;try{return R.apply(this,arguments)}finally{y=$}}}})(Dm)),Dm}var Tg;function T1(){return Tg||(Tg=1,Rm.exports=C1()),Rm.exports}var Eg;function E1(){if(Eg)return Gi;Eg=1;var a=T1(),l=tw(),r=aw();function c(s){var t="https://react.dev/errors/"+s;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+s+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var t=s,n=s;if(s.alternate)for(;t.return;)t=t.return;else{s=t;do t=s,(t.flags&4098)!==0&&(n=t.return),s=t.return;while(s)}return t.tag===3?n:null}function h(s){if(s.tag===13){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function f(s){if(s.tag===31){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function p(s){if(u(s)!==s)throw Error(c(188))}function g(s){var t=s.alternate;if(!t){if(t=u(s),t===null)throw Error(c(188));return t!==s?null:s}for(var n=s,i=t;;){var o=n.return;if(o===null)break;var x=o.alternate;if(x===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===x.child){for(x=o.child;x;){if(x===n)return p(o),s;if(x===i)return p(o),t;x=x.sibling}throw Error(c(188))}if(n.return!==i.return)n=o,i=x;else{for(var v=!1,k=o.child;k;){if(k===n){v=!0,n=o,i=x;break}if(k===i){v=!0,i=o,n=x;break}k=k.sibling}if(!v){for(k=x.child;k;){if(k===n){v=!0,n=x,i=o;break}if(k===i){v=!0,i=x,n=o;break}k=k.sibling}if(!v)throw Error(c(189))}}if(n.alternate!==i)throw Error(c(190))}if(n.tag!==3)throw Error(c(188));return n.stateNode.current===n?s:t}function b(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s;for(s=s.child;s!==null;){if(t=b(s),t!==null)return t;s=s.sibling}return null}var j=Object.assign,y=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),oe=Symbol.for("react.memo_cache_sentinel"),Ne=Symbol.iterator;function je(s){return s===null||typeof s!="object"?null:(s=Ne&&s[Ne]||s["@@iterator"],typeof s=="function"?s:null)}var de=Symbol.for("react.client.reference");function he(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===de?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case M:return"Fragment";case S:return"Profiler";case A:return"StrictMode";case D:return"Suspense";case P:return"SuspenseList";case L:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case E:return s.displayName||"Context";case U:return(s._context.displayName||"Context")+".Consumer";case C:var t=s.render;return s=s.displayName,s||(s=t.displayName||t.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return t=s.displayName||null,t!==null?t:he(s.type)||"Memo";case J:t=s._payload,s=s._init;try{return he(s(t))}catch{}}return null}var ge=Array.isArray,R=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},ue=[],G=-1;function Se(s){return{current:s}}function fe(s){0>G||(s.current=ue[G],ue[G]=null,G--)}function Te(s,t){G++,ue[G]=s.current,s.current=t}var q=Se(null),B=Se(null),z=Se(null),K=Se(null);function Ae(s,t){switch(Te(z,t),Te(B,s),Te(q,null),t.nodeType){case 9:case 11:s=(s=t.documentElement)&&(s=s.namespaceURI)?qp(s):0;break;default:if(s=t.tagName,t=t.namespaceURI)t=qp(t),s=Kp(t,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}fe(q),Te(q,s)}function ee(){fe(q),fe(B),fe(z)}function Y(s){s.memoizedState!==null&&Te(K,s);var t=q.current,n=Kp(t,s.type);t!==n&&(Te(B,s),Te(q,n))}function $e(s){B.current===s&&(fe(q),fe(B)),K.current===s&&(fe(K),Pi._currentValue=$)}var H,se;function Ue(s){if(H===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);H=t&&t[1]||"",se=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+H+s+se}var ie=!1;function Ee(s,t){if(!s||ie)return"";ie=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(xe){var ce=xe}Reflect.construct(s,[],ye)}else{try{ye.call()}catch(xe){ce=xe}s.call(ye.prototype)}}else{try{throw Error()}catch(xe){ce=xe}(ye=s())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(xe){if(xe&&ce&&typeof xe.stack=="string")return[xe.stack,ce.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=i.DetermineComponentFrameRoot(),v=x[0],k=x[1];if(v&&k){var I=v.split(`
`),ne=k.split(`
`);for(o=i=0;i<I.length&&!I[i].includes("DetermineComponentFrameRoot");)i++;for(;o<ne.length&&!ne[o].includes("DetermineComponentFrameRoot");)o++;if(i===I.length||o===ne.length)for(i=I.length-1,o=ne.length-1;1<=i&&0<=o&&I[i]!==ne[o];)o--;for(;1<=i&&0<=o;i--,o--)if(I[i]!==ne[o]){if(i!==1||o!==1)do if(i--,o--,0>o||I[i]!==ne[o]){var ve=`
`+I[i].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=i&&0<=o);break}}}finally{ie=!1,Error.prepareStackTrace=n}return(n=s?s.displayName||s.name:"")?Ue(n):""}function me(s,t){switch(s.tag){case 26:case 27:case 5:return Ue(s.type);case 16:return Ue("Lazy");case 13:return s.child!==t&&t!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return Ee(s.type,!1);case 11:return Ee(s.type.render,!1);case 1:return Ee(s.type,!0);case 31:return Ue("Activity");default:return""}}function ze(s){try{var t="",n=null;do t+=me(s,n),n=s,s=s.return;while(s);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var at=Object.prototype.hasOwnProperty,Pt=a.unstable_scheduleCallback,qt=a.unstable_cancelCallback,Ja=a.unstable_shouldYield,As=a.unstable_requestPaint,vt=a.unstable_now,Z=a.unstable_getCurrentPriorityLevel,qe=a.unstable_ImmediatePriority,Qe=a.unstable_UserBlockingPriority,We=a.unstable_NormalPriority,Rs=a.unstable_LowPriority,He=a.unstable_IdlePriority,Ss=a.log,Ds=a.unstable_setDisableYieldValue,Vs=null,ns=null;function ts(s){if(typeof Ss=="function"&&Ds(s),ns&&typeof ns.setStrictMode=="function")try{ns.setStrictMode(Vs,s)}catch{}}var Ns=Math.clz32?Math.clz32:_s,Le=Math.log,bs=Math.LN2;function _s(s){return s>>>=0,s===0?32:31-(Le(s)/bs|0)|0}var rs=256,ft=262144,zt=4194304;function Oa(s){var t=s&42;if(t!==0)return t;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ll(s,t,n){var i=s.pendingLanes;if(i===0)return 0;var o=0,x=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var k=i&134217727;return k!==0?(i=k&~x,i!==0?o=Oa(i):(v&=k,v!==0?o=Oa(v):n||(n=k&~s,n!==0&&(o=Oa(n))))):(k=i&~x,k!==0?o=Oa(k):v!==0?o=Oa(v):n||(n=i&~s,n!==0&&(o=Oa(n)))),o===0?0:t!==0&&t!==o&&(t&x)===0&&(x=o&-o,n=t&-t,x>=n||x===32&&(n&4194048)!==0)?t:o}function xl(s,t){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&t)===0}function sr(s,t){switch(s){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function te(){var s=zt;return zt<<=1,(zt&62914560)===0&&(zt=4194304),s}function we(s){for(var t=[],n=0;31>n;n++)t.push(s);return t}function Oe(s,t){s.pendingLanes|=t,t!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Gs(s,t,n,i,o,x){var v=s.pendingLanes;s.pendingLanes=n,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=n,s.entangledLanes&=n,s.errorRecoveryDisabledLanes&=n,s.shellSuspendCounter=0;var k=s.entanglements,I=s.expirationTimes,ne=s.hiddenUpdates;for(n=v&~n;0<n;){var ve=31-Ns(n),ye=1<<ve;k[ve]=0,I[ve]=-1;var ce=ne[ve];if(ce!==null)for(ne[ve]=null,ve=0;ve<ce.length;ve++){var xe=ce[ve];xe!==null&&(xe.lane&=-536870913)}n&=~ye}i!==0&&Ut(s,i,0),x!==0&&o===0&&s.tag!==0&&(s.suspendedLanes|=x&~(v&~t))}function Ut(s,t,n){s.pendingLanes|=t,s.suspendedLanes&=~t;var i=31-Ns(t);s.entangledLanes|=t,s.entanglements[i]=s.entanglements[i]|1073741824|n&261930}function ta(s,t){var n=s.entangledLanes|=t;for(s=s.entanglements;n;){var i=31-Ns(n),o=1<<i;o&t|s[i]&t&&(s[i]|=t),n&=~o}}function dt(s,t){var n=t&-t;return n=(n&42)!==0?1:aa(n),(n&(s.suspendedLanes|t))!==0?0:n}function aa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function pt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function re(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:pg(s.type))}function pe(s,t){var n=Q.p;try{return Q.p=s,t()}finally{Q.p=n}}var as=Math.random().toString(36).slice(2),ys="__reactFiber$"+as,fs="__reactProps$"+as,yt="__reactContainer$"+as,va="__reactEvents$"+as,Pl="__reactListeners$"+as,tr="__reactHandles$"+as,ti="__reactResources$"+as,_n="__reactMarker$"+as;function Nd(s){delete s[ys],delete s[fs],delete s[va],delete s[Pl],delete s[tr]}function ar(s){var t=s[ys];if(t)return t;for(var n=s.parentNode;n;){if(t=n[yt]||n[ys]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(s=eg(s);s!==null;){if(n=s[ys])return n;s=eg(s)}return t}s=n,n=s.parentNode}return null}function lr(s){if(s=s[ys]||s[yt]){var t=s.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return s}return null}function ai(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s.stateNode;throw Error(c(33))}function nr(s){var t=s[ti];return t||(t=s[ti]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ft(s){s[_n]=!0}var Rx=new Set,Dx={};function Sn(s,t){rr(s,t),rr(s+"Capture",t)}function rr(s,t){for(Dx[s]=t,s=0;s<t.length;s++)Rx.add(t[s])}var Bb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ox={},Lx={};function Ib(s){return at.call(Lx,s)?!0:at.call(Ox,s)?!1:Bb.test(s)?Lx[s]=!0:(Ox[s]=!0,!1)}function Nc(s,t,n){if(Ib(t))if(n===null)s.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":s.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){s.removeAttribute(t);return}}s.setAttribute(t,""+n)}}function bc(s,t,n){if(n===null)s.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(t);return}s.setAttribute(t,""+n)}}function hl(s,t,n,i){if(i===null)s.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(n);return}s.setAttributeNS(t,n,""+i)}}function La(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ux(s){var t=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Pb(s,t,n){var i=Object.getOwnPropertyDescriptor(s.constructor.prototype,t);if(!s.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var o=i.get,x=i.set;return Object.defineProperty(s,t,{configurable:!0,get:function(){return o.call(this)},set:function(v){n=""+v,x.call(this,v)}}),Object.defineProperty(s,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(v){n=""+v},stopTracking:function(){s._valueTracker=null,delete s[t]}}}}function bd(s){if(!s._valueTracker){var t=Ux(s)?"checked":"value";s._valueTracker=Pb(s,t,""+s[t])}}function $x(s){if(!s)return!1;var t=s._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return s&&(i=Ux(s)?s.checked?"true":"false":s.value),s=i,s!==n?(t.setValue(s),!0):!1}function yc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Fb=/[\n"\\]/g;function Ua(s){return s.replace(Fb,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function yd(s,t,n,i,o,x,v,k){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),t!=null?v==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+La(t)):s.value!==""+La(t)&&(s.value=""+La(t)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),t!=null?wd(s,v,La(t)):n!=null?wd(s,v,La(n)):i!=null&&s.removeAttribute("value"),o==null&&x!=null&&(s.defaultChecked=!!x),o!=null&&(s.checked=o&&typeof o!="function"&&typeof o!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+La(k):s.removeAttribute("name")}function Bx(s,t,n,i,o,x,v,k){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),t!=null||n!=null){if(!(x!=="submit"&&x!=="reset"||t!=null)){bd(s);return}n=n!=null?""+La(n):"",t=t!=null?""+La(t):n,k||t===s.value||(s.value=t),s.defaultValue=t}i=i??o,i=typeof i!="function"&&typeof i!="symbol"&&!!i,s.checked=k?s.checked:!!i,s.defaultChecked=!!i,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),bd(s)}function wd(s,t,n){t==="number"&&yc(s.ownerDocument)===s||s.defaultValue===""+n||(s.defaultValue=""+n)}function ir(s,t,n,i){if(s=s.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<s.length;n++)o=t.hasOwnProperty("$"+s[n].value),s[n].selected!==o&&(s[n].selected=o),o&&i&&(s[n].defaultSelected=!0)}else{for(n=""+La(n),t=null,o=0;o<s.length;o++){if(s[o].value===n){s[o].selected=!0,i&&(s[o].defaultSelected=!0);return}t!==null||s[o].disabled||(t=s[o])}t!==null&&(t.selected=!0)}}function Ix(s,t,n){if(t!=null&&(t=""+La(t),t!==s.value&&(s.value=t),n==null)){s.defaultValue!==t&&(s.defaultValue=t);return}s.defaultValue=n!=null?""+La(n):""}function Px(s,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(c(92));if(ge(i)){if(1<i.length)throw Error(c(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=La(t),s.defaultValue=n,i=s.textContent,i===n&&i!==""&&i!==null&&(s.value=i),bd(s)}function cr(s,t){if(t){var n=s.firstChild;if(n&&n===s.lastChild&&n.nodeType===3){n.nodeValue=t;return}}s.textContent=t}var Hb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fx(s,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?s.setProperty(t,""):t==="float"?s.cssFloat="":s[t]="":i?s.setProperty(t,n):typeof n!="number"||n===0||Hb.has(t)?t==="float"?s.cssFloat=n:s[t]=(""+n).trim():s[t]=n+"px"}function Hx(s,t,n){if(t!=null&&typeof t!="object")throw Error(c(62));if(s=s.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="");for(var o in t)i=t[o],t.hasOwnProperty(o)&&n[o]!==i&&Fx(s,o,i)}else for(var x in t)t.hasOwnProperty(x)&&Fx(s,x,t[x])}function _d(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wc(s){return Gb.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function fl(){}var Sd=null;function kd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var or=null,dr=null;function Vx(s){var t=lr(s);if(t&&(s=t.stateNode)){var n=s[fs]||null;e:switch(s=t.stateNode,t.type){case"input":if(yd(s,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=s;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Ua(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==s&&i.form===s.form){var o=i[fs]||null;if(!o)throw Error(c(90));yd(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===s.form&&$x(i)}break e;case"textarea":Ix(s,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&ir(s,!!n.multiple,t,!1)}}}var Cd=!1;function Gx(s,t,n){if(Cd)return s(t,n);Cd=!0;try{var i=s(t);return i}finally{if(Cd=!1,(or!==null||dr!==null)&&(uo(),or&&(t=or,s=dr,dr=or=null,Vx(t),s)))for(t=0;t<s.length;t++)Vx(s[t])}}function li(s,t){var n=s.stateNode;if(n===null)return null;var i=n[fs]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(s=s.type,i=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!i;break e;default:s=!1}if(s)return null;if(n&&typeof n!="function")throw Error(c(231,t,typeof n));return n}var pl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Td=!1;if(pl)try{var ni={};Object.defineProperty(ni,"passive",{get:function(){Td=!0}}),window.addEventListener("test",ni,ni),window.removeEventListener("test",ni,ni)}catch{Td=!1}var Fl=null,Ed=null,_c=null;function qx(){if(_c)return _c;var s,t=Ed,n=t.length,i,o="value"in Fl?Fl.value:Fl.textContent,x=o.length;for(s=0;s<n&&t[s]===o[s];s++);var v=n-s;for(i=1;i<=v&&t[n-i]===o[x-i];i++);return _c=o.slice(s,1<i?1-i:void 0)}function Sc(s){var t=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&t===13&&(s=13)):s=t,s===10&&(s=13),32<=s||s===13?s:0}function kc(){return!0}function Kx(){return!1}function da(s){function t(n,i,o,x,v){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=x,this.target=v,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(n=s[k],this[k]=n?n(x):x[k]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?kc:Kx,this.isPropagationStopped=Kx,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kc)},persist:function(){},isPersistent:kc}),t}var kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cc=da(kn),ri=j({},kn,{view:0,detail:0}),qb=da(ri),Md,Ad,ii,Tc=j({},ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ii&&(ii&&s.type==="mousemove"?(Md=s.screenX-ii.screenX,Ad=s.screenY-ii.screenY):Ad=Md=0,ii=s),Md)},movementY:function(s){return"movementY"in s?s.movementY:Ad}}),Qx=da(Tc),Kb=j({},Tc,{dataTransfer:0}),Qb=da(Kb),Yb=j({},ri,{relatedTarget:0}),zd=da(Yb),Jb=j({},kn,{animationName:0,elapsedTime:0,pseudoElement:0}),Xb=da(Jb),Zb=j({},kn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Wb=da(Zb),ey=j({},kn,{data:0}),Yx=da(ey),sy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ty={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ay={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ly(s){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(s):(s=ay[s])?!!t[s]:!1}function Rd(){return ly}var ny=j({},ri,{key:function(s){if(s.key){var t=sy[s.key]||s.key;if(t!=="Unidentified")return t}return s.type==="keypress"?(s=Sc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ty[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rd,charCode:function(s){return s.type==="keypress"?Sc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Sc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ry=da(ny),iy=j({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jx=da(iy),cy=j({},ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rd}),oy=da(cy),dy=j({},kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),uy=da(dy),my=j({},Tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),xy=da(my),hy=j({},kn,{newState:0,oldState:0}),fy=da(hy),py=[9,13,27,32],Dd=pl&&"CompositionEvent"in window,ci=null;pl&&"documentMode"in document&&(ci=document.documentMode);var gy=pl&&"TextEvent"in window&&!ci,Xx=pl&&(!Dd||ci&&8<ci&&11>=ci),Zx=" ",Wx=!1;function eh(s,t){switch(s){case"keyup":return py.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sh(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ur=!1;function jy(s,t){switch(s){case"compositionend":return sh(t);case"keypress":return t.which!==32?null:(Wx=!0,Zx);case"textInput":return s=t.data,s===Zx&&Wx?null:s;default:return null}}function vy(s,t){if(ur)return s==="compositionend"||!Dd&&eh(s,t)?(s=qx(),_c=Ed=Fl=null,ur=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xx&&t.locale!=="ko"?null:t.data;default:return null}}var Ny={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function th(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t==="input"?!!Ny[s.type]:t==="textarea"}function ah(s,t,n,i){or?dr?dr.push(i):dr=[i]:or=i,t=jo(t,"onChange"),0<t.length&&(n=new Cc("onChange","change",null,n,i),s.push({event:n,listeners:t}))}var oi=null,di=null;function by(s){Ip(s,0)}function Ec(s){var t=ai(s);if($x(t))return s}function lh(s,t){if(s==="change")return t}var nh=!1;if(pl){var Od;if(pl){var Ld="oninput"in document;if(!Ld){var rh=document.createElement("div");rh.setAttribute("oninput","return;"),Ld=typeof rh.oninput=="function"}Od=Ld}else Od=!1;nh=Od&&(!document.documentMode||9<document.documentMode)}function ih(){oi&&(oi.detachEvent("onpropertychange",ch),di=oi=null)}function ch(s){if(s.propertyName==="value"&&Ec(di)){var t=[];ah(t,di,s,kd(s)),Gx(by,t)}}function yy(s,t,n){s==="focusin"?(ih(),oi=t,di=n,oi.attachEvent("onpropertychange",ch)):s==="focusout"&&ih()}function wy(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ec(di)}function _y(s,t){if(s==="click")return Ec(t)}function Sy(s,t){if(s==="input"||s==="change")return Ec(t)}function ky(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var Na=typeof Object.is=="function"?Object.is:ky;function ui(s,t){if(Na(s,t))return!0;if(typeof s!="object"||s===null||typeof t!="object"||t===null)return!1;var n=Object.keys(s),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!at.call(t,o)||!Na(s[o],t[o]))return!1}return!0}function oh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function dh(s,t){var n=oh(s);s=0;for(var i;n;){if(n.nodeType===3){if(i=s+n.textContent.length,s<=t&&i>=t)return{node:n,offset:t-s};s=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=oh(n)}}function uh(s,t){return s&&t?s===t?!0:s&&s.nodeType===3?!1:t&&t.nodeType===3?uh(s,t.parentNode):"contains"in s?s.contains(t):s.compareDocumentPosition?!!(s.compareDocumentPosition(t)&16):!1:!1}function mh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var t=yc(s.document);t instanceof s.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)s=t.contentWindow;else break;t=yc(s.document)}return t}function Ud(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t&&(t==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||t==="textarea"||s.contentEditable==="true")}var Cy=pl&&"documentMode"in document&&11>=document.documentMode,mr=null,$d=null,mi=null,Bd=!1;function xh(s,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bd||mr==null||mr!==yc(i)||(i=mr,"selectionStart"in i&&Ud(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),mi&&ui(mi,i)||(mi=i,i=jo($d,"onSelect"),0<i.length&&(t=new Cc("onSelect","select",null,t,n),s.push({event:t,listeners:i}),t.target=mr)))}function Cn(s,t){var n={};return n[s.toLowerCase()]=t.toLowerCase(),n["Webkit"+s]="webkit"+t,n["Moz"+s]="moz"+t,n}var xr={animationend:Cn("Animation","AnimationEnd"),animationiteration:Cn("Animation","AnimationIteration"),animationstart:Cn("Animation","AnimationStart"),transitionrun:Cn("Transition","TransitionRun"),transitionstart:Cn("Transition","TransitionStart"),transitioncancel:Cn("Transition","TransitionCancel"),transitionend:Cn("Transition","TransitionEnd")},Id={},hh={};pl&&(hh=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);function Tn(s){if(Id[s])return Id[s];if(!xr[s])return s;var t=xr[s],n;for(n in t)if(t.hasOwnProperty(n)&&n in hh)return Id[s]=t[n];return s}var fh=Tn("animationend"),ph=Tn("animationiteration"),gh=Tn("animationstart"),Ty=Tn("transitionrun"),Ey=Tn("transitionstart"),My=Tn("transitioncancel"),jh=Tn("transitionend"),vh=new Map,Pd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pd.push("scrollEnd");function Xa(s,t){vh.set(s,t),Sn(t,[s])}var Mc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},$a=[],hr=0,Fd=0;function Ac(){for(var s=hr,t=Fd=hr=0;t<s;){var n=$a[t];$a[t++]=null;var i=$a[t];$a[t++]=null;var o=$a[t];$a[t++]=null;var x=$a[t];if($a[t++]=null,i!==null&&o!==null){var v=i.pending;v===null?o.next=o:(o.next=v.next,v.next=o),i.pending=o}x!==0&&Nh(n,o,x)}}function zc(s,t,n,i){$a[hr++]=s,$a[hr++]=t,$a[hr++]=n,$a[hr++]=i,Fd|=i,s.lanes|=i,s=s.alternate,s!==null&&(s.lanes|=i)}function Hd(s,t,n,i){return zc(s,t,n,i),Rc(s)}function En(s,t){return zc(s,null,null,t),Rc(s)}function Nh(s,t,n){s.lanes|=n;var i=s.alternate;i!==null&&(i.lanes|=n);for(var o=!1,x=s.return;x!==null;)x.childLanes|=n,i=x.alternate,i!==null&&(i.childLanes|=n),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(o=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,o&&t!==null&&(o=31-Ns(n),s=x.hiddenUpdates,i=s[o],i===null?s[o]=[t]:i.push(t),t.lane=n|536870912),x):null}function Rc(s){if(50<Di)throw Di=0,Zu=null,Error(c(185));for(var t=s.return;t!==null;)s=t,t=s.return;return s.tag===3?s.stateNode:null}var fr={};function Ay(s,t,n,i){this.tag=s,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ba(s,t,n,i){return new Ay(s,t,n,i)}function Vd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function gl(s,t){var n=s.alternate;return n===null?(n=ba(s.tag,t,s.key,s.mode),n.elementType=s.elementType,n.type=s.type,n.stateNode=s.stateNode,n.alternate=s,s.alternate=n):(n.pendingProps=t,n.type=s.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=s.flags&65011712,n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,t=s.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=s.sibling,n.index=s.index,n.ref=s.ref,n.refCleanup=s.refCleanup,n}function bh(s,t){s.flags&=65011714;var n=s.alternate;return n===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=n.childLanes,s.lanes=n.lanes,s.child=n.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=n.memoizedProps,s.memoizedState=n.memoizedState,s.updateQueue=n.updateQueue,s.type=n.type,t=n.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s}function Dc(s,t,n,i,o,x){var v=0;if(i=s,typeof s=="function")Vd(s)&&(v=1);else if(typeof s=="string")v=L0(s,n,q.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case L:return s=ba(31,n,t,o),s.elementType=L,s.lanes=x,s;case M:return Mn(n.children,o,x,t);case A:v=8,o|=24;break;case S:return s=ba(12,n,t,o|2),s.elementType=S,s.lanes=x,s;case D:return s=ba(13,n,t,o),s.elementType=D,s.lanes=x,s;case P:return s=ba(19,n,t,o),s.elementType=P,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:v=10;break e;case U:v=9;break e;case C:v=11;break e;case O:v=14;break e;case J:v=16,i=null;break e}v=29,n=Error(c(130,s===null?"null":typeof s,"")),i=null}return t=ba(v,n,t,o),t.elementType=s,t.type=i,t.lanes=x,t}function Mn(s,t,n,i){return s=ba(7,s,i,t),s.lanes=n,s}function Gd(s,t,n){return s=ba(6,s,null,t),s.lanes=n,s}function yh(s){var t=ba(18,null,null,0);return t.stateNode=s,t}function qd(s,t,n){return t=ba(4,s.children!==null?s.children:[],s.key,t),t.lanes=n,t.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},t}var wh=new WeakMap;function Ba(s,t){if(typeof s=="object"&&s!==null){var n=wh.get(s);return n!==void 0?n:(t={value:s,source:t,stack:ze(t)},wh.set(s,t),t)}return{value:s,source:t,stack:ze(t)}}var pr=[],gr=0,Oc=null,xi=0,Ia=[],Pa=0,Hl=null,nl=1,rl="";function jl(s,t){pr[gr++]=xi,pr[gr++]=Oc,Oc=s,xi=t}function _h(s,t,n){Ia[Pa++]=nl,Ia[Pa++]=rl,Ia[Pa++]=Hl,Hl=s;var i=nl;s=rl;var o=32-Ns(i)-1;i&=~(1<<o),n+=1;var x=32-Ns(t)+o;if(30<x){var v=o-o%5;x=(i&(1<<v)-1).toString(32),i>>=v,o-=v,nl=1<<32-Ns(t)+o|n<<o|i,rl=x+s}else nl=1<<x|n<<o|i,rl=s}function Kd(s){s.return!==null&&(jl(s,1),_h(s,1,0))}function Qd(s){for(;s===Oc;)Oc=pr[--gr],pr[gr]=null,xi=pr[--gr],pr[gr]=null;for(;s===Hl;)Hl=Ia[--Pa],Ia[Pa]=null,rl=Ia[--Pa],Ia[Pa]=null,nl=Ia[--Pa],Ia[Pa]=null}function Sh(s,t){Ia[Pa++]=nl,Ia[Pa++]=rl,Ia[Pa++]=Hl,nl=t.id,rl=t.overflow,Hl=s}var Kt=null,ut=null,zs=!1,Vl=null,Fa=!1,Yd=Error(c(519));function Gl(s){var t=Error(c(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hi(Ba(t,s)),Yd}function kh(s){var t=s.stateNode,n=s.type,i=s.memoizedProps;switch(t[ys]=s,t[fs]=i,n){case"dialog":Cs("cancel",t),Cs("close",t);break;case"iframe":case"object":case"embed":Cs("load",t);break;case"video":case"audio":for(n=0;n<Li.length;n++)Cs(Li[n],t);break;case"source":Cs("error",t);break;case"img":case"image":case"link":Cs("error",t),Cs("load",t);break;case"details":Cs("toggle",t);break;case"input":Cs("invalid",t),Bx(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Cs("invalid",t);break;case"textarea":Cs("invalid",t),Px(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||Vp(t.textContent,n)?(i.popover!=null&&(Cs("beforetoggle",t),Cs("toggle",t)),i.onScroll!=null&&Cs("scroll",t),i.onScrollEnd!=null&&Cs("scrollend",t),i.onClick!=null&&(t.onclick=fl),t=!0):t=!1,t||Gl(s,!0)}function Ch(s){for(Kt=s.return;Kt;)switch(Kt.tag){case 5:case 31:case 13:Fa=!1;return;case 27:case 3:Fa=!0;return;default:Kt=Kt.return}}function jr(s){if(s!==Kt)return!1;if(!zs)return Ch(s),zs=!0,!1;var t=s.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=s.type,n=!(n!=="form"&&n!=="button")||xm(s.type,s.memoizedProps)),n=!n),n&&ut&&Gl(s),Ch(s),t===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));ut=Wp(s)}else if(t===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));ut=Wp(s)}else t===27?(t=ut,nn(s.type)?(s=jm,jm=null,ut=s):ut=t):ut=Kt?Va(s.stateNode.nextSibling):null;return!0}function An(){ut=Kt=null,zs=!1}function Jd(){var s=Vl;return s!==null&&(ha===null?ha=s:ha.push.apply(ha,s),Vl=null),s}function hi(s){Vl===null?Vl=[s]:Vl.push(s)}var Xd=Se(null),zn=null,vl=null;function ql(s,t,n){Te(Xd,t._currentValue),t._currentValue=n}function Nl(s){s._currentValue=Xd.current,fe(Xd)}function Zd(s,t,n){for(;s!==null;){var i=s.alternate;if((s.childLanes&t)!==t?(s.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),s===n)break;s=s.return}}function Wd(s,t,n,i){var o=s.child;for(o!==null&&(o.return=s);o!==null;){var x=o.dependencies;if(x!==null){var v=o.child;x=x.firstContext;e:for(;x!==null;){var k=x;x=o;for(var I=0;I<t.length;I++)if(k.context===t[I]){x.lanes|=n,k=x.alternate,k!==null&&(k.lanes|=n),Zd(x.return,n,s),i||(v=null);break e}x=k.next}}else if(o.tag===18){if(v=o.return,v===null)throw Error(c(341));v.lanes|=n,x=v.alternate,x!==null&&(x.lanes|=n),Zd(v,n,s),v=null}else v=o.child;if(v!==null)v.return=o;else for(v=o;v!==null;){if(v===s){v=null;break}if(o=v.sibling,o!==null){o.return=v.return,v=o;break}v=v.return}o=v}}function vr(s,t,n,i){s=null;for(var o=t,x=!1;o!==null;){if(!x){if((o.flags&524288)!==0)x=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var v=o.alternate;if(v===null)throw Error(c(387));if(v=v.memoizedProps,v!==null){var k=o.type;Na(o.pendingProps.value,v.value)||(s!==null?s.push(k):s=[k])}}else if(o===K.current){if(v=o.alternate,v===null)throw Error(c(387));v.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(s!==null?s.push(Pi):s=[Pi])}o=o.return}s!==null&&Wd(t,s,n,i),t.flags|=262144}function Lc(s){for(s=s.firstContext;s!==null;){if(!Na(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Rn(s){zn=s,vl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qt(s){return Th(zn,s)}function Uc(s,t){return zn===null&&Rn(s),Th(s,t)}function Th(s,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},vl===null){if(s===null)throw Error(c(308));vl=t,s.dependencies={lanes:0,firstContext:t},s.flags|=524288}else vl=vl.next=t;return n}var zy=typeof AbortController<"u"?AbortController:function(){var s=[],t=this.signal={aborted:!1,addEventListener:function(n,i){s.push(i)}};this.abort=function(){t.aborted=!0,s.forEach(function(n){return n()})}},Ry=a.unstable_scheduleCallback,Dy=a.unstable_NormalPriority,Rt={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function eu(){return{controller:new zy,data:new Map,refCount:0}}function fi(s){s.refCount--,s.refCount===0&&Ry(Dy,function(){s.controller.abort()})}var pi=null,su=0,Nr=0,br=null;function Oy(s,t){if(pi===null){var n=pi=[];su=0,Nr=lm(),br={status:"pending",value:void 0,then:function(i){n.push(i)}}}return su++,t.then(Eh,Eh),t}function Eh(){if(--su===0&&pi!==null){br!==null&&(br.status="fulfilled");var s=pi;pi=null,Nr=0,br=null;for(var t=0;t<s.length;t++)(0,s[t])()}}function Ly(s,t){var n=[],i={status:"pending",value:null,reason:null,then:function(o){n.push(o)}};return s.then(function(){i.status="fulfilled",i.value=t;for(var o=0;o<n.length;o++)(0,n[o])(t)},function(o){for(i.status="rejected",i.reason=o,o=0;o<n.length;o++)(0,n[o])(void 0)}),i}var Mh=R.S;R.S=function(s,t){hp=vt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Oy(s,t),Mh!==null&&Mh(s,t)};var Dn=Se(null);function tu(){var s=Dn.current;return s!==null?s:lt.pooledCache}function $c(s,t){t===null?Te(Dn,Dn.current):Te(Dn,t.pool)}function Ah(){var s=tu();return s===null?null:{parent:Rt._currentValue,pool:s}}var yr=Error(c(460)),au=Error(c(474)),Bc=Error(c(542)),Ic={then:function(){}};function zh(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Rh(s,t,n){switch(n=s[n],n===void 0?s.push(t):n!==t&&(t.then(fl,fl),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Oh(s),s;default:if(typeof t.status=="string")t.then(fl,fl);else{if(s=lt,s!==null&&100<s.shellSuspendCounter)throw Error(c(482));s=t,s.status="pending",s.then(function(i){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=i}},function(i){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Oh(s),s}throw Ln=t,yr}}function On(s){try{var t=s._init;return t(s._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Ln=n,yr):n}}var Ln=null;function Dh(){if(Ln===null)throw Error(c(459));var s=Ln;return Ln=null,s}function Oh(s){if(s===yr||s===Bc)throw Error(c(483))}var wr=null,gi=0;function Pc(s){var t=gi;return gi+=1,wr===null&&(wr=[]),Rh(wr,s,t)}function ji(s,t){t=t.props.ref,s.ref=t!==void 0?t:null}function Fc(s,t){throw t.$$typeof===y?Error(c(525)):(s=Object.prototype.toString.call(t),Error(c(31,s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)))}function Lh(s){function t(X,V){if(s){var le=X.deletions;le===null?(X.deletions=[V],X.flags|=16):le.push(V)}}function n(X,V){if(!s)return null;for(;V!==null;)t(X,V),V=V.sibling;return null}function i(X){for(var V=new Map;X!==null;)X.key!==null?V.set(X.key,X):V.set(X.index,X),X=X.sibling;return V}function o(X,V){return X=gl(X,V),X.index=0,X.sibling=null,X}function x(X,V,le){return X.index=le,s?(le=X.alternate,le!==null?(le=le.index,le<V?(X.flags|=67108866,V):le):(X.flags|=67108866,V)):(X.flags|=1048576,V)}function v(X){return s&&X.alternate===null&&(X.flags|=67108866),X}function k(X,V,le,be){return V===null||V.tag!==6?(V=Gd(le,X.mode,be),V.return=X,V):(V=o(V,le),V.return=X,V)}function I(X,V,le,be){var Je=le.type;return Je===M?ve(X,V,le.props.children,be,le.key):V!==null&&(V.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===J&&On(Je)===V.type)?(V=o(V,le.props),ji(V,le),V.return=X,V):(V=Dc(le.type,le.key,le.props,null,X.mode,be),ji(V,le),V.return=X,V)}function ne(X,V,le,be){return V===null||V.tag!==4||V.stateNode.containerInfo!==le.containerInfo||V.stateNode.implementation!==le.implementation?(V=qd(le,X.mode,be),V.return=X,V):(V=o(V,le.children||[]),V.return=X,V)}function ve(X,V,le,be,Je){return V===null||V.tag!==7?(V=Mn(le,X.mode,be,Je),V.return=X,V):(V=o(V,le),V.return=X,V)}function ye(X,V,le){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Gd(""+V,X.mode,le),V.return=X,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case N:return le=Dc(V.type,V.key,V.props,null,X.mode,le),ji(le,V),le.return=X,le;case w:return V=qd(V,X.mode,le),V.return=X,V;case J:return V=On(V),ye(X,V,le)}if(ge(V)||je(V))return V=Mn(V,X.mode,le,null),V.return=X,V;if(typeof V.then=="function")return ye(X,Pc(V),le);if(V.$$typeof===E)return ye(X,Uc(X,V),le);Fc(X,V)}return null}function ce(X,V,le,be){var Je=V!==null?V.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Je!==null?null:k(X,V,""+le,be);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case N:return le.key===Je?I(X,V,le,be):null;case w:return le.key===Je?ne(X,V,le,be):null;case J:return le=On(le),ce(X,V,le,be)}if(ge(le)||je(le))return Je!==null?null:ve(X,V,le,be,null);if(typeof le.then=="function")return ce(X,V,Pc(le),be);if(le.$$typeof===E)return ce(X,V,Uc(X,le),be);Fc(X,le)}return null}function xe(X,V,le,be,Je){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return X=X.get(le)||null,k(V,X,""+be,Je);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case N:return X=X.get(be.key===null?le:be.key)||null,I(V,X,be,Je);case w:return X=X.get(be.key===null?le:be.key)||null,ne(V,X,be,Je);case J:return be=On(be),xe(X,V,le,be,Je)}if(ge(be)||je(be))return X=X.get(le)||null,ve(V,X,be,Je,null);if(typeof be.then=="function")return xe(X,V,le,Pc(be),Je);if(be.$$typeof===E)return xe(X,V,le,Uc(V,be),Je);Fc(V,be)}return null}function Ve(X,V,le,be){for(var Je=null,Is=null,Ke=V,js=V=0,Ms=null;Ke!==null&&js<le.length;js++){Ke.index>js?(Ms=Ke,Ke=null):Ms=Ke.sibling;var Ps=ce(X,Ke,le[js],be);if(Ps===null){Ke===null&&(Ke=Ms);break}s&&Ke&&Ps.alternate===null&&t(X,Ke),V=x(Ps,V,js),Is===null?Je=Ps:Is.sibling=Ps,Is=Ps,Ke=Ms}if(js===le.length)return n(X,Ke),zs&&jl(X,js),Je;if(Ke===null){for(;js<le.length;js++)Ke=ye(X,le[js],be),Ke!==null&&(V=x(Ke,V,js),Is===null?Je=Ke:Is.sibling=Ke,Is=Ke);return zs&&jl(X,js),Je}for(Ke=i(Ke);js<le.length;js++)Ms=xe(Ke,X,js,le[js],be),Ms!==null&&(s&&Ms.alternate!==null&&Ke.delete(Ms.key===null?js:Ms.key),V=x(Ms,V,js),Is===null?Je=Ms:Is.sibling=Ms,Is=Ms);return s&&Ke.forEach(function(un){return t(X,un)}),zs&&jl(X,js),Je}function es(X,V,le,be){if(le==null)throw Error(c(151));for(var Je=null,Is=null,Ke=V,js=V=0,Ms=null,Ps=le.next();Ke!==null&&!Ps.done;js++,Ps=le.next()){Ke.index>js?(Ms=Ke,Ke=null):Ms=Ke.sibling;var un=ce(X,Ke,Ps.value,be);if(un===null){Ke===null&&(Ke=Ms);break}s&&Ke&&un.alternate===null&&t(X,Ke),V=x(un,V,js),Is===null?Je=un:Is.sibling=un,Is=un,Ke=Ms}if(Ps.done)return n(X,Ke),zs&&jl(X,js),Je;if(Ke===null){for(;!Ps.done;js++,Ps=le.next())Ps=ye(X,Ps.value,be),Ps!==null&&(V=x(Ps,V,js),Is===null?Je=Ps:Is.sibling=Ps,Is=Ps);return zs&&jl(X,js),Je}for(Ke=i(Ke);!Ps.done;js++,Ps=le.next())Ps=xe(Ke,X,js,Ps.value,be),Ps!==null&&(s&&Ps.alternate!==null&&Ke.delete(Ps.key===null?js:Ps.key),V=x(Ps,V,js),Is===null?Je=Ps:Is.sibling=Ps,Is=Ps);return s&&Ke.forEach(function(K0){return t(X,K0)}),zs&&jl(X,js),Je}function tt(X,V,le,be){if(typeof le=="object"&&le!==null&&le.type===M&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case N:e:{for(var Je=le.key;V!==null;){if(V.key===Je){if(Je=le.type,Je===M){if(V.tag===7){n(X,V.sibling),be=o(V,le.props.children),be.return=X,X=be;break e}}else if(V.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===J&&On(Je)===V.type){n(X,V.sibling),be=o(V,le.props),ji(be,le),be.return=X,X=be;break e}n(X,V);break}else t(X,V);V=V.sibling}le.type===M?(be=Mn(le.props.children,X.mode,be,le.key),be.return=X,X=be):(be=Dc(le.type,le.key,le.props,null,X.mode,be),ji(be,le),be.return=X,X=be)}return v(X);case w:e:{for(Je=le.key;V!==null;){if(V.key===Je)if(V.tag===4&&V.stateNode.containerInfo===le.containerInfo&&V.stateNode.implementation===le.implementation){n(X,V.sibling),be=o(V,le.children||[]),be.return=X,X=be;break e}else{n(X,V);break}else t(X,V);V=V.sibling}be=qd(le,X.mode,be),be.return=X,X=be}return v(X);case J:return le=On(le),tt(X,V,le,be)}if(ge(le))return Ve(X,V,le,be);if(je(le)){if(Je=je(le),typeof Je!="function")throw Error(c(150));return le=Je.call(le),es(X,V,le,be)}if(typeof le.then=="function")return tt(X,V,Pc(le),be);if(le.$$typeof===E)return tt(X,V,Uc(X,le),be);Fc(X,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,V!==null&&V.tag===6?(n(X,V.sibling),be=o(V,le),be.return=X,X=be):(n(X,V),be=Gd(le,X.mode,be),be.return=X,X=be),v(X)):n(X,V)}return function(X,V,le,be){try{gi=0;var Je=tt(X,V,le,be);return wr=null,Je}catch(Ke){if(Ke===yr||Ke===Bc)throw Ke;var Is=ba(29,Ke,null,X.mode);return Is.lanes=be,Is.return=X,Is}finally{}}}var Un=Lh(!0),Uh=Lh(!1),Kl=!1;function lu(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nu(s,t){s=s.updateQueue,t.updateQueue===s&&(t.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ql(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Yl(s,t,n){var i=s.updateQueue;if(i===null)return null;if(i=i.shared,(Hs&2)!==0){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,t=Rc(s),Nh(s,null,n),t}return zc(s,i,t,n),Rc(s)}function vi(s,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=s.pendingLanes,n|=i,t.lanes=n,ta(s,n)}}function ru(s,t){var n=s.updateQueue,i=s.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,x=null;if(n=n.firstBaseUpdate,n!==null){do{var v={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};x===null?o=x=v:x=x.next=v,n=n.next}while(n!==null);x===null?o=x=t:x=x.next=t}else o=x=t;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:x,shared:i.shared,callbacks:i.callbacks},s.updateQueue=n;return}s=n.lastBaseUpdate,s===null?n.firstBaseUpdate=t:s.next=t,n.lastBaseUpdate=t}var iu=!1;function Ni(){if(iu){var s=br;if(s!==null)throw s}}function bi(s,t,n,i){iu=!1;var o=s.updateQueue;Kl=!1;var x=o.firstBaseUpdate,v=o.lastBaseUpdate,k=o.shared.pending;if(k!==null){o.shared.pending=null;var I=k,ne=I.next;I.next=null,v===null?x=ne:v.next=ne,v=I;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,k=ve.lastBaseUpdate,k!==v&&(k===null?ve.firstBaseUpdate=ne:k.next=ne,ve.lastBaseUpdate=I))}if(x!==null){var ye=o.baseState;v=0,ve=ne=I=null,k=x;do{var ce=k.lane&-536870913,xe=ce!==k.lane;if(xe?(Es&ce)===ce:(i&ce)===ce){ce!==0&&ce===Nr&&(iu=!0),ve!==null&&(ve=ve.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Ve=s,es=k;ce=t;var tt=n;switch(es.tag){case 1:if(Ve=es.payload,typeof Ve=="function"){ye=Ve.call(tt,ye,ce);break e}ye=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=es.payload,ce=typeof Ve=="function"?Ve.call(tt,ye,ce):Ve,ce==null)break e;ye=j({},ye,ce);break e;case 2:Kl=!0}}ce=k.callback,ce!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=o.callbacks,xe===null?o.callbacks=[ce]:xe.push(ce))}else xe={lane:ce,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ve===null?(ne=ve=xe,I=ye):ve=ve.next=xe,v|=ce;if(k=k.next,k===null){if(k=o.shared.pending,k===null)break;xe=k,k=xe.next,xe.next=null,o.lastBaseUpdate=xe,o.shared.pending=null}}while(!0);ve===null&&(I=ye),o.baseState=I,o.firstBaseUpdate=ne,o.lastBaseUpdate=ve,x===null&&(o.shared.lanes=0),en|=v,s.lanes=v,s.memoizedState=ye}}function $h(s,t){if(typeof s!="function")throw Error(c(191,s));s.call(t)}function Bh(s,t){var n=s.callbacks;if(n!==null)for(s.callbacks=null,s=0;s<n.length;s++)$h(n[s],t)}var _r=Se(null),Hc=Se(0);function Ih(s,t){s=El,Te(Hc,s),Te(_r,t),El=s|t.baseLanes}function cu(){Te(Hc,El),Te(_r,_r.current)}function ou(){El=Hc.current,fe(_r),fe(Hc)}var ya=Se(null),Ha=null;function Jl(s){var t=s.alternate;Te(Tt,Tt.current&1),Te(ya,s),Ha===null&&(t===null||_r.current!==null||t.memoizedState!==null)&&(Ha=s)}function du(s){Te(Tt,Tt.current),Te(ya,s),Ha===null&&(Ha=s)}function Ph(s){s.tag===22?(Te(Tt,Tt.current),Te(ya,s),Ha===null&&(Ha=s)):Xl()}function Xl(){Te(Tt,Tt.current),Te(ya,ya.current)}function wa(s){fe(ya),Ha===s&&(Ha=null),fe(Tt)}var Tt=Se(0);function Vc(s){for(var t=s;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||pm(n)||gm(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var bl=0,ps=null,et=null,Dt=null,Gc=!1,Sr=!1,$n=!1,qc=0,yi=0,kr=null,Uy=0;function wt(){throw Error(c(321))}function uu(s,t){if(t===null)return!1;for(var n=0;n<t.length&&n<s.length;n++)if(!Na(s[n],t[n]))return!1;return!0}function mu(s,t,n,i,o,x){return bl=x,ps=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,R.H=s===null||s.memoizedState===null?Sf:Cu,$n=!1,x=n(i,o),$n=!1,Sr&&(x=Hh(t,n,i,o)),Fh(s),x}function Fh(s){R.H=Si;var t=et!==null&&et.next!==null;if(bl=0,Dt=et=ps=null,Gc=!1,yi=0,kr=null,t)throw Error(c(300));s===null||Ot||(s=s.dependencies,s!==null&&Lc(s)&&(Ot=!0))}function Hh(s,t,n,i){ps=s;var o=0;do{if(Sr&&(kr=null),yi=0,Sr=!1,25<=o)throw Error(c(301));if(o+=1,Dt=et=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}R.H=kf,x=t(n,i)}while(Sr);return x}function $y(){var s=R.H,t=s.useState()[0];return t=typeof t.then=="function"?wi(t):t,s=s.useState()[0],(et!==null?et.memoizedState:null)!==s&&(ps.flags|=1024),t}function xu(){var s=qc!==0;return qc=0,s}function hu(s,t,n){t.updateQueue=s.updateQueue,t.flags&=-2053,s.lanes&=~n}function fu(s){if(Gc){for(s=s.memoizedState;s!==null;){var t=s.queue;t!==null&&(t.pending=null),s=s.next}Gc=!1}bl=0,Dt=et=ps=null,Sr=!1,yi=qc=0,kr=null}function la(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?ps.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function Et(){if(et===null){var s=ps.alternate;s=s!==null?s.memoizedState:null}else s=et.next;var t=Dt===null?ps.memoizedState:Dt.next;if(t!==null)Dt=t,et=s;else{if(s===null)throw ps.alternate===null?Error(c(467)):Error(c(310));et=s,s={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},Dt===null?ps.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function Kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wi(s){var t=yi;return yi+=1,kr===null&&(kr=[]),s=Rh(kr,s,t),t=ps,(Dt===null?t.memoizedState:Dt.next)===null&&(t=t.alternate,R.H=t===null||t.memoizedState===null?Sf:Cu),s}function Qc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return wi(s);if(s.$$typeof===E)return Qt(s)}throw Error(c(438,String(s)))}function pu(s){var t=null,n=ps.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=ps.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Kc(),ps.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(s),i=0;i<s;i++)n[i]=oe;return t.index++,n}function yl(s,t){return typeof t=="function"?t(s):t}function Yc(s){var t=Et();return gu(t,et,s)}function gu(s,t,n){var i=s.queue;if(i===null)throw Error(c(311));i.lastRenderedReducer=n;var o=s.baseQueue,x=i.pending;if(x!==null){if(o!==null){var v=o.next;o.next=x.next,x.next=v}t.baseQueue=o=x,i.pending=null}if(x=s.baseState,o===null)s.memoizedState=x;else{t=o.next;var k=v=null,I=null,ne=t,ve=!1;do{var ye=ne.lane&-536870913;if(ye!==ne.lane?(Es&ye)===ye:(bl&ye)===ye){var ce=ne.revertLane;if(ce===0)I!==null&&(I=I.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ye===Nr&&(ve=!0);else if((bl&ce)===ce){ne=ne.next,ce===Nr&&(ve=!0);continue}else ye={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},I===null?(k=I=ye,v=x):I=I.next=ye,ps.lanes|=ce,en|=ce;ye=ne.action,$n&&n(x,ye),x=ne.hasEagerState?ne.eagerState:n(x,ye)}else ce={lane:ye,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},I===null?(k=I=ce,v=x):I=I.next=ce,ps.lanes|=ye,en|=ye;ne=ne.next}while(ne!==null&&ne!==t);if(I===null?v=x:I.next=k,!Na(x,s.memoizedState)&&(Ot=!0,ve&&(n=br,n!==null)))throw n;s.memoizedState=x,s.baseState=v,s.baseQueue=I,i.lastRenderedState=x}return o===null&&(i.lanes=0),[s.memoizedState,i.dispatch]}function ju(s){var t=Et(),n=t.queue;if(n===null)throw Error(c(311));n.lastRenderedReducer=s;var i=n.dispatch,o=n.pending,x=t.memoizedState;if(o!==null){n.pending=null;var v=o=o.next;do x=s(x,v.action),v=v.next;while(v!==o);Na(x,t.memoizedState)||(Ot=!0),t.memoizedState=x,t.baseQueue===null&&(t.baseState=x),n.lastRenderedState=x}return[x,i]}function Vh(s,t,n){var i=ps,o=Et(),x=zs;if(x){if(n===void 0)throw Error(c(407));n=n()}else n=t();var v=!Na((et||o).memoizedState,n);if(v&&(o.memoizedState=n,Ot=!0),o=o.queue,bu(Kh.bind(null,i,o,s),[s]),o.getSnapshot!==t||v||Dt!==null&&Dt.memoizedState.tag&1){if(i.flags|=2048,Cr(9,{destroy:void 0},qh.bind(null,i,o,n,t),null),lt===null)throw Error(c(349));x||(bl&127)!==0||Gh(i,t,n)}return n}function Gh(s,t,n){s.flags|=16384,s={getSnapshot:t,value:n},t=ps.updateQueue,t===null?(t=Kc(),ps.updateQueue=t,t.stores=[s]):(n=t.stores,n===null?t.stores=[s]:n.push(s))}function qh(s,t,n,i){t.value=n,t.getSnapshot=i,Qh(t)&&Yh(s)}function Kh(s,t,n){return n(function(){Qh(t)&&Yh(s)})}function Qh(s){var t=s.getSnapshot;s=s.value;try{var n=t();return!Na(s,n)}catch{return!0}}function Yh(s){var t=En(s,2);t!==null&&fa(t,s,2)}function vu(s){var t=la();if(typeof s=="function"){var n=s;if(s=n(),$n){ts(!0);try{n()}finally{ts(!1)}}}return t.memoizedState=t.baseState=s,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:s},t}function Jh(s,t,n,i){return s.baseState=n,gu(s,et,typeof i=="function"?i:yl)}function By(s,t,n,i,o){if(Zc(s))throw Error(c(485));if(s=t.action,s!==null){var x={payload:o,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){x.listeners.push(v)}};R.T!==null?n(!0):x.isTransition=!1,i(x),n=t.pending,n===null?(x.next=t.pending=x,Xh(t,x)):(x.next=n.next,t.pending=n.next=x)}}function Xh(s,t){var n=t.action,i=t.payload,o=s.state;if(t.isTransition){var x=R.T,v={};R.T=v;try{var k=n(o,i),I=R.S;I!==null&&I(v,k),Zh(s,t,k)}catch(ne){Nu(s,t,ne)}finally{x!==null&&v.types!==null&&(x.types=v.types),R.T=x}}else try{x=n(o,i),Zh(s,t,x)}catch(ne){Nu(s,t,ne)}}function Zh(s,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Wh(s,t,i)},function(i){return Nu(s,t,i)}):Wh(s,t,n)}function Wh(s,t,n){t.status="fulfilled",t.value=n,ef(t),s.state=n,t=s.pending,t!==null&&(n=t.next,n===t?s.pending=null:(n=n.next,t.next=n,Xh(s,n)))}function Nu(s,t,n){var i=s.pending;if(s.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,ef(t),t=t.next;while(t!==i)}s.action=null}function ef(s){s=s.listeners;for(var t=0;t<s.length;t++)(0,s[t])()}function sf(s,t){return t}function tf(s,t){if(zs){var n=lt.formState;if(n!==null){e:{var i=ps;if(zs){if(ut){s:{for(var o=ut,x=Fa;o.nodeType!==8;){if(!x){o=null;break s}if(o=Va(o.nextSibling),o===null){o=null;break s}}x=o.data,o=x==="F!"||x==="F"?o:null}if(o){ut=Va(o.nextSibling),i=o.data==="F!";break e}}Gl(i)}i=!1}i&&(t=n[0])}}return n=la(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sf,lastRenderedState:t},n.queue=i,n=yf.bind(null,ps,i),i.dispatch=n,i=vu(!1),x=ku.bind(null,ps,!1,i.queue),i=la(),o={state:t,dispatch:null,action:s,pending:null},i.queue=o,n=By.bind(null,ps,o,x,n),o.dispatch=n,i.memoizedState=s,[t,n,!1]}function af(s){var t=Et();return lf(t,et,s)}function lf(s,t,n){if(t=gu(s,t,sf)[0],s=Yc(yl)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=wi(t)}catch(v){throw v===yr?Bc:v}else i=t;t=Et();var o=t.queue,x=o.dispatch;return n!==t.memoizedState&&(ps.flags|=2048,Cr(9,{destroy:void 0},Iy.bind(null,o,n),null)),[i,x,s]}function Iy(s,t){s.action=t}function nf(s){var t=Et(),n=et;if(n!==null)return lf(t,n,s);Et(),t=t.memoizedState,n=Et();var i=n.queue.dispatch;return n.memoizedState=s,[t,i,!1]}function Cr(s,t,n,i){return s={tag:s,create:n,deps:i,inst:t,next:null},t=ps.updateQueue,t===null&&(t=Kc(),ps.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=s.next=s:(i=n.next,n.next=s,s.next=i,t.lastEffect=s),s}function rf(){return Et().memoizedState}function Jc(s,t,n,i){var o=la();ps.flags|=s,o.memoizedState=Cr(1|t,{destroy:void 0},n,i===void 0?null:i)}function Xc(s,t,n,i){var o=Et();i=i===void 0?null:i;var x=o.memoizedState.inst;et!==null&&i!==null&&uu(i,et.memoizedState.deps)?o.memoizedState=Cr(t,x,n,i):(ps.flags|=s,o.memoizedState=Cr(1|t,x,n,i))}function cf(s,t){Jc(8390656,8,s,t)}function bu(s,t){Xc(2048,8,s,t)}function Py(s){ps.flags|=4;var t=ps.updateQueue;if(t===null)t=Kc(),ps.updateQueue=t,t.events=[s];else{var n=t.events;n===null?t.events=[s]:n.push(s)}}function of(s){var t=Et().memoizedState;return Py({ref:t,nextImpl:s}),function(){if((Hs&2)!==0)throw Error(c(440));return t.impl.apply(void 0,arguments)}}function df(s,t){return Xc(4,2,s,t)}function uf(s,t){return Xc(4,4,s,t)}function mf(s,t){if(typeof t=="function"){s=s();var n=t(s);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return s=s(),t.current=s,function(){t.current=null}}function xf(s,t,n){n=n!=null?n.concat([s]):null,Xc(4,4,mf.bind(null,t,s),n)}function yu(){}function hf(s,t){var n=Et();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&uu(t,i[1])?i[0]:(n.memoizedState=[s,t],s)}function ff(s,t){var n=Et();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&uu(t,i[1]))return i[0];if(i=s(),$n){ts(!0);try{s()}finally{ts(!1)}}return n.memoizedState=[i,t],i}function wu(s,t,n){return n===void 0||(bl&1073741824)!==0&&(Es&261930)===0?s.memoizedState=t:(s.memoizedState=n,s=pp(),ps.lanes|=s,en|=s,n)}function pf(s,t,n,i){return Na(n,t)?n:_r.current!==null?(s=wu(s,n,i),Na(s,t)||(Ot=!0),s):(bl&42)===0||(bl&1073741824)!==0&&(Es&261930)===0?(Ot=!0,s.memoizedState=n):(s=pp(),ps.lanes|=s,en|=s,t)}function gf(s,t,n,i,o){var x=Q.p;Q.p=x!==0&&8>x?x:8;var v=R.T,k={};R.T=k,ku(s,!1,t,n);try{var I=o(),ne=R.S;if(ne!==null&&ne(k,I),I!==null&&typeof I=="object"&&typeof I.then=="function"){var ve=Ly(I,i);_i(s,t,ve,ka(s))}else _i(s,t,i,ka(s))}catch(ye){_i(s,t,{then:function(){},status:"rejected",reason:ye},ka())}finally{Q.p=x,v!==null&&k.types!==null&&(v.types=k.types),R.T=v}}function Fy(){}function _u(s,t,n,i){if(s.tag!==5)throw Error(c(476));var o=jf(s).queue;gf(s,o,t,$,n===null?Fy:function(){return vf(s),n(i)})}function jf(s){var t=s.memoizedState;if(t!==null)return t;t={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:$},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:n},next:null},s.memoizedState=t,s=s.alternate,s!==null&&(s.memoizedState=t),t}function vf(s){var t=jf(s);t.next===null&&(t=s.alternate.memoizedState),_i(s,t.next.queue,{},ka())}function Su(){return Qt(Pi)}function Nf(){return Et().memoizedState}function bf(){return Et().memoizedState}function Hy(s){for(var t=s.return;t!==null;){switch(t.tag){case 24:case 3:var n=ka();s=Ql(n);var i=Yl(t,s,n);i!==null&&(fa(i,t,n),vi(i,t,n)),t={cache:eu()},s.payload=t;return}t=t.return}}function Vy(s,t,n){var i=ka();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Zc(s)?wf(t,n):(n=Hd(s,t,n,i),n!==null&&(fa(n,s,i),_f(n,t,i)))}function yf(s,t,n){var i=ka();_i(s,t,n,i)}function _i(s,t,n,i){var o={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zc(s))wf(t,o);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=t.lastRenderedReducer,x!==null))try{var v=t.lastRenderedState,k=x(v,n);if(o.hasEagerState=!0,o.eagerState=k,Na(k,v))return zc(s,t,o,0),lt===null&&Ac(),!1}catch{}finally{}if(n=Hd(s,t,o,i),n!==null)return fa(n,s,i),_f(n,t,i),!0}return!1}function ku(s,t,n,i){if(i={lane:2,revertLane:lm(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Zc(s)){if(t)throw Error(c(479))}else t=Hd(s,n,i,2),t!==null&&fa(t,s,2)}function Zc(s){var t=s.alternate;return s===ps||t!==null&&t===ps}function wf(s,t){Sr=Gc=!0;var n=s.pending;n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t}function _f(s,t,n){if((n&4194048)!==0){var i=t.lanes;i&=s.pendingLanes,n|=i,t.lanes=n,ta(s,n)}}var Si={readContext:Qt,use:Qc,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt};Si.useEffectEvent=wt;var Sf={readContext:Qt,use:Qc,useCallback:function(s,t){return la().memoizedState=[s,t===void 0?null:t],s},useContext:Qt,useEffect:cf,useImperativeHandle:function(s,t,n){n=n!=null?n.concat([s]):null,Jc(4194308,4,mf.bind(null,t,s),n)},useLayoutEffect:function(s,t){return Jc(4194308,4,s,t)},useInsertionEffect:function(s,t){Jc(4,2,s,t)},useMemo:function(s,t){var n=la();t=t===void 0?null:t;var i=s();if($n){ts(!0);try{s()}finally{ts(!1)}}return n.memoizedState=[i,t],i},useReducer:function(s,t,n){var i=la();if(n!==void 0){var o=n(t);if($n){ts(!0);try{n(t)}finally{ts(!1)}}}else o=t;return i.memoizedState=i.baseState=o,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},i.queue=s,s=s.dispatch=Vy.bind(null,ps,s),[i.memoizedState,s]},useRef:function(s){var t=la();return s={current:s},t.memoizedState=s},useState:function(s){s=vu(s);var t=s.queue,n=yf.bind(null,ps,t);return t.dispatch=n,[s.memoizedState,n]},useDebugValue:yu,useDeferredValue:function(s,t){var n=la();return wu(n,s,t)},useTransition:function(){var s=vu(!1);return s=gf.bind(null,ps,s.queue,!0,!1),la().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,t,n){var i=ps,o=la();if(zs){if(n===void 0)throw Error(c(407));n=n()}else{if(n=t(),lt===null)throw Error(c(349));(Es&127)!==0||Gh(i,t,n)}o.memoizedState=n;var x={value:n,getSnapshot:t};return o.queue=x,cf(Kh.bind(null,i,x,s),[s]),i.flags|=2048,Cr(9,{destroy:void 0},qh.bind(null,i,x,n,t),null),n},useId:function(){var s=la(),t=lt.identifierPrefix;if(zs){var n=rl,i=nl;n=(i&~(1<<32-Ns(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=qc++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Uy++,t="_"+t+"r_"+n.toString(32)+"_";return s.memoizedState=t},useHostTransitionStatus:Su,useFormState:tf,useActionState:tf,useOptimistic:function(s){var t=la();t.memoizedState=t.baseState=s;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ku.bind(null,ps,!0,n),n.dispatch=t,[s,t]},useMemoCache:pu,useCacheRefresh:function(){return la().memoizedState=Hy.bind(null,ps)},useEffectEvent:function(s){var t=la(),n={impl:s};return t.memoizedState=n,function(){if((Hs&2)!==0)throw Error(c(440));return n.impl.apply(void 0,arguments)}}},Cu={readContext:Qt,use:Qc,useCallback:hf,useContext:Qt,useEffect:bu,useImperativeHandle:xf,useInsertionEffect:df,useLayoutEffect:uf,useMemo:ff,useReducer:Yc,useRef:rf,useState:function(){return Yc(yl)},useDebugValue:yu,useDeferredValue:function(s,t){var n=Et();return pf(n,et.memoizedState,s,t)},useTransition:function(){var s=Yc(yl)[0],t=Et().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Vh,useId:Nf,useHostTransitionStatus:Su,useFormState:af,useActionState:af,useOptimistic:function(s,t){var n=Et();return Jh(n,et,s,t)},useMemoCache:pu,useCacheRefresh:bf};Cu.useEffectEvent=of;var kf={readContext:Qt,use:Qc,useCallback:hf,useContext:Qt,useEffect:bu,useImperativeHandle:xf,useInsertionEffect:df,useLayoutEffect:uf,useMemo:ff,useReducer:ju,useRef:rf,useState:function(){return ju(yl)},useDebugValue:yu,useDeferredValue:function(s,t){var n=Et();return et===null?wu(n,s,t):pf(n,et.memoizedState,s,t)},useTransition:function(){var s=ju(yl)[0],t=Et().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Vh,useId:Nf,useHostTransitionStatus:Su,useFormState:nf,useActionState:nf,useOptimistic:function(s,t){var n=Et();return et!==null?Jh(n,et,s,t):(n.baseState=s,[s,n.queue.dispatch])},useMemoCache:pu,useCacheRefresh:bf};kf.useEffectEvent=of;function Tu(s,t,n,i){t=s.memoizedState,n=n(i,t),n=n==null?t:j({},t,n),s.memoizedState=n,s.lanes===0&&(s.updateQueue.baseState=n)}var Eu={enqueueSetState:function(s,t,n){s=s._reactInternals;var i=ka(),o=Ql(i);o.payload=t,n!=null&&(o.callback=n),t=Yl(s,o,i),t!==null&&(fa(t,s,i),vi(t,s,i))},enqueueReplaceState:function(s,t,n){s=s._reactInternals;var i=ka(),o=Ql(i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Yl(s,o,i),t!==null&&(fa(t,s,i),vi(t,s,i))},enqueueForceUpdate:function(s,t){s=s._reactInternals;var n=ka(),i=Ql(n);i.tag=2,t!=null&&(i.callback=t),t=Yl(s,i,n),t!==null&&(fa(t,s,n),vi(t,s,n))}};function Cf(s,t,n,i,o,x,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(i,x,v):t.prototype&&t.prototype.isPureReactComponent?!ui(n,i)||!ui(o,x):!0}function Tf(s,t,n,i){s=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==s&&Eu.enqueueReplaceState(t,t.state,null)}function Bn(s,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(s=s.defaultProps){n===t&&(n=j({},n));for(var o in s)n[o]===void 0&&(n[o]=s[o])}return n}function Ef(s){Mc(s)}function Mf(s){console.error(s)}function Af(s){Mc(s)}function Wc(s,t){try{var n=s.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function zf(s,t,n){try{var i=s.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function Mu(s,t,n){return n=Ql(n),n.tag=3,n.payload={element:null},n.callback=function(){Wc(s,t)},n}function Rf(s){return s=Ql(s),s.tag=3,s}function Df(s,t,n,i){var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var x=i.value;s.payload=function(){return o(x)},s.callback=function(){zf(t,n,i)}}var v=n.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){zf(t,n,i),typeof o!="function"&&(sn===null?sn=new Set([this]):sn.add(this));var k=i.stack;this.componentDidCatch(i.value,{componentStack:k!==null?k:""})})}function Gy(s,t,n,i,o){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&vr(t,n,o,!0),n=ya.current,n!==null){switch(n.tag){case 31:case 13:return Ha===null?mo():n.alternate===null&&_t===0&&(_t=3),n.flags&=-257,n.flags|=65536,n.lanes=o,i===Ic?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),sm(s,i,o)),!1;case 22:return n.flags|=65536,i===Ic?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),sm(s,i,o)),!1}throw Error(c(435,n.tag))}return sm(s,i,o),mo(),!1}if(zs)return t=ya.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,i!==Yd&&(s=Error(c(422),{cause:i}),hi(Ba(s,n)))):(i!==Yd&&(t=Error(c(423),{cause:i}),hi(Ba(t,n))),s=s.current.alternate,s.flags|=65536,o&=-o,s.lanes|=o,i=Ba(i,n),o=Mu(s.stateNode,i,o),ru(s,o),_t!==4&&(_t=2)),!1;var x=Error(c(520),{cause:i});if(x=Ba(x,n),Ri===null?Ri=[x]:Ri.push(x),_t!==4&&(_t=2),t===null)return!0;i=Ba(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,s=o&-o,n.lanes|=s,s=Mu(n.stateNode,i,s),ru(n,s),!1;case 1:if(t=n.type,x=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(sn===null||!sn.has(x))))return n.flags|=65536,o&=-o,n.lanes|=o,o=Rf(o),Df(o,s,n,i),ru(n,o),!1}n=n.return}while(n!==null);return!1}var Au=Error(c(461)),Ot=!1;function Yt(s,t,n,i){t.child=s===null?Uh(t,null,n,i):Un(t,s.child,n,i)}function Of(s,t,n,i,o){n=n.render;var x=t.ref;if("ref"in i){var v={};for(var k in i)k!=="ref"&&(v[k]=i[k])}else v=i;return Rn(t),i=mu(s,t,n,v,x,o),k=xu(),s!==null&&!Ot?(hu(s,t,o),wl(s,t,o)):(zs&&k&&Kd(t),t.flags|=1,Yt(s,t,i,o),t.child)}function Lf(s,t,n,i,o){if(s===null){var x=n.type;return typeof x=="function"&&!Vd(x)&&x.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=x,Uf(s,t,x,i,o)):(s=Dc(n.type,null,i,t,t.mode,o),s.ref=t.ref,s.return=t,t.child=s)}if(x=s.child,!Bu(s,o)){var v=x.memoizedProps;if(n=n.compare,n=n!==null?n:ui,n(v,i)&&s.ref===t.ref)return wl(s,t,o)}return t.flags|=1,s=gl(x,i),s.ref=t.ref,s.return=t,t.child=s}function Uf(s,t,n,i,o){if(s!==null){var x=s.memoizedProps;if(ui(x,i)&&s.ref===t.ref)if(Ot=!1,t.pendingProps=i=x,Bu(s,o))(s.flags&131072)!==0&&(Ot=!0);else return t.lanes=s.lanes,wl(s,t,o)}return zu(s,t,n,i,o)}function $f(s,t,n,i){var o=i.children,x=s!==null?s.memoizedState:null;if(s===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(x=x!==null?x.baseLanes|n:n,s!==null){for(i=t.child=s.child,o=0;i!==null;)o=o|i.lanes|i.childLanes,i=i.sibling;i=o&~x}else i=0,t.child=null;return Bf(s,t,x,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},s!==null&&$c(t,x!==null?x.cachePool:null),x!==null?Ih(t,x):cu(),Ph(t);else return i=t.lanes=536870912,Bf(s,t,x!==null?x.baseLanes|n:n,n,i)}else x!==null?($c(t,x.cachePool),Ih(t,x),Xl(),t.memoizedState=null):(s!==null&&$c(t,null),cu(),Xl());return Yt(s,t,o,n),t.child}function ki(s,t){return s!==null&&s.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bf(s,t,n,i,o){var x=tu();return x=x===null?null:{parent:Rt._currentValue,pool:x},t.memoizedState={baseLanes:n,cachePool:x},s!==null&&$c(t,null),cu(),Ph(t),s!==null&&vr(s,t,i,!0),t.childLanes=o,null}function eo(s,t){return t=to({mode:t.mode,children:t.children},s.mode),t.ref=s.ref,s.child=t,t.return=s,t}function If(s,t,n){return Un(t,s.child,null,n),s=eo(t,t.pendingProps),s.flags|=2,wa(t),t.memoizedState=null,s}function qy(s,t,n){var i=t.pendingProps,o=(t.flags&128)!==0;if(t.flags&=-129,s===null){if(zs){if(i.mode==="hidden")return s=eo(t,i),t.lanes=536870912,ki(null,s);if(du(t),(s=ut)?(s=Zp(s,Fa),s=s!==null&&s.data==="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Hl!==null?{id:nl,overflow:rl}:null,retryLane:536870912,hydrationErrors:null},n=yh(s),n.return=t,t.child=n,Kt=t,ut=null)):s=null,s===null)throw Gl(t);return t.lanes=536870912,null}return eo(t,i)}var x=s.memoizedState;if(x!==null){var v=x.dehydrated;if(du(t),o)if(t.flags&256)t.flags&=-257,t=If(s,t,n);else if(t.memoizedState!==null)t.child=s.child,t.flags|=128,t=null;else throw Error(c(558));else if(Ot||vr(s,t,n,!1),o=(n&s.childLanes)!==0,Ot||o){if(i=lt,i!==null&&(v=dt(i,n),v!==0&&v!==x.retryLane))throw x.retryLane=v,En(s,v),fa(i,s,v),Au;mo(),t=If(s,t,n)}else s=x.treeContext,ut=Va(v.nextSibling),Kt=t,zs=!0,Vl=null,Fa=!1,s!==null&&Sh(t,s),t=eo(t,i),t.flags|=4096;return t}return s=gl(s.child,{mode:i.mode,children:i.children}),s.ref=t.ref,t.child=s,s.return=t,s}function so(s,t){var n=t.ref;if(n===null)s!==null&&s.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(c(284));(s===null||s.ref!==n)&&(t.flags|=4194816)}}function zu(s,t,n,i,o){return Rn(t),n=mu(s,t,n,i,void 0,o),i=xu(),s!==null&&!Ot?(hu(s,t,o),wl(s,t,o)):(zs&&i&&Kd(t),t.flags|=1,Yt(s,t,n,o),t.child)}function Pf(s,t,n,i,o,x){return Rn(t),t.updateQueue=null,n=Hh(t,i,n,o),Fh(s),i=xu(),s!==null&&!Ot?(hu(s,t,x),wl(s,t,x)):(zs&&i&&Kd(t),t.flags|=1,Yt(s,t,n,x),t.child)}function Ff(s,t,n,i,o){if(Rn(t),t.stateNode===null){var x=fr,v=n.contextType;typeof v=="object"&&v!==null&&(x=Qt(v)),x=new n(i,x),t.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Eu,t.stateNode=x,x._reactInternals=t,x=t.stateNode,x.props=i,x.state=t.memoizedState,x.refs={},lu(t),v=n.contextType,x.context=typeof v=="object"&&v!==null?Qt(v):fr,x.state=t.memoizedState,v=n.getDerivedStateFromProps,typeof v=="function"&&(Tu(t,n,v,i),x.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(v=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),v!==x.state&&Eu.enqueueReplaceState(x,x.state,null),bi(t,i,x,o),Ni(),x.state=t.memoizedState),typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(s===null){x=t.stateNode;var k=t.memoizedProps,I=Bn(n,k);x.props=I;var ne=x.context,ve=n.contextType;v=fr,typeof ve=="object"&&ve!==null&&(v=Qt(ve));var ye=n.getDerivedStateFromProps;ve=typeof ye=="function"||typeof x.getSnapshotBeforeUpdate=="function",k=t.pendingProps!==k,ve||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(k||ne!==v)&&Tf(t,x,i,v),Kl=!1;var ce=t.memoizedState;x.state=ce,bi(t,i,x,o),Ni(),ne=t.memoizedState,k||ce!==ne||Kl?(typeof ye=="function"&&(Tu(t,n,ye,i),ne=t.memoizedState),(I=Kl||Cf(t,n,I,i,ce,ne,v))?(ve||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=ne),x.props=i,x.state=ne,x.context=v,i=I):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{x=t.stateNode,nu(s,t),v=t.memoizedProps,ve=Bn(n,v),x.props=ve,ye=t.pendingProps,ce=x.context,ne=n.contextType,I=fr,typeof ne=="object"&&ne!==null&&(I=Qt(ne)),k=n.getDerivedStateFromProps,(ne=typeof k=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(v!==ye||ce!==I)&&Tf(t,x,i,I),Kl=!1,ce=t.memoizedState,x.state=ce,bi(t,i,x,o),Ni();var xe=t.memoizedState;v!==ye||ce!==xe||Kl||s!==null&&s.dependencies!==null&&Lc(s.dependencies)?(typeof k=="function"&&(Tu(t,n,k,i),xe=t.memoizedState),(ve=Kl||Cf(t,n,ve,i,ce,xe,I)||s!==null&&s.dependencies!==null&&Lc(s.dependencies))?(ne||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(i,xe,I),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(i,xe,I)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||v===s.memoizedProps&&ce===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&ce===s.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=xe),x.props=i,x.state=xe,x.context=I,i=ve):(typeof x.componentDidUpdate!="function"||v===s.memoizedProps&&ce===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&ce===s.memoizedState||(t.flags|=1024),i=!1)}return x=i,so(s,t),i=(t.flags&128)!==0,x||i?(x=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:x.render(),t.flags|=1,s!==null&&i?(t.child=Un(t,s.child,null,o),t.child=Un(t,null,n,o)):Yt(s,t,n,o),t.memoizedState=x.state,s=t.child):s=wl(s,t,o),s}function Hf(s,t,n,i){return An(),t.flags|=256,Yt(s,t,n,i),t.child}var Ru={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Du(s){return{baseLanes:s,cachePool:Ah()}}function Ou(s,t,n){return s=s!==null?s.childLanes&~n:0,t&&(s|=Sa),s}function Vf(s,t,n){var i=t.pendingProps,o=!1,x=(t.flags&128)!==0,v;if((v=x)||(v=s!==null&&s.memoizedState===null?!1:(Tt.current&2)!==0),v&&(o=!0,t.flags&=-129),v=(t.flags&32)!==0,t.flags&=-33,s===null){if(zs){if(o?Jl(t):Xl(),(s=ut)?(s=Zp(s,Fa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Hl!==null?{id:nl,overflow:rl}:null,retryLane:536870912,hydrationErrors:null},n=yh(s),n.return=t,t.child=n,Kt=t,ut=null)):s=null,s===null)throw Gl(t);return gm(s)?t.lanes=32:t.lanes=536870912,null}var k=i.children;return i=i.fallback,o?(Xl(),o=t.mode,k=to({mode:"hidden",children:k},o),i=Mn(i,o,n,null),k.return=t,i.return=t,k.sibling=i,t.child=k,i=t.child,i.memoizedState=Du(n),i.childLanes=Ou(s,v,n),t.memoizedState=Ru,ki(null,i)):(Jl(t),Lu(t,k))}var I=s.memoizedState;if(I!==null&&(k=I.dehydrated,k!==null)){if(x)t.flags&256?(Jl(t),t.flags&=-257,t=Uu(s,t,n)):t.memoizedState!==null?(Xl(),t.child=s.child,t.flags|=128,t=null):(Xl(),k=i.fallback,o=t.mode,i=to({mode:"visible",children:i.children},o),k=Mn(k,o,n,null),k.flags|=2,i.return=t,k.return=t,i.sibling=k,t.child=i,Un(t,s.child,null,n),i=t.child,i.memoizedState=Du(n),i.childLanes=Ou(s,v,n),t.memoizedState=Ru,t=ki(null,i));else if(Jl(t),gm(k)){if(v=k.nextSibling&&k.nextSibling.dataset,v)var ne=v.dgst;v=ne,i=Error(c(419)),i.stack="",i.digest=v,hi({value:i,source:null,stack:null}),t=Uu(s,t,n)}else if(Ot||vr(s,t,n,!1),v=(n&s.childLanes)!==0,Ot||v){if(v=lt,v!==null&&(i=dt(v,n),i!==0&&i!==I.retryLane))throw I.retryLane=i,En(s,i),fa(v,s,i),Au;pm(k)||mo(),t=Uu(s,t,n)}else pm(k)?(t.flags|=192,t.child=s.child,t=null):(s=I.treeContext,ut=Va(k.nextSibling),Kt=t,zs=!0,Vl=null,Fa=!1,s!==null&&Sh(t,s),t=Lu(t,i.children),t.flags|=4096);return t}return o?(Xl(),k=i.fallback,o=t.mode,I=s.child,ne=I.sibling,i=gl(I,{mode:"hidden",children:i.children}),i.subtreeFlags=I.subtreeFlags&65011712,ne!==null?k=gl(ne,k):(k=Mn(k,o,n,null),k.flags|=2),k.return=t,i.return=t,i.sibling=k,t.child=i,ki(null,i),i=t.child,k=s.child.memoizedState,k===null?k=Du(n):(o=k.cachePool,o!==null?(I=Rt._currentValue,o=o.parent!==I?{parent:I,pool:I}:o):o=Ah(),k={baseLanes:k.baseLanes|n,cachePool:o}),i.memoizedState=k,i.childLanes=Ou(s,v,n),t.memoizedState=Ru,ki(s.child,i)):(Jl(t),n=s.child,s=n.sibling,n=gl(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,s!==null&&(v=t.deletions,v===null?(t.deletions=[s],t.flags|=16):v.push(s)),t.child=n,t.memoizedState=null,n)}function Lu(s,t){return t=to({mode:"visible",children:t},s.mode),t.return=s,s.child=t}function to(s,t){return s=ba(22,s,null,t),s.lanes=0,s}function Uu(s,t,n){return Un(t,s.child,null,n),s=Lu(t,t.pendingProps.children),s.flags|=2,t.memoizedState=null,s}function Gf(s,t,n){s.lanes|=t;var i=s.alternate;i!==null&&(i.lanes|=t),Zd(s.return,t,n)}function $u(s,t,n,i,o,x){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o,treeForkCount:x}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=i,v.tail=n,v.tailMode=o,v.treeForkCount=x)}function qf(s,t,n){var i=t.pendingProps,o=i.revealOrder,x=i.tail;i=i.children;var v=Tt.current,k=(v&2)!==0;if(k?(v=v&1|2,t.flags|=128):v&=1,Te(Tt,v),Yt(s,t,i,n),i=zs?xi:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=t.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Gf(s,n,t);else if(s.tag===19)Gf(s,n,t);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(o){case"forwards":for(n=t.child,o=null;n!==null;)s=n.alternate,s!==null&&Vc(s)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),$u(t,!1,o,n,x,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(s=o.alternate,s!==null&&Vc(s)===null){t.child=o;break}s=o.sibling,o.sibling=n,n=o,o=s}$u(t,!0,n,null,x,i);break;case"together":$u(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function wl(s,t,n){if(s!==null&&(t.dependencies=s.dependencies),en|=t.lanes,(n&t.childLanes)===0)if(s!==null){if(vr(s,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(s!==null&&t.child!==s.child)throw Error(c(153));if(t.child!==null){for(s=t.child,n=gl(s,s.pendingProps),t.child=n,n.return=t;s.sibling!==null;)s=s.sibling,n=n.sibling=gl(s,s.pendingProps),n.return=t;n.sibling=null}return t.child}function Bu(s,t){return(s.lanes&t)!==0?!0:(s=s.dependencies,!!(s!==null&&Lc(s)))}function Ky(s,t,n){switch(t.tag){case 3:Ae(t,t.stateNode.containerInfo),ql(t,Rt,s.memoizedState.cache),An();break;case 27:case 5:Y(t);break;case 4:Ae(t,t.stateNode.containerInfo);break;case 10:ql(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,du(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Jl(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Vf(s,t,n):(Jl(t),s=wl(s,t,n),s!==null?s.sibling:null);Jl(t);break;case 19:var o=(s.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(vr(s,t,n,!1),i=(n&t.childLanes)!==0),o){if(i)return qf(s,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Te(Tt,Tt.current),i)break;return null;case 22:return t.lanes=0,$f(s,t,n,t.pendingProps);case 24:ql(t,Rt,s.memoizedState.cache)}return wl(s,t,n)}function Kf(s,t,n){if(s!==null)if(s.memoizedProps!==t.pendingProps)Ot=!0;else{if(!Bu(s,n)&&(t.flags&128)===0)return Ot=!1,Ky(s,t,n);Ot=(s.flags&131072)!==0}else Ot=!1,zs&&(t.flags&1048576)!==0&&_h(t,xi,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(s=On(t.elementType),t.type=s,typeof s=="function")Vd(s)?(i=Bn(s,i),t.tag=1,t=Ff(null,t,s,i,n)):(t.tag=0,t=zu(null,t,s,i,n));else{if(s!=null){var o=s.$$typeof;if(o===C){t.tag=11,t=Of(null,t,s,i,n);break e}else if(o===O){t.tag=14,t=Lf(null,t,s,i,n);break e}}throw t=he(s)||s,Error(c(306,t,""))}}return t;case 0:return zu(s,t,t.type,t.pendingProps,n);case 1:return i=t.type,o=Bn(i,t.pendingProps),Ff(s,t,i,o,n);case 3:e:{if(Ae(t,t.stateNode.containerInfo),s===null)throw Error(c(387));i=t.pendingProps;var x=t.memoizedState;o=x.element,nu(s,t),bi(t,i,null,n);var v=t.memoizedState;if(i=v.cache,ql(t,Rt,i),i!==x.cache&&Wd(t,[Rt],n,!0),Ni(),i=v.element,x.isDehydrated)if(x={element:i,isDehydrated:!1,cache:v.cache},t.updateQueue.baseState=x,t.memoizedState=x,t.flags&256){t=Hf(s,t,i,n);break e}else if(i!==o){o=Ba(Error(c(424)),t),hi(o),t=Hf(s,t,i,n);break e}else{switch(s=t.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ut=Va(s.firstChild),Kt=t,zs=!0,Vl=null,Fa=!0,n=Uh(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(An(),i===o){t=wl(s,t,n);break e}Yt(s,t,i,n)}t=t.child}return t;case 26:return so(s,t),s===null?(n=lg(t.type,null,t.pendingProps,null))?t.memoizedState=n:zs||(n=t.type,s=t.pendingProps,i=vo(z.current).createElement(n),i[ys]=t,i[fs]=s,Jt(i,n,s),Ft(i),t.stateNode=i):t.memoizedState=lg(t.type,s.memoizedProps,t.pendingProps,s.memoizedState),null;case 27:return Y(t),s===null&&zs&&(i=t.stateNode=sg(t.type,t.pendingProps,z.current),Kt=t,Fa=!0,o=ut,nn(t.type)?(jm=o,ut=Va(i.firstChild)):ut=o),Yt(s,t,t.pendingProps.children,n),so(s,t),s===null&&(t.flags|=4194304),t.child;case 5:return s===null&&zs&&((o=i=ut)&&(i=w0(i,t.type,t.pendingProps,Fa),i!==null?(t.stateNode=i,Kt=t,ut=Va(i.firstChild),Fa=!1,o=!0):o=!1),o||Gl(t)),Y(t),o=t.type,x=t.pendingProps,v=s!==null?s.memoizedProps:null,i=x.children,xm(o,x)?i=null:v!==null&&xm(o,v)&&(t.flags|=32),t.memoizedState!==null&&(o=mu(s,t,$y,null,null,n),Pi._currentValue=o),so(s,t),Yt(s,t,i,n),t.child;case 6:return s===null&&zs&&((s=n=ut)&&(n=_0(n,t.pendingProps,Fa),n!==null?(t.stateNode=n,Kt=t,ut=null,s=!0):s=!1),s||Gl(t)),null;case 13:return Vf(s,t,n);case 4:return Ae(t,t.stateNode.containerInfo),i=t.pendingProps,s===null?t.child=Un(t,null,i,n):Yt(s,t,i,n),t.child;case 11:return Of(s,t,t.type,t.pendingProps,n);case 7:return Yt(s,t,t.pendingProps,n),t.child;case 8:return Yt(s,t,t.pendingProps.children,n),t.child;case 12:return Yt(s,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,ql(t,t.type,i.value),Yt(s,t,i.children,n),t.child;case 9:return o=t.type._context,i=t.pendingProps.children,Rn(t),o=Qt(o),i=i(o),t.flags|=1,Yt(s,t,i,n),t.child;case 14:return Lf(s,t,t.type,t.pendingProps,n);case 15:return Uf(s,t,t.type,t.pendingProps,n);case 19:return qf(s,t,n);case 31:return qy(s,t,n);case 22:return $f(s,t,n,t.pendingProps);case 24:return Rn(t),i=Qt(Rt),s===null?(o=tu(),o===null&&(o=lt,x=eu(),o.pooledCache=x,x.refCount++,x!==null&&(o.pooledCacheLanes|=n),o=x),t.memoizedState={parent:i,cache:o},lu(t),ql(t,Rt,o)):((s.lanes&n)!==0&&(nu(s,t),bi(t,null,null,n),Ni()),o=s.memoizedState,x=t.memoizedState,o.parent!==i?(o={parent:i,cache:i},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),ql(t,Rt,i)):(i=x.cache,ql(t,Rt,i),i!==o.cache&&Wd(t,[Rt],n,!0))),Yt(s,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(c(156,t.tag))}function _l(s){s.flags|=4}function Iu(s,t,n,i,o){if((t=(s.mode&32)!==0)&&(t=!1),t){if(s.flags|=16777216,(o&335544128)===o)if(s.stateNode.complete)s.flags|=8192;else if(Np())s.flags|=8192;else throw Ln=Ic,au}else s.flags&=-16777217}function Qf(s,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!og(t))if(Np())s.flags|=8192;else throw Ln=Ic,au}function ao(s,t){t!==null&&(s.flags|=4),s.flags&16384&&(t=s.tag!==22?te():536870912,s.lanes|=t,Ar|=t)}function Ci(s,t){if(!zs)switch(s.tailMode){case"hidden":t=s.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?s.tail=null:n.sibling=null;break;case"collapsed":n=s.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||s.tail===null?s.tail=null:s.tail.sibling=null:i.sibling=null}}function mt(s){var t=s.alternate!==null&&s.alternate.child===s.child,n=0,i=0;if(t)for(var o=s.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&65011712,i|=o.flags&65011712,o.return=s,o=o.sibling;else for(o=s.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=s,o=o.sibling;return s.subtreeFlags|=i,s.childLanes=n,t}function Qy(s,t,n){var i=t.pendingProps;switch(Qd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(t),null;case 1:return mt(t),null;case 3:return n=t.stateNode,i=null,s!==null&&(i=s.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Nl(Rt),ee(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(s===null||s.child===null)&&(jr(t)?_l(t):s===null||s.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Jd())),mt(t),null;case 26:var o=t.type,x=t.memoizedState;return s===null?(_l(t),x!==null?(mt(t),Qf(t,x)):(mt(t),Iu(t,o,null,i,n))):x?x!==s.memoizedState?(_l(t),mt(t),Qf(t,x)):(mt(t),t.flags&=-16777217):(s=s.memoizedProps,s!==i&&_l(t),mt(t),Iu(t,o,s,i,n)),null;case 27:if($e(t),n=z.current,o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&_l(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return mt(t),null}s=q.current,jr(t)?kh(t):(s=sg(o,i,n),t.stateNode=s,_l(t))}return mt(t),null;case 5:if($e(t),o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&_l(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return mt(t),null}if(x=q.current,jr(t))kh(t);else{var v=vo(z.current);switch(x){case 1:x=v.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:x=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":x=v.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":x=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":x=v.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof i.is=="string"?v.createElement("select",{is:i.is}):v.createElement("select"),i.multiple?x.multiple=!0:i.size&&(x.size=i.size);break;default:x=typeof i.is=="string"?v.createElement(o,{is:i.is}):v.createElement(o)}}x[ys]=t,x[fs]=i;e:for(v=t.child;v!==null;){if(v.tag===5||v.tag===6)x.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}t.stateNode=x;e:switch(Jt(x,o,i),o){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&_l(t)}}return mt(t),Iu(t,t.type,s===null?null:s.memoizedProps,t.pendingProps,n),null;case 6:if(s&&t.stateNode!=null)s.memoizedProps!==i&&_l(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(c(166));if(s=z.current,jr(t)){if(s=t.stateNode,n=t.memoizedProps,i=null,o=Kt,o!==null)switch(o.tag){case 27:case 5:i=o.memoizedProps}s[ys]=t,s=!!(s.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Vp(s.nodeValue,n)),s||Gl(t,!0)}else s=vo(s).createTextNode(i),s[ys]=t,t.stateNode=s}return mt(t),null;case 31:if(n=t.memoizedState,s===null||s.memoizedState!==null){if(i=jr(t),n!==null){if(s===null){if(!i)throw Error(c(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(557));s[ys]=t}else An(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;mt(t),s=!1}else n=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=n),s=!0;if(!s)return t.flags&256?(wa(t),t):(wa(t),null);if((t.flags&128)!==0)throw Error(c(558))}return mt(t),null;case 13:if(i=t.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(o=jr(t),i!==null&&i.dehydrated!==null){if(s===null){if(!o)throw Error(c(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(c(317));o[ys]=t}else An(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;mt(t),o=!1}else o=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(wa(t),t):(wa(t),null)}return wa(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,s=s!==null&&s.memoizedState!==null,n&&(i=t.child,o=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(o=i.alternate.memoizedState.cachePool.pool),x=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(x=i.memoizedState.cachePool.pool),x!==o&&(i.flags|=2048)),n!==s&&n&&(t.child.flags|=8192),ao(t,t.updateQueue),mt(t),null);case 4:return ee(),s===null&&cm(t.stateNode.containerInfo),mt(t),null;case 10:return Nl(t.type),mt(t),null;case 19:if(fe(Tt),i=t.memoizedState,i===null)return mt(t),null;if(o=(t.flags&128)!==0,x=i.rendering,x===null)if(o)Ci(i,!1);else{if(_t!==0||s!==null&&(s.flags&128)!==0)for(s=t.child;s!==null;){if(x=Vc(s),x!==null){for(t.flags|=128,Ci(i,!1),s=x.updateQueue,t.updateQueue=s,ao(t,s),t.subtreeFlags=0,s=n,n=t.child;n!==null;)bh(n,s),n=n.sibling;return Te(Tt,Tt.current&1|2),zs&&jl(t,i.treeForkCount),t.child}s=s.sibling}i.tail!==null&&vt()>co&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304)}else{if(!o)if(s=Vc(x),s!==null){if(t.flags|=128,o=!0,s=s.updateQueue,t.updateQueue=s,ao(t,s),Ci(i,!0),i.tail===null&&i.tailMode==="hidden"&&!x.alternate&&!zs)return mt(t),null}else 2*vt()-i.renderingStartTime>co&&n!==536870912&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304);i.isBackwards?(x.sibling=t.child,t.child=x):(s=i.last,s!==null?s.sibling=x:t.child=x,i.last=x)}return i.tail!==null?(s=i.tail,i.rendering=s,i.tail=s.sibling,i.renderingStartTime=vt(),s.sibling=null,n=Tt.current,Te(Tt,o?n&1|2:n&1),zs&&jl(t,i.treeForkCount),s):(mt(t),null);case 22:case 23:return wa(t),ou(),i=t.memoizedState!==null,s!==null?s.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(mt(t),t.subtreeFlags&6&&(t.flags|=8192)):mt(t),n=t.updateQueue,n!==null&&ao(t,n.retryQueue),n=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),s!==null&&fe(Dn),null;case 24:return n=null,s!==null&&(n=s.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Nl(Rt),mt(t),null;case 25:return null;case 30:return null}throw Error(c(156,t.tag))}function Yy(s,t){switch(Qd(t),t.tag){case 1:return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 3:return Nl(Rt),ee(),s=t.flags,(s&65536)!==0&&(s&128)===0?(t.flags=s&-65537|128,t):null;case 26:case 27:case 5:return $e(t),null;case 31:if(t.memoizedState!==null){if(wa(t),t.alternate===null)throw Error(c(340));An()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 13:if(wa(t),s=t.memoizedState,s!==null&&s.dehydrated!==null){if(t.alternate===null)throw Error(c(340));An()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 19:return fe(Tt),null;case 4:return ee(),null;case 10:return Nl(t.type),null;case 22:case 23:return wa(t),ou(),s!==null&&fe(Dn),s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 24:return Nl(Rt),null;case 25:return null;default:return null}}function Yf(s,t){switch(Qd(t),t.tag){case 3:Nl(Rt),ee();break;case 26:case 27:case 5:$e(t);break;case 4:ee();break;case 31:t.memoizedState!==null&&wa(t);break;case 13:wa(t);break;case 19:fe(Tt);break;case 10:Nl(t.type);break;case 22:case 23:wa(t),ou(),s!==null&&fe(Dn);break;case 24:Nl(Rt)}}function Ti(s,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var o=i.next;n=o;do{if((n.tag&s)===s){i=void 0;var x=n.create,v=n.inst;i=x(),v.destroy=i}n=n.next}while(n!==o)}}catch(k){Qs(t,t.return,k)}}function Zl(s,t,n){try{var i=t.updateQueue,o=i!==null?i.lastEffect:null;if(o!==null){var x=o.next;i=x;do{if((i.tag&s)===s){var v=i.inst,k=v.destroy;if(k!==void 0){v.destroy=void 0,o=t;var I=n,ne=k;try{ne()}catch(ve){Qs(o,I,ve)}}}i=i.next}while(i!==x)}}catch(ve){Qs(t,t.return,ve)}}function Jf(s){var t=s.updateQueue;if(t!==null){var n=s.stateNode;try{Bh(t,n)}catch(i){Qs(s,s.return,i)}}}function Xf(s,t,n){n.props=Bn(s.type,s.memoizedProps),n.state=s.memoizedState;try{n.componentWillUnmount()}catch(i){Qs(s,t,i)}}function Ei(s,t){try{var n=s.ref;if(n!==null){switch(s.tag){case 26:case 27:case 5:var i=s.stateNode;break;case 30:i=s.stateNode;break;default:i=s.stateNode}typeof n=="function"?s.refCleanup=n(i):n.current=i}}catch(o){Qs(s,t,o)}}function il(s,t){var n=s.ref,i=s.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(o){Qs(s,t,o)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(o){Qs(s,t,o)}else n.current=null}function Zf(s){var t=s.type,n=s.memoizedProps,i=s.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(o){Qs(s,s.return,o)}}function Pu(s,t,n){try{var i=s.stateNode;g0(i,s.type,n,t),i[fs]=t}catch(o){Qs(s,s.return,o)}}function Wf(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&nn(s.type)||s.tag===4}function Fu(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Wf(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&nn(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Hu(s,t,n){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(s,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(s),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=fl));else if(i!==4&&(i===27&&nn(s.type)&&(n=s.stateNode,t=null),s=s.child,s!==null))for(Hu(s,t,n),s=s.sibling;s!==null;)Hu(s,t,n),s=s.sibling}function lo(s,t,n){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?n.insertBefore(s,t):n.appendChild(s);else if(i!==4&&(i===27&&nn(s.type)&&(n=s.stateNode),s=s.child,s!==null))for(lo(s,t,n),s=s.sibling;s!==null;)lo(s,t,n),s=s.sibling}function ep(s){var t=s.stateNode,n=s.memoizedProps;try{for(var i=s.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);Jt(t,i,n),t[ys]=s,t[fs]=n}catch(x){Qs(s,s.return,x)}}var Sl=!1,Lt=!1,Vu=!1,sp=typeof WeakSet=="function"?WeakSet:Set,Ht=null;function Jy(s,t){if(s=s.containerInfo,um=ko,s=mh(s),Ud(s)){if("selectionStart"in s)var n={start:s.selectionStart,end:s.selectionEnd};else e:{n=(n=s.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,x=i.focusNode;i=i.focusOffset;try{n.nodeType,x.nodeType}catch{n=null;break e}var v=0,k=-1,I=-1,ne=0,ve=0,ye=s,ce=null;s:for(;;){for(var xe;ye!==n||o!==0&&ye.nodeType!==3||(k=v+o),ye!==x||i!==0&&ye.nodeType!==3||(I=v+i),ye.nodeType===3&&(v+=ye.nodeValue.length),(xe=ye.firstChild)!==null;)ce=ye,ye=xe;for(;;){if(ye===s)break s;if(ce===n&&++ne===o&&(k=v),ce===x&&++ve===i&&(I=v),(xe=ye.nextSibling)!==null)break;ye=ce,ce=ye.parentNode}ye=xe}n=k===-1||I===-1?null:{start:k,end:I}}else n=null}n=n||{start:0,end:0}}else n=null;for(mm={focusedElem:s,selectionRange:n},ko=!1,Ht=t;Ht!==null;)if(t=Ht,s=t.child,(t.subtreeFlags&1028)!==0&&s!==null)s.return=t,Ht=s;else for(;Ht!==null;){switch(t=Ht,x=t.alternate,s=t.flags,t.tag){case 0:if((s&4)!==0&&(s=t.updateQueue,s=s!==null?s.events:null,s!==null))for(n=0;n<s.length;n++)o=s[n],o.ref.impl=o.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,n=t,o=x.memoizedProps,x=x.memoizedState,i=n.stateNode;try{var Ve=Bn(n.type,o);s=i.getSnapshotBeforeUpdate(Ve,x),i.__reactInternalSnapshotBeforeUpdate=s}catch(es){Qs(n,n.return,es)}}break;case 3:if((s&1024)!==0){if(s=t.stateNode.containerInfo,n=s.nodeType,n===9)fm(s);else if(n===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(c(163))}if(s=t.sibling,s!==null){s.return=t.return,Ht=s;break}Ht=t.return}}function tp(s,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Cl(s,n),i&4&&Ti(5,n);break;case 1:if(Cl(s,n),i&4)if(s=n.stateNode,t===null)try{s.componentDidMount()}catch(v){Qs(n,n.return,v)}else{var o=Bn(n.type,t.memoizedProps);t=t.memoizedState;try{s.componentDidUpdate(o,t,s.__reactInternalSnapshotBeforeUpdate)}catch(v){Qs(n,n.return,v)}}i&64&&Jf(n),i&512&&Ei(n,n.return);break;case 3:if(Cl(s,n),i&64&&(s=n.updateQueue,s!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Bh(s,t)}catch(v){Qs(n,n.return,v)}}break;case 27:t===null&&i&4&&ep(n);case 26:case 5:Cl(s,n),t===null&&i&4&&Zf(n),i&512&&Ei(n,n.return);break;case 12:Cl(s,n);break;case 31:Cl(s,n),i&4&&np(s,n);break;case 13:Cl(s,n),i&4&&rp(s,n),i&64&&(s=n.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(n=n0.bind(null,n),S0(s,n))));break;case 22:if(i=n.memoizedState!==null||Sl,!i){t=t!==null&&t.memoizedState!==null||Lt,o=Sl;var x=Lt;Sl=i,(Lt=t)&&!x?Tl(s,n,(n.subtreeFlags&8772)!==0):Cl(s,n),Sl=o,Lt=x}break;case 30:break;default:Cl(s,n)}}function ap(s){var t=s.alternate;t!==null&&(s.alternate=null,ap(t)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(t=s.stateNode,t!==null&&Nd(t)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var gt=null,ua=!1;function kl(s,t,n){for(n=n.child;n!==null;)lp(s,t,n),n=n.sibling}function lp(s,t,n){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(Vs,n)}catch{}switch(n.tag){case 26:Lt||il(n,t),kl(s,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Lt||il(n,t);var i=gt,o=ua;nn(n.type)&&(gt=n.stateNode,ua=!1),kl(s,t,n),$i(n.stateNode),gt=i,ua=o;break;case 5:Lt||il(n,t);case 6:if(i=gt,o=ua,gt=null,kl(s,t,n),gt=i,ua=o,gt!==null)if(ua)try{(gt.nodeType===9?gt.body:gt.nodeName==="HTML"?gt.ownerDocument.body:gt).removeChild(n.stateNode)}catch(x){Qs(n,t,x)}else try{gt.removeChild(n.stateNode)}catch(x){Qs(n,t,x)}break;case 18:gt!==null&&(ua?(s=gt,Jp(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,n.stateNode),Br(s)):Jp(gt,n.stateNode));break;case 4:i=gt,o=ua,gt=n.stateNode.containerInfo,ua=!0,kl(s,t,n),gt=i,ua=o;break;case 0:case 11:case 14:case 15:Zl(2,n,t),Lt||Zl(4,n,t),kl(s,t,n);break;case 1:Lt||(il(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Xf(n,t,i)),kl(s,t,n);break;case 21:kl(s,t,n);break;case 22:Lt=(i=Lt)||n.memoizedState!==null,kl(s,t,n),Lt=i;break;default:kl(s,t,n)}}function np(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Br(s)}catch(n){Qs(t,t.return,n)}}}function rp(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Br(s)}catch(n){Qs(t,t.return,n)}}function Xy(s){switch(s.tag){case 31:case 13:case 19:var t=s.stateNode;return t===null&&(t=s.stateNode=new sp),t;case 22:return s=s.stateNode,t=s._retryCache,t===null&&(t=s._retryCache=new sp),t;default:throw Error(c(435,s.tag))}}function no(s,t){var n=Xy(s);t.forEach(function(i){if(!n.has(i)){n.add(i);var o=r0.bind(null,s,i);i.then(o,o)}})}function ma(s,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i],x=s,v=t,k=v;e:for(;k!==null;){switch(k.tag){case 27:if(nn(k.type)){gt=k.stateNode,ua=!1;break e}break;case 5:gt=k.stateNode,ua=!1;break e;case 3:case 4:gt=k.stateNode.containerInfo,ua=!0;break e}k=k.return}if(gt===null)throw Error(c(160));lp(x,v,o),gt=null,ua=!1,x=o.alternate,x!==null&&(x.return=null),o.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)ip(t,s),t=t.sibling}var Za=null;function ip(s,t){var n=s.alternate,i=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ma(t,s),xa(s),i&4&&(Zl(3,s,s.return),Ti(3,s),Zl(5,s,s.return));break;case 1:ma(t,s),xa(s),i&512&&(Lt||n===null||il(n,n.return)),i&64&&Sl&&(s=s.updateQueue,s!==null&&(i=s.callbacks,i!==null&&(n=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var o=Za;if(ma(t,s),xa(s),i&512&&(Lt||n===null||il(n,n.return)),i&4){var x=n!==null?n.memoizedState:null;if(i=s.memoizedState,n===null)if(i===null)if(s.stateNode===null){e:{i=s.type,n=s.memoizedProps,o=o.ownerDocument||o;s:switch(i){case"title":x=o.getElementsByTagName("title")[0],(!x||x[_n]||x[ys]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=o.createElement(i),o.head.insertBefore(x,o.querySelector("head > title"))),Jt(x,i,n),x[ys]=s,Ft(x),i=x;break e;case"link":var v=ig("link","href",o).get(i+(n.href||""));if(v){for(var k=0;k<v.length;k++)if(x=v[k],x.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&x.getAttribute("rel")===(n.rel==null?null:n.rel)&&x.getAttribute("title")===(n.title==null?null:n.title)&&x.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){v.splice(k,1);break s}}x=o.createElement(i),Jt(x,i,n),o.head.appendChild(x);break;case"meta":if(v=ig("meta","content",o).get(i+(n.content||""))){for(k=0;k<v.length;k++)if(x=v[k],x.getAttribute("content")===(n.content==null?null:""+n.content)&&x.getAttribute("name")===(n.name==null?null:n.name)&&x.getAttribute("property")===(n.property==null?null:n.property)&&x.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&x.getAttribute("charset")===(n.charSet==null?null:n.charSet)){v.splice(k,1);break s}}x=o.createElement(i),Jt(x,i,n),o.head.appendChild(x);break;default:throw Error(c(468,i))}x[ys]=s,Ft(x),i=x}s.stateNode=i}else cg(o,s.type,s.stateNode);else s.stateNode=rg(o,i,s.memoizedProps);else x!==i?(x===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):x.count--,i===null?cg(o,s.type,s.stateNode):rg(o,i,s.memoizedProps)):i===null&&s.stateNode!==null&&Pu(s,s.memoizedProps,n.memoizedProps)}break;case 27:ma(t,s),xa(s),i&512&&(Lt||n===null||il(n,n.return)),n!==null&&i&4&&Pu(s,s.memoizedProps,n.memoizedProps);break;case 5:if(ma(t,s),xa(s),i&512&&(Lt||n===null||il(n,n.return)),s.flags&32){o=s.stateNode;try{cr(o,"")}catch(Ve){Qs(s,s.return,Ve)}}i&4&&s.stateNode!=null&&(o=s.memoizedProps,Pu(s,o,n!==null?n.memoizedProps:o)),i&1024&&(Vu=!0);break;case 6:if(ma(t,s),xa(s),i&4){if(s.stateNode===null)throw Error(c(162));i=s.memoizedProps,n=s.stateNode;try{n.nodeValue=i}catch(Ve){Qs(s,s.return,Ve)}}break;case 3:if(yo=null,o=Za,Za=No(t.containerInfo),ma(t,s),Za=o,xa(s),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Br(t.containerInfo)}catch(Ve){Qs(s,s.return,Ve)}Vu&&(Vu=!1,cp(s));break;case 4:i=Za,Za=No(s.stateNode.containerInfo),ma(t,s),xa(s),Za=i;break;case 12:ma(t,s),xa(s);break;case 31:ma(t,s),xa(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 13:ma(t,s),xa(s),s.child.flags&8192&&s.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(io=vt()),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 22:o=s.memoizedState!==null;var I=n!==null&&n.memoizedState!==null,ne=Sl,ve=Lt;if(Sl=ne||o,Lt=ve||I,ma(t,s),Lt=ve,Sl=ne,xa(s),i&8192)e:for(t=s.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(n===null||I||Sl||Lt||In(s)),n=null,t=s;;){if(t.tag===5||t.tag===26){if(n===null){I=n=t;try{if(x=I.stateNode,o)v=x.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{k=I.stateNode;var ye=I.memoizedProps.style,ce=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;k.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Ve){Qs(I,I.return,Ve)}}}else if(t.tag===6){if(n===null){I=t;try{I.stateNode.nodeValue=o?"":I.memoizedProps}catch(Ve){Qs(I,I.return,Ve)}}}else if(t.tag===18){if(n===null){I=t;try{var xe=I.stateNode;o?Xp(xe,!0):Xp(I.stateNode,!1)}catch(Ve){Qs(I,I.return,Ve)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===s)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=s.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,no(s,n))));break;case 19:ma(t,s),xa(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 30:break;case 21:break;default:ma(t,s),xa(s)}}function xa(s){var t=s.flags;if(t&2){try{for(var n,i=s.return;i!==null;){if(Wf(i)){n=i;break}i=i.return}if(n==null)throw Error(c(160));switch(n.tag){case 27:var o=n.stateNode,x=Fu(s);lo(s,x,o);break;case 5:var v=n.stateNode;n.flags&32&&(cr(v,""),n.flags&=-33);var k=Fu(s);lo(s,k,v);break;case 3:case 4:var I=n.stateNode.containerInfo,ne=Fu(s);Hu(s,ne,I);break;default:throw Error(c(161))}}catch(ve){Qs(s,s.return,ve)}s.flags&=-3}t&4096&&(s.flags&=-4097)}function cp(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var t=s;cp(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),s=s.sibling}}function Cl(s,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)tp(s,t.alternate,t),t=t.sibling}function In(s){for(s=s.child;s!==null;){var t=s;switch(t.tag){case 0:case 11:case 14:case 15:Zl(4,t,t.return),In(t);break;case 1:il(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Xf(t,t.return,n),In(t);break;case 27:$i(t.stateNode);case 26:case 5:il(t,t.return),In(t);break;case 22:t.memoizedState===null&&In(t);break;case 30:In(t);break;default:In(t)}s=s.sibling}}function Tl(s,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,o=s,x=t,v=x.flags;switch(x.tag){case 0:case 11:case 15:Tl(o,x,n),Ti(4,x);break;case 1:if(Tl(o,x,n),i=x,o=i.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(ne){Qs(i,i.return,ne)}if(i=x,o=i.updateQueue,o!==null){var k=i.stateNode;try{var I=o.shared.hiddenCallbacks;if(I!==null)for(o.shared.hiddenCallbacks=null,o=0;o<I.length;o++)$h(I[o],k)}catch(ne){Qs(i,i.return,ne)}}n&&v&64&&Jf(x),Ei(x,x.return);break;case 27:ep(x);case 26:case 5:Tl(o,x,n),n&&i===null&&v&4&&Zf(x),Ei(x,x.return);break;case 12:Tl(o,x,n);break;case 31:Tl(o,x,n),n&&v&4&&np(o,x);break;case 13:Tl(o,x,n),n&&v&4&&rp(o,x);break;case 22:x.memoizedState===null&&Tl(o,x,n),Ei(x,x.return);break;case 30:break;default:Tl(o,x,n)}t=t.sibling}}function Gu(s,t){var n=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(s!=null&&s.refCount++,n!=null&&fi(n))}function qu(s,t){s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s))}function Wa(s,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)op(s,t,n,i),t=t.sibling}function op(s,t,n,i){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Wa(s,t,n,i),o&2048&&Ti(9,t);break;case 1:Wa(s,t,n,i);break;case 3:Wa(s,t,n,i),o&2048&&(s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s)));break;case 12:if(o&2048){Wa(s,t,n,i),s=t.stateNode;try{var x=t.memoizedProps,v=x.id,k=x.onPostCommit;typeof k=="function"&&k(v,t.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(I){Qs(t,t.return,I)}}else Wa(s,t,n,i);break;case 31:Wa(s,t,n,i);break;case 13:Wa(s,t,n,i);break;case 23:break;case 22:x=t.stateNode,v=t.alternate,t.memoizedState!==null?x._visibility&2?Wa(s,t,n,i):Mi(s,t):x._visibility&2?Wa(s,t,n,i):(x._visibility|=2,Tr(s,t,n,i,(t.subtreeFlags&10256)!==0||!1)),o&2048&&Gu(v,t);break;case 24:Wa(s,t,n,i),o&2048&&qu(t.alternate,t);break;default:Wa(s,t,n,i)}}function Tr(s,t,n,i,o){for(o=o&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var x=s,v=t,k=n,I=i,ne=v.flags;switch(v.tag){case 0:case 11:case 15:Tr(x,v,k,I,o),Ti(8,v);break;case 23:break;case 22:var ve=v.stateNode;v.memoizedState!==null?ve._visibility&2?Tr(x,v,k,I,o):Mi(x,v):(ve._visibility|=2,Tr(x,v,k,I,o)),o&&ne&2048&&Gu(v.alternate,v);break;case 24:Tr(x,v,k,I,o),o&&ne&2048&&qu(v.alternate,v);break;default:Tr(x,v,k,I,o)}t=t.sibling}}function Mi(s,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=s,i=t,o=i.flags;switch(i.tag){case 22:Mi(n,i),o&2048&&Gu(i.alternate,i);break;case 24:Mi(n,i),o&2048&&qu(i.alternate,i);break;default:Mi(n,i)}t=t.sibling}}var Ai=8192;function Er(s,t,n){if(s.subtreeFlags&Ai)for(s=s.child;s!==null;)dp(s,t,n),s=s.sibling}function dp(s,t,n){switch(s.tag){case 26:Er(s,t,n),s.flags&Ai&&s.memoizedState!==null&&U0(n,Za,s.memoizedState,s.memoizedProps);break;case 5:Er(s,t,n);break;case 3:case 4:var i=Za;Za=No(s.stateNode.containerInfo),Er(s,t,n),Za=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Ai,Ai=16777216,Er(s,t,n),Ai=i):Er(s,t,n));break;default:Er(s,t,n)}}function up(s){var t=s.alternate;if(t!==null&&(s=t.child,s!==null)){t.child=null;do t=s.sibling,s.sibling=null,s=t;while(s!==null)}}function zi(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Ht=i,xp(i,s)}up(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)mp(s),s=s.sibling}function mp(s){switch(s.tag){case 0:case 11:case 15:zi(s),s.flags&2048&&Zl(9,s,s.return);break;case 3:zi(s);break;case 12:zi(s);break;case 22:var t=s.stateNode;s.memoizedState!==null&&t._visibility&2&&(s.return===null||s.return.tag!==13)?(t._visibility&=-3,ro(s)):zi(s);break;default:zi(s)}}function ro(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Ht=i,xp(i,s)}up(s)}for(s=s.child;s!==null;){switch(t=s,t.tag){case 0:case 11:case 15:Zl(8,t,t.return),ro(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,ro(t));break;default:ro(t)}s=s.sibling}}function xp(s,t){for(;Ht!==null;){var n=Ht;switch(n.tag){case 0:case 11:case 15:Zl(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:fi(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,Ht=i;else e:for(n=s;Ht!==null;){i=Ht;var o=i.sibling,x=i.return;if(ap(i),i===n){Ht=null;break e}if(o!==null){o.return=x,Ht=o;break e}Ht=x}}}var Zy={getCacheForType:function(s){var t=Qt(Rt),n=t.data.get(s);return n===void 0&&(n=s(),t.data.set(s,n)),n},cacheSignal:function(){return Qt(Rt).controller.signal}},Wy=typeof WeakMap=="function"?WeakMap:Map,Hs=0,lt=null,ks=null,Es=0,Ks=0,_a=null,Wl=!1,Mr=!1,Ku=!1,El=0,_t=0,en=0,Pn=0,Qu=0,Sa=0,Ar=0,Ri=null,ha=null,Yu=!1,io=0,hp=0,co=1/0,oo=null,sn=null,$t=0,tn=null,zr=null,Ml=0,Ju=0,Xu=null,fp=null,Di=0,Zu=null;function ka(){return(Hs&2)!==0&&Es!==0?Es&-Es:R.T!==null?lm():re()}function pp(){if(Sa===0)if((Es&536870912)===0||zs){var s=ft;ft<<=1,(ft&3932160)===0&&(ft=262144),Sa=s}else Sa=536870912;return s=ya.current,s!==null&&(s.flags|=32),Sa}function fa(s,t,n){(s===lt&&(Ks===2||Ks===9)||s.cancelPendingCommit!==null)&&(Rr(s,0),an(s,Es,Sa,!1)),Oe(s,n),((Hs&2)===0||s!==lt)&&(s===lt&&((Hs&2)===0&&(Pn|=n),_t===4&&an(s,Es,Sa,!1)),cl(s))}function gp(s,t,n){if((Hs&6)!==0)throw Error(c(327));var i=!n&&(t&127)===0&&(t&s.expiredLanes)===0||xl(s,t),o=i?t0(s,t):em(s,t,!0),x=i;do{if(o===0){Mr&&!i&&an(s,t,0,!1);break}else{if(n=s.current.alternate,x&&!e0(n)){o=em(s,t,!1),x=!1;continue}if(o===2){if(x=t,s.errorRecoveryDisabledLanes&x)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){t=v;e:{var k=s;o=Ri;var I=k.current.memoizedState.isDehydrated;if(I&&(Rr(k,v).flags|=256),v=em(k,v,!1),v!==2){if(Ku&&!I){k.errorRecoveryDisabledLanes|=x,Pn|=x,o=4;break e}x=ha,ha=o,x!==null&&(ha===null?ha=x:ha.push.apply(ha,x))}o=v}if(x=!1,o!==2)continue}}if(o===1){Rr(s,0),an(s,t,0,!0);break}e:{switch(i=s,x=o,x){case 0:case 1:throw Error(c(345));case 4:if((t&4194048)!==t)break;case 6:an(i,t,Sa,!Wl);break e;case 2:ha=null;break;case 3:case 5:break;default:throw Error(c(329))}if((t&62914560)===t&&(o=io+300-vt(),10<o)){if(an(i,t,Sa,!Wl),ll(i,0,!0)!==0)break e;Ml=t,i.timeoutHandle=Qp(jp.bind(null,i,n,ha,oo,Yu,t,Sa,Pn,Ar,Wl,x,"Throttled",-0,0),o);break e}jp(i,n,ha,oo,Yu,t,Sa,Pn,Ar,Wl,x,null,-0,0)}}break}while(!0);cl(s)}function jp(s,t,n,i,o,x,v,k,I,ne,ve,ye,ce,xe){if(s.timeoutHandle=-1,ye=t.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:fl},dp(t,x,ye);var Ve=(x&62914560)===x?io-vt():(x&4194048)===x?hp-vt():0;if(Ve=$0(ye,Ve),Ve!==null){Ml=x,s.cancelPendingCommit=Ve(kp.bind(null,s,t,x,n,i,o,v,k,I,ve,ye,null,ce,xe)),an(s,x,v,!ne);return}}kp(s,t,x,n,i,o,v,k,I)}function e0(s){for(var t=s;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var o=n[i],x=o.getSnapshot;o=o.value;try{if(!Na(x(),o))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function an(s,t,n,i){t&=~Qu,t&=~Pn,s.suspendedLanes|=t,s.pingedLanes&=~t,i&&(s.warmLanes|=t),i=s.expirationTimes;for(var o=t;0<o;){var x=31-Ns(o),v=1<<x;i[x]=-1,o&=~v}n!==0&&Ut(s,n,t)}function uo(){return(Hs&6)===0?(Oi(0),!1):!0}function Wu(){if(ks!==null){if(Ks===0)var s=ks.return;else s=ks,vl=zn=null,fu(s),wr=null,gi=0,s=ks;for(;s!==null;)Yf(s.alternate,s),s=s.return;ks=null}}function Rr(s,t){var n=s.timeoutHandle;n!==-1&&(s.timeoutHandle=-1,N0(n)),n=s.cancelPendingCommit,n!==null&&(s.cancelPendingCommit=null,n()),Ml=0,Wu(),lt=s,ks=n=gl(s.current,null),Es=t,Ks=0,_a=null,Wl=!1,Mr=xl(s,t),Ku=!1,Ar=Sa=Qu=Pn=en=_t=0,ha=Ri=null,Yu=!1,(t&8)!==0&&(t|=t&32);var i=s.entangledLanes;if(i!==0)for(s=s.entanglements,i&=t;0<i;){var o=31-Ns(i),x=1<<o;t|=s[o],i&=~x}return El=t,Ac(),n}function vp(s,t){ps=null,R.H=Si,t===yr||t===Bc?(t=Dh(),Ks=3):t===au?(t=Dh(),Ks=4):Ks=t===Au?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,_a=t,ks===null&&(_t=1,Wc(s,Ba(t,s.current)))}function Np(){var s=ya.current;return s===null?!0:(Es&4194048)===Es?Ha===null:(Es&62914560)===Es||(Es&536870912)!==0?s===Ha:!1}function bp(){var s=R.H;return R.H=Si,s===null?Si:s}function yp(){var s=R.A;return R.A=Zy,s}function mo(){_t=4,Wl||(Es&4194048)!==Es&&ya.current!==null||(Mr=!0),(en&134217727)===0&&(Pn&134217727)===0||lt===null||an(lt,Es,Sa,!1)}function em(s,t,n){var i=Hs;Hs|=2;var o=bp(),x=yp();(lt!==s||Es!==t)&&(oo=null,Rr(s,t)),t=!1;var v=_t;e:do try{if(Ks!==0&&ks!==null){var k=ks,I=_a;switch(Ks){case 8:Wu(),v=6;break e;case 3:case 2:case 9:case 6:ya.current===null&&(t=!0);var ne=Ks;if(Ks=0,_a=null,Dr(s,k,I,ne),n&&Mr){v=0;break e}break;default:ne=Ks,Ks=0,_a=null,Dr(s,k,I,ne)}}s0(),v=_t;break}catch(ve){vp(s,ve)}while(!0);return t&&s.shellSuspendCounter++,vl=zn=null,Hs=i,R.H=o,R.A=x,ks===null&&(lt=null,Es=0,Ac()),v}function s0(){for(;ks!==null;)wp(ks)}function t0(s,t){var n=Hs;Hs|=2;var i=bp(),o=yp();lt!==s||Es!==t?(oo=null,co=vt()+500,Rr(s,t)):Mr=xl(s,t);e:do try{if(Ks!==0&&ks!==null){t=ks;var x=_a;s:switch(Ks){case 1:Ks=0,_a=null,Dr(s,t,x,1);break;case 2:case 9:if(zh(x)){Ks=0,_a=null,_p(t);break}t=function(){Ks!==2&&Ks!==9||lt!==s||(Ks=7),cl(s)},x.then(t,t);break e;case 3:Ks=7;break e;case 4:Ks=5;break e;case 7:zh(x)?(Ks=0,_a=null,_p(t)):(Ks=0,_a=null,Dr(s,t,x,7));break;case 5:var v=null;switch(ks.tag){case 26:v=ks.memoizedState;case 5:case 27:var k=ks;if(v?og(v):k.stateNode.complete){Ks=0,_a=null;var I=k.sibling;if(I!==null)ks=I;else{var ne=k.return;ne!==null?(ks=ne,xo(ne)):ks=null}break s}}Ks=0,_a=null,Dr(s,t,x,5);break;case 6:Ks=0,_a=null,Dr(s,t,x,6);break;case 8:Wu(),_t=6;break e;default:throw Error(c(462))}}a0();break}catch(ve){vp(s,ve)}while(!0);return vl=zn=null,R.H=i,R.A=o,Hs=n,ks!==null?0:(lt=null,Es=0,Ac(),_t)}function a0(){for(;ks!==null&&!Ja();)wp(ks)}function wp(s){var t=Kf(s.alternate,s,El);s.memoizedProps=s.pendingProps,t===null?xo(s):ks=t}function _p(s){var t=s,n=t.alternate;switch(t.tag){case 15:case 0:t=Pf(n,t,t.pendingProps,t.type,void 0,Es);break;case 11:t=Pf(n,t,t.pendingProps,t.type.render,t.ref,Es);break;case 5:fu(t);default:Yf(n,t),t=ks=bh(t,El),t=Kf(n,t,El)}s.memoizedProps=s.pendingProps,t===null?xo(s):ks=t}function Dr(s,t,n,i){vl=zn=null,fu(t),wr=null,gi=0;var o=t.return;try{if(Gy(s,o,t,n,Es)){_t=1,Wc(s,Ba(n,s.current)),ks=null;return}}catch(x){if(o!==null)throw ks=o,x;_t=1,Wc(s,Ba(n,s.current)),ks=null;return}t.flags&32768?(zs||i===1?s=!0:Mr||(Es&536870912)!==0?s=!1:(Wl=s=!0,(i===2||i===9||i===3||i===6)&&(i=ya.current,i!==null&&i.tag===13&&(i.flags|=16384))),Sp(t,s)):xo(t)}function xo(s){var t=s;do{if((t.flags&32768)!==0){Sp(t,Wl);return}s=t.return;var n=Qy(t.alternate,t,El);if(n!==null){ks=n;return}if(t=t.sibling,t!==null){ks=t;return}ks=t=s}while(t!==null);_t===0&&(_t=5)}function Sp(s,t){do{var n=Yy(s.alternate,s);if(n!==null){n.flags&=32767,ks=n;return}if(n=s.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(s=s.sibling,s!==null)){ks=s;return}ks=s=n}while(s!==null);_t=6,ks=null}function kp(s,t,n,i,o,x,v,k,I){s.cancelPendingCommit=null;do ho();while($t!==0);if((Hs&6)!==0)throw Error(c(327));if(t!==null){if(t===s.current)throw Error(c(177));if(x=t.lanes|t.childLanes,x|=Fd,Gs(s,n,x,v,k,I),s===lt&&(ks=lt=null,Es=0),zr=t,tn=s,Ml=n,Ju=x,Xu=o,fp=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,i0(We,function(){return Ap(),null})):(s.callbackNode=null,s.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=R.T,R.T=null,o=Q.p,Q.p=2,v=Hs,Hs|=4;try{Jy(s,t,n)}finally{Hs=v,Q.p=o,R.T=i}}$t=1,Cp(),Tp(),Ep()}}function Cp(){if($t===1){$t=0;var s=tn,t=zr,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=R.T,R.T=null;var i=Q.p;Q.p=2;var o=Hs;Hs|=4;try{ip(t,s);var x=mm,v=mh(s.containerInfo),k=x.focusedElem,I=x.selectionRange;if(v!==k&&k&&k.ownerDocument&&uh(k.ownerDocument.documentElement,k)){if(I!==null&&Ud(k)){var ne=I.start,ve=I.end;if(ve===void 0&&(ve=ne),"selectionStart"in k)k.selectionStart=ne,k.selectionEnd=Math.min(ve,k.value.length);else{var ye=k.ownerDocument||document,ce=ye&&ye.defaultView||window;if(ce.getSelection){var xe=ce.getSelection(),Ve=k.textContent.length,es=Math.min(I.start,Ve),tt=I.end===void 0?es:Math.min(I.end,Ve);!xe.extend&&es>tt&&(v=tt,tt=es,es=v);var X=dh(k,es),V=dh(k,tt);if(X&&V&&(xe.rangeCount!==1||xe.anchorNode!==X.node||xe.anchorOffset!==X.offset||xe.focusNode!==V.node||xe.focusOffset!==V.offset)){var le=ye.createRange();le.setStart(X.node,X.offset),xe.removeAllRanges(),es>tt?(xe.addRange(le),xe.extend(V.node,V.offset)):(le.setEnd(V.node,V.offset),xe.addRange(le))}}}}for(ye=[],xe=k;xe=xe.parentNode;)xe.nodeType===1&&ye.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ye.length;k++){var be=ye[k];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}ko=!!um,mm=um=null}finally{Hs=o,Q.p=i,R.T=n}}s.current=t,$t=2}}function Tp(){if($t===2){$t=0;var s=tn,t=zr,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=R.T,R.T=null;var i=Q.p;Q.p=2;var o=Hs;Hs|=4;try{tp(s,t.alternate,t)}finally{Hs=o,Q.p=i,R.T=n}}$t=3}}function Ep(){if($t===4||$t===3){$t=0,As();var s=tn,t=zr,n=Ml,i=fp;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?$t=5:($t=0,zr=tn=null,Mp(s,s.pendingLanes));var o=s.pendingLanes;if(o===0&&(sn=null),pt(n),t=t.stateNode,ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(Vs,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=R.T,o=Q.p,Q.p=2,R.T=null;try{for(var x=s.onRecoverableError,v=0;v<i.length;v++){var k=i[v];x(k.value,{componentStack:k.stack})}}finally{R.T=t,Q.p=o}}(Ml&3)!==0&&ho(),cl(s),o=s.pendingLanes,(n&261930)!==0&&(o&42)!==0?s===Zu?Di++:(Di=0,Zu=s):Di=0,Oi(0)}}function Mp(s,t){(s.pooledCacheLanes&=t)===0&&(t=s.pooledCache,t!=null&&(s.pooledCache=null,fi(t)))}function ho(){return Cp(),Tp(),Ep(),Ap()}function Ap(){if($t!==5)return!1;var s=tn,t=Ju;Ju=0;var n=pt(Ml),i=R.T,o=Q.p;try{Q.p=32>n?32:n,R.T=null,n=Xu,Xu=null;var x=tn,v=Ml;if($t=0,zr=tn=null,Ml=0,(Hs&6)!==0)throw Error(c(331));var k=Hs;if(Hs|=4,mp(x.current),op(x,x.current,v,n),Hs=k,Oi(0,!1),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(Vs,x)}catch{}return!0}finally{Q.p=o,R.T=i,Mp(s,t)}}function zp(s,t,n){t=Ba(n,t),t=Mu(s.stateNode,t,2),s=Yl(s,t,2),s!==null&&(Oe(s,2),cl(s))}function Qs(s,t,n){if(s.tag===3)zp(s,s,n);else for(;t!==null;){if(t.tag===3){zp(t,s,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(sn===null||!sn.has(i))){s=Ba(n,s),n=Rf(2),i=Yl(t,n,2),i!==null&&(Df(n,i,t,s),Oe(i,2),cl(i));break}}t=t.return}}function sm(s,t,n){var i=s.pingCache;if(i===null){i=s.pingCache=new Wy;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(n)||(Ku=!0,o.add(n),s=l0.bind(null,s,t,n),t.then(s,s))}function l0(s,t,n){var i=s.pingCache;i!==null&&i.delete(t),s.pingedLanes|=s.suspendedLanes&n,s.warmLanes&=~n,lt===s&&(Es&n)===n&&(_t===4||_t===3&&(Es&62914560)===Es&&300>vt()-io?(Hs&2)===0&&Rr(s,0):Qu|=n,Ar===Es&&(Ar=0)),cl(s)}function Rp(s,t){t===0&&(t=te()),s=En(s,t),s!==null&&(Oe(s,t),cl(s))}function n0(s){var t=s.memoizedState,n=0;t!==null&&(n=t.retryLane),Rp(s,n)}function r0(s,t){var n=0;switch(s.tag){case 31:case 13:var i=s.stateNode,o=s.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=s.stateNode;break;case 22:i=s.stateNode._retryCache;break;default:throw Error(c(314))}i!==null&&i.delete(t),Rp(s,n)}function i0(s,t){return Pt(s,t)}var fo=null,Or=null,tm=!1,po=!1,am=!1,ln=0;function cl(s){s!==Or&&s.next===null&&(Or===null?fo=Or=s:Or=Or.next=s),po=!0,tm||(tm=!0,o0())}function Oi(s,t){if(!am&&po){am=!0;do for(var n=!1,i=fo;i!==null;){if(s!==0){var o=i.pendingLanes;if(o===0)var x=0;else{var v=i.suspendedLanes,k=i.pingedLanes;x=(1<<31-Ns(42|s)+1)-1,x&=o&~(v&~k),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(n=!0,Up(i,x))}else x=Es,x=ll(i,i===lt?x:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(x&3)===0||xl(i,x)||(n=!0,Up(i,x));i=i.next}while(n);am=!1}}function c0(){Dp()}function Dp(){po=tm=!1;var s=0;ln!==0&&v0()&&(s=ln);for(var t=vt(),n=null,i=fo;i!==null;){var o=i.next,x=Op(i,t);x===0?(i.next=null,n===null?fo=o:n.next=o,o===null&&(Or=n)):(n=i,(s!==0||(x&3)!==0)&&(po=!0)),i=o}$t!==0&&$t!==5||Oi(s),ln!==0&&(ln=0)}function Op(s,t){for(var n=s.suspendedLanes,i=s.pingedLanes,o=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var v=31-Ns(x),k=1<<v,I=o[v];I===-1?((k&n)===0||(k&i)!==0)&&(o[v]=sr(k,t)):I<=t&&(s.expiredLanes|=k),x&=~k}if(t=lt,n=Es,n=ll(s,s===t?n:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i=s.callbackNode,n===0||s===t&&(Ks===2||Ks===9)||s.cancelPendingCommit!==null)return i!==null&&i!==null&&qt(i),s.callbackNode=null,s.callbackPriority=0;if((n&3)===0||xl(s,n)){if(t=n&-n,t===s.callbackPriority)return t;switch(i!==null&&qt(i),pt(n)){case 2:case 8:n=Qe;break;case 32:n=We;break;case 268435456:n=He;break;default:n=We}return i=Lp.bind(null,s),n=Pt(n,i),s.callbackPriority=t,s.callbackNode=n,t}return i!==null&&i!==null&&qt(i),s.callbackPriority=2,s.callbackNode=null,2}function Lp(s,t){if($t!==0&&$t!==5)return s.callbackNode=null,s.callbackPriority=0,null;var n=s.callbackNode;if(ho()&&s.callbackNode!==n)return null;var i=Es;return i=ll(s,s===lt?i:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i===0?null:(gp(s,i,t),Op(s,vt()),s.callbackNode!=null&&s.callbackNode===n?Lp.bind(null,s):null)}function Up(s,t){if(ho())return null;gp(s,t,!0)}function o0(){b0(function(){(Hs&6)!==0?Pt(qe,c0):Dp()})}function lm(){if(ln===0){var s=Nr;s===0&&(s=rs,rs<<=1,(rs&261888)===0&&(rs=256)),ln=s}return ln}function $p(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:wc(""+s)}function Bp(s,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,s.id&&n.setAttribute("form",s.id),t.parentNode.insertBefore(n,t),s=new FormData(s),n.parentNode.removeChild(n),s}function d0(s,t,n,i,o){if(t==="submit"&&n&&n.stateNode===o){var x=$p((o[fs]||null).action),v=i.submitter;v&&(t=(t=v[fs]||null)?$p(t.formAction):v.getAttribute("formAction"),t!==null&&(x=t,v=null));var k=new Cc("action","action",null,i,o);s.push({event:k,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(ln!==0){var I=v?Bp(o,v):new FormData(o);_u(n,{pending:!0,data:I,method:o.method,action:x},null,I)}}else typeof x=="function"&&(k.preventDefault(),I=v?Bp(o,v):new FormData(o),_u(n,{pending:!0,data:I,method:o.method,action:x},x,I))},currentTarget:o}]})}}for(var nm=0;nm<Pd.length;nm++){var rm=Pd[nm],u0=rm.toLowerCase(),m0=rm[0].toUpperCase()+rm.slice(1);Xa(u0,"on"+m0)}Xa(fh,"onAnimationEnd"),Xa(ph,"onAnimationIteration"),Xa(gh,"onAnimationStart"),Xa("dblclick","onDoubleClick"),Xa("focusin","onFocus"),Xa("focusout","onBlur"),Xa(Ty,"onTransitionRun"),Xa(Ey,"onTransitionStart"),Xa(My,"onTransitionCancel"),Xa(jh,"onTransitionEnd"),rr("onMouseEnter",["mouseout","mouseover"]),rr("onMouseLeave",["mouseout","mouseover"]),rr("onPointerEnter",["pointerout","pointerover"]),rr("onPointerLeave",["pointerout","pointerover"]),Sn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Sn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Sn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Sn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Sn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Sn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),x0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Li));function Ip(s,t){t=(t&4)!==0;for(var n=0;n<s.length;n++){var i=s[n],o=i.event;i=i.listeners;e:{var x=void 0;if(t)for(var v=i.length-1;0<=v;v--){var k=i[v],I=k.instance,ne=k.currentTarget;if(k=k.listener,I!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=ne;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=I}else for(v=0;v<i.length;v++){if(k=i[v],I=k.instance,ne=k.currentTarget,k=k.listener,I!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=ne;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=I}}}}function Cs(s,t){var n=t[va];n===void 0&&(n=t[va]=new Set);var i=s+"__bubble";n.has(i)||(Pp(t,s,2,!1),n.add(i))}function im(s,t,n){var i=0;t&&(i|=4),Pp(n,s,i,t)}var go="_reactListening"+Math.random().toString(36).slice(2);function cm(s){if(!s[go]){s[go]=!0,Rx.forEach(function(n){n!=="selectionchange"&&(x0.has(n)||im(n,!1,s),im(n,!0,s))});var t=s.nodeType===9?s:s.ownerDocument;t===null||t[go]||(t[go]=!0,im("selectionchange",!1,t))}}function Pp(s,t,n,i){switch(pg(t)){case 2:var o=P0;break;case 8:o=F0;break;default:o=wm}n=o.bind(null,t,n,s),o=void 0,!Td||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?s.addEventListener(t,n,{capture:!0,passive:o}):s.addEventListener(t,n,!0):o!==void 0?s.addEventListener(t,n,{passive:o}):s.addEventListener(t,n,!1)}function om(s,t,n,i,o){var x=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var v=i.tag;if(v===3||v===4){var k=i.stateNode.containerInfo;if(k===o)break;if(v===4)for(v=i.return;v!==null;){var I=v.tag;if((I===3||I===4)&&v.stateNode.containerInfo===o)return;v=v.return}for(;k!==null;){if(v=ar(k),v===null)return;if(I=v.tag,I===5||I===6||I===26||I===27){i=x=v;continue e}k=k.parentNode}}i=i.return}Gx(function(){var ne=x,ve=kd(n),ye=[];e:{var ce=vh.get(s);if(ce!==void 0){var xe=Cc,Ve=s;switch(s){case"keypress":if(Sc(n)===0)break e;case"keydown":case"keyup":xe=ry;break;case"focusin":Ve="focus",xe=zd;break;case"focusout":Ve="blur",xe=zd;break;case"beforeblur":case"afterblur":xe=zd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Qx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=Qb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=oy;break;case fh:case ph:case gh:xe=Xb;break;case jh:xe=uy;break;case"scroll":case"scrollend":xe=qb;break;case"wheel":xe=xy;break;case"copy":case"cut":case"paste":xe=Wb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Jx;break;case"toggle":case"beforetoggle":xe=fy}var es=(t&4)!==0,tt=!es&&(s==="scroll"||s==="scrollend"),X=es?ce!==null?ce+"Capture":null:ce;es=[];for(var V=ne,le;V!==null;){var be=V;if(le=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||le===null||X===null||(be=li(V,X),be!=null&&es.push(Ui(V,be,le))),tt)break;V=V.return}0<es.length&&(ce=new xe(ce,Ve,null,n,ve),ye.push({event:ce,listeners:es}))}}if((t&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",ce&&n!==Sd&&(Ve=n.relatedTarget||n.fromElement)&&(ar(Ve)||Ve[yt]))break e;if((xe||ce)&&(ce=ve.window===ve?ve:(ce=ve.ownerDocument)?ce.defaultView||ce.parentWindow:window,xe?(Ve=n.relatedTarget||n.toElement,xe=ne,Ve=Ve?ar(Ve):null,Ve!==null&&(tt=u(Ve),es=Ve.tag,Ve!==tt||es!==5&&es!==27&&es!==6)&&(Ve=null)):(xe=null,Ve=ne),xe!==Ve)){if(es=Qx,be="onMouseLeave",X="onMouseEnter",V="mouse",(s==="pointerout"||s==="pointerover")&&(es=Jx,be="onPointerLeave",X="onPointerEnter",V="pointer"),tt=xe==null?ce:ai(xe),le=Ve==null?ce:ai(Ve),ce=new es(be,V+"leave",xe,n,ve),ce.target=tt,ce.relatedTarget=le,be=null,ar(ve)===ne&&(es=new es(X,V+"enter",Ve,n,ve),es.target=le,es.relatedTarget=tt,be=es),tt=be,xe&&Ve)s:{for(es=h0,X=xe,V=Ve,le=0,be=X;be;be=es(be))le++;be=0;for(var Je=V;Je;Je=es(Je))be++;for(;0<le-be;)X=es(X),le--;for(;0<be-le;)V=es(V),be--;for(;le--;){if(X===V||V!==null&&X===V.alternate){es=X;break s}X=es(X),V=es(V)}es=null}else es=null;xe!==null&&Fp(ye,ce,xe,es,!1),Ve!==null&&tt!==null&&Fp(ye,tt,Ve,es,!0)}}e:{if(ce=ne?ai(ne):window,xe=ce.nodeName&&ce.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ce.type==="file")var Is=lh;else if(th(ce))if(nh)Is=Sy;else{Is=wy;var Ke=yy}else xe=ce.nodeName,!xe||xe.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ne&&_d(ne.elementType)&&(Is=lh):Is=_y;if(Is&&(Is=Is(s,ne))){ah(ye,Is,n,ve);break e}Ke&&Ke(s,ce,ne),s==="focusout"&&ne&&ce.type==="number"&&ne.memoizedProps.value!=null&&wd(ce,"number",ce.value)}switch(Ke=ne?ai(ne):window,s){case"focusin":(th(Ke)||Ke.contentEditable==="true")&&(mr=Ke,$d=ne,mi=null);break;case"focusout":mi=$d=mr=null;break;case"mousedown":Bd=!0;break;case"contextmenu":case"mouseup":case"dragend":Bd=!1,xh(ye,n,ve);break;case"selectionchange":if(Cy)break;case"keydown":case"keyup":xh(ye,n,ve)}var js;if(Dd)e:{switch(s){case"compositionstart":var Ms="onCompositionStart";break e;case"compositionend":Ms="onCompositionEnd";break e;case"compositionupdate":Ms="onCompositionUpdate";break e}Ms=void 0}else ur?eh(s,n)&&(Ms="onCompositionEnd"):s==="keydown"&&n.keyCode===229&&(Ms="onCompositionStart");Ms&&(Xx&&n.locale!=="ko"&&(ur||Ms!=="onCompositionStart"?Ms==="onCompositionEnd"&&ur&&(js=qx()):(Fl=ve,Ed="value"in Fl?Fl.value:Fl.textContent,ur=!0)),Ke=jo(ne,Ms),0<Ke.length&&(Ms=new Yx(Ms,s,null,n,ve),ye.push({event:Ms,listeners:Ke}),js?Ms.data=js:(js=sh(n),js!==null&&(Ms.data=js)))),(js=gy?jy(s,n):vy(s,n))&&(Ms=jo(ne,"onBeforeInput"),0<Ms.length&&(Ke=new Yx("onBeforeInput","beforeinput",null,n,ve),ye.push({event:Ke,listeners:Ms}),Ke.data=js)),d0(ye,s,ne,n,ve)}Ip(ye,t)})}function Ui(s,t,n){return{instance:s,listener:t,currentTarget:n}}function jo(s,t){for(var n=t+"Capture",i=[];s!==null;){var o=s,x=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||x===null||(o=li(s,n),o!=null&&i.unshift(Ui(s,o,x)),o=li(s,t),o!=null&&i.push(Ui(s,o,x))),s.tag===3)return i;s=s.return}return[]}function h0(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Fp(s,t,n,i,o){for(var x=t._reactName,v=[];n!==null&&n!==i;){var k=n,I=k.alternate,ne=k.stateNode;if(k=k.tag,I!==null&&I===i)break;k!==5&&k!==26&&k!==27||ne===null||(I=ne,o?(ne=li(n,x),ne!=null&&v.unshift(Ui(n,ne,I))):o||(ne=li(n,x),ne!=null&&v.push(Ui(n,ne,I)))),n=n.return}v.length!==0&&s.push({event:t,listeners:v})}var f0=/\r\n?/g,p0=/\u0000|\uFFFD/g;function Hp(s){return(typeof s=="string"?s:""+s).replace(f0,`
`).replace(p0,"")}function Vp(s,t){return t=Hp(t),Hp(s)===t}function st(s,t,n,i,o,x){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||cr(s,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&cr(s,""+i);break;case"className":bc(s,"class",i);break;case"tabIndex":bc(s,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":bc(s,n,i);break;case"style":Hx(s,i,x);break;case"data":if(t!=="object"){bc(s,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){s.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(n);break}i=wc(""+i),s.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){s.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(n==="formAction"?(t!=="input"&&st(s,t,"name",o.name,o,null),st(s,t,"formEncType",o.formEncType,o,null),st(s,t,"formMethod",o.formMethod,o,null),st(s,t,"formTarget",o.formTarget,o,null)):(st(s,t,"encType",o.encType,o,null),st(s,t,"method",o.method,o,null),st(s,t,"target",o.target,o,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(n);break}i=wc(""+i),s.setAttribute(n,i);break;case"onClick":i!=null&&(s.onclick=fl);break;case"onScroll":i!=null&&Cs("scroll",s);break;case"onScrollEnd":i!=null&&Cs("scrollend",s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(n=i.__html,n!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=n}}break;case"multiple":s.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":s.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){s.removeAttribute("xlink:href");break}n=wc(""+i),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,""+i):s.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,""):s.removeAttribute(n);break;case"capture":case"download":i===!0?s.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,i):s.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?s.setAttribute(n,i):s.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?s.removeAttribute(n):s.setAttribute(n,i);break;case"popover":Cs("beforetoggle",s),Cs("toggle",s),Nc(s,"popover",i);break;case"xlinkActuate":hl(s,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":hl(s,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":hl(s,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":hl(s,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":hl(s,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":hl(s,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":hl(s,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":hl(s,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":hl(s,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Nc(s,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Vb.get(n)||n,Nc(s,n,i))}}function dm(s,t,n,i,o,x){switch(n){case"style":Hx(s,i,x);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(n=i.__html,n!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=n}}break;case"children":typeof i=="string"?cr(s,i):(typeof i=="number"||typeof i=="bigint")&&cr(s,""+i);break;case"onScroll":i!=null&&Cs("scroll",s);break;case"onScrollEnd":i!=null&&Cs("scrollend",s);break;case"onClick":i!=null&&(s.onclick=fl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dx.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),x=s[fs]||null,x=x!=null?x[n]:null,typeof x=="function"&&s.removeEventListener(t,x,o),typeof i=="function")){typeof x!="function"&&x!==null&&(n in s?s[n]=null:s.hasAttribute(n)&&s.removeAttribute(n)),s.addEventListener(t,i,o);break e}n in s?s[n]=i:i===!0?s.setAttribute(n,""):Nc(s,n,i)}}}function Jt(s,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Cs("error",s),Cs("load",s);var i=!1,o=!1,x;for(x in n)if(n.hasOwnProperty(x)){var v=n[x];if(v!=null)switch(x){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:st(s,t,x,v,n,null)}}o&&st(s,t,"srcSet",n.srcSet,n,null),i&&st(s,t,"src",n.src,n,null);return;case"input":Cs("invalid",s);var k=x=v=o=null,I=null,ne=null;for(i in n)if(n.hasOwnProperty(i)){var ve=n[i];if(ve!=null)switch(i){case"name":o=ve;break;case"type":v=ve;break;case"checked":I=ve;break;case"defaultChecked":ne=ve;break;case"value":x=ve;break;case"defaultValue":k=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(c(137,t));break;default:st(s,t,i,ve,n,null)}}Bx(s,x,k,I,ne,v,o,!1);return;case"select":Cs("invalid",s),i=v=x=null;for(o in n)if(n.hasOwnProperty(o)&&(k=n[o],k!=null))switch(o){case"value":x=k;break;case"defaultValue":v=k;break;case"multiple":i=k;default:st(s,t,o,k,n,null)}t=x,n=v,s.multiple=!!i,t!=null?ir(s,!!i,t,!1):n!=null&&ir(s,!!i,n,!0);return;case"textarea":Cs("invalid",s),x=o=i=null;for(v in n)if(n.hasOwnProperty(v)&&(k=n[v],k!=null))switch(v){case"value":i=k;break;case"defaultValue":o=k;break;case"children":x=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(c(91));break;default:st(s,t,v,k,n,null)}Px(s,i,o,x);return;case"option":for(I in n)if(n.hasOwnProperty(I)&&(i=n[I],i!=null))switch(I){case"selected":s.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:st(s,t,I,i,n,null)}return;case"dialog":Cs("beforetoggle",s),Cs("toggle",s),Cs("cancel",s),Cs("close",s);break;case"iframe":case"object":Cs("load",s);break;case"video":case"audio":for(i=0;i<Li.length;i++)Cs(Li[i],s);break;case"image":Cs("error",s),Cs("load",s);break;case"details":Cs("toggle",s);break;case"embed":case"source":case"link":Cs("error",s),Cs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in n)if(n.hasOwnProperty(ne)&&(i=n[ne],i!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:st(s,t,ne,i,n,null)}return;default:if(_d(t)){for(ve in n)n.hasOwnProperty(ve)&&(i=n[ve],i!==void 0&&dm(s,t,ve,i,n,void 0));return}}for(k in n)n.hasOwnProperty(k)&&(i=n[k],i!=null&&st(s,t,k,i,n,null))}function g0(s,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,x=null,v=null,k=null,I=null,ne=null,ve=null;for(xe in n){var ye=n[xe];if(n.hasOwnProperty(xe)&&ye!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":I=ye;default:i.hasOwnProperty(xe)||st(s,t,xe,null,i,ye)}}for(var ce in i){var xe=i[ce];if(ye=n[ce],i.hasOwnProperty(ce)&&(xe!=null||ye!=null))switch(ce){case"type":x=xe;break;case"name":o=xe;break;case"checked":ne=xe;break;case"defaultChecked":ve=xe;break;case"value":v=xe;break;case"defaultValue":k=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(c(137,t));break;default:xe!==ye&&st(s,t,ce,xe,i,ye)}}yd(s,v,k,I,ne,ve,x,o);return;case"select":xe=v=k=ce=null;for(x in n)if(I=n[x],n.hasOwnProperty(x)&&I!=null)switch(x){case"value":break;case"multiple":xe=I;default:i.hasOwnProperty(x)||st(s,t,x,null,i,I)}for(o in i)if(x=i[o],I=n[o],i.hasOwnProperty(o)&&(x!=null||I!=null))switch(o){case"value":ce=x;break;case"defaultValue":k=x;break;case"multiple":v=x;default:x!==I&&st(s,t,o,x,i,I)}t=k,n=v,i=xe,ce!=null?ir(s,!!n,ce,!1):!!i!=!!n&&(t!=null?ir(s,!!n,t,!0):ir(s,!!n,n?[]:"",!1));return;case"textarea":xe=ce=null;for(k in n)if(o=n[k],n.hasOwnProperty(k)&&o!=null&&!i.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:st(s,t,k,null,i,o)}for(v in i)if(o=i[v],x=n[v],i.hasOwnProperty(v)&&(o!=null||x!=null))switch(v){case"value":ce=o;break;case"defaultValue":xe=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(c(91));break;default:o!==x&&st(s,t,v,o,i,x)}Ix(s,ce,xe);return;case"option":for(var Ve in n)if(ce=n[Ve],n.hasOwnProperty(Ve)&&ce!=null&&!i.hasOwnProperty(Ve))switch(Ve){case"selected":s.selected=!1;break;default:st(s,t,Ve,null,i,ce)}for(I in i)if(ce=i[I],xe=n[I],i.hasOwnProperty(I)&&ce!==xe&&(ce!=null||xe!=null))switch(I){case"selected":s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:st(s,t,I,ce,i,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var es in n)ce=n[es],n.hasOwnProperty(es)&&ce!=null&&!i.hasOwnProperty(es)&&st(s,t,es,null,i,ce);for(ne in i)if(ce=i[ne],xe=n[ne],i.hasOwnProperty(ne)&&ce!==xe&&(ce!=null||xe!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(c(137,t));break;default:st(s,t,ne,ce,i,xe)}return;default:if(_d(t)){for(var tt in n)ce=n[tt],n.hasOwnProperty(tt)&&ce!==void 0&&!i.hasOwnProperty(tt)&&dm(s,t,tt,void 0,i,ce);for(ve in i)ce=i[ve],xe=n[ve],!i.hasOwnProperty(ve)||ce===xe||ce===void 0&&xe===void 0||dm(s,t,ve,ce,i,xe);return}}for(var X in n)ce=n[X],n.hasOwnProperty(X)&&ce!=null&&!i.hasOwnProperty(X)&&st(s,t,X,null,i,ce);for(ye in i)ce=i[ye],xe=n[ye],!i.hasOwnProperty(ye)||ce===xe||ce==null&&xe==null||st(s,t,ye,ce,i,xe)}function Gp(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function j0(){if(typeof performance.getEntriesByType=="function"){for(var s=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var o=n[i],x=o.transferSize,v=o.initiatorType,k=o.duration;if(x&&k&&Gp(v)){for(v=0,k=o.responseEnd,i+=1;i<n.length;i++){var I=n[i],ne=I.startTime;if(ne>k)break;var ve=I.transferSize,ye=I.initiatorType;ve&&Gp(ye)&&(I=I.responseEnd,v+=ve*(I<k?1:(k-ne)/(I-ne)))}if(--i,t+=8*(x+v)/(o.duration/1e3),s++,10<s)break}}if(0<s)return t/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var um=null,mm=null;function vo(s){return s.nodeType===9?s:s.ownerDocument}function qp(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Kp(s,t){if(s===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&t==="foreignObject"?0:s}function xm(s,t){return s==="textarea"||s==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hm=null;function v0(){var s=window.event;return s&&s.type==="popstate"?s===hm?!1:(hm=s,!0):(hm=null,!1)}var Qp=typeof setTimeout=="function"?setTimeout:void 0,N0=typeof clearTimeout=="function"?clearTimeout:void 0,Yp=typeof Promise=="function"?Promise:void 0,b0=typeof queueMicrotask=="function"?queueMicrotask:typeof Yp<"u"?function(s){return Yp.resolve(null).then(s).catch(y0)}:Qp;function y0(s){setTimeout(function(){throw s})}function nn(s){return s==="head"}function Jp(s,t){var n=t,i=0;do{var o=n.nextSibling;if(s.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"||n==="/&"){if(i===0){s.removeChild(o),Br(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")$i(s.ownerDocument.documentElement);else if(n==="head"){n=s.ownerDocument.head,$i(n);for(var x=n.firstChild;x;){var v=x.nextSibling,k=x.nodeName;x[_n]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&x.rel.toLowerCase()==="stylesheet"||n.removeChild(x),x=v}}else n==="body"&&$i(s.ownerDocument.body);n=o}while(n);Br(t)}function Xp(s,t){var n=s;s=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(s===0)break;s--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||s++;n=i}while(n)}function fm(s){var t=s.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":fm(n),Nd(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}s.removeChild(n)}}function w0(s,t,n,i){for(;s.nodeType===1;){var o=n;if(s.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(i){if(!s[_n])switch(t){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==o.rel||s.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||s.getAttribute("title")!==(o.title==null?null:o.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(o.src==null?null:o.src)||s.getAttribute("type")!==(o.type==null?null:o.type)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(t==="input"&&s.type==="hidden"){var x=o.name==null?null:""+o.name;if(o.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=Va(s.nextSibling),s===null)break}return null}function _0(s,t,n){if(t==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!n||(s=Va(s.nextSibling),s===null))return null;return s}function Zp(s,t){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!t||(s=Va(s.nextSibling),s===null))return null;return s}function pm(s){return s.data==="$?"||s.data==="$~"}function gm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function S0(s,t){var n=s.ownerDocument;if(s.data==="$~")s._reactRetry=t;else if(s.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),s._reactRetry=i}}function Va(s){for(;s!=null;s=s.nextSibling){var t=s.nodeType;if(t===1||t===3)break;if(t===8){if(t=s.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return s}var jm=null;function Wp(s){s=s.nextSibling;for(var t=0;s;){if(s.nodeType===8){var n=s.data;if(n==="/$"||n==="/&"){if(t===0)return Va(s.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}s=s.nextSibling}return null}function eg(s){s=s.previousSibling;for(var t=0;s;){if(s.nodeType===8){var n=s.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return s;t--}else n!=="/$"&&n!=="/&"||t++}s=s.previousSibling}return null}function sg(s,t,n){switch(t=vo(n),s){case"html":if(s=t.documentElement,!s)throw Error(c(452));return s;case"head":if(s=t.head,!s)throw Error(c(453));return s;case"body":if(s=t.body,!s)throw Error(c(454));return s;default:throw Error(c(451))}}function $i(s){for(var t=s.attributes;t.length;)s.removeAttributeNode(t[0]);Nd(s)}var Ga=new Map,tg=new Set;function No(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Al=Q.d;Q.d={f:k0,r:C0,D:T0,C:E0,L:M0,m:A0,X:R0,S:z0,M:D0};function k0(){var s=Al.f(),t=uo();return s||t}function C0(s){var t=lr(s);t!==null&&t.tag===5&&t.type==="form"?vf(t):Al.r(s)}var Lr=typeof document>"u"?null:document;function ag(s,t,n){var i=Lr;if(i&&typeof t=="string"&&t){var o=Ua(t);o='link[rel="'+s+'"][href="'+o+'"]',typeof n=="string"&&(o+='[crossorigin="'+n+'"]'),tg.has(o)||(tg.add(o),s={rel:s,crossOrigin:n,href:t},i.querySelector(o)===null&&(t=i.createElement("link"),Jt(t,"link",s),Ft(t),i.head.appendChild(t)))}}function T0(s){Al.D(s),ag("dns-prefetch",s,null)}function E0(s,t){Al.C(s,t),ag("preconnect",s,t)}function M0(s,t,n){Al.L(s,t,n);var i=Lr;if(i&&s&&t){var o='link[rel="preload"][as="'+Ua(t)+'"]';t==="image"&&n&&n.imageSrcSet?(o+='[imagesrcset="'+Ua(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(o+='[imagesizes="'+Ua(n.imageSizes)+'"]')):o+='[href="'+Ua(s)+'"]';var x=o;switch(t){case"style":x=Ur(s);break;case"script":x=$r(s)}Ga.has(x)||(s=j({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:s,as:t},n),Ga.set(x,s),i.querySelector(o)!==null||t==="style"&&i.querySelector(Bi(x))||t==="script"&&i.querySelector(Ii(x))||(t=i.createElement("link"),Jt(t,"link",s),Ft(t),i.head.appendChild(t)))}}function A0(s,t){Al.m(s,t);var n=Lr;if(n&&s){var i=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ua(i)+'"][href="'+Ua(s)+'"]',x=o;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=$r(s)}if(!Ga.has(x)&&(s=j({rel:"modulepreload",href:s},t),Ga.set(x,s),n.querySelector(o)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ii(x)))return}i=n.createElement("link"),Jt(i,"link",s),Ft(i),n.head.appendChild(i)}}}function z0(s,t,n){Al.S(s,t,n);var i=Lr;if(i&&s){var o=nr(i).hoistableStyles,x=Ur(s);t=t||"default";var v=o.get(x);if(!v){var k={loading:0,preload:null};if(v=i.querySelector(Bi(x)))k.loading=5;else{s=j({rel:"stylesheet",href:s,"data-precedence":t},n),(n=Ga.get(x))&&vm(s,n);var I=v=i.createElement("link");Ft(I),Jt(I,"link",s),I._p=new Promise(function(ne,ve){I.onload=ne,I.onerror=ve}),I.addEventListener("load",function(){k.loading|=1}),I.addEventListener("error",function(){k.loading|=2}),k.loading|=4,bo(v,t,i)}v={type:"stylesheet",instance:v,count:1,state:k},o.set(x,v)}}}function R0(s,t){Al.X(s,t);var n=Lr;if(n&&s){var i=nr(n).hoistableScripts,o=$r(s),x=i.get(o);x||(x=n.querySelector(Ii(o)),x||(s=j({src:s,async:!0},t),(t=Ga.get(o))&&Nm(s,t),x=n.createElement("script"),Ft(x),Jt(x,"link",s),n.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function D0(s,t){Al.M(s,t);var n=Lr;if(n&&s){var i=nr(n).hoistableScripts,o=$r(s),x=i.get(o);x||(x=n.querySelector(Ii(o)),x||(s=j({src:s,async:!0,type:"module"},t),(t=Ga.get(o))&&Nm(s,t),x=n.createElement("script"),Ft(x),Jt(x,"link",s),n.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function lg(s,t,n,i){var o=(o=z.current)?No(o):null;if(!o)throw Error(c(446));switch(s){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Ur(n.href),n=nr(o).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){s=Ur(n.href);var x=nr(o).hoistableStyles,v=x.get(s);if(v||(o=o.ownerDocument||o,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,v),(x=o.querySelector(Bi(s)))&&!x._p&&(v.instance=x,v.state.loading=5),Ga.has(s)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Ga.set(s,n),x||O0(o,s,n,v.state))),t&&i===null)throw Error(c(528,""));return v}if(t&&i!==null)throw Error(c(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=$r(n),n=nr(o).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,s))}}function Ur(s){return'href="'+Ua(s)+'"'}function Bi(s){return'link[rel="stylesheet"]['+s+"]"}function ng(s){return j({},s,{"data-precedence":s.precedence,precedence:null})}function O0(s,t,n,i){s.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=s.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Jt(t,"link",n),Ft(t),s.head.appendChild(t))}function $r(s){return'[src="'+Ua(s)+'"]'}function Ii(s){return"script[async]"+s}function rg(s,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=s.querySelector('style[data-href~="'+Ua(n.href)+'"]');if(i)return t.instance=i,Ft(i),i;var o=j({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(s.ownerDocument||s).createElement("style"),Ft(i),Jt(i,"style",o),bo(i,n.precedence,s),t.instance=i;case"stylesheet":o=Ur(n.href);var x=s.querySelector(Bi(o));if(x)return t.state.loading|=4,t.instance=x,Ft(x),x;i=ng(n),(o=Ga.get(o))&&vm(i,o),x=(s.ownerDocument||s).createElement("link"),Ft(x);var v=x;return v._p=new Promise(function(k,I){v.onload=k,v.onerror=I}),Jt(x,"link",i),t.state.loading|=4,bo(x,n.precedence,s),t.instance=x;case"script":return x=$r(n.src),(o=s.querySelector(Ii(x)))?(t.instance=o,Ft(o),o):(i=n,(o=Ga.get(x))&&(i=j({},n),Nm(i,o)),s=s.ownerDocument||s,o=s.createElement("script"),Ft(o),Jt(o,"link",i),s.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(c(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,bo(i,n.precedence,s));return t.instance}function bo(s,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=i.length?i[i.length-1]:null,x=o,v=0;v<i.length;v++){var k=i[v];if(k.dataset.precedence===t)x=k;else if(x!==o)break}x?x.parentNode.insertBefore(s,x.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(s,t.firstChild))}function vm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.title==null&&(s.title=t.title)}function Nm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.integrity==null&&(s.integrity=t.integrity)}var yo=null;function ig(s,t,n){if(yo===null){var i=new Map,o=yo=new Map;o.set(n,i)}else o=yo,i=o.get(n),i||(i=new Map,o.set(n,i));if(i.has(s))return i;for(i.set(s,null),n=n.getElementsByTagName(s),o=0;o<n.length;o++){var x=n[o];if(!(x[_n]||x[ys]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var v=x.getAttribute(t)||"";v=s+v;var k=i.get(v);k?k.push(x):i.set(v,[x])}}return i}function cg(s,t,n){s=s.ownerDocument||s,s.head.insertBefore(n,t==="title"?s.querySelector("head > title"):null)}function L0(s,t,n){if(n===1||t.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return s=t.disabled,typeof t.precedence=="string"&&s==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function og(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function U0(s,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var o=Ur(i.href),x=t.querySelector(Bi(o));if(x){t=x._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(s.count++,s=wo.bind(s),t.then(s,s)),n.state.loading|=4,n.instance=x,Ft(x);return}x=t.ownerDocument||t,i=ng(i),(o=Ga.get(o))&&vm(i,o),x=x.createElement("link"),Ft(x);var v=x;v._p=new Promise(function(k,I){v.onload=k,v.onerror=I}),Jt(x,"link",i),n.instance=x}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(s.count++,n=wo.bind(s),t.addEventListener("load",n),t.addEventListener("error",n))}}var bm=0;function $0(s,t){return s.stylesheets&&s.count===0&&So(s,s.stylesheets),0<s.count||0<s.imgCount?function(n){var i=setTimeout(function(){if(s.stylesheets&&So(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4+t);0<s.imgBytes&&bm===0&&(bm=62500*j0());var o=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&So(s,s.stylesheets),s.unsuspend)){var x=s.unsuspend;s.unsuspend=null,x()}},(s.imgBytes>bm?50:800)+t);return s.unsuspend=n,function(){s.unsuspend=null,clearTimeout(i),clearTimeout(o)}}:null}function wo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)So(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var _o=null;function So(s,t){s.stylesheets=null,s.unsuspend!==null&&(s.count++,_o=new Map,t.forEach(B0,s),_o=null,wo.call(s))}function B0(s,t){if(!(t.state.loading&4)){var n=_o.get(s);if(n)var i=n.get(null);else{n=new Map,_o.set(s,n);for(var o=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<o.length;x++){var v=o[x];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(n.set(v.dataset.precedence,v),i=v)}i&&n.set(null,i)}o=t.instance,v=o.getAttribute("data-precedence"),x=n.get(v)||i,x===i&&n.set(null,o),n.set(v,o),this.count++,i=wo.bind(this),o.addEventListener("load",i),o.addEventListener("error",i),x?x.parentNode.insertBefore(o,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(o,s.firstChild)),t.state.loading|=4}}var Pi={$$typeof:E,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function I0(s,t,n,i,o,x,v,k,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=we(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=we(0),this.hiddenUpdates=we(null),this.identifierPrefix=i,this.onUncaughtError=o,this.onCaughtError=x,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function dg(s,t,n,i,o,x,v,k,I,ne,ve,ye){return s=new I0(s,t,n,v,I,ne,ve,ye,k),t=1,x===!0&&(t|=24),x=ba(3,null,null,t),s.current=x,x.stateNode=s,t=eu(),t.refCount++,s.pooledCache=t,t.refCount++,x.memoizedState={element:i,isDehydrated:n,cache:t},lu(x),s}function ug(s){return s?(s=fr,s):fr}function mg(s,t,n,i,o,x){o=ug(o),i.context===null?i.context=o:i.pendingContext=o,i=Ql(t),i.payload={element:n},x=x===void 0?null:x,x!==null&&(i.callback=x),n=Yl(s,i,t),n!==null&&(fa(n,s,t),vi(n,s,t))}function xg(s,t){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var n=s.retryLane;s.retryLane=n!==0&&n<t?n:t}}function ym(s,t){xg(s,t),(s=s.alternate)&&xg(s,t)}function hg(s){if(s.tag===13||s.tag===31){var t=En(s,67108864);t!==null&&fa(t,s,67108864),ym(s,67108864)}}function fg(s){if(s.tag===13||s.tag===31){var t=ka();t=aa(t);var n=En(s,t);n!==null&&fa(n,s,t),ym(s,t)}}var ko=!0;function P0(s,t,n,i){var o=R.T;R.T=null;var x=Q.p;try{Q.p=2,wm(s,t,n,i)}finally{Q.p=x,R.T=o}}function F0(s,t,n,i){var o=R.T;R.T=null;var x=Q.p;try{Q.p=8,wm(s,t,n,i)}finally{Q.p=x,R.T=o}}function wm(s,t,n,i){if(ko){var o=_m(i);if(o===null)om(s,t,i,Co,n),gg(s,i);else if(V0(o,s,t,n,i))i.stopPropagation();else if(gg(s,i),t&4&&-1<H0.indexOf(s)){for(;o!==null;){var x=lr(o);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var v=Oa(x.pendingLanes);if(v!==0){var k=x;for(k.pendingLanes|=2,k.entangledLanes|=2;v;){var I=1<<31-Ns(v);k.entanglements[1]|=I,v&=~I}cl(x),(Hs&6)===0&&(co=vt()+500,Oi(0))}}break;case 31:case 13:k=En(x,2),k!==null&&fa(k,x,2),uo(),ym(x,2)}if(x=_m(i),x===null&&om(s,t,i,Co,n),x===o)break;o=x}o!==null&&i.stopPropagation()}else om(s,t,i,null,n)}}function _m(s){return s=kd(s),Sm(s)}var Co=null;function Sm(s){if(Co=null,s=ar(s),s!==null){var t=u(s);if(t===null)s=null;else{var n=t.tag;if(n===13){if(s=h(t),s!==null)return s;s=null}else if(n===31){if(s=f(t),s!==null)return s;s=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;s=null}else t!==s&&(s=null)}}return Co=s,null}function pg(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Z()){case qe:return 2;case Qe:return 8;case We:case Rs:return 32;case He:return 268435456;default:return 32}default:return 32}}var km=!1,rn=null,cn=null,on=null,Fi=new Map,Hi=new Map,dn=[],H0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function gg(s,t){switch(s){case"focusin":case"focusout":rn=null;break;case"dragenter":case"dragleave":cn=null;break;case"mouseover":case"mouseout":on=null;break;case"pointerover":case"pointerout":Fi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hi.delete(t.pointerId)}}function Vi(s,t,n,i,o,x){return s===null||s.nativeEvent!==x?(s={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:x,targetContainers:[o]},t!==null&&(t=lr(t),t!==null&&hg(t)),s):(s.eventSystemFlags|=i,t=s.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),s)}function V0(s,t,n,i,o){switch(t){case"focusin":return rn=Vi(rn,s,t,n,i,o),!0;case"dragenter":return cn=Vi(cn,s,t,n,i,o),!0;case"mouseover":return on=Vi(on,s,t,n,i,o),!0;case"pointerover":var x=o.pointerId;return Fi.set(x,Vi(Fi.get(x)||null,s,t,n,i,o)),!0;case"gotpointercapture":return x=o.pointerId,Hi.set(x,Vi(Hi.get(x)||null,s,t,n,i,o)),!0}return!1}function jg(s){var t=ar(s.target);if(t!==null){var n=u(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){s.blockedOn=t,pe(s.priority,function(){fg(n)});return}}else if(t===31){if(t=f(n),t!==null){s.blockedOn=t,pe(s.priority,function(){fg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){s.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}s.blockedOn=null}function To(s){if(s.blockedOn!==null)return!1;for(var t=s.targetContainers;0<t.length;){var n=_m(s.nativeEvent);if(n===null){n=s.nativeEvent;var i=new n.constructor(n.type,n);Sd=i,n.target.dispatchEvent(i),Sd=null}else return t=lr(n),t!==null&&hg(t),s.blockedOn=n,!1;t.shift()}return!0}function vg(s,t,n){To(s)&&n.delete(t)}function G0(){km=!1,rn!==null&&To(rn)&&(rn=null),cn!==null&&To(cn)&&(cn=null),on!==null&&To(on)&&(on=null),Fi.forEach(vg),Hi.forEach(vg)}function Eo(s,t){s.blockedOn===t&&(s.blockedOn=null,km||(km=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,G0)))}var Mo=null;function Ng(s){Mo!==s&&(Mo=s,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Mo===s&&(Mo=null);for(var t=0;t<s.length;t+=3){var n=s[t],i=s[t+1],o=s[t+2];if(typeof i!="function"){if(Sm(i||n)===null)continue;break}var x=lr(n);x!==null&&(s.splice(t,3),t-=3,_u(x,{pending:!0,data:o,method:n.method,action:i},i,o))}}))}function Br(s){function t(I){return Eo(I,s)}rn!==null&&Eo(rn,s),cn!==null&&Eo(cn,s),on!==null&&Eo(on,s),Fi.forEach(t),Hi.forEach(t);for(var n=0;n<dn.length;n++){var i=dn[n];i.blockedOn===s&&(i.blockedOn=null)}for(;0<dn.length&&(n=dn[0],n.blockedOn===null);)jg(n),n.blockedOn===null&&dn.shift();if(n=(s.ownerDocument||s).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var o=n[i],x=n[i+1],v=o[fs]||null;if(typeof x=="function")v||Ng(n);else if(v){var k=null;if(x&&x.hasAttribute("formAction")){if(o=x,v=x[fs]||null)k=v.formAction;else if(Sm(o)!==null)continue}else k=v.action;typeof k=="function"?n[i+1]=k:(n.splice(i,3),i-=3),Ng(n)}}}function bg(){function s(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(v){return o=v})},focusReset:"manual",scroll:"manual"})}function t(){o!==null&&(o(),o=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,o=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),o!==null&&(o(),o=null)}}}function Cm(s){this._internalRoot=s}Ao.prototype.render=Cm.prototype.render=function(s){var t=this._internalRoot;if(t===null)throw Error(c(409));var n=t.current,i=ka();mg(n,i,s,t,null,null)},Ao.prototype.unmount=Cm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var t=s.containerInfo;mg(s.current,2,null,s,null,null),uo(),t[yt]=null}};function Ao(s){this._internalRoot=s}Ao.prototype.unstable_scheduleHydration=function(s){if(s){var t=re();s={blockedOn:null,target:s,priority:t};for(var n=0;n<dn.length&&t!==0&&t<dn[n].priority;n++);dn.splice(n,0,s),n===0&&jg(s)}};var yg=l.version;if(yg!=="19.2.1")throw Error(c(527,yg,"19.2.1"));Q.findDOMNode=function(s){var t=s._reactInternals;if(t===void 0)throw typeof s.render=="function"?Error(c(188)):(s=Object.keys(s).join(","),Error(c(268,s)));return s=g(t),s=s!==null?b(s):null,s=s===null?null:s.stateNode,s};var q0={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zo.isDisabled&&zo.supportsFiber)try{Vs=zo.inject(q0),ns=zo}catch{}}return Gi.createRoot=function(s,t){if(!d(s))throw Error(c(299));var n=!1,i="",o=Ef,x=Mf,v=Af;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(x=t.onCaughtError),t.onRecoverableError!==void 0&&(v=t.onRecoverableError)),t=dg(s,1,!1,null,null,n,i,null,o,x,v,bg),s[yt]=t.current,cm(s),new Cm(t)},Gi.hydrateRoot=function(s,t,n){if(!d(s))throw Error(c(299));var i=!1,o="",x=Ef,v=Mf,k=Af,I=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(x=n.onUncaughtError),n.onCaughtError!==void 0&&(v=n.onCaughtError),n.onRecoverableError!==void 0&&(k=n.onRecoverableError),n.formState!==void 0&&(I=n.formState)),t=dg(s,1,!0,t,n??null,i,o,I,x,v,k,bg),t.context=ug(null),n=t.current,i=ka(),i=aa(i),o=Ql(i),o.callback=null,Yl(n,o,i),n=i,t.current.lanes=n,Oe(t,n),cl(t),s[yt]=t.current,cm(s),new Ao(t)},Gi.version="19.2.1",Gi}var Mg;function M1(){if(Mg)return zm.exports;Mg=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(l){console.error(l)}}return a(),zm.exports=E1(),zm.exports}var A1=M1();function F(...a){return nw(rw(a))}const ke=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("rounded-xl border bg-card text-card-foreground shadow",a),...l}));ke.displayName="Card";const Re=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("flex flex-col space-y-1.5 p-6",a),...l}));Re.displayName="CardHeader";const De=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("font-semibold leading-none tracking-tight",a),...l}));De.displayName="CardTitle";const is=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("text-sm text-muted-foreground",a),...l}));is.displayName="CardDescription";const Me=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("p-6 pt-0",a),...l}));Me.displayName="CardContent";const id=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("flex items-center p-6 pt-0",a),...l}));id.displayName="CardFooter";const ea=cw,Gt=m.forwardRef(({className:a,...l},r)=>e.jsx(cj,{ref:r,className:F("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...l}));Gt.displayName=cj.displayName;const Xe=m.forwardRef(({className:a,...l},r)=>e.jsx(oj,{ref:r,className:F("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...l}));Xe.displayName=oj.displayName;const vs=m.forwardRef(({className:a,...l},r)=>e.jsx(dj,{ref:r,className:F("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 data-[state=active]:animate-in data-[state=active]:fade-in data-[state=active]:duration-300",a),...l}));vs.displayName=dj.displayName;const Ze=m.forwardRef(({className:a,children:l,viewportRef:r,...c},d)=>e.jsxs(uj,{ref:d,className:F("relative overflow-hidden",a),...c,children:[e.jsx(ow,{ref:r,className:"h-full w-full rounded-[inherit]",children:l}),e.jsx(Qm,{}),e.jsx(Qm,{orientation:"horizontal"}),e.jsx(dw,{})]}));Ze.displayName=uj.displayName;const Qm=m.forwardRef(({className:a,orientation:l="vertical",...r},c)=>e.jsx(mj,{ref:c,orientation:l,className:F("flex touch-none select-none transition-colors",l==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",l==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...r,children:e.jsx(uw,{className:"relative flex-1 rounded-full bg-border"})}));Qm.displayName=mj.displayName;function ws({className:a,...l}){return e.jsx("div",{className:F("animate-pulse rounded-md bg-primary/10",a),...l})}const Xn=m.forwardRef(({className:a,value:l,...r},c)=>e.jsx(xj,{ref:c,className:F("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...r,children:e.jsx(mw,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(l||0)}%)`}})}));Xn.displayName=xj.displayName;async function _e(a,l){const c=l?.body instanceof FormData?{...l?.headers}:{"Content-Type":"application/json",...l?.headers},d={...l,credentials:"include",headers:c},u=await fetch(a,d);if(u.status===401)throw window.location.href="/auth",new Error("");return u}function qs(){return{"Content-Type":"application/json"}}async function z1(){try{await fetch("/api/webui/auth/logout",{method:"POST",credentials:"include"})}catch(a){console.error(":",a)}window.location.href="/auth"}async function cc(){try{return(await(await fetch("/api/webui/auth/check",{method:"GET",credentials:"include"})).json()).authenticated===!0}catch{return!1}}const R1={light:"",dark:".dark"},_v=m.createContext(null);function Sv(){const a=m.useContext(_v);if(!a)throw new Error("useChart must be used within a <ChartContainer />");return a}const Vr=m.forwardRef(({id:a,className:l,children:r,config:c,...d},u)=>{const h=m.useId(),f=`chart-${a||h.replace(/:/g,"")}`;return e.jsx(_v.Provider,{value:{config:c},children:e.jsxs("div",{"data-chart":f,ref:u,className:F("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...d,children:[e.jsx(D1,{id:f,config:c}),e.jsx(Aj,{children:r})]})})});Vr.displayName="Chart";const D1=({id:a,config:l})=>{const r=Object.entries(l).filter(([,c])=>c.theme||c.color);return r.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(R1).map(([c,d])=>`
${d} [data-chart=${a}] {
${r.map(([u,h])=>{const f=h.theme?.[c]||h.color;return f?`  --color-${u}: ${f};`:null}).join(`
`)}
}
`).join(`
`)}}):null},qi=zj,Gr=m.forwardRef(({active:a,payload:l,className:r,indicator:c="dot",hideLabel:d=!1,hideIndicator:u=!1,label:h,labelFormatter:f,labelClassName:p,formatter:g,color:b,nameKey:j,labelKey:y},N)=>{const{config:w}=Sv(),M=m.useMemo(()=>{if(d||!l?.length)return null;const[S]=l,U=`${y||S?.dataKey||S?.name||"value"}`,E=Ym(w,S,U),C=!y&&typeof h=="string"?w[h]?.label||h:E?.label;return f?e.jsx("div",{className:F("font-medium",p),children:f(C,l)}):C?e.jsx("div",{className:F("font-medium",p),children:C}):null},[h,f,l,d,p,w,y]);if(!a||!l?.length)return null;const A=l.length===1&&c!=="dot";return e.jsxs("div",{ref:N,className:F("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[A?null:M,e.jsx("div",{className:"grid gap-1.5",children:l.filter(S=>S.type!=="none").map((S,U)=>{const E=`${j||S.name||S.dataKey||"value"}`,C=Ym(w,S,E),D=b||S.payload.fill||S.color;return e.jsx("div",{className:F("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",c==="dot"&&"items-center"),children:g&&S?.value!==void 0&&S.name?g(S.value,S.name,S,U,S.payload):e.jsxs(e.Fragment,{children:[C?.icon?e.jsx(C.icon,{}):!u&&e.jsx("div",{className:F("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":c==="dot","w-1":c==="line","w-0 border-[1.5px] border-dashed bg-transparent":c==="dashed","my-0.5":A&&c==="dashed"}),style:{"--color-bg":D,"--color-border":D}}),e.jsxs("div",{className:F("flex flex-1 justify-between leading-none",A?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[A?M:null,e.jsx("span",{className:"text-muted-foreground",children:C?.label||S.name})]}),S.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:S.value.toLocaleString()})]})]})},S.dataKey)})})]})});Gr.displayName="ChartTooltip";const O1=Vw,kv=m.forwardRef(({className:a,hideIcon:l=!1,payload:r,verticalAlign:c="bottom",nameKey:d},u)=>{const{config:h}=Sv();return r?.length?e.jsx("div",{ref:u,className:F("flex items-center justify-center gap-4",c==="top"?"pb-3":"pt-3",a),children:r.filter(f=>f.type!=="none").map(f=>{const p=`${d||f.dataKey||"value"}`,g=Ym(h,f,p);return e.jsxs("div",{className:F("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[g?.icon&&!l?e.jsx(g.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:f.color}}),g?.label]},f.value)})}):null});kv.displayName="ChartLegend";function Ym(a,l,r){if(typeof l!="object"||l===null)return;const c="payload"in l&&typeof l.payload=="object"&&l.payload!==null?l.payload:void 0;let d=r;return r in l&&typeof l[r]=="string"?d=l[r]:c&&r in c&&typeof c[r]=="string"&&(d=c[r]),d in a?a[d]:a[r]}const Zr=Wr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_=m.forwardRef(({className:a,variant:l,size:r,asChild:c=!1,...d},u)=>{const h=c?Jw:"button";return e.jsx(h,{className:F(Zr({variant:l,size:r,className:a})),ref:u,...d})});_.displayName="Button";const L1=Wr("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ce({className:a,variant:l,...r}){return e.jsx("div",{className:F(L1({variant:l}),a),...r})}async function U1(){const a=await _e("/api/webui/system/restart",{method:"POST",headers:qs()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return await a.json()}async function $1(){const a=await _e("/api/webui/system/status",{method:"GET",headers:qs()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return await a.json()}const Ir={INITIAL_DELAY:3e3,CHECK_INTERVAL:2e3,CHECK_TIMEOUT:3e3,MAX_ATTEMPTS:60,PROGRESS_INTERVAL:200,SUCCESS_REDIRECT_DELAY:1500},Cv=m.createContext(null);function Wn({children:a,onRestartComplete:l,onRestartFailed:r,healthCheckUrl:c="/api/webui/system/status",maxAttempts:d=Ir.MAX_ATTEMPTS}){const[u,h]=m.useState({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),f=m.useRef({}),p=m.useCallback(()=>{const M=f.current;M.progress&&(clearInterval(M.progress),M.progress=void 0),M.elapsed&&(clearInterval(M.elapsed),M.elapsed=void 0),M.check&&(clearTimeout(M.check),M.check=void 0)},[]),g=m.useCallback(()=>{p(),h({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d})},[p,d]),b=m.useCallback(async()=>{try{const M=new AbortController,A=setTimeout(()=>M.abort(),Ir.CHECK_TIMEOUT),S=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include",signal:M.signal});return clearTimeout(A),S.ok}catch{return!1}},[c]),j=m.useCallback(()=>{let M=0;const A=async()=>{if(M++,h(U=>({...U,status:"checking",checkAttempts:M})),await b())p(),h(U=>({...U,status:"success",progress:100})),setTimeout(()=>{l?.(),window.location.href="/auth"},Ir.SUCCESS_REDIRECT_DELAY);else if(M>=d){p();const U=` (${M}/${d})`;h(E=>({...E,status:"failed",error:U})),r?.(U)}else{const U=setTimeout(A,Ir.CHECK_INTERVAL);f.current.check=U}};A()},[b,p,d,l,r]),y=m.useCallback(()=>{h(M=>({...M,status:"checking",checkAttempts:0,error:void 0})),j()},[j]),N=m.useCallback(async M=>{const{delay:A=0,skipApiCall:S=!1}=M??{};if(u.status!=="idle"&&u.status!=="failed")return;if(p(),h({status:"requesting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),A>0&&await new Promise(C=>setTimeout(C,A)),S)h(C=>({...C,status:"restarting"}));else try{h(C=>({...C,status:"restarting"})),await Promise.race([U1(),new Promise(C=>setTimeout(C,5e3))])}catch{}const U=setInterval(()=>{h(C=>({...C,progress:C.progress>=90?C.progress:C.progress+1}))},Ir.PROGRESS_INTERVAL),E=setInterval(()=>{h(C=>({...C,elapsedTime:C.elapsedTime+1}))},1e3);f.current.progress=U,f.current.elapsed=E,setTimeout(()=>{j()},Ir.INITIAL_DELAY)},[u.status,p,d,j]),w={state:u,isRestarting:u.status!=="idle",triggerRestart:N,resetState:g,retryHealthCheck:y};return e.jsx(Cv.Provider,{value:w,children:a})}function yn(){const a=m.useContext(Cv);if(!a)throw new Error("useRestart must be used within a RestartProvider");return a}function B1(){try{return yn()}catch{return null}}const I1=(a,l,r,c,d)=>({idle:{icon:null,title:"",description:"",tip:""},requesting:{icon:e.jsx(Os,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},restarting:{icon:e.jsx(Os,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},checking:{icon:e.jsx(Os,{className:"h-16 w-16 text-primary animate-spin"}),title:"",description:`... (${l}/${r})`,tip:" ..."},success:{icon:e.jsx(bt,{className:"h-16 w-16 text-green-500"}),title:"",description:"...",tip:" "},failed:{icon:e.jsx(Ct,{className:"h-16 w-16 text-destructive"}),title:"",description:"",tip:" "}})[a];function er({visible:a,onComplete:l,onFailed:r,title:c,description:d,showAnimation:u=!0,className:h}){const f=B1();return(f?f.isRestarting:a)?f?e.jsx(Tv,{state:f.state,onRetry:f.retryHealthCheck,onComplete:l,onFailed:r,title:c,description:d,showAnimation:u,className:h}):e.jsx(P1,{onComplete:l,onFailed:r,title:c,description:d,showAnimation:u,className:h}):null}function Tv({state:a,onRetry:l,onComplete:r,onFailed:c,title:d,description:u,showAnimation:h,className:f}){const{status:p,progress:g,elapsedTime:b,checkAttempts:j,maxAttempts:y}=a;m.useEffect(()=>{p==="success"&&r?r():p==="failed"&&c&&c()},[p,r,c]);const N=I1(p,j,y,d,u),w=M=>{const A=Math.floor(M/60),S=M%60;return`${A}:${S.toString().padStart(2,"0")}`};return e.jsxs("div",{className:F("fixed inset-0 bg-background/95 backdrop-blur-sm z-50 flex items-center justify-center",f),children:[h&&e.jsx(F1,{}),e.jsxs("div",{className:"max-w-md w-full mx-4 space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[N.icon,(p==="restarting"||p==="checking")&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/20 animate-ping"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:N.title}),e.jsx("p",{className:"text-muted-foreground text-center",children:N.description})]}),p!=="failed"&&p!=="idle"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Xn,{value:g,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[g,"%"]}),e.jsxs("span",{children:[": ",w(b)]})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:N.tip})}),p==="failed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{onClick:()=>window.location.reload(),variant:"default",className:"flex-1",children:[e.jsx(xt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:l,variant:"secondary",className:"flex-1",children:[e.jsx(lc,{className:"mr-2 h-4 w-4"}),""]})]})]})]})}function P1({onComplete:a,onFailed:l,title:r,description:c,showAnimation:d,className:u}){const[h,f]=m.useState({status:"restarting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:60}),p=m.useCallback(()=>{let g=0;const b=60,j=async()=>{g++,f(y=>({...y,status:"checking",checkAttempts:g}));try{if((await fetch("/api/webui/system/status",{method:"GET",signal:AbortSignal.timeout(3e3)})).ok){f(N=>({...N,status:"success",progress:100})),setTimeout(()=>{a?.(),window.location.href="/auth"},1500);return}}catch{}g>=b?(f(y=>({...y,status:"failed"})),l?.()):setTimeout(j,2e3)};j()},[a,l]);return m.useEffect(()=>{const g=setInterval(()=>{f(y=>({...y,progress:y.progress>=90?y.progress:y.progress+1}))},200),b=setInterval(()=>{f(y=>({...y,elapsedTime:y.elapsedTime+1}))},1e3),j=setTimeout(()=>{p()},3e3);return()=>{clearInterval(g),clearInterval(b),clearTimeout(j)}},[p]),e.jsx(Tv,{state:h,onRetry:p,onComplete:a,onFailed:l,title:r,description:c,showAnimation:d,className:u})}function F1(){return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite]"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_0.5s]"}),e.jsx("div",{className:"absolute inset-16 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_1s]"})]}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-bounce"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-primary/15 rounded-full animate-bounce delay-150"}),e.jsx("div",{className:"absolute top-1/2 right-1/3 w-2 h-2 bg-primary/20 rounded-full animate-bounce delay-300"})]})}const Fs=Ww,cd=e_,H1=Xw,Ev=m.forwardRef(({className:a,...l},r)=>e.jsx(Rj,{ref:r,className:F("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l}));Ev.displayName=Rj.displayName;const Us=m.forwardRef(({className:a,children:l,preventOutsideClose:r=!1,...c},d)=>e.jsxs(H1,{children:[e.jsx(Ev,{}),e.jsxs(Dj,{ref:d,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),onPointerDownOutside:r?u=>u.preventDefault():void 0,onInteractOutside:r?u=>u.preventDefault():void 0,...c,children:[l,e.jsxs(Zw,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Aa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Us.displayName=Dj.displayName;const $s=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col space-y-1.5 text-center sm:text-left",a),...l});$s.displayName="DialogHeader";const nt=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...l});nt.displayName="DialogFooter";const Bs=m.forwardRef(({className:a,...l},r)=>e.jsx(Oj,{ref:r,className:F("text-lg font-semibold leading-none tracking-tight",a),...l}));Bs.displayName=Oj.displayName;const Xs=m.forwardRef(({className:a,...l},r)=>e.jsx(Lj,{ref:r,className:F("text-sm text-muted-foreground",a),...l}));Xs.displayName=Lj.displayName;const ae=m.forwardRef(({className:a,type:l,...r},c)=>e.jsx("input",{type:l,className:F("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:c,...r}));ae.displayName="Input";const Js=m.forwardRef(({className:a,...l},r)=>e.jsx(Uj,{ref:r,className:F("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:e.jsx(s_,{className:F("grid place-content-center text-current"),children:e.jsx(Mt,{className:"h-4 w-4"})})}));Js.displayName=Uj.displayName;const Pe=i_,Fe=c_,Be=m.forwardRef(({className:a,children:l,...r},c)=>e.jsxs($j,{ref:c,className:F("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[l,e.jsx(t_,{asChild:!0,children:e.jsx(za,{className:"h-4 w-4 opacity-50"})})]}));Be.displayName=$j.displayName;const Mv=m.forwardRef(({className:a,...l},r)=>e.jsx(Bj,{ref:r,className:F("flex cursor-default items-center justify-center py-1",a),...l,children:e.jsx(Qr,{className:"h-4 w-4"})}));Mv.displayName=Bj.displayName;const Av=m.forwardRef(({className:a,...l},r)=>e.jsx(Ij,{ref:r,className:F("flex cursor-default items-center justify-center py-1",a),...l,children:e.jsx(za,{className:"h-4 w-4"})}));Av.displayName=Ij.displayName;const Ie=m.forwardRef(({className:a,children:l,position:r="popper",...c},d)=>e.jsx(a_,{children:e.jsxs(Pj,{ref:d,className:F("relative z-[100] max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-hidden rounded-md border border-border bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...c,children:[e.jsx(Mv,{}),e.jsx(l_,{className:F("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),e.jsx(Av,{})]})}));Ie.displayName=Pj.displayName;const V1=m.forwardRef(({className:a,...l},r)=>e.jsx(Fj,{ref:r,className:F("px-2 py-1.5 text-sm font-semibold",a),...l}));V1.displayName=Fj.displayName;const W=m.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(Hj,{ref:c,className:F("relative flex w-full cursor-default select-none items-center rounded-sm py-2 pl-2 pr-8 text-sm outline-none bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-gray-100 dark:focus:bg-gray-800 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(n_,{children:e.jsx(Mt,{className:"h-4 w-4"})})}),e.jsx(r_,{children:l})]}));W.displayName=Hj.displayName;const G1=m.forwardRef(({className:a,...l},r)=>e.jsx(Vj,{ref:r,className:F("-mx-1 my-1 h-px bg-muted",a),...l}));G1.displayName=Vj.displayName;const dx=({className:a,...l})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:F("mx-auto flex w-full justify-center",a),...l});dx.displayName="Pagination";const ux=m.forwardRef(({className:a,...l},r)=>e.jsx("ul",{ref:r,className:F("flex flex-row items-center gap-1",a),...l}));ux.displayName="PaginationContent";const qn=m.forwardRef(({className:a,...l},r)=>e.jsx("li",{ref:r,className:F("",a),...l}));qn.displayName="PaginationItem";const pc=({className:a,isActive:l,size:r="icon",...c})=>e.jsx("a",{"aria-current":l?"page":void 0,className:F(Zr({variant:l?"outline":"ghost",size:r}),a),...c});pc.displayName="PaginationLink";const zv=({className:a,...l})=>e.jsxs(pc,{"aria-label":"Go to previous page",size:"default",className:F("gap-1 pl-2.5",a),...l,children:[e.jsx(Da,{className:"h-4 w-4"}),e.jsx("span",{children:""})]});zv.displayName="PaginationPrevious";const Rv=({className:a,...l})=>e.jsxs(pc,{"aria-label":"Go to next page",size:"default",className:F("gap-1 pr-2.5",a),...l,children:[e.jsx("span",{children:""}),e.jsx(sa,{className:"h-4 w-4"})]});Rv.displayName="PaginationNext";const Dv=({className:a,...l})=>e.jsxs("span",{"aria-hidden":!0,className:F("flex h-9 w-9 items-center justify-center",a),...l,children:[e.jsx(v_,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});Dv.displayName="PaginationEllipsis";const q1=5,K1=5e3;let Om=0;function Q1(){return Om=(Om+1)%Number.MAX_SAFE_INTEGER,Om.toString()}const Lm=new Map,Ag=a=>{if(Lm.has(a))return;const l=setTimeout(()=>{Lm.delete(a),sc({type:"REMOVE_TOAST",toastId:a})},K1);Lm.set(a,l)},Y1=(a,l)=>{switch(l.type){case"ADD_TOAST":return{...a,toasts:[l.toast,...a.toasts].slice(0,q1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(r=>r.id===l.toast.id?{...r,...l.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=l;return r?Ag(r):a.toasts.forEach(c=>{Ag(c.id)}),{...a,toasts:a.toasts.map(c=>c.id===r||r===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return l.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(r=>r.id!==l.toastId)}}},Io=[];let Po={toasts:[]};function sc(a){Po=Y1(Po,a),Io.forEach(l=>{l(Po)})}function Xt({...a}){const l=Q1(),r=d=>sc({type:"UPDATE_TOAST",toast:{...d,id:l}}),c=()=>sc({type:"DISMISS_TOAST",toastId:l});return sc({type:"ADD_TOAST",toast:{...a,id:l,open:!0,onOpenChange:d=>{d||c()}}}),{id:l,dismiss:c,update:r}}function Ws(){const[a,l]=m.useState(Po);return m.useEffect(()=>(Io.push(l),()=>{const r=Io.indexOf(l);r>-1&&Io.splice(r,1)}),[a]),{...a,toast:Xt,dismiss:r=>sc({type:"DISMISS_TOAST",toastId:r})}}const tl="/api/webui/expression";async function mx(){const a=await _e(`${tl}/chats`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function J1(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id);const r=await _e(`${tl}/list?${l}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function X1(a){const l=await _e(`${tl}/${a}`,{});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function Z1(a){const l=await _e(`${tl}/`,{method:"POST",body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function W1(a,l){const r=await _e(`${tl}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function e2(a){const l=await _e(`${tl}/${a}`,{method:"DELETE"});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function s2(a){const l=await _e(`${tl}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function t2(){const a=await _e(`${tl}/stats/summary`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function xx(){const a=await _e(`${tl}/review/stats`);if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function a2(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.filter_type&&l.append("filter_type",a.filter_type),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id);const r=await _e(`${tl}/review/list?${l}`);if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function zg(a){const l=await _e(`${tl}/review/batch`,{method:"POST",body:JSON.stringify({items:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function Ov({open:a,onOpenChange:l}){const[r,c]=m.useState(null),[d,u]=m.useState([]),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[b,j]=m.useState(0),[y,N]=m.useState(1),[w,M]=m.useState(20),[A,S]=m.useState(""),[U,E]=m.useState("unchecked"),[C,D]=m.useState(""),[P,O]=m.useState(""),[J,L]=m.useState(new Set),[oe,Ne]=m.useState(new Set),[je,de]=m.useState(new Map),{toast:he}=Ws(),ge=m.useCallback(async()=>{try{g(!0);const Y=await xx();c(Y)}catch(Y){console.error(":",Y)}finally{g(!1)}},[]),R=m.useCallback(async()=>{try{f(!0);const Y=await a2({page:y,page_size:w,filter_type:U,search:C||void 0});u(Y.data),j(Y.total)}catch(Y){he({title:"",description:Y instanceof Error?Y.message:"",variant:"destructive"})}finally{f(!1)}},[y,w,U,C,he]),Q=m.useCallback(async()=>{try{const Y=await mx();if(Y?.data){const $e=new Map;Y.data.forEach(H=>{$e.set(H.chat_id,H.chat_name)}),de($e)}}catch(Y){console.error(":",Y)}},[]);m.useEffect(()=>{a&&(ge(),R(),Q())},[a,ge,R,Q]),m.useEffect(()=>{N(1),L(new Set)},[U,C]);const $=()=>{D(P),N(1)},ue=Y=>je.get(Y)||Y,G=async(Y,$e)=>{try{Ne(se=>new Set(se).add(Y));const H=await zg([{id:Y,rejected:$e,require_unchecked:U==="unchecked"}]);H.results[0]?.success?(he({title:$e?"":"",description:` #${Y} ${$e?"":""}`}),R(),ge()):he({title:"",description:H.results[0]?.message||"",variant:"destructive"})}catch(H){he({title:"",description:H instanceof Error?H.message:"",variant:"destructive"})}finally{Ne(H=>{const se=new Set(H);return se.delete(Y),se})}},Se=async Y=>{if(J.size===0){he({title:"",description:"",variant:"destructive"});return}try{f(!0);const $e=Array.from(J).map(se=>({id:se,rejected:Y,require_unchecked:U==="unchecked"})),H=await zg($e);he({title:"",description:` ${H.succeeded}  ${H.failed} `,variant:H.failed>0?"destructive":"default"}),L(new Set),R(),ge()}catch($e){he({title:"",description:$e instanceof Error?$e.message:"",variant:"destructive"})}finally{f(!1)}},fe=()=>{J.size===d.length?L(new Set):L(new Set(d.map(Y=>Y.id)))},Te=Y=>{L($e=>{const H=new Set($e);return H.has(Y)?H.delete(Y):H.add(Y),H})},q=Y=>Y?new Date(Y*1e3).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",B=Y=>Y.checked?Y.rejected?e.jsxs(Ce,{variant:"destructive",className:"gap-1",children:[e.jsx(Ka,{className:"h-3 w-3"}),""]}):e.jsxs(Ce,{variant:"default",className:"gap-1 bg-green-600",children:[e.jsx(bt,{className:"h-3 w-3"}),""]}):e.jsxs(Ce,{variant:"outline",className:"gap-1",children:[e.jsx(na,{className:"h-3 w-3"}),""]}),z=Y=>Y?Y==="ai"?e.jsxs(Ce,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(Vn,{className:"h-3 w-3"}),"AI"]}):e.jsxs(Ce,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(jn,{className:"h-3 w-3"}),""]}):null,K=Math.ceil(b/w),Ae=()=>{const Y=[];if(K<=7)for(let $e=1;$e<=K;$e++)Y.push($e);else{Y.push(1),y>3&&Y.push("ellipsis");const $e=Math.max(2,y-1),H=Math.min(K-1,y+1);for(let se=$e;se<=H;se++)Y.push(se);y<K-2&&Y.push("ellipsis"),K>1&&Y.push(K)}return Y},ee=()=>{const Y=parseInt(A,10);!isNaN(Y)&&Y>=1&&Y<=K&&(N(Y),S(""))};return e.jsx(Fs,{open:a,onOpenChange:l,children:e.jsxs(Us,{className:"max-w-5xl w-[95vw] sm:w-full h-[90vh] sm:h-[85vh] flex flex-col p-0",children:[e.jsxs($s,{className:"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b shrink-0",children:[e.jsx(Bs,{className:"text-lg sm:text-xl",children:""}),e.jsx(Xs,{className:"text-xs sm:text-sm",children:""}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mt-4",children:[e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-orange-500",children:p?"-":r?.unchecked??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-500",children:p?"-":r?.passed??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-500",children:p?"-":r?.rejected??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-500",children:p?"-":r?.total??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b shrink-0 space-y-3",children:[e.jsx(ea,{value:U,onValueChange:Y=>E(Y),className:"w-full",children:e.jsxs(Gt,{className:"grid w-full grid-cols-4",children:[e.jsxs(Xe,{value:"unchecked",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(na,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.unchecked??0,")"]})]}),e.jsxs(Xe,{value:"passed",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(bt,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.passed??0,")"]})]}),e.jsxs(Xe,{value:"rejected",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(Ka,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.rejected??0,")"]})]}),e.jsxs(Xe,{value:"all",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx("span",{children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r?.total??0,")"]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:P,onChange:Y=>O(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&$(),className:"pl-9"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:$,children:e.jsx(At,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"icon",onClick:()=>{R(),ge()},disabled:h,children:e.jsx(xt,{className:F("h-4 w-4",h&&"animate-spin")})})]}),U==="unchecked"&&J.size>0&&e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>Se(!1),disabled:h,children:[e.jsx(bt,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",J.size,")"]}),e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>Se(!0),disabled:h,children:[e.jsx(Ka,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",J.size,")"]})]})]})]}),e.jsx(Ze,{className:"flex-1 px-4 sm:px-6",children:h&&d.length===0?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(xt,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-muted-foreground",children:[e.jsx(Ct,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:""})]}):e.jsxs("div",{className:"space-y-2 py-2",children:[U==="unchecked"&&d.length>0&&e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 rounded-lg bg-muted/50",children:[e.jsx(Js,{checked:J.size===d.length&&d.length>0,onCheckedChange:fe}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" (",d.length," )"]})]}),d.map(Y=>e.jsx("div",{className:F("rounded-lg border p-3 sm:p-4 space-y-2 sm:space-y-3 transition-colors",J.has(Y.id)&&"bg-accent border-primary",oe.has(Y.id)&&"opacity-50"),children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[U==="unchecked"&&e.jsx(Js,{checked:J.has(Y.id),onCheckedChange:()=>Te(Y.id),disabled:oe.has(Y.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm font-medium break-words",children:Y.situation})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground break-words",children:Y.style})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["#",Y.id]}),e.jsx("span",{children:""}),e.jsx("span",{title:ue(Y.chat_id),className:"truncate max-w-24 sm:max-w-32",children:ue(Y.chat_id)}),e.jsx("span",{children:""}),e.jsx("span",{children:q(Y.create_date)}),e.jsxs("div",{className:"flex items-center gap-1",children:[B(Y),z(Y.modified_by)]})]})]}),e.jsx("div",{className:"flex flex-col gap-1 sm:gap-2 shrink-0",children:U==="unchecked"?e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(bt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]}):U==="passed"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):U==="rejected"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(bt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsx(e.Fragment,{children:Y.rejected?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(bt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):Y.checked?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!1),disabled:oe.has(Y.id),children:[e.jsx(bt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>G(Y.id,!0),disabled:oe.has(Y.id),children:[e.jsx(Ka,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})})})]})},Y.id))]})}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-t shrink-0 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs(Pe,{value:w.toString(),onValueChange:Y=>{M(parseInt(Y,10)),N(1)},children:[e.jsx(Be,{className:"w-[70px] h-8",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs("span",{className:"text-muted-foreground",children:[" ",b," "]})]}),e.jsx(dx,{className:"mx-0 w-auto",children:e.jsxs(ux,{children:[e.jsx(qn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>N(Y=>Math.max(1,Y-1)),disabled:y<=1||h,children:e.jsx(Da,{className:"h-4 w-4"})})}),Ae().map((Y,$e)=>e.jsx(qn,{children:Y==="ellipsis"?e.jsx(Dv,{}):e.jsx(pc,{href:"#",isActive:Y===y,onClick:H=>{H.preventDefault(),N(Y)},className:"h-8 w-8 cursor-pointer",children:Y})},$e)),e.jsx(qn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>N(Y=>Math.min(K,Y+1)),disabled:y>=K||h,children:e.jsx(sa,{className:"h-4 w-4"})})})]})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(ae,{type:"number",min:1,max:K,value:A,onChange:Y=>S(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&ee(),className:"w-16 h-8 text-center",placeholder:y.toString()}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(_,{variant:"outline",size:"sm",className:"h-8",onClick:ee,disabled:h,children:""})]})]})]})})}function l2(){return e.jsx(Wn,{children:e.jsx(r2,{})})}const n2=a=>{const l=[];for(let r=0;r<a;r++){const c=r*137.508%360;l.push(`hsl(${c}, 70%, 55%)`)}return l};function r2(){const[a,l]=m.useState(null),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(24),[p,g]=m.useState(!0),[b,j]=m.useState(null),[y,N]=m.useState(!0),[w,M]=m.useState(null),[A,S]=m.useState(!1),[U,E]=m.useState(0),{triggerRestart:C,isRestarting:D}=yn(),P=m.useRef(!0),O=m.useRef(null);m.useEffect(()=>(P.current=!0,()=>{P.current=!1,O.current&&(clearInterval(O.current),O.current=null)}),[]);const J=m.useCallback(async()=>{try{const z=await xx();P.current&&E(z.unchecked)}catch(z){console.error(":",z)}},[]),L=m.useCallback(async()=>{try{N(!0);const z=await iw.get("https://v1.hitokoto.cn/?c=a&c=b&c=c&c=d&c=h&c=i&c=k");P.current&&j({hitokoto:z.data.hitokoto,from:z.data.from||z.data.from_who||""})}catch(z){console.error(":",z),P.current&&j({hitokoto:"",from:""})}finally{P.current&&N(!1)}},[]),oe=m.useCallback(async()=>{try{const z=await _e("/api/webui/system/status");if(!P.current)return;if(z.ok){const K=await z.json();M(K)}else M(null)}catch(z){console.error(":",z),P.current&&M(null)}},[]),Ne=async()=>{await C()},je=m.useCallback(async()=>{try{const z=await _e(`/api/webui/statistics/dashboard?hours=${h}`);if(!P.current)return;if(z.ok){const K=await z.json();l(K)}c(!1),u(100)}catch(z){console.error("Failed to fetch dashboard data:",z),P.current&&(c(!1),u(100))}},[h]);if(m.useEffect(()=>{if(!r)return;u(0);const z=setTimeout(()=>u(15),200),K=setTimeout(()=>u(30),800),Ae=setTimeout(()=>u(45),2e3),ee=setTimeout(()=>u(60),4e3),Y=setTimeout(()=>u(75),6500),$e=setTimeout(()=>u(85),9e3),H=setTimeout(()=>u(92),11e3);return()=>{clearTimeout(z),clearTimeout(K),clearTimeout(Ae),clearTimeout(ee),clearTimeout(Y),clearTimeout($e),clearTimeout(H)}},[r]),m.useEffect(()=>{je(),L(),oe(),J()},[je,L,oe,J]),m.useEffect(()=>{if(O.current&&(clearInterval(O.current),O.current=null),!!p)return O.current=setInterval(()=>{P.current&&(je(),oe())},3e4),()=>{O.current&&(clearInterval(O.current),O.current=null)}},[p,je,oe]),r||!a)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"text-center space-y-6 w-full max-w-md px-4",children:[e.jsx(xt,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Xn,{value:d,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d,"%"]})]})]})});const{summary:de,model_stats:he=[],hourly_data:ge=[],daily_data:R=[],recent_activity:Q=[]}=a,$=de??{total_requests:0,total_cost:0,total_tokens:0,online_time:0,total_messages:0,total_replies:0,avg_response_time:0,cost_per_hour:0,tokens_per_hour:0},ue=z=>{const K=Math.floor(z/3600),Ae=Math.floor(z%3600/60);return`${K}${Ae}`},G=z=>{const K=z.toLocaleString("zh-CN");return z>=1e9?{display:`${(z/1e9).toFixed(2)}B`,exact:K,needsExact:!0}:z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:K,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:K,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:K,needsExact:!0}:{display:K,exact:K,needsExact:!1}},Se=z=>{const K=`${z.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:K,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:K,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:K,needsExact:!0}:{display:K,exact:K,needsExact:!1}},fe=z=>new Date(z).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Te=n2(he.length),q=he.map((z,K)=>({name:z.model_name,value:z.request_count,fill:Te[K]})),B={requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"},tokens:{label:"Tokens",color:"hsl(var(--chart-3))"}};return e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ea,{value:h.toString(),onValueChange:z=>f(Number(z)),children:e.jsxs(Gt,{className:"grid grid-cols-3 w-full sm:w-auto",children:[e.jsx(Xe,{value:"24",children:"24"}),e.jsx(Xe,{value:"168",children:"7"}),e.jsx(Xe,{value:"720",children:"30"})]})}),e.jsxs(_,{variant:p?"default":"outline",size:"sm",onClick:()=>g(!p),className:"gap-2",children:[e.jsx(xt,{className:`h-4 w-4 ${p?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:je,children:e.jsx(xt,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg border border-dashed border-muted-foreground/30 bg-muted/20",children:[y?e.jsx(ws,{className:"h-5 flex-1"}):b?e.jsxs("p",{className:"flex-1 text-sm text-muted-foreground italic truncate",children:['"',b.hitokoto,'"  ',b.from]}):null,e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:L,disabled:y,children:e.jsx(xt,{className:`h-3.5 w-3.5 ${y?"animate-spin":""}`})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-3",children:[e.jsxs(ke,{className:"lg:col-span-1",children:[e.jsx(Re,{className:"pb-3",children:e.jsxs(De,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hc,{className:"h-4 w-4"}),""]})}),e.jsx(Me,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:w?.running?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500 animate-pulse"}),e.jsxs(Ce,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[e.jsx(bt,{className:"h-3 w-3 mr-1"}),""]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500"}),e.jsxs(Ce,{variant:"outline",className:"text-red-600 border-red-300 bg-red-50",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]})]})}),w&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{children:["v",w.version]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{children:[" ",ue(w.uptime)]})]})]})})]}),e.jsxs(ke,{children:[e.jsx(Re,{className:"pb-3",children:e.jsxs(De,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]})}),e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:Ne,disabled:D,className:"gap-2",children:[e.jsx(lc,{className:`h-4 w-4 ${D?"animate-spin":""}`}),D?"...":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>S(!0),className:"gap-2",children:[e.jsx(ev,{className:"h-4 w-4"}),"",U>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:U>99?"99+":U})]}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/logs",children:[e.jsx(Ea,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/plugins",children:[e.jsx(N_,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/settings",children:[e.jsx(vn,{className:"h-4 w-4"}),""]})})]})})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"pb-3",children:[e.jsxs(De,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(b_,{className:"h-4 w-4"}),""]}),e.jsx(is,{className:"text-xs",children:""})]}),e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/survey/webui-feedback",children:[e.jsx(Ea,{className:"h-4 w-4"}),"WebUI "]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Fn,{to:"/survey/maibot-feedback",children:[e.jsx(Ra,{className:"h-4 w-4"}),""]})})]})})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(tx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[G($.total_requests).display,G($.total_requests).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",G($.total_requests).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["",h<48?h+"":Math.floor(h/24)+""]})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(y_,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Se($.total_cost).display,Se($.total_cost).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",Se($.total_cost).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:$.cost_per_hour>0?`${$.cost_per_hour.toFixed(2)}/`:""})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:"Token"}),e.jsx(Yr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[G($.total_tokens).display,G($.total_tokens).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",G($.total_tokens).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:$.tokens_per_hour>0?`${G($.tokens_per_hour).display}/`:""})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(el,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[$.avg_response_time.toFixed(2),"s"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"API"})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(na,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"text-xl font-bold",children:[ue($.online_time),e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",$.online_time.toLocaleString(),")"]})]})})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-xl font-bold",children:[G($.total_messages).display,G($.total_messages).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",G($.total_messages).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",G($.total_replies).display,G($.total_replies).needsExact&&e.jsxs("span",{children:["(",G($.total_replies).exact,")"]})," "]})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(ax,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-xl font-bold",children:$.total_messages>0?`${($.total_cost/$.total_messages*100).toFixed(2)}`:"0.00"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"100"})]})]})]}),e.jsxs(ea,{defaultValue:"trends",className:"space-y-4",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[e.jsx(Xe,{value:"trends",children:""}),e.jsx(Xe,{value:"models",children:""}),e.jsx(Xe,{value:"activity",children:""}),e.jsx(Xe,{value:"daily",children:""})]}),e.jsxs(vs,{value:"trends",className:"space-y-4",children:[e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsxs(is,{children:["",h,""]})]}),e.jsx(Me,{children:e.jsx(Vr,{config:B,className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Gw,{data:ge,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>fe(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>fe(z)})}),e.jsx(qw,{type:"monotone",dataKey:"requests",stroke:"var(--color-requests)",strokeWidth:2})]})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:"API"})]}),e.jsx(Me,{children:e.jsx(Vr,{config:B,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:ge,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>fe(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>fe(z)})}),e.jsx(Ji,{dataKey:"cost",fill:"var(--color-cost)"})]})})})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:"Token"}),e.jsx(is,{children:"Token"})]}),e.jsx(Me,{children:e.jsx(Vr,{config:B,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:ge,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>fe(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>fe(z)})}),e.jsx(Ji,{dataKey:"tokens",fill:"var(--color-tokens)"})]})})})]})]})]}),e.jsx(vs,{value:"models",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsxs(is,{children:[" ( ",he.length," )"]})]}),e.jsx(Me,{children:e.jsx(Vr,{config:Object.fromEntries(he.map((z,K)=>[z.model_name,{label:z.model_name,color:Te[K]}])),className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Kw,{children:[e.jsx(qi,{content:e.jsx(Gr,{})}),e.jsx(Qw,{data:q,cx:"50%",cy:"50%",labelLine:!1,label:({name:z,percent:K})=>K&&K<.05?"":`${z} ${K?(K*100).toFixed(0):0}%`,outerRadius:100,dataKey:"value",children:q.map((z,K)=>e.jsx(Yw,{fill:z.fill},`cell-${K}`))})]})})})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:e.jsx(Ze,{className:"h-[300px] sm:h-[400px]",children:e.jsx("div",{className:"space-y-3",children:he.map((z,K)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm truncate flex-1 min-w-0",children:z.model_name}),e.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:`hsl(var(--chart-${K%5+1}))`}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-1 font-medium",children:z.request_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:["",z.total_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[(z.total_tokens/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:[z.avg_response_time.toFixed(2),"s"]})]})]})]},K))})})})]})]})}),e.jsx(vs,{value:"activity",children:e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:"API"})]}),e.jsx(Me,{children:e.jsx(Ze,{className:"h-[400px] sm:h-[500px]",children:e.jsx("div",{className:"space-y-2",children:Q.map((z,K)=>e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:z.model}),e.jsx("div",{className:"text-xs text-muted-foreground",children:z.request_type})]}),e.jsx("div",{className:"text-xs text-muted-foreground flex-shrink-0",children:fe(z.timestamp)})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsx("span",{className:"ml-1",children:z.tokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:["",z.cost.toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:[z.time_cost.toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:`ml-1 ${z.status==="success"?"text-green-600":"text-red-600"}`,children:z.status})]})]})]},K))})})})]})}),e.jsx(vs,{value:"daily",children:e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:"7"})]}),e.jsx(Me,{children:e.jsx(Vr,{config:{requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"}},className:"h-[400px] sm:h-[500px] w-full aspect-auto",children:e.jsxs(Uo,{data:R,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>{const K=new Date(z);return`${K.getMonth()+1}/${K.getDate()}`},stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{yAxisId:"left",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Hr,{yAxisId:"right",orientation:"right",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qi,{content:e.jsx(Gr,{labelFormatter:z=>new Date(z).toLocaleDateString("zh-CN")})}),e.jsx(O1,{content:e.jsx(kv,{})}),e.jsx(Ji,{yAxisId:"left",dataKey:"requests",fill:"var(--color-requests)"}),e.jsx(Ji,{yAxisId:"right",dataKey:"cost",fill:"var(--color-cost)"})]})})})]})})]}),e.jsx(er,{}),e.jsx(Ov,{open:A,onOpenChange:z=>{S(z),z||J()}})]})})}const i2={theme:"system",setTheme:()=>null},Lv=m.createContext(i2),hx=()=>{const a=m.useContext(Lv);if(a===void 0)throw new Error("useTheme must be used within a ThemeProvider");return a},c2=(a,l,r)=>{const c=document.documentElement.classList.contains("no-animations");if(!document.startViewTransition||c){l(a);return}const d=r.clientX,u=r.clientY,h=Math.hypot(Math.max(d,innerWidth-d),Math.max(u,innerHeight-u));document.startViewTransition(()=>{l(a)}).ready.then(()=>{document.documentElement.animate({clipPath:[`circle(0px at ${d}px ${u}px)`,`circle(${h}px at ${d}px ${u}px)`]},{duration:500,easing:"ease-in-out",pseudoElement:"::view-transition-new(root)"})})},Uv=m.createContext(void 0),$v=()=>{const a=m.useContext(Uv);if(a===void 0)throw new Error("useAnimation must be used within an AnimationProvider");return a},Ge=m.forwardRef(({className:a,...l},r)=>e.jsx(hj,{className:F("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...l,ref:r,children:e.jsx(xw,{className:F("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ge.displayName=hj.displayName;const o2=Wr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),T=m.forwardRef(({className:a,...l},r)=>e.jsx(Gj,{ref:r,className:F(o2(),a),...l}));T.displayName=Gj.displayName;const d2=[{id:"minLength",label:" 10 ",description:"Token  10 ",validate:a=>a.length>=10},{id:"hasUppercase",label:"",description:" (A-Z)",validate:a=>/[A-Z]/.test(a)},{id:"hasLowercase",label:"",description:" (a-z)",validate:a=>/[a-z]/.test(a)},{id:"hasSpecialChar",label:"",description:" (!@#$%^&*()_+-=[]{}|;:,.<>?/)",validate:a=>/[!@#$%^&*()_+\-=[\]{}|;:,.<>?/]/.test(a)}];function u2(a){const l=d2.map(c=>({id:c.id,label:c.label,description:c.description,passed:c.validate(a)}));return{isValid:l.every(c=>c.passed),rules:l}}const od="0.12.2",fx="MaiBot Dashboard",m2=`${fx} v${od}`,x2=(a="v")=>`${a}${od}`,pa={THEME:"maibot-ui-theme",ACCENT_COLOR:"accent-color",ENABLE_ANIMATIONS:"maibot-animations",ENABLE_WAVES_BACKGROUND:"maibot-waves-background",LOG_CACHE_SIZE:"maibot-log-cache-size",LOG_AUTO_SCROLL:"maibot-log-auto-scroll",LOG_FONT_SIZE:"maibot-log-font-size",LOG_LINE_SPACING:"maibot-log-line-spacing",DATA_SYNC_INTERVAL:"maibot-data-sync-interval",WS_RECONNECT_INTERVAL:"maibot-ws-reconnect-interval",WS_MAX_RECONNECT_ATTEMPTS:"maibot-ws-max-reconnect-attempts",COMPLETED_TOURS:"maibot-completed-tours"},dl={theme:"system",accentColor:"blue",enableAnimations:!0,enableWavesBackground:!0,logCacheSize:1e3,logAutoScroll:!0,logFontSize:"xs",logLineSpacing:4,dataSyncInterval:30,wsReconnectInterval:3e3,wsMaxReconnectAttempts:10};function kt(a){const l=Bv(a),r=localStorage.getItem(l);if(r===null)return dl[a];const c=dl[a];if(typeof c=="boolean")return r==="true";if(typeof c=="number"){const d=parseFloat(r);return isNaN(d)?c:d}return r}function qr(a,l){const r=Bv(a);localStorage.setItem(r,String(l)),window.dispatchEvent(new CustomEvent("maibot-settings-change",{detail:{key:a,value:l}}))}function h2(){return{theme:kt("theme"),accentColor:kt("accentColor"),enableAnimations:kt("enableAnimations"),enableWavesBackground:kt("enableWavesBackground"),logCacheSize:kt("logCacheSize"),logAutoScroll:kt("logAutoScroll"),logFontSize:kt("logFontSize"),logLineSpacing:kt("logLineSpacing"),dataSyncInterval:kt("dataSyncInterval"),wsReconnectInterval:kt("wsReconnectInterval"),wsMaxReconnectAttempts:kt("wsMaxReconnectAttempts")}}function f2(){const a=h2(),l=localStorage.getItem(pa.COMPLETED_TOURS),r=l?JSON.parse(l):[];return{...a,completedTours:r}}function p2(a){const l=[],r=[];for(const[c,d]of Object.entries(a)){if(c==="completedTours"){Array.isArray(d)?(localStorage.setItem(pa.COMPLETED_TOURS,JSON.stringify(d)),l.push("completedTours")):r.push("completedTours");continue}if(c in dl){const u=c,h=dl[u];if(typeof d==typeof h){if(u==="theme"&&!["light","dark","system"].includes(d)){r.push(c);continue}if(u==="logFontSize"&&!["xs","sm","base"].includes(d)){r.push(c);continue}qr(u,d),l.push(c)}else r.push(c)}else r.push(c)}return{success:l.length>0,imported:l,skipped:r}}function g2(){for(const a of Object.keys(dl))qr(a,dl[a]);localStorage.removeItem(pa.COMPLETED_TOURS),window.dispatchEvent(new CustomEvent("maibot-settings-reset"))}function j2(){const a=[],l=[],r=[];for(let c=0;c<localStorage.length;c++){const d=localStorage.key(c);d&&(d.startsWith("maibot")||d.startsWith("accent-color")||d==="access-token")&&r.push(d)}for(const c of r)localStorage.removeItem(c),a.push(c);return{clearedKeys:a,preservedKeys:l}}function Rg(){let a=0;const l=[];for(let r=0;r<localStorage.length;r++){const c=localStorage.key(r);if(c){const d=localStorage.getItem(c)||"",u=(c.length+d.length)*2;a+=u,l.push({key:c,size:u})}}return l.sort((r,c)=>c.size-r.size),{used:a,items:localStorage.length,details:l}}function v2(a){if(a===0)return"0 B";const l=1024,r=["B","KB","MB"],c=Math.floor(Math.log(a)/Math.log(l));return parseFloat((a/Math.pow(l,c)).toFixed(2))+" "+r[c]}function Bv(a){return{theme:pa.THEME,accentColor:pa.ACCENT_COLOR,enableAnimations:pa.ENABLE_ANIMATIONS,enableWavesBackground:pa.ENABLE_WAVES_BACKGROUND,logCacheSize:pa.LOG_CACHE_SIZE,logAutoScroll:pa.LOG_AUTO_SCROLL,logFontSize:pa.LOG_FONT_SIZE,logLineSpacing:pa.LOG_LINE_SPACING,dataSyncInterval:pa.DATA_SYNC_INTERVAL,wsReconnectInterval:pa.WS_RECONNECT_INTERVAL,wsMaxReconnectAttempts:pa.WS_MAX_RECONNECT_ATTEMPTS}[a]}const Qa=m.forwardRef(({className:a,...l},r)=>e.jsxs(fj,{ref:r,className:F("relative flex w-full touch-none select-none items-center",a),...l,children:[e.jsx(hw,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(fw,{className:"absolute h-full bg-primary"})}),e.jsx(pw,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Qa.displayName=fj.displayName;class N2{ws=null;reconnectTimeout=null;reconnectAttempts=0;heartbeatInterval=null;logCallbacks=new Set;connectionCallbacks=new Set;isConnected=!1;logCache=[];getMaxCacheSize(){return kt("logCacheSize")}getMaxReconnectAttempts(){return kt("wsMaxReconnectAttempts")}getReconnectInterval(){return kt("wsReconnectInterval")}getWebSocketUrl(l){let r;{const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host;r=`${c}//${d}/ws/logs`}return l?`${r}?token=${encodeURIComponent(l)}`:r}async getWsToken(){try{const l=await _e("/api/webui/ws-token",{method:"GET",credentials:"include"});if(!l.ok)return console.error(" WebSocket token :",l.status),null;const r=await l.json();return r.success&&r.token?r.token:null}catch(l){return console.error(" WebSocket token :",l),null}}async connect(){if(this.ws?.readyState===WebSocket.OPEN||this.ws?.readyState===WebSocket.CONNECTING)return;if(window.location.pathname==="/auth"){console.log("  WebSocket ");return}if(!await cc()){console.log("  WebSocket ");return}const r=await this.getWsToken();if(!r){console.log("  WebSocket token");return}const c=this.getWebSocketUrl(r);try{this.ws=new WebSocket(c),this.ws.onopen=()=>{this.isConnected=!0,this.reconnectAttempts=0,this.notifyConnection(!0),this.startHeartbeat()},this.ws.onmessage=d=>{try{if(d.data==="pong")return;const u=JSON.parse(d.data);this.notifyLog(u)}catch(u){console.error(":",u)}},this.ws.onerror=d=>{console.error(" WebSocket :",d),this.isConnected=!1,this.notifyConnection(!1)},this.ws.onclose=()=>{this.isConnected=!1,this.notifyConnection(!1),this.stopHeartbeat(),this.attemptReconnect()}}catch(d){console.error(" WebSocket :",d),this.attemptReconnect()}}attemptReconnect(){const l=this.getMaxReconnectAttempts();if(this.reconnectAttempts>=l)return;this.reconnectAttempts+=1;const r=this.getReconnectInterval(),c=Math.min(r*this.reconnectAttempts,3e4);this.reconnectTimeout=window.setTimeout(()=>{this.connect()},c)}startHeartbeat(){this.heartbeatInterval=window.setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.ws.send("ping")},3e4)}stopHeartbeat(){this.heartbeatInterval!==null&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}disconnect(){this.reconnectTimeout!==null&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.stopHeartbeat(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.reconnectAttempts=0}onLog(l){return this.logCallbacks.add(l),()=>this.logCallbacks.delete(l)}onConnectionChange(l){return this.connectionCallbacks.add(l),l(this.isConnected),()=>this.connectionCallbacks.delete(l)}notifyLog(l){if(!this.logCache.some(c=>c.id===l.id)){this.logCache.push(l);const c=this.getMaxCacheSize();this.logCache.length>c&&(this.logCache=this.logCache.slice(-c)),this.logCallbacks.forEach(d=>{try{d(l)}catch(u){console.error(":",u)}})}}notifyConnection(l){this.connectionCallbacks.forEach(r=>{try{r(l)}catch(c){console.error(":",c)}})}getAllLogs(){return[...this.logCache]}clearLogs(){this.logCache=[]}getConnectionStatus(){return this.isConnected}}const Hn=new N2;typeof window<"u"&&setTimeout(()=>{Hn.connect()},100);const gs=jw,jt=vw,b2=gw,Iv=m.forwardRef(({className:a,...l},r)=>e.jsx(pj,{className:F("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:r}));Iv.displayName=pj.displayName;const cs=m.forwardRef(({className:a,...l},r)=>e.jsxs(b2,{children:[e.jsx(Iv,{}),e.jsx(gj,{ref:r,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]}));cs.displayName=gj.displayName;const os=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col space-y-2 text-center sm:text-left",a),...l});os.displayName="AlertDialogHeader";const ds=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...l});ds.displayName="AlertDialogFooter";const us=m.forwardRef(({className:a,...l},r)=>e.jsx(jj,{ref:r,className:F("text-lg font-semibold",a),...l}));us.displayName=jj.displayName;const ms=m.forwardRef(({className:a,...l},r)=>e.jsx(vj,{ref:r,className:F("text-sm text-muted-foreground",a),...l}));ms.displayName=vj.displayName;const xs=m.forwardRef(({className:a,variant:l,...r},c)=>e.jsx(Nj,{ref:c,className:F(Zr({variant:l}),a),...r}));xs.displayName=Nj.displayName;const hs=m.forwardRef(({className:a,...l},r)=>e.jsx(bj,{ref:r,className:F(Zr({variant:"outline"}),"mt-2 sm:mt-0",a),...l}));hs.displayName=bj.displayName;function y2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]})}),e.jsxs(ea,{defaultValue:"appearance",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2 sm:grid-cols-4 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Xe,{value:"appearance",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(w_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"security",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(sv,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"other",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(vn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"about",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Vt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Ze,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(vs,{value:"appearance",className:"mt-0",children:e.jsx(w2,{})}),e.jsx(vs,{value:"security",className:"mt-0",children:e.jsx(_2,{})}),e.jsx(vs,{value:"other",className:"mt-0",children:e.jsx(S2,{})}),e.jsx(vs,{value:"about",className:"mt-0",children:e.jsx(k2,{})})]})]})]})}function Dg(a){const l=document.documentElement,c={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[a];if(c)l.style.setProperty("--primary",c.hsl),c.gradient?(l.style.setProperty("--primary-gradient",c.gradient),l.classList.add("has-gradient")):(l.style.removeProperty("--primary-gradient"),l.classList.remove("has-gradient"));else if(a.startsWith("#")){const d=u=>{u=u.replace("#","");const h=parseInt(u.substring(0,2),16)/255,f=parseInt(u.substring(2,4),16)/255,p=parseInt(u.substring(4,6),16)/255,g=Math.max(h,f,p),b=Math.min(h,f,p);let j=0,y=0;const N=(g+b)/2;if(g!==b){const w=g-b;switch(y=N>.5?w/(2-g-b):w/(g+b),g){case h:j=((f-p)/w+(f<p?6:0))/6;break;case f:j=((p-h)/w+2)/6;break;case p:j=((h-f)/w+4)/6;break}}return`${Math.round(j*360)} ${Math.round(y*100)}% ${Math.round(N*100)}%`};l.style.setProperty("--primary",d(a)),l.style.removeProperty("--primary-gradient"),l.classList.remove("has-gradient")}}function w2(){const{theme:a,setTheme:l}=hx(),{enableAnimations:r,setEnableAnimations:c,enableWavesBackground:d,setEnableWavesBackground:u}=$v(),[h,f]=m.useState(()=>localStorage.getItem("accent-color")||"blue");m.useEffect(()=>{const g=localStorage.getItem("accent-color")||"blue";Dg(g)},[]);const p=g=>{f(g),localStorage.setItem("accent-color",g),Dg(g)};return e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(Um,{value:"light",current:a,onChange:l,label:"",description:""}),e.jsx(Um,{value:"dark",current:a,onChange:l,label:"",description:""}),e.jsx(Um,{value:"system",current:a,onChange:l,label:"",description:""})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(qa,{value:"blue",current:h,onChange:p,label:"",colorClass:"bg-blue-500"}),e.jsx(qa,{value:"purple",current:h,onChange:p,label:"",colorClass:"bg-purple-500"}),e.jsx(qa,{value:"green",current:h,onChange:p,label:"",colorClass:"bg-green-500"}),e.jsx(qa,{value:"orange",current:h,onChange:p,label:"",colorClass:"bg-orange-500"}),e.jsx(qa,{value:"pink",current:h,onChange:p,label:"",colorClass:"bg-pink-500"}),e.jsx(qa,{value:"red",current:h,onChange:p,label:"",colorClass:"bg-red-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(qa,{value:"gradient-sunset",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-orange-500 to-pink-500"}),e.jsx(qa,{value:"gradient-ocean",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-500"}),e.jsx(qa,{value:"gradient-forest",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-green-500 to-emerald-500"}),e.jsx(qa,{value:"gradient-aurora",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-purple-500 to-pink-500"}),e.jsx(qa,{value:"gradient-fire",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-red-500 to-orange-500"}),e.jsx(qa,{value:"gradient-twilight",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"color",value:h.startsWith("#")?h:"#3b82f6",onChange:g=>p(g.target.value),className:"h-10 sm:h-12 w-full rounded-lg border-2 border-border cursor-pointer",title:""})}),e.jsx("div",{className:"flex-1",children:e.jsx(ae,{type:"text",value:h,onChange:g=>p(g.target.value),placeholder:"#3b82f6",className:"font-mono text-sm"})})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-2",children:" HEX "})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"animations",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"animations",checked:r,onCheckedChange:c})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"waves-background",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"waves-background",checked:d,onCheckedChange:u})]})})]})]})]})}function _2(){const a=ca(),[l,r]=m.useState(""),[c,d]=m.useState(""),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[g,b]=m.useState(!1),[j,y]=m.useState(!1),[N,w]=m.useState(!1),[M,A]=m.useState(!1),[S,U]=m.useState(""),[E,C]=m.useState(!1),{toast:D}=Ws(),P=m.useMemo(()=>u2(c),[c]),O=async de=>{if(!l){D({title:"",description:"Token  Cookie  Token",variant:"destructive"});return}try{await navigator.clipboard.writeText(de),w(!0),D({title:"",description:"Token "}),setTimeout(()=>w(!1),2e3)}catch{D({title:"",description:" Token",variant:"destructive"})}},J=async()=>{if(!c.trim()){D({title:"",description:" Token",variant:"destructive"});return}if(!P.isValid){const de=P.rules.filter(he=>!he.passed).map(he=>he.label).join(", ");D({title:"",description:`Token : ${de}`,variant:"destructive"});return}b(!0);try{const de=await fetch("/api/webui/auth/update",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({new_token:c.trim()})}),he=await de.json();de.ok&&he.success?(d(""),r(c.trim()),D({title:"",description:"Access Token "}),setTimeout(()=>{a({to:"/auth"})},1500)):D({title:"",description:he.message||" Token",variant:"destructive"})}catch(de){console.error(" Token :",de),D({title:"",description:"",variant:"destructive"})}finally{b(!1)}},L=async()=>{y(!0);try{const de=await fetch("/api/webui/auth/regenerate",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),he=await de.json();de.ok&&he.success?(r(he.token),U(he.token),A(!0),C(!1),D({title:"",description:" Access Token "})):D({title:"",description:he.message||" Token",variant:"destructive"})}catch(de){console.error(" Token :",de),D({title:"",description:"",variant:"destructive"})}finally{y(!1)}},oe=async()=>{try{await navigator.clipboard.writeText(S),C(!0),D({title:"",description:"Token "})}catch{D({title:"",description:" Token",variant:"destructive"})}},Ne=()=>{A(!1),setTimeout(()=>{U(""),C(!1)},300),setTimeout(()=>{a({to:"/auth"})},500)},je=de=>{de||Ne()};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(Fs,{open:M,onOpenChange:je,children:e.jsxs(Us,{className:"sm:max-w-md",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-5 w-5 text-yellow-500"})," Access Token"]}),e.jsx(Xs,{children:" Token"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-2 border-primary/20 bg-primary/5 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-2 block",children:" Token (64)"}),e.jsx("div",{className:"font-mono text-sm break-all select-all bg-background p-3 rounded border",children:S})]}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(It,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token "}),e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:" Token "})]})]})]})})]}),e.jsxs(nt,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:oe,className:"gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"h-4 w-4"})," Token"]})}),e.jsx(_,{onClick:Ne,children:""})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"current-token",className:"text-sm",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ae,{id:"current-token",type:u?"text":"password",value:l||"",readOnly:!0,className:"pr-10 font-mono text-sm",placeholder:"Token  Cookie "}),e.jsx("button",{onClick:()=>{l?h(!u):D({title:"",description:'Token  Cookie  Token ""'})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:u?"":"",children:u?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:()=>O(l),title:"",className:"flex-shrink-0",disabled:!l,children:N?e.jsx(Mt,{className:"h-4 w-4 text-green-500"}):e.jsx(Fo,{className:"h-4 w-4"})}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:j,className:"gap-2 flex-1 sm:flex-none",children:[e.jsx(xt,{className:F("h-4 w-4",j&&"animate-spin")}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:" Token"}),e.jsx(ms,{children:" 64  Token   Token "})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:L,children:""})]})]})]})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:" Access Token"})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"new-token",className:"text-sm",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{id:"new-token",type:f?"text":"password",value:c,onChange:de=>d(de.target.value),className:"pr-10 font-mono text-sm",placeholder:" Token"}),e.jsx("button",{onClick:()=>p(!f),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:f?"":"",children:f?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),c&&e.jsxs("div",{className:"mt-3 space-y-2 p-3 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Token :"}),e.jsx("div",{className:"space-y-1.5",children:P.rules.map(de=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[de.passed?e.jsx(bt,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(Ka,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:F(de.passed?"text-green-600 dark:text-green-400":"text-muted-foreground"),children:de.label})]},de.id))}),P.isValid&&e.jsx("div",{className:"mt-2 pt-2 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(Mt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Token "})]})})]})]}),e.jsx(_,{onClick:J,disabled:g||!P.isValid||!c,className:"w-full sm:w-auto",children:g?"...":" Token"})]})]}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3 sm:p-4",children:[e.jsx("h4",{className:"text-sm sm:text-base font-semibold text-yellow-900 dark:text-yellow-200 mb-2",children:""}),e.jsxs("ul",{className:"text-xs sm:text-sm text-yellow-800 dark:text-yellow-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:" Token  64 "}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token  Token "}),e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token "})]})]})]})}function S2(){const a=ca(),{toast:l}=Ws(),[r,c]=m.useState(!1),[d,u]=m.useState(!1),[h,f]=m.useState(()=>kt("logCacheSize")),[p,g]=m.useState(()=>kt("wsReconnectInterval")),[b,j]=m.useState(()=>kt("wsMaxReconnectAttempts")),[y,N]=m.useState(()=>kt("dataSyncInterval")),[w,M]=m.useState(()=>Rg()),[A,S]=m.useState(!1),[U,E]=m.useState(!1),C=m.useRef(null);if(d)throw new Error("");const D=()=>{M(Rg())},P=R=>{const Q=R[0];f(Q),qr("logCacheSize",Q)},O=R=>{const Q=R[0];g(Q),qr("wsReconnectInterval",Q)},J=R=>{const Q=R[0];j(Q),qr("wsMaxReconnectAttempts",Q)},L=R=>{const Q=R[0];N(Q),qr("dataSyncInterval",Q)},oe=()=>{Hn.clearLogs(),l({title:"",description:""})},Ne=()=>{const R=j2();D(),l({title:"",description:` ${R.clearedKeys.length} `})},je=()=>{S(!0);try{const R=f2(),Q=JSON.stringify(R,null,2),$=new Blob([Q],{type:"application/json"}),ue=URL.createObjectURL($),G=document.createElement("a");G.href=ue,G.download=`maibot-webui-settings-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(ue),l({title:"",description:" JSON "})}catch(R){console.error(":",R),l({title:"",description:"",variant:"destructive"})}finally{S(!1)}},de=R=>{const Q=R.target.files?.[0];if(!Q)return;E(!0);const $=new FileReader;$.onload=ue=>{try{const G=ue.target?.result,Se=JSON.parse(G),fe=p2(Se);fe.success?(f(kt("logCacheSize")),g(kt("wsReconnectInterval")),j(kt("wsMaxReconnectAttempts")),N(kt("dataSyncInterval")),D(),l({title:"",description:` ${fe.imported.length} ${fe.skipped.length>0?` ${fe.skipped.length} `:""}`}),(fe.imported.includes("theme")||fe.imported.includes("accentColor"))&&l({title:"",description:""})):l({title:"",description:"",variant:"destructive"})}catch(G){console.error(":",G),l({title:"",description:"",variant:"destructive"})}finally{E(!1),C.current&&(C.current.value="")}},$.readAsText(Q)},he=()=>{g2(),f(dl.logCacheSize),g(dl.wsReconnectInterval),j(dl.wsMaxReconnectAttempts),N(dl.dataSyncInterval),D(),l({title:"",description:""})},ge=async()=>{c(!0);try{const R=await _e("/api/webui/setup/reset",{method:"POST"}),Q=await R.json();R.ok&&Q.success?(l({title:"",description:""}),setTimeout(()=>{a({to:"/setup"})},1e3)):l({title:"",description:Q.message||"",variant:"destructive"})}catch(R){console.error(":",R),l({title:"",description:"",variant:"destructive"})}finally{c(!1)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Yr,{className:"h-5 w-5"}),""]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(__,{className:"h-4 w-4"}),""]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:D,className:"h-7 px-2",children:e.jsx(xt,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:v2(w.used)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[w.items," "]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h," "]})]}),e.jsx(Qa,{value:[h],onValueChange:P,min:100,max:5e3,step:100,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y," "]})]}),e.jsx(Qa,{value:[y],onValueChange:L,min:10,max:120,step:5,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p/1e3," "]})]}),e.jsx(Qa,{value:[p],onValueChange:O,min:1e3,max:1e4,step:500,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" WebSocket "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[b," "]})]}),e.jsx(Qa,{value:[b],onValueChange:J,min:3,max:30,step:1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:oe,className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),""]}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{children:" "})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:Ne,children:""})]})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Wt,{className:"h-5 w-5"}),"/"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",onClick:je,disabled:A,className:"gap-2",children:[e.jsx(Wt,{className:"h-4 w-4"}),A?"...":""]}),e.jsx("input",{ref:C,type:"file",accept:".json",onChange:de,className:"hidden"}),e.jsxs(_,{variant:"outline",onClick:()=>C.current?.click(),disabled:U,className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),U?"...":""]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2 text-destructive hover:text-destructive",children:[e.jsx(lc,{className:"h-4 w-4"}),""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{children:" "})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:he,children:""})]})]})]})})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:r,className:"gap-2",children:[e.jsx(lc,{className:F("h-4 w-4",r&&"animate-spin")}),""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{children:""})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:ge,children:""})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-dashed border-yellow-500/50 bg-yellow-500/5 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(It,{className:"h-5 w-5 text-yellow-500"}),""]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{variant:"destructive",className:"gap-2",children:[e.jsx(It,{className:"h-4 w-4"}),""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{children:" React  "})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>u(!0),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})]})]})]})]})}function k2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"rounded-lg border-2 border-primary/30 bg-gradient-to-r from-primary/5 to-primary/10 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-shrink-0 rounded-lg bg-primary/10 p-2 sm:p-3",children:e.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3",children:" GitHub  Star  "}),e.jsxs("a",{href:"https://github.com/Mai-with-u/MaiBot-Dashboard",target:"_blank",rel:"noopener noreferrer",className:F("inline-flex items-center gap-2 px-4 py-2 rounded-lg","bg-primary text-primary-foreground font-medium text-sm","hover:bg-primary/90 transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})," GitHub",e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:[" ",fx]}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("p",{children:[": ",od]}),e.jsx("p",{children:"MaiBot Web "})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"MaiBot "}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Mai-with-u"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"WebUI"}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Mai-with-u ",e.jsx("a",{href:"https://github.com/DrSmoothl",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"@MotricSeven"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"React 19.2.0"}),e.jsx("li",{children:"TypeScript 5.7.2"}),e.jsx("li",{children:"Vite 6.0.7"}),e.jsx("li",{children:"TanStack Router 1.94.2"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:"UI "}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"shadcn/ui"}),e.jsx("li",{children:"Radix UI"}),e.jsx("li",{children:"Tailwind CSS 3.4.17"}),e.jsx("li",{children:"Lucide Icons"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Python 3.12+"}),e.jsx("li",{children:"FastAPI"}),e.jsx("li",{children:"Uvicorn"}),e.jsx("li",{children:"WebSocket"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Bun / npm"}),e.jsx("li",{children:"ESLint 9.17.0"}),e.jsx("li",{children:"PostCSS"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-3",children:""}),e.jsx(Ze,{className:"h-[300px] sm:h-[400px]",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"UI "}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{name:"React",description:"",license:"MIT"}),e.jsx(Nt,{name:"shadcn/ui",description:" React ",license:"MIT"}),e.jsx(Nt,{name:"Radix UI",description:"",license:"MIT"}),e.jsx(Nt,{name:"Tailwind CSS",description:" CSS ",license:"MIT"}),e.jsx(Nt,{name:"Lucide React",description:"",license:"ISC"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{name:"TanStack Router",description:"",license:"MIT"}),e.jsx(Nt,{name:"Zustand",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{name:"React Hook Form",description:"",license:"MIT"}),e.jsx(Nt,{name:"Zod",description:"TypeScript  schema ",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{name:"clsx",description:" className ",license:"MIT"}),e.jsx(Nt,{name:"tailwind-merge",description:"Tailwind ",license:"MIT"}),e.jsx(Nt,{name:"class-variance-authority",description:"",license:"Apache-2.0"}),e.jsx(Nt,{name:"date-fns",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{name:"Framer Motion",description:"React ",license:"MIT"}),e.jsx(Nt,{name:"vaul",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{name:"FastAPI",description:" Python Web ",license:"MIT"}),e.jsx(Nt,{name:"Uvicorn",description:"ASGI ",license:"BSD-3-Clause"}),e.jsx(Nt,{name:"Pydantic",description:"",license:"MIT"}),e.jsx(Nt,{name:"python-multipart",description:"",license:"Apache-2.0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{name:"TypeScript",description:"JavaScript ",license:"Apache-2.0"}),e.jsx(Nt,{name:"Vite",description:"",license:"MIT"}),e.jsx(Nt,{name:"ESLint",description:"JavaScript ",license:"MIT"}),e.jsx(Nt,{name:"PostCSS",description:"CSS ",license:"MIT"})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/5 border border-primary/20 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:"rounded-md bg-primary/10 px-2 py-1",children:e.jsx("span",{className:"text-xs sm:text-sm font-bold text-primary",children:"GPLv3"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm sm:text-base font-semibold text-foreground mb-1",children:"MaiBot WebUI"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" GNU General Public License v3.0  "})]})]})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"MITApache-2.0BSD  "})]})]})]})}function Nt({name:a,description:l,license:r}){return e.jsxs("div",{className:"flex items-start justify-between gap-2 rounded-lg border bg-muted/30 p-2.5 sm:p-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:a}),e.jsx("p",{className:"text-muted-foreground text-xs mt-0.5",children:l})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary flex-shrink-0",children:r})]})}function Um({value:a,current:l,onChange:r,label:c,description:d}){const u=l===a;return e.jsxs("button",{onClick:()=>r(a),className:F("relative rounded-lg border-2 p-3 sm:p-4 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",u?"border-primary bg-accent":"border-border"),children:[u&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3 h-2 w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm sm:text-base font-medium",children:c}),e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:d})]}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex gap-1",children:[a==="light"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-200"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-400"})]}),a==="dark"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"})]}),a==="system"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-200 to-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-300 to-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-400 to-slate-900"})]})]})]})}function qa({value:a,current:l,onChange:r,label:c,colorClass:d}){const u=l===a;return e.jsxs("button",{onClick:()=>r(a),className:F("relative rounded-lg border-2 p-2 sm:p-3 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",u?"border-primary bg-accent":"border-border"),children:[u&&e.jsx("div",{className:"absolute top-1.5 right-1.5 sm:top-2 sm:right-2 h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"flex flex-col items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:F("h-8 w-8 sm:h-10 sm:w-10 rounded-full",d)}),e.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-center",children:c})]})]})}const C2=Date.now()%1e6;class T2{grad3;p;perm;constructor(l=0){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];for(let r=0;r<256;r++)this.p[r]=Math.floor(Math.random()*256);this.perm=[];for(let r=0;r<512;r++)this.perm[r]=this.p[r&255]}dot(l,r,c){return l[0]*r+l[1]*c}mix(l,r,c){return(1-c)*l+c*r}fade(l){return l*l*l*(l*(l*6-15)+10)}perlin2(l,r){const c=Math.floor(l)&255,d=Math.floor(r)&255;l-=Math.floor(l),r-=Math.floor(r);const u=this.fade(l),h=this.fade(r),f=this.perm[c]+d,p=this.perm[f],g=this.perm[f+1],b=this.perm[c+1]+d,j=this.perm[b],y=this.perm[b+1];return this.mix(this.mix(this.dot(this.grad3[p%12],l,r),this.dot(this.grad3[j%12],l-1,r),u),this.mix(this.dot(this.grad3[g%12],l,r-1),this.dot(this.grad3[y%12],l-1,r-1),u),h)}}function Og(){const a=m.useRef(null),l=m.useRef(null),r=m.useRef(void 0),[c]=m.useState(()=>new T2(C2)),d=m.useRef({mouse:{x:-10,y:0,lx:0,ly:0,sx:0,sy:0,v:0,vs:0,a:0,set:!1},lines:[],paths:[],noise:c,bounding:null});return m.useEffect(()=>{const u=l.current,h=a.current;if(!u||!h)return;const f=d.current;f.noise=c;const p=()=>{const A=u.getBoundingClientRect();f.bounding=A,h.style.width=`${A.width}px`,h.style.height=`${A.height}px`},g=()=>{if(!f.bounding)return;const{width:A,height:S}=f.bounding;f.lines=[],f.paths.forEach(oe=>oe.remove()),f.paths=[];const U=10,E=32,C=A+200,D=S+30,P=Math.ceil(C/U),O=Math.ceil(D/E),J=(A-U*P)/2,L=(S-E*O)/2;for(let oe=0;oe<=P;oe++){const Ne=[];for(let de=0;de<=O;de++){const he={x:J+U*oe,y:L+E*de,wave:{x:0,y:0},cursor:{x:0,y:0,vx:0,vy:0}};Ne.push(he)}const je=document.createElementNS("http://www.w3.org/2000/svg","path");h.appendChild(je),f.paths.push(je),f.lines.push(Ne)}},b=A=>{const{lines:S,mouse:U,noise:E}=f;S.forEach(C=>{C.forEach(D=>{const P=E.perlin2((D.x+A*.0125)*.002,(D.y+A*.005)*.0015)*12;D.wave.x=Math.cos(P)*32,D.wave.y=Math.sin(P)*16;const O=D.x-U.sx,J=D.y-U.sy,L=Math.hypot(O,J),oe=Math.max(175,U.vs);if(L<oe){const Ne=1-L/oe,je=Math.cos(L*.001)*Ne;D.cursor.vx+=Math.cos(U.a)*je*oe*U.vs*65e-5,D.cursor.vy+=Math.sin(U.a)*je*oe*U.vs*65e-5}D.cursor.vx+=(0-D.cursor.x)*.005,D.cursor.vy+=(0-D.cursor.y)*.005,D.cursor.vx*=.925,D.cursor.vy*=.925,D.cursor.x+=D.cursor.vx*2,D.cursor.y+=D.cursor.vy*2,D.cursor.x=Math.min(100,Math.max(-100,D.cursor.x)),D.cursor.y=Math.min(100,Math.max(-100,D.cursor.y))})})},j=(A,S=!0)=>{const U={x:A.x+A.wave.x+(S?A.cursor.x:0),y:A.y+A.wave.y+(S?A.cursor.y:0)};return U.x=Math.round(U.x*10)/10,U.y=Math.round(U.y*10)/10,U},y=()=>{const{lines:A,paths:S}=f;A.forEach((U,E)=>{let C=j(U[0],!1),D=`M ${C.x} ${C.y}`;U.forEach((P,O)=>{const J=O===U.length-1;C=j(P,!J),D+=`L ${C.x} ${C.y}`}),S[E].setAttribute("d",D)})},N=A=>{const{mouse:S}=f;S.sx+=(S.x-S.sx)*.1,S.sy+=(S.y-S.sy)*.1;const U=S.x-S.lx,E=S.y-S.ly,C=Math.hypot(U,E);S.v=C,S.vs+=(C-S.vs)*.1,S.vs=Math.min(100,S.vs),S.lx=S.x,S.ly=S.y,S.a=Math.atan2(E,U),u&&(u.style.setProperty("--x",`${S.sx}px`),u.style.setProperty("--y",`${S.sy}px`)),b(A),y(),r.current=requestAnimationFrame(N)},w=A=>{if(!f.bounding)return;const{mouse:S}=f;S.x=A.pageX-f.bounding.left,S.y=A.pageY-f.bounding.top+window.scrollY,S.set||(S.sx=S.x,S.sy=S.y,S.lx=S.x,S.ly=S.y,S.set=!0)},M=()=>{p(),g()};return p(),g(),window.addEventListener("resize",M),window.addEventListener("mousemove",w),r.current=requestAnimationFrame(N),()=>{window.removeEventListener("resize",M),window.removeEventListener("mousemove",w),r.current&&cancelAnimationFrame(r.current)}},[c]),e.jsxs("div",{ref:l,className:"waves-background",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},children:[e.jsx("div",{className:"waves-cursor",style:{position:"absolute",top:0,left:0,width:"0.5rem",height:"0.5rem",background:"hsl(var(--primary) / 0.3)",borderRadius:"50%",transform:"translate3d(calc(var(--x, -0.5rem) - 50%), calc(var(--y, 50%) - 50%), 0)",willChange:"transform",pointerEvents:"none"}}),e.jsx("svg",{ref:a,style:{display:"block",width:"100%",height:"100%"},children:e.jsx("style",{children:`
          path {
            fill: none;
            stroke: hsl(var(--primary) / 0.20);
            stroke-width: 1px;
          }
        `})})]})}function E2(){const[a,l]=m.useState(""),[r,c]=m.useState(!1),[d,u]=m.useState(""),[h,f]=m.useState(!0),p=ca(),{enableWavesBackground:g,setEnableWavesBackground:b}=$v(),{theme:j,setTheme:y}=hx();m.useEffect(()=>{(async()=>{try{await cc()&&p({to:"/"})}catch{}finally{f(!1)}})()},[p]);const w=j==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":j,M=()=>{y(w==="dark"?"light":"dark")},A=async S=>{if(S.preventDefault(),u(""),!a.trim()){u(" Access Token");return}c(!0),console.log(" token...");try{const U=await fetch("/api/webui/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:a.trim()})});console.log("Token :",U.status);const E=await U.json();if(console.log("Token :",E),U.ok&&E.valid){console.log("Token ..."),console.log("is_first_setup:",E.is_first_setup),await new Promise(D=>setTimeout(D,100));const C=await cc();console.log(":",C),E.is_first_setup?(console.log(""),p({to:"/setup"})):(console.log(""),p({to:"/"}))}else console.error("Token :",E.message),u(E.message||"Token ")}catch(U){console.error("Token :",U),u("")}finally{c(!1)}};return h?e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Og,{}),e.jsx("div",{className:"text-muted-foreground",children:"..."})]}):e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Og,{}),e.jsxs(ke,{className:"relative z-10 w-full max-w-md shadow-2xl backdrop-blur-xl bg-card/80 border-border/50",children:[e.jsx("button",{onClick:M,className:"absolute right-4 top-4 rounded-lg p-2 hover:bg-accent transition-colors z-10 text-foreground",title:w==="dark"?"":"",children:w==="dark"?e.jsx(lx,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"}):e.jsx(ec,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"})}),e.jsxs(Re,{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(wg,{className:"h-8 w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(De,{className:"text-2xl font-bold",children:" MaiBot"}),e.jsx(is,{className:"text-base",children:" Access Token "})]})]}),e.jsx(Me,{children:e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"token",className:"text-sm font-medium",children:"Access Token"}),e.jsxs("div",{className:"relative",children:[e.jsx(nx,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground",strokeWidth:2,fill:"none"}),e.jsx(ae,{id:"token",type:"password",placeholder:" Access Token",value:a,onChange:S=>l(S.target.value),className:F("pl-10",d&&"border-red-500 focus-visible:ring-red-500"),disabled:r,autoFocus:!0,autoComplete:"off"})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-red-50 p-3 text-sm text-red-600 dark:bg-red-950/50 dark:text-red-400",children:[e.jsx(Ct,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{children:d})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):""}),e.jsxs(Fs,{children:[e.jsx(cd,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-primary hover:text-primary/80 transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(tv,{className:"h-4 w-4",strokeWidth:2,fill:"none"})," Token Token"]})}),e.jsxs(Us,{className:"sm:max-w-md",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(wg,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"})," Access Token"]}),e.jsx(Xs,{children:"Access Token  MaiBot WebUI "})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S_,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" MaiBot  WebUI Access Token"}),e.jsxs("div",{className:"rounded bg-background p-2 font-mono text-xs",children:[e.jsx("p",{className:"text-muted-foreground",children:" WebUI Access Token: abc123..."}),e.jsx("p",{className:"text-muted-foreground",children:"  Token  WebUI"})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ea,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Token "}),e.jsx("div",{className:"rounded bg-background p-2 font-mono text-xs break-all",children:e.jsx("code",{className:"text-primary",children:"data/webui.json"})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",e.jsx("code",{className:"px-1 py-0.5 bg-background rounded",children:"access_token"})," "]})]})]})}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ct,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token"})]})]})]})})]})]})]}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(el,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsxs(us,{className:"flex items-center gap-2",children:[e.jsx(el,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"}),""]}),e.jsx(ms,{children:""})]}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>b(!1),children:""})]})]})]})]})})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:m2})})]})}const rt=m.forwardRef(({className:a,autoResize:l=!0,minHeight:r=60,maxHeight:c,value:d,onChange:u,...h},f)=>{const p=m.useRef(null),[g,b]=m.useState(!1);m.useImperativeHandle(f,()=>p.current),m.useEffect(()=>{if(a){const N=/\b(h-\d+|h-\[[\d.]+(?:px|rem|em)\]|min-h-\[[\d.]+(?:px|rem|em)\])\b/.test(a);b(N)}},[a]);const j=m.useCallback(()=>{const N=p.current;if(!N||!l||g)return;N.style.height="auto";const w=N.scrollHeight;let M=Math.max(w,r);c&&c>0&&(M=Math.min(M,c)),N.style.height=`${M}px`,c&&c>0&&w>c?N.style.overflowY="auto":N.style.overflowY="hidden"},[l,g,r,c]);m.useEffect(()=>{j()},[d,j]),m.useEffect(()=>{j()},[j]);const y=m.useCallback(N=>{u?.(N),requestAnimationFrame(()=>{j()})},[u,j]);return e.jsx("textarea",{className:F("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","custom-scrollbar",l&&!g&&"resize-none overflow-hidden",a),ref:p,value:d,onChange:y,style:{minHeight:l&&!g?`${r}px`:void 0},...h})});rt.displayName="Textarea";const Zt=m.forwardRef(({className:a,orientation:l="horizontal",decorative:r=!0,...c},d)=>e.jsx(yj,{ref:d,decorative:r,orientation:l,className:F("shrink-0 bg-border",l==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",a),...c}));Zt.displayName=yj.displayName;function M2({config:a,onChange:l}){const r=d=>{d.trim()&&!a.alias_names.includes(d.trim())&&l({...a,alias_names:[...a.alias_names,d.trim()]})},c=d=>{l({...a,alias_names:a.alias_names.filter((u,h)=>h!==d)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ *"}),e.jsx(ae,{id:"qq_account",type:"number",placeholder:"QQ",value:a.qq_account||"",onChange:d=>l({...a,qq_account:Number(d.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"QQ"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"nickname",children:" *"}),e.jsx(ae,{id:"nickname",placeholder:"",value:a.nickname,onChange:d=>l({...a,nickname:d.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{children:""}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:a.alias_names.map((d,u)=>e.jsxs(Ce,{variant:"secondary",className:"gap-1",children:[d,e.jsx("button",{type:"button",onClick:()=>c(u),className:"ml-1 hover:text-destructive",children:e.jsx(Aa,{className:"h-3 w-3"})})]},u))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{id:"alias_input",placeholder:"",onKeyPress:d=>{d.key==="Enter"&&(r(d.target.value),d.target.value="")}}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>{const d=document.getElementById("alias_input");d&&(r(d.value),d.value="")},children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function A2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"personality",children:" *"}),e.jsx(rt,{id:"personality",placeholder:"120",value:a.personality,onChange:r=>l({...a,personality:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"reply_style",children:" *"}),e.jsx(rt,{id:"reply_style",placeholder:"",value:a.reply_style,onChange:r=>l({...a,reply_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"interest",children:" *"}),e.jsx(rt,{id:"interest",placeholder:"",value:a.interest,onChange:r=>l({...a,interest:r.target.value}),rows:2}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"plan_style",children:" *"}),e.jsx(rt,{id:"plan_style",placeholder:"",value:a.plan_style,onChange:r=>l({...a,plan_style:r.target.value}),rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"private_plan_style",children:" *"}),e.jsx(rt,{id:"private_plan_style",placeholder:"",value:a.private_plan_style,onChange:r=>l({...a,private_plan_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function z2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[(a.emoji_chance*100).toFixed(0),"%"]})]}),e.jsx(ae,{id:"emoji_chance",type:"range",min:"0",max:"1",step:"0.1",value:a.emoji_chance,onChange:r=>l({...a,emoji_chance:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ae,{id:"max_reg_num",type:"number",min:"1",max:"200",value:a.max_reg_num,onChange:r=>l({...a,max_reg_num:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"do_replace",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"do_replace",checked:a.do_replace,onCheckedChange:r=>l({...a,do_replace:r})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ae,{id:"check_interval",type:"number",min:"1",max:"120",value:a.check_interval,onChange:r=>l({...a,check_interval:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"steal_emoji",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"steal_emoji",checked:a.steal_emoji,onCheckedChange:r=>l({...a,steal_emoji:r})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"content_filtration",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"content_filtration",checked:a.content_filtration,onCheckedChange:r=>l({...a,content_filtration:r})})]}),a.content_filtration&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ae,{id:"filtration_prompt",placeholder:"",value:a.filtration_prompt,onChange:r=>l({...a,filtration_prompt:r.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function R2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"enable_tool",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"enable_tool",checked:a.enable_tool,onCheckedChange:r=>l({...a,enable_tool:r})})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"all_global",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"all_global",checked:a.all_global,onCheckedChange:r=>l({...a,all_global:r})})]})]})}function D2({config:a,onChange:l}){const[r,c]=m.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:" (SiliconFlow)"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 mb-2",children:" DeepSeek V3Qwen  API Key "}),e.jsxs("a",{href:"https://cloud.siliconflow.cn",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:underline font-medium",children:[" API Key",e.jsx($o,{className:"h-3 w-3"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"siliconflow_api_key",children:"SiliconFlow API Key *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{id:"siliconflow_api_key",type:r?"text":"password",placeholder:"sk-...",value:a.api_key,onChange:d=>l({api_key:d.target.value}),className:"font-mono pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!r),children:r?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" API "})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground ml-2",children:[e.jsx("li",{children:"DeepSeek V3 - "}),e.jsx("li",{children:"Qwen3 30B - "}),e.jsx("li",{children:"Qwen3 VL 30B - "}),e.jsx("li",{children:"SenseVoice - "}),e.jsx("li",{children:"BGE-M3 - "}),e.jsx("li",{children:" (LPMM)"})]})]}),e.jsx("div",{className:"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 p-4",children:e.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-medium",children:" "}),'"  " API ']})})]})}async function O2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:qs()});if(!a.ok)throw new Error("Bot");const r=(await a.json()).config.bot||{};return{qq_account:r.qq_account||0,nickname:r.nickname||"",alias_names:r.alias_names||[]}}async function L2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:qs()});if(!a.ok)throw new Error("");const r=(await a.json()).config.personality||{};return{personality:r.personality||"",reply_style:r.reply_style||"",interest:r.interest||"",plan_style:r.plan_style||"",private_plan_style:r.private_plan_style||""}}async function U2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:qs()});if(!a.ok)throw new Error("");const r=(await a.json()).config.emoji||{};return{emoji_chance:r.emoji_chance??.4,max_reg_num:r.max_reg_num??40,do_replace:r.do_replace??!0,check_interval:r.check_interval??10,steal_emoji:r.steal_emoji??!0,content_filtration:r.content_filtration??!1,filtration_prompt:r.filtration_prompt||""}}async function $2(){const a=await _e("/api/webui/config/bot",{method:"GET",headers:qs()});if(!a.ok)throw new Error("");const r=(await a.json()).config,c=r.tool||{},d=r.expression||{};return{enable_tool:c.enable_tool??!0,all_global:d.all_global_jargon??!0}}async function B2(){const a=await _e("/api/webui/config/model",{method:"GET",headers:qs()});if(!a.ok)throw new Error("");return{api_key:((await a.json()).config.api_providers||[]).find(u=>u.name==="SiliconFlow")?.api_key||""}}async function I2(a){const l=await _e("/api/webui/config/bot/section/bot",{method:"POST",headers:qs(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"Bot")}return await l.json()}async function P2(a){const l=await _e("/api/webui/config/bot/section/personality",{method:"POST",headers:qs(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function F2(a){const l=await _e("/api/webui/config/bot/section/emoji",{method:"POST",headers:qs(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function H2(a){const l=[];l.push(_e("/api/webui/config/bot/section/tool",{method:"POST",headers:qs(),body:JSON.stringify({enable_tool:a.enable_tool})})),l.push(_e("/api/webui/config/bot/section/expression",{method:"POST",headers:qs(),body:JSON.stringify({all_global_jargon:a.all_global})}));const r=await Promise.all(l);for(const c of r)if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return{success:!0}}async function V2(a){const l=await _e("/api/webui/config/model",{method:"GET",headers:qs()});if(!l.ok)throw new Error("");const c=(await l.json()).config,d=c.api_providers||[],u=d.findIndex(p=>p.name==="SiliconFlow");u>=0?d[u]={...d[u],api_key:a.api_key}:d.push({name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",api_key:a.api_key,client_type:"openai",max_retry:3,timeout:120,retry_interval:5});const h={...c,api_providers:d},f=await _e("/api/webui/config/model",{method:"POST",headers:qs(),body:JSON.stringify(h)});if(!f.ok){const p=await f.json();throw new Error(p.detail||"")}return await f.json()}async function Lg(){const a=await _e("/api/webui/setup/complete",{method:"POST"});if(!a.ok){const l=await a.json();throw new Error(l.message||"")}return await a.json()}function G2(){return e.jsx(Wn,{children:e.jsx(q2,{})})}function q2(){const a=ca(),{toast:l}=Ws(),{triggerRestart:r}=yn(),[c,d]=m.useState(0),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[g,b]=m.useState(!0),[j,y]=m.useState({qq_account:0,nickname:"",alias_names:[]}),[N,w]=m.useState({personality:"",reply_style:"",interest:"",plan_style:`1.****action****
2.
3.
4.
5.`,private_plan_style:`1.****action****
2.
3.`}),[M,A]=m.useState({emoji_chance:.4,max_reg_num:40,do_replace:!0,check_interval:10,steal_emoji:!0,content_filtration:!1,filtration_prompt:""}),[S,U]=m.useState({enable_tool:!0,all_global:!0}),[E,C]=m.useState({api_key:""}),D=[{id:"bot-basic",title:"Bot",description:"",icon:Vn},{id:"personality",title:"",description:"",icon:jn},{id:"emoji",title:"",description:"",icon:ld},{id:"other",title:"",description:"",icon:vn},{id:"siliconflow",title:"API",description:"API",icon:nx}],P=(c+1)/D.length*100;m.useEffect(()=>{(async()=>{try{b(!0);const[he,ge,R,Q,$]=await Promise.all([O2(),L2(),U2(),$2(),B2()]);y(he),w(ge),A(R),U(Q),C($)}catch(he){l({title:"",description:he instanceof Error?he.message:"",variant:"destructive"})}finally{b(!1)}})()},[l]);const O=async()=>{p(!0);try{switch(c){case 0:await I2(j);break;case 1:await P2(N);break;case 2:await F2(M);break;case 3:await H2(S);break;case 4:await V2(E);break}return l({title:"",description:`${D[c].title}`}),!0}catch(de){return l({title:"",description:de instanceof Error?de.message:"",variant:"destructive"}),!1}finally{p(!1)}},J=async()=>{await O()&&c<D.length-1&&d(c+1)},L=()=>{c>0&&d(c-1)},oe=async()=>{h(!0);try{if(!await O()){h(!1);return}await Lg(),l({title:"",description:"..."}),await r()}catch(de){l({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}finally{h(!1)}},Ne=async()=>{try{await Lg(),a({to:"/"})}catch(de){l({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}},je=()=>{switch(c){case 0:return e.jsx(M2,{config:j,onChange:y});case 1:return e.jsx(A2,{config:N,onChange:w});case 2:return e.jsx(z2,{config:M,onChange:A});case 3:return e.jsx(R2,{config:S,onChange:U});case 4:return e.jsx(D2,{config:E,onChange:C});default:return null}};return e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center justify-center overflow-hidden bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4 md:p-6",children:[e.jsx(er,{}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute left-1/4 top-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-primary/5 blur-3xl"}),e.jsx("div",{className:"absolute right-1/4 bottom-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-secondary/5 blur-3xl"})]}),g?e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center",children:e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative z-10 w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6 md:mb-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 md:h-16 md:w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(k_,{className:"h-6 w-6 md:h-8 md:w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsx("h1",{className:"mb-2 text-2xl md:text-3xl font-bold",children:""}),e.jsxs("p",{className:"text-sm md:text-base text-muted-foreground",children:[" ",fx," "]})]}),e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs md:text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[" ",c+1," / ",D.length]}),e.jsxs("span",{className:"font-medium text-primary",children:[Math.round(P),"%"]})]}),e.jsx(Xn,{value:P,className:"h-2"})]}),e.jsx("div",{className:"mb-6 md:mb-8 flex justify-between",children:D.map((de,he)=>{const ge=de.icon;return e.jsxs("div",{className:F("flex flex-1 flex-col items-center gap-1 md:gap-2",he<D.length-1&&"relative"),children:[he<D.length-1&&e.jsx("div",{className:F("absolute left-1/2 top-3 md:top-4 h-0.5 w-full",he<c?"bg-primary":"bg-border")}),e.jsx("div",{className:F("relative z-10 flex h-6 w-6 md:h-8 md:w-8 items-center justify-center rounded-full border-2 transition-all",he===c||he<c?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-muted-foreground"),children:he<c?e.jsx(bt,{className:"h-3 w-3 md:h-4 md:w-4",strokeWidth:2.5,fill:"none"}):e.jsx(ge,{className:"h-3 w-3 md:h-4 md:w-4"})}),e.jsx("span",{className:F("text-[10px] md:text-xs text-center max-w-[60px] md:max-w-none truncate md:whitespace-normal",he===c?"font-medium text-foreground":"text-muted-foreground"),title:de.title,children:de.title})]},de.id)})}),e.jsx(ke,{className:"mb-6 md:mb-8 shadow-lg",children:e.jsx(Me,{className:"p-4 md:p-8",children:e.jsxs("div",{className:"min-h-[300px] md:min-h-[400px]",children:[e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsx("h2",{className:"mb-2 text-xl md:text-2xl font-semibold",children:D[c].title}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:D[c].description})]}),e.jsx(Ze,{className:"h-[400px] md:h-[500px]",children:e.jsx("div",{className:"pr-2",children:je()})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:L,disabled:c===0||f,className:"w-full sm:w-auto order-2 sm:order-1",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto order-1 sm:order-2",children:[e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"flex-1 sm:flex-none gap-2",disabled:f||u,children:[e.jsx(C_,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{children:""})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:Ne,children:""})]})]})]}),c===D.length-1?e.jsx(_,{onClick:oe,disabled:u||f,className:"flex-1 sm:flex-none",children:u||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),f?"...":"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(bt,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})}):e.jsx(_,{onClick:J,disabled:f,className:"flex-1 sm:flex-none",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(T_,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})})]})]})]}),e.jsx("div",{className:"relative z-10 mt-6 md:mt-8 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:""})})]})]})}function Pv(){const a=ca();return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("h1",{className:"text-[150px] font-black leading-none text-primary/10 select-none sm:text-[200px]",children:"404"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(At,{className:"h-20 w-20 text-primary/30 sm:h-24 sm:w-24"})})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground sm:text-3xl",children:""}),e.jsx("p",{className:"text-base text-muted-foreground sm:text-lg max-w-md mx-auto",children:" URL "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs(_,{size:"lg",onClick:()=>a({to:"/"}),className:"gap-2 w-full sm:w-auto",children:[e.jsx(nd,{className:"h-4 w-4"}),""]}),e.jsxs(_,{size:"lg",variant:"outline",onClick:()=>window.history.back(),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Ma,{className:"h-4 w-4"}),""]})]}),e.jsx("div",{className:"mt-12 pt-8 border-t border-border",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})})]})})}const K2=Ls.memo(function({config:l,onChange:r}){const c=l.platforms||[],d=l.alias_names||[],u=()=>{r({...l,platforms:[...c,""]})},h=j=>{r({...l,platforms:c.filter((y,N)=>N!==j)})},f=(j,y)=>{const N=[...c];N[j]=y,r({...l,platforms:N})},p=()=>{r({...l,alias_names:[...d,""]})},g=j=>{r({...l,alias_names:d.filter((y,N)=>N!==j)})},b=(j,y)=>{const N=[...d];N[j]=y,r({...l,alias_names:N})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"platform",children:""}),e.jsx(ae,{id:"platform",value:l.platform,onChange:j=>r({...l,platform:j.target.value}),placeholder:"qq"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ"}),e.jsx(ae,{id:"qq_account",value:l.qq_account,onChange:j=>r({...l,qq_account:j.target.value}),placeholder:"123456789"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ae,{id:"nickname",value:l.nickname,onChange:j=>r({...l,nickname:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:p,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[d.map((j,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:j,onChange:N=>b(y,N.target.value),placeholder:""}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',j||"()",'" ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>g(y),children:""})]})]})]})]},y)),d.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:u,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((j,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:j,onChange:N=>f(y,N.target.value),placeholder:"wx:114514"}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',j||"()",'" ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>h(y),children:""})]})]})]})]},y)),c.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})]})})}),Q2=Ls.memo(function({config:l,onChange:r}){const c=()=>{r({...l,states:[...l.states,""]})},d=h=>{r({...l,states:l.states.filter((f,p)=>p!==h)})},u=(h,f)=>{const p=[...l.states];p[h]=f,r({...l,states:p})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"personality",children:""}),e.jsx(rt,{id:"personality",value:l.personality,onChange:h=>r({...l,personality:h.target.value}),placeholder:"120",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"120"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"space-y-2",children:l.states.map((h,f)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(rt,{value:h,onChange:p=>u(f,p.target.value),placeholder:"",rows:2}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{children:""})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>d(f),children:""})]})]})]})]},f))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"state_probability",children:""}),e.jsx(ae,{id:"state_probability",type:"number",step:"0.1",min:"0",max:"1",value:l.state_probability,onChange:h=>r({...l,state_probability:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.0-1.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"reply_style",children:""}),e.jsx(rt,{id:"reply_style",value:l.reply_style,onChange:h=>r({...l,reply_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_style",children:""}),e.jsx(rt,{id:"plan_style",value:l.plan_style,onChange:h=>r({...l,plan_style:h.target.value}),placeholder:"",rows:5})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"visual_style",children:""}),e.jsx(rt,{id:"visual_style",value:l.visual_style,onChange:h=>r({...l,visual_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"private_plan_style",children:""}),e.jsx(rt,{id:"private_plan_style",value:l.private_plan_style,onChange:h=>r({...l,private_plan_style:h.target.value}),placeholder:"",rows:4})]})]})]})})}),ul=bw,ml=yw,sl=m.forwardRef(({className:a,align:l="center",sideOffset:r=4,...c},d)=>e.jsx(Nw,{children:e.jsx(wj,{ref:d,align:l,sideOffset:r,className:F("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...c})}));sl.displayName=wj.displayName;const Y2=Ls.memo(function({value:l,onChange:r}){const c=m.useMemo(()=>{const N=l.split("-");if(N.length===2){const[w,M]=N,[A,S]=w.split(":"),[U,E]=M.split(":");return{startHour:A?A.padStart(2,"0"):"00",startMinute:S?S.padStart(2,"0"):"00",endHour:U?U.padStart(2,"0"):"23",endMinute:E?E.padStart(2,"0"):"59"}}return{startHour:"00",startMinute:"00",endHour:"23",endMinute:"59"}},[l]),[d,u]=m.useState(c.startHour),[h,f]=m.useState(c.startMinute),[p,g]=m.useState(c.endHour),[b,j]=m.useState(c.endMinute);m.useEffect(()=>{u(c.startHour),f(c.startMinute),g(c.endHour),j(c.endMinute)},[c]);const y=(N,w,M,A)=>{const S=`${N}:${w}-${M}:${A}`;r(S)};return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"w-full justify-start font-mono text-sm",children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),l||""]})}),e.jsx(sl,{className:"w-72 sm:w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:d,onValueChange:N=>{u(N),y(N,h,p,b)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:24},(N,w)=>w).map(N=>e.jsx(W,{value:N.toString().padStart(2,"0"),children:N.toString().padStart(2,"0")},N))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:h,onValueChange:N=>{f(N),y(d,N,p,b)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:60},(N,w)=>w).map(N=>e.jsx(W,{value:N.toString().padStart(2,"0"),children:N.toString().padStart(2,"0")},N))})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:p,onValueChange:N=>{g(N),y(d,h,N,b)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:24},(N,w)=>w).map(N=>e.jsx(W,{value:N.toString().padStart(2,"0"),children:N.toString().padStart(2,"0")},N))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:b,onValueChange:N=>{j(N),y(d,h,p,N)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:60},(N,w)=>w).map(N=>e.jsx(W,{value:N.toString().padStart(2,"0"),children:N.toString().padStart(2,"0")},N))})]})]})]})]})]})})]})}),J2=Ls.memo(function({rule:l}){const r=`{ target = "${l.target}", time = "${l.time}", value = ${l.value.toFixed(1)} }`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})}),X2=Ls.memo(function({config:l,onChange:r}){const c=()=>{r({...l,talk_value_rules:[...l.talk_value_rules,{target:"",time:"00:00-23:59",value:1}]})},d=h=>{r({...l,talk_value_rules:l.talk_value_rules.filter((f,p)=>p!==h)})},u=(h,f,p)=>{const g=[...l.talk_value_rules];g[h]={...g[h],[f]:p},r({...l,talk_value_rules:g})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"talk_value",children:""}),e.jsx(ae,{id:"talk_value",type:"number",step:"0.1",min:"0",max:"1",value:l.talk_value,onChange:h=>r({...l,talk_value:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"think_mode",children:""}),e.jsxs(Pe,{value:l.think_mode||"classic",onValueChange:h=>r({...l,think_mode:h}),children:[e.jsx(Be,{id:"think_mode",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"classic",children:" - "}),e.jsx(W,{value:"deep",children:" - "}),e.jsx(W,{value:"dynamic",children:" - "})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"mentioned_bot_reply",checked:l.mentioned_bot_reply,onCheckedChange:h=>r({...l,mentioned_bot_reply:h})}),e.jsx(T,{htmlFor:"mentioned_bot_reply",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_context_size",children:""}),e.jsx(ae,{id:"max_context_size",type:"number",min:"1",value:l.max_context_size,onChange:h=>r({...l,max_context_size:parseInt(h.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"planner_smooth",children:""}),e.jsx(ae,{id:"planner_smooth",type:"number",step:"1",min:"0",value:l.planner_smooth,onChange:h=>r({...l,planner_smooth:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" planner  1-50 "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_reply_log_max_per_chat",children:""}),e.jsx(ae,{id:"plan_reply_log_max_per_chat",type:"number",step:"1",min:"100",value:l.plan_reply_log_max_per_chat??1024,onChange:h=>r({...l,plan_reply_log_max_per_chat:parseInt(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Plan/Reply "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"llm_quote",checked:l.llm_quote??!1,onCheckedChange:h=>r({...l,llm_quote:h})}),e.jsx(T,{htmlFor:"llm_quote",className:"cursor-pointer",children:" LLM "})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2 ml-10",children:"LLM "}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_talk_value_rules",checked:l.enable_talk_value_rules,onCheckedChange:h=>r({...l,enable_talk_value_rules:h})}),e.jsx(T,{htmlFor:"enable_talk_value_rules",className:"cursor-pointer",children:""})]})]})]}),l.enable_talk_value_rules&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ID"})]}),e.jsxs(_,{onClick:c,size:"sm",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),l.talk_value_rules&&l.talk_value_rules.length>0?e.jsx("div",{className:"space-y-4",children:l.talk_value_rules.map((h,f)=>e.jsxs("div",{className:"rounded-lg border p-4 bg-muted/50 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[" #",f+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J2,{rule:h}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(ls,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" #",f+1," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>d(f),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:h.target===""?"global":"specific",onValueChange:p=>{p==="global"?u(f,"target",""):u(f,"target","qq::group")},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"global",children:""}),e.jsx(W,{value:"specific",children:""})]})]})]}),h.target!==""&&(()=>{const p=h.target.split(":"),g=p[0]||"qq",b=p[1]||"",j=p[2]||"group";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:g,onValueChange:y=>{u(f,"target",`${y}:${b}:${j}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ae,{value:b,onChange:y=>{u(f,"target",`${g}:${y.target.value}:${j}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:j,onValueChange:y=>{u(f,"target",`${g}:${b}:${y}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"group",children:"group"}),e.jsx(W,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",h.target||""]})]})})(),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" (Time)"}),e.jsx(Y2,{value:h.time,onChange:p=>u(f,"time",p)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00-02:00"})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:`rule-value-${f}`,className:"text-xs font-medium",children:" (Value)"}),e.jsx(ae,{id:`rule-value-${f}`,type:"number",step:"0.01",min:"0.01",max:"1",value:h.value,onChange:p=>{const g=parseFloat(p.target.value);isNaN(g)||u(f,"value",Math.max(.01,Math.min(1,g)))},className:"w-20 h-8 text-xs"})]}),e.jsx(Qa,{value:[h.value],onValueChange:p=>u(f,"value",p[0]),min:.01,max:1,step:.01,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0.01 ()"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0 ()"})]})]})]})]},f))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:'""'})}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),"platform:id:type"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 23:00-02:00 112"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 0-10 1 "]})]})]})]})]})}),Z2=Ls.memo(function({config:l,onChange:r}){const c=S=>{if(!S||!S.includes(":"))return{platform:"qq",userId:""};const[U,E]=S.split(":");return{platform:U,userId:E}},{platform:d,userId:u}=c(l.dream_send),[h,f]=m.useState(d),[p,g]=m.useState(u),b=S=>{const[U,E]=S.split("-");return{startTime:U||"09:00",endTime:E||"22:00"}},j=(S,U)=>{const E=U?`${S}:${U}`:"";r({...l,dream_send:E})},y=S=>{f(S),j(S,p)},N=S=>{g(S),j(h,S)},w=()=>{r({...l,dream_time_ranges:[...l.dream_time_ranges,"09:00-22:00"]})},M=S=>{r({...l,dream_time_ranges:l.dream_time_ranges.filter((U,E)=>E!==S)})},A=(S,U,E)=>{const C=[...l.dream_time_ranges],D=b(C[S]);U==="startTime"?D.startTime=E:D.endTime=E,C[S]=`${D.startTime}-${D.endTime}`,r({...l,dream_time_ranges:C})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"interval_minutes",children:""}),e.jsx(ae,{id:"interval_minutes",type:"number",min:"1",value:l.interval_minutes,onChange:S=>r({...l,interval_minutes:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"max_iterations",children:""}),e.jsx(ae,{id:"max_iterations",type:"number",min:"1",value:l.max_iterations,onChange:S=>r({...l,max_iterations:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"first_delay_seconds",children:""}),e.jsx(ae,{id:"first_delay_seconds",type:"number",min:"0",value:l.first_delay_seconds,onChange:S=>r({...l,first_delay_seconds:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Pe,{value:h,onValueChange:y,children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""}),e.jsx(W,{value:"webui",children:"WebUI"})]})]}),e.jsx(ae,{type:"text",placeholder:"ID (: 123456)",value:p,onChange:S=>N(S.target.value),className:"flex-1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IDID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(_,{type:"button",size:"sm",onClick:w,children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00  02:00"}),e.jsxs("div",{className:"space-y-2",children:[l.dream_time_ranges.map((S,U)=>{const{startTime:E,endTime:C}=b(S);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"time",value:E,onChange:D=>A(U,"startTime",D.target.value),className:"w-[140px]"}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(ae,{type:"time",value:C,onChange:D=>A(U,"endTime",D.target.value),className:"w-[140px]"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:()=>M(U),children:e.jsx(Aa,{className:"h-4 w-4"})})]},U)}),l.dream_time_ranges.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})}),W2=Ls.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.enable,onCheckedChange:c=>r({...l,enable:c})}),e.jsx(T,{className:"cursor-pointer",children:" LPMM "})]}),l.enable&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"LPMM "}),e.jsxs(Pe,{value:l.lpmm_mode,onValueChange:c=>r({...l,lpmm_mode:c}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:" LPMM "})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"classic",children:""}),e.jsx(W,{value:"agent",children:"Agent "})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" TopK"}),e.jsx(ae,{type:"number",min:"1",value:l.rag_synonym_search_top_k,onChange:c=>r({...l,rag_synonym_search_top_k:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",step:"0.1",min:"0",max:"1",value:l.rag_synonym_threshold,onChange:c=>r({...l,rag_synonym_threshold:parseFloat(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:l.info_extraction_workers,onChange:c=>r({...l,info_extraction_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:l.embedding_dimension,onChange:c=>r({...l,embedding_dimension:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:l.max_embedding_workers,onChange:c=>r({...l,max_embedding_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:l.embedding_chunk_size,onChange:c=>r({...l,embedding_chunk_size:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",min:"1",value:l.max_synonym_entities,onChange:c=>r({...l,max_synonym_entities:parseInt(c.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.enable_ppr,onCheckedChange:c=>r({...l,enable_ppr:c})}),e.jsx(T,{className:"cursor-pointer",children:" PPR ()"})]})]})]})]})}),eS=Ls.memo(function({config:l,onChange:r}){const[c,d]=m.useState(""),[u,h]=m.useState("WARNING"),f=()=>{c&&!l.suppress_libraries.includes(c)&&(r({...l,suppress_libraries:[...l.suppress_libraries,c]}),d(""))},p=w=>{r({...l,suppress_libraries:l.suppress_libraries.filter(M=>M!==w)})},g=()=>{c&&!l.library_log_levels[c]&&(r({...l,library_log_levels:{...l.library_log_levels,[c]:u}}),d(""),h("WARNING"))},b=w=>{const M={...l.library_log_levels};delete M[w],r({...l,library_log_levels:M})},j=["DEBUG","INFO","WARNING","ERROR","CRITICAL"],y=["FULL","compact","lite"],N=["none","title","full"];return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{value:l.date_style,onChange:w=>r({...l,date_style:w.target.value}),placeholder:": m-d H:i:s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"m=, d=, H=, i=, s="})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.log_level_style,onValueChange:w=>r({...l,log_level_style:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:y.map(w=>e.jsx(W,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.color_text,onValueChange:w=>r({...l,color_text:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:N.map(w=>e.jsx(W,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.log_level,onValueChange:w=>r({...l,log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(W,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.console_log_level,onValueChange:w=>r({...l,console_log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(W,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.file_log_level,onValueChange:w=>r({...l,file_log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(W,{value:w,children:w},w))})]})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:c,onChange:w=>d(w.target.value),placeholder:"",className:"flex-1",onKeyDown:w=>{w.key==="Enter"&&(w.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",className:"flex-shrink-0",children:e.jsx(Ys,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.suppress_libraries.map(w=>e.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-3 py-1 rounded-md",children:[e.jsx("span",{className:"text-sm",children:w}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>p(w),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},w))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:c,onChange:w=>d(w.target.value),placeholder:"",className:"flex-1"}),e.jsxs(Pe,{value:u,onValueChange:h,children:[e.jsx(Be,{className:"w-32",children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(W,{value:w,children:w},w))})]}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(Ys,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(l.library_log_levels).map(([w,M])=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-medium",children:w}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:M}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>b(w),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]})]},w))})]})]})}),sS=Ls.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_prompt,onCheckedChange:c=>r({...l,show_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_replyer_prompt,onCheckedChange:c=>r({...l,show_replyer_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_replyer_reasoning,onCheckedChange:c=>r({...l,show_replyer_reasoning:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Jargon Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_jargon_prompt,onCheckedChange:c=>r({...l,show_jargon_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_memory_prompt,onCheckedChange:c=>r({...l,show_memory_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Planner Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Planner "})]}),e.jsx(Ge,{checked:l.show_planner_prompt,onCheckedChange:c=>r({...l,show_planner_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" LPMM "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LPMM "})]}),e.jsx(Ge,{checked:l.show_lpmm_paragraph,onCheckedChange:c=>r({...l,show_lpmm_paragraph:c})})]})]})]})}),tS=Ls.memo(function({config:l,onChange:r}){const[c,d]=m.useState(""),[u,h]=m.useState(""),f=()=>{c&&!l.auth_token.includes(c)&&(r({...l,auth_token:[...l.auth_token,c]}),d(""))},p=j=>{r({...l,auth_token:l.auth_token.filter((y,N)=>N!==j)})},g=()=>{u&&!l.api_server_allowed_api_keys.includes(u)&&(r({...l,api_server_allowed_api_keys:[...l.api_server_allowed_api_keys,u]}),h(""))},b=j=>{r({...l,api_server_allowed_api_keys:l.api_server_allowed_api_keys.filter((y,N)=>N!==j)})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:" API "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:" API "}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:c,onChange:j=>d(j.target.value),placeholder:"",onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",children:e.jsx(Ys,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:l.auth_token.map((j,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:j}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>p(y),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:" API Server "}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" API Server"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" API Server"})]}),e.jsx(Ge,{checked:l.enable_api_server,onCheckedChange:j=>r({...l,enable_api_server:j})})]}),l.enable_api_server&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{value:l.api_server_host,onChange:j=>r({...l,api_server_host:j.target.value}),placeholder:"0.0.0.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",value:l.api_server_port,onChange:j=>r({...l,api_server_port:parseInt(j.target.value)}),placeholder:"8090"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.api_server_use_wss,onCheckedChange:j=>r({...l,api_server_use_wss:j})}),e.jsx(T,{children:" WSS "})]}),l.api_server_use_wss&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ae,{value:l.api_server_cert_file,onChange:j=>r({...l,api_server_cert_file:j.target.value}),placeholder:"cert.pem"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ae,{value:l.api_server_key_file,onChange:j=>r({...l,api_server_key_file:j.target.value}),placeholder:"key.pem"})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:" API Key "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ae,{value:u,onChange:j=>h(j.target.value),placeholder:" API Key",onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),g())}}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(Ys,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:l.api_server_allowed_api_keys.map((j,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:j}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>b(y),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]})]})]})]})]})}),aS=Ls.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.enable,onCheckedChange:c=>r({...l,enable:c})})]})]})}),lS=Ls.memo(function({emojiConfig:l,memoryConfig:r,toolConfig:c,voiceConfig:d,onEmojiChange:u,onMemoryChange:h,onToolChange:f,onVoiceChange:p}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_tool",checked:c.enable_tool,onCheckedChange:g=>f({...c,enable_tool:g})}),e.jsx(T,{htmlFor:"enable_tool",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(Ge,{id:"enable_asr",checked:d.enable_asr,onCheckedChange:g=>p({...d,enable_asr:g})}),e.jsx(T,{htmlFor:"enable_asr",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_agent_iterations",children:""}),e.jsx(ae,{id:"max_agent_iterations",type:"number",min:"1",value:r.max_agent_iterations,onChange:g=>h({...r,max_agent_iterations:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"agent_timeout_seconds",children:""}),e.jsx(ae,{id:"agent_timeout_seconds",type:"number",min:"1",step:"0.1",value:r.agent_timeout_seconds??120,onChange:g=>h({...r,agent_timeout_seconds:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_jargon_detection",checked:r.enable_jargon_detection??!0,onCheckedChange:g=>h({...r,enable_jargon_detection:g})}),e.jsx(T,{htmlFor:"enable_jargon_detection",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"global_memory",checked:r.global_memory??!1,onCheckedChange:g=>h({...r,global_memory:g})}),e.jsx(T,{htmlFor:"global_memory",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsx(ae,{id:"emoji_chance",type:"number",step:"0.1",min:"0",max:"1",value:l.emoji_chance,onChange:g=>u({...l,emoji_chance:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ae,{id:"max_reg_num",type:"number",min:"1",value:l.max_reg_num,onChange:g=>u({...l,max_reg_num:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ae,{id:"check_interval",type:"number",min:"1",value:l.check_interval,onChange:g=>u({...l,check_interval:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"do_replace",checked:l.do_replace,onCheckedChange:g=>u({...l,do_replace:g})}),e.jsx(T,{htmlFor:"do_replace",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"steal_emoji",checked:l.steal_emoji,onCheckedChange:g=>u({...l,steal_emoji:g})}),e.jsx(T,{htmlFor:"steal_emoji",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"content_filtration",checked:l.content_filtration,onCheckedChange:g=>u({...l,content_filtration:g})}),e.jsx(T,{htmlFor:"content_filtration",className:"cursor-pointer",children:""})]}),l.content_filtration&&e.jsxs("div",{className:"grid gap-2 pl-6 border-l-2 border-primary/20",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ae,{id:"filtration_prompt",value:l.filtration_prompt,onChange:g=>u({...l,filtration_prompt:g.target.value}),placeholder:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})})]})}),nS=Ls.memo(function({member:l,groupIndex:r,memberIndex:c,availableChatIds:d,onUpdate:u,onRemove:h}){const f=d.includes(l)||l==="*",[p,g]=m.useState(!f);return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 flex gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx(ae,{value:l,onChange:b=>u(r,c,b.target.value),placeholder:' "*"  "qq:123456:group"',className:"flex-1"}),d.length>0&&e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!1),title:"",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{value:l,onValueChange:b=>u(r,c,b),children:[e.jsx(Be,{className:"flex-1",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"*",children:"* ()"}),d.map((b,j)=>e.jsx(W,{value:b,children:b},j))]})]}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!0),title:"",children:""})]})}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',l||"()",'" ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>h(r,c),children:""})]})]})]})]})}),rS=Ls.memo(function({config:l,onChange:r}){const c=()=>{r({...l,learning_list:[...l.learning_list,["","enable","enable","1.0"]]})},d=y=>{r({...l,learning_list:l.learning_list.filter((N,w)=>w!==y)})},u=(y,N,w)=>{const M=[...l.learning_list];M[y][N]=w,r({...l,learning_list:M})},h=({rule:y})=>{const N=`["${y[0]}", "${y[1]}", "${y[2]}", "${y[3]}"]`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:N}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},f=()=>{r({...l,expression_groups:[...l.expression_groups,[]]})},p=y=>{r({...l,expression_groups:l.expression_groups.filter((N,w)=>w!==y)})},g=y=>{const N=[...l.expression_groups];N[y]=[...N[y],""],r({...l,expression_groups:N})},b=(y,N)=>{const w=[...l.expression_groups];w[y]=w[y].filter((M,A)=>A!==N),r({...l,expression_groups:w})},j=(y,N,w)=>{const M=[...l.expression_groups];M[y][N]=w,r({...l,expression_groups:M})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"all_global_jargon",checked:l.all_global_jargon??!1,onCheckedChange:y=>r({...l,all_global_jargon:y})}),e.jsx(T,{htmlFor:"all_global_jargon",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_jargon_explanation",checked:l.enable_jargon_explanation??!0,onCheckedChange:y=>r({...l,enable_jargon_explanation:y})}),e.jsx(T,{htmlFor:"enable_jargon_explanation",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"LLM"})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"jargon_mode",children:""}),e.jsxs(Pe,{value:l.jargon_mode??"context",onValueChange:y=>r({...l,jargon_mode:y}),children:[e.jsx(Be,{id:"jargon_mode",className:"mt-2",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"context",children:""}),e.jsx(W,{value:"planner",children:"Plannerunknown_words"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["",e.jsx("br",{}),"PlannerPlannerreplyunknown_words"]})]})]}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[l.learning_list.map((y,N)=>{const w=l.learning_list.some((C,D)=>D!==N&&C[0]===""),M=y[0]==="",A=y[0].split(":"),S=A[0]||"qq",U=A[1]||"",E=A[2]||"group";return e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",N+1," ",M&&""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{rule:y}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",N+1," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>d(N),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:M?"global":"specific",onValueChange:C=>{C==="global"?u(N,0,""):u(N,0,"qq::group")},disabled:w&&!M,children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"global",children:""}),e.jsx(W,{value:"specific",disabled:w&&!M,children:""})]})]}),w&&!M&&e.jsx("p",{className:"text-xs text-amber-600",children:""})]}),!M&&e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:S,onValueChange:C=>{u(N,0,`${C}:${U}:${E}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ae,{value:U,onChange:C=>{u(N,0,`${S}:${C.target.value}:${E}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:E,onValueChange:C=>{u(N,0,`${S}:${U}:${C}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"group",children:"group"}),e.jsx(W,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",y[0]||""]})]}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:y[1]==="enable",onCheckedChange:C=>u(N,1,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:y[2]==="enable",onCheckedChange:C=>u(N,2,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:y[3]==="true"||y[3]==="enable",onCheckedChange:C=>u(N,3,C?"true":"false")})]})})]})]},N)}),l.learning_list.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_self_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"expression_self_reflect",checked:l.expression_self_reflect??!1,onCheckedChange:y=>r({...l,expression_self_reflect:y})})]}),l.expression_self_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_interval",children:""}),e.jsx(ae,{id:"expression_auto_check_interval",type:"number",min:"60",value:l.expression_auto_check_interval??3600,onChange:y=>r({...l,expression_auto_check_interval:parseInt(y.target.value)||3600})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"36001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_count",children:""}),e.jsx(ae,{id:"expression_auto_check_count",type:"number",min:"1",max:"100",value:l.expression_auto_check_count??10,onChange:y=>r({...l,expression_auto_check_count:parseInt(y.target.value)||10})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"10"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:()=>{r({...l,expression_auto_check_custom_criteria:[...l.expression_auto_check_custom_criteria||[],""]})},size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(l.expression_auto_check_custom_criteria||[]).map((y,N)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:y,onChange:w=>{const M=[...l.expression_auto_check_custom_criteria||[]];M[N]=w.target.value,r({...l,expression_auto_check_custom_criteria:M})},placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>{r({...l,expression_auto_check_custom_criteria:(l.expression_auto_check_custom_criteria||[]).filter((w,M)=>M!==N)})},size:"icon",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})]},N)),(!l.expression_auto_check_custom_criteria||l.expression_auto_check_custom_criteria.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:'""'})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_checked_only",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"expression_checked_only",checked:l.expression_checked_only??!1,onCheckedChange:y=>r({...l,expression_checked_only:y})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_manual_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"expression_manual_reflect",checked:l.expression_manual_reflect??!1,onCheckedChange:y=>r({...l,expression_manual_reflect:y})})]}),l.expression_manual_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-sm font-medium",children:""})}),e.jsx("div",{className:"space-y-4",children:(()=>{const N=(l.manual_reflect_operator_id||"").split(":"),w=N[0]||"qq",M=N[1]||"",A=N[2]||"private";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:w,onValueChange:S=>{r({...l,manual_reflect_operator_id:`${S}:${M}:${A}`})},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"/ ID"}),e.jsx(ae,{value:M,onChange:S=>{r({...l,manual_reflect_operator_id:`${w}:${S.target.value}:${A}`})},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:A,onValueChange:S=>{r({...l,manual_reflect_operator_id:`${w}:${M}:${S}`})},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"private",children:"private"}),e.jsx(W,{value:"group",children:"group"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",l.manual_reflect_operator_id||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'IDplatform:id:type ( "qq:123456:private"  "qq:654321:group")'})]})})()})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>{r({...l,allow_reflect:[...l.allow_reflect||[],"qq::group"]})},size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(l.allow_reflect||[]).map((y,N)=>{const w=y.split(":"),M=w[0]||"qq",A=w[1]||"",S=w[2]||"group";return e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-muted/50",children:[e.jsxs(Pe,{value:M,onValueChange:U=>{const E=[...l.allow_reflect];E[N]=`${U}:${A}:${S}`,r({...l,allow_reflect:E})},children:[e.jsx(Be,{className:"w-24",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]}),e.jsx(ae,{value:A,onChange:U=>{const E=[...l.allow_reflect];E[N]=`${M}:${U.target.value}:${S}`,r({...l,allow_reflect:E})},placeholder:"ID",className:"flex-1 font-mono text-sm"}),e.jsxs(Pe,{value:S,onValueChange:U=>{const E=[...l.allow_reflect];E[N]=`${M}:${A}:${U}`,r({...l,allow_reflect:E})},children:[e.jsx(Be,{className:"w-32",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"group",children:""}),e.jsx(W,{value:"private",children:""})]})]}),e.jsx(_,{onClick:()=>{r({...l,allow_reflect:l.allow_reflect.filter((U,E)=>E!==N)})},size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})]},N)}),(!l.allow_reflect||l.allow_reflect.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:""})]})]})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:f,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[l.expression_groups.map((y,N)=>{const w=l.learning_list.map(M=>M[0]).filter(M=>M!=="");return e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",N+1,y.length===1&&y[0]==="*"&&""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:()=>g(N),size:"sm",variant:"outline",children:e.jsx(Ys,{className:"h-4 w-4"})}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",N+1," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>p(N),children:""})]})]})]})]})]}),e.jsx("div",{className:"space-y-2",children:y.map((M,A)=>e.jsx(nS,{member:M,groupIndex:N,memberIndex:A,availableChatIds:w,onUpdate:j,onRemove:b},`${N}-${A}`))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' "*" '})]},N)}),l.expression_groups.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})})]})});function iS({regex:a,reaction:l,onRegexChange:r,onReactionChange:c}){const[d,u]=m.useState(!1),[h,f]=m.useState(""),[p,g]=m.useState(null),[b,j]=m.useState(""),[y,N]=m.useState({}),[w,M]=m.useState(""),A=m.useRef(null),[S,U]=m.useState("build"),E=O=>O.replace(/\(\?P<([^>]+)>/g,"(?<$1>"),C=(O,J=0)=>{const L=A.current;if(!L)return;const oe=L.selectionStart||0,Ne=L.selectionEnd||0,je=a.substring(0,oe)+O+a.substring(Ne);r(je),setTimeout(()=>{const de=oe+O.length+J;L.setSelectionRange(de,de),L.focus()},0)};m.useEffect(()=>{if(!a||!h){p!==null&&g(null),Object.keys(y).length>0&&N({}),w!==l&&M(l),b!==""&&j("");return}try{const O=E(a),J=new RegExp(O,"g"),L=h.match(J);g(L),j("");const Ne=new RegExp(O).exec(h);if(Ne&&Ne.groups){N(Ne.groups);let je=l;Object.entries(Ne.groups).forEach(([de,he])=>{je=je.replace(new RegExp(`\\[${de}\\]`,"g"),he||"")}),M(je)}else N({}),M(l)}catch(O){j(O.message),g(null),N({}),M(l)}},[a,h,l,p,y,w,b]);const D=()=>{if(!h||!p||p.length===0)return e.jsx("span",{className:"text-muted-foreground",children:h||""});try{const O=E(a),J=new RegExp(O,"g");let L=0;const oe=[];let Ne;for(;(Ne=J.exec(h))!==null;)Ne.index>L&&oe.push(e.jsx("span",{children:h.substring(L,Ne.index)},`text-${L}`)),oe.push(e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-900 font-semibold",children:Ne[0]},`match-${Ne.index}`)),L=Ne.index+Ne[0].length;return L<h.length&&oe.push(e.jsx("span",{children:h.substring(L)},`text-${L}`)),e.jsx(e.Fragment,{children:oe})}catch{return e.jsx("span",{children:h})}},P=[{category:"",items:[{label:"",pattern:".",desc:""},{label:"",pattern:"\\d",desc:" 0-9"},{label:"",pattern:"\\D",desc:""},{label:"",pattern:"\\w",desc:""},{label:"",pattern:"\\W",desc:""},{label:"",pattern:"\\s",desc:""},{label:"",pattern:"\\S",desc:""}]},{category:"",items:[{label:"",pattern:"^",desc:""},{label:"",pattern:"$",desc:""},{label:"",pattern:"\\b",desc:""}]},{category:"",items:[{label:"0",pattern:"*",desc:"0"},{label:"1",pattern:"+",desc:"1"},{label:"01",pattern:"?",desc:"01"},{label:"",pattern:"{n}",desc:"nn"},{label:"",pattern:"{m,n}",desc:"mn"}]},{category:"",items:[{label:"",pattern:"()",desc:"",moveCursor:-1},{label:"",pattern:"(?P<name>)",desc:"Python",moveCursor:-1},{label:"",pattern:"(?:)",desc:"",moveCursor:-1}]},{category:"",items:[{label:"",pattern:"[]",desc:"",moveCursor:-1},{label:"",pattern:"[^]",desc:"",moveCursor:-1},{label:"",pattern:"[a-z]",desc:"az"},{label:"",pattern:"[\\u4e00-\\u9fa5]",desc:""}]},{category:"",items:[{label:"",pattern:"(?P<word>\\S+)",desc:""},{label:"",pattern:"(?P<sentence>.+)",desc:""},{label:"",pattern:"(?P<num>\\d+)",desc:""},{label:"",pattern:"(?:1|2)",desc:""}]}];return e.jsxs(Fs,{open:d,onOpenChange:u,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(rx,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Us,{className:"max-w-[95vw] sm:max-w-[900px] max-h-[90vh]",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{className:"text-sm",children:""})]}),e.jsx(Ze,{className:"max-h-[calc(90vh-120px)]",children:e.jsxs(ea,{value:S,onValueChange:O=>U(O),className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2",children:[e.jsx(Xe,{value:"build",children:" "}),e.jsx(Xe,{value:"test",children:" "})]}),e.jsxs(vs,{value:"build",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ae,{ref:A,value:a,onChange:O=>r(O.target.value),className:"font-mono text-sm",placeholder:"..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(rt,{value:l,onChange:O=>c(O.target.value),placeholder:" [] ...",rows:3,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[P.map(O=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:O.category}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:O.items.map(J=>e.jsx(_,{variant:"outline",size:"sm",className:"justify-start h-auto py-2 px-3",onClick:()=>C(J.pattern,J.moveCursor||0),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("span",{className:"text-xs font-medium",children:J.label}),e.jsx("code",{className:"ml-auto text-xs bg-muted px-1.5 py-0.5 rounded font-mono",children:J.pattern})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:J.desc})]})},J.label))})]},O.category)),e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("^(?P<n>\\S{1,20})$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:["^(?P<n>\\S","{1,20}",")$"]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?P<subject>.+?)(?:||)"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?P<subject>.+?)(?:||)"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})})]})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsxs("li",{children:["",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"(?P<>)"})]}),e.jsxs("li",{children:[" reaction  ",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"[]"})," "]}),e.jsx("li",{children:""})]})]})]}),e.jsxs(vs,{value:"test",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:a||"()"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"test-text",className:"text-sm font-medium",children:""}),e.jsx(rt,{id:"test-text",value:h,onChange:O=>f(O.target.value),placeholder:`...
`,className:"min-h-[100px] text-sm"})]}),b&&e.jsxs("div",{className:"rounded-md bg-destructive/10 border border-destructive/20 p-3",children:[e.jsx("p",{className:"text-sm text-destructive font-medium",children:""}),e.jsx("p",{className:"text-xs text-destructive/80 mt-1",children:b})]}),!b&&h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:p&&p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[" (",p.length," )"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:""})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(Ze,{className:"h-40 rounded-md bg-muted p-3",children:e.jsx("div",{className:"text-sm break-words",children:D()})})]}),Object.keys(y).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(Ze,{className:"h-32 rounded-md border p-3",children:e.jsx("div",{className:"space-y-2",children:Object.entries(y).map(([O,J])=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsxs("span",{className:"font-mono font-semibold text-primary min-w-[80px]",children:["[",O,"]"]}),e.jsx("span",{className:"text-muted-foreground",children:"="}),e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded",children:J})]},O))})})]}),Object.keys(y).length>0&&l&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(Ze,{className:"h-48 rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3",children:e.jsx("div",{className:"text-sm break-words",children:w})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"reaction  [name] "})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:"Reaction "}),e.jsx("li",{children:""})]})]})]})]})})]})]})}const cS=Ls.memo(function({keywordReactionConfig:l,responsePostProcessConfig:r,chineseTypoConfig:c,responseSplitterConfig:d,onKeywordReactionChange:u,onResponsePostProcessChange:h,onChineseTypoChange:f,onResponseSplitterChange:p}){const g=()=>{u({...l,regex_rules:[...l.regex_rules,{regex:[""],reaction:""}]})},b=C=>{u({...l,regex_rules:l.regex_rules.filter((D,P)=>P!==C)})},j=(C,D,P)=>{const O=[...l.regex_rules];D==="regex"&&typeof P=="string"?O[C]={...O[C],regex:[P]}:D==="reaction"&&typeof P=="string"&&(O[C]={...O[C],reaction:P}),u({...l,regex_rules:O})},y=()=>{u({...l,keyword_rules:[...l.keyword_rules,{keywords:[],reaction:""}]})},N=C=>{u({...l,keyword_rules:l.keyword_rules.filter((D,P)=>P!==C)})},w=(C,D,P)=>{const O=[...l.keyword_rules];typeof P=="string"&&(O[C]={...O[C],reaction:P}),u({...l,keyword_rules:O})},M=C=>{const D=[...l.keyword_rules];D[C]={...D[C],keywords:[...D[C].keywords||[],""]},u({...l,keyword_rules:D})},A=(C,D)=>{const P=[...l.keyword_rules];P[C]={...P[C],keywords:(P[C].keywords||[]).filter((O,J)=>J!==D)},u({...l,keyword_rules:P})},S=(C,D,P)=>{const O=[...l.keyword_rules],J=[...O[C].keywords||[]];J[D]=P,O[C]={...O[C],keywords:J},u({...l,keyword_rules:O})},U=({rule:C})=>{const D=`{ regex = [${(C.regex||[]).map(P=>`"${P}"`).join(", ")}], reaction = "${C.reaction}" }`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Ze,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs break-all",children:D})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},E=({rule:C})=>{const D=`[[keyword_reaction.keyword_rules]]
keywords = [${(C.keywords||[]).map(P=>`"${P}"`).join(", ")}]
reaction = "${C.reaction}"`;return e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(sl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Ze,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-all",children:D})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:g,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[l.regex_rules.map((C,D)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",D+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(iS,{regex:C.regex&&C.regex[0]||"",reaction:C.reaction,onRegexChange:P=>j(D,"regex",P),onReactionChange:P=>j(D,"reaction",P)}),e.jsx(U,{rule:C}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",D+1," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>b(D),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"Python "}),e.jsx(ae,{value:C.regex&&C.regex[0]||"",onChange:P=>j(D,"regex",P.target.value),placeholder:"^(?P<n>\\\\S{1,20})$ ",className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' (?P<name>pattern) reaction  [name] ""'})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(rt,{value:C.reaction,onChange:P=>j(D,"reaction",P.target.value),placeholder:`...
 [] `,rows:3,className:"text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" []  [n] "})]})]})]},D)),l.regex_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:y,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[l.keyword_rules.map((C,D)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",D+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{rule:C}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",D+1," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>N(D),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(_,{onClick:()=>M(D),size:"sm",variant:"ghost",children:[e.jsx(Ys,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(C.keywords||[]).map((P,O)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{value:P,onChange:J=>S(D,O,J.target.value),placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>A(D,O),size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})]},O)),(!C.keywords||C.keywords.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-2",children:'""'})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(rt,{value:C.reaction,onChange:P=>w(D,"reaction",P.target.value),placeholder:"...",rows:3,className:"text-sm"})]})]})]},D)),l.keyword_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_response_post_process",checked:r.enable_response_post_process,onCheckedChange:C=>h({...r,enable_response_post_process:C})}),e.jsx(T,{htmlFor:"enable_response_post_process",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),r.enable_response_post_process&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ge,{id:"enable_chinese_typo",checked:c.enable,onCheckedChange:C=>f({...c,enable:C})}),e.jsx(T,{htmlFor:"enable_chinese_typo",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),c.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"error_rate",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"error_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.error_rate,onChange:C=>f({...c,error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"min_freq",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"min_freq",type:"number",min:"0",value:c.min_freq,onChange:C=>f({...c,min_freq:parseInt(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"tone_error_rate",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"tone_error_rate",type:"number",step:"0.01",min:"0",max:"1",value:c.tone_error_rate,onChange:C=>f({...c,tone_error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"word_replace_rate",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"word_replace_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.word_replace_rate,onChange:C=>f({...c,word_replace_rate:parseFloat(C.target.value)})})]})]})]})}),e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ge,{id:"enable_response_splitter",checked:d.enable,onCheckedChange:C=>p({...d,enable:C})}),e.jsx(T,{htmlFor:"enable_response_splitter",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),d.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_length",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"max_length",type:"number",min:"1",value:d.max_length,onChange:C=>p({...d,max_length:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_sentence_num",className:"text-xs font-medium",children:""}),e.jsx(ae,{id:"max_sentence_num",type:"number",min:"1",value:d.max_sentence_num,onChange:C=>p({...d,max_sentence_num:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_kaomoji_protection",checked:d.enable_kaomoji_protection,onCheckedChange:C=>p({...d,enable_kaomoji_protection:C})}),e.jsx(T,{htmlFor:"enable_kaomoji_protection",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_overflow_return_all",checked:d.enable_overflow_return_all,onCheckedChange:C=>p({...d,enable_overflow_return_all:C})}),e.jsx(T,{htmlFor:"enable_overflow_return_all",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})})]})]})]})});function oS({config:a,onChange:l}){const[r,c]=m.useState(""),[d,u]=m.useState(""),h=()=>{const y=r.trim();y&&!a.ban_words.includes(y)&&(l({...a,ban_words:[...a.ban_words,y]}),c(""))},f=y=>{l({...a,ban_words:a.ban_words.filter((N,w)=>w!==y)})},p=y=>{y.key==="Enter"&&(y.preventDefault(),h())},g=()=>{const y=d.trim();if(y&&!a.ban_msgs_regex.includes(y))try{new RegExp(y),l({...a,ban_msgs_regex:[...a.ban_msgs_regex,y]}),u("")}catch(N){alert(`${N.message}`)}},b=y=>{l({...a,ban_msgs_regex:a.ban_msgs_regex.filter((N,w)=>w!==y)})},j=y=>{y.key==="Enter"&&(y.preventDefault(),g())};return e.jsx("div",{className:"space-y-6",children:e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:e.jsxs(ea,{defaultValue:"ban_words",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2",children:[e.jsx(Xe,{value:"ban_words",children:""}),e.jsx(Xe,{value:"ban_regex",children:""})]}),e.jsx(vs,{value:"ban_words",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(It,{className:"h-4 w-4 text-yellow-500 mt-1 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bot "})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{placeholder:"",value:r,onChange:y=>c(y.target.value),onKeyDown:p}),e.jsx(_,{onClick:h,size:"icon",children:e.jsx(Ys,{className:"h-4 w-4"})})]}),a.ban_words.length===0?e.jsx("div",{className:"rounded-md border border-dashed p-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}):e.jsx("div",{className:"space-y-2",children:a.ban_words.map((y,N)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsx("code",{className:"text-sm",children:y}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",children:e.jsx(ls,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",e.jsxs("code",{children:['"',y,'"']})," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>f(N),children:""})]})]})]})]},N))})]})}),e.jsx(vs,{value:"ban_regex",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(It,{className:"h-4 w-4 text-yellow-500 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("p",{children:""}),e.jsx("p",{className:"text-xs",children:" "})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(rt,{placeholder:`
https?://[^\\s]+ `,value:d,onChange:y=>u(y.target.value),onKeyDown:j,className:"min-h-[60px] font-mono text-sm"}),e.jsx(_,{onClick:g,size:"icon",children:e.jsx(Ys,{className:"h-4 w-4"})})]}),a.ban_msgs_regex.length===0?e.jsx("div",{className:"rounded-md border border-dashed p-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}):e.jsx("div",{className:"space-y-2",children:a.ban_msgs_regex.map((y,N)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsx("code",{className:"text-sm font-mono flex-1 break-all",children:y}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",className:"ml-2 flex-shrink-0",children:e.jsx(ls,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",e.jsxs("code",{children:['"',y,'"']})," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>b(N),children:""})]})]})]})]},N))})]})})]})})]})})}const dS=Ls.memo(function({config:l,onChange:r}){const[c,d]=m.useState(""),[u,h]=m.useState(""),[f,p]=m.useState(!1),g=l.allowed_ips?l.allowed_ips.split(",").map(S=>S.trim()).filter(S=>S):[],b=l.trusted_proxies?l.trusted_proxies.split(",").map(S=>S.trim()).filter(S=>S):[],j=()=>{if(!c.trim())return;const S=[...g,c.trim()];r({...l,allowed_ips:S.join(",")}),d("")},y=S=>{const U=g.filter((E,C)=>C!==S);r({...l,allowed_ips:U.join(",")})},N=()=>{if(!u.trim())return;const S=[...b,u.trim()];r({...l,trusted_proxies:S.join(",")}),h("")},w=S=>{const U=b.filter((E,C)=>C!==S);r({...l,trusted_proxies:U.join(",")})},M=S=>{!S&&l.enabled?p(!0):r({...l,enabled:S})},A=()=>{r({...l,enabled:!1}),p(!1)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"WebUI "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.enabled,onCheckedChange:M}),e.jsx(T,{className:"cursor-pointer",children:" WebUI"})]}),l.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.mode,onValueChange:S=>r({...l,mode:S}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"development",children:""}),e.jsx(W,{value:"production",children:""})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": WebUI  .env  WEBUI_HOST  WEBUI_PORT"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.anti_crawler_mode,onValueChange:S=>r({...l,anti_crawler_mode:S}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"false",children:""}),e.jsx(W,{value:"basic",children:""}),e.jsx(W,{value:"loose",children:""}),e.jsx(W,{value:"strict",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:"IP "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:c,onChange:S=>d(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),j())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:j,disabled:!c.trim(),children:e.jsx(Ys,{className:"h-4 w-4"})})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:g.map((S,U)=>e.jsxs(Ce,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>y(U),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Aa,{className:"h-3 w-3"})})]},U))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPCIDR127.0.0.1192.168.1.0/24"})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:" IP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:u,onChange:S=>h(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),N())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:N,disabled:!u.trim(),children:e.jsx(Ys,{className:"h-4 w-4"})})]}),b.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:b.map((S,U)=>e.jsxs(Ce,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>w(U),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Aa,{className:"h-3 w-3"})})]},U))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPX-Forwarded-For"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.trust_xff,onCheckedChange:S=>r({...l,trust_xff:S})}),e.jsx(T,{className:"cursor-pointer",children:" X-Forwarded-For "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.secure_cookie,onCheckedChange:S=>r({...l,secure_cookie:S})}),e.jsx(T,{className:"cursor-pointer",children:" Cookie HTTPS"})]})]})]}),e.jsx(gs,{open:f,onOpenChange:p,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:" WebUI"}),e.jsxs(ms,{children:[" WebUI WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{variant:"destructive",onClick:A,children:""})]})]})})]})}),wn="/api/webui/config";async function Ug(){const l=await(await _e(`${wn}/bot`)).json();if(!l.success)throw new Error("");return l.config}async function xn(){const l=await(await _e(`${wn}/model`)).json();if(!l.success)throw new Error("");return l.config}async function $g(a){const r=await(await _e(`${wn}/bot`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function uS(){const l=await(await _e(`${wn}/bot/raw`)).json();if(!l.success)throw new Error("");return l.content}async function mS(a){const r=await(await _e(`${wn}/bot/raw`,{method:"POST",body:JSON.stringify({raw_content:a})})).json();if(!r.success)throw new Error(r.message||"")}async function tc(a){const r=await(await _e(`${wn}/model`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function xS(a,l){const c=await(await _e(`${wn}/bot/section/${a}`,{method:"POST",body:JSON.stringify(l)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function Jm(a,l){const c=await(await _e(`${wn}/model/section/${a}`,{method:"POST",body:JSON.stringify(l)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function hS(a,l="openai",r="/models"){const c=new URLSearchParams({provider_name:a,parser:l,endpoint:r}),d=await _e(`/api/webui/models/list?${c}`);if(!d.ok){const h=await d.json().catch(()=>({}));throw new Error(h.detail||` (${d.status})`)}const u=await d.json();if(!u.success)throw new Error("");return u.models}async function fS(a){const l=new URLSearchParams({provider_name:a}),r=await _e(`/api/webui/models/test-connection-by-name?${l}`,{method:"POST"});if(!r.ok){const c=await r.json().catch(()=>({}));throw new Error(c.detail||` (${r.status})`)}return await r.json()}const pS=Wr("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),it=m.forwardRef(({className:a,variant:l,...r},c)=>e.jsx("div",{ref:c,role:"alert",className:F(pS({variant:l}),a),...r}));it.displayName="Alert";const Gn=m.forwardRef(({className:a,...l},r)=>e.jsx("h5",{ref:r,className:F("mb-1 font-medium leading-none tracking-tight",a),...l}));Gn.displayName="AlertTitle";const ct=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("text-sm [&_p]:leading-relaxed",a),...l}));ct.displayName="AlertDescription";const gS={name:"toml",startState:function(){return{inString:!1,stringType:"",lhs:!0,inArray:0}},token:function(a,l){let r;if(!l.inString&&(r=a.match(/^('''|"""|'|")/))&&(l.stringType=r[0],l.inString=!0),a.sol()&&!l.inString&&l.inArray===0&&(l.lhs=!0),l.inString){for(;l.inString;)if(a.match(l.stringType))l.inString=!1;else if(a.peek()==="\\")a.next(),a.next();else{if(a.eol())break;a.match(/^.[^\\\"\']*/)}return l.lhs?"property":"string"}else{if(l.inArray&&a.peek()==="]")return a.next(),l.inArray--,"bracket";if(l.lhs&&a.peek()==="["&&a.skipTo("]"))return a.next(),a.peek()==="]"&&a.next(),"atom";if(a.peek()==="#")return a.skipToEnd(),"comment";if(a.eatSpace())return null;if(l.lhs&&a.eatWhile(function(c){return c!="="&&c!=" "}))return"property";if(l.lhs&&a.peek()==="=")return a.next(),l.lhs=!1,null;if(!l.lhs&&a.match(/^\d\d\d\d[\d\-\:\.T]*Z/))return"atom";if(!l.lhs&&(a.match("true")||a.match("false")))return"atom";if(!l.lhs&&a.peek()==="[")return l.inArray++,a.next(),"bracket";if(!l.lhs&&a.match(/^\-?\d+(?:\.\d+)?/))return"number";a.eatSpace()||a.next()}return null},languageData:{commentTokens:{line:"#"}}},jS={python:[a1()],json:[l1(),n1()],toml:[t1.define(gS)],text:[]};function Fv({value:a,onChange:l,language:r="text",readOnly:c=!1,height:d="400px",minHeight:u,maxHeight:h,placeholder:f,theme:p="dark",className:g=""}){const[b,j]=m.useState(!1);if(m.useEffect(()=>{j(!0)},[]),!b)return e.jsx("div",{className:`rounded-md border bg-muted animate-pulse ${g}`,style:{height:d,minHeight:u,maxHeight:h}});const y=[...jS[r]||[],Am.lineWrapping,Am.theme({"&":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-content":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-gutters":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-scroller":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'}})];return c&&y.push(Am.editable.of(!1)),e.jsx("div",{className:`rounded-md overflow-hidden border custom-scrollbar ${g}`,children:e.jsx(r1,{value:a,height:d,minHeight:u,maxHeight:h,theme:p==="dark"?i1:void 0,extensions:y,onChange:l,placeholder:f,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightSpecialChars:!0,history:!0,foldGutter:!0,drawSelection:!0,dropCursor:!0,allowMultipleSelections:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:!0,crosshairCursor:!0,highlightActiveLine:!0,highlightSelectionMatches:!0,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:!0,historyKeymap:!0,foldKeymap:!0,completionKeymap:!0,lintKeymap:!0}})})}function vS({id:a,index:l,itemType:r,itemFields:c,value:d,onChange:u,onRemove:h,disabled:f,canRemove:p,placeholder:g}){const{attributes:b,listeners:j,setNodeRef:y,transform:N,transition:w,isDragging:M}=bv({id:a,disabled:f}),A={transform:yv.Transform.toString(N),transition:w};return e.jsxs("div",{ref:y,style:A,className:F("flex items-start gap-2 group",M&&"opacity-50 z-50"),children:[e.jsx("button",{type:"button",className:F("flex-shrink-0 p-2 cursor-grab active:cursor-grabbing","text-muted-foreground hover:text-foreground transition-colors","opacity-0 group-hover:opacity-100 focus:opacity-100",f&&"cursor-not-allowed opacity-30"),...b,...j,children:e.jsx(av,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1 min-w-0",children:r==="object"&&c?e.jsx(NS,{value:d,onChange:u,fields:c,disabled:f}):r==="number"?e.jsx(ae,{type:"number",value:d??"",onChange:S=>u(parseFloat(S.target.value)||0),placeholder:g??` ${l+1} `,disabled:f,className:"font-mono"}):e.jsx(ae,{type:"text",value:d??"",onChange:S=>u(S.target.value),placeholder:g??` ${l+1} `,disabled:f})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:h,disabled:f||!p,className:F("flex-shrink-0 text-muted-foreground hover:text-destructive","opacity-0 group-hover:opacity-100 focus:opacity-100 transition-opacity"),children:e.jsx(ls,{className:"h-4 w-4"})})]})}function NS({value:a,onChange:l,fields:r,disabled:c}){const d=m.useCallback((h,f)=>{l({...a,[h]:f})},[a,l]),u=(h,f)=>{const p=a?.[h];if(f.type==="boolean"||f.type==="switch")return e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(Ge,{checked:!!(p??f.default),onCheckedChange:g=>d(h,g),disabled:c})]});if(f.type==="slider"||f.type==="number"&&f.min!=null&&f.max!=null){const g=p??f.default??f.min??0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g})]}),e.jsx(Qa,{value:[g],onValueChange:b=>d(h,b[0]),min:f.min??0,max:f.max??100,step:f.step??1,disabled:c,className:"py-1"})]})}return f.type==="select"&&f.choices?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsxs(Pe,{value:String(p??f.default??""),onValueChange:g=>d(h,g),disabled:c,children:[e.jsx(Be,{className:"h-8 text-sm",children:e.jsx(Fe,{placeholder:f.placeholder??""})}),e.jsx(Ie,{children:f.choices.map(g=>e.jsx(W,{value:String(g),children:String(g)},String(g)))})]})]}):f.type==="number"?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ae,{type:"number",value:p??f.default??"",onChange:g=>d(h,parseFloat(g.target.value)||0),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ae,{type:"text",value:p??f.default??"",onChange:g=>d(h,g.target.value),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]})};return e.jsx(ke,{className:"p-3 space-y-2 bg-muted/30",children:Object.entries(r).map(([h,f])=>e.jsx("div",{children:u(h,f)},h))})}function bS({value:a,onChange:l,itemType:r="string",itemFields:c,minItems:d,maxItems:u,disabled:h,placeholder:f}){const p=m.useMemo(()=>Array.isArray(a)?a:typeof a=="string"&&a.trim()?a.split(",").map(E=>E.trim()):[],[a]),[g]=m.useState(()=>new Map),b=m.useCallback(E=>(g.has(E)||g.set(E,`item-${Date.now()}-${E}-${Math.random().toString(36).slice(2)}`),g.get(E)),[g]),j=m.useMemo(()=>{const E=[];for(let C=0;C<p.length;C++)E.push(b(C));return E},[p.length,b]),y=xv(qo(pv,{activationConstraint:{distance:8}}),qo(fv,{coordinateGetter:hv})),N=m.useCallback(E=>{const{active:C,over:D}=E;if(D&&C.id!==D.id){const P=j.indexOf(C.id),O=j.indexOf(D.id),J=gv(p,P,O);l(J)}},[p,j,l]),w=m.useCallback(()=>{if(u!=null&&p.length>=u)return;let E;r==="object"&&c?E=Object.fromEntries(Object.entries(c).map(([C,D])=>[C,D.default??""])):r==="number"?E=0:E="",l([...p,E])},[p,u,r,c,l]),M=m.useCallback((E,C)=>{const D=[...p];D[E]=C,l(D)},[p,l]),A=m.useCallback(E=>{if(d!=null&&p.length<=d)return;const C=p.filter((D,P)=>P!==E);g.delete(E),l(C)},[p,d,g,l]),S=u==null||p.length<u,U=d==null||p.length>d;return e.jsxs("div",{className:"space-y-2",children:[p.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-4 justify-center border border-dashed rounded-md",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}):e.jsx(jv,{sensors:y,collisionDetection:vv,onDragEnd:N,children:e.jsx(Nv,{items:j,strategy:c1,children:e.jsx("div",{className:"space-y-2",children:p.map((E,C)=>e.jsx(vS,{id:j[C],index:C,itemType:r,itemFields:c,value:E,onChange:D=>M(C,D),onRemove:()=>A(C),disabled:h,canRemove:U,placeholder:f},j[C]))})})}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:w,disabled:h||!S,className:"w-full",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),"",u!==void 0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",p.length,"/",u,")"]})]}),(d!=null||u!=null)&&(d!==null||u!==null)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:d!=null&&u!=null?` ${d} - ${u} `:d!=null?` ${d} `:` ${u} `})]})}function px({content:a,className:l=""}){return e.jsx("div",{className:`prose prose-sm dark:prose-invert max-w-none ${l}`,children:e.jsx(h1,{remarkPlugins:[p1,g1],rehypePlugins:[f1],components:{code({inline:r,className:c,children:d,...u}){return r?e.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded text-sm font-mono",...u,children:d}):e.jsx("code",{className:`${c} block bg-muted p-4 rounded-lg overflow-x-auto`,...u,children:d})},table({children:r,...c}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"border-collapse border border-border",...c,children:r})})},th({children:r,...c}){return e.jsx("th",{className:"border border-border bg-muted px-4 py-2 text-left font-semibold",...c,children:r})},td({children:r,...c}){return e.jsx("td",{className:"border border-border px-4 py-2",...c,children:r})},a({children:r,...c}){return e.jsx("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...c,children:r})},blockquote({children:r,...c}){return e.jsx("blockquote",{className:"border-l-4 border-primary pl-4 italic text-muted-foreground",...c,children:r})},h1({children:r,...c}){return e.jsx("h1",{className:"text-3xl font-bold mt-6 mb-4",...c,children:r})},h2({children:r,...c}){return e.jsx("h2",{className:"text-2xl font-bold mt-5 mb-3",...c,children:r})},h3({children:r,...c}){return e.jsx("h3",{className:"text-xl font-bold mt-4 mb-2",...c,children:r})},h4({children:r,...c}){return e.jsx("h4",{className:"text-lg font-semibold mt-3 mb-2",...c,children:r})},ul({children:r,...c}){return e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",...c,children:r})},ol({children:r,...c}){return e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",...c,children:r})},p({children:r,...c}){return e.jsx("p",{className:"my-2 leading-relaxed",...c,children:r})},hr({...r}){return e.jsx("hr",{className:"my-4 border-border",...r})}},children:a})})}function yS(a,l){let r=a.slice(0,l).split(/\r\n|\n|\r/g);return[r.length,r.pop().length+1]}function wS(a,l,r){let c=a.split(/\r\n|\n|\r/g),d="",u=(Math.log10(l+1)|0)+1;for(let h=l-1;h<=l+1;h++){let f=c[h-1];f&&(d+=h.toString().padEnd(u," "),d+=":  ",d+=f,d+=`
`,h===l&&(d+=" ".repeat(u+r+2),d+=`^
`))}return d}class Ts extends Error{line;column;codeblock;constructor(l,r){const[c,d]=yS(r.toml,r.ptr),u=wS(r.toml,c,d);super(`Invalid TOML document: ${l}

${u}`,r),this.line=c,this.column=d,this.codeblock=u}}function _S(a,l){let r=0;for(;a[l-++r]==="\\";);return--r&&r%2}function Yo(a,l=0,r=a.length){let c=a.indexOf(`
`,l);return a[c-1]==="\r"&&c--,c<=r?c:-1}function gx(a,l){for(let r=l;r<a.length;r++){let c=a[r];if(c===`
`)return r;if(c==="\r"&&a[r+1]===`
`)return r+1;if(c<" "&&c!=="	"||c==="")throw new Ts("control characters are not allowed in comments",{toml:a,ptr:l})}return a.length}function Ol(a,l,r,c){let d;for(;(d=a[l])===" "||d==="	"||!r&&(d===`
`||d==="\r"&&a[l+1]===`
`);)l++;return c||d!=="#"?l:Ol(a,gx(a,l),r)}function Bg(a,l,r,c,d=!1){if(!c)return l=Yo(a,l),l<0?a.length:l;for(let u=l;u<a.length;u++){let h=a[u];if(h==="#")u=Yo(a,u);else{if(h===r)return u+1;if(h===c||d&&(h===`
`||h==="\r"&&a[u+1]===`
`))return u}}throw new Ts("cannot find end of structure",{toml:a,ptr:l})}function Hv(a,l){let r=a[l],c=r===a[l+1]&&a[l+1]===a[l+2]?a.slice(l,l+3):r;l+=c.length-1;do l=a.indexOf(c,++l);while(l>-1&&r!=="'"&&_S(a,l));return l>-1&&(l+=c.length,c.length>1&&(a[l]===r&&l++,a[l]===r&&l++)),l}let SS=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i;class Kr extends Date{#s=!1;#t=!1;#e=null;constructor(l){let r=!0,c=!0,d="Z";if(typeof l=="string"){let u=l.match(SS);u?(u[1]||(r=!1,l=`0000-01-01T${l}`),c=!!u[2],c&&l[10]===" "&&(l=l.replace(" ","T")),u[2]&&+u[2]>23?l="":(d=u[3]||null,l=l.toUpperCase(),!d&&c&&(l+="Z"))):l=""}super(l),isNaN(this.getTime())||(this.#s=r,this.#t=c,this.#e=d)}isDateTime(){return this.#s&&this.#t}isLocal(){return!this.#s||!this.#t||!this.#e}isDate(){return this.#s&&!this.#t}isTime(){return this.#t&&!this.#s}isValid(){return this.#s||this.#t}toISOString(){let l=super.toISOString();if(this.isDate())return l.slice(0,10);if(this.isTime())return l.slice(11,23);if(this.#e===null)return l.slice(0,-1);if(this.#e==="Z")return l;let r=+this.#e.slice(1,3)*60+ +this.#e.slice(4,6);return r=this.#e[0]==="-"?r:-r,new Date(this.getTime()-r*6e4).toISOString().slice(0,-1)+this.#e}static wrapAsOffsetDateTime(l,r="Z"){let c=new Kr(l);return c.#e=r,c}static wrapAsLocalDateTime(l){let r=new Kr(l);return r.#e=null,r}static wrapAsLocalDate(l){let r=new Kr(l);return r.#t=!1,r.#e=null,r}static wrapAsLocalTime(l){let r=new Kr(l);return r.#s=!1,r.#e=null,r}}let kS=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,CS=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,TS=/^[+-]?0[0-9_]/,ES=/^[0-9a-f]{4,8}$/i,Ig={b:"\b",t:"	",n:`
`,f:"\f",r:"\r",'"':'"',"\\":"\\"};function Vv(a,l=0,r=a.length){let c=a[l]==="'",d=a[l++]===a[l]&&a[l]===a[l+1];d&&(r-=2,a[l+=2]==="\r"&&l++,a[l]===`
`&&l++);let u=0,h,f="",p=l;for(;l<r-1;){let g=a[l++];if(g===`
`||g==="\r"&&a[l]===`
`){if(!d)throw new Ts("newlines are not allowed in strings",{toml:a,ptr:l-1})}else if(g<" "&&g!=="	"||g==="")throw new Ts("control characters are not allowed in strings",{toml:a,ptr:l-1});if(h){if(h=!1,g==="u"||g==="U"){let b=a.slice(l,l+=g==="u"?4:8);if(!ES.test(b))throw new Ts("invalid unicode escape",{toml:a,ptr:u});try{f+=String.fromCodePoint(parseInt(b,16))}catch{throw new Ts("invalid unicode escape",{toml:a,ptr:u})}}else if(d&&(g===`
`||g===" "||g==="	"||g==="\r")){if(l=Ol(a,l-1,!0),a[l]!==`
`&&a[l]!=="\r")throw new Ts("invalid escape: only line-ending whitespace may be escaped",{toml:a,ptr:u});l=Ol(a,l)}else if(g in Ig)f+=Ig[g];else throw new Ts("unrecognized escape sequence",{toml:a,ptr:u});p=l}else!c&&g==="\\"&&(u=l-1,h=!0,f+=a.slice(p,u))}return f+a.slice(p,r-1)}function MS(a,l,r,c){if(a==="true")return!0;if(a==="false")return!1;if(a==="-inf")return-1/0;if(a==="inf"||a==="+inf")return 1/0;if(a==="nan"||a==="+nan"||a==="-nan")return NaN;if(a==="-0")return c?0n:0;let d=kS.test(a);if(d||CS.test(a)){if(TS.test(a))throw new Ts("leading zeroes are not allowed",{toml:l,ptr:r});a=a.replace(/_/g,"");let h=+a;if(isNaN(h))throw new Ts("invalid number",{toml:l,ptr:r});if(d){if((d=!Number.isSafeInteger(h))&&!c)throw new Ts("integer value cannot be represented losslessly",{toml:l,ptr:r});(d||c===!0)&&(h=BigInt(a))}return h}const u=new Kr(a);if(!u.isValid())throw new Ts("invalid value",{toml:l,ptr:r});return u}function AS(a,l,r,c){let d=a.slice(l,r),u=d.indexOf("#");u>-1&&(gx(a,u),d=d.slice(0,u));let h=d.trimEnd();if(!c){let f=d.indexOf(`
`,h.length);if(f>-1)throw new Ts("newlines are not allowed in inline tables",{toml:a,ptr:l+f})}return[h,u]}function jx(a,l,r,c,d){if(c===0)throw new Ts("document contains excessively nested structures. aborting.",{toml:a,ptr:l});let u=a[l];if(u==="["||u==="{"){let[p,g]=u==="["?DS(a,l,c,d):RS(a,l,c,d),b=r?Bg(a,g,",",r):g;if(g-b&&r==="}"){let j=Yo(a,g,b);if(j>-1)throw new Ts("newlines are not allowed in inline tables",{toml:a,ptr:j})}return[p,b]}let h;if(u==='"'||u==="'"){h=Hv(a,l);let p=Vv(a,l,h);if(r){if(h=Ol(a,h,r!=="]"),a[h]&&a[h]!==","&&a[h]!==r&&a[h]!==`
`&&a[h]!=="\r")throw new Ts("unexpected character encountered",{toml:a,ptr:h});h+=+(a[h]===",")}return[p,h]}h=Bg(a,l,",",r);let f=AS(a,l,h-+(a[h-1]===","),r==="]");if(!f[0])throw new Ts("incomplete key-value declaration: no value specified",{toml:a,ptr:l});return r&&f[1]>-1&&(h=Ol(a,l+f[1]),h+=+(a[h]===",")),[MS(f[0],a,l,d),h]}let zS=/^[a-zA-Z0-9-_]+[ \t]*$/;function Xm(a,l,r="="){let c=l-1,d=[],u=a.indexOf(r,l);if(u<0)throw new Ts("incomplete key-value: cannot find end of key",{toml:a,ptr:l});do{let h=a[l=++c];if(h!==" "&&h!=="	")if(h==='"'||h==="'"){if(h===a[l+1]&&h===a[l+2])throw new Ts("multiline strings are not allowed in keys",{toml:a,ptr:l});let f=Hv(a,l);if(f<0)throw new Ts("unfinished string encountered",{toml:a,ptr:l});c=a.indexOf(".",f);let p=a.slice(f,c<0||c>u?u:c),g=Yo(p);if(g>-1)throw new Ts("newlines are not allowed in keys",{toml:a,ptr:l+c+g});if(p.trimStart())throw new Ts("found extra tokens after the string part",{toml:a,ptr:f});if(u<f&&(u=a.indexOf(r,f),u<0))throw new Ts("incomplete key-value: cannot find end of key",{toml:a,ptr:l});d.push(Vv(a,l,f))}else{c=a.indexOf(".",l);let f=a.slice(l,c<0||c>u?u:c);if(!zS.test(f))throw new Ts("only letter, numbers, dashes and underscores are allowed in keys",{toml:a,ptr:l});d.push(f.trimEnd())}}while(c+1&&c<u);return[d,Ol(a,u+1,!0,!0)]}function RS(a,l,r,c){let d={},u=new Set,h,f=0;for(l++;(h=a[l++])!=="}"&&h;){let p={toml:a,ptr:l-1};if(h===`
`)throw new Ts("newlines are not allowed in inline tables",p);if(h==="#")throw new Ts("inline tables cannot contain comments",p);if(h===",")throw new Ts("expected key-value, found comma",p);if(h!==" "&&h!=="	"){let g,b=d,j=!1,[y,N]=Xm(a,l-1);for(let A=0;A<y.length;A++){if(A&&(b=j?b[g]:b[g]={}),g=y[A],(j=Object.hasOwn(b,g))&&(typeof b[g]!="object"||u.has(b[g])))throw new Ts("trying to redefine an already defined value",{toml:a,ptr:l});!j&&g==="__proto__"&&Object.defineProperty(b,g,{enumerable:!0,configurable:!0,writable:!0})}if(j)throw new Ts("trying to redefine an already defined value",{toml:a,ptr:l});let[w,M]=jx(a,N,"}",r-1,c);u.add(w),b[g]=w,l=M,f=a[l-1]===","?l-1:0}}if(f)throw new Ts("trailing commas are not allowed in inline tables",{toml:a,ptr:f});if(!h)throw new Ts("unfinished table encountered",{toml:a,ptr:l});return[d,l]}function DS(a,l,r,c){let d=[],u;for(l++;(u=a[l++])!=="]"&&u;){if(u===",")throw new Ts("expected value, found comma",{toml:a,ptr:l-1});if(u==="#")l=gx(a,l);else if(u!==" "&&u!=="	"&&u!==`
`&&u!=="\r"){let h=jx(a,l-1,"]",r-1,c);d.push(h[0]),l=h[1]}}if(!u)throw new Ts("unfinished array encountered",{toml:a,ptr:l});return[d,l]}function Pg(a,l,r,c){let d=l,u=r,h,f=!1,p;for(let g=0;g<a.length;g++){if(g){if(d=f?d[h]:d[h]={},u=(p=u[h]).c,c===0&&(p.t===1||p.t===2))return null;if(p.t===2){let b=d.length-1;d=d[b],u=u[b].c}}if(h=a[g],(f=Object.hasOwn(d,h))&&u[h]?.t===0&&u[h]?.d)return null;f||(h==="__proto__"&&(Object.defineProperty(d,h,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(u,h,{enumerable:!0,configurable:!0,writable:!0})),u[h]={t:g<a.length-1&&c===2?3:c,d:!1,i:0,c:{}})}if(p=u[h],p.t!==c&&!(c===1&&p.t===3)||(c===2&&(p.d||(p.d=!0,d[h]=[]),d[h].push(d={}),p.c[p.i++]=p={t:1,d:!1,i:0,c:{}}),p.d))return null;if(p.d=!0,c===1)d=f?d[h]:d[h]={};else if(c===0&&f)return null;return[h,d,p.c]}function vx(a,{maxDepth:l=1e3,integersAsBigInt:r}={}){let c={},d={},u=c,h=d;for(let f=Ol(a,0);f<a.length;){if(a[f]==="["){let p=a[++f]==="[",g=Xm(a,f+=+p,"]");if(p){if(a[g[1]-1]!=="]")throw new Ts("expected end of table declaration",{toml:a,ptr:g[1]-1});g[1]++}let b=Pg(g[0],c,d,p?2:1);if(!b)throw new Ts("trying to redefine an already defined table or value",{toml:a,ptr:f});h=b[2],u=b[1],f=g[1]}else{let p=Xm(a,f),g=Pg(p[0],u,h,0);if(!g)throw new Ts("trying to redefine an already defined table or value",{toml:a,ptr:f});let b=jx(a,p[1],void 0,l,r);g[1][g[0]]=b[0],f=b[1]}if(f=Ol(a,f,!0),a[f]&&a[f]!==`
`&&a[f]!=="\r")throw new Ts("each key-value declaration must be followed by an end-of-line",{toml:a,ptr:f});f=Ol(a,f)}return c}let Gv=/^[a-z0-9-_]+$/i;function gc(a){let l=typeof a;if(l==="object"){if(Array.isArray(a))return"array";if(a instanceof Date)return"date"}return l}function OS(a){for(let l=0;l<a.length;l++)if(gc(a[l])!=="object")return!1;return a.length!=0}function Nx(a){return JSON.stringify(a).replace(/\x7f/g,"\\u007f")}function bx(a,l,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");if(l==="number")return isNaN(a)?"nan":a===1/0?"inf":a===-1/0?"-inf":c&&Number.isInteger(a)?a.toFixed(1):a.toString();if(l==="bigint"||l==="boolean")return a.toString();if(l==="string")return Nx(a);if(l==="date"){if(isNaN(a.getTime()))throw new TypeError("cannot serialize invalid date");return a.toISOString()}if(l==="object")return LS(a,r,c);if(l==="array")return US(a,r,c)}function LS(a,l,r){let c=Object.keys(a);if(c.length===0)return"{}";let d="{ ";for(let u=0;u<c.length;u++){let h=c[u];u&&(d+=", "),d+=Gv.test(h)?h:Nx(h),d+=" = ",d+=bx(a[h],gc(a[h]),l-1,r)}return d+" }"}function US(a,l,r){if(a.length===0)return"[]";let c="[ ";for(let d=0;d<a.length;d++){if(d&&(c+=", "),a[d]===null||a[d]===void 0)throw new TypeError("arrays cannot contain null or undefined values");c+=bx(a[d],gc(a[d]),l-1,r)}return c+" ]"}function $S(a,l,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let d="";for(let u=0;u<a.length;u++)d+=`${d&&`
`}[[${l}]]
`,d+=yx(0,a[u],l,r,c);return d}function yx(a,l,r,c,d){if(c===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let u="",h="",f=Object.keys(l);for(let p=0;p<f.length;p++){let g=f[p];if(l[g]!==null&&l[g]!==void 0){let b=gc(l[g]);if(b==="symbol"||b==="function")throw new TypeError(`cannot serialize values of type '${b}'`);let j=Gv.test(g)?g:Nx(g);if(b==="array"&&OS(l[g]))h+=(h&&`
`)+$S(l[g],r?`${r}.${j}`:j,c-1,d);else if(b==="object"){let y=r?`${r}.${j}`:j;h+=(h&&`
`)+yx(y,l[g],y,c-1,d)}else u+=j,u+=" = ",u+=bx(l[g],b,c,d),u+=`
`}}return a&&(u||!h)&&(u=u?`[${a}]
${u}`:`[${a}]`),u&&h?`${u}
${h}`:u||h}function BS(a,{maxDepth:l=1e3,numbersAsFloat:r=!1}={}){if(gc(a)!=="object")throw new TypeError("stringify can only be called with an object");let c=yx(0,a,"",l,r);return c[c.length-1]!==`
`?c+`
`:c}function IS(a,l,r,c={}){const{debounceMs:d=2e3,onSaveSuccess:u,onSaveError:h}=c,f=m.useRef(null),p=m.useCallback(async(y,N)=>{try{l(!0),await xS(y,N),r(!1),u?.()}catch(w){console.error(` ${y} :`,w),r(!0),h?.(w instanceof Error?w:new Error(String(w)))}finally{l(!1)}},[l,r,u,h]),g=m.useCallback((y,N)=>{a||(r(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(y,N)},d))},[a,r,p,d]),b=m.useCallback(async(y,N)=>{f.current&&(clearTimeout(f.current),f.current=null),await p(y,N)},[p]),j=m.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);return m.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),{triggerAutoSave:g,saveNow:b,cancelPendingAutoSave:j}}function Bt(a,l,r,c){m.useEffect(()=>{a&&!r&&c(l,a)},[a])}const PS=500;function FS(){return e.jsx(Wn,{children:e.jsx(HS,{})})}function HS(){const[a,l]=m.useState(!0),[r,c]=m.useState(!1),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState("visual"),[b,j]=m.useState(""),[y,N]=m.useState(!1),[w,M]=m.useState(""),{toast:A}=Ws(),{triggerRestart:S,isRestarting:U}=yn(),[E,C]=m.useState(null),[D,P]=m.useState(null),[O,J]=m.useState(null),[L,oe]=m.useState(null),[Ne,je]=m.useState(null),[de,he]=m.useState(null),[ge,R]=m.useState(null),[Q,$]=m.useState(null),[ue,G]=m.useState(null),[Se,fe]=m.useState(null),[Te,q]=m.useState(null),[B,z]=m.useState(null),[K,Ae]=m.useState(null),[ee,Y]=m.useState(null),[$e,H]=m.useState(null),[se,Ue]=m.useState(null),[ie,Ee]=m.useState(null),[me,ze]=m.useState(null),[at,Pt]=m.useState(null),[qt,Ja]=m.useState(null),As=m.useRef(!0),vt=m.useRef({}),Z=Le=>{const bs=Le.split(`
`);let _s=bs[0];_s=_s.replace(/^Error:\s*/,"");const rs=[[/Invalid TOML document: unrecognized escape sequence/,"TOML  \\\\ "],[/Invalid TOML document: only letter, numbers, dashes and underscores are allowed in keys/,"TOML "],[/Invalid TOML document: (.+)/,"TOML $1"],[/Unexpected character.*at line (\d+), column (\d+)/," $1  $2 "],[/Expected.*at line (\d+), column (\d+)/," $1  $2 "],[/Invalid.*at line (\d+), column (\d+)/," $1  $2 "],[/Unterminated string at line (\d+)/," $1 "],[/Duplicate key.*at line (\d+)/," $1 "],[/Invalid escape sequence at line (\d+)/," $1  \\\\ "],[/Expected.*but got.*at line (\d+)/," $1 "],[/line (\d+), column (\d+)/," $1  $2 "],[/Unexpected end of input/,""],[/Unexpected token/,""],[/Invalid number/,""],[/Invalid date/,""],[/Invalid boolean/," true  false"],[/Unexpected character/,""],[/unrecognized escape sequence/,""]];for(const[ft,zt]of rs)if(ft.test(_s)){_s=_s.replace(ft,zt);break}return bs.length>1?(bs[0]=_s,bs.join(`
`)):_s},qe=m.useCallback(Le=>{vt.current=Le,C(Le.bot),P(Le.personality);const bs=Le.chat;bs.talk_value_rules||(bs.talk_value_rules=[]),J(bs),oe(Le.expression),je(Le.emoji),he(Le.memory),R(Le.tool),$(Le.voice),G(Le.message_receive),fe(Le.dream),q(Le.lpmm_knowledge),z(Le.keyword_reaction),Ae(Le.response_post_process),Y(Le.chinese_typo),H(Le.response_splitter),Ue(Le.log),Ee(Le.debug),ze(Le.maim_message),Pt(Le.telemetry),Ja(Le.webui)},[]),Qe=m.useCallback(()=>({...vt.current,bot:E,personality:D,chat:O,expression:L,emoji:Ne,memory:de,tool:ge,voice:Q,message_receive:ue,dream:Se,lpmm_knowledge:Te,keyword_reaction:B,response_post_process:K,chinese_typo:ee,response_splitter:$e,log:se,debug:ie,maim_message:me,telemetry:at,webui:qt}),[E,D,O,L,Ne,de,ge,Q,ue,Se,Te,B,K,ee,$e,se,ie,me,at,qt]),We=m.useCallback(async()=>{try{const bs=(await uS()).replace(/"([^"]*)"/g,(_s,rs)=>`"${rs.replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\"/g,'"').replace(/\\\\/g,"\\")}"`);j(bs),N(!1)}catch(Le){A({variant:"destructive",title:"",description:Le instanceof Error?Le.message:""})}},[A]),Rs=m.useCallback(async()=>{try{l(!0);const Le=await Ug();qe(Le),f(!1),As.current=!1,await We()}catch(Le){console.error(":",Le),A({title:"",description:"",variant:"destructive"})}finally{l(!1)}},[A,We,qe]);m.useEffect(()=>{Rs()},[Rs]);const{triggerAutoSave:He,cancelPendingAutoSave:Ss}=IS(As.current,u,f);Bt(E,"bot",As.current,He),Bt(D,"personality",As.current,He),Bt(O,"chat",As.current,He),Bt(L,"expression",As.current,He),Bt(Ne,"emoji",As.current,He),Bt(de,"memory",As.current,He),Bt(ge,"tool",As.current,He),Bt(Q,"voice",As.current,He),Bt(Se,"dream",As.current,He),Bt(Te,"lpmm_knowledge",As.current,He),Bt(B,"keyword_reaction",As.current,He),Bt(K,"response_post_process",As.current,He),Bt(ee,"chinese_typo",As.current,He),Bt($e,"response_splitter",As.current,He),Bt(se,"log",As.current,He),Bt(ie,"debug",As.current,He),Bt(me,"maim_message",As.current,He),Bt(at,"telemetry",As.current,He),Bt(qt,"webui",As.current,He);const Ds=async()=>{try{c(!0);try{vx(b)}catch(bs){const _s=bs instanceof Error?bs.message:"TOML ",rs=Z(_s);N(!0),M(rs),A({variant:"destructive",title:"TOML ",description:rs}),c(!1);return}const Le=b.replace(/"([^"]*)"/g,(bs,_s)=>`"${_s.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}"`);await mS(Le),f(!1),N(!1),M(""),A({title:"",description:""}),await Rs()}catch(Le){N(!0);const bs=Le instanceof Error?Le.message:"";M(bs),A({variant:"destructive",title:"",description:bs})}finally{c(!1)}},Vs=async Le=>{if(h){A({variant:"destructive",title:"",description:""});return}if(g(Le),Le==="source")await We();else try{const bs=await Ug();qe(bs),f(!1)}catch(bs){console.error(":",bs),A({title:"",description:"",variant:"destructive"})}},ns=async()=>{try{c(!0),Ss(),await $g(Qe()),f(!1),A({title:"",description:""})}catch(Le){console.error(":",Le),A({title:"",description:Le.message,variant:"destructive"})}finally{c(!1)}},ts=async()=>{await S()},Ns=async()=>{try{c(!0),Ss(),await $g(Qe()),f(!1),A({title:"",description:"..."}),await new Promise(Le=>setTimeout(Le,PS)),await ts()}catch(Le){console.error(":",Le),A({title:"",description:Le.message,variant:"destructive"})}finally{c(!1)}};return a?e.jsx(Ze,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs sm:text-sm",children:""})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(_,{onClick:p==="visual"?ns:Ds,disabled:r||d||!h||U,size:"sm",variant:"outline",className:"w-20 sm:w-24",children:[e.jsx(fc,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:r?"":d?"":h?"":""})]}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{disabled:r||d||U,size:"sm",className:"w-20 sm:w-28",children:[e.jsx(hc,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:U?"":h?"":""})]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:h?",":","})})})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:h?Ns:ts,children:h?"":""})]})]})]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(ea,{value:p,onValueChange:Le=>Vs(Le),className:"w-full",children:e.jsxs(Gt,{className:"h-8 sm:h-9 w-full grid grid-cols-2",children:[e.jsxs(Xe,{value:"visual",className:"text-xs sm:text-sm",children:[e.jsx(lv,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]}),e.jsxs(Xe,{value:"source",className:"text-xs sm:text-sm",children:[e.jsx(nv,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]})]})})})]}),e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs(ct,{children:["",e.jsx("strong",{children:""}),'""']})]}),p==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs(ct,{children:[e.jsx("strong",{children:""})," TOML  TOML ",y&&w&&e.jsxs("div",{className:"text-destructive font-semibold mt-3 p-3 bg-destructive/10 rounded-md",children:[e.jsx("div",{className:"font-bold mb-2",children:" TOML "}),e.jsx("pre",{className:"text-sm font-mono whitespace-pre-wrap break-words",children:w})]})]})]}),e.jsx(Fv,{value:b,onChange:Le=>{j(Le),f(!0),y&&(N(!1),M(""))},language:"toml",theme:"dark",height:"calc(100vh - 280px)",minHeight:"500px",placeholder:"TOML "})]}),p==="visual"&&e.jsx(e.Fragment,{children:e.jsxs(ea,{defaultValue:"bot",className:"w-full",children:[e.jsxs(Gt,{className:"flex flex-wrap h-auto gap-1 p-1 sm:grid sm:grid-cols-5 lg:grid-cols-10",children:[e.jsx(Xe,{value:"bot",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"personality",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"chat",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"expression",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"features",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"processing",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"dream",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"lpmm",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"webui",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:"WebUI"}),e.jsx(Xe,{value:"other",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""})]}),e.jsx(vs,{value:"bot",className:"space-y-4",children:E&&e.jsx(K2,{config:E,onChange:C})}),e.jsx(vs,{value:"personality",className:"space-y-4",children:D&&e.jsx(Q2,{config:D,onChange:P})}),e.jsx(vs,{value:"chat",className:"space-y-4",children:O&&e.jsx(X2,{config:O,onChange:J})}),e.jsx(vs,{value:"expression",className:"space-y-4",children:L&&e.jsx(rS,{config:L,onChange:oe})}),e.jsx(vs,{value:"features",className:"space-y-4",children:Ne&&de&&ge&&Q&&e.jsx(lS,{emojiConfig:Ne,memoryConfig:de,toolConfig:ge,voiceConfig:Q,onEmojiChange:je,onMemoryChange:he,onToolChange:R,onVoiceChange:$})}),e.jsxs(vs,{value:"processing",className:"space-y-4",children:[B&&K&&ee&&$e&&e.jsx(cS,{keywordReactionConfig:B,responsePostProcessConfig:K,chineseTypoConfig:ee,responseSplitterConfig:$e,onKeywordReactionChange:z,onResponsePostProcessChange:Ae,onChineseTypoChange:Y,onResponseSplitterChange:H}),ue&&e.jsx(oS,{config:ue,onChange:G})]}),e.jsx(vs,{value:"dream",className:"space-y-4",children:Se&&e.jsx(Z2,{config:Se,onChange:fe})}),e.jsx(vs,{value:"lpmm",className:"space-y-4",children:Te&&e.jsx(W2,{config:Te,onChange:q})}),e.jsx(vs,{value:"webui",className:"space-y-4",children:qt&&e.jsx(dS,{config:qt,onChange:Ja})}),e.jsxs(vs,{value:"other",className:"space-y-4",children:[se&&e.jsx(eS,{config:se,onChange:Ue}),ie&&e.jsx(sS,{config:ie,onChange:Ee}),me&&e.jsx(tS,{config:me,onChange:ze}),at&&e.jsx(aS,{config:at,onChange:Pt})]})]})}),e.jsx(er,{})]})})}const Ul=m.forwardRef(({className:a,...l},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:F("w-full caption-bottom text-sm",a),...l})}));Ul.displayName="Table";const $l=m.forwardRef(({className:a,...l},r)=>e.jsx("thead",{ref:r,className:F("[&_tr]:border-b",a),...l}));$l.displayName="TableHeader";const Bl=m.forwardRef(({className:a,...l},r)=>e.jsx("tbody",{ref:r,className:F("[&_tr:last-child]:border-0",a),...l}));Bl.displayName="TableBody";const VS=m.forwardRef(({className:a,...l},r)=>e.jsx("tfoot",{ref:r,className:F("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...l}));VS.displayName="TableFooter";const ht=m.forwardRef(({className:a,...l},r)=>e.jsx("tr",{ref:r,className:F("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...l}));ht.displayName="TableRow";const ss=m.forwardRef(({className:a,...l},r)=>e.jsx("th",{ref:r,className:F("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...l}));ss.displayName="TableHead";const Ye=m.forwardRef(({className:a,...l},r)=>e.jsx("td",{ref:r,className:F("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...l}));Ye.displayName="TableCell";const GS=m.forwardRef(({className:a,...l},r)=>e.jsx("caption",{ref:r,className:F("mt-4 text-sm text-muted-foreground",a),...l}));GS.displayName="TableCaption";const dd=m.forwardRef(({className:a,...l},r)=>e.jsx(ja,{ref:r,className:F("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...l}));dd.displayName=ja.displayName;const ud=m.forwardRef(({className:a,...l},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(At,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(ja.Input,{ref:r,className:F("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...l})]}));ud.displayName=ja.Input.displayName;const md=m.forwardRef(({className:a,...l},r)=>e.jsx(ja.List,{ref:r,className:F("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...l}));md.displayName=ja.List.displayName;const xd=m.forwardRef((a,l)=>e.jsx(ja.Empty,{ref:l,className:"py-6 text-center text-sm",...a}));xd.displayName=ja.Empty.displayName;const oc=m.forwardRef(({className:a,...l},r)=>e.jsx(ja.Group,{ref:r,className:F("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...l}));oc.displayName=ja.Group.displayName;const qS=m.forwardRef(({className:a,...l},r)=>e.jsx(ja.Separator,{ref:r,className:F("-mx-1 h-px bg-border",a),...l}));qS.displayName=ja.Separator.displayName;const dc=m.forwardRef(({className:a,...l},r)=>e.jsx(ja.Item,{ref:r,className:F("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...l}));dc.displayName=ja.Item.displayName;const qv=m.createContext(null),Kv="maibot-completed-tours";function KS(){try{const a=localStorage.getItem(Kv);return a?new Set(JSON.parse(a)):new Set}catch{return new Set}}function Fg(a){localStorage.setItem(Kv,JSON.stringify([...a]))}function QS({children:a}){const[l,r]=m.useState({activeTourId:null,stepIndex:0,isRunning:!1}),[c]=m.useState(()=>new Map),[d,u]=m.useState(KS),[,h]=m.useState(0),f=m.useCallback((E,C)=>{c.set(E,C),h(D=>D+1)},[c]),p=m.useCallback(E=>{c.delete(E),r(C=>C.activeTourId===E?{...C,activeTourId:null,isRunning:!1,stepIndex:0}:C)},[c]),g=m.useCallback((E,C=0)=>{c.has(E)&&r({activeTourId:E,stepIndex:C,isRunning:!0})},[c]),b=m.useCallback(()=>{r(E=>({...E,isRunning:!1}))},[]),j=m.useCallback(E=>{r(C=>({...C,stepIndex:E}))},[]),y=m.useCallback(()=>{r(E=>({...E,stepIndex:E.stepIndex+1}))},[]),N=m.useCallback(()=>{r(E=>({...E,stepIndex:Math.max(0,E.stepIndex-1)}))},[]),w=m.useCallback(()=>l.activeTourId?c.get(l.activeTourId)||[]:[],[l.activeTourId,c]),M=m.useCallback(E=>{u(C=>{const D=new Set(C);return D.add(E),Fg(D),D})},[]),A=m.useCallback(E=>{const{action:C,index:D,status:P,type:O}=E,J=["finished","skipped"];if(C==="close"){r(L=>({...L,isRunning:!1,stepIndex:0}));return}J.includes(P)?r(L=>(P==="finished"&&L.activeTourId&&setTimeout(()=>M(L.activeTourId),0),{...L,isRunning:!1,stepIndex:0})):O==="step:after"&&(C==="next"?r(L=>({...L,stepIndex:D+1})):C==="prev"&&r(L=>({...L,stepIndex:D-1})))},[M]),S=m.useCallback(E=>d.has(E),[d]),U=m.useCallback(E=>{u(C=>{const D=new Set(C);return D.delete(E),Fg(D),D})},[]);return e.jsx(qv.Provider,{value:{state:l,tours:c,registerTour:f,unregisterTour:p,startTour:g,stopTour:b,goToStep:j,nextStep:y,prevStep:N,getCurrentSteps:w,handleJoyrideCallback:A,isTourCompleted:S,markTourCompleted:M,resetTourCompleted:U},children:a})}function wx(){const a=m.useContext(qv);if(!a)throw new Error("useTour must be used within a TourProvider");return a}const YS={options:{zIndex:1e4,primaryColor:"hsl(var(--primary))",textColor:"hsl(var(--foreground))",backgroundColor:"hsl(var(--background))",arrowColor:"hsl(var(--background))",overlayColor:"rgba(0, 0, 0, 0.5)"},tooltip:{borderRadius:"var(--radius)",padding:"1rem"},tooltipContainer:{textAlign:"left"},tooltipTitle:{fontSize:"1rem",fontWeight:600,marginBottom:"0.5rem"},tooltipContent:{fontSize:"0.875rem",padding:"0.5rem 0"},buttonNext:{backgroundColor:"hsl(var(--primary))",color:"hsl(var(--primary-foreground))",borderRadius:"calc(var(--radius) - 2px)",fontSize:"0.875rem",padding:"0.5rem 1rem"},buttonBack:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem",marginRight:"0.5rem"},buttonSkip:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem"},buttonClose:{color:"hsl(var(--muted-foreground))"},spotlight:{borderRadius:"var(--radius)"}},JS={back:"",close:"",last:"",next:"",nextLabelWithProgress:" ({step}/{steps})",open:"",skip:""};function XS(){const{state:a,getCurrentSteps:l,handleJoyrideCallback:r}=wx(),c=l(),[d,u]=m.useState(!1),h=m.useRef(a.stepIndex),f=m.useRef(null);m.useEffect(()=>{h.current!==a.stepIndex&&(u(!1),h.current=a.stepIndex)},[a.stepIndex]),m.useEffect(()=>{if(!a.isRunning||c.length===0){u(!1);return}const j=c[a.stepIndex];if(!j){u(!1);return}const y=j.target;if(y==="body"){u(!0);return}u(!1);const N=setTimeout(()=>{const w=()=>{const U=document.querySelector(y);if(U){const E=U.getBoundingClientRect();if(E.width>0&&E.height>0)return!0}return!1};if(w()){setTimeout(()=>u(!0),100);return}const M=setInterval(()=>{w()&&(clearInterval(M),setTimeout(()=>u(!0),100))},100),A=setTimeout(()=>{clearInterval(M),u(!0)},5e3),S=()=>{clearInterval(M),clearTimeout(A)};f.current=S},150);return()=>{clearTimeout(N),f.current&&(f.current(),f.current=null)}},[a.isRunning,a.stepIndex,c]);const[p,g]=m.useState(null);if(m.useEffect(()=>{let j=document.getElementById("tour-portal-container");return j||(j=document.createElement("div"),j.id="tour-portal-container",j.style.cssText="position: fixed; top: 0; left: 0; z-index: 99999; pointer-events: none;",document.body.appendChild(j)),g(j),()=>{}},[]),!a.isRunning||c.length===0||!d)return null;const b=e.jsx(d1,{steps:c,stepIndex:a.stepIndex,run:a.isRunning,continuous:!0,showSkipButton:!0,showProgress:!0,disableOverlayClose:!0,disableScrolling:!1,disableScrollParentFix:!1,callback:r,styles:YS,locale:JS,scrollOffset:80,scrollToFirstStep:!0,floaterProps:{styles:{floater:{zIndex:99999}},disableAnimation:!0}},`tour-step-${a.stepIndex}`);return p?Q0.createPortal(b,p):b}const ol="model-assignment-tour",Qv=[{target:"body",content:"",placement:"center",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="sidebar-model-provider"]',content:' DeepSeek Siliconflow""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-provider-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="provider-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-apikey-input"]',content:" API  API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-url-input"]',content:" API API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-template-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="sidebar-model-management"]',content:'""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-model-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="model-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-provider-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-identifier-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="tasks-tab-trigger"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="task-model-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1}],Yv={0:"/config/model",1:"/config/model",2:"/config/modelProvider",3:"/config/modelProvider",4:"/config/modelProvider",5:"/config/modelProvider",6:"/config/modelProvider",7:"/config/modelProvider",8:"/config/modelProvider",9:"/config/modelProvider",10:"/config/modelProvider",11:"/config/model",12:"/config/model",13:"/config/model",14:"/config/model",15:"/config/model",16:"/config/model",17:"/config/model",18:"/config/model",19:"/config/model"},Xi=[{id:"siliconflow",name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",client_type:"openai",display_name:" (SiliconFlow)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"deepseek",name:"DeepSeek",base_url:"https://api.deepseek.com",client_type:"openai",display_name:"DeepSeek",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"rinkoai",name:"RinkoAI",base_url:"https://rinkoai.com/v1",client_type:"openai",display_name:"RinkoAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"zhipu",name:"ZhipuAI",base_url:"https://open.bigmodel.cn/api/paas/v4",client_type:"openai",display_name:" AI (ZhipuAI / GLM)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"moonshot",name:"Moonshot",base_url:"https://api.moonshot.cn/v1",client_type:"openai",display_name:" (Moonshot / Kimi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"doubao",name:"Doubao",base_url:"https://ark.cn-beijing.volces.com/api/v3",client_type:"openai",display_name:" (Doubao)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"alibaba",name:"Alibaba",base_url:"https://dashscope.aliyuncs.com/compatible-mode/v1",client_type:"openai",display_name:" (Alibaba Qwen)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"baichuan",name:"Baichuan",base_url:"https://api.baichuan-ai.com/v1",client_type:"openai",display_name:" (Baichuan)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"minimax",name:"MiniMax",base_url:"https://api.minimax.chat/v1",client_type:"openai",display_name:"MiniMax ( AI)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"stepfun",name:"StepFun",base_url:"https://api.stepfun.com/v1",client_type:"openai",display_name:" (StepFun)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"lingyi",name:"Lingyi",base_url:"https://api.lingyiwanwu.com/v1",client_type:"openai",display_name:" (Lingyi / Yi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"openai",name:"OpenAI",base_url:"https://api.openai.com/v1",client_type:"openai",display_name:"OpenAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"xai",name:"xAI",base_url:"https://api.x.ai/v1",client_type:"openai",display_name:"xAI (Grok)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"anthropic",name:"Anthropic",base_url:"https://api.anthropic.com/v1",client_type:"openai",display_name:"Anthropic (Claude)"},{id:"gemini",name:"Gemini",base_url:"https://generativelanguage.googleapis.com/v1beta",client_type:"gemini",display_name:"Google Gemini",modelFetcher:{endpoint:"/models",parser:"gemini"}},{id:"cohere",name:"Cohere",base_url:"https://api.cohere.ai/v1",client_type:"openai",display_name:"Cohere"},{id:"groq",name:"Groq",base_url:"https://api.groq.com/openai/v1",client_type:"openai",display_name:"Groq",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"together",name:"Together AI",base_url:"https://api.together.xyz/v1",client_type:"openai",display_name:"Together AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"fireworks",name:"Fireworks",base_url:"https://api.fireworks.ai/inference/v1",client_type:"openai",display_name:"Fireworks AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"mistral",name:"Mistral",base_url:"https://api.mistral.ai/v1",client_type:"openai",display_name:"Mistral AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"perplexity",name:"Perplexity",base_url:"https://api.perplexity.ai",client_type:"openai",display_name:"Perplexity AI"},{id:"custom",name:"",base_url:"",client_type:"openai",display_name:""}];function Hg(a){return a?a.replace(/\/+$/,"").toLowerCase():""}function ZS(a){if(!a)return null;const l=Hg(a);return Xi.find(r=>r.id!=="custom"&&Hg(r.base_url)===l)||null}const Do=a=>({...a,max_retry:a.max_retry??2,timeout:a.timeout??30,retry_interval:a.retry_interval??10}),WS=(a,l=[],r=null)=>{const c={};return a?(a.name?.trim()?l.some((u,h)=>r!==null&&h===r?!1:u.name.trim().toLowerCase()===a.name.trim().toLowerCase())&&(c.name=""):c.name="",a.base_url?.trim()||(c.base_url=" URL"),a.api_key?.trim()||(c.api_key=" API Key"),{isValid:Object.keys(c).length===0,errors:c}):{isValid:!1,errors:{name:""}}};function e4(){return e.jsx(Wn,{children:e.jsx(s4,{})})}function s4(){const[a,l]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[b,j]=m.useState(!1),[y,N]=m.useState(null),[w,M]=m.useState(null),[A,S]=m.useState("custom"),[U,E]=m.useState(!1),[C,D]=m.useState(!1),[P,O]=m.useState(null),[J,L]=m.useState(!1),[oe,Ne]=m.useState(""),[je,de]=m.useState(new Set),[he,ge]=m.useState(!1),[R,Q]=m.useState(1),[$,ue]=m.useState(20),[G,Se]=m.useState(""),[fe,Te]=m.useState({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),[q,B]=m.useState({}),[z,K]=m.useState(new Set),[Ae,ee]=m.useState(new Map),{toast:Y}=Ws(),$e=ca(),{state:H,goToStep:se,registerTour:Ue}=wx(),{triggerRestart:ie,isRestarting:Ee}=yn(),me=m.useRef(null),ze=m.useRef(!0);m.useEffect(()=>{Ue(ol,Qv)},[Ue]),m.useEffect(()=>{if(H.activeTourId===ol&&H.isRunning){const te=Yv[H.stepIndex];te&&!window.location.pathname.endsWith(te.replace("/config/",""))&&$e({to:te})}},[H.stepIndex,H.activeTourId,H.isRunning,$e]);const at=m.useRef(H.stepIndex);m.useEffect(()=>{if(H.activeTourId===ol&&H.isRunning){const te=at.current,we=H.stepIndex;te>=3&&te<=9&&we<3&&j(!1),te>=10&&we>=3&&we<=9&&(B({}),S("custom"),N({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10}),M(null),L(!1),j(!0)),at.current=we}},[H.stepIndex,H.activeTourId,H.isRunning]),m.useEffect(()=>{if(H.activeTourId!==ol||!H.isRunning)return;const te=we=>{const Oe=we.target,Gs=H.stepIndex;Gs===2&&Oe.closest('[data-tour="add-provider-button"]')?setTimeout(()=>se(3),300):Gs===9&&Oe.closest('[data-tour="provider-cancel-button"]')&&setTimeout(()=>se(10),300)};return document.addEventListener("click",te,!0),()=>document.removeEventListener("click",te,!0)},[H,se]),m.useEffect(()=>{Pt()},[]);const Pt=async()=>{try{c(!0);const te=await xn();l(te.api_providers||[]),g(!1),ze.current=!1}catch(te){console.error(":",te)}finally{c(!1)}},qt=async()=>{await ie()},Ja=async()=>{try{u(!0),me.current&&clearTimeout(me.current);const te=a.map(dt=>({...dt,max_retry:dt.max_retry??2,timeout:dt.timeout??30,retry_interval:dt.retry_interval??10})),{shouldProceed:we}=await As(te,"restart");if(!we){u(!1);return}const Oe=await xn(),Gs=new Set(te.map(dt=>dt.name)),ta=(Oe.models||[]).filter(dt=>Gs.has(dt.api_provider));Oe.api_providers=te,Oe.models=ta,await tc(Oe),g(!1),Y({title:"",description:"..."}),await qt()}catch(te){console.error(":",te),Y({title:"",description:te.message,variant:"destructive"}),u(!1)}},As=m.useCallback(async(te,we="auto")=>{try{const Oe=await xn(),Gs=new Set(a.map(pt=>pt.name)),Ut=new Set(te.map(pt=>pt.name)),ta=Array.from(Gs).filter(pt=>!Ut.has(pt));if(ta.length===0)return{shouldProceed:!0,providers:te};const aa=(Oe.models||[]).filter(pt=>ta.includes(pt.api_provider));return aa.length===0?{shouldProceed:!0,providers:te}:(Te({isOpen:!0,providersToDelete:ta,affectedModels:aa,pendingProviders:te,context:we,oldProviders:[...a]}),{shouldProceed:!1,providers:te})}catch(Oe){return console.error(":",Oe),{shouldProceed:!0,providers:te}}},[a]),vt=async()=>{try{(fe.context==="auto"?f:u)(!0),Te(pt=>({...pt,isOpen:!1}));const we=await xn(),Oe=fe.pendingProviders.map(Do),Gs=new Set(Oe.map(pt=>pt.name)),ta=(we.models||[]).filter(pt=>Gs.has(pt.api_provider)),dt=new Set(fe.affectedModels.map(pt=>pt.name)),aa=we.model_task_config;aa&&Object.keys(aa).forEach(pt=>{const re=aa[pt];re&&Array.isArray(re.model_list)&&(re.model_list=re.model_list.filter(pe=>!dt.has(pe)))}),we.api_providers=Oe,we.models=ta,we.model_task_config=aa,await tc(we),l(fe.pendingProviders),g(!1),Y({title:"",description:` ${fe.providersToDelete.length}  ${fe.affectedModels.length} `}),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),de(new Set),fe.context==="restart"&&await qt()}catch(te){console.error(":",te),Y({title:"",description:te.message,variant:"destructive"})}finally{fe.context==="auto"?f(!1):u(!1)}},Z=()=>{fe.oldProviders.length>0&&l(fe.oldProviders),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),g(!1)},qe=m.useCallback(async te=>{if(ze.current)return;const{shouldProceed:we}=await As(te,"auto");if(!we){g(!0);return}try{f(!0);const Oe=te.map(Do);await Jm("api_providers",Oe),g(!1)}catch(Oe){console.error(":",Oe),Y({title:"",description:Oe.message,variant:"destructive"}),g(!0)}finally{f(!1)}},[a,As]);m.useEffect(()=>{if(!ze.current)return g(!0),me.current&&clearTimeout(me.current),me.current=setTimeout(()=>{qe(a)},2e3),()=>{me.current&&clearTimeout(me.current)}},[a,qe]);const Qe=async()=>{try{u(!0),me.current&&clearTimeout(me.current);const te=a.map(Do),{shouldProceed:we}=await As(te,"manual");if(!we){u(!1);return}const Oe=await xn(),Gs=new Set(te.map(dt=>dt.name)),Ut=Oe.models||[],ta=Ut.filter(dt=>{const aa=Gs.has(dt.api_provider);return aa||console.warn(` "${dt.name}"  "${dt.api_provider}"`),aa});if(Ut.length!==ta.length){const dt=Ut.length-ta.length;Y({title:"",description:` ${dt} `,variant:"default"})}console.log(" providers :",te),Oe.api_providers=te,Oe.models=ta,console.log(":",Oe),await tc(Oe),g(!1),Y({title:"",description:""})}catch(te){console.error(":",te),Y({title:"",description:te.message,variant:"destructive"})}finally{u(!1)}},We=(te,we)=>{if(B({}),te){const Oe=Xi.find(Gs=>Gs.base_url===te.base_url&&Gs.client_type===te.client_type);S(Oe?.id||"custom"),N(te)}else S("custom"),N({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10});M(we),L(!1),j(!0)},Rs=m.useCallback(te=>{S(te),E(!1);const we=Xi.find(Oe=>Oe.id===te);we&&we.id!=="custom"?N(Oe=>({...Oe,name:we.name,base_url:we.base_url,client_type:we.client_type})):we?.id==="custom"&&N(Oe=>({...Oe,name:"",base_url:"",client_type:"openai"}))},[]),He=m.useMemo(()=>A!=="custom",[A]),Ss=m.useCallback(async()=>{if(y?.api_key)try{await navigator.clipboard.writeText(y.api_key),Y({title:"",description:"API Key "})}catch{Y({title:"",description:"",variant:"destructive"})}},[y?.api_key,Y]),Ds=()=>{if(!y)return;const{isValid:te,errors:we}=WS(y,a,w);if(!te){B(we);return}B({});const Oe=Do(y);if(w!==null){const Gs=[...a];Gs[w]=Oe,l(Gs)}else l([...a,Oe]);j(!1),N(null),M(null)},Vs=te=>{if(!te&&y){const we={...y,max_retry:y.max_retry??2,timeout:y.timeout??30,retry_interval:y.retry_interval??10};N(we)}j(te)},ns=te=>{O(te),D(!0)},ts=async()=>{if(P!==null){const te=a.filter((Oe,Gs)=>Gs!==P),{shouldProceed:we}=await As(te,"manual");we&&(l(te),Y({title:"",description:""}))}D(!1),O(null)},Ns=te=>{const we=new Set(je);we.has(te)?we.delete(te):we.add(te),de(we)},Le=()=>{if(je.size===rs.length)de(new Set);else{const te=rs.map((we,Oe)=>a.findIndex(Gs=>Gs===rs[Oe]));de(new Set(te))}},bs=()=>{if(je.size===0){Y({title:"",description:"",variant:"default"});return}ge(!0)},_s=async()=>{const te=a.filter((Oe,Gs)=>!je.has(Gs)),{shouldProceed:we}=await As(te,"manual");we&&(l(te),de(new Set),Y({title:"",description:` ${je.size} `})),ge(!1)},rs=m.useMemo(()=>{if(!oe)return a;const te=oe.toLowerCase();return a.filter(we=>we.name.toLowerCase().includes(te)||we.base_url.toLowerCase().includes(te)||we.client_type.toLowerCase().includes(te))},[a,oe]),{totalPages:ft,paginatedProviders:zt}=m.useMemo(()=>{const te=Math.ceil(rs.length/$),we=rs.slice((R-1)*$,R*$);return{totalPages:te,paginatedProviders:we}},[rs,R,$]),Oa=m.useCallback(()=>{const te=parseInt(G);te>=1&&te<=ft&&(Q(te),Se(""))},[G,ft]),ll=async te=>{K(we=>new Set(we).add(te));try{const we=await fS(te);ee(Oe=>new Map(Oe).set(te,we)),we.network_ok?we.api_key_valid===!0?Y({title:"",description:`${te} API Key  (${we.latency_ms}ms)`}):we.api_key_valid===!1?Y({title:" Key ",description:`${te}  API Key `,variant:"destructive"}):Y({title:"",description:`${te}  (${we.latency_ms}ms)`}):Y({title:"",description:we.error||"",variant:"destructive"})}catch(we){Y({title:"",description:we.message,variant:"destructive"})}finally{K(we=>{const Oe=new Set(we);return Oe.delete(te),Oe})}},xl=async()=>{for(const te of a)await ll(te.name)},sr=te=>{const we=z.has(te),Oe=Ae.get(te);return we?e.jsxs(Ce,{variant:"secondary",className:"gap-1",children:[e.jsx(Os,{className:"h-3 w-3 animate-spin"}),""]}):Oe?Oe.network_ok?Oe.api_key_valid===!0?e.jsxs(Ce,{className:"gap-1 bg-green-600 hover:bg-green-700",children:[e.jsx(bt,{className:"h-3 w-3"}),""]}):Oe.api_key_valid===!1?e.jsxs(Ce,{variant:"destructive",className:"gap-1",children:[e.jsx(Ct,{className:"h-3 w-3"}),"Key"]}):e.jsxs(Ce,{className:"gap-1 bg-blue-600 hover:bg-blue-700",children:[e.jsx(bt,{className:"h-3 w-3"}),""]}):e.jsxs(Ce,{variant:"destructive",className:"gap-1",children:[e.jsx(Ka,{className:"h-3 w-3"}),""]}):null};return r?e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"AI"}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" AI  API "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[je.size>0&&e.jsxs(_,{onClick:bs,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ls,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",je.size,")"]}),e.jsxs(_,{onClick:xl,size:"sm",variant:"outline",className:"w-full sm:w-auto",disabled:a.length===0||z.size>0,children:[e.jsx(el,{className:"mr-2 h-4 w-4"}),z.size>0?` (${z.size})`:""]}),e.jsxs(_,{onClick:()=>We(null,null),size:"sm",className:"w-full sm:w-auto","data-tour":"add-provider-button",children:[e.jsx(Ys,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{onClick:Qe,disabled:d||h||!p||Ee,size:"sm",variant:"outline",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),d?"...":h?"...":p?"":""]}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{disabled:d||h||Ee,size:"sm",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Ee?"...":p?"":""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:p?",":","})})})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:p?Ja:qt,children:p?"":""})]})]})]})]})]}),e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs(ct,{children:["",e.jsx("strong",{children:""}),'""']})]}),e.jsxs(Ze,{className:"h-[calc(100vh-260px)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"URL ...",value:oe,onChange:te=>Ne(te.target.value),className:"pl-9"})]}),oe&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",rs.length," "]})]}),e.jsx("div",{className:"md:hidden space-y-3",children:rs.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8 rounded-lg border bg-card",children:oe?"":'""'}):zt.map((te,we)=>{const Oe=a.findIndex(Gs=>Gs===te);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-base truncate",children:te.name}),sr(te.name)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 break-all",children:te.base_url})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ll(te.name),disabled:z.has(te.name),title:"",children:z.has(te.name)?e.jsx(Os,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsx(_,{variant:"default",size:"sm",onClick:()=>We(te,Oe),children:e.jsx(Kn,{className:"h-4 w-4",strokeWidth:2,fill:"none"})}),e.jsx(_,{size:"sm",onClick:()=>ns(Oe),className:"bg-red-600 hover:bg-red-700 text-white",children:e.jsx(ls,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:te.client_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:te.max_retry})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:te.timeout})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:te.retry_interval})]})]})]},we)})}),e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{className:"w-12",children:e.jsx(Js,{checked:je.size===rs.length&&rs.length>0,onCheckedChange:Le})}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:"URL"}),e.jsx(ss,{children:""}),e.jsx(ss,{className:"text-right",children:""}),e.jsx(ss,{className:"text-right",children:"()"}),e.jsx(ss,{className:"text-right",children:"()"}),e.jsx(ss,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:zt.length===0?e.jsx(ht,{children:e.jsx(Ye,{colSpan:9,className:"text-center text-muted-foreground py-8",children:oe?"":'""'})}):zt.map((te,we)=>{const Oe=a.findIndex(Gs=>Gs===te);return e.jsxs(ht,{children:[e.jsx(Ye,{children:e.jsx(Js,{checked:je.has(Oe),onCheckedChange:()=>Ns(Oe)})}),e.jsx(Ye,{children:sr(te.name)||e.jsx(Ce,{variant:"outline",className:"text-muted-foreground",children:""})}),e.jsx(Ye,{className:"font-medium",children:te.name}),e.jsx(Ye,{className:"max-w-xs truncate",title:te.base_url,children:te.base_url}),e.jsx(Ye,{children:te.client_type}),e.jsx(Ye,{className:"text-right",children:te.max_retry}),e.jsx(Ye,{className:"text-right",children:te.timeout}),e.jsx(Ye,{className:"text-right",children:te.retry_interval}),e.jsx(Ye,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ll(te.name),disabled:z.has(te.name),title:"",children:z.has(te.name)?e.jsx(Os,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>We(te,Oe),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>ns(Oe),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},we)})})]})})}),rs.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-provider",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:$.toString(),onValueChange:te=>{ue(parseInt(te)),Q(1),de(new Set)},children:[e.jsx(Be,{id:"page-size-provider",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(R-1)*$+1," "," ",Math.min(R*$,rs.length),"  ",rs.length," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Q(1),disabled:R===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Q(te=>Math.max(1,te-1)),disabled:R===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:G,onChange:te=>Se(te.target.value),onKeyDown:te=>te.key==="Enter"&&Oa(),placeholder:R.toString(),className:"w-16 h-8 text-center",min:1,max:ft}),e.jsx(_,{variant:"outline",size:"sm",onClick:Oa,disabled:!G,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Q(te=>te+1),disabled:R>=ft,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Q(ft),disabled:R>=ft,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]}),e.jsx(Fs,{open:b,onOpenChange:Vs,children:e.jsxs(Us,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"provider-dialog",preventOutsideClose:H.isRunning,children:[e.jsxs($s,{children:[e.jsx(Bs,{children:w!==null?"":""}),e.jsx(Xs,{children:" API "})]}),e.jsxs("form",{onSubmit:te=>{te.preventDefault(),Ds()},autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"provider-template-select",children:[e.jsx(T,{htmlFor:"template",children:""}),e.jsxs(ul,{open:U,onOpenChange:E,children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":U,className:"w-full justify-between",children:[A?Xi.find(te=>te.id===A)?.display_name:"...",e.jsx(ix,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(sl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(Ze,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:""}),e.jsx(oc,{children:Xi.map(te=>e.jsxs(dc,{value:te.display_name,onSelect:()=>Rs(te.id),children:[e.jsx(Mt,{className:`mr-2 h-4 w-4 ${A===te.id?"opacity-100":"opacity-0"}`}),te.display_name]},te.id))})]})})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" URL ,"})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-name-input",children:[e.jsx(T,{htmlFor:"name",className:q.name?"text-destructive":"",children:" *"}),e.jsx(ae,{id:"name",value:y?.name||"",onChange:te=>{N(we=>we?{...we,name:te.target.value}:null),q.name&&B(we=>({...we,name:void 0}))},placeholder:": DeepSeek, SiliconFlow",className:q.name?"border-destructive focus-visible:ring-destructive":""}),q.name&&e.jsx("p",{className:"text-xs text-destructive",children:q.name})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-url-input",children:[e.jsx(T,{htmlFor:"base_url",className:q.base_url?"text-destructive":"",children:" URL *"}),e.jsx(ae,{id:"base_url",value:y?.base_url||"",onChange:te=>{N(we=>we?{...we,base_url:te.target.value}:null),q.base_url&&B(we=>({...we,base_url:void 0}))},placeholder:"https://api.example.com/v1",disabled:He,className:`${He?"bg-muted cursor-not-allowed":""} ${q.base_url?"border-destructive focus-visible:ring-destructive":""}`}),q.base_url&&e.jsx("p",{className:"text-xs text-destructive",children:q.base_url}),He&&!q.base_url&&e.jsx("p",{className:"text-xs text-muted-foreground",children:' URL ,""'})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-apikey-input",children:[e.jsx(T,{htmlFor:"api_key",className:q.api_key?"text-destructive":"",children:"API Key *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{id:"api_key",type:J?"text":"password",value:y?.api_key||"",onChange:te=>{N(we=>we?{...we,api_key:te.target.value}:null),q.api_key&&B(we=>({...we,api_key:void 0}))},placeholder:"sk-...",className:`flex-1 ${q.api_key?"border-destructive focus-visible:ring-destructive":""}`}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:()=>L(!J),title:J?"":"",children:J?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:Ss,title:"",children:e.jsx(Fo,{className:"h-4 w-4"})})]}),q.api_key&&e.jsx("p",{className:"text-xs text-destructive",children:q.api_key})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"client_type",children:""}),e.jsxs(Pe,{value:y?.client_type||"openai",onValueChange:te=>N(we=>we?{...we,client_type:te}:null),disabled:He,children:[e.jsx(Be,{id:"client_type",className:He?"bg-muted cursor-not-allowed":"",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"openai",children:"OpenAI"}),e.jsx(W,{value:"gemini",children:"Gemini"})]})]}),He&&e.jsx("p",{className:"text-xs text-muted-foreground",children:',""'})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_retry",children:""}),e.jsx(ae,{id:"max_retry",type:"number",min:"0",value:y?.max_retry??"",onChange:te=>{const we=te.target.value===""?null:parseInt(te.target.value);N(Oe=>Oe?{...Oe,max_retry:we}:null)},placeholder:": 2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"timeout",children:"()"}),e.jsx(ae,{id:"timeout",type:"number",min:"1",value:y?.timeout??"",onChange:te=>{const we=te.target.value===""?null:parseInt(te.target.value);N(Oe=>Oe?{...Oe,timeout:we}:null)},placeholder:": 30"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"retry_interval",children:"()"}),e.jsx(ae,{id:"retry_interval",type:"number",min:"1",value:y?.retry_interval??"",onChange:te=>{const we=te.target.value===""?null:parseInt(te.target.value);N(Oe=>Oe?{...Oe,retry_interval:we}:null)},placeholder:": 10"})]})]})]}),e.jsxs(nt,{children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>j(!1),"data-tour":"provider-cancel-button",children:""}),e.jsx(_,{type:"submit","data-tour":"provider-save-button",children:""})]})]})]})}),e.jsx(gs,{open:C,onOpenChange:D,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',P!==null?a[P]?.name:"",'"  ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:ts,children:""})]})]})}),e.jsx(gs,{open:he,onOpenChange:ge,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",je.size,"  "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:_s,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(gs,{open:fe.isOpen,onOpenChange:te=>Te(we=>({...we,isOpen:te})),children:e.jsxs(cs,{className:"max-w-2xl",children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{asChild:!0,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:["",e.jsx("strong",{className:"text-foreground ml-1",children:fe.providersToDelete.join(", ")})]}),e.jsxs("p",{className:"text-yellow-600 dark:text-yellow-500 font-medium",children:["  ",fe.affectedModels.length," "]}),e.jsx(Ze,{className:"h-32 w-full rounded border p-3",children:e.jsx("div",{className:"space-y-1",children:fe.affectedModels.map((te,we)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-mono text-muted-foreground",children:""}),e.jsx("span",{className:"ml-2 font-medium",children:te.name}),e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",te.model_identifier,")"]})]},we))})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})})]}),e.jsxs(ds,{children:[e.jsx(hs,{onClick:Z,children:""}),e.jsx(xs,{onClick:vt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(er,{})]})}function ac(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,11)}`}function $m(a){return a===null?"null":Array.isArray(a)?"array":typeof a=="object"?"object":typeof a=="boolean"?"boolean":typeof a=="number"?"number":"string"}function Zm(a){return Object.entries(a).map(([l,r])=>{const c=$m(r),d={id:ac(),key:l,value:r,type:c,expanded:!0};return c==="object"&&r&&typeof r=="object"?d.children=Zm(r):c==="array"&&Array.isArray(r)&&(d.children=r.map((u,h)=>{const f=$m(u),p={id:ac(),key:String(h),value:u,type:f,expanded:!0};return f==="object"&&u&&typeof u=="object"?p.children=Zm(u):f==="array"&&Array.isArray(u)&&(p.children=u.map((g,b)=>({id:ac(),key:String(b),value:g,type:$m(g),expanded:!0}))),p})),d})}function Wm(a){const l={};for(const r of a)r.key.trim()&&(r.type==="object"&&r.children?l[r.key]=Wm(r.children):r.type==="array"&&r.children?l[r.key]=r.children.map(c=>c.type==="object"&&c.children?Wm(c.children):c.type==="array"&&c.children?c.children.map(d=>d.value):c.value):r.type==="null"?l[r.key]=null:l[r.key]=r.value);return l}function Vg(a,l){switch(l){case"boolean":return a==="true";case"number":{const r=parseFloat(a);return isNaN(r)?0:r}case"null":return null;default:return a}}function Jv({node:a,level:l,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:u}){const h=a.type==="object"||a.type==="array",f=a.children&&a.children.length>0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 items-center",style:{gridTemplateColumns:h?"32px 1fr 90px 64px":"32px 1fr 1fr 90px 32px",paddingLeft:`${l*20}px`},children:[e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>u(a.id),disabled:!h||!f,children:h&&f?a.expanded?e.jsx(za,{className:"h-4 w-4"}):e.jsx(sa,{className:"h-4 w-4"}):e.jsx("span",{className:"w-4"})}),e.jsx(ae,{value:a.key,onChange:p=>r(a.id,"key",p.target.value),placeholder:"key",className:"h-8 text-sm"}),!h&&e.jsx(e.Fragment,{children:a.type==="boolean"?e.jsxs("div",{className:"flex items-center h-8 px-3 border rounded-md bg-background",children:[e.jsx(Ge,{checked:a.value===!0,onCheckedChange:p=>r(a.id,"value",p)}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:a.value?"true":"false"})]}):a.type==="null"?e.jsx("div",{className:"flex items-center h-8 px-3 border rounded-md bg-muted text-sm text-muted-foreground",children:"null"}):e.jsx(ae,{type:a.type==="number"?"number":"text",value:a.value,onChange:p=>r(a.id,"value",p.target.value),placeholder:"value",className:"h-8 text-sm",step:a.type==="number"?"any":void 0})}),e.jsxs(Pe,{value:a.type,onValueChange:p=>r(a.id,"type",p),children:[e.jsx(Be,{className:"h-8 text-xs",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"string",children:""}),e.jsx(W,{value:"number",children:""}),e.jsx(W,{value:"boolean",children:""}),e.jsx(W,{value:"null",children:"Null"}),e.jsx(W,{value:"object",children:""}),e.jsx(W,{value:"array",children:""})]})]}),e.jsxs("div",{className:"flex gap-1 justify-end",children:[h&&e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>d(a.id),title:"",children:e.jsx(Ys,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>c(a.id),title:"",children:e.jsx(ls,{className:"h-4 w-4"})})]})]}),h&&a.expanded&&a.children&&a.children.length>0&&e.jsx("div",{className:"space-y-1",children:a.children.map(p=>e.jsx(Jv,{node:p,level:l+1,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:u},p.id))})]})}function t4({value:a,onChange:l,placeholder:r="..."}){const[c,d]=m.useState(()=>Zm(a||{})),u=m.useCallback(j=>{d(j),l(Wm(j))},[l]),h=m.useCallback(()=>{const j={id:ac(),key:"",value:"",type:"string",expanded:!1};u([...c,j])},[c,u]),f=m.useCallback((j,y,N)=>{const w=M=>M.map(A=>{if(A.id===j)if(y==="type"){const S=N;if(S==="object")return{...A,type:S,value:{},children:[]};if(S==="array")return{...A,type:S,value:[],children:[]};if(S==="null")return{...A,type:S,value:null};{const U=Vg(String(A.value),S);return{...A,type:S,value:U,children:void 0}}}else if(y==="value"){const S=Vg(String(N),A.type);return{...A,value:S}}else return{...A,[y]:String(N)};return A.children?{...A,children:w(A.children)}:A});u(w(c))},[c,u]),p=m.useCallback(j=>{const y=N=>N.filter(w=>w.id!==j).map(w=>w.children?{...w,children:y(w.children)}:w);u(y(c))},[c,u]),g=m.useCallback(j=>{const y=N=>N.map(w=>{if(w.id===j){const M={id:ac(),key:w.type==="array"?String(w.children?.length||0):"",value:"",type:"string",expanded:!0};return{...w,children:[...w.children||[],M]}}return w.children?{...w,children:y(w.children)}:w});u(y(c))},[c,u]),b=m.useCallback(j=>{const y=N=>N.map(w=>w.id===j?{...w,expanded:!w.expanded}:w.children?{...w,children:y(w.children)}:w);d(y(c))},[c]);return e.jsxs("div",{className:"h-full flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c.length," "]}),e.jsxs(_,{type:"button",size:"sm",variant:"outline",onClick:h,className:"h-7 text-xs",children:[e.jsx(Ys,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",children:c.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border border-dashed rounded-md",children:r}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 text-xs text-muted-foreground px-1 sticky top-0 bg-background z-10",style:{gridTemplateColumns:"32px 1fr 1fr 90px 32px"},children:[e.jsx("span",{}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{})]}),c.map(j=>e.jsx(Jv,{node:j,level:0,onUpdate:f,onRemove:p,onAddChild:g,onToggleExpand:b},j.id))]})})]})}function Gg(a){if(!a.trim())return{valid:!0,parsed:{}};try{const l=JSON.parse(a);return typeof l!="object"||l===null||Array.isArray(l)?{valid:!1,error:" JSON  {}"}:{valid:!0,parsed:l}}catch{return{valid:!1,error:"JSON "}}}function a4({value:a,onChange:l,className:r,placeholder:c="..."}){const[d,u]=m.useState("list"),h=m.useMemo(()=>Object.keys(a||{}).length>0?JSON.stringify(a,null,2):"",[a]),[f,p]=m.useState(h),[g,b]=m.useState(null);m.useEffect(()=>{p(h)},[h]);const j=m.useMemo(()=>{const w=Gg(f);return w.valid&&w.parsed?{success:!0,data:w.parsed}:{success:!1,data:{}}},[f]),y=m.useCallback(w=>{const M=w;M==="json"&&d==="list"&&(p(Object.keys(a).length>0?JSON.stringify(a,null,2):""),b(null)),u(M)},[d,a]),N=m.useCallback(w=>{p(w);const M=Gg(w);M.valid&&M.parsed?(b(null),l(M.parsed)):b(M.error||"JSON ")},[l]);return e.jsx("div",{className:F("h-full flex flex-col",r),children:e.jsxs(ea,{value:d,onValueChange:y,className:"w-full flex-1 flex flex-col",children:[e.jsxs(Gt,{className:"h-8 p-0.5 bg-muted/60 w-fit",children:[e.jsx(Xe,{value:"list",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:""}),e.jsx(Xe,{value:"json",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"JSON "})]}),e.jsx(vs,{value:"list",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsx(t4,{value:a,onChange:l,placeholder:c})}),e.jsx(vs,{value:"json",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),g?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-destructive",children:[e.jsx(Ct,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:g})]}):f.trim()&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Mt,{className:"h-3 w-3"}),e.jsx("span",{children:""})]})]}),e.jsx(rt,{value:f,onChange:w=>N(w.target.value),placeholder:`{
  "key": "value"
}`,className:F("font-mono text-sm flex-1 resize-none",g&&"border-destructive focus-visible:ring-destructive")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" JSON "})]}),e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"flex-1 rounded-md border bg-muted/30 p-3 overflow-auto",children:j.success&&Object.keys(j.data).length>0?e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-words",children:JSON.stringify(j.data,null,2)}):j.success?e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:""}):e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-destructive",children:"JSON "})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})})]})})}function l4({open:a,onOpenChange:l,value:r,onChange:c}){const[d,u]=m.useState(r),h=g=>{g&&u(r),l(g)},f=()=>{c(d),l(!1)},p=()=>{u(r),l(!1)};return e.jsx(Fs,{open:a,onOpenChange:h,children:e.jsxs(Us,{className:"max-w-3xl h-[70vh] flex flex-col",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:e.jsx(a4,{value:d,onChange:u,placeholder:" thinkingtop_p ..."})}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:p,children:""}),e.jsx(_,{onClick:f,children:""})]})]})})}const ei="https://maibot-plugin-stats.maibot-webui.workers.dev";async function n4(a){const l=new URLSearchParams;a?.status&&l.set("status",a.status),a?.page&&l.set("page",a.page.toString()),a?.page_size&&l.set("page_size",a.page_size.toString()),a?.search&&l.set("search",a.search),a?.sort_by&&l.set("sort_by",a.sort_by),a?.sort_order&&l.set("sort_order",a.sort_order);const r=await fetch(`${ei}/pack?${l.toString()}`);if(!r.ok)throw new Error(` Pack : ${r.status}`);return r.json()}async function r4(a){const l=await fetch(`${ei}/pack/${a}`);if(!l.ok)throw new Error(` Pack : ${l.status}`);const r=await l.json();if(!r.success)throw new Error(r.error||" Pack ");return r.pack}async function i4(a){const r=await(await fetch(`${ei}/pack`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.error||" Pack ");return r}async function c4(a,l){await fetch(`${ei}/pack/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:l})})}async function Xv(a,l){const c=await(await fetch(`${ei}/pack/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:l})})).json();if(!c.success)throw new Error(c.error||"");return{likes:c.likes,liked:c.liked}}async function Zv(a,l){return(await(await fetch(`${ei}/pack/like/check?pack_id=${a}&user_id=${l}`)).json()).liked||!1}async function o4(a){const l=await _e("/api/webui/config/model");if(!l.ok)throw new Error("");const r=await l.json(),c=r.config||r;console.log("=== Pack Conflict Detection ==="),console.log("Pack providers:",a.providers),console.log("Local providers:",c.api_providers);const d={existing_providers:[],new_providers:[],conflicting_models:[]},u=c.api_providers||[];for(const f of a.providers){console.log(`
Checking pack provider: ${f.name}`),console.log(`  Pack URL: ${f.base_url}`),console.log(`  Normalized: ${Bm(f.base_url)}`);const p=u.filter(g=>{const b=Bm(g.base_url),j=Bm(f.base_url);return console.log(`  Comparing with local "${g.name}": ${g.base_url}`),console.log(`    Local normalized: ${b}`),console.log(`    Match: ${b===j}`),b===j});p.length>0?(console.log(`   Matched with ${p.length} local provider(s):`,p.map(g=>g.name).join(", ")),d.existing_providers.push({pack_provider:f,local_providers:p.map(g=>({name:g.name,base_url:g.base_url}))})):(console.log("   No match found - will need API key"),d.new_providers.push(f))}const h=c.models||[];console.log(`
=== Model Conflict Detection ===`);for(const f of a.models){const p=h.find(g=>g.name===f.name);p&&(console.log(`Model conflict: ${f.name}`),d.conflicting_models.push({pack_model:f.name,local_model:p.name}))}return console.log(`
=== Detection Summary ===`),console.log(`Existing providers: ${d.existing_providers.length}`),console.log(`New providers: ${d.new_providers.length}`),console.log(`Conflicting models: ${d.conflicting_models.length}`),console.log(`===========================
`),d}async function d4(a,l,r,c){const d=await _e("/api/webui/config/model");if(!d.ok)throw new Error("");const u=await d.json(),h=u.config||u;if(l.apply_providers){const p=l.selected_providers?a.providers.filter(g=>l.selected_providers.includes(g.name)):a.providers;for(const g of p){if(r[g.name])continue;const b=c[g.name];if(!b)throw new Error(` "${g.name}"  API Key`);const j={...g,api_key:b},y=h.api_providers.findIndex(N=>N.name===g.name);y>=0?h.api_providers[y]=j:h.api_providers.push(j)}}if(l.apply_models){const p=l.selected_models?a.models.filter(g=>l.selected_models.includes(g.name)):a.models;for(const g of p){const b=r[g.api_provider]||g.api_provider,j={...g,api_provider:b},y=h.models.findIndex(N=>N.name===g.name);y>=0?h.models[y]=j:h.models.push(j)}}if(l.apply_task_config){const p=l.selected_tasks||Object.keys(a.task_config);for(const g of p){const b=a.task_config[g];if(!b)continue;const j=new Set(l.selected_models||a.models.map(w=>w.name)),y=b.model_list.filter(w=>j.has(w));if(y.length===0)continue;const N={...b,model_list:y};if(l.task_mode==="replace")h.model_task_config[g]=N;else{const w=h.model_task_config[g];if(w){const M=[...new Set([...w.model_list,...y])];h.model_task_config[g]={...w,model_list:M}}else h.model_task_config[g]=N}}}if(!(await _e("/api/webui/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("")}async function u4(a){const l=await _e("/api/webui/config/model");if(!l.ok)throw new Error("");const r=await l.json();if(!r.success||!r.config)throw new Error("");const c=r.config;let d=(c.api_providers||[]).map(g=>({name:g.name,base_url:g.base_url,client_type:g.client_type,max_retry:g.max_retry,timeout:g.timeout,retry_interval:g.retry_interval}));a.selectedProviders&&(d=d.filter(g=>a.selectedProviders.includes(g.name)));let u=c.models||[];a.selectedModels&&(u=u.filter(g=>a.selectedModels.includes(g.name)));const h={},f=c.model_task_config||{},p=a.selectedTasks||Object.keys(f);for(const g of p)f[g]&&(h[g]=f[g]);return{providers:d,models:u,task_config:h}}function Bm(a){try{const l=new URL(a);return`${l.protocol}//${l.host}${l.pathname}`.replace(/\/$/,"").toLowerCase()}catch{return a.toLowerCase().replace(/\/$/,"")}}function Wv(){const a="maibot_pack_user_id";let l=localStorage.getItem(a);return l||(l="pack_user_"+Math.random().toString(36).substring(2,15),localStorage.setItem(a,l)),l}const m4={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""},x4=["","","","","","","OpenAI","Claude","Gemini","","",""];function h4({trigger:a}){const[l,r]=m.useState(!1),[c,d]=m.useState(1),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[g,b]=m.useState([]),[j,y]=m.useState([]),[N,w]=m.useState({}),[M,A]=m.useState(new Set),[S,U]=m.useState(new Set),[E,C]=m.useState(new Set),[D,P]=m.useState(""),[O,J]=m.useState(""),[L,oe]=m.useState(""),[Ne,je]=m.useState([]);m.useEffect(()=>{l&&c===1&&de()},[l,c]);const de=async()=>{h(!0);try{const q=await u4({name:"",description:"",author:""});b(q.providers),y(q.models),w(q.task_config),A(new Set(q.providers.map(B=>B.name))),U(new Set(q.models.map(B=>B.name))),C(new Set(Object.keys(q.task_config)))}catch(q){console.error(":",q),Xt({title:"",variant:"destructive"})}finally{h(!1)}},he=q=>{const B=new Set(M),z=new Set(S),K=new Set(E);B.has(q)?(B.delete(q),j.filter(ee=>ee.api_provider===q).forEach(ee=>z.delete(ee.name)),Object.entries(N).forEach(([ee,Y])=>{Y.model_list&&(Y.model_list.some(H=>z.has(H))||K.delete(ee))})):(B.add(q),j.filter(ee=>ee.api_provider===q).forEach(ee=>z.add(ee.name)),Object.entries(N).forEach(([ee,Y])=>{Y.model_list&&Y.model_list.some(H=>{const se=j.find(Ue=>Ue.name===H);return se&&se.api_provider===q})&&K.add(ee)})),A(B),U(z),C(K)},ge=q=>{const B=new Set(S),z=new Set(E);B.has(q)?(B.delete(q),Object.entries(N).forEach(([K,Ae])=>{Ae.model_list&&(Ae.model_list.some(Y=>B.has(Y))||z.delete(K))})):(B.add(q),Object.entries(N).forEach(([K,Ae])=>{Ae.model_list&&Ae.model_list.includes(q)&&z.add(K)})),U(B),C(z)},R=q=>{const B=new Set(E);B.has(q)?B.delete(q):B.add(q),C(B)},Q=q=>{Ne.includes(q)?je(Ne.filter(B=>B!==q)):Ne.length<5?je([...Ne,q]):Xt({title:" 5 ",variant:"destructive"})},$=()=>{M.size===g.length?A(new Set):A(new Set(g.map(q=>q.name)))},ue=()=>{S.size===j.length?U(new Set):U(new Set(j.map(q=>q.name)))},G=()=>{const q=Object.keys(N);E.size===q.length?C(new Set):C(new Set(q))},Se=async()=>{if(!D.trim()){Xt({title:"",variant:"destructive"});return}if(!O.trim()){Xt({title:"",variant:"destructive"});return}if(!L.trim()){Xt({title:"",variant:"destructive"});return}if(M.size===0&&S.size===0&&E.size===0){Xt({title:"",variant:"destructive"});return}p(!0);try{const q=g.filter(K=>M.has(K.name)),B=j.filter(K=>S.has(K.name)),z={};for(const[K,Ae]of Object.entries(N))E.has(K)&&(z[K]=Ae);await i4({name:D.trim(),description:O.trim(),author:L.trim(),tags:Ne,providers:q,models:B,task_config:z}),Xt({title:""}),r(!1),fe()}catch(q){console.error(":",q),Xt({title:q instanceof Error?q.message:"",variant:"destructive"})}finally{p(!1)}},fe=()=>{d(1),P(""),J(""),oe(""),je([]),A(new Set),U(new Set),C(new Set)},Te=2;return e.jsxs(Fs,{open:l,onOpenChange:r,children:[e.jsx(cd,{asChild:!0,children:a||e.jsxs(_,{variant:"outline",children:[e.jsx(rv,{className:"w-4 h-4 mr-2"}),""]})}),e.jsxs(Us,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(ra,{className:"w-5 h-5"}),""]}),e.jsxs(Xs,{children:[" ",c," / ",Te,"",c===1&&"",c===2&&""]})]}),e.jsx(Ze,{className:"h-[calc(85vh-220px)] pr-4",children:u?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Os,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsxs(ct,{children:["",e.jsx("strong",{children:""})," API Key"]})]}),e.jsxs(ea,{defaultValue:"providers",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Xe,{value:"providers",children:[e.jsx(Ll,{className:"w-4 h-4 mr-2"}),"API ",e.jsxs(Ce,{variant:"secondary",className:"ml-2",children:[M.size,"/",g.length]})]}),e.jsxs(Xe,{value:"models",children:[e.jsx(Qn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(Ce,{variant:"secondary",className:"ml-2",children:[S.size,"/",j.length]})]}),e.jsxs(Xe,{value:"tasks",children:[e.jsx(Yn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(Ce,{variant:"secondary",className:"ml-2",children:[E.size,"/",Object.keys(N).length]})]})]}),e.jsx(vs,{value:"providers",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:$,children:M.size===g.length?"":""})}),g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):g.map(q=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(Js,{id:`provider-${q.name}`,checked:M.has(q.name),onCheckedChange:()=>he(q.name)}),e.jsxs(T,{htmlFor:`provider-${q.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:q.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:q.base_url})]}),e.jsx(Ce,{variant:"outline",className:"text-xs",children:q.client_type})]},q.name))]})}),e.jsx(vs,{value:"models",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:ue,children:S.size===j.length?"":""})}),j.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):j.map(q=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(Js,{id:`model-${q.name}`,checked:S.has(q.name),onCheckedChange:()=>ge(q.name)}),e.jsxs(T,{htmlFor:`model-${q.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:q.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:q.model_identifier})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:q.api_provider})]},q.name))]})}),e.jsx(vs,{value:"tasks",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:G,children:E.size===Object.keys(N).length?"":""})}),Object.keys(N).length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):Object.entries(N).map(([q,B])=>e.jsxs("div",{className:"space-y-2 p-2 rounded hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:`task-${q}`,checked:E.has(q),onCheckedChange:()=>R(q)}),e.jsx(T,{htmlFor:`task-${q}`,className:"flex-1 cursor-pointer",children:e.jsx("span",{className:"font-medium",children:m4[q]||q})}),e.jsxs(Ce,{variant:"outline",className:"text-xs",children:[B.model_list.length," "]})]}),B.model_list&&B.model_list.length>0&&e.jsx("div",{className:"ml-6 flex flex-wrap gap-1",children:B.model_list.map(z=>{const K=j.find(ee=>ee.name===z),Ae=S.has(z);return e.jsxs(Ce,{variant:Ae?"default":"outline",className:"text-xs cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>ge(z),children:[z,K&&e.jsxs("span",{className:"ml-1 opacity-70",children:["(",K.api_provider,")"]})]},z)})})]},q))]})})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm p-3 bg-muted rounded-lg",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ll,{className:"w-4 h-4"}),M.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qn,{className:"w-4 h-4"}),S.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Yn,{className:"w-4 h-4"}),E.size," "]})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-name",children:" *"}),e.jsx(ae,{id:"pack-name",placeholder:"",value:D,onChange:q=>P(q.target.value),maxLength:50}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[D.length,"/50"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-description",children:" *"}),e.jsx(rt,{id:"pack-description",placeholder:"...",value:O,onChange:q=>J(q.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[O.length,"/500"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-author",children:" *"}),e.jsx(ae,{id:"pack-author",placeholder:" ID",value:L,onChange:q=>oe(q.target.value),maxLength:30})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" 5 "}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x4.map(q=>e.jsxs(Ce,{variant:Ne.includes(q)?"default":"outline",className:"cursor-pointer transition-colors",onClick:()=>Q(q),children:[Ne.includes(q)&&e.jsx(Mt,{className:"w-3 h-3 mr-1"}),e.jsx(rd,{className:"w-3 h-3 mr-1"}),q]},q))})]})]}),e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(ct,{children:" 1-3 "})]})]})]})}),e.jsxs(nt,{className:"flex justify-between pt-4 border-t",children:[e.jsx("div",{children:c>1&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>{r(!1),fe()},disabled:f,children:""}),c<Te?e.jsx(_,{onClick:()=>d(c+1),disabled:u||M.size===0&&S.size===0&&E.size===0,children:""}):e.jsxs(_,{onClick:Se,disabled:f,children:[f&&e.jsx(Os,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})]})}function f4({value:a,label:l,onRemove:r}){const{attributes:c,listeners:d,setNodeRef:u,transform:h,transition:f,isDragging:p}=bv({id:a}),g={transform:yv.Transform.toString(h),transition:f,opacity:p?.5:1},b=y=>{y.preventDefault(),y.stopPropagation(),r(a)},j=y=>{y.stopPropagation()};return e.jsx("div",{ref:u,style:g,className:F("inline-flex items-center gap-1",p&&"shadow-lg"),children:e.jsxs(Ce,{variant:"secondary",className:"cursor-move hover:bg-secondary/80 flex items-center gap-1",children:[e.jsx("div",{...c,...d,className:"cursor-grab active:cursor-grabbing flex items-center",children:e.jsx(av,{className:"h-3 w-3 text-muted-foreground"})}),e.jsx("span",{children:l}),e.jsx("span",{role:"button",tabIndex:0,className:"ml-1 rounded-sm hover:bg-destructive/20 focus:outline-none focus:ring-1 focus:ring-destructive cursor-pointer",onClick:b,onPointerDown:j,onMouseDown:y=>y.stopPropagation(),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),b(y))},children:e.jsx(Aa,{className:"h-3 w-3 hover:text-destructive",strokeWidth:2,fill:"none"})})]})})}function p4({options:a,selected:l,onChange:r,placeholder:c="...",emptyText:d="",className:u}){const[h,f]=m.useState(!1),p=xv(qo(pv,{activationConstraint:{distance:8}}),qo(fv,{coordinateGetter:hv})),g=y=>{l.includes(y)?r(l.filter(N=>N!==y)):r([...l,y])},b=y=>{r(l.filter(N=>N!==y))},j=y=>{const{active:N,over:w}=y;if(w&&N.id!==w.id){const M=l.indexOf(N.id),A=l.indexOf(w.id);r(gv(l,M,A))}};return e.jsxs(ul,{open:h,onOpenChange:f,children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":h,className:F("w-full justify-between min-h-10 h-auto",u),children:[e.jsx(jv,{sensors:p,collisionDetection:vv,onDragEnd:j,children:e.jsx(Nv,{items:l,strategy:o1,children:e.jsx("div",{className:"flex gap-1 flex-wrap flex-1",children:l.length===0?e.jsx("span",{className:"text-muted-foreground",children:c}):l.map(y=>{const N=a.find(w=>w.value===y);return e.jsx(f4,{value:y,label:N?.label||y,onRemove:b},y)})})})}),e.jsx(ix,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:2,fill:"none"})]})}),e.jsx(sl,{className:"w-full p-0",align:"start",children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"...",className:"h-9"}),e.jsxs(md,{children:[e.jsx(xd,{children:d}),e.jsx(oc,{children:a.map(y=>{const N=l.includes(y.value);return e.jsxs(dc,{value:y.value,onSelect:()=>g(y.value),children:[e.jsx("div",{className:F("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",N?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Mt,{className:"h-3 w-3",strokeWidth:2,fill:"none"})}),e.jsx("span",{children:y.label})]},y.value)})})]})]})})]})}const zl=Ls.memo(function({title:l,description:r,taskConfig:c,modelNames:d,onChange:u,hideTemperature:h=!1,hideMaxTokens:f=!1,dataTour:p}){const g=b=>{u("model_list",b)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-base sm:text-lg",children:l}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:r})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":p,children:[e.jsx(T,{children:""}),e.jsx(p4,{options:d.map(b=>({label:b,value:b})),selected:c.model_list||[],onChange:g,placeholder:"...",emptyText:""})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!h&&e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(ae,{type:"number",step:"0.1",min:"0",max:"1",value:c.temperature??.3,onChange:b=>{const j=parseFloat(b.target.value);!isNaN(j)&&j>=0&&j<=1&&u("temperature",j)},className:"w-20 h-8 text-sm"})]}),e.jsx(Qa,{value:[c.temperature??.3],onValueChange:b=>u("temperature",b[0]),min:0,max:1,step:.1,className:"w-full"})]}),!f&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" Token"}),e.jsx(ae,{type:"number",step:"1",min:"1",value:c.max_tokens??1024,onChange:b=>u("max_tokens",parseInt(b.target.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:" ()"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(ae,{type:"number",step:"1",min:"1",value:c.slow_threshold??15,onChange:b=>{const j=parseInt(b.target.value);!isNaN(j)&&j>=1&&u("slow_threshold",j)},placeholder:"15"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:c.selection_strategy??"balance",onValueChange:b=>u("selection_strategy",b),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"balance",children:"balance"}),e.jsx(W,{value:"random",children:"random"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})}),g4=Ls.memo(function({paginatedModels:l,allModels:r,onEdit:c,onDelete:d,isModelUsed:u,searchQuery:h}){return l.length===0?e.jsx("div",{className:"md:hidden text-center text-muted-foreground py-8 rounded-lg border bg-card",children:h?"":""}):e.jsx("div",{className:"md:hidden space-y-3",children:l.map((f,p)=>{const g=r.findIndex(j=>j===f),b=u(f.name);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:f.name}),e.jsx(Ce,{variant:b?"default":"secondary",className:b?"bg-green-600 hover:bg-green-700":"",children:b?"":""})]}),e.jsx("p",{className:"text-xs text-muted-foreground break-all",title:f.model_identifier,children:f.model_identifier})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>c(f,g),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>d(g),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.api_provider})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.temperature!=null?f.temperature:e.jsx("span",{className:"text-muted-foreground",children:""})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_in,"/M"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_out,"/M"]})]})]})]},p)})})}),j4=Ls.memo(function({paginatedModels:l,allModels:r,filteredModels:c,selectedModels:d,onEdit:u,onDelete:h,onToggleSelection:f,onToggleSelectAll:p,isModelUsed:g,searchQuery:b}){return e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{className:"w-12",children:e.jsx(Js,{checked:d.size===c.length&&c.length>0,onCheckedChange:p})}),e.jsx(ss,{className:"w-24",children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{className:"text-center",children:""}),e.jsx(ss,{className:"text-right",children:""}),e.jsx(ss,{className:"text-right",children:""}),e.jsx(ss,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:l.length===0?e.jsx(ht,{children:e.jsx(Ye,{colSpan:9,className:"text-center text-muted-foreground py-8",children:b?"":""})}):l.map((j,y)=>{const N=r.findIndex(M=>M===j),w=g(j.name);return e.jsxs(ht,{children:[e.jsx(Ye,{children:e.jsx(Js,{checked:d.has(N),onCheckedChange:()=>f(N)})}),e.jsx(Ye,{children:e.jsx(Ce,{variant:w?"default":"secondary",className:w?"bg-green-600 hover:bg-green-700":"",children:w?"":""})}),e.jsx(Ye,{className:"font-medium",children:j.name}),e.jsx(Ye,{className:"max-w-xs truncate",title:j.model_identifier,children:j.model_identifier}),e.jsx(Ye,{children:j.api_provider}),e.jsx(Ye,{className:"text-center",children:j.temperature!=null?j.temperature:e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(Ye,{className:"text-right",children:["",j.price_in,"/M"]}),e.jsxs(Ye,{className:"text-right",children:["",j.price_out,"/M"]}),e.jsx(Ye,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>u(j,N),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>h(N),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},y)})})]})})})}),v4=300*1e3,qg=new Map,N4=[10,20,50,100],b4=Ls.memo(function({page:l,pageSize:r,totalItems:c,jumpToPage:d,onPageChange:u,onPageSizeChange:h,onJumpToPageChange:f,onJumpToPage:p,onSelectionClear:g}){const b=Math.ceil(c/r),j=N=>{h(parseInt(N)),u(1),g?.()},y=N=>{N.key==="Enter"&&p()};return c===0?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-model",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:r.toString(),onValueChange:j,children:[e.jsx(Be,{id:"page-size-model",className:"w-20",children:e.jsx(Fe,{})}),e.jsx(Ie,{children:N4.map(N=>e.jsx(W,{value:N.toString(),children:N},N))})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(l-1)*r+1," "," ",Math.min(l*r,c),"  ",c," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>u(1),disabled:l===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>u(Math.max(1,l-1)),disabled:l===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:d,onChange:N=>f(N.target.value),onKeyDown:y,placeholder:l.toString(),className:"w-16 h-8 text-center",min:1,max:b}),e.jsx(_,{variant:"outline",size:"sm",onClick:p,disabled:!d,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>u(l+1),disabled:l>=b,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>u(b),disabled:l>=b,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})});function y4(a){const{models:l,taskConfig:r,debounceMs:c=2e3,onSavingChange:d,onUnsavedChange:u}=a,h=m.useRef(null),f=m.useRef(null),p=m.useRef(!0),g=m.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current&&(clearTimeout(f.current),f.current=null)},[]),b=m.useCallback(N=>{const w={model_identifier:N.model_identifier,name:N.name,api_provider:N.api_provider,price_in:N.price_in??0,price_out:N.price_out??0,force_stream_mode:N.force_stream_mode??!1,extra_params:N.extra_params??{}};return N.temperature!=null&&(w.temperature=N.temperature),N.max_tokens!=null&&(w.max_tokens=N.max_tokens),w},[]),j=m.useCallback(async N=>{try{d?.(!0);const w=N.map(b);await Jm("models",w),u?.(!1)}catch(w){console.error(":",w),u?.(!0)}finally{d?.(!1)}},[d,u,b]),y=m.useCallback(async N=>{try{d?.(!0),await Jm("model_task_config",N),u?.(!1)}catch(w){console.error(":",w),u?.(!0)}finally{d?.(!1)}},[d,u]);return m.useEffect(()=>{if(!p.current)return u?.(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{j(l)},c),()=>{h.current&&clearTimeout(h.current)}},[l,j,c,u]),m.useEffect(()=>{if(!(p.current||!r))return u?.(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{y(r)},c),()=>{f.current&&clearTimeout(f.current)}},[r,y,c,u]),m.useEffect(()=>()=>{g()},[g]),{clearTimers:g,initialLoadRef:p}}function w4(a={}){const{onCloseEditDialog:l}=a,r=ca(),{registerTour:c,startTour:d,state:u,goToStep:h}=wx(),f=m.useRef(u.stepIndex);return m.useEffect(()=>{c(ol,Qv)},[c]),m.useEffect(()=>{if(u.activeTourId===ol&&u.isRunning){const g=Yv[u.stepIndex];g&&!window.location.pathname.endsWith(g.replace("/config/",""))&&r({to:g})}},[u.stepIndex,u.activeTourId,u.isRunning,r]),m.useEffect(()=>{if(u.activeTourId===ol&&u.isRunning){const g=f.current,b=u.stepIndex;g>=12&&g<=17&&b<12&&l?.(),f.current=b}},[u.stepIndex,u.activeTourId,u.isRunning,l]),m.useEffect(()=>{if(u.activeTourId!==ol||!u.isRunning)return;const g=b=>{const j=b.target,y=u.stepIndex;y===2&&j.closest('[data-tour="add-provider-button"]')?setTimeout(()=>h(3),300):y===9&&j.closest('[data-tour="provider-cancel-button"]')?setTimeout(()=>h(10),300):y===11&&j.closest('[data-tour="add-model-button"]')?setTimeout(()=>h(12),300):y===17&&j.closest('[data-tour="model-cancel-button"]')?setTimeout(()=>h(18),300):y===18&&j.closest('[data-tour="tasks-tab-trigger"]')&&setTimeout(()=>h(19),300)};return document.addEventListener("click",g,!0),()=>document.removeEventListener("click",g,!0)},[u,h]),{startTour:m.useCallback(()=>{d(ol)},[d]),isRunning:u.isRunning&&u.activeTourId===ol,stepIndex:u.stepIndex}}function _4(a){const{getProviderConfig:l}=a,[r,c]=m.useState([]),[d,u]=m.useState(!1),[h,f]=m.useState(null),[p,g]=m.useState(null),b=m.useCallback(()=>{c([]),f(null),g(null)},[]),j=m.useCallback(async(y,N=!1)=>{const w=l(y);if(!w?.base_url){c([]),g(null),f('""');return}if(!w.api_key){c([]),g(null),f(' API Key""');return}const M=ZS(w.base_url);if(g(M),!M?.modelFetcher){c([]),f(null);return}const A=`${y}:${w.base_url}`,S=qg.get(A);if(!N&&S&&Date.now()-S.timestamp<v4){c(S.models),f(null);return}u(!0),f(null);try{const U=await hS(y,M.modelFetcher.parser,M.modelFetcher.endpoint);c(U),qg.set(A,{models:U,timestamp:Date.now()})}catch(U){console.error(":",U);const E=U.message||"";E.includes("")||E.includes("")||E.includes("API Key")?f('API Key ""'):E.includes("")?f(" API Key "):E.includes("timeout")||E.includes("")?f(""):E.includes("")?f(""):f(E),c([])}finally{u(!1)}},[l]);return{availableModels:r,fetchingModels:d,modelFetchError:h,matchedTemplate:p,fetchModelsForProvider:j,clearModels:b}}function S4(){return e.jsx(Wn,{children:e.jsx(k4,{})})}function k4(){const[a,l]=m.useState([]),[r,c]=m.useState([]),[d,u]=m.useState([]),[h,f]=m.useState([]),[p,g]=m.useState(null),[b,j]=m.useState(!0),[y,N]=m.useState(!1),[w,M]=m.useState(!1),[A,S]=m.useState(!1),[U,E]=m.useState(!1),[C,D]=m.useState(null),[P,O]=m.useState(null),[J,L]=m.useState(!1),[oe,Ne]=m.useState(!1),[je,de]=m.useState(null),[he,ge]=m.useState(""),[R,Q]=m.useState(new Set),[$,ue]=m.useState(!1),[G,Se]=m.useState(1),[fe,Te]=m.useState(20),[q,B]=m.useState(""),[z,K]=m.useState(!1),[Ae,ee]=m.useState(!1),Y=m.useRef([]),$e=m.useRef(null),[H,se]=m.useState([]),[Ue,ie]=m.useState([]),[Ee,me]=m.useState({}),{toast:ze}=Ws(),{triggerRestart:at,isRestarting:Pt}=yn(),{startTour:qt,isRunning:Ja}=w4({onCloseEditDialog:()=>E(!1)}),{clearTimers:As,initialLoadRef:vt}=y4({models:a,taskConfig:p,onSavingChange:M,onUnsavedChange:S}),Z=m.useCallback((re,pe)=>{if(!re)return;const as=new Set(pe.map(va=>va.name)),ys=[],fs=[],yt=[{key:"utils",label:""},{key:"tool_use",label:""},{key:"replyer",label:""},{key:"planner",label:""},{key:"vlm",label:""},{key:"voice",label:""},{key:"embedding",label:""},{key:"lpmm_entity_extract",label:"LPMM"},{key:"lpmm_rdf_build",label:"LPMM"}];for(const{key:va,label:Pl}of yt){const tr=re[va];if(!tr)continue;if(!tr.model_list||tr.model_list.length===0){fs.push(Pl);continue}const ti=tr.model_list.filter(_n=>!as.has(_n));ti.length>0&&ys.push({taskName:Pl,invalidModels:ti})}se(ys),ie(fs)},[]),qe=m.useCallback(async()=>{try{j(!0);const re=await xn(),pe=re.models||[];l(pe),f(pe.map(yt=>yt.name));const as=re.api_providers||[];c(as.map(yt=>yt.name)),u(as);const ys=re.model_task_config||null;g(ys),Z(ys,pe);const fs=ys?.embedding?.model_list||[];Y.current=[...fs],S(!1),vt.current=!1}catch(re){console.error(":",re)}finally{j(!1)}},[vt,Z]);m.useEffect(()=>{qe()},[qe]);const Qe=m.useCallback(re=>d.find(pe=>pe.name===re),[d]),{availableModels:We,fetchingModels:Rs,modelFetchError:He,matchedTemplate:Ss,fetchModelsForProvider:Ds,clearModels:Vs}=_4({getProviderConfig:Qe});m.useEffect(()=>{U&&C?.api_provider&&Ds(C.api_provider)},[U,C?.api_provider,Ds]);const ns=async()=>{await at()},ts=m.useCallback(()=>{if(!p)return;const re=new Set(a.map(ys=>ys.name)),pe={...p},as=Object.keys(pe);for(const ys of as){const fs=pe[ys];fs&&fs.model_list&&(fs.model_list=fs.model_list.filter(yt=>re.has(yt)))}g(pe),se([]),ze({title:"",description:""})},[p,a,ze]),Ns=re=>{const pe={model_identifier:re.model_identifier,name:re.name,api_provider:re.api_provider,price_in:re.price_in??0,price_out:re.price_out??0,force_stream_mode:re.force_stream_mode??!1,extra_params:re.extra_params??{}};return re.temperature!=null&&(pe.temperature=re.temperature),re.max_tokens!=null&&(pe.max_tokens=re.max_tokens),pe},Le=async()=>{try{N(!0),As();const re=await xn();re.models=a.map(Ns),re.model_task_config=p,await tc(re),S(!1),ze({title:"",description:"..."}),await ns()}catch(re){console.error(":",re),ze({title:"",description:re.message,variant:"destructive"}),N(!1)}},bs=async()=>{try{N(!0),As();const re=await xn();re.models=a.map(Ns),re.model_task_config=p,await tc(re),S(!1),ze({title:"",description:""}),await qe()}catch(re){console.error(":",re),ze({title:"",description:re.message,variant:"destructive"})}finally{N(!1)}},_s=(re,pe)=>{me({}),D(re||{model_identifier:"",name:"",api_provider:r[0]||"",price_in:0,price_out:0,temperature:null,max_tokens:null,force_stream_mode:!1,extra_params:{}}),O(pe),E(!0)},rs=()=>{if(!C)return;const re={};if(C.name?.trim()?a.some((yt,va)=>P!==null&&va===P?!1:yt.name.trim().toLowerCase()===C.name.trim().toLowerCase())&&(re.name=""):re.name="",C.api_provider?.trim()||(re.api_provider=" API "),C.model_identifier?.trim()||(re.model_identifier=""),Object.keys(re).length>0){me(re);return}me({});const pe={model_identifier:C.model_identifier,name:C.name,api_provider:C.api_provider,price_in:C.price_in??0,price_out:C.price_out??0,force_stream_mode:C.force_stream_mode??!1,extra_params:C.extra_params??{}};C.temperature!=null&&(pe.temperature=C.temperature),C.max_tokens!=null&&(pe.max_tokens=C.max_tokens);let as,ys=null;if(P!==null?(ys=a[P].name,as=[...a],as[P]=pe):as=[...a,pe],l(as),f(as.map(fs=>fs.name)),ys&&ys!==pe.name&&p){const fs=yt=>yt.map(va=>va===ys?pe.name:va);g({...p,utils:{...p.utils,model_list:fs(p.utils?.model_list||[])},tool_use:{...p.tool_use,model_list:fs(p.tool_use?.model_list||[])},replyer:{...p.replyer,model_list:fs(p.replyer?.model_list||[])},planner:{...p.planner,model_list:fs(p.planner?.model_list||[])},vlm:{...p.vlm,model_list:fs(p.vlm?.model_list||[])},voice:{...p.voice,model_list:fs(p.voice?.model_list||[])},embedding:{...p.embedding,model_list:fs(p.embedding?.model_list||[])},lpmm_entity_extract:{...p.lpmm_entity_extract,model_list:fs(p.lpmm_entity_extract?.model_list||[])},lpmm_rdf_build:{...p.lpmm_rdf_build,model_list:fs(p.lpmm_rdf_build?.model_list||[])}})}E(!1),D(null),O(null),ze({title:P!==null?"":"",description:' 2 ""'})},ft=re=>{if(!re&&C){const pe={...C,price_in:C.price_in??0,price_out:C.price_out??0};D(pe)}E(re)},zt=re=>{de(re),Ne(!0)},Oa=()=>{if(je!==null){const re=a.filter((pe,as)=>as!==je);l(re),f(re.map(pe=>pe.name)),Z(p,re),ze({title:"",description:' 2 ""'})}Ne(!1),de(null)},ll=re=>{const pe=new Set(R);pe.has(re)?pe.delete(re):pe.add(re),Q(pe)},xl=()=>{if(R.size===Ut.length)Q(new Set);else{const re=Ut.map((pe,as)=>a.findIndex(ys=>ys===Ut[as]));Q(new Set(re))}},sr=()=>{if(R.size===0){ze({title:"",description:"",variant:"default"});return}ue(!0)},te=()=>{const re=R.size,pe=a.filter((as,ys)=>!R.has(ys));l(pe),f(pe.map(as=>as.name)),Z(p,pe),Q(new Set),ue(!1),ze({title:"",description:` ${re}  2 `})},we=(re,pe,as)=>{if(!p)return;if(re==="embedding"&&pe==="model_list"&&Array.isArray(as)){const fs=Y.current,yt=as;if((fs.length!==yt.length||fs.some(Pl=>!yt.includes(Pl))||yt.some(Pl=>!fs.includes(Pl)))&&fs.length>0){$e.current={field:pe,value:as},ee(!0);return}}const ys={...p,[re]:{...p[re],[pe]:as}};g(ys),Z(ys,a),re==="embedding"&&pe==="model_list"&&Array.isArray(as)&&(Y.current=[...as])},Oe=()=>{if(!p||!$e.current)return;const{field:re,value:pe}=$e.current,as={...p,embedding:{...p.embedding,[re]:pe}};g(as),Z(as,a),re==="model_list"&&Array.isArray(pe)&&(Y.current=[...pe]),$e.current=null,ee(!1),ze({title:"",description:""})},Gs=()=>{$e.current=null,ee(!1)},Ut=a.filter(re=>{if(!he)return!0;const pe=he.toLowerCase();return re.name.toLowerCase().includes(pe)||re.model_identifier.toLowerCase().includes(pe)||re.api_provider.toLowerCase().includes(pe)}),ta=Math.ceil(Ut.length/fe),dt=Ut.slice((G-1)*fe,G*fe),aa=()=>{const re=parseInt(q);re>=1&&re<=ta&&(Se(re),B(""))},pt=re=>p?[p.utils?.model_list||[],p.tool_use?.model_list||[],p.replyer?.model_list||[],p.planner?.model_list||[],p.vlm?.model_list||[],p.voice?.model_list||[],p.embedding?.model_list||[],p.lpmm_entity_extract?.model_list||[],p.lpmm_rdf_build?.model_list||[]].some(as=>as.includes(re)):!1;return b?e.jsx(Ze,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(h4,{trigger:e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(rv,{className:"mr-2 h-4 w-4"}),""]})}),e.jsxs(_,{onClick:bs,disabled:y||w||!A||Pt,size:"sm",variant:"outline",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),y?"...":w?"...":A?"":""]}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsxs(_,{disabled:y||w||Pt,size:"sm",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Pt?"...":A?"":""]})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsx(ms,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:A?",":","})})})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:A?Le:ns,children:A?"":""})]})]})]})]})]}),e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs(ct,{children:["",e.jsx("strong",{children:""}),'""']})]}),H.length>0&&e.jsxs(it,{variant:"destructive",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs(ct,{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:H.map(({taskName:re,invalidModels:pe})=>e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:re})," : ",pe.join(", ")]},re))})]}),e.jsx(_,{variant:"outline",size:"sm",className:"shrink-0 bg-background hover:bg-accent",onClick:ts,children:""})]})]}),Ue.length>0&&e.jsxs(it,{variant:"default",className:"border-yellow-500/50 bg-yellow-500/10",children:[e.jsx(It,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(ct,{children:[e.jsx("strong",{className:"text-yellow-600",children:""}),e.jsxs("div",{className:"mt-2 text-sm",children:[Ue.join("")," "]})]})]}),e.jsxs(it,{className:"hidden lg:flex border-primary/30 bg-primary/5 cursor-pointer hover:bg-primary/10 transition-colors",onClick:qt,children:[e.jsx(E_,{className:"h-4 w-4 text-primary"}),e.jsxs(ct,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[e.jsx("strong",{className:"text-primary",children:""}),""]}),e.jsx(_,{variant:"outline",size:"sm",className:"ml-4 shrink-0",children:""})]})]}),e.jsxs(ea,{defaultValue:"models",className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full max-w-full sm:max-w-md grid-cols-2",children:[e.jsx(Xe,{value:"models",children:""}),e.jsx(Xe,{value:"tasks","data-tour":"tasks-tab-trigger",children:""})]}),e.jsxs(vs,{value:"models",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[R.size>0&&e.jsxs(_,{onClick:sr,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ls,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",R.size,")"]}),e.jsxs(_,{onClick:()=>_s(null,null),size:"sm",variant:"outline",className:"w-full sm:w-auto","data-tour":"add-model-button",children:[e.jsx(Ys,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:he,onChange:re=>ge(re.target.value),className:"pl-9"})]}),he&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Ut.length," "]})]}),e.jsx(g4,{paginatedModels:dt,allModels:a,onEdit:_s,onDelete:zt,isModelUsed:pt,searchQuery:he}),e.jsx(j4,{paginatedModels:dt,allModels:a,filteredModels:Ut,selectedModels:R,onEdit:_s,onDelete:zt,onToggleSelection:ll,onToggleSelectAll:xl,isModelUsed:pt,searchQuery:he}),e.jsx(b4,{page:G,pageSize:fe,totalItems:Ut.length,jumpToPage:q,onPageChange:Se,onPageSizeChange:Te,onJumpToPageChange:B,onJumpToPage:aa,onSelectionClear:()=>Q(new Set)})]}),e.jsxs(vs,{value:"tasks",className:"space-y-6 mt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),p&&e.jsxs("div",{className:"grid gap-4 sm:gap-6",children:[e.jsx(zl,{title:" (utils)",description:"",taskConfig:p.utils,modelNames:h,onChange:(re,pe)=>we("utils",re,pe),dataTour:"task-model-select"}),e.jsx(zl,{title:" (tool_use)",description:"",taskConfig:p.tool_use,modelNames:h,onChange:(re,pe)=>we("tool_use",re,pe)}),e.jsx(zl,{title:" (replyer)",description:"",taskConfig:p.replyer,modelNames:h,onChange:(re,pe)=>we("replyer",re,pe)}),e.jsx(zl,{title:" (planner)",description:"",taskConfig:p.planner,modelNames:h,onChange:(re,pe)=>we("planner",re,pe)}),e.jsx(zl,{title:" (vlm)",description:"",taskConfig:p.vlm,modelNames:h,onChange:(re,pe)=>we("vlm",re,pe),hideTemperature:!0}),e.jsx(zl,{title:" (voice)",description:"",taskConfig:p.voice,modelNames:h,onChange:(re,pe)=>we("voice",re,pe),hideTemperature:!0,hideMaxTokens:!0}),e.jsx(zl,{title:" (embedding)",description:"",taskConfig:p.embedding,modelNames:h,onChange:(re,pe)=>we("embedding",re,pe),hideTemperature:!0,hideMaxTokens:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsx(zl,{title:" (lpmm_entity_extract)",description:"",taskConfig:p.lpmm_entity_extract,modelNames:h,onChange:(re,pe)=>we("lpmm_entity_extract",re,pe)}),e.jsx(zl,{title:"RDF  (lpmm_rdf_build)",description:"",taskConfig:p.lpmm_rdf_build,modelNames:h,onChange:(re,pe)=>we("lpmm_rdf_build",re,pe)})]})]})]})]}),e.jsx(Fs,{open:U,onOpenChange:ft,children:e.jsxs(Us,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"model-dialog",preventOutsideClose:Ja,children:[e.jsxs($s,{children:[e.jsx(Bs,{children:P!==null?"":""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"model-name-input",children:[e.jsx(T,{htmlFor:"model_name",className:Ee.name?"text-destructive":"",children:" *"}),e.jsx(ae,{id:"model_name",value:C?.name||"",onChange:re=>{D(pe=>pe?{...pe,name:re.target.value}:null),Ee.name&&me(pe=>({...pe,name:void 0}))},placeholder:": qwen3-30b",className:Ee.name?"border-destructive focus-visible:ring-destructive":""}),Ee.name?e.jsx("p",{className:"text-xs text-destructive",children:Ee.name}):e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-provider-select",children:[e.jsx(T,{htmlFor:"api_provider",className:Ee.api_provider?"text-destructive":"",children:"API  *"}),e.jsxs(Pe,{value:C?.api_provider||"",onValueChange:re=>{D(pe=>pe?{...pe,api_provider:re}:null),Vs(),Ee.api_provider&&me(pe=>({...pe,api_provider:void 0}))},children:[e.jsx(Be,{id:"api_provider",className:Ee.api_provider?"border-destructive focus-visible:ring-destructive":"",children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:r.map(re=>e.jsx(W,{value:re,children:re},re))})]}),Ee.api_provider&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.api_provider})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-identifier-input",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"model_identifier",className:Ee.model_identifier?"text-destructive":"",children:" *"}),Ss?.modelFetcher&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{variant:"secondary",className:"text-xs",children:Ss.display_name}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>C?.api_provider&&Ds(C.api_provider,!0),disabled:Rs,children:Rs?e.jsx(Os,{className:"h-3 w-3 animate-spin"}):e.jsx(xt,{className:"h-3 w-3"})})]})]}),Ss?.modelFetcher?e.jsxs(ul,{open:z,onOpenChange:K,children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":z,className:"w-full justify-between font-normal",disabled:Rs||!!He,children:[Rs?e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Os,{className:"h-4 w-4 animate-spin"}),"..."]}):He?e.jsx("span",{className:"text-muted-foreground text-sm",children:""}):C?.model_identifier?e.jsx("span",{className:"truncate",children:C.model_identifier}):e.jsx("span",{className:"text-muted-foreground",children:"..."}),e.jsx(ix,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(sl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(Ze,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:He?e.jsxs("div",{className:"py-4 px-2 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:He}),!He.includes("API Key")&&e.jsx(_,{variant:"link",size:"sm",onClick:()=>C?.api_provider&&Ds(C.api_provider,!0),children:""})]}):""}),e.jsx(oc,{heading:"",children:We.map(re=>e.jsxs(dc,{value:re.id,onSelect:()=>{D(pe=>pe?{...pe,model_identifier:re.id}:null),K(!1)},children:[e.jsx(Mt,{className:`mr-2 h-4 w-4 ${C?.model_identifier===re.id?"opacity-100":"opacity-0"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:re.id}),re.name!==re.id&&e.jsx("span",{className:"text-xs text-muted-foreground",children:re.name})]})]},re.id))}),e.jsx(oc,{heading:"",children:e.jsxs(dc,{value:"__manual_input__",onSelect:()=>{K(!1)},children:[e.jsx(Kn,{className:"mr-2 h-4 w-4"}),"..."]})})]})})]})})]}):e.jsx(ae,{id:"model_identifier",value:C?.model_identifier||"",onChange:re=>{D(pe=>pe?{...pe,model_identifier:re.target.value}:null),Ee.model_identifier&&me(pe=>({...pe,model_identifier:void 0}))},placeholder:"Qwen/Qwen3-30B-A3B-Instruct-2507",className:Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}),Ee.model_identifier&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.model_identifier}),He&&Ss?.modelFetcher&&!Ee.model_identifier&&e.jsxs(it,{variant:"destructive",className:"mt-2 py-2",children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx(ct,{className:"text-xs",children:He})]}),Ss?.modelFetcher&&e.jsx(ae,{value:C?.model_identifier||"",onChange:re=>{D(pe=>pe?{...pe,model_identifier:re.target.value}:null),Ee.model_identifier&&me(pe=>({...pe,model_identifier:void 0}))},placeholder:"",className:`mt-2 ${Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}`}),!Ee.model_identifier&&e.jsx("p",{className:"text-xs text-muted-foreground",children:He?'"" API Key':Ss?.modelFetcher?` ${Ss.display_name}`:"API  ID"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_in",children:" (/M token)"}),e.jsx(ae,{id:"price_in",type:"number",step:"0.1",min:"0",value:C?.price_in??"",onChange:re=>{const pe=re.target.value===""?null:parseFloat(re.target.value);D(as=>as?{...as,price_in:pe}:null)},placeholder:": 0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_out",children:" (/M token)"}),e.jsx(ae,{id:"price_out",type:"number",step:"0.1",min:"0",value:C?.price_out??"",onChange:re=>{const pe=re.target.value===""?null:parseFloat(re.target.value);D(as=>as?{...as,price_out:pe}:null)},placeholder:": 0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_temperature",className:"cursor-pointer",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"enable_model_temperature",checked:C?.temperature!=null,onCheckedChange:re=>{D(re?pe=>pe?{...pe,temperature:.5}:null:pe=>pe?{...pe,temperature:null}:null)}})]}),C?.temperature!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:""}),e.jsx("span",{className:"text-sm font-medium tabular-nums",children:C.temperature.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"0"}),e.jsx(Qa,{value:[C.temperature],onValueChange:re=>D(pe=>pe?{...pe,temperature:re[0]}:null),min:0,max:1,step:.1,className:"flex-1"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.1-0.30.7-1.0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_max_tokens",className:"cursor-pointer",children:" Token"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Token "})]}),e.jsx(Ge,{id:"enable_model_max_tokens",checked:C?.max_tokens!=null,onCheckedChange:re=>{D(re?pe=>pe?{...pe,max_tokens:2048}:null:pe=>pe?{...pe,max_tokens:null}:null)}})]}),C?.max_tokens!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:" Token "}),e.jsx(ae,{type:"number",min:"1",max:"128000",value:C.max_tokens,onChange:re=>{const pe=parseInt(re.target.value);!isNaN(pe)&&pe>=1&&D(as=>as?{...as,max_tokens:pe}:null)},className:"w-28 h-8 text-sm"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" token "})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"force_stream_mode",checked:C?.force_stream_mode||!1,onCheckedChange:re=>D(pe=>pe?{...pe,force_stream_mode:re}:null)}),e.jsx(T,{htmlFor:"force_stream_mode",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(_,{type:"button",variant:"outline",size:"sm",className:"flex-1 justify-start h-9",onClick:()=>L(!0),children:[e.jsx(vn,{className:"h-4 w-4 mr-2"}),Object.keys(C?.extra_params||{}).length>0?e.jsxs("span",{children:[" ",Object.keys(C?.extra_params||{}).length," "]}):e.jsx("span",{className:"text-muted-foreground",children:""})]})}),Object.keys(C?.extra_params||{}).length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:[Object.keys(C?.extra_params||{}).slice(0,3).map(re=>e.jsx("span",{className:"inline-block mr-2",children:e.jsx("code",{className:"px-1.5 py-0.5 bg-muted rounded",children:re})},re)),Object.keys(C?.extra_params||{}).length>3&&e.jsx("span",{children:"..."})]})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>E(!1),"data-tour":"model-cancel-button",children:""}),e.jsx(_,{onClick:rs,"data-tour":"model-save-button",children:""})]})]})}),e.jsx(gs,{open:oe,onOpenChange:Ne,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',je!==null?a[je]?.name:"",'"  ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:Oa,children:""})]})]})}),e.jsx(gs,{open:$,onOpenChange:ue,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",R.size,"  "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:te,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(gs,{open:Ae,onOpenChange:ee,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsxs(us,{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-5 w-5 text-amber-500"}),""]}),e.jsx(ms,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-foreground",children:""}),""]}),e.jsxs("ul",{className:"space-y-2 ml-4 list-disc text-muted-foreground",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"text-foreground font-medium",children:""})]})})]}),e.jsxs(ds,{children:[e.jsx(hs,{onClick:Gs,children:""}),e.jsx(xs,{onClick:Oe,className:"bg-amber-600 hover:bg-amber-700",children:""})]})]})}),e.jsx(l4,{open:J,onOpenChange:L,value:C?.extra_params||{},onChange:re=>D(pe=>pe?{...pe,extra_params:re}:null)}),e.jsx(er,{})]})})}const uc=_j,mc=ww,xc=_w,hd="/api/webui/config";async function C4(){const l=await(await _e(`${hd}/adapter-config/path`)).json();return!l.success||!l.path?null:{path:l.path,lastModified:l.lastModified}}async function Kg(a){const r=await(await _e(`${hd}/adapter-config/path`,{method:"POST",headers:qs(),body:JSON.stringify({path:a})})).json();if(!r.success)throw new Error(r.message||"")}async function Qg(a){const r=await(await _e(`${hd}/adapter-config?path=${encodeURIComponent(a)}`)).json();if(!r.success)throw new Error("");return r.content}async function Yg(a,l){const c=await(await _e(`${hd}/adapter-config`,{method:"POST",headers:qs(),body:JSON.stringify({path:a,content:l})})).json();if(!c.success)throw new Error(c.message||"")}const St={inner:{version:"0.1.2"},nickname:{nickname:""},napcat_server:{host:"localhost",port:8095,token:"",heartbeat_interval:30},maibot_server:{host:"localhost",port:8e3},chat:{group_list_type:"whitelist",group_list:[],private_list_type:"whitelist",private_list:[],ban_user_id:[],ban_qq_bot:!1,enable_poke:!0},voice:{use_tts:!1},debug:{level:"INFO"}},Im={oneclick:{name:"",description:"",path:"../MaiBot-Napcat-Adapter/config.toml",icon:ra},docker:{name:"Docker",description:"Docker Compose ",path:"/MaiMBot/adapters-config/config.toml",icon:M_}};function Pm(a){try{const l=vx(a);return{inner:{...St.inner,...l.inner},nickname:{...St.nickname,...l.nickname},napcat_server:{...St.napcat_server,...l.napcat_server},maibot_server:{...St.maibot_server,...l.maibot_server},chat:{...St.chat,...l.chat},voice:{...St.voice,...l.voice},debug:{...St.debug,...l.debug}}}catch(l){throw console.error("TOML :",l),new Error(` TOML : ${l instanceof Error?l.message:""}`)}}function Fm(a){try{const l=(d,u)=>d===""||d===null||d===void 0?u:d,r={inner:{version:l(a.inner.version,St.inner.version)},nickname:{nickname:l(a.nickname.nickname,St.nickname.nickname)},napcat_server:{host:l(a.napcat_server.host,St.napcat_server.host),port:l(a.napcat_server.port||0,St.napcat_server.port),token:l(a.napcat_server.token,St.napcat_server.token),heartbeat_interval:l(a.napcat_server.heartbeat_interval||0,St.napcat_server.heartbeat_interval)},maibot_server:{host:l(a.maibot_server.host,St.maibot_server.host),port:l(a.maibot_server.port||0,St.maibot_server.port)},chat:{group_list_type:l(a.chat.group_list_type,St.chat.group_list_type),group_list:a.chat.group_list||[],private_list_type:l(a.chat.private_list_type,St.chat.private_list_type),private_list:a.chat.private_list||[],ban_user_id:a.chat.ban_user_id||[],ban_qq_bot:a.chat.ban_qq_bot??St.chat.ban_qq_bot,enable_poke:a.chat.enable_poke??St.chat.enable_poke},voice:{use_tts:a.voice.use_tts??St.voice.use_tts},debug:{level:l(a.debug.level,St.debug.level)}};let c=BS(r);return c=T4(c),c}catch(l){throw console.error("TOML :",l),new Error(` TOML : ${l instanceof Error?l.message:""}`)}}function T4(a){const l=a.split(`
`),r=[];for(let c=0;c<l.length;c++){const d=l[c];if(d==="[inner]"){r.push(d);continue}if(d.startsWith("version = ")){r.push(`${d} # `),r.push("# ");continue}if(d==="[nickname]"){r.push("[nickname] # ");continue}if(d==="[napcat_server]"){r.push("[napcat_server] # Napcatws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[napcat_server]")){r.push(`${d}      # Napcat`);continue}if(d.startsWith("port = ")&&l[c-1]?.includes("host")){r.push(`${d}             # Napcat`);continue}if(d.startsWith("token = ")){r.push(`${d}              # Napcat`);continue}if(d.startsWith("heartbeat_interval = ")){r.push(`${d} # Napcat`);continue}if(d==="[maibot_server]"){r.push("[maibot_server] # ws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[maibot_server]")){r.push(`${d} # .envHOST`);continue}if(d.startsWith("port = ")&&r[r.length-1]?.includes(".env")){r.push(`${d}        # .envPORT`);continue}if(d==="[chat]"){r.push("[chat] # ");continue}if(d.startsWith("group_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("group_list = ")){r.push(`${d}               # `),r.push("# group_list_typewhitelist"),r.push("# group_list_typeblacklist");continue}if(d.startsWith("private_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("private_list = ")){r.push(`${d}               # `),r.push("# private_list_typewhitelist"),r.push("# private_list_typeblacklist");continue}if(d.startsWith("ban_user_id = ")){r.push(`${d}   # `);continue}if(d.startsWith("ban_qq_bot = ")){r.push(`${d} # QQ`);continue}if(d.startsWith("enable_poke = ")){r.push(`${d} # `);continue}if(d==="[voice]"){r.push("[voice] # ");continue}if(d.startsWith("use_tts = ")){r.push(`${d} # ttsttsadapter`);continue}if(d.startsWith("level = ")&&r[r.length-1]==="[debug]"){r.push(`${d} # DEBUG, INFO, WARNING, ERROR, CRITICAL`);continue}r.push(d)}return r.join(`
`)}function Hm(a){if(!a.trim())return{valid:!1,error:""};if(!a.toLowerCase().endsWith(".toml"))return{valid:!1,error:" .toml "};const l=/^([a-zA-Z]:\\|\\\\[^\\]+\\[^\\]+\\).+\.toml$/i,r=/^(\/|~\/).+\.toml$/i,c=/^(\.{1,2}[\\/]|[^:\\/]).+\.toml$/i,d=l.test(a),u=r.test(a),h=c.test(a);return!d&&!u&&!h?{valid:!1,error:""}:/[<>"|?*\x00-\x1F]/.test(a)?{valid:!1,error:""}:{valid:!0,error:""}}function E4(){const[a,l]=m.useState("upload"),[r,c]=m.useState(null),[d,u]=m.useState(""),[h,f]=m.useState(""),[p,g]=m.useState("oneclick"),[b,j]=m.useState(""),[y,N]=m.useState(!1),[w,M]=m.useState(!1),[A,S]=m.useState(!1),[U,E]=m.useState(!1),[C,D]=m.useState(null),[P,O]=m.useState(!1),J=m.useRef(null),{toast:L}=Ws(),oe=m.useRef(null),Ne=z=>{if(f(z),z.trim()){const K=Hm(z);j(K.error)}else j("")},je=m.useCallback(async z=>{const K=Im[z];M(!0);try{const Ae=await Qg(K.path),ee=Pm(Ae);c(ee),g(z),f(K.path),await Kg(K.path),L({title:"",description:`${K.name}`})}catch(Ae){console.error(":",Ae),L({title:"",description:Ae instanceof Error?Ae.message:"",variant:"destructive"})}finally{M(!1)}},[L]),de=m.useCallback(async z=>{const K=Hm(z);if(!K.valid){j(K.error),L({title:"",description:K.error,variant:"destructive"});return}j(""),M(!0);try{const Ae=await Qg(z),ee=Pm(Ae);c(ee),f(z),await Kg(z),L({title:"",description:""})}catch(Ae){console.error(":",Ae),L({title:"",description:Ae instanceof Error?Ae.message:"",variant:"destructive"})}finally{M(!1)}},[L]);m.useEffect(()=>{(async()=>{try{const K=await C4();if(K&&K.path){f(K.path);const Ae=Object.entries(Im).find(([,ee])=>ee.path===K.path);Ae?(l("preset"),g(Ae[0]),await je(Ae[0])):(l("path"),await de(K.path))}}catch(K){console.error(":",K)}})()},[de,je]);const he=m.useCallback(z=>{a!=="path"&&a!=="preset"||!h||(oe.current&&clearTimeout(oe.current),oe.current=setTimeout(async()=>{N(!0);try{const K=Fm(z);await Yg(h,K),L({title:"",description:""})}catch(K){console.error(":",K),L({title:"",description:K instanceof Error?K.message:"",variant:"destructive"})}finally{N(!1)}},1e3))},[a,h,L]),ge=async()=>{if(!r||!h)return;const z=Hm(h);if(!z.valid){L({title:"",description:z.error,variant:"destructive"});return}N(!0);try{const K=Fm(r);await Yg(h,K),L({title:"",description:""})}catch(K){console.error(":",K),L({title:"",description:K instanceof Error?K.message:"",variant:"destructive"})}finally{N(!1)}},R=async()=>{h&&await de(h)},Q=z=>{if(z!==a){if(r){D(z),S(!0);return}$(z)}},$=z=>{c(null),u(""),j(""),l(z),z==="preset"&&je("oneclick"),L({title:"",description:{upload:"",path:"",preset:""}[z]})},ue=()=>{C&&($(C),D(null)),S(!1)},G=()=>{if(r){E(!0);return}Se()},Se=()=>{f(""),c(null),j(""),L({title:"",description:""})},fe=()=>{Se(),E(!1)},Te=z=>{const K=z.target.files?.[0];if(!K)return;const Ae=new FileReader;Ae.onload=ee=>{try{const Y=ee.target?.result,$e=Pm(Y);c($e),u(K.name),L({title:"",description:`${K.name}`})}catch(Y){console.error(":",Y),L({title:"",description:"",variant:"destructive"})}},Ae.readAsText(K)},q=()=>{if(!r)return;const z=Fm(r),K=new Blob([z],{type:"text/plain;charset=utf-8"}),Ae=URL.createObjectURL(K),ee=document.createElement("a");ee.href=Ae,ee.download=d||"config.toml",document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(Ae),L({title:"",description:""})},B=()=>{c(JSON.parse(JSON.stringify(St))),u("config.toml"),L({title:"",description:""})};return e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" QQ "})]})}),e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg border border-amber-500/50 bg-amber-500/10 text-amber-700 dark:text-amber-400",children:[e.jsx(Ct,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:" WebUI "})]}),e.jsx(uc,{open:P,onOpenChange:O,children:e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx(za,{className:`h-4 w-4 transition-transform duration-200 ${P?"transform rotate-180":""}`}),e.jsx("span",{className:"sr-only",children:""})]})})]})}),e.jsx(xc,{children:e.jsxs(Me,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="preset"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("preset"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(ra,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="upload"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("upload"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(rc,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="path"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("path"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(A_,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})})]}),a==="preset"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(Im).map(([z,K])=>{const Ae=K.icon,ee=p===z;return e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-all ${ee?"border-primary bg-primary/5":"border-muted hover:border-primary/50"}`,onClick:()=>{g(z),je(z)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ae,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:K.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:K.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 font-mono break-all",children:K.path})]})]})},z)})})]}),a==="path"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"config-path",className:"text-sm md:text-base",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(ae,{id:"config-path",value:h,onChange:z=>Ne(z.target.value),placeholder:": C:\\Adapter\\config.toml",className:`text-sm ${b?"border-destructive":""}`}),b&&e.jsx("p",{className:"text-xs text-destructive",children:b})]}),e.jsx(_,{onClick:()=>de(h),disabled:w||!h||!!b,className:"w-full sm:w-auto",children:w?e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sm:hidden",children:""}),e.jsx("span",{className:"hidden sm:inline",children:""})]})})]})]}),e.jsxs("details",{className:"rounded-lg bg-muted/50 p-3 group",children:[e.jsxs("summary",{className:"text-xs font-medium cursor-pointer select-none list-none flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx("svg",{className:"h-4 w-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Windows"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"C:\\Adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"D:\\MaiBot\\adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"\\\\server\\share\\config.toml"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Linux"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"/opt/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"/home/user/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"~/adapter/config.toml"})]})]}),e.jsx("p",{className:"pt-1 border-t text-[10px] md:text-xs",children:"  1 "})]})]})]})]})})]})}),e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx(ct,{children:a==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]}):a==="upload"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""}),"      "]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]})})]}),a==="upload"&&!r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx("input",{ref:J,type:"file",accept:".toml",className:"hidden",onChange:Te}),e.jsxs(_,{onClick:()=>J.current?.click(),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(rc,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:B,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-2 h-4 w-4"}),""]})]}),a==="upload"&&r&&e.jsx("div",{className:"flex gap-2",children:e.jsxs(_,{onClick:q,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Wt,{className:"mr-2 h-4 w-4"}),""]})}),(a==="preset"||a==="path")&&r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(_,{onClick:ge,size:"sm",disabled:y||!!b,className:"w-full sm:w-auto",children:[e.jsx(fc,{className:"mr-2 h-4 w-4"}),y?"...":""]}),e.jsxs(_,{onClick:R,size:"sm",variant:"outline",disabled:w,className:"w-full sm:w-auto",children:[e.jsx(xt,{className:`mr-2 h-4 w-4 ${w?"animate-spin":""}`}),""]}),a==="path"&&e.jsxs(_,{onClick:G,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),""]})]}),r?e.jsxs(ea,{defaultValue:"napcat",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Gt,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:grid-cols-5",children:[e.jsxs(Xe,{value:"napcat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Napcat "}),e.jsx("span",{className:"sm:hidden",children:"Napcat"})]}),e.jsxs(Xe,{value:"maibot",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Xe,{value:"chat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Xe,{value:"voice",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(Xe,{value:"debug",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:""})]})}),e.jsx(vs,{value:"napcat",className:"space-y-4",children:e.jsx(M4,{config:r,onChange:z=>{c(z),he(z)}})}),e.jsx(vs,{value:"maibot",className:"space-y-4",children:e.jsx(A4,{config:r,onChange:z=>{c(z),he(z)}})}),e.jsx(vs,{value:"chat",className:"space-y-4",children:e.jsx(z4,{config:r,onChange:z=>{c(z),he(z)}})}),e.jsx(vs,{value:"voice",className:"space-y-4",children:e.jsx(R4,{config:r,onChange:z=>{c(z),he(z)}})}),e.jsx(vs,{value:"debug",className:"space-y-4",children:e.jsx(D4,{config:r,onChange:z=>{c(z),he(z)}})})]}):e.jsx("div",{className:"rounded-lg border bg-card p-6 md:p-12",children:e.jsxs("div",{className:"text-center space-y-3 md:space-y-4",children:[e.jsx(Ea,{className:"h-12 w-12 md:h-16 md:w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-2 px-4",children:a==="preset"?"":a==="upload"?"":""})]})]})}),e.jsx(gs,{open:A,onOpenChange:S,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-destructive font-medium",children:""})]})]}),e.jsxs(ds,{children:[e.jsx(hs,{onClick:()=>{S(!1),D(null)},children:""}),e.jsx(xs,{onClick:ue,children:""})]})]})}),e.jsx(gs,{open:U,onOpenChange:E,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground text-sm",children:""})]})]}),e.jsxs(ds,{children:[e.jsx(hs,{onClick:()=>E(!1),children:""}),e.jsx(xs,{onClick:fe,className:"bg-destructive hover:bg-destructive/90",children:""})]})]})})]})})}function M4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:"Napcat WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-host",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"napcat-host",value:a.napcat_server.host,onChange:r=>l({...a,napcat_server:{...a.napcat_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-port",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"napcat-port",type:"number",value:a.napcat_server.port||"",onChange:r=>l({...a,napcat_server:{...a.napcat_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8095",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat  8095"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-token",className:"text-sm md:text-base",children:"Token"}),e.jsx(ae,{id:"napcat-token",type:"password",value:a.napcat_server.token,onChange:r=>l({...a,napcat_server:{...a.napcat_server,token:r.target.value}}),placeholder:"",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-heartbeat",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"napcat-heartbeat",type:"number",value:a.napcat_server.heartbeat_interval||"",onChange:r=>l({...a,napcat_server:{...a.napcat_server,heartbeat_interval:r.target.value?parseInt(r.target.value):0}}),placeholder:"30",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Napcat  30"})]})]})]})})}function A4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:" WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-host",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"maibot-host",value:a.maibot_server.host,onChange:r=>l({...a,maibot_server:{...a.maibot_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  HOST "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-port",className:"text-sm md:text-base",children:""}),e.jsx(ae,{id:"maibot-port",type:"number",value:a.maibot_server.port||"",onChange:r=>l({...a,maibot_server:{...a.maibot_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8000",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  PORT  8000"})]})]})]})})}function z4({config:a,onChange:l}){const r=u=>{const h={...a};u==="group"?h.chat.group_list=[...h.chat.group_list,0]:u==="private"?h.chat.private_list=[...h.chat.private_list,0]:h.chat.ban_user_id=[...h.chat.ban_user_id,0],l(h)},c=(u,h)=>{const f={...a};u==="group"?f.chat.group_list=f.chat.group_list.filter((p,g)=>g!==h):u==="private"?f.chat.private_list=f.chat.private_list.filter((p,g)=>g!==h):f.chat.ban_user_id=f.chat.ban_user_id.filter((p,g)=>g!==h),l(f)},d=(u,h,f)=>{const p={...a};u==="group"?p.chat.group_list[h]=f:u==="private"?p.chat.private_list[h]=f:p.chat.ban_user_id[h]=f,l(p)};return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"grid gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.chat.group_list_type,onValueChange:u=>l({...a,chat:{...a.chat,group_list_type:u}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"whitelist",children:""}),e.jsx(W,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("group"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.group_list.map((u,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{type:"number",value:u,onChange:f=>d("group",h,parseInt(f.target.value)||0),placeholder:"",className:"text-sm md:text-base"}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",u," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>c("group",h),children:""})]})]})]})]},h)),a.chat.group_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.chat.private_list_type,onValueChange:u=>l({...a,chat:{...a.chat,private_list_type:u}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"whitelist",children:""}),e.jsx(W,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("private"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.private_list.map((u,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{type:"number",value:u,onChange:f=>d("private",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",u," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>c("private",h),children:""})]})]})]})]},h)),a.chat.private_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>r("ban"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ea,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.ban_user_id.map((u,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{type:"number",value:u,onChange:f=>d("ban",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(gs,{children:[e.jsx(jt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",u," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>c("ban",h),children:""})]})]})]})]},h)),a.chat.ban_user_id.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:"QQ"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"QQ"})]}),e.jsx(Ge,{checked:a.chat.ban_qq_bot,onCheckedChange:u=>l({...a,chat:{...a.chat,ban_qq_bot:u}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:a.chat.enable_poke,onCheckedChange:u=>l({...a,chat:{...a.chat,enable_poke:u}})})]})]})]})})}function R4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:" TTS "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" TTS "})]}),e.jsx(Ge,{checked:a.voice.use_tts,onCheckedChange:r=>l({...a,voice:{use_tts:r}})})]})]})})}function D4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.debug.level,onValueChange:r=>l({...a,debug:{level:r}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"DEBUG",children:"DEBUG"}),e.jsx(W,{value:"INFO",children:"INFO"}),e.jsx(W,{value:"WARNING",children:"WARNING"}),e.jsx(W,{value:"ERROR",children:"ERROR"}),e.jsx(W,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})})]})})}const O4=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],L4=/^(aria-|data-)/,eN=a=>Object.fromEntries(Object.entries(a).filter(([l])=>L4.test(l)||O4.includes(l)));function U4(a,l){const r=eN(a);return Object.keys(a).some(c=>!Object.hasOwn(r,c)&&a[c]!==l[c])}class $4 extends m.Component{container;plugin;componentDidMount(){this.installPlugin()}componentDidUpdate(l){if(l.uppy!==this.props.uppy)this.uninstallPlugin(l),this.installPlugin();else if(U4(this.props,l)){const{uppy:r,...c}={...this.props,target:this.container};this.plugin.setOptions(c)}}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{uppy:l,...r}={id:"Dashboard",...this.props,inline:!0,target:this.container};l.use(m1,r),this.plugin=l.getPlugin(r.id)}uninstallPlugin(l=this.props){const{uppy:r}=l;r.removePlugin(this.plugin)}render(){return m.createElement("div",{className:"uppy-Container",ref:l=>{this.container=l},...eN(this.props)})}}function B4({src:a,alt:l="",className:r,maxRetries:c=5,retryInterval:d=1500}){const[u,h]=m.useState("loading"),[f,p]=m.useState(0),[g,b]=m.useState(null),[j,y]=m.useState(a);a!==j&&(h("loading"),p(0),b(null),y(a));const N=m.useCallback(async()=>{try{const w=await fetch(a,{credentials:"include"});if(w.status===202){h("generating"),f<c?setTimeout(()=>{p(S=>S+1)},d):h("error");return}if(!w.ok){h("error");return}const M=await w.blob(),A=URL.createObjectURL(M);b(A),h("loaded")}catch(w){console.error(":",w),h("error")}},[a,f,c,d]);return m.useEffect(()=>{N()},[N]),m.useEffect(()=>()=>{g&&URL.revokeObjectURL(g)},[g]),u==="loading"||u==="generating"?e.jsx(ws,{className:F("w-full h-full",r)}):u==="error"||!g?e.jsx("div",{className:F("w-full h-full flex items-center justify-center bg-muted",r),children:e.jsx(cx,{className:"h-8 w-8 text-muted-foreground"})}):e.jsx("img",{src:g,alt:l,className:F("w-full h-full object-contain",r)})}function I4({children:a,className:l}){return e.jsx(px,{content:a,className:l})}const Ya="/api/webui/emoji";async function P4(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.is_registered!==void 0&&l.append("is_registered",a.is_registered.toString()),a.is_banned!==void 0&&l.append("is_banned",a.is_banned.toString()),a.format&&l.append("format",a.format),a.sort_by&&l.append("sort_by",a.sort_by),a.sort_order&&l.append("sort_order",a.sort_order);const r=await _e(`${Ya}/list?${l}`,{});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function F4(a){const l=await _e(`${Ya}/${a}`,{});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function H4(a,l){const r=await _e(`${Ya}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function V4(a){const l=await _e(`${Ya}/${a}`,{method:"DELETE"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function G4(){const a=await _e(`${Ya}/stats/summary`,{});if(!a.ok)throw new Error(`: ${a.statusText}`);return a.json()}async function q4(a){const l=await _e(`${Ya}/${a}/register`,{method:"POST"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function K4(a){const l=await _e(`${Ya}/${a}/ban`,{method:"POST"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}function Q4(a,l=!1){return l?`${Ya}/${a}/thumbnail?original=true`:`${Ya}/${a}/thumbnail`}function Y4(a){return`${Ya}/${a}/thumbnail?original=true`}async function J4(a){const l=await _e(`${Ya}/batch/delete`,{method:"POST",body:JSON.stringify({emoji_ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function X4(){return`${Ya}/upload`}function Z4(){const[a,l]=m.useState([]),[r,c]=m.useState(null),[d,u]=m.useState(!1),[h,f]=m.useState(1),[p,g]=m.useState(0),[b,j]=m.useState(20),[y,N]=m.useState("all"),[w,M]=m.useState("all"),[A,S]=m.useState("all"),[U,E]=m.useState("usage_count"),[C,D]=m.useState("desc"),[P,O]=m.useState(null),[J,L]=m.useState(!1),[oe,Ne]=m.useState(!1),[je,de]=m.useState(!1),[he,ge]=m.useState(new Set),[R,Q]=m.useState(!1),[$,ue]=m.useState(""),[G,Se]=m.useState("medium"),[fe,Te]=m.useState(!1),{toast:q}=Ws(),B=m.useCallback(async()=>{try{u(!0);const me=await P4({page:h,page_size:b,is_registered:y==="all"?void 0:y==="registered",is_banned:w==="all"?void 0:w==="banned",format:A==="all"?void 0:A,sort_by:U,sort_order:C});l(me.data),g(me.total)}catch(me){const ze=me instanceof Error?me.message:"";q({title:"",description:ze,variant:"destructive"})}finally{u(!1)}},[h,b,y,w,A,U,C,q]),z=async()=>{try{const me=await G4();c(me.data)}catch(me){console.error(":",me)}};m.useEffect(()=>{B()},[B]),m.useEffect(()=>{z()},[]);const K=async me=>{try{const ze=await F4(me.id);O(ze.data),L(!0)}catch(ze){const at=ze instanceof Error?ze.message:"";q({title:"",description:at,variant:"destructive"})}},Ae=me=>{O(me),Ne(!0)},ee=me=>{O(me),de(!0)},Y=async()=>{if(P)try{await V4(P.id),q({title:"",description:""}),de(!1),O(null),B(),z()}catch(me){const ze=me instanceof Error?me.message:"";q({title:"",description:ze,variant:"destructive"})}},$e=async me=>{try{await q4(me.id),q({title:"",description:""}),B(),z()}catch(ze){const at=ze instanceof Error?ze.message:"";q({title:"",description:at,variant:"destructive"})}},H=async me=>{try{await K4(me.id),q({title:"",description:""}),B(),z()}catch(ze){const at=ze instanceof Error?ze.message:"";q({title:"",description:at,variant:"destructive"})}},se=me=>{const ze=new Set(he);ze.has(me)?ze.delete(me):ze.add(me),ge(ze)},Ue=async()=>{try{const me=await J4(Array.from(he));q({title:"",description:me.message}),ge(new Set),Q(!1),B(),z()}catch(me){q({title:"",description:me instanceof Error?me.message:"",variant:"destructive"})}},ie=()=>{const me=parseInt($),ze=Math.ceil(p/b);me>=1&&me<=ze?(f(me),ue("")):q({title:"",description:`1-${ze}`,variant:"destructive"})},Ee=r?.formats?Object.keys(r.formats):[];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>Te(!0),className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),""]})]}),e.jsx(Ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[r&&e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(ke,{children:e.jsxs(Re,{className:"pb-2",children:[e.jsx(is,{children:""}),e.jsx(De,{className:"text-2xl",children:r.total})]})}),e.jsx(ke,{children:e.jsxs(Re,{className:"pb-2",children:[e.jsx(is,{children:""}),e.jsx(De,{className:"text-2xl text-green-600",children:r.registered})]})}),e.jsx(ke,{children:e.jsxs(Re,{className:"pb-2",children:[e.jsx(is,{children:""}),e.jsx(De,{className:"text-2xl text-red-600",children:r.banned})]})}),e.jsx(ke,{children:e.jsxs(Re,{className:"pb-2",children:[e.jsx(is,{children:""}),e.jsx(De,{className:"text-2xl text-gray-600",children:r.unregistered})]})})]}),e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx(Bo,{className:"h-5 w-5"}),""]})}),e.jsxs(Me,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:`${U}-${C}`,onValueChange:me=>{const[ze,at]=me.split("-");E(ze),D(at),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"usage_count-desc",children:" ()"}),e.jsx(W,{value:"usage_count-asc",children:" ()"}),e.jsx(W,{value:"register_time-desc",children:" ()"}),e.jsx(W,{value:"register_time-asc",children:" ()"}),e.jsx(W,{value:"record_time-desc",children:" ()"}),e.jsx(W,{value:"record_time-asc",children:" ()"}),e.jsx(W,{value:"last_used_time-desc",children:" ()"}),e.jsx(W,{value:"last_used_time-asc",children:" ()"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:y,onValueChange:me=>{N(me),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"registered",children:""}),e.jsx(W,{value:"unregistered",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:w,onValueChange:me=>{M(me),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"banned",children:""}),e.jsx(W,{value:"unbanned",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:A,onValueChange:me=>{S(me),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),Ee.map(me=>e.jsxs(W,{value:me,children:[me.toUpperCase()," (",r?.formats[me],")"]},me))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[he.size>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",he.size," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:G,onValueChange:me=>Se(me),children:[e.jsx(Be,{className:"w-24",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"small",children:""}),e.jsx(W,{value:"medium",children:""}),e.jsx(W,{value:"large",children:""})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"emoji-page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:b.toString(),onValueChange:me=>{j(parseInt(me)),f(1),ge(new Set)},children:[e.jsx(Be,{id:"emoji-page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"40",children:"40"}),e.jsx(W,{value:"60",children:"60"}),e.jsx(W,{value:"100",children:"100"})]})]}),he.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ge(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>Q(!0),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs(_,{variant:"outline",size:"sm",onClick:B,disabled:d,children:[e.jsx(xt,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]})})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsxs(is,{children:[" ",p,"  ",h," "]})]}),e.jsxs(Me,{children:[a.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""}):e.jsx("div",{className:`grid gap-3 ${G==="small"?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10":G==="medium"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8":"grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"}`,children:a.map(me=>e.jsxs("div",{className:`group relative rounded-lg border bg-card overflow-hidden hover:ring-2 hover:ring-primary transition-all cursor-pointer ${he.has(me.id)?"ring-2 ring-primary bg-primary/5":""}`,onClick:()=>se(me.id),children:[e.jsx("div",{className:`absolute top-1 left-1 z-10 transition-opacity ${he.has(me.id)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${he.has(me.id)?"bg-primary border-primary text-primary-foreground":"bg-background/80 border-muted-foreground/50"}`,children:he.has(me.id)&&e.jsx(bt,{className:"h-3 w-3"})})}),e.jsxs("div",{className:"absolute top-1 right-1 z-10 flex flex-col gap-0.5",children:[me.is_registered&&e.jsx(Ce,{variant:"default",className:"bg-green-600 text-[10px] px-1 py-0",children:""}),me.is_banned&&e.jsx(Ce,{variant:"destructive",className:"text-[10px] px-1 py-0",children:""})]}),e.jsx("div",{className:`aspect-square bg-muted flex items-center justify-center overflow-hidden ${G==="small"?"p-1":G==="medium"?"p-2":"p-3"}`,children:e.jsx(B4,{src:Q4(me.id),alt:""})}),e.jsxs("div",{className:`border-t bg-card ${G==="small"?"p-1":"p-2"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-1 text-xs text-muted-foreground mb-1",children:[e.jsx(Ce,{variant:"outline",className:"text-[10px] px-1 py-0",children:me.format.toUpperCase()}),e.jsxs("span",{className:"font-mono",children:[me.usage_count,""]})]}),e.jsxs("div",{className:`flex gap-1 justify-center opacity-0 group-hover:opacity-100 transition-opacity ${G==="small"?"flex-wrap":""}`,children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:ze=>{ze.stopPropagation(),Ae(me)},title:"",children:e.jsx(Jn,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:ze=>{ze.stopPropagation(),K(me)},title:"",children:e.jsx(Vt,{className:"h-3 w-3"})}),!me.is_registered&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-green-700",onClick:ze=>{ze.stopPropagation(),$e(me)},title:"",children:e.jsx(bt,{className:"h-3 w-3"})}),!me.is_banned&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-orange-600 hover:text-orange-700",onClick:ze=>{ze.stopPropagation(),H(me)},title:"",children:e.jsx(z_,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600 hover:text-red-700",onClick:ze=>{ze.stopPropagation(),ee(me)},title:"",children:e.jsx(ls,{className:"h-3 w-3"})})]})]})]},me.id))}),p>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(h-1)*b+1," "," ",Math.min(h*b,p),"  ",p," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(me=>Math.max(1,me-1)),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:$,onChange:me=>ue(me.target.value),onKeyDown:me=>me.key==="Enter"&&ie(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(p/b)}),e.jsx(_,{variant:"outline",size:"sm",onClick:ie,disabled:!$,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(me=>me+1),disabled:h>=Math.ceil(p/b),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(p/b)),disabled:h>=Math.ceil(p/b),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(W4,{emoji:P,open:J,onOpenChange:L}),e.jsx(ek,{emoji:P,open:oe,onOpenChange:Ne,onSuccess:()=>{B(),z()}}),e.jsx(sk,{open:fe,onOpenChange:Te,onSuccess:()=>{B(),z()}})]})}),e.jsx(gs,{open:R,onOpenChange:Q,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",he.size," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:Ue,children:""})]})]})}),e.jsx(Fs,{open:je,onOpenChange:de,children:e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>de(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:Y,children:""})]})]})})]})}function W4({emoji:a,open:l,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl max-h-[90vh]",children:[e.jsx($s,{children:e.jsx(Bs,{children:""})}),e.jsx(Ze,{className:"max-h-[calc(90vh-8rem)] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:Y4(a.id),alt:a.description||"",className:"w-full h-full object-cover",onError:d=>{const u=d.target;u.style.display="none";const h=u.parentElement;h&&(h.innerHTML='<svg class="h-16 w-16 text-muted-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>')}})})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:"ID"}),e.jsx("div",{className:"mt-1 font-mono",children:a.id})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(Ce,{variant:"outline",children:a.format.toUpperCase()})})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.full_path})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.emoji_hash})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),a.description?e.jsx("div",{className:"mt-1 rounded-lg border bg-muted/50 p-3",children:e.jsx(I4,{className:"prose-sm",children:a.description})}):e.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:"-"})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:a.emotion?e.jsx("span",{className:"text-sm",children:a.emotion}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.is_registered&&e.jsx(Ce,{variant:"default",className:"bg-green-600",children:""}),a.is_banned&&e.jsx(Ce,{variant:"destructive",children:""}),!a.is_registered&&!a.is_banned&&e.jsx(Ce,{variant:"outline",children:""})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-lg",children:a.usage_count})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.record_time)})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.register_time)})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.last_used_time)})]})]})})]})})}function ek({emoji:a,open:l,onOpenChange:r,onSuccess:c}){const[d,u]=m.useState(""),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[b,j]=m.useState(!1),{toast:y}=Ws();m.useEffect(()=>{a&&(u(a.emotion||""),f(a.is_registered),g(a.is_banned))},[a]);const N=async()=>{if(a)try{j(!0);const w=d.split(/[,,]/).map(M=>M.trim()).filter(Boolean).join(",");await H4(a.id,{emotion:w||void 0,is_registered:h,is_banned:p}),y({title:"",description:""}),r(!1),c()}catch(w){const M=w instanceof Error?w.message:"";y({title:"",description:M,variant:"destructive"})}finally{j(!1)}};return a?e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:""}),e.jsx(rt,{value:d,onChange:w=>u(w.target.value),placeholder:"...",rows:2,className:"mt-1"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"is_registered",checked:h,onCheckedChange:w=>{w===!0?(f(!0),g(!1)):f(!1)}}),e.jsx(T,{htmlFor:"is_registered",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"is_banned",checked:p,onCheckedChange:w=>{w===!0?(g(!0),f(!1)):g(!1)}}),e.jsx(T,{htmlFor:"is_banned",className:"cursor-pointer",children:""})]})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:N,disabled:b,children:b?"...":""})]})]})}):null}function sk({open:a,onOpenChange:l,onSuccess:r}){const[c,d]=m.useState("select"),[u,h]=m.useState([]),[f,p]=m.useState(null),[g,b]=m.useState(!1),{toast:j}=Ws(),y=m.useMemo(()=>new x1({id:"emoji-uploader",autoProceed:!1,restrictions:{maxFileSize:10485760,allowedFileTypes:["image/jpeg","image/png","image/gif","image/webp"],maxNumberOfFiles:20},locale:{pluralize:()=>0,strings:{addMoreFiles:"",addingMoreFiles:"",allowedFileTypes:"%{types}",cancel:"",closeModal:"",complete:"",connectedToInternet:"",copyLink:"",copyLinkToClipboardFallback:"",copyLinkToClipboardSuccess:"",dashboardTitle:"",dashboardWindowTitle:" ESC ",done:"",dropHereOr:" %{browse}",dropHint:"",dropPasteFiles:" %{browseFiles}",dropPasteFolders:" %{browseFolders}",dropPasteBoth:"%{browseFiles}  %{browseFolders}",dropPasteImportFiles:"%{browseFiles} ",dropPasteImportFolders:"%{browseFolders} ",dropPasteImportBoth:"%{browseFiles}%{browseFolders} ",editFile:"",editing:" %{file}",emptyFolderAdded:"",exceedsSize:"%{file}  %{size}",failedToUpload:" %{file} ",fileSource:"%{name}",filesUploadedOfTotal:{0:" %{complete} / %{smart_count} ",1:" %{complete} / %{smart_count} "},filter:"",finishEditingFile:"",folderAdded:{0:" %{folder}  %{smart_count} ",1:" %{folder}  %{smart_count} "},generatingThumbnails:"...",import:"",importFiles:"",importFrom:" %{name} ",loading:"...",logOut:"",myDevice:"",noFilesFound:"",noInternetConnection:"",openFolderNamed:" %{name}",pause:"",pauseUpload:"",paused:"",poweredBy:"%{uppy}",processingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},recording:"",removeFile:"",resetFilter:"",resume:"",resumeUpload:"",retry:"",retryUpload:"",save:"",saveChanges:"",selectFileNamed:" %{name}",selectX:{0:" %{smart_count}",1:" %{smart_count}"},smile:"",startRecording:"",stopRecording:"",takePicture:"",timedOut:" %{seconds} ",upload:"",uploadComplete:"",uploadFailed:"",uploadPaused:"",uploadXFiles:{0:"%{smart_count} ",1:"%{smart_count} "},uploadXNewFiles:{0:"+%{smart_count} ",1:"+%{smart_count} "},uploading:"",uploadingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},xFilesSelected:{0:" %{smart_count} ",1:" %{smart_count} "},xMoreFilesAdded:{0:" %{smart_count} ",1:" %{smart_count} "},xTimeLeft:" %{time}",youCanOnlyUploadFileTypes:"%{types}",youCanOnlyUploadX:{0:" %{smart_count} ",1:" %{smart_count} "},youHaveToAtLeastSelectX:{0:" %{smart_count} ",1:" %{smart_count} "},browseFiles:"",browseFolders:"",cancelUpload:"",addMore:"",back:"",editFileWithFilename:" %{file}"}}}),[]);m.useEffect(()=>{const P=()=>{const O=y.getFiles();if(O.length===0)return;const J=O.map(L=>({id:L.id,name:L.name,previewUrl:L.preview||URL.createObjectURL(L.data),emotion:"",description:"",isRegistered:!0,file:L.data}));h(J),O.length===1?(p(J[0].id),d("edit-single")):d("edit-multiple")};return y.on("upload",P),()=>{y.off("upload",P)}},[y]),m.useEffect(()=>{a||(y.cancelAll(),d("select"),h([]),p(null),b(!1))},[a,y]);const N=m.useCallback((P,O)=>{h(J=>J.map(L=>L.id===P?{...L,...O}:L))},[]),w=m.useCallback(P=>P.emotion.trim().length>0,[]),M=m.useMemo(()=>u.length>0&&u.every(w),[u,w]),A=m.useMemo(()=>u.find(P=>P.id===f)||null,[u,f]),S=m.useCallback(()=>{(c==="edit-single"||c==="edit-multiple")&&(d("select"),h([]),p(null))},[c]),U=m.useCallback(async()=>{if(!M){j({title:"",description:"",variant:"destructive"});return}b(!0);let P=0,O=0;try{for(const J of u){const L=new FormData;L.append("file",J.file),L.append("emotion",J.emotion),L.append("description",J.description),L.append("is_registered",J.isRegistered.toString());try{(await _e(X4(),{method:"POST",body:L})).ok?P++:O++}catch{O++}}O===0?(j({title:"",description:` ${P} `}),l(!1),r()):(j({title:"",description:` ${P}  ${O} `,variant:"destructive"}),r())}finally{b(!1)}},[M,u,j,l,r]),E=()=>e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"border rounded-lg overflow-hidden w-full",children:e.jsx($4,{uppy:y,proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!0,height:350,width:"100%",theme:"auto",note:" JPGPNGGIFWebP  20 "})})}),C=()=>{const P=u[0];return P?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ma,{className:"h-4 w-4 mr-1"}),""]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"w-32 h-32 rounded-lg border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:P.previewUrl,alt:P.name,className:"max-w-full max-h-full object-contain"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center truncate max-w-32",children:P.name})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"single-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"single-emotion",value:P.emotion,onChange:O=>N(P.id,{emotion:O.target.value}),placeholder:",",className:P.emotion.trim()?"":"border-destructive"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"single-description",children:""}),e.jsx(ae,{id:"single-description",value:P.description,onChange:O=>N(P.id,{description:O.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"single-is-registered",checked:P.isRegistered,onCheckedChange:O=>N(P.id,{isRegistered:O===!0})}),e.jsx(T,{htmlFor:"single-is-registered",className:"cursor-pointer",children:""})]})]})]}),e.jsx(nt,{children:e.jsx(_,{onClick:U,disabled:!M||g,children:g?"...":""})})]}):null},D=()=>{const P=u.filter(w).length,O=u.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ma,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["",P,"/",O," "]})]}),e.jsx(Ce,{variant:M?"default":"secondary",children:M?e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Aa,{className:"h-3 w-3 mr-1"}),""]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ze,{className:"h-[350px] pr-2",children:e.jsx("div",{className:"space-y-2",children:u.map(J=>{const L=w(J),oe=f===J.id;return e.jsxs("div",{onClick:()=>p(J.id),className:`
                      flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all
                      ${oe?"ring-2 ring-primary":""}
                      ${L?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-border hover:border-muted-foreground/50"}
                    `,children:[e.jsx("div",{className:"w-12 h-12 rounded border overflow-hidden bg-muted flex-shrink-0 flex items-center justify-center",children:e.jsx("img",{src:J.previewUrl,alt:J.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:J.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:J.emotion||""})]}),L?e.jsx(bt,{className:"h-5 w-5 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-muted-foreground/30 flex-shrink-0"})]},J.id)})})}),e.jsx("div",{className:"border rounded-lg p-4",children:A?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:A.previewUrl,alt:A.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:A.name}),w(A)&&e.jsxs(Ce,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(Mt,{className:"h-3 w-3 mr-1"}),""]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"multi-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"multi-emotion",value:A.emotion,onChange:J=>N(A.id,{emotion:J.target.value}),placeholder:",",className:A.emotion.trim()?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"multi-description",children:""}),e.jsx(ae,{id:"multi-description",value:A.description,onChange:J=>N(A.id,{description:J.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"multi-is-registered",checked:A.isRegistered,onCheckedChange:J=>N(A.id,{isRegistered:J===!0})}),e.jsx(T,{htmlFor:"multi-is-registered",className:"cursor-pointer text-sm",children:""})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(cx,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:""})]})})})]}),e.jsx(nt,{children:e.jsx(_,{onClick:U,disabled:!M||g,children:g?"...":` (${O})`})})]})};return e.jsx(Fs,{open:a,onOpenChange:l,children:e.jsxs(Us,{className:"max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(rc,{className:"h-5 w-5"}),c==="select"&&" - ",c==="edit-single"&&" - ",c==="edit-multiple"&&" - "]}),e.jsxs(Xs,{children:[c==="select"&&" JPGPNGGIFWebP  10MB",c==="edit-single"&&"",c==="edit-multiple"&&""]})]}),e.jsxs("div",{className:"overflow-y-auto pr-1",children:[c==="select"&&E(),c==="edit-single"&&C(),c==="edit-multiple"&&D()]})]})})}function tk(){const[a,l]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[b,j]=m.useState(""),[y,N]=m.useState(null),[w,M]=m.useState(!1),[A,S]=m.useState(!1),[U,E]=m.useState(!1),[C,D]=m.useState(null),[P,O]=m.useState(new Set),[J,L]=m.useState(!1),[oe,Ne]=m.useState(""),[je,de]=m.useState({total:0,recent_7days:0,chat_count:0,top_chats:{}}),[he,ge]=m.useState([]),[R,Q]=m.useState(new Map),[$,ue]=m.useState(!1),[G,Se]=m.useState(0),{toast:fe}=Ws(),Te=async()=>{try{c(!0);const ie=await J1({page:h,page_size:p,search:b||void 0});l(ie.data),u(ie.total)}catch(ie){fe({title:"",description:ie instanceof Error?ie.message:"",variant:"destructive"})}finally{c(!1)}},q=async()=>{try{const ie=await t2();ie?.data&&de(ie.data)}catch(ie){console.error(":",ie)}},B=async()=>{try{const ie=await xx();Se(ie.unchecked)}catch(ie){console.error(":",ie)}},z=async()=>{try{const ie=await mx();if(ie?.data){ge(ie.data);const Ee=new Map;ie.data.forEach(me=>{Ee.set(me.chat_id,me.chat_name)}),Q(Ee)}}catch(ie){console.error(":",ie)}},K=ie=>R.get(ie)||ie;m.useEffect(()=>{Te(),B(),q(),z()},[h,p,b]);const Ae=async ie=>{try{const Ee=await X1(ie.id);N(Ee.data),M(!0)}catch(Ee){fe({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},ee=ie=>{N(ie),S(!0)},Y=async ie=>{try{await e2(ie.id),fe({title:"",description:`: ${ie.situation}`}),D(null),Te(),q()}catch(Ee){fe({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},$e=ie=>{const Ee=new Set(P);Ee.has(ie)?Ee.delete(ie):Ee.add(ie),O(Ee)},H=()=>{P.size===a.length&&a.length>0?O(new Set):O(new Set(a.map(ie=>ie.id)))},se=async()=>{try{await s2(Array.from(P)),fe({title:"",description:` ${P.size} `}),O(new Set),L(!1),Te(),q()}catch(ie){fe({title:"",description:ie instanceof Error?ie.message:"",variant:"destructive"})}},Ue=()=>{const ie=parseInt(oe),Ee=Math.ceil(d/p);ie>=1&&ie<=Ee?(f(ie),Ne("")):fe({title:"",description:`1-${Ee}`,variant:"destructive"})};return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ra,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>ue(!0),className:"gap-2",children:[e.jsx(ev,{className:"h-4 w-4"}),"",G>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:G>99?"99+":G})]}),e.jsxs(_,{onClick:()=>E(!0),className:"gap-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),""]})]})]})}),e.jsx(Ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:je.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"7"}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:je.recent_7days})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-blue-600",children:je.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 mt-1.5",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(At,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{id:"search",placeholder:"...",value:b,onChange:ie=>j(ie.target.value),className:"pl-9"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:P.size>0&&e.jsxs("span",{children:[" ",P.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:ie=>{g(parseInt(ie)),f(1),O(new Set)},children:[e.jsx(Be,{id:"page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),P.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>O(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>L(!0),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{className:"w-12",children:e.jsx(Js,{checked:P.size===a.length&&a.length>0,onCheckedChange:H})}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r?e.jsx(ht,{children:e.jsx(Ye,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(ht,{children:e.jsx(Ye,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(ie=>e.jsxs(ht,{children:[e.jsx(Ye,{children:e.jsx(Js,{checked:P.has(ie.id),onCheckedChange:()=>$e(ie.id)})}),e.jsx(Ye,{className:"font-medium max-w-xs truncate",children:ie.situation}),e.jsx(Ye,{className:"max-w-xs truncate",children:ie.style}),e.jsx(Ye,{className:"max-w-[200px] truncate",title:K(ie.chat_id),style:{wordBreak:"keep-all"},children:e.jsx("span",{className:"whitespace-nowrap overflow-hidden text-ellipsis block",children:K(ie.chat_id)})}),e.jsx(Ye,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>ee(ie),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Ae(ie),title:"",children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>D(ie),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})})]},ie.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(ie=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Js,{checked:P.has(ie.id),onCheckedChange:()=>$e(ie.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 overflow-hidden space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 w-full break-all",title:ie.situation,children:ie.situation})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm line-clamp-2 w-full break-all",title:ie.style,children:ie.style})]})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm truncate",title:K(ie.chat_id),style:{wordBreak:"keep-all"},children:K(ie.chat_id)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>ee(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Jn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ae(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:e.jsx(ia,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>D(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ls,{className:"h-3 w-3 mr-1"}),""]})]})]},ie.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:oe,onChange:ie=>Ne(ie.target.value),onKeyDown:ie=>ie.key==="Enter"&&Ue(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:Ue,disabled:!oe,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(ak,{expression:y,open:w,onOpenChange:M,chatNameMap:R}),e.jsx(lk,{open:U,onOpenChange:E,chatList:he,onSuccess:()=>{Te(),q(),E(!1)}}),e.jsx(nk,{expression:y,open:A,onOpenChange:S,chatList:he,onSuccess:()=>{Te(),q(),S(!1)}}),e.jsx(gs,{open:!!C,onOpenChange:()=>D(null),children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',C?.situation,'"  ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>C&&Y(C),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(rk,{open:J,onOpenChange:L,onConfirm:se,count:P.size}),e.jsx(Ov,{open:$,onOpenChange:ie=>{ue(ie),ie||(Te(),q(),B())}})]})}function ak({expression:a,open:l,onOpenChange:r,chatNameMap:c}){if(!a)return null;const d=h=>h?new Date(h*1e3).toLocaleString("zh-CN"):"-",u=h=>c.get(h)||h;return e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ki,{label:"",value:a.situation}),e.jsx(Ki,{label:"",value:a.style}),e.jsx(Ki,{label:"",value:u(a.chat_id)}),e.jsx(Ki,{icon:Jr,label:"ID",value:a.id.toString(),mono:!0})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(Ki,{icon:na,label:"",value:d(a.create_date)})}),e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-3 block",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("flex h-8 w-8 items-center justify-center rounded-full",a.checked?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.checked?e.jsx(bt,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.checked?"":""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("flex h-8 w-8 items-center justify-center rounded-full",a.rejected?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.rejected?e.jsx(Ka,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.rejected?"":""})]})]})]})]})]}),e.jsx(nt,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Ki({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function lk({open:a,onOpenChange:l,chatList:r,onSuccess:c}){const[d,u]=m.useState({situation:"",style:"",chat_id:""}),[h,f]=m.useState(!1),{toast:p}=Ws(),g=async()=>{if(!d.situation||!d.style||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await Z1(d),p({title:"",description:""}),u({situation:"",style:"",chat_id:""}),c()}catch(b){p({title:"",description:b instanceof Error?b.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Fs,{open:a,onOpenChange:l,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"situation",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"situation",value:d.situation,onChange:b=>u({...d,situation:b.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"style",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"style",value:d.style,onChange:b=>u({...d,style:b.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Pe,{value:d.chat_id,onValueChange:b=>u({...d,chat_id:b}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:r.map(b=>e.jsx(W,{value:b.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[b.chat_name,b.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},b.chat_id))})]})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function nk({expression:a,open:l,onOpenChange:r,chatList:c,onSuccess:d}){const[u,h]=m.useState({}),[f,p]=m.useState(!1),{toast:g}=Ws();m.useEffect(()=>{a&&h({situation:a.situation,style:a.style,chat_id:a.chat_id,checked:a.checked,rejected:a.rejected})},[a]);const b=async()=>{if(a)try{p(!0),await W1(a.id,u),g({title:"",description:""}),d()}catch(j){g({title:"",description:j instanceof Error?j.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_situation",children:""}),e.jsx(ae,{id:"edit_situation",value:u.situation||"",onChange:j=>h({...u,situation:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_style",children:""}),e.jsx(ae,{id:"edit_style",value:u.style||"",onChange:j=>h({...u,style:j.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Pe,{value:u.chat_id||"",onValueChange:j=>h({...u,chat_id:j}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:c.map(j=>e.jsx(W,{value:j.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[j.chat_name,j.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},j.chat_id))})]})]}),e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx(ct,{className:"text-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:""})}),e.jsx("p",{children:" AI"}),e.jsx("p",{children:" "}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:['""',e.jsx("br",{})," ",e.jsx("br",{})," "]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_checked",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"edit_checked",checked:u.checked??!1,onCheckedChange:j=>h({...u,checked:j})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_rejected",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"edit_rejected",checked:u.rejected??!1,onCheckedChange:j=>h({...u,rejected:j})})]})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:b,disabled:f,children:f?"...":""})]})]})}):null}function rk({open:a,onOpenChange:l,onConfirm:r,count:c}){return e.jsx(gs,{open:a,onOpenChange:l,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",c," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:r,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})}const Il="/api/webui/jargon";async function ik(){const a=await _e(`${Il}/chats`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function ck(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id),a.is_jargon!==void 0&&a.is_jargon!==null&&l.append("is_jargon",a.is_jargon.toString()),a.is_global!==void 0&&l.append("is_global",a.is_global.toString());const r=await _e(`${Il}/list?${l}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function ok(a){const l=await _e(`${Il}/${a}`,{});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function dk(a){const l=await _e(`${Il}/`,{method:"POST",body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function uk(a,l){const r=await _e(`${Il}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function mk(a){const l=await _e(`${Il}/${a}`,{method:"DELETE"});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function xk(a){const l=await _e(`${Il}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function hk(){const a=await _e(`${Il}/stats/summary`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function fk(a,l){const r=new URLSearchParams;a.forEach(d=>r.append("ids",d.toString())),r.append("is_jargon",l.toString());const c=await _e(`${Il}/batch/set-jargon?${r}`,{method:"POST"});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return c.json()}function pk(){const[a,l]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[b,j]=m.useState(""),[y,N]=m.useState("all"),[w,M]=m.useState("all"),[A,S]=m.useState(null),[U,E]=m.useState(!1),[C,D]=m.useState(!1),[P,O]=m.useState(!1),[J,L]=m.useState(null),[oe,Ne]=m.useState(new Set),[je,de]=m.useState(!1),[he,ge]=m.useState(""),[R,Q]=m.useState({total:0,confirmed_jargon:0,confirmed_not_jargon:0,pending:0,global_count:0,complete_count:0,chat_count:0,top_chats:{}}),[$,ue]=m.useState([]),{toast:G}=Ws(),Se=async()=>{try{c(!0);const se=await ck({page:h,page_size:p,search:b||void 0,chat_id:y==="all"?void 0:y,is_jargon:w==="all"?void 0:w==="true"?!0:w==="false"?!1:void 0});l(se.data),u(se.total)}catch(se){G({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{c(!1)}},fe=async()=>{try{const se=await hk();se?.data&&Q(se.data)}catch(se){console.error(":",se)}},Te=async()=>{try{const se=await ik();se?.data&&ue(se.data)}catch(se){console.error(":",se)}};m.useEffect(()=>{Se(),fe(),Te()},[h,p,b,y,w]);const q=async se=>{try{const Ue=await ok(se.id);S(Ue.data),E(!0)}catch(Ue){G({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},B=se=>{S(se),D(!0)},z=async se=>{try{await mk(se.id),G({title:"",description:`: ${se.content}`}),L(null),Se(),fe()}catch(Ue){G({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},K=se=>{const Ue=new Set(oe);Ue.has(se)?Ue.delete(se):Ue.add(se),Ne(Ue)},Ae=()=>{oe.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(se=>se.id)))},ee=async()=>{try{await xk(Array.from(oe)),G({title:"",description:` ${oe.size} `}),Ne(new Set),de(!1),Se(),fe()}catch(se){G({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}},Y=async se=>{try{await fk(Array.from(oe),se),G({title:"",description:` ${oe.size} ${se?"":""}`}),Ne(new Set),Se(),fe()}catch(Ue){G({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},$e=()=>{const se=parseInt(he),Ue=Math.ceil(d/p);se>=1&&se<=Ue?(f(se),ge("")):G({title:"",description:`1-${Ue}`,variant:"destructive"})},H=se=>se===!0?e.jsxs(Ce,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Mt,{className:"h-3 w-3 mr-1"}),""]}):se===!1?e.jsxs(Ce,{variant:"secondary",children:[e.jsx(Aa,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(Ce,{variant:"outline",children:[e.jsx(tv,{className:"h-3 w-3 mr-1"}),""]});return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(R_,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs(_,{onClick:()=>O(!0),className:"gap-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),""]})]})}),e.jsx(Ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:R.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-green-600",children:R.confirmed_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-gray-500",children:R.confirmed_not_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-yellow-600",children:R.pending})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-blue-600",children:R.global_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-purple-600",children:R.complete_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:R.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(At,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{id:"search",placeholder:"...",value:b,onChange:se=>j(se.target.value),className:"pl-9"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:y,onValueChange:N,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),$.map(se=>e.jsx(W,{value:se.chat_id,children:se.chat_name},se.chat_id))]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:w,onValueChange:M,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"true",children:""}),e.jsx(W,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"page-size",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:se=>{g(parseInt(se)),f(1),Ne(new Set)},children:[e.jsx(Be,{id:"page-size",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]})]})]}),oe.size>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",oe.size," "]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Y(!0),children:[e.jsx(Mt,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Y(!1),children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>de(!0),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{className:"w-12",children:e.jsx(Js,{checked:oe.size===a.length&&a.length>0,onCheckedChange:Ae})}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{className:"text-center",children:""}),e.jsx(ss,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r?e.jsx(ht,{children:e.jsx(Ye,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(ht,{children:e.jsx(Ye,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(se=>e.jsxs(ht,{children:[e.jsx(Ye,{children:e.jsx(Js,{checked:oe.has(se.id),onCheckedChange:()=>K(se.id)})}),e.jsx(Ye,{className:"font-medium max-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[se.is_global&&e.jsx("span",{title:"",children:e.jsx(Vo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"})}),e.jsx("span",{className:"truncate",title:se.content,children:se.content})]})}),e.jsx(Ye,{className:"max-w-[200px] truncate",title:se.meaning||"",children:se.meaning||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ye,{className:"max-w-[150px] truncate",title:se.chat_name||se.chat_id,children:se.chat_name||se.chat_id}),e.jsx(Ye,{children:H(se.is_jargon)}),e.jsx(Ye,{className:"text-center",children:se.count}),e.jsx(Ye,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>B(se),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>q(se),title:"",children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>L(se),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})})]},se.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(se=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Js,{checked:oe.has(se.id),onCheckedChange:()=>K(se.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[se.is_global&&e.jsx(Vo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),e.jsx("h3",{className:"font-semibold text-sm break-all",children:se.content})]}),se.meaning&&e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:se.meaning}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[H(se.is_jargon),e.jsxs("span",{className:"text-muted-foreground",children:[": ",se.count]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[": ",se.chat_name||se.chat_id]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>B(se),className:"text-xs px-2 py-1 h-auto",children:[e.jsx(Jn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>q(se),className:"text-xs px-2 py-1 h-auto",children:e.jsx(ia,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>L(se),className:"text-xs px-2 py-1 h-auto text-destructive hover:text-destructive",children:[e.jsx(ls,{className:"h-3 w-3 mr-1"}),""]})]})]},se.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:he,onChange:se=>ge(se.target.value),onKeyDown:se=>se.key==="Enter"&&$e(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:$e,disabled:!he,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(gk,{jargon:A,open:U,onOpenChange:E}),e.jsx(jk,{open:P,onOpenChange:O,chatList:$,onSuccess:()=>{Se(),fe(),O(!1)}}),e.jsx(vk,{jargon:A,open:C,onOpenChange:D,chatList:$,onSuccess:()=>{Se(),fe(),D(!1)}}),e.jsx(gs,{open:!!J,onOpenChange:()=>L(null),children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',J?.content,'" ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>J&&z(J),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(gs,{open:je,onOpenChange:de,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",oe.size," "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:ee,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function gk({jargon:a,open:l,onOpenChange:r}){return a?e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsx(Ze,{className:"h-full pr-4",children:e.jsxs("div",{className:"space-y-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Vm,{icon:Jr,label:"ID",value:a.id.toString(),mono:!0}),e.jsx(Vm,{label:"",value:a.count.toString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all whitespace-pre-wrap",children:a.content})]}),a.raw_content&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:(()=>{try{const c=JSON.parse(a.raw_content);return Array.isArray(c)?c.map((d,u)=>e.jsxs("div",{children:[u>0&&e.jsx("hr",{className:"my-3 border-border"}),e.jsx("div",{className:"whitespace-pre-wrap",children:d})]},u)):e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}catch{return e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}})()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:a.meaning?e.jsx(px,{content:a.meaning}):"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Vm,{label:"",value:a.chat_name||a.chat_id}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.is_jargon===!0&&e.jsx(Ce,{variant:"default",className:"bg-green-600",children:""}),a.is_jargon===!1&&e.jsx(Ce,{variant:"secondary",children:""}),a.is_jargon===null&&e.jsx(Ce,{variant:"outline",children:""}),a.is_global&&e.jsx(Ce,{variant:"outline",className:"border-blue-500 text-blue-500",children:""}),a.is_complete&&e.jsx(Ce,{variant:"outline",className:"border-purple-500 text-purple-500",children:""})]})]})]}),a.inference_with_context&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_with_context})]}),a.inference_content_only&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_content_only})]})]})}),e.jsx(nt,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})}):null}function Vm({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function jk({open:a,onOpenChange:l,chatList:r,onSuccess:c}){const[d,u]=m.useState({content:"",meaning:"",chat_id:"",is_global:!1}),[h,f]=m.useState(!1),{toast:p}=Ws(),g=async()=>{if(!d.content||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await dk(d),p({title:"",description:""}),u({content:"",meaning:"",chat_id:"",is_global:!1}),c()}catch(b){p({title:"",description:b instanceof Error?b.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Fs,{open:a,onOpenChange:l,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"content",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ae,{id:"content",value:d.content,onChange:b=>u({...d,content:b.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"meaning",children:""}),e.jsx(rt,{id:"meaning",value:d.meaning||"",onChange:b=>u({...d,meaning:b.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Pe,{value:d.chat_id,onValueChange:b=>u({...d,chat_id:b}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:r.map(b=>e.jsx(W,{value:b.chat_id,children:b.chat_name},b.chat_id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"is_global",checked:d.is_global,onCheckedChange:b=>u({...d,is_global:b})}),e.jsx(T,{htmlFor:"is_global",children:""})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function vk({jargon:a,open:l,onOpenChange:r,chatList:c,onSuccess:d}){const[u,h]=m.useState({}),[f,p]=m.useState(!1),{toast:g}=Ws();m.useEffect(()=>{a&&h({content:a.content,meaning:a.meaning||"",chat_id:a.stream_id||a.chat_id,is_global:a.is_global,is_jargon:a.is_jargon})},[a]);const b=async()=>{if(a)try{p(!0),await uk(a.id,u),g({title:"",description:""}),d()}catch(j){g({title:"",description:j instanceof Error?j.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_content",children:""}),e.jsx(ae,{id:"edit_content",value:u.content||"",onChange:j=>h({...u,content:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_meaning",children:""}),e.jsx(rt,{id:"edit_meaning",value:u.meaning||"",onChange:j=>h({...u,meaning:j.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Pe,{value:u.chat_id||"",onValueChange:j=>h({...u,chat_id:j}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:c.map(j=>e.jsx(W,{value:j.chat_id,children:j.chat_name},j.chat_id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:u.is_jargon===null?"null":u.is_jargon?.toString()||"null",onValueChange:j=>h({...u,is_jargon:j==="null"?null:j==="true"}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"null",children:""}),e.jsx(W,{value:"true",children:""}),e.jsx(W,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"edit_is_global",checked:u.is_global,onCheckedChange:j=>h({...u,is_global:j})}),e.jsx(T,{htmlFor:"edit_is_global",children:""})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:b,disabled:f,children:f?"...":""})]})]})}):null}const si="/api/webui/person";async function Nk(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.is_known!==void 0&&l.append("is_known",a.is_known.toString()),a.platform&&l.append("platform",a.platform);const r=await _e(`${si}/list?${l}`,{headers:qs()});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function bk(a){const l=await _e(`${si}/${a}`,{headers:qs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function yk(a,l){const r=await _e(`${si}/${a}`,{method:"PATCH",headers:qs(),body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function wk(a){const l=await _e(`${si}/${a}`,{method:"DELETE",headers:qs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function _k(){const a=await _e(`${si}/stats/summary`,{headers:qs()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function Sk(a){const l=await _e(`${si}/batch/delete`,{method:"POST",headers:qs(),body:JSON.stringify({person_ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function kk(){const[a,l]=m.useState([]),[r,c]=m.useState(!0),[d,u]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[b,j]=m.useState(""),[y,N]=m.useState(void 0),[w,M]=m.useState(void 0),[A,S]=m.useState(null),[U,E]=m.useState(!1),[C,D]=m.useState(!1),[P,O]=m.useState(null),[J,L]=m.useState({total:0,known:0,unknown:0,platforms:{}}),[oe,Ne]=m.useState(new Set),[je,de]=m.useState(!1),[he,ge]=m.useState(""),{toast:R}=Ws(),Q=async()=>{try{c(!0);const ee=await Nk({page:h,page_size:p,search:b||void 0,is_known:y,platform:w});l(ee.data),u(ee.total)}catch(ee){R({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}finally{c(!1)}},$=async()=>{try{const ee=await _k();ee?.data&&L(ee.data)}catch(ee){console.error(":",ee)}};m.useEffect(()=>{Q(),$()},[h,p,b,y,w]);const ue=async ee=>{try{const Y=await bk(ee.person_id);S(Y.data),E(!0)}catch(Y){R({title:"",description:Y instanceof Error?Y.message:"",variant:"destructive"})}},G=ee=>{S(ee),D(!0)},Se=async ee=>{try{await wk(ee.person_id),R({title:"",description:`: ${ee.person_name||ee.nickname||ee.user_id}`}),O(null),Q(),$()}catch(Y){R({title:"",description:Y instanceof Error?Y.message:"",variant:"destructive"})}},fe=m.useMemo(()=>Object.keys(J.platforms),[J.platforms]),Te=ee=>{const Y=new Set(oe);Y.has(ee)?Y.delete(ee):Y.add(ee),Ne(Y)},q=()=>{oe.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(ee=>ee.person_id)))},B=()=>{if(oe.size===0){R({title:"",description:"",variant:"destructive"});return}de(!0)},z=async()=>{try{const ee=await Sk(Array.from(oe));R({title:"",description:ee.message}),Ne(new Set),de(!1),Q(),$()}catch(ee){R({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}},K=()=>{const ee=parseInt(he),Y=Math.ceil(d/p);ee>=1&&ee<=Y?(f(ee),ge("")):R({title:"",description:`1-${Y}`,variant:"destructive"})},Ae=ee=>ee?new Date(ee*1e3).toLocaleString("zh-CN"):"-";return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ic,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:J.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:J.known})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-muted-foreground",children:J.unknown})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative mt-1.5",children:[e.jsx(At,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{id:"search",placeholder:"ID...",value:b,onChange:ee=>j(ee.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-known",children:""}),e.jsxs(Pe,{value:y===void 0?"all":y.toString(),onValueChange:ee=>{N(ee==="all"?void 0:ee==="true"),f(1)},children:[e.jsx(Be,{id:"filter-known",className:"mt-1.5",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"true",children:""}),e.jsx(W,{value:"false",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-platform",children:""}),e.jsxs(Pe,{value:w||"all",onValueChange:ee=>{M(ee==="all"?void 0:ee),f(1)},children:[e.jsx(Be,{id:"filter-platform",className:"mt-1.5",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),fe.map(ee=>e.jsxs(W,{value:ee,children:[ee," (",J.platforms[ee],")"]},ee))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:oe.size>0&&e.jsxs("span",{children:[" ",oe.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:ee=>{g(parseInt(ee)),f(1),Ne(new Set)},children:[e.jsx(Be,{id:"page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),oe.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:B,children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{className:"w-12",children:e.jsx(Js,{checked:a.length>0&&oe.size===a.length,onCheckedChange:q,"aria-label":""})}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:"ID"}),e.jsx(ss,{children:""}),e.jsx(ss,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r?e.jsx(ht,{children:e.jsx(Ye,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(ht,{children:e.jsx(Ye,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(ee=>e.jsxs(ht,{children:[e.jsx(Ye,{children:e.jsx(Js,{checked:oe.has(ee.person_id),onCheckedChange:()=>Te(ee.person_id),"aria-label":` ${ee.person_name||ee.nickname||ee.user_id}`})}),e.jsx(Ye,{children:e.jsx("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",ee.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:ee.is_known?"":""})}),e.jsx(Ye,{className:"font-medium",children:ee.person_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ye,{children:ee.nickname||"-"}),e.jsx(Ye,{children:ee.platform}),e.jsx(Ye,{className:"font-mono text-sm",children:ee.user_id}),e.jsx(Ye,{className:"text-sm text-muted-foreground",children:Ae(ee.last_know)}),e.jsx(Ye,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>ue(ee),children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>G(ee),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>O(ee),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})})]},ee.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(ee=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Js,{checked:oe.has(ee.person_id),onCheckedChange:()=>Te(ee.person_id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium mb-2",ee.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:ee.is_known?"":""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-1 w-full break-all",children:ee.person_name||e.jsx("span",{className:"text-muted-foreground",children:""})}),ee.nickname&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1 w-full break-all",children:[": ",ee.nickname]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"font-medium text-xs",children:ee.platform})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ID"}),e.jsx("p",{className:"font-mono text-xs truncate",title:ee.user_id,children:ee.user_id})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-xs",children:Ae(ee.last_know)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>ue(ee),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(ia,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>G(ee),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Jn,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>O(ee),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ls,{className:"h-3 w-3 mr-1"}),""]})]})]},ee.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Da,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{type:"number",value:he,onChange:ee=>ge(ee.target.value),onKeyDown:ee=>ee.key==="Enter"&&K(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:K,disabled:!he,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(Ck,{person:A,open:U,onOpenChange:E}),e.jsx(Tk,{person:A,open:C,onOpenChange:D,onSuccess:()=>{Q(),$(),D(!1)}}),e.jsx(gs,{open:!!P,onOpenChange:()=>O(null),children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[' "',P?.person_name||P?.nickname||P?.user_id,'"  ']})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:()=>P&&Se(P),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(gs,{open:je,onOpenChange:de,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:[" ",oe.size,"  "]})]}),e.jsxs(ds,{children:[e.jsx(hs,{children:""}),e.jsx(xs,{onClick:z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function Ck({person:a,open:l,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsxs(Xs,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Rl,{icon:jn,label:"",value:a.person_name}),e.jsx(Rl,{icon:Ra,label:"",value:a.nickname}),e.jsx(Rl,{icon:Jr,label:"ID",value:a.user_id,mono:!0}),e.jsx(Rl,{icon:Jr,label:"ID",value:a.person_id,mono:!0}),e.jsx(Rl,{label:"",value:a.platform}),e.jsx(Rl,{label:"",value:a.is_known?"":""})]}),a.name_reason&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm",children:a.name_reason})]}),a.memory_points&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:a.memory_points})]}),a.group_nick_name&&a.group_nick_name.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:a.group_nick_name.map((d,u)=>e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:d.group_id}),e.jsx("span",{children:""}),e.jsx("span",{children:d.group_nick_name})]},u))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Rl,{icon:na,label:"",value:c(a.know_times)}),e.jsx(Rl,{icon:na,label:"",value:c(a.know_since)}),e.jsx(Rl,{icon:na,label:"",value:c(a.last_know)})]})]}),e.jsx(nt,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Rl({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function Tk({person:a,open:l,onOpenChange:r,onSuccess:c}){const[d,u]=m.useState({}),[h,f]=m.useState(!1),{toast:p}=Ws();m.useEffect(()=>{a&&u({person_name:a.person_name||"",name_reason:a.name_reason||"",nickname:a.nickname||"",is_known:a.is_known})},[a]);const g=async()=>{if(a)try{f(!0),await yk(a.person_id,d),p({title:"",description:""}),c()}catch(b){p({title:"",description:b instanceof Error?b.message:"",variant:"destructive"})}finally{f(!1)}};return a?e.jsx(Fs,{open:l,onOpenChange:r,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsxs(Xs,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"person_name",children:""}),e.jsx(ae,{id:"person_name",value:d.person_name||"",onChange:b=>u({...d,person_name:b.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ae,{id:"nickname",value:d.nickname||"",onChange:b=>u({...d,nickname:b.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"name_reason",children:""}),e.jsx(rt,{id:"name_reason",value:d.name_reason||"",onChange:b=>u({...d,name_reason:b.target.value}),placeholder:"",rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"is_known",className:"text-base font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"is_known",checked:d.is_known,onCheckedChange:b=>u({...d,is_known:b})})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})}):null}var Ek=j1();const Jg=lw(Ek),_x="/api/webui";async function Mk(a=100,l="all"){const r=`${_x}/knowledge/graph?limit=${a}&node_type=${l}`,c=await fetch(r);if(!c.ok)throw new Error(`: ${c.status}`);return c.json()}async function Ak(){const a=await fetch(`${_x}/knowledge/stats`);if(!a.ok)throw new Error("");return a.json()}async function zk(a){const l=await fetch(`${_x}/knowledge/search?query=${encodeURIComponent(a)}`);if(!l.ok)throw new Error("");return l.json()}const sN=m.memo(({data:a})=>e.jsxs("div",{className:"px-4 py-2 shadow-md rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700 min-w-[120px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-semibold text-white text-sm truncate max-w-[200px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));sN.displayName="EntityNode";const tN=m.memo(({data:a})=>e.jsxs("div",{className:"px-3 py-2 shadow-md rounded-md bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700 min-w-[100px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-medium text-white text-xs truncate max-w-[150px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));tN.displayName="ParagraphNode";const Rk={entity:sN,paragraph:tN};function Dk(a,l){const r=new Jg.graphlib.Graph;r.setDefaultEdgeLabel(()=>({})),r.setGraph({rankdir:"TB",ranksep:100,nodesep:80});const c=[],d=[];return a.forEach(u=>{r.setNode(u.id,{width:150,height:50})}),l.forEach(u=>{r.setEdge(u.source,u.target)}),Jg.layout(r),a.forEach(u=>{const h=r.node(u.id);c.push({id:u.id,type:u.type,position:{x:h.x-75,y:h.y-25},data:{label:u.content.slice(0,20)+(u.content.length>20?"...":""),content:u.content}})}),l.forEach((u,h)=>{const f={id:`edge-${h}`,source:u.source,target:u.target,animated:a.length<=200&&u.weight>5,style:{strokeWidth:Math.min(u.weight/2,5),opacity:.6}};u.weight>10&&a.length<100&&(f.label=`${u.weight.toFixed(0)}`),d.push(f)}),{nodes:c,edges:d}}function Ok(){const a=ca(),[l,r]=m.useState(!1),[c,d]=m.useState(null),[u,h]=m.useState(""),[f,p]=m.useState("all"),[g,b]=m.useState(50),[j,y]=m.useState("50"),[N,w]=m.useState(!1),[M,A]=m.useState(!0),[S,U]=m.useState(!1),[E,C]=m.useState(!1),[D,P,O]=v1([]),[J,L,oe]=N1([]),[Ne,je]=m.useState(0),[de,he]=m.useState(null),[ge,R]=m.useState(null),{toast:Q}=Ws(),$=m.useCallback(z=>z.type==="entity"?"#6366f1":z.type==="paragraph"?"#10b981":"#6b7280",[]),ue=m.useCallback(async(z=!1)=>{try{if(!z&&g>200){C(!0);return}r(!0);const[K,Ae]=await Promise.all([Mk(g,f),Ak()]);if(d(Ae),K.nodes.length===0){Q({title:"",description:""}),P([]),L([]);return}const{nodes:ee,edges:Y}=Dk(K.nodes,K.edges);P(ee),L(Y),je(ee.length),Ae&&Ae.total_nodes>g&&Q({title:"",description:` ${Ae.total_nodes}  ${ee.length} `}),Q({title:"",description:` ${ee.length} ${Y.length} `})}catch(K){console.error(":",K),Q({title:"",description:K instanceof Error?K.message:"",variant:"destructive"})}finally{r(!1)}},[g,f,Q]),G=m.useCallback(async()=>{if(!u.trim()){Q({title:"",description:""});return}try{const z=await zk(u);if(z.length===0){Q({title:"",description:""});return}const K=new Set(z.map(Ae=>Ae.id));P(Ae=>Ae.map(ee=>({...ee,style:{...ee.style,opacity:K.has(ee.id)?1:.3,filter:K.has(ee.id)?"brightness(1.2)":"brightness(0.8)"}}))),Q({title:"",description:` ${z.length} `})}catch(z){console.error(":",z),Q({title:"",description:z instanceof Error?z.message:"",variant:"destructive"})}},[u,Q]),Se=m.useCallback(()=>{P(z=>z.map(K=>({...K,style:{...K.style,opacity:1,filter:"brightness(1)"}})))},[]),fe=m.useCallback(()=>{A(!1),U(!0),ue()},[ue]),Te=m.useCallback(()=>{C(!1),setTimeout(()=>{ue(!0)},0)},[ue]),q=m.useCallback((z,K)=>{D.find(ee=>ee.id===K.id)&&he({id:K.id,type:K.type,content:K.data.content})},[D]);m.useEffect(()=>{M||S&&ue()},[g,f,M,S]);const B=m.useCallback((z,K)=>{const Ae=D.find($e=>$e.id===K.source),ee=D.find($e=>$e.id===K.target),Y=J.find($e=>$e.id===K.id);Ae&&ee&&Y&&R({source:{id:Ae.id,type:Ae.type,content:Ae.data.content},target:{id:ee.id,type:ee.type,content:ee.data.content},edge:{source:K.source,target:K.target,weight:parseFloat(K.label||"0")}})},[D,J]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b bg-background",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1",children:""})]}),c&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(Ce,{variant:"outline",className:"gap-1",children:[e.jsx(Yr,{className:"h-3 w-3"}),": ",c.total_nodes]}),e.jsxs(Ce,{variant:"outline",className:"gap-1",children:[e.jsx(iv,{className:"h-3 w-3"}),": ",c.total_edges]}),e.jsxs(Ce,{variant:"outline",className:"gap-1",children:[e.jsx(Vt,{className:"h-3 w-3"}),": ",c.entity_nodes]}),e.jsxs(Ce,{variant:"outline",className:"gap-1",children:[e.jsx(Ea,{className:"h-3 w-3"}),": ",c.paragraph_nodes]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(ae,{placeholder:"...",value:u,onChange:z=>h(z.target.value),onKeyDown:z=>z.key==="Enter"&&G(),className:"flex-1"}),e.jsx(_,{onClick:G,size:"sm",children:e.jsx(At,{className:"h-4 w-4"})}),e.jsx(_,{onClick:Se,variant:"outline",size:"sm",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Pe,{value:f,onValueChange:z=>p(z),children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"entity",children:""}),e.jsx(W,{value:"paragraph",children:""})]})]}),e.jsxs(Pe,{value:g===1e4?"all":N?"custom":g.toString(),onValueChange:z=>{z==="custom"?(w(!0),y(g.toString())):z==="all"?(w(!1),b(1e4)):(w(!1),b(Number(z)))},children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"50",children:"50 "}),e.jsx(W,{value:"100",children:"100 "}),e.jsx(W,{value:"200",children:"200 "}),e.jsx(W,{value:"500",children:"500 "}),e.jsx(W,{value:"1000",children:"1000 "}),e.jsx(W,{value:"all",children:" (10000)"}),e.jsx(W,{value:"custom",children:"..."})]})]}),N&&e.jsx(ae,{type:"number",min:"50",value:j,onChange:z=>y(z.target.value),onBlur:()=>{const z=parseInt(j);!isNaN(z)&&z>=50?b(z):(y("50"),b(50))},onKeyDown:z=>{if(z.key==="Enter"){const K=parseInt(j);!isNaN(K)&&K>=50?b(K):(y("50"),b(50))}},placeholder:"50",className:"w-[120px]"}),e.jsx(_,{onClick:()=>ue(),variant:"outline",size:"sm",disabled:l,children:e.jsx(xt,{className:F("h-4 w-4",l&&"animate-spin")})})]})]})]}),e.jsx("div",{className:"flex-1 relative",children:l?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xt,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):D.length===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Yr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]})}):e.jsxs(b1,{nodes:D,edges:J,onNodesChange:O,onEdgesChange:oe,onNodeClick:q,onEdgeClick:B,nodeTypes:Rk,fitView:!0,minZoom:.05,maxZoom:1.5,defaultViewport:{x:0,y:0,zoom:.5},elevateNodesOnSelect:Ne<=500,nodesDraggable:Ne<=1e3,attributionPosition:"bottom-left",children:[e.jsx(y1,{variant:w1.Dots,gap:12,size:1}),e.jsx(_1,{}),Ne<=500&&e.jsx(S1,{nodeColor:$,nodeBorderRadius:8,pannable:!0,zoomable:!0}),e.jsxs(k1,{position:"top-right",className:"bg-background/95 backdrop-blur-sm rounded-lg border p-3 shadow-lg",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:""}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700"}),e.jsx("span",{children:""})]}),Ne>200&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-yellow-600 dark:text-yellow-500",children:[e.jsx("div",{className:"font-semibold",children:""}),e.jsx("div",{children:""}),Ne>500&&e.jsx("div",{children:""})]})]})]})]})}),e.jsx(Fs,{open:!!de,onOpenChange:z=>!z&&he(null),children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx($s,{children:e.jsx(Bs,{children:""})}),de&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(Ce,{variant:de.type==="entity"?"default":"secondary",children:de.type==="entity"?" ":" "})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ID"}),e.jsx("code",{className:"mt-1 block p-2 bg-muted rounded text-xs break-all",children:de.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx(Ze,{className:"mt-1 h-40 p-3 bg-muted rounded",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:de.content})})]})]})]})}),e.jsx(Fs,{open:!!ge,onOpenChange:z=>!z&&R(null),children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx($s,{children:e.jsx(Bs,{children:""})}),ge&&e.jsx(Ze,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-blue-50 dark:bg-blue-950 rounded border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:ge.source.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[ge.source.id.slice(0,40),"..."]})]}),e.jsx("div",{className:"text-2xl text-muted-foreground flex-shrink-0",children:""}),e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-green-50 dark:bg-green-950 rounded border-2 border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:ge.target.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[ge.target.id.slice(0,40),"..."]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(Ce,{variant:"outline",className:"text-base font-mono",children:ge.edge.weight.toFixed(4)})})]})]})})]})}),e.jsx(gs,{open:M,onOpenChange:A,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:""}),e.jsxs(ms,{children:["",e.jsx("br",{}),"?"]})]}),e.jsxs(ds,{children:[e.jsx(hs,{onClick:()=>a({to:"/"}),children:" ()"}),e.jsx(xs,{onClick:fe,children:""})]})]})}),e.jsx(gs,{open:E,onOpenChange:C,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(us,{children:" "}),e.jsx(ms,{asChild:!0,children:e.jsxs("div",{children:[e.jsxs("p",{children:[" ",e.jsx("strong",{className:"text-orange-600",children:g>=1e4?" (10000)":g})," "]}),e.jsx("p",{className:"mt-4",children:":"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"mt-4",children:" (50-200 )"})]})})]}),e.jsxs(ds,{children:[e.jsx(hs,{onClick:()=>{C(!1),g>200&&(b(50),w(!1))},children:""}),e.jsx(xs,{onClick:Te,className:"bg-orange-600 hover:bg-orange-700",children:""})]})]})})]})}function Lk(){return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-none border-b bg-card/50 px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:""})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"mx-auto max-w-4xl",children:e.jsxs(ke,{children:[e.jsxs(Re,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Yr,{className:"h-10 w-10 text-primary"})}),e.jsx(De,{className:"text-2xl",children:""}),e.jsx(is,{className:"text-base",children:""})]}),e.jsx(Me,{className:"text-center text-sm text-muted-foreground",children:e.jsx("p",{children:""})})]})})})]})}function Xg({className:a,classNames:l,showOutsideDays:r=!0,captionLayout:c="label",buttonVariant:d="ghost",formatters:u,components:h,...f}){const p=wv();return e.jsx(u1,{showOutsideDays:r,className:F("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,a),captionLayout:c,formatters:{formatMonthDropdown:g=>g.toLocaleString("default",{month:"short"}),...u},classNames:{root:F("w-fit",p.root),months:F("relative flex flex-col gap-4 md:flex-row",p.months),month:F("flex w-full flex-col gap-4",p.month),nav:F("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",p.nav),button_previous:F(Zr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_previous),button_next:F(Zr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_next),month_caption:F("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",p.month_caption),dropdowns:F("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",p.dropdowns),dropdown_root:F("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",p.dropdown_root),dropdown:F("bg-popover absolute inset-0 opacity-0",p.dropdown),caption_label:F("select-none font-medium",c==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",p.caption_label),table:"w-full border-collapse",weekdays:F("flex",p.weekdays),weekday:F("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",p.weekday),week:F("mt-2 flex w-full",p.week),week_number_header:F("w-[--cell-size] select-none",p.week_number_header),week_number:F("text-muted-foreground select-none text-[0.8rem]",p.week_number),day:F("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",p.day),range_start:F("bg-accent rounded-l-md",p.range_start),range_middle:F("rounded-none",p.range_middle),range_end:F("bg-accent rounded-r-md",p.range_end),today:F("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",p.today),outside:F("text-muted-foreground aria-selected:text-muted-foreground",p.outside),disabled:F("text-muted-foreground opacity-50",p.disabled),hidden:F("invisible",p.hidden),...l},components:{Root:({className:g,rootRef:b,...j})=>e.jsx("div",{"data-slot":"calendar",ref:b,className:F(g),...j}),Chevron:({className:g,orientation:b,...j})=>b==="left"?e.jsx(Da,{className:F("size-4",g),...j}):b==="right"?e.jsx(sa,{className:F("size-4",g),...j}):e.jsx(za,{className:F("size-4",g),...j}),DayButton:Uk,WeekNumber:({children:g,...b})=>e.jsx("td",{...b,children:e.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:g})}),...h},...f})}function Uk({className:a,day:l,modifiers:r,...c}){const d=wv(),u=m.useRef(null);return m.useEffect(()=>{r.focused&&u.current?.focus()},[r.focused]),e.jsx(_,{ref:u,variant:"ghost",size:"icon","data-day":l.date.toLocaleDateString(),"data-selected-single":r.selected&&!r.range_start&&!r.range_end&&!r.range_middle,"data-range-start":r.range_start,"data-range-end":r.range_end,"data-range-middle":r.range_middle,className:F("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",d.day,a),...c})}const Oo={xs:{label:"",rowHeight:28,class:"text-[10px] sm:text-xs"},sm:{label:"",rowHeight:36,class:"text-xs sm:text-sm"},base:{label:"",rowHeight:44,class:"text-sm sm:text-base"}};function $k(){const[a,l]=m.useState([]),[r,c]=m.useState(""),[d,u]=m.useState("all"),[h,f]=m.useState("all"),[p,g]=m.useState(void 0),[b,j]=m.useState(void 0),[y,N]=m.useState(!0),[w,M]=m.useState(!1),[A,S]=m.useState("xs"),[U,E]=m.useState(4),[C,D]=m.useState(!1),P=m.useRef(null);m.useEffect(()=>{const G=Hn.getAllLogs();l(G);const Se=Hn.onLog(()=>{l(Hn.getAllLogs())}),fe=Hn.onConnectionChange(Te=>{M(Te)});return()=>{Se(),fe()}},[]);const O=m.useMemo(()=>{const G=new Set(a.map(Se=>Se.module).filter(Se=>Se&&Se.trim()!==""));return Array.from(G).sort()},[a]),J=G=>{switch(G){case"DEBUG":return"text-muted-foreground";case"INFO":return"text-blue-500 dark:text-blue-400";case"WARNING":return"text-yellow-600 dark:text-yellow-500";case"ERROR":return"text-red-600 dark:text-red-500";case"CRITICAL":return"text-red-700 dark:text-red-400 font-bold";default:return"text-foreground"}},L=G=>{switch(G){case"DEBUG":return"bg-gray-800/30 dark:bg-gray-800/50";case"INFO":return"bg-blue-900/20 dark:bg-blue-500/20";case"WARNING":return"bg-yellow-900/20 dark:bg-yellow-500/20";case"ERROR":return"bg-red-900/20 dark:bg-red-500/20";case"CRITICAL":return"bg-red-900/30 dark:bg-red-600/30";default:return"bg-gray-800/20 dark:bg-gray-800/30"}},oe=()=>{window.location.reload()},Ne=()=>{Hn.clearLogs(),l([])},je=()=>{const G=ge.map(q=>`${q.timestamp} [${q.level.padEnd(8)}] [${q.module}] ${q.message}`).join(`
`),Se=new Blob([G],{type:"text/plain;charset=utf-8"}),fe=URL.createObjectURL(Se),Te=document.createElement("a");Te.href=fe,Te.download=`logs-${Tm(new Date,"yyyy-MM-dd-HHmmss")}.txt`,Te.click(),URL.revokeObjectURL(fe)},de=()=>{N(!y)},he=()=>{g(void 0),j(void 0)},ge=m.useMemo(()=>a.filter(G=>{const Se=r===""||G.message.toLowerCase().includes(r.toLowerCase())||G.module.toLowerCase().includes(r.toLowerCase()),fe=d==="all"||G.level===d,Te=h==="all"||G.module===h;let q=!0;if(p||b){const B=new Date(G.timestamp);if(p){const z=new Date(p);z.setHours(0,0,0,0),q=q&&B>=z}if(b){const z=new Date(b);z.setHours(23,59,59,999),q=q&&B<=z}}return Se&&fe&&Te&&q}),[a,r,d,h,p,b]),R=Oo[A].rowHeight+U,Q=Y0({count:ge.length,getScrollElement:()=>P.current,estimateSize:()=>R,overscan:50}),$=m.useRef(!1),ue=m.useRef(ge.length);return m.useEffect(()=>{const G=P.current;if(!G)return;const Se=()=>{if($.current)return;const{scrollTop:fe,scrollHeight:Te,clientHeight:q}=G,B=Te-fe-q;B>100&&y?N(!1):B<50&&!y&&N(!0)};return G.addEventListener("scroll",Se,{passive:!0}),()=>G.removeEventListener("scroll",Se)},[y]),m.useEffect(()=>{const G=ge.length>ue.current;ue.current=ge.length,y&&ge.length>0&&G&&($.current=!0,Q.scrollToIndex(ge.length-1,{align:"end",behavior:"auto"}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{$.current=!1})}))},[ge.length,y,Q]),e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 space-y-2 sm:space-y-3 p-2 sm:p-3 lg:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 hidden sm:block",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("h-2 w-2 sm:h-2.5 sm:w-2.5 rounded-full",w?"bg-green-500 animate-pulse":"bg-red-500")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:w?"":""})]})]}),e.jsx(ke,{className:"p-2 sm:p-3",children:e.jsx(uc,{open:C,onOpenChange:D,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(At,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:r,onChange:G=>c(G.target.value),className:"pl-8 h-8 text-xs sm:text-sm"})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:y?"default":"outline",size:"sm",onClick:de,className:"h-8 px-2",title:y?"":"",children:[y?e.jsx(D_,{className:"h-3.5 w-3.5"}):e.jsx(O_,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden sm:inline",children:y?"":""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:Ne,className:"h-8 px-2",title:"",children:[e.jsx(ls,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden md:inline",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"h-8 px-2 hidden sm:flex",title:"",children:[e.jsx(Wt,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden lg:inline",children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"h-8 px-2",title:C?"":"",children:[e.jsx(Bo,{className:"h-3.5 w-3.5"}),C?e.jsx(Qr,{className:"h-3.5 w-3.5 ml-1"}):e.jsx(za,{className:"h-3.5 w-3.5 ml-1"})]})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center sm:text-right -mt-1",children:[e.jsxs("span",{className:"font-mono",children:[ge.length," / ",a.length]}),e.jsx("span",{className:"ml-1",children:""})]}),e.jsxs(xc,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(Pe,{value:d,onValueChange:u,children:[e.jsxs(Be,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Fe,{placeholder:""})]}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"DEBUG",children:"DEBUG"}),e.jsx(W,{value:"INFO",children:"INFO"}),e.jsx(W,{value:"WARNING",children:"WARNING"}),e.jsx(W,{value:"ERROR",children:"ERROR"}),e.jsx(W,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsxs(Pe,{value:h,onValueChange:f,children:[e.jsxs(Be,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Fe,{placeholder:""})]}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),O.map(G=>e.jsx(W,{value:G,children:G},G))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:F("w-full sm:flex-1 justify-start text-left font-normal h-8",!p&&"text-muted-foreground"),children:[e.jsx(Go,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:p?Tm(p,"PP",{locale:Ro}):""})]})}),e.jsx(sl,{className:"w-auto p-0",align:"start",children:e.jsx(Xg,{mode:"single",selected:p,onSelect:g,initialFocus:!0,locale:Ro})})]}),e.jsxs(ul,{children:[e.jsx(ml,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:F("w-full sm:flex-1 justify-start text-left font-normal h-8",!b&&"text-muted-foreground"),children:[e.jsx(Go,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:b?Tm(b,"PP",{locale:Ro}):""})]})}),e.jsx(sl,{className:"w-auto p-0",align:"start",children:e.jsx(Xg,{mode:"single",selected:b,onSelect:j,initialFocus:!0,locale:Ro})})]}),(p||b)&&e.jsxs(_,{variant:"outline",size:"sm",onClick:he,className:"w-full sm:w-auto h-8",children:[e.jsx(Aa,{className:"h-3.5 w-3.5 sm:mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3 pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(L_,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:""})]}),e.jsx("div",{className:"flex gap-1",children:Object.keys(Oo).map(G=>e.jsx(_,{variant:A===G?"default":"outline",size:"sm",onClick:()=>S(G),className:"h-6 px-2 text-xs",children:Oo[G].label},G))})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:""}),e.jsx(Qa,{value:[U],onValueChange:([G])=>E(G),min:0,max:12,step:2,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-7",children:[U,"px"]})]}),e.jsxs("div",{className:"flex gap-2 sm:hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:oe,className:"flex-1 h-8",children:[e.jsx(xt,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"flex-1 h-8",children:[e.jsx(Wt,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]})]})]})]})})})]}),e.jsx("div",{className:"flex-1 min-h-0 px-2 sm:px-3 lg:px-4 pb-2 sm:pb-3 lg:pb-4",children:e.jsx(ke,{className:"bg-black dark:bg-gray-950 border-gray-800 dark:border-gray-900 h-full overflow-hidden",children:e.jsx("div",{ref:P,className:F("h-full overflow-auto","[&::-webkit-scrollbar]:w-2.5","[&::-webkit-scrollbar-track]:bg-transparent","[&::-webkit-scrollbar-thumb]:bg-border [&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-thumb:hover]:bg-border/80"),children:e.jsx("div",{className:F("p-2 sm:p-3 font-mono relative",Oo[A].class),style:{height:`${Q.getTotalSize()}px`},children:ge.length===0?e.jsx("div",{className:"text-gray-500 dark:text-gray-600 text-center py-8 text-xs sm:text-sm",children:""}):Q.getVirtualItems().map(G=>{const Se=ge[G.index];return e.jsxs("div",{"data-index":G.index,ref:Q.measureElement,className:F("absolute top-0 left-0 w-full px-2 sm:px-3 rounded hover:bg-white/5 transition-colors",L(Se.level)),style:{transform:`translateY(${G.start}px)`,paddingTop:`${U/2}px`,paddingBottom:`${U/2}px`},children:[e.jsxs("div",{className:"flex flex-col gap-0.5 sm:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 text-[10px]",children:Se.timestamp}),e.jsxs("span",{className:F("font-semibold text-[10px]",J(Se.level)),children:["[",Se.level,"]"]})]}),e.jsx("div",{className:"text-cyan-400 dark:text-cyan-500 truncate text-[10px]",children:Se.module}),e.jsx("div",{className:"text-gray-300 dark:text-gray-400 whitespace-pre-wrap break-words text-[10px]",children:Se.message})]}),e.jsxs("div",{className:"hidden sm:flex gap-2 items-start",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 flex-shrink-0 w-[130px] lg:w-[160px]",children:Se.timestamp}),e.jsxs("span",{className:F("flex-shrink-0 w-[65px] lg:w-[75px] font-semibold",J(Se.level)),children:["[",Se.level,"]"]}),e.jsx("span",{className:"text-cyan-400 dark:text-cyan-500 flex-shrink-0 w-[100px] lg:w-[130px] truncate",children:Se.module}),e.jsx("span",{className:"text-gray-300 dark:text-gray-400 flex-1 whitespace-pre-wrap break-words",children:Se.message})]})]},G.key)})})})})})]})}async function Bk(){return(await _e("/api/planner/overview")).json()}async function Ik(a,l=1,r=20,c){const d=new URLSearchParams({page:l.toString(),page_size:r.toString()});return c&&d.append("search",c),(await _e(`/api/planner/chat/${a}/logs?${d}`)).json()}async function Pk(a,l){return(await _e(`/api/planner/log/${a}/${l}`)).json()}async function Fk(){return(await _e("/api/replier/overview")).json()}async function Hk(a,l=1,r=20,c){const d=new URLSearchParams({page:l.toString(),page_size:r.toString()});return c&&d.append("search",c),(await _e(`/api/replier/chat/${a}/logs?${d}`)).json()}async function Vk(a,l){return(await _e(`/api/replier/log/${a}/${l}`)).json()}function aN(){const[a,l]=m.useState(new Map),[r,c]=m.useState(!0),d=m.useCallback(async()=>{try{c(!0);const h=await mx();if(h?.data){const f=new Map;h.data.forEach(p=>{f.set(p.chat_id,p.chat_name)}),l(f)}}catch(h){console.error(":",h)}finally{c(!1)}},[]);m.useEffect(()=>{d()},[d]);const u=m.useCallback(h=>a.get(h)||h,[a]);return{chatNameMap:a,getChatName:u,loading:r,reload:d}}function Jo(a){return new Date(a*1e3).toLocaleString("zh-CN")}function lN(a){const r=Date.now()/1e3-a;return r<60?"":r<3600?`${Math.floor(r/60)} `:r<86400?`${Math.floor(r/3600)} `:`${Math.floor(r/86400)} `}function nN(a,l,r=1e4){m.useEffect(()=>{if(!a)return;const c=setInterval(l,r);return()=>clearInterval(c)},[a,l,r])}function Gk({autoRefresh:a,refreshKey:l}){const[r,c]=m.useState("overview"),[d,u]=m.useState(null),{getChatName:h}=aN(),[f,p]=m.useState(null),[g,b]=m.useState(!0),[j,y]=m.useState(null),[N,w]=m.useState(!1),[M,A]=m.useState(1),[S,U]=m.useState(20),[E,C]=m.useState(""),[D,P]=m.useState(""),[O,J]=m.useState(""),[L,oe]=m.useState(null),[Ne,je]=m.useState(!1),[de,he]=m.useState(!1),ge=m.useCallback(async()=>{try{b(!0);const B=await Bk();p(B)}catch(B){console.error(":",B)}finally{b(!1)}},[]),R=m.useCallback(async()=>{if(d)try{w(!0);const B=await Ik(d.chat_id,M,S,D||void 0);y(B)}catch(B){console.error(":",B)}finally{w(!1)}},[d,M,S,D]);m.useEffect(()=>{ge()},[ge]),m.useEffect(()=>{l>0&&(r==="overview"?ge():R())},[l,r,ge,R]),m.useEffect(()=>{r==="chat-logs"&&d&&R()},[r,d,R]),nN(a,m.useCallback(()=>{r==="overview"?ge():R()},[r,ge,R]));const Q=B=>{u(B),A(1),P(""),J(""),c("chat-logs")},$=()=>{c("overview"),u(null),y(null),P(""),J("")},ue=()=>{P(O),A(1)},G=()=>{J(""),P(""),A(1)},Se=async(B,z)=>{try{he(!0),je(!0);const K=await Pk(B,z);oe(K)}catch(K){console.error(":",K)}finally{he(!1)}},fe=B=>{U(Number(B)),A(1)},Te=()=>{const B=parseInt(E),z=j?Math.ceil(j.total/j.page_size):0;!isNaN(B)&&B>=1&&B<=z&&(A(B),C(""))},q=j?Math.ceil(j.total/j.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(ws,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(ax,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(ws,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_plans||0})})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((B,z)=>e.jsx(ws,{className:"h-24 w-full"},z))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(B=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Q(B),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(B.chat_id),children:h(B.chat_id)})]}),e.jsx(Ce,{variant:"secondary",children:B.plan_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",lN(B.latest_timestamp)]})]},B.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:$,children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",j?.total||0," "]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(De,{children:""}),e.jsx(is,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{placeholder:"...",value:O,onChange:B=>J(B.target.value),onKeyDown:B=>B.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(At,{className:"h-4 w-4"})}),D&&e.jsx(_,{variant:"ghost",size:"sm",onClick:G,children:""})]}),e.jsxs(Pe,{value:S.toString(),onValueChange:fe,children:[e.jsx(Be,{className:"w-full sm:w-32",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"10",children:"10/"}),e.jsx(W,{value:"20",children:"20/"}),e.jsx(W,{value:"50",children:"50/"}),e.jsx(W,{value:"100",children:"100/"})]})]})]})]}),D&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',D,'"']})]})]}),e.jsx(Me,{children:N?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((B,z)=>e.jsx(ws,{className:"h-20 w-full"},z))}):j?.data&&j.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:j.data.map(B=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Se(B.chat_id,B.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo(B.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(Ce,{variant:"secondary",className:"text-xs",children:[B.action_count," "]}),e.jsxs(Ce,{variant:"outline",className:"text-xs",children:[B.total_plan_ms.toFixed(0),"ms"]})]})]}),B.action_types&&B.action_types.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:B.action_types.map((z,K)=>e.jsx(Ce,{variant:"outline",className:"text-xs bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800",children:z},K))}),e.jsx("p",{className:"text-sm line-clamp-2",children:B.reasoning_preview||""})]},B.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",j.total,"  ",M," / ",q," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(1),disabled:M===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(B=>Math.max(1,B-1)),disabled:M===1,children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(ae,{type:"number",min:1,max:q,value:E,onChange:B=>C(B.target.value),onKeyDown:B=>B.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[M,"/",q]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(B=>Math.min(q,B+1)),disabled:M===q,children:e.jsx(sa,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(q),disabled:M===q,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Fs,{open:Ne,onOpenChange:je,children:e.jsxs(Us,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),""]}),e.jsx(Xs,{children:""})]}),e.jsx(Ze,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:de?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((B,z)=>e.jsx(ws,{className:"h-24 w-full"},z))}):L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:L.chat_id,children:h(L.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(L.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx(Ce,{variant:"outline",children:L.type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(Ce,{children:[L.actions.length," "]})]})]})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(ke,{children:[e.jsx(Re,{className:"p-4 pb-2",children:e.jsx(De,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.prompt_build_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(ke,{children:[e.jsx(Re,{className:"p-4 pb-2",children:e.jsx(De,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.llm_duration_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(ke,{children:[e.jsx(Re,{className:"p-4 pb-2",children:e.jsx(De,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.total_plan_ms?.toFixed(2)||0,"ms"]})})]})]})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ox,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.reasoning||""})})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(U_,{className:"h-4 w-4"})," (",L.actions.length,")"]}),e.jsx("div",{className:"space-y-3",children:L.actions.map((B,z)=>e.jsxs(ke,{children:[e.jsx(Re,{className:"p-4 pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ce,{variant:"default",children:[" ",z+1]}),e.jsx(Ce,{variant:"outline",children:B.action_type})]})})}),e.jsxs(Me,{className:"p-4 pt-0 space-y-3",children:[B.reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof B.reasoning=="string"?B.reasoning:JSON.stringify(B.reasoning)})]}),B.action_message&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),typeof B.action_message=="string"?e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded break-all whitespace-pre-wrap",children:B.action_message}):e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify(B.action_message,null,2)})]}),B.action_data&&Object.keys(B.action_data).length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto",children:JSON.stringify(B.action_data,null,2)})]}),B.action_reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof B.action_reasoning=="string"?B.action_reasoning:JSON.stringify(B.action_reasoning)})]})]})]},z))})]}),e.jsx(Zt,{}),L.raw_output&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.raw_output})})]})]}),L.prompt&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.prompt})})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(nt,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function qk({autoRefresh:a,refreshKey:l}){const[r,c]=m.useState("overview"),[d,u]=m.useState(null),{getChatName:h}=aN(),[f,p]=m.useState(null),[g,b]=m.useState(!0),[j,y]=m.useState(null),[N,w]=m.useState(!1),[M,A]=m.useState(1),[S,U]=m.useState(20),[E,C]=m.useState(""),[D,P]=m.useState(""),[O,J]=m.useState(""),[L,oe]=m.useState(null),[Ne,je]=m.useState(!1),[de,he]=m.useState(!1),ge=m.useCallback(async()=>{try{b(!0);const B=await Fk();p(B)}catch(B){console.error(":",B)}finally{b(!1)}},[]),R=m.useCallback(async()=>{if(d)try{w(!0);const B=await Hk(d.chat_id,M,S,D||void 0);y(B)}catch(B){console.error(":",B)}finally{w(!1)}},[d,M,S,D]);m.useEffect(()=>{ge()},[ge]),m.useEffect(()=>{l>0&&(r==="overview"?ge():R())},[l,r,ge,R]),m.useEffect(()=>{r==="chat-logs"&&d&&R()},[r,d,R]),nN(a,m.useCallback(()=>{r==="overview"?ge():R()},[r,ge,R]));const Q=B=>{u(B),A(1),P(""),J(""),c("chat-logs")},$=()=>{c("overview"),u(null),y(null),P(""),J("")},ue=()=>{P(O),A(1)},G=()=>{J(""),P(""),A(1)},Se=async(B,z)=>{try{he(!0),je(!0);const K=await Vk(B,z);oe(K)}catch(K){console.error(":",K)}finally{he(!1)}},fe=B=>{U(Number(B)),A(1)},Te=()=>{const B=parseInt(E),z=j?Math.ceil(j.total/j.page_size):0;!isNaN(B)&&B>=1&&B<=z&&(A(B),C(""))},q=j?Math.ceil(j.total/j.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(ws,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(ax,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(ws,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_replies||0})})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((B,z)=>e.jsx(ws,{className:"h-24 w-full"},z))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(B=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Q(B),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(B.chat_id),children:h(B.chat_id)})]}),e.jsx(Ce,{variant:"secondary",children:B.reply_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",lN(B.latest_timestamp)]})]},B.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:$,children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",j?.total||0," "]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(De,{children:""}),e.jsx(is,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{placeholder:"...",value:O,onChange:B=>J(B.target.value),onKeyDown:B=>B.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(At,{className:"h-4 w-4"})}),D&&e.jsx(_,{variant:"ghost",size:"sm",onClick:G,children:""})]}),e.jsxs(Pe,{value:S.toString(),onValueChange:fe,children:[e.jsx(Be,{className:"w-full sm:w-32",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"10",children:"10/"}),e.jsx(W,{value:"20",children:"20/"}),e.jsx(W,{value:"50",children:"50/"}),e.jsx(W,{value:"100",children:"100/"})]})]})]})]}),D&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',D,'"']})]})]}),e.jsx(Me,{children:N?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((B,z)=>e.jsx(ws,{className:"h-20 w-full"},z))}):j?.data&&j.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:j.data.map(B=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Se(B.chat_id,B.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo(B.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[B.success?e.jsxs(Ce,{variant:"default",className:"text-xs bg-green-600",children:[e.jsx(_g,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(Ce,{variant:"destructive",className:"text-xs",children:[e.jsx(Ka,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(Ce,{variant:"outline",className:"text-xs",children:B.model}),e.jsxs(Ce,{variant:"secondary",className:"text-xs",children:[B.overall_ms.toFixed(0),"ms"]})]})]}),e.jsx("p",{className:"text-sm line-clamp-2",children:B.output_preview||""})]},B.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",j.total,"  ",M," / ",q," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(1),disabled:M===1,className:"hidden sm:flex",children:e.jsx(Nn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(B=>Math.max(1,B-1)),disabled:M===1,children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(ae,{type:"number",min:1,max:q,value:E,onChange:B=>C(B.target.value),onKeyDown:B=>B.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[M,"/",q]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(B=>Math.min(q,B+1)),disabled:M===q,children:e.jsx(sa,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>A(q),disabled:M===q,className:"hidden sm:flex",children:e.jsx(bn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Fs,{open:Ne,onOpenChange:je,children:e.jsxs(Us,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),""]}),e.jsx(Xs,{children:""})]}),e.jsx(Ze,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:de?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((B,z)=>e.jsx(ws,{className:"h-24 w-full"},z))}):L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:L.chat_id,children:h(L.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(L.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),L.success?e.jsxs(Ce,{variant:"default",className:"bg-green-600",children:[e.jsx(_g,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(Ce,{variant:"destructive",children:[e.jsx(Ka,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(Ce,{variant:"outline",children:["Level ",L.think_level]})]})]})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx($_,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx(Ce,{variant:"secondary",className:"text-sm",children:L.model})})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(ke,{children:[e.jsx(Re,{className:"p-4 pb-2",children:e.jsx(De,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.prompt_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(ke,{children:[e.jsx(Re,{className:"p-4 pb-2",children:e.jsx(De,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.llm_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(ke,{children:[e.jsx(Re,{className:"p-4 pb-2",children:e.jsx(De,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.overall_ms?.toFixed(2)||0,"ms"]})})]})]}),L.timing.timing_logs&&L.timing.timing_logs.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"space-y-1",children:L.timing.timing_logs.map((B,z)=>e.jsx("div",{className:"text-xs text-muted-foreground",children:B},z))})]}),L.timing.almost_zero&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),L.timing.almost_zero]})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ox,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.output||""})})]}),L.processed_output&&L.processed_output.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-2",children:L.processed_output.map((B,z)=>e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:B})},z))})]})]}),L.reasoning&&e.jsxs(e.Fragment,{children:[e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.reasoning})})]})]}),L.error&&e.jsxs(e.Fragment,{children:[e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-destructive",children:""}),e.jsx("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:e.jsx("p",{className:"text-sm text-destructive whitespace-pre-wrap",children:L.error})})]})]}),L.prompt&&e.jsxs(e.Fragment,{children:[e.jsx(Zt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.prompt})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(nt,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function Kk(){const[a,l]=m.useState("planner"),[r,c]=m.useState(!1),[d,u]=m.useState(0),h=m.useCallback(()=>{u(f=>f+1)},[]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:" & "}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:r?"default":"outline",size:"sm",onClick:()=>c(!r),children:[e.jsx(xt,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),r?"":""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:h,children:e.jsx(xt,{className:"h-4 w-4"})})]})]}),e.jsxs(ea,{value:a,onValueChange:f=>l(f),className:"w-full",children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Xe,{value:"planner",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(tx,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Xe,{value:"replier",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(B_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Ze,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(vs,{value:"planner",className:"mt-0",children:e.jsx(Gk,{autoRefresh:r,refreshKey:d})}),e.jsx(vs,{value:"replier",className:"mt-0",children:e.jsx(qk,{autoRefresh:r,refreshKey:d})})]})]})]})}const Qk="Mai-with-u",Yk="plugin-repo",Jk="main",Xk="plugin_details.json";async function Zk(){try{const a=await _e("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:Qk,repo:Yk,branch:Jk,file_path:Xk})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(!l.success||!l.data)throw new Error(l.error||"");return JSON.parse(l.data).filter(d=>!d?.id||!d?.manifest?(console.warn(":",d),!1):!d.manifest.name||!d.manifest.version?(console.warn(":",d.id),!1):!0).map(d=>({id:d.id,manifest:{manifest_version:d.manifest.manifest_version||1,name:d.manifest.name,version:d.manifest.version,description:d.manifest.description||"",author:d.manifest.author||{name:"Unknown"},license:d.manifest.license||"Unknown",host_application:d.manifest.host_application||{min_version:"0.0.0"},homepage_url:d.manifest.homepage_url,repository_url:d.manifest.repository_url,keywords:d.manifest.keywords||[],categories:d.manifest.categories||[],default_locale:d.manifest.default_locale||"zh-CN",locales_path:d.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()}))}catch(a){throw console.error("Failed to fetch plugin list:",a),a}}async function rN(){try{const a=await _e("/api/webui/plugins/git-status");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to check Git status:",a),{installed:!1,error:" Git "}}}async function iN(){try{const a=await _e("/api/webui/plugins/version");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to get Maimai version:",a),{version:"0.0.0",version_major:0,version_minor:0,version_patch:0}}}function cN(a,l,r){const c=a.split(".").map(f=>parseInt(f)||0),d=c[0]||0,u=c[1]||0,h=c[2]||0;if(r.version_major<d||r.version_major===d&&r.version_minor<u||r.version_major===d&&r.version_minor===u&&r.version_patch<h)return!1;if(l){const f=l.split(".").map(j=>parseInt(j)||0),p=f[0]||0,g=f[1]||0,b=f[2]||0;if(r.version_major>p||r.version_major===p&&r.version_minor>g||r.version_major===p&&r.version_minor===g&&r.version_patch>b)return!1}return!0}async function Wk(){try{const a=await _e("/api/webui/ws-token");if(!a.ok)return console.error(" WebSocket token :",a.status),null;const l=await a.json();return l.success&&l.token?l.token:null}catch(a){return console.error(" WebSocket token :",a),null}}async function eC(a,l){const r=await Wk();if(!r)return console.warn(" WebSocket token"),null;const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host,u=`${c}//${d}/api/webui/ws/plugin-progress?token=${encodeURIComponent(r)}`;try{const h=new WebSocket(u);return h.onopen=()=>{console.log("Plugin progress WebSocket connected");const f=setInterval(()=>{h.readyState===WebSocket.OPEN?h.send("ping"):clearInterval(f)},3e4)},h.onmessage=f=>{try{if(f.data==="pong")return;const p=JSON.parse(f.data);a(p)}catch(p){console.error("Failed to parse progress data:",p)}},h.onerror=f=>{console.error("Plugin progress WebSocket error:",f),l?.(f)},h.onclose=()=>{console.log("Plugin progress WebSocket disconnected")},h}catch(h){return console.error(" WebSocket :",h),null}}async function Dl(){try{const a=await _e("/api/webui/plugins/installed",{headers:qs()});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(!l.success)throw new Error(l.message||"");return l.plugins||[]}catch(a){return console.error("Failed to get installed plugins:",a),[]}}function hn(a,l){return l.some(r=>r.id===a)}function fn(a,l){const r=l.find(c=>c.id===a);if(r)return r.manifest?.version||r.version}async function oN(a,l,r="main"){const c=await _e("/api/webui/plugins/install",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:l,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function dN(a){const l=await _e("/api/webui/plugins/uninstall",{method:"POST",body:JSON.stringify({plugin_id:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function uN(a,l,r="main"){const c=await _e("/api/webui/plugins/update",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:l,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function sC(a){const l=await _e(`/api/webui/plugins/config/${a}/schema`,{headers:qs()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||" Schema ")}catch{throw new Error(` Schema  (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||" Schema ");return r.schema}async function tC(a){const l=await _e(`/api/webui/plugins/config/${a}`,{headers:qs()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||"");return r.config}async function aC(a){const l=await _e(`/api/webui/plugins/config/${a}/raw`,{headers:qs()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||"");return r.config}async function lC(a,l){const r=await _e(`/api/webui/plugins/config/${a}`,{method:"PUT",headers:qs(),body:JSON.stringify({config:l})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function nC(a,l){const r=await _e(`/api/webui/plugins/config/${a}/raw`,{method:"PUT",headers:qs(),body:JSON.stringify({config:l})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function rC(a){const l=await _e(`/api/webui/plugins/config/${a}/reset`,{method:"POST",headers:qs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function iC(a){const l=await _e(`/api/webui/plugins/config/${a}/toggle`,{method:"POST",headers:qs()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}const jc="https://maibot-plugin-stats.maibot-webui.workers.dev";async function mN(a){try{const l=await fetch(`${jc}/stats/${a}`);return l.ok?await l.json():(console.error("Failed to fetch plugin stats:",l.statusText),null)}catch(l){return console.error("Error fetching plugin stats:",l),null}}async function cC(a,l){try{const r=l||Sx(),c=await fetch(`${jc}/stats/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error liking plugin:",r),{success:!1,error:""}}}async function oC(a,l){try{const r=l||Sx(),c=await fetch(`${jc}/stats/dislike`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error disliking plugin:",r),{success:!1,error:""}}}async function dC(a,l,r,c){if(l<1||l>5)return{success:!1,error:" 1-5 "};try{const d=c||Sx(),u=await fetch(`${jc}/stats/rate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,rating:l,comment:r,user_id:d})}),h=await u.json();return u.status===429?{success:!1,error:" 3 "}:u.ok?{success:!0,...h}:{success:!1,error:h.error||""}}catch(d){return console.error("Error rating plugin:",d),{success:!1,error:""}}}async function xN(a){try{const l=await fetch(`${jc}/stats/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a})}),r=await l.json();return l.status===429?(console.warn("Download recording rate limited"),{success:!0}):l.ok?{success:!0,...r}:(console.error("Failed to record download:",r.error),{success:!1,error:r.error})}catch(l){return console.error("Error recording download:",l),{success:!1,error:""}}}function uC(){const a=navigator,l=[navigator.userAgent,navigator.language,navigator.languages?.join(",")||"",navigator.platform,navigator.hardwareConcurrency||0,screen.width,screen.height,screen.colorDepth,screen.pixelDepth,new Date().getTimezoneOffset(),Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.maxTouchPoints||0,a.deviceMemory||0].join("|");let r=0;for(let c=0;c<l.length;c++){const d=l.charCodeAt(c);r=(r<<5)-r+d,r=r&r}return`fp_${Math.abs(r).toString(36)}`}function Sx(){const a="maibot_user_id";let l=localStorage.getItem(a);if(!l){const r=uC(),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,15);l=`${r}_${c}_${d}`,localStorage.setItem(a,l)}return l}const mC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function xC(){return e.jsx(Wn,{children:e.jsx(hC,{})})}function hC(){const a=ca(),{triggerRestart:l,isRestarting:r}=yn(),[c,d]=m.useState(""),[u,h]=m.useState("all"),[f,p]=m.useState("all"),[g,b]=m.useState(!0),[j,y]=m.useState([]),[N,w]=m.useState(!0),[M,A]=m.useState(null),[S,U]=m.useState(null),[E,C]=m.useState(null),[D,P]=m.useState(null),[,O]=m.useState([]),[J,L]=m.useState({}),[oe,Ne]=m.useState(!1),[je,de]=m.useState(null),[he,ge]=m.useState("main"),[R,Q]=m.useState(""),[$,ue]=m.useState("preset"),[G,Se]=m.useState(!1),{toast:fe}=Ws(),Te=async H=>{const se=H.map(async Ee=>{try{const me=await mN(Ee.id);return{id:Ee.id,stats:me}}catch(me){return console.warn(`Failed to load stats for ${Ee.id}:`,me),{id:Ee.id,stats:null}}}),Ue=await Promise.all(se),ie={};Ue.forEach(({id:Ee,stats:me})=>{me&&(ie[Ee]=me)}),L(ie)};m.useEffect(()=>{let H=null,se=!1;return(async()=>{if(H=await eC(ie=>{se||(C(ie),ie.stage==="success"?setTimeout(()=>{se||C(null)},2e3):ie.stage==="error"&&(w(!1),A(ie.error||"")))},ie=>{console.error("WebSocket error:",ie),se||fe({title:"WebSocket ",description:"",variant:"destructive"})}),await new Promise(ie=>{if(!H){ie();return}const Ee=()=>{H&&H.readyState===WebSocket.OPEN?(console.log("WebSocket connected, starting to load plugins"),ie()):H&&H.readyState===WebSocket.CLOSED?(console.warn("WebSocket closed before loading plugins"),ie()):setTimeout(Ee,100)};Ee()}),!se){const ie=await rN();U(ie),ie.installed||fe({title:"Git ",description:ie.error||" Git ",variant:"destructive"})}if(!se){const ie=await iN();P(ie)}if(!se)try{w(!0),A(null);const ie=await Zk();if(!se){const Ee=await Dl();O(Ee);const me=ie.map(ze=>{const at=hn(ze.id,Ee),Pt=fn(ze.id,Ee);return{...ze,installed:at,installed_version:Pt}});for(const ze of Ee)!me.some(Pt=>Pt.id===ze.id)&&ze.manifest&&me.push({id:ze.id,manifest:{manifest_version:ze.manifest.manifest_version||1,name:ze.manifest.name,version:ze.manifest.version,description:ze.manifest.description||"",author:ze.manifest.author,license:ze.manifest.license||"Unknown",host_application:ze.manifest.host_application,homepage_url:ze.manifest.homepage_url,repository_url:ze.manifest.repository_url,keywords:ze.manifest.keywords||[],categories:ze.manifest.categories||[],default_locale:ze.manifest.default_locale||"zh-CN",locales_path:ze.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!0,installed_version:ze.manifest.version,published_at:new Date().toISOString(),updated_at:new Date().toISOString()});y(me),Te(me)}}catch(ie){if(!se){const Ee=ie instanceof Error?ie.message:"";A(Ee),fe({title:"",description:Ee,variant:"destructive"})}}finally{se||w(!1)}})(),()=>{se=!0,H&&H.close()}},[fe]);const q=H=>{if(!H.installed&&D&&!B(H))return e.jsxs(Ce,{variant:"destructive",className:"gap-1",children:[e.jsx(Ct,{className:"h-3 w-3"}),""]});if(H.installed){const se=H.installed_version?.trim(),Ue=H.manifest.version?.trim();if(se!==Ue){const ie=se?.split(".").map(Number)||[0,0,0],Ee=Ue?.split(".").map(Number)||[0,0,0];for(let me=0;me<3;me++){if((Ee[me]||0)>(ie[me]||0))return e.jsxs(Ce,{variant:"outline",className:"gap-1 text-orange-600 border-orange-600",children:[e.jsx(Ct,{className:"h-3 w-3"}),""]});if((Ee[me]||0)<(ie[me]||0))break}}return e.jsxs(Ce,{variant:"default",className:"gap-1",children:[e.jsx(bt,{className:"h-3 w-3"}),""]})}return null},B=H=>!D||!H.manifest?.host_application?!0:cN(H.manifest.host_application.min_version,H.manifest.host_application.max_version,D),z=H=>{if(!H.installed||!H.installed_version||!H.manifest?.version)return!1;const se=H.installed_version.trim(),Ue=H.manifest.version.trim();if(se===Ue)return!1;const ie=se.split(".").map(Number),Ee=Ue.split(".").map(Number);for(let me=0;me<3;me++){if((Ee[me]||0)>(ie[me]||0))return!0;if((Ee[me]||0)<(ie[me]||0))return!1}return!1},K=j.filter(H=>{if(!H.manifest)return console.warn("[]  manifest :",H.id),!1;const se=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(me=>me.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u);let ie=!0;f==="installed"?ie=H.installed===!0:f==="updates"&&(ie=H.installed===!0&&z(H));const Ee=!g||!D||B(H);return se&&Ue&&ie&&Ee}),Ae=H=>{if(!S?.installed){fe({title:"",description:"Git ",variant:"destructive"});return}if(D&&!B(H)){fe({title:"",description:"",variant:"destructive"});return}de(H),ge("main"),Q(""),ue("preset"),Se(!1),Ne(!0)},ee=async()=>{if(!je)return;const H=$==="custom"?R:he;if(!H||H.trim()===""){fe({title:"",variant:"destructive"});return}try{Ne(!1),await oN(je.id,je.manifest.repository_url||"",H),xN(je.id).catch(Ue=>{console.warn("Failed to record download:",Ue)}),fe({title:"",description:`${je.manifest.name} `});const se=await Dl();O(se),y(Ue=>Ue.map(ie=>{if(ie.id===je.id){const Ee=hn(ie.id,se),me=fn(ie.id,se);return{...ie,installed:Ee,installed_version:me}}return ie}))}catch(se){fe({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{de(null)}},Y=async H=>{try{await dN(H.id),fe({title:"",description:`${H.manifest.name} `});const se=await Dl();O(se),y(Ue=>Ue.map(ie=>{if(ie.id===H.id){const Ee=hn(ie.id,se),me=fn(ie.id,se);return{...ie,installed:Ee,installed_version:me}}return ie}))}catch(se){fe({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}},$e=async H=>{if(!S?.installed){fe({title:"",description:"Git ",variant:"destructive"});return}try{const se=await uN(H.id,H.manifest.repository_url||"","main");fe({title:"",description:`${H.manifest.name}  ${se.old_version}  ${se.new_version}`});const Ue=await Dl();O(Ue),y(ie=>ie.map(Ee=>{if(Ee.id===H.id){const me=hn(Ee.id,Ue),ze=fn(Ee.id,Ue);return{...Ee,installed:me,installed_version:ze}}return Ee}))}catch(se){fe({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}};return e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>l(),disabled:r,children:[e.jsx(cv,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]}),e.jsxs(_,{onClick:()=>a({to:"/plugin-mirrors"}),children:[e.jsx(I_,{className:"h-4 w-4 mr-2"}),""]})]})]}),e.jsx(ke,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900",children:e.jsx(Me,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vt,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["",e.jsx("span",{className:"font-semibold",children:""}),""]})]})})}),S&&!S.installed&&e.jsxs(ke,{className:"border-orange-600 bg-orange-50 dark:bg-orange-950/20",children:[e.jsx(Re,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(It,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx(De,{className:"text-lg text-orange-900 dark:text-orange-100",children:"Git "}),e.jsx(is,{className:"text-orange-800 dark:text-orange-200",children:S.error||" Git "})]})]})}),e.jsx(Me,{children:e.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[" ",e.jsx("a",{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer",className:"underline font-medium",children:"git-scm.com"}),"  Git "]})})]}),e.jsx(ke,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:c,onChange:H=>d(H.target.value),className:"pl-9"})]}),e.jsxs(Pe,{value:u,onValueChange:h,children:[e.jsx(Be,{className:"w-full sm:w-[200px]",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"Group Management",children:""}),e.jsx(W,{value:"Entertainment & Interaction",children:""}),e.jsx(W,{value:"Utility Tools",children:""}),e.jsx(W,{value:"Content Generation",children:""}),e.jsx(W,{value:"Multimedia",children:""}),e.jsx(W,{value:"External Integration",children:""}),e.jsx(W,{value:"Data Analysis & Insights",children:""}),e.jsx(W,{value:"Other",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"compatible-only",checked:g,onCheckedChange:H=>b(H===!0)}),e.jsx("label",{htmlFor:"compatible-only",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:""})]})]})}),e.jsx(ea,{value:f,onValueChange:p,className:"w-full",children:e.jsxs(Gt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Xe,{value:"all",children:[" (",j.filter(H=>{if(!H.manifest)return!1;const se=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u),ie=!g||!D||B(H);return se&&Ue&&ie}).length,")"]}),e.jsxs(Xe,{value:"installed",children:[" (",j.filter(H=>{if(!H.manifest)return!1;const se=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u),ie=!g||!D||B(H);return H.installed&&se&&Ue&&ie}).length,")"]}),e.jsxs(Xe,{value:"updates",children:[" (",j.filter(H=>{if(!H.manifest)return!1;const se=c===""||H.manifest.name?.toLowerCase().includes(c.toLowerCase())||H.manifest.description?.toLowerCase().includes(c.toLowerCase())||H.manifest.keywords&&H.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Ue=u==="all"||H.manifest.categories&&H.manifest.categories.includes(u),ie=!g||!D||B(H);return H.installed&&z(H)&&se&&Ue&&ie}).length,")"]})]})}),E&&E.stage==="loading"&&E.operation==="fetch"&&e.jsx(ke,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:""})]}),e.jsxs("span",{className:"text-sm font-medium",children:[E.progress,"%"]})]}),e.jsx(Xn,{value:E.progress,className:"h-2"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:E.message}),E.total_plugins>0&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[" ",E.loaded_plugins," / ",E.total_plugins," "]})]})}),E&&E.stage==="error"&&E.error&&e.jsx(ke,{className:"border-destructive bg-destructive/10",children:e.jsx(Re,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(It,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx(De,{className:"text-lg text-destructive",children:""}),e.jsx(is,{className:"text-destructive/80",children:E.error})]})]})})}),N?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Os,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]}):M?e.jsx(ke,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(It,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:M}),e.jsx(_,{onClick:()=>window.location.reload(),children:""})]})}):K.length===0?e.jsx(ke,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(At,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||u!=="all"?"":""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:K.map(H=>e.jsxs(ke,{className:"flex flex-col hover:shadow-lg transition-shadow h-full",children:[e.jsxs(Re,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(De,{className:"text-xl",children:H.manifest?.name||H.id}),e.jsxs("div",{className:"flex flex-col gap-1",children:[H.manifest?.categories&&H.manifest.categories[0]&&e.jsx(Ce,{variant:"secondary",className:"text-xs whitespace-nowrap",children:mC[H.manifest.categories[0]]||H.manifest.categories[0]}),q(H)]})]}),e.jsx(is,{className:"line-clamp-2",children:H.manifest?.description||""})]}),e.jsx(Me,{className:"flex-1",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{children:(J[H.id]?.downloads??H.downloads??0).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:(J[H.id]?.rating??H.rating??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[H.manifest?.keywords&&H.manifest.keywords.slice(0,3).map(se=>e.jsx(Ce,{variant:"outline",className:"text-xs",children:se},se)),H.manifest?.keywords&&H.manifest.keywords.length>3&&e.jsxs(Ce,{variant:"outline",className:"text-xs",children:["+",H.manifest.keywords.length-3]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t space-y-1",children:[e.jsxs("div",{children:["v",H.manifest?.version||"unknown","  ",H.manifest?.author?.name||"Unknown"]}),H.manifest?.host_application&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:":"}),e.jsxs("span",{className:"font-medium",children:[H.manifest.host_application.min_version,H.manifest.host_application.max_version?` - ${H.manifest.host_application.max_version}`:" - "]})]})]})]})}),e.jsx(id,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>a({to:"/plugin-detail",search:{pluginId:H.id}}),children:""}),H.installed?z(H)?e.jsxs(_,{size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>$e(H),children:[e.jsx(xt,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{variant:"destructive",size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>Y(H),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{size:"sm",disabled:!S?.installed||E?.operation==="install"||D!==null&&!B(H),title:S?.installed?D!==null&&!B(H)?` ( ${H.manifest?.host_application?.min_version||""}${H.manifest?.host_application?.max_version?` - ${H.manifest.host_application.max_version}`:"+"} ${D?.version})`:void 0:"Git ",onClick:()=>Ae(H),children:[e.jsx(Wt,{className:"h-4 w-4 mr-1"}),E?.operation==="install"&&E?.plugin_id===H.id?"...":""]})]})}),E&&(E.stage==="loading"||E.stage==="success"||E.stage==="error")&&E.operation!=="fetch"&&E.plugin_id===H.id&&e.jsx("div",{className:"px-6 pb-4 -mt-2",children:e.jsxs("div",{className:`space-y-2 p-3 rounded-lg border ${E.stage==="success"?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-900":E.stage==="error"?"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-900":"bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[E.stage==="loading"?e.jsx(Os,{className:"h-3 w-3 animate-spin"}):E.stage==="success"?e.jsx(bt,{className:"h-3 w-3 text-green-600"}):e.jsx(Ct,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":E.stage==="error"?"text-red-700 dark:text-red-300":""}`,children:E.stage==="loading"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):E.stage==="success"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]})})]}),E.stage!=="error"&&e.jsxs("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":""}`,children:[E.progress,"%"]})]}),E.stage!=="error"&&e.jsx(Xn,{value:E.progress,className:`h-1.5 ${E.stage==="success"?"[&>div]:bg-green-500":""}`}),e.jsx("div",{className:`text-xs ${E.stage==="success"?"text-green-600 dark:text-green-400 truncate":E.stage==="error"?"text-red-600 dark:text-red-400":"text-muted-foreground truncate"}`,children:E.stage==="error"?E.error||E.message||"":E.message})]})})]},H.id))}),e.jsx(Fs,{open:oe,onOpenChange:Ne,children:e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsxs(Xs,{children:[" ",je?.manifest.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",je?.manifest.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",typeof je?.manifest.author=="string"?je.manifest.author:je?.manifest.author?.name]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"advanced-options",checked:G,onCheckedChange:H=>Se(H)}),e.jsx("label",{htmlFor:"advanced-options",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:""})]}),G&&e.jsx("div",{className:"space-y-4 p-4 border rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:""}),e.jsxs(ea,{value:$,onValueChange:H=>ue(H),children:[e.jsxs(Gt,{className:"grid w-full grid-cols-2",children:[e.jsx(Xe,{value:"preset",className:"text-xs",children:""}),e.jsx(Xe,{value:"custom",className:"text-xs",children:""})]}),$==="preset"&&e.jsx("div",{className:"mt-3",children:e.jsxs(Pe,{value:he,onValueChange:ge,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(W,{value:"main",children:"main ()"}),e.jsx(W,{value:"master",children:"master"}),e.jsx(W,{value:"dev",children:"dev ()"}),e.jsx(W,{value:"develop",children:"develop"}),e.jsx(W,{value:"beta",children:"beta ()"}),e.jsx(W,{value:"stable",children:"stable ()"})]})]})}),$==="custom"&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:": feature/new-feature",value:R,onChange:H=>Q(H.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Git "})]})]})]})}),!G&&e.jsx("p",{className:"text-sm text-muted-foreground",children:" (main) "})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>Ne(!1),children:""}),e.jsxs(_,{onClick:ee,children:[e.jsx(Wt,{className:"h-4 w-4 mr-2"}),""]})]})]})}),e.jsx(er,{})]})})}function fC(){return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ov,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Ze,{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)]",children:e.jsxs(ke,{className:"max-w-2xl w-full border-dashed",children:[e.jsxs(Re,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(ra,{className:"h-16 w-16 text-muted-foreground"})}),e.jsx(De,{className:"text-2xl",children:""}),e.jsx(is,{className:"text-base",children:""})]}),e.jsx(Me,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:" "}),e.jsxs("ul",{className:"space-y-2 ml-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]})]})]})})]})})})]})}function pC({field:a,value:l,onChange:r}){const[c,d]=m.useState(!1);switch(a.ui_type){case"switch":return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:a.label}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]}),e.jsx(Ge,{checked:!!l,onCheckedChange:r,disabled:a.disabled})]});case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ae,{type:"number",value:l??a.default,onChange:u=>r(parseFloat(u.target.value)||0),min:a.min,max:a.max,step:a.step??1,placeholder:a.placeholder,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"slider":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:a.label}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l??a.default})]}),e.jsx(Qa,{value:[l??a.default],onValueChange:u=>r(u[0]),min:a.min??0,max:a.max??100,step:a.step??1,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs(Pe,{value:String(l??a.default),onValueChange:r,disabled:a.disabled,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:a.placeholder??""})}),e.jsx(Ie,{children:a.choices?.map(u=>e.jsx(W,{value:String(u),children:String(u)},String(u)))})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(rt,{value:l??a.default,onChange:u=>r(u.target.value),placeholder:a.placeholder,rows:a.rows??3,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"password":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{type:c?"text":"password",value:l??"",onChange:u=>r(u.target.value),placeholder:a.placeholder,disabled:a.disabled,className:"pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>d(!c),children:c?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"list":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(bS,{value:Array.isArray(l)?l:[],onChange:u=>r(u),itemType:a.item_type??"string",itemFields:a.item_fields,minItems:a.min_items,maxItems:a.max_items,disabled:a.disabled,placeholder:a.placeholder}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"text":default:return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ae,{type:"text",value:l??a.default??"",onChange:u=>r(u.target.value),placeholder:a.placeholder,maxLength:a.max_length,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]})}}function Zg({section:a,config:l,onChange:r}){const[c,d]=m.useState(!a.collapsed),u=Object.entries(a.fields).filter(([,h])=>!h.hidden).sort(([,h],[,f])=>h.order-f.order);return e.jsx(uc,{open:c,onOpenChange:d,children:e.jsxs(ke,{children:[e.jsx(mc,{asChild:!0,children:e.jsxs(Re,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx(za,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(sa,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(De,{className:"text-lg",children:a.title})]}),e.jsxs(Ce,{variant:"secondary",className:"text-xs",children:[u.length," "]})]}),a.description&&e.jsx(is,{className:"ml-6",children:a.description})]})}),e.jsx(xc,{children:e.jsx(Me,{className:"space-y-4 pt-0",children:u.map(([h,f])=>e.jsx(pC,{field:f,value:l[a.name]?.[h],onChange:p=>r(a.name,h,p),sectionName:a.name},h))})})]})})}function gC({plugin:a,onBack:l}){const{toast:r}=Ws(),{triggerRestart:c,isRestarting:d}=yn(),[u,h]=m.useState("visual"),[f,p]=m.useState(null),[g,b]=m.useState({}),[j,y]=m.useState({}),[N,w]=m.useState(""),[M,A]=m.useState(""),[S,U]=m.useState(!0),[E,C]=m.useState(!1),[D,P]=m.useState(!1),[O,J]=m.useState(!1),[L,oe]=m.useState(!1),Ne=m.useCallback(async()=>{U(!0);try{const[$,ue,G]=await Promise.all([sC(a.id),tC(a.id),aC(a.id)]);p($),b(ue),y(JSON.parse(JSON.stringify(ue))),w(G),A(G)}catch($){r({title:"",description:$ instanceof Error?$.message:"",variant:"destructive"})}finally{U(!1)}},[a.id,r]);m.useEffect(()=>{Ne()},[Ne]),m.useEffect(()=>{P(u==="visual"?JSON.stringify(g)!==JSON.stringify(j):N!==M)},[g,j,N,M,u]);const je=($,ue,G)=>{b(Se=>({...Se,[$]:{...Se[$]||{},[ue]:G}}))},de=async()=>{C(!0);try{if(u==="source"){try{vx(N)}catch($){J(!0),r({title:"TOML ",description:$ instanceof Error?$.message:" TOML ",variant:"destructive"}),C(!1);return}await nC(a.id,N),A(N),J(!1)}else await lC(a.id,g),y(JSON.parse(JSON.stringify(g)));r({title:"",description:""})}catch($){r({title:"",description:$ instanceof Error?$.message:"",variant:"destructive"})}finally{C(!1)}},he=async()=>{try{await rC(a.id),r({title:"",description:""}),oe(!1),Ne()}catch($){r({title:"",description:$ instanceof Error?$.message:"",variant:"destructive"})}},ge=async()=>{try{const $=await iC(a.id);r({title:$.message,description:$.note}),Ne()}catch($){r({title:"",description:$ instanceof Error?$.message:"",variant:"destructive"})}};if(S)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Os,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!f)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx(Ct,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsxs(_,{onClick:l,variant:"outline",children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),""]})]});const R=Object.values(f.sections).sort(($,ue)=>$.order-ue.order),Q=g.plugin?.enabled!==!1;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:l,children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:f.plugin_info.name||a.manifest.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Ce,{variant:Q?"default":"secondary",children:Q?"":""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["v",f.plugin_info.version||a.manifest.version]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-10 sm:ml-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>h(u==="visual"?"source":"visual"),children:u==="visual"?e.jsxs(e.Fragment,{children:[e.jsx(nv,{className:"h-4 w-4 mr-2"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(lv,{className:"h-4 w-4 mr-2"}),""]})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>c(),disabled:d,children:[e.jsx(cv,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:ge,children:[e.jsx(hc,{className:"h-4 w-4 mr-2"}),Q?"":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>oe(!0),children:[e.jsx(lc,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs(_,{size:"sm",onClick:de,disabled:!D||E,children:[E?e.jsx(Os,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(fc,{className:"h-4 w-4 mr-2"}),""]})]})]}),D&&e.jsx(ke,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20 dark:border-orange-900",children:e.jsx(Me,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vt,{className:"h-4 w-4 text-orange-600"}),e.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:""})]})})}),u==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(it,{children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsxs(ct,{children:[e.jsx("strong",{children:""})," TOML ",O&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(Fv,{value:N,onChange:$=>{w($),O&&J(!1)},language:"toml",theme:"dark",height:"calc(100vh - 350px)",minHeight:"500px",placeholder:"TOML "})]}),u==="visual"&&e.jsxs(e.Fragment,{children:[e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs(ct,{children:[e.jsx("strong",{children:""}),"WebUI  "]})]}),f.layout.type==="tabs"&&f.layout.tabs.length>0?e.jsxs(ea,{defaultValue:f.layout.tabs[0]?.id,children:[e.jsx(Gt,{children:f.layout.tabs.map($=>e.jsxs(Xe,{value:$.id,children:[$.title,$.badge&&e.jsx(Ce,{variant:"secondary",className:"ml-2 text-xs",children:$.badge})]},$.id))}),f.layout.tabs.map($=>e.jsx(vs,{value:$.id,className:"space-y-4 mt-4",children:$.sections.map(ue=>{const G=f.sections[ue];return G?e.jsx(Zg,{section:G,config:g,onChange:je},ue):null})},$.id))]}):e.jsx("div",{className:"space-y-4",children:R.map($=>e.jsx(Zg,{section:$,config:g,onChange:je},$.name))})]}),e.jsx(Fs,{open:L,onOpenChange:oe,children:e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>oe(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:he,children:""})]})]})})]})}function jC(){return e.jsx(Wn,{children:e.jsx(vC,{})})}function vC(){const{toast:a}=Ws(),[l,r]=m.useState([]),[c,d]=m.useState(!0),[u,h]=m.useState(""),[f,p]=m.useState(null),g=async()=>{d(!0);try{const w=await Dl();r(w)}catch(w){a({title:"",description:w instanceof Error?w.message:"",variant:"destructive"})}finally{d(!1)}};m.useEffect(()=>{g()},[]);const j=l.filter(w=>{const M=u.toLowerCase();return w.id.toLowerCase().includes(M)||w.manifest.name.toLowerCase().includes(M)||w.manifest.description?.toLowerCase().includes(M)}).filter((w,M,A)=>M===A.findIndex(S=>S.id===w.id)),y=l.length,N=0;return f?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"h-full",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(gC,{plugin:f,onBack:()=>p(null)})})}),e.jsx(er,{})]}):e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:g,children:[e.jsx(xt,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),""]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c?"...":""})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(bt,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]}),e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:""}),e.jsx(Ct,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:u,onChange:w=>h(w.target.value),className:"pl-9"})]}),e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Os,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):j.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(ra,{className:"h-16 w-16 text-muted-foreground/50"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:u?"":""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u?"":""})]})]}):e.jsx("div",{className:"space-y-2",children:j.map(w=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>p(w),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(ra,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:w.manifest.name}),e.jsxs(Ce,{variant:"secondary",className:"text-xs flex-shrink-0",children:["v",w.manifest.version]})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:w.manifest.description||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(vn,{className:"h-4 w-4"})}),e.jsx(sa,{className:"h-4 w-4 text-muted-foreground"})]})]},w.id))})})]})]})})}function NC(){const a=ca(),{toast:l}=Ws(),[r,c]=m.useState([]),[d,u]=m.useState(!0),[h,f]=m.useState(null),[p,g]=m.useState(null),[b,j]=m.useState(!1),[y,N]=m.useState(!1),[w,M]=m.useState({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),A=m.useCallback(async()=>{try{u(!0),f(null);const O=await _e("/api/webui/plugins/mirrors");if(!O.ok)throw new Error("");const J=await O.json();c(J.mirrors||[])}catch(O){const J=O instanceof Error?O.message:"";f(J),l({title:"",description:J,variant:"destructive"})}finally{u(!1)}},[l]);m.useEffect(()=>{A()},[A]);const S=async()=>{try{const O=await _e("/api/webui/plugins/mirrors",{method:"POST",body:JSON.stringify(w)});if(!O.ok){const J=await O.json();throw new Error(J.detail||"")}l({title:"",description:""}),j(!1),M({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),A()}catch(O){l({title:"",description:O instanceof Error?O.message:"",variant:"destructive"})}},U=async()=>{if(p)try{if(!(await _e(`/api/webui/plugins/mirrors/${p.id}`,{method:"PUT",body:JSON.stringify({name:w.name,raw_prefix:w.raw_prefix,clone_prefix:w.clone_prefix,enabled:w.enabled,priority:w.priority})})).ok)throw new Error("");l({title:"",description:""}),N(!1),g(null),A()}catch(O){l({title:"",description:O instanceof Error?O.message:"",variant:"destructive"})}},E=async O=>{if(confirm(""))try{if(!(await _e(`/api/webui/plugins/mirrors/${O}`,{method:"DELETE"})).ok)throw new Error("");l({title:"",description:""}),A()}catch(J){l({title:"",description:J instanceof Error?J.message:"",variant:"destructive"})}},C=async O=>{try{if(!(await _e(`/api/webui/plugins/mirrors/${O.id}`,{method:"PUT",body:JSON.stringify({enabled:!O.enabled})})).ok)throw new Error("");A()}catch(J){l({title:"",description:J instanceof Error?J.message:"",variant:"destructive"})}},D=O=>{g(O),M({id:O.id,name:O.name,raw_prefix:O.raw_prefix,clone_prefix:O.clone_prefix,enabled:O.enabled,priority:O.priority}),N(!0)},P=async(O,J)=>{const L=J==="up"?O.priority-1:O.priority+1;if(!(L<1))try{if(!(await _e(`/api/webui/plugins/mirrors/${O.id}`,{method:"PUT",body:JSON.stringify({priority:L})})).ok)throw new Error("");A()}catch(oe){l({title:"",description:oe instanceof Error?oe.message:"",variant:"destructive"})}};return e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:" Git "})]})]}),e.jsxs(_,{onClick:()=>j(!0),children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),""]})]}),d?e.jsx(ke,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Os,{className:"h-8 w-8 animate-spin text-primary"})})}):h?e.jsx(ke,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(It,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h}),e.jsx(_,{onClick:A,children:""})]})}):e.jsxs(ke,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:"ID"}),e.jsx(ss,{children:""}),e.jsx(ss,{className:"text-right",children:""})]})}),e.jsx(Bl,{children:r.map(O=>e.jsxs(ht,{children:[e.jsx(Ye,{children:e.jsx(Ge,{checked:O.enabled,onCheckedChange:()=>C(O)})}),e.jsx(Ye,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:O.name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Raw: ",O.raw_prefix]})]})}),e.jsx(Ye,{children:e.jsx(Ce,{variant:"outline",children:O.id})}),e.jsx(Ye,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono",children:O.priority}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>P(O,"up"),disabled:O.priority===1,children:e.jsx(Qr,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>P(O,"down"),children:e.jsx(za,{className:"h-3 w-3"})})]})]})}),e.jsx(Ye,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>D(O),children:e.jsx(Kn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>E(O.id),children:e.jsx(ls,{className:"h-4 w-4 text-destructive"})})]})})]},O.id))})]})}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:r.map(O=>e.jsx(ke,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:O.name}),O.enabled&&e.jsx(Ce,{variant:"default",className:"text-xs",children:""})]}),e.jsx(Ce,{variant:"outline",className:"mt-1 text-xs",children:O.id})]}),e.jsx(Ge,{checked:O.enabled,onCheckedChange:()=>C(O)})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Raw: "}),e.jsx("span",{className:"break-all",children:O.raw_prefix})]}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),e.jsx("span",{className:"font-mono",children:O.priority})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>D(O),children:[e.jsx(Kn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>P(O,"up"),disabled:O.priority===1,children:e.jsx(Qr,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>P(O,"down"),children:e.jsx(za,{className:"h-4 w-4"})}),e.jsx(_,{variant:"destructive",size:"sm",onClick:()=>E(O.id),children:e.jsx(ls,{className:"h-4 w-4"})})]})]})},O.id))})]}),e.jsx(Fs,{open:b,onOpenChange:j,children:e.jsxs(Us,{className:"max-w-lg",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:" Git "})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-id",children:" ID *"}),e.jsx(ae,{id:"add-id",placeholder:": my-mirror",value:w.id,onChange:O=>M({...w,id:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-name",children:" *"}),e.jsx(ae,{id:"add-name",placeholder:": ",value:w.name,onChange:O=>M({...w,name:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-raw",children:"Raw  *"}),e.jsx(ae,{id:"add-raw",placeholder:"https://example.com/raw",value:w.raw_prefix,onChange:O=>M({...w,raw_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-clone",children:" *"}),e.jsx(ae,{id:"add-clone",placeholder:"https://example.com/clone",value:w.clone_prefix,onChange:O=>M({...w,clone_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-priority",children:""}),e.jsx(ae,{id:"add-priority",type:"number",min:"1",value:w.priority,onChange:O=>M({...w,priority:parseInt(O.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"add-enabled",checked:w.enabled,onCheckedChange:O=>M({...w,enabled:O})}),e.jsx(T,{htmlFor:"add-enabled",children:""})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:""}),e.jsx(_,{onClick:S,children:""})]})]})}),e.jsx(Fs,{open:y,onOpenChange:N,children:e.jsxs(Us,{className:"max-w-lg",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" ID"}),e.jsx(ae,{value:w.id,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-name",children:" *"}),e.jsx(ae,{id:"edit-name",value:w.name,onChange:O=>M({...w,name:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-raw",children:"Raw  *"}),e.jsx(ae,{id:"edit-raw",value:w.raw_prefix,onChange:O=>M({...w,raw_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-clone",children:" *"}),e.jsx(ae,{id:"edit-clone",value:w.clone_prefix,onChange:O=>M({...w,clone_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-priority",children:""}),e.jsx(ae,{id:"edit-priority",type:"number",min:"1",value:w.priority,onChange:O=>M({...w,priority:parseInt(O.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"edit-enabled",checked:w.enabled,onCheckedChange:O=>M({...w,enabled:O})}),e.jsx(T,{htmlFor:"edit-enabled",children:""})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>N(!1),children:""}),e.jsx(_,{onClick:U,children:""})]})]})})]})})}function bC({pluginId:a,compact:l=!1}){const[r,c]=m.useState(null),[d,u]=m.useState(!0),[h,f]=m.useState(0),[p,g]=m.useState(""),[b,j]=m.useState(!1),{toast:y}=Ws(),N=async()=>{u(!0);const S=await mN(a);S&&c(S),u(!1)};m.useEffect(()=>{N()},[a]);const w=async()=>{const S=await cC(a);S.success?(y({title:"",description:""}),N()):y({title:"",description:S.error||"",variant:"destructive"})},M=async()=>{const S=await oC(a);S.success?(y({title:"",description:""}),N()):y({title:"",description:S.error||"",variant:"destructive"})},A=async()=>{if(h===0){y({title:"",description:" 1 ",variant:"destructive"});return}const S=await dC(a,h,p||void 0);S.success?(y({title:"",description:""}),j(!1),f(0),g(""),N()):y({title:"",description:S.error||"",variant:"destructive"})};return d?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mn,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]})]}):r?l?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.downloads.toLocaleString()}`,children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{children:r.downloads.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.rating.toFixed(1)} (${r.rating_count} )`,children:[e.jsx(mn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:r.rating.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.likes}`,children:[e.jsx(Em,{className:"h-4 w-4"}),e.jsx("span",{children:r.likes})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Wt,{className:"h-5 w-5 text-muted-foreground mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.downloads.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(mn,{className:"h-5 w-5 text-yellow-400 mb-1 fill-yellow-400"}),e.jsx("span",{className:"text-2xl font-bold",children:r.rating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.rating_count," "]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Em,{className:"h-5 w-5 text-green-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.likes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Sg,{className:"h-5 w-5 text-red-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.dislikes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(Em,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:M,children:[e.jsx(Sg,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(Fs,{open:b,onOpenChange:j,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"default",size:"sm",children:[e.jsx(mn,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(S=>e.jsx("button",{onClick:()=>f(S),className:"focus:outline-none",children:e.jsx(mn,{className:`h-8 w-8 transition-colors ${S<=h?"fill-yellow-400 text-yellow-400":"text-muted-foreground hover:text-yellow-300"}`})},S))}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h===0&&"",h===1&&"",h===2&&"",h===3&&"",h===4&&"",h===5&&""]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),e.jsx(rt,{value:p,onChange:S=>g(S.target.value),placeholder:"...",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[p.length," / 500"]})]})]}),e.jsxs(nt,{children:[e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:""}),e.jsx(_,{onClick:A,disabled:h===0,children:""})]})]})]})]}),r.recent_ratings&&r.recent_ratings.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-3",children:r.recent_ratings.map((S,U)=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>e.jsx(mn,{className:`h-3 w-3 ${E<=S.rating?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`},E))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(S.created_at).toLocaleDateString()})]}),S.comment&&e.jsx("p",{className:"text-sm text-muted-foreground",children:S.comment})]},U))})]})]}):null}const yC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function wC(){const a=ca(),l=J0({strict:!1}),{toast:r}=Ws(),[c,d]=m.useState(null),[u,h]=m.useState(""),[f,p]=m.useState(!0),[g,b]=m.useState(!0),[j,y]=m.useState(null),[N,w]=m.useState(null),[M,A]=m.useState(null),[S,U]=m.useState(!1),[E,C]=m.useState(),[D,P]=m.useState(!1);m.useEffect(()=>{(async()=>{if(!l.pluginId){y(" ID"),p(!1);return}try{p(!0),y(null);const he=await _e("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:"Mai-with-u",repo:"plugin-repo",branch:"main",file_path:"plugin_details.json"})});if(!he.ok)throw new Error("");const ge=await he.json();if(!ge.success||!ge.data)throw new Error(ge.error||"");const Q=JSON.parse(ge.data).find(fe=>fe.id===l.pluginId);if(!Q)throw new Error("");const $={id:Q.id,manifest:Q.manifest,downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()};d($);const[ue,G,Se]=await Promise.all([rN(),iN(),Dl()]);w(ue),A(G),U(hn(l.pluginId,Se)),C(fn(l.pluginId,Se))}catch(he){y(he instanceof Error?he.message:"")}finally{p(!1)}})()},[l.pluginId]),m.useEffect(()=>{(async()=>{if(!c?.manifest?.repository_url){b(!1);return}try{if(b(!0),S&&l.pluginId)try{const G=await _e(`/api/webui/plugins/local-readme/${l.pluginId}`);if(G.ok){const Se=await G.json();if(Se.success&&Se.data){h(Se.data),b(!1);return}}}catch(G){console.log(" README :",G)}const he=c.manifest.repository_url.match(/github\.com\/([^/]+)\/([^/\s]+)/);if(!he){h("");return}const[,ge,R]=he,Q=R.replace(/\.git$/,""),$=await _e("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:ge,repo:Q,branch:"main",file_path:"README.md"})});if(!$.ok)throw new Error(" README ");const ue=await $.json();ue.success&&ue.data?h(ue.data):h(" README ")}catch(he){console.error(" README :",he),h(" README ")}finally{b(!1)}})()},[c,S,l.pluginId]);const O=()=>!c||!S||!E?!1:E!==c.manifest.version,J=()=>!c||!M?!0:cN(c.manifest.host_application.min_version,c.manifest.host_application.max_version,M),L=async()=>{if(!(!c||!N?.installed))try{P(!0),await oN(c.id,c.manifest.repository_url||"","main"),xN(c.id).catch(he=>{console.warn("Failed to record download:",he)}),r({title:"",description:`${c.manifest.name} `});const de=await Dl();U(hn(c.id,de)),C(fn(c.id,de))}catch(de){r({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}finally{P(!1)}},oe=async()=>{if(c)try{P(!0),await dN(c.id),r({title:"",description:`${c.manifest.name} `});const de=await Dl();U(hn(c.id,de)),C(fn(c.id,de))}catch(de){r({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}finally{P(!1)}},Ne=async()=>{if(!(!c||!N?.installed))try{P(!0);const de=await uN(c.id,c.manifest.repository_url||"","main");r({title:"",description:`${c.manifest.name}  ${de.old_version}  ${de.new_version}`});const he=await Dl();U(hn(c.id,he)),C(fn(c.id,he))}catch(de){r({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}finally{P(!1)}};if(f)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Os,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]})]});if(j||!c)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsx(ke,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Ct,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:j}),e.jsx(_,{onClick:()=>a({to:"/plugins"}),children:""})]})})]});const je=J();return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),className:"shrink-0",children:e.jsx(Ma,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:c.manifest.name})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S?e.jsxs(e.Fragment,{children:[O()?e.jsx(_,{disabled:!N?.installed||D,onClick:Ne,title:N?.installed?void 0:"Git ",children:D?e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"h-4 w-4 mr-2"}),""]})}):null,e.jsx(_,{variant:"destructive",disabled:!N?.installed||D,onClick:oe,title:N?.installed?void 0:"Git ",children:D?e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),""]})})]}):e.jsx(_,{disabled:!N?.installed||!je||D,onClick:L,title:N?.installed?je?void 0:` ( ${c.manifest.host_application.min_version}${c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:"+"} ${M?.version})`:"Git ",children:D?e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Wt,{className:"h-4 w-4 mr-2"}),""]})})})]}),e.jsx(Ze,{className:"h-[calc(100vh-200px)] sm:h-[calc(100vh-220px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsx(ke,{children:e.jsx(Re,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(De,{className:"text-2xl",children:c.manifest.name}),e.jsxs(Ce,{variant:"secondary",className:"text-sm",children:["v",c.manifest.version]}),S&&e.jsxs(Ce,{variant:"default",className:"text-sm",children:[e.jsx(bt,{className:"h-3 w-3 mr-1"})," ",E&&`(v${E})`]}),O()&&e.jsxs(Ce,{variant:"outline",className:"text-sm border-orange-500 text-orange-500",children:[e.jsx(xt,{className:"h-3 w-3 mr-1"}),""]}),!je&&e.jsxs(Ce,{variant:"destructive",className:"text-sm",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx(is,{className:"text-base",children:c.manifest.description})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsx(De,{className:"text-lg",children:""})}),e.jsx(Me,{children:e.jsx(bC,{pluginId:c.id})})]}),e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsx(De,{className:"text-lg",children:""})}),e.jsx(Me,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(jn,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.author?.name||"Unknown"}),c.manifest.author?.url&&e.jsx("a",{href:c.manifest.author.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:e.jsx($o,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-medium",children:["v",c.manifest.version]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(sv,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.license})]}),c.manifest.homepage_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Vo,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.homepage_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["",e.jsx($o,{className:"h-3 w-3"})]})]}),c.manifest.repository_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(P_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.repository_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["GitHub",e.jsx($o,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"})]}),e.jsxs("div",{className:"text-sm pl-6 font-medium",children:[c.manifest.host_application.min_version,c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:" - "]})]})]})})]}),(c.manifest.categories||c.manifest.keywords)&&e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsx(De,{className:"text-lg",children:""})}),e.jsxs(Me,{className:"space-y-4",children:[c.manifest.categories&&c.manifest.categories.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.categories.map(de=>e.jsx(Ce,{variant:"secondary",children:yC[de]||de},de))})]}),c.manifest.keywords&&c.manifest.keywords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.keywords.map(de=>e.jsxs(Ce,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"h-3 w-3 mr-1"}),de]},de))})]})]})]})]}),e.jsxs(ke,{className:"lg:col-span-2",children:[e.jsx(Re,{children:e.jsx(De,{className:"text-lg",children:""})}),e.jsx(Me,{children:e.jsx(Ze,{className:"h-[600px] pr-4",children:g?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Os,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-sm text-muted-foreground",children:"..."})]}):u?e.jsx(px,{content:u}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:""})})})]})]})]})})]})}const Zi=m.forwardRef(({className:a,...l},r)=>e.jsx(Sj,{ref:r,className:F("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...l}));Zi.displayName=Sj.displayName;const _C=m.forwardRef(({className:a,...l},r)=>e.jsx(kj,{ref:r,className:F("aspect-square h-full w-full",a),...l}));_C.displayName=kj.displayName;const Wi=m.forwardRef(({className:a,...l},r)=>e.jsx(Cj,{ref:r,className:F("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...l}));Wi.displayName=Cj.displayName;function SC(){return"webui_"+Math.random().toString(36).substr(2,9)+"_"+Date.now().toString(36)}function kC(){const a="maibot_webui_user_id";let l=localStorage.getItem(a);return l||(l=SC(),localStorage.setItem(a,l)),l}function CC(){return localStorage.getItem("maibot_webui_user_name")||"WebUI"}function TC(a){localStorage.setItem("maibot_webui_user_name",a)}const hN="maibot_webui_virtual_tabs";function EC(){try{const a=localStorage.getItem(hN);if(a)return JSON.parse(a)}catch(a){console.error("[Chat] :",a)}return[]}function Wg(a){try{localStorage.setItem(hN,JSON.stringify(a))}catch(l){console.error("[Chat] :",l)}}function MC({segment:a}){switch(a.type){case"text":return e.jsx("span",{className:"whitespace-pre-wrap",children:String(a.data)});case"image":case"emoji":return e.jsx("img",{src:String(a.data),alt:a.type==="emoji"?"":"",className:F("rounded-lg max-w-full",a.type==="emoji"?"max-h-32":"max-h-64"),loading:"lazy",onError:l=>{const r=l.target;r.style.display="none",r.parentElement?.insertAdjacentHTML("beforeend",`<span class="text-muted-foreground text-xs">[${a.type==="emoji"?"":""}]</span>`)}});case"voice":return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("audio",{controls:!0,src:String(a.data),className:"max-w-[200px] h-8",children:""})});case"video":return e.jsx("video",{controls:!0,src:String(a.data),className:"rounded-lg max-w-full max-h-64",children:""});case"face":return e.jsxs("span",{className:"text-muted-foreground",children:["[:",String(a.data),"]"]});case"music":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"file":return e.jsxs("span",{className:"text-muted-foreground",children:["[: ",String(a.data),"]"]});case"reply":return e.jsx("span",{className:"text-muted-foreground text-xs",children:"[]"});case"forward":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"unknown":default:return e.jsxs("span",{className:"text-muted-foreground",children:["[",a.original_type||"","]"]})}}function AC({message:a,isBot:l}){return a.message_type==="rich"&&a.segments&&a.segments.length>0?e.jsx("div",{className:"flex flex-col gap-2",children:a.segments.map((r,c)=>e.jsx(MC,{segment:r},c))}):e.jsx("span",{className:"whitespace-pre-wrap",children:a.content})}function zC(){const a={id:"webui-default",type:"webui",label:"WebUI",messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}},l=()=>{const qe=EC().map(Qe=>{const We=Qe.virtualConfig;return!We.groupId&&We.platform&&We.userId&&(We.groupId=`webui_virtual_group_${We.platform}_${We.userId}`),{id:Qe.id,type:"virtual",label:Qe.label,virtualConfig:We,messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}}});return[a,...qe]},[r,c]=m.useState(l),[d,u]=m.useState("webui-default"),h=r.find(Z=>Z.id===d)||r[0],[f,p]=m.useState(""),[g,b]=m.useState(!1),[j,y]=m.useState(!0),[N,w]=m.useState(CC()),[M,A]=m.useState(!1),[S,U]=m.useState(""),[E,C]=m.useState(!1),[D,P]=m.useState([]),[O,J]=m.useState([]),[L,oe]=m.useState(!1),[Ne,je]=m.useState(!1),[de,he]=m.useState(""),[ge,R]=m.useState({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),Q=m.useRef(kC()),$=m.useRef(new Map),ue=m.useRef(null),G=m.useRef(new Map),Se=m.useRef(0),fe=m.useRef(new Map),{toast:Te}=Ws(),q=Z=>(Se.current+=1,`${Z}-${Date.now()}-${Se.current}-${Math.random().toString(36).substr(2,9)}`),B=m.useCallback((Z,qe)=>{c(Qe=>Qe.map(We=>We.id===Z?{...We,...qe}:We))},[]),z=m.useCallback((Z,qe)=>{c(Qe=>Qe.map(We=>We.id===Z?{...We,messages:[...We.messages,qe]}:We))},[]),K=m.useCallback(()=>{ue.current?.scrollIntoView({behavior:"smooth"})},[]);m.useEffect(()=>{K()},[h?.messages,K]);const Ae=m.useCallback(async()=>{oe(!0);try{const Z=await _e("/api/chat/platforms");if(console.log("[Chat] :",Z.status,Z.headers.get("content-type")),Z.ok){const qe=Z.headers.get("content-type");if(qe&&qe.includes("application/json")){const Qe=await Z.json();console.log("[Chat] :",Qe),P(Qe.platforms||[])}else{const Qe=await Z.text();console.error("[Chat] :  JSON :",Qe.substring(0,200)),Te({title:"",description:" MaiBot ",variant:"destructive"})}}else console.error("[Chat] : HTTP",Z.status),Te({title:"",description:`: ${Z.status}`,variant:"destructive"})}catch(Z){console.error("[Chat] :",Z),Te({title:"",description:"",variant:"destructive"})}finally{oe(!1)}},[Te]),ee=m.useCallback(async(Z,qe)=>{je(!0);try{const Qe=new URLSearchParams;Z&&Qe.append("platform",Z),qe&&Qe.append("search",qe),Qe.append("limit","50");const We=await _e(`/api/chat/persons?${Qe.toString()}`);if(We.ok){const Rs=We.headers.get("content-type");if(Rs&&Rs.includes("application/json")){const He=await We.json();J(He.persons||[])}else console.error("[Chat] :  JSON ")}}catch(Qe){console.error("[Chat] :",Qe)}finally{je(!1)}},[]);m.useEffect(()=>{ge.platform&&ee(ge.platform,de)},[ge.platform,de,ee]);const Y=m.useCallback(async(Z,qe)=>{y(!0);try{const Qe=new URLSearchParams;Qe.append("user_id",Q.current),Qe.append("limit","50"),qe&&Qe.append("group_id",qe);const We=`/api/chat/history?${Qe.toString()}`;console.log("[Chat] :",We);const Rs=await _e(We);if(Rs.ok){const He=await Rs.text();try{const Ss=JSON.parse(He);if(Ss.messages&&Ss.messages.length>0){const Ds=Ss.messages.map(ns=>({id:ns.id,type:ns.type,content:ns.content,timestamp:ns.timestamp,sender:{name:ns.sender_name||(ns.is_bot?"":"WebUI"),user_id:ns.user_id,is_bot:ns.is_bot}}));B(Z,{messages:Ds});const Vs=fe.current.get(Z)||new Set;Ds.forEach(ns=>{if(ns.type==="bot"){const ts=`bot-${ns.content}-${Math.floor(ns.timestamp*1e3)}`;Vs.add(ts)}}),fe.current.set(Z,Vs)}}catch(Ss){console.error("[Chat] JSON :",Ss)}}}catch(Qe){console.error("[Chat] :",Qe)}finally{y(!1)}},[B]),$e=m.useCallback(async(Z,qe,Qe)=>{const We=$.current.get(Z);if(We?.readyState===WebSocket.OPEN||We?.readyState===WebSocket.CONNECTING){console.log(`[Tab ${Z}] WebSocket `);return}b(!0);let Rs=null;try{const Vs=await _e("/api/webui/ws-token");if(Vs.ok){const ns=await Vs.json();if(ns.success&&ns.token)Rs=ns.token;else{console.warn(`[Tab ${Z}]  WebSocket token : ${ns.message||""}`),b(!1);return}}}catch(Vs){console.error(`[Tab ${Z}]  WebSocket token :`,Vs),b(!1);return}if(!Rs){b(!1);return}const He=window.location.protocol==="https:"?"wss:":"ws:",Ss=new URLSearchParams;Ss.append("token",Rs),qe==="virtual"&&Qe?(Ss.append("user_id",Qe.userId),Ss.append("user_name",Qe.userName),Ss.append("platform",Qe.platform),Ss.append("person_id",Qe.personId),Ss.append("group_name",Qe.groupName||"WebUI"),Qe.groupId&&Ss.append("group_id",Qe.groupId)):(Ss.append("user_id",Q.current),Ss.append("user_name",N));const Ds=`${He}//${window.location.host}/api/chat/ws?${Ss.toString()}`;console.log(`[Tab ${Z}]  WebSocket:`,Ds);try{const Vs=new WebSocket(Ds);$.current.set(Z,Vs),Vs.onopen=()=>{B(Z,{isConnected:!0}),b(!1),console.log(`[Tab ${Z}] WebSocket `)},Vs.onmessage=ns=>{try{const ts=JSON.parse(ns.data);switch(ts.type){case"session_info":B(Z,{sessionInfo:{session_id:ts.session_id,user_id:ts.user_id,user_name:ts.user_name,bot_name:ts.bot_name}});break;case"system":z(Z,{id:q("sys"),type:"system",content:ts.content||"",timestamp:ts.timestamp||Date.now()/1e3});break;case"user_message":{const Ns=ts.sender?.user_id,Le=qe==="virtual"&&Qe?Qe.userId:Q.current;console.log(`[Tab ${Z}]  user_message, sender: ${Ns}, current: ${Le}`);const bs=Ns?Ns.replace(/^webui_user_/,""):"",_s=Le?Le.replace(/^webui_user_/,""):"";if(bs&&_s&&bs===_s){console.log(`[Tab ${Z}] user_id `);break}const rs=fe.current.get(Z)||new Set,ft=`user-${ts.content}-${Math.floor((ts.timestamp||0)*1e3)}`;if(rs.has(ft)){console.log(`[Tab ${Z}] `);break}if(rs.add(ft),fe.current.set(Z,rs),rs.size>100){const zt=rs.values().next().value;zt&&rs.delete(zt)}z(Z,{id:ts.message_id||q("user"),type:"user",content:ts.content||"",timestamp:ts.timestamp||Date.now()/1e3,sender:ts.sender});break}case"bot_message":{B(Z,{isTyping:!1});const Ns=fe.current.get(Z)||new Set,Le=`bot-${ts.content}-${Math.floor((ts.timestamp||0)*1e3)}`;if(Ns.has(Le))break;if(Ns.add(Le),fe.current.set(Z,Ns),Ns.size>100){const bs=Ns.values().next().value;bs&&Ns.delete(bs)}c(bs=>bs.map(_s=>{if(_s.id!==Z)return _s;const rs=_s.messages.filter(zt=>zt.type!=="thinking"),ft={id:q("bot"),type:"bot",content:ts.content||"",message_type:ts.message_type==="rich"?"rich":"text",segments:ts.segments,timestamp:ts.timestamp||Date.now()/1e3,sender:ts.sender};return{..._s,messages:[...rs,ft]}}));break}case"typing":B(Z,{isTyping:ts.is_typing||!1});break;case"error":c(Ns=>Ns.map(Le=>{if(Le.id!==Z)return Le;const bs=Le.messages.filter(_s=>_s.type!=="thinking");return{...Le,messages:[...bs,{id:q("error"),type:"error",content:ts.content||"",timestamp:ts.timestamp||Date.now()/1e3}]}})),Te({title:"",description:ts.content,variant:"destructive"});break;case"pong":break;case"history":{const Ns=ts.messages||[];if(Ns.length>0){const Le=fe.current.get(Z)||new Set,bs=Ns.map(_s=>{const rs=_s.is_bot||!1,ft=_s.id||q(rs?"bot":"user"),zt=`${rs?"bot":"user"}-${_s.content}-${Math.floor(_s.timestamp*1e3)}`;return Le.add(zt),{id:ft,type:rs?"bot":"user",content:_s.content,timestamp:_s.timestamp,sender:{name:_s.sender_name||(rs?"":""),user_id:_s.sender_id,is_bot:rs}}});fe.current.set(Z,Le),B(Z,{messages:bs}),console.log(`[Tab ${Z}]  ${bs.length} `)}break}default:console.log(":",ts.type)}}catch(ts){console.error(":",ts)}},Vs.onclose=()=>{B(Z,{isConnected:!1}),b(!1),$.current.delete(Z),console.log(`[Tab ${Z}] WebSocket `);const ns=G.current.get(Z);ns&&clearTimeout(ns);const ts=window.setTimeout(()=>{if(!H.current){const Ns=r.find(Le=>Le.id===Z);Ns&&$e(Z,Ns.type,Ns.virtualConfig)}},5e3);G.current.set(Z,ts)},Vs.onerror=ns=>{console.error(`[Tab ${Z}] WebSocket :`,ns),b(!1)}}catch(Vs){console.error(`[Tab ${Z}]  WebSocket :`,Vs),b(!1)}},[N,B,z,Te,r]),H=m.useRef(!1);m.useEffect(()=>{H.current=!1;const Z=$.current,qe=G.current,Qe=fe.current;Y("webui-default");const We=setTimeout(()=>{H.current||($e("webui-default","webui"),r.forEach(He=>{He.type==="virtual"&&He.virtualConfig&&(Qe.set(He.id,new Set),setTimeout(()=>{H.current||$e(He.id,"virtual",He.virtualConfig)},200))}))},100),Rs=setInterval(()=>{Z.forEach(He=>{He.readyState===WebSocket.OPEN&&He.send(JSON.stringify({type:"ping"}))})},3e4);return()=>{H.current=!0,clearTimeout(We),clearInterval(Rs),qe.forEach(He=>{clearTimeout(He)}),qe.clear(),Z.forEach(He=>{He.close()}),Z.clear()}},[]);const se=m.useCallback(()=>{const Z=$.current.get(d);if(!f.trim()||!Z||Z.readyState!==WebSocket.OPEN)return;const qe=h?.type==="virtual"&&h.virtualConfig?.userName||N,Qe=f.trim(),We=Date.now()/1e3;Z.send(JSON.stringify({type:"message",content:Qe,user_name:qe}));const Rs=fe.current.get(d)||new Set,He=`user-${Qe}-${Math.floor(We*1e3)}`;if(Rs.add(He),fe.current.set(d,Rs),Rs.size>100){const Vs=Rs.values().next().value;Vs&&Rs.delete(Vs)}const Ss={id:q("user"),type:"user",content:Qe,timestamp:We,sender:{name:qe,is_bot:!1}};z(d,Ss);const Ds={id:q("thinking"),type:"thinking",content:"",timestamp:We+.001,sender:{name:h?.sessionInfo.bot_name||"",is_bot:!0}};z(d,Ds),p("")},[f,N,d,h,z]),Ue=Z=>{Z.key==="Enter"&&!Z.shiftKey&&(Z.preventDefault(),se())},ie=()=>{U(N),A(!0)},Ee=()=>{const Z=S.trim()||"WebUI";w(Z),TC(Z),A(!1);const qe=$.current.get(d);qe?.readyState===WebSocket.OPEN&&qe.send(JSON.stringify({type:"update_nickname",user_name:Z}))},me=()=>{U(""),A(!1)},ze=Z=>new Date(Z*1e3).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),at=()=>{const Z=$.current.get(d);Z&&(Z.close(),$.current.delete(d)),$e(d,h?.type||"webui",h?.virtualConfig)},Pt=()=>{R({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),he(""),Ae(),C(!0)},qt=()=>{if(!ge.platform||!ge.personId){Te({title:"",description:"",variant:"destructive"});return}const Z=`webui_virtual_group_${ge.platform}_${ge.userId}`,qe=`virtual-${ge.platform}-${ge.userId}-${Date.now()}`,Qe=ge.userName||ge.userId,We={id:qe,type:"virtual",label:Qe,virtualConfig:{...ge,groupId:Z},messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}};c(Rs=>{const He=[...Rs,We],Ss=He.filter(Ds=>Ds.type==="virtual"&&Ds.virtualConfig).map(Ds=>({id:Ds.id,label:Ds.label,virtualConfig:Ds.virtualConfig,createdAt:Date.now()}));return Wg(Ss),He}),u(qe),C(!1),fe.current.set(qe,new Set),setTimeout(()=>{$e(qe,"virtual",ge)},100),Te({title:"",description:` ${Qe} `})},Ja=(Z,qe)=>{if(qe?.stopPropagation(),Z==="webui-default")return;const Qe=$.current.get(Z);Qe&&(Qe.close(),$.current.delete(Z));const We=G.current.get(Z);We&&(clearTimeout(We),G.current.delete(Z)),fe.current.delete(Z),c(Rs=>{const He=Rs.filter(Ds=>Ds.id!==Z),Ss=He.filter(Ds=>Ds.type==="virtual"&&Ds.virtualConfig).map(Ds=>({id:Ds.id,label:Ds.label,virtualConfig:Ds.virtualConfig,createdAt:Date.now()}));return Wg(Ss),He}),d===Z&&u("webui-default")},As=Z=>{u(Z)},vt=Z=>{R(qe=>({...qe,personId:Z.person_id,userId:Z.user_id,userName:Z.nickname||Z.person_name}))};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(Fs,{open:E,onOpenChange:C,children:e.jsxs(Us,{className:"sm:max-w-[500px] max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(Mm,{className:"h-5 w-5"}),""]}),e.jsx(Xs,{children:""})]}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Vo,{className:"h-4 w-4"}),""]}),e.jsxs(Pe,{value:ge.platform,onValueChange:Z=>{R(qe=>({...qe,platform:Z,personId:"",userId:"",userName:""})),J([])},children:[e.jsx(Be,{disabled:L,children:e.jsx(Fe,{placeholder:L?"...":""})}),e.jsx(Ie,{children:D.map(Z=>e.jsxs(W,{value:Z.platform,children:[Z.platform," (",Z.count," )"]},Z.platform))})]})]}),ge.platform&&e.jsxs("div",{className:"space-y-2 flex-1 overflow-hidden flex flex-col",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"relative",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:de,onChange:Z=>he(Z.target.value),className:"pl-9"})]}),e.jsx(Ze,{className:"h-[250px] border rounded-md",children:e.jsx("div",{className:"p-2",children:Ne?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Os,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):O.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ic,{className:"h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:""})]}):e.jsx("div",{className:"space-y-1",children:O.map(Z=>e.jsxs("button",{onClick:()=>vt(Z),className:F("w-full flex items-center gap-3 p-2 rounded-md text-left transition-colors",ge.personId===Z.person_id?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(Zi,{className:"h-8 w-8 shrink-0",children:e.jsx(Wi,{className:F("text-xs",ge.personId===Z.person_id?"bg-primary-foreground/20":"bg-muted"),children:(Z.nickname||Z.person_name||"?").charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate",children:Z.nickname||Z.person_name}),e.jsxs("div",{className:F("text-xs truncate",ge.personId===Z.person_id?"text-primary-foreground/70":"text-muted-foreground"),children:["ID: ",Z.user_id,Z.is_known&&"  "]})]})]},Z.person_id))})})})]}),ge.personId&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsx(ae,{placeholder:"WebUI",value:ge.groupName,onChange:Z=>R(qe=>({...qe,groupName:Z.target.value}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs(nt,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:()=>C(!1),children:""}),e.jsx(_,{onClick:qt,disabled:!ge.platform||!ge.personId,children:""})]})]})}),e.jsx("div",{className:"shrink-0 border-b bg-muted/30",children:e.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto py-1.5 scrollbar-thin",children:[r.map(Z=>e.jsxs("div",{className:F("flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm whitespace-nowrap transition-colors cursor-pointer","hover:bg-muted",d===Z.id?"bg-background shadow-sm border":"text-muted-foreground"),onClick:()=>As(Z.id),children:[Z.type==="webui"?e.jsx(Ra,{className:"h-3.5 w-3.5"}):e.jsx(Mm,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"max-w-[100px] truncate",children:Z.label}),e.jsx("span",{className:F("w-1.5 h-1.5 rounded-full",Z.isConnected?"bg-green-500":"bg-muted-foreground/50")}),Z.id!=="webui-default"&&e.jsx("span",{onClick:qe=>Ja(Z.id,qe),className:"ml-0.5 p-0.5 rounded hover:bg-muted-foreground/20 cursor-pointer",role:"button",tabIndex:0,onKeyDown:qe=>{(qe.key==="Enter"||qe.key===" ")&&(qe.preventDefault(),Ja(Z.id,qe))},children:e.jsx(Aa,{className:"h-3 w-3"})})]},Z.id)),e.jsx("button",{onClick:Pt,className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-sm text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",title:"",children:e.jsx(Ys,{className:"h-3.5 w-3.5"})})]})})}),e.jsx("div",{className:"shrink-0 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(Zi,{className:"h-8 w-8 sm:h-10 sm:w-10 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Vn,{className:"h-4 w-4 sm:h-5 sm:w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:h?.sessionInfo.bot_name||""}),e.jsx("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:h?.isConnected?e.jsxs(e.Fragment,{children:[e.jsx(F_,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:""})]}):g?e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(H_,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:""})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[j&&e.jsx(Os,{className:"h-4 w-4 animate-spin text-muted-foreground"}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:at,disabled:g,title:"",children:e.jsx(xt,{className:F("h-4 w-4",g&&"animate-spin")})})]})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:h?.type==="virtual"&&h.virtualConfig?e.jsxs(e.Fragment,{children:[e.jsx(Mm,{className:"h-3 w-3 text-primary"}),e.jsx("span",{children:""}),e.jsx("span",{className:"font-medium text-primary",children:h.virtualConfig.userName}),e.jsxs("span",{className:"text-xs",children:["(",h.virtualConfig.platform,")"]}),h.virtualConfig.groupName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:""}),e.jsxs("span",{className:"text-xs",children:["",h.virtualConfig.groupName]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(jn,{className:"h-3 w-3"}),e.jsx("span",{children:""}),M?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{value:S,onChange:Z=>U(Z.target.value),onKeyDown:Z=>{Z.key==="Enter"&&Ee(),Z.key==="Escape"&&me()},className:"h-7 w-32",placeholder:"",autoFocus:!0}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:Ee,children:""}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:me,children:""})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:N}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:ie,title:"",children:e.jsx(V_,{className:"h-3 w-3"})})]})]})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(Ze,{className:"h-full",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto space-y-3 sm:space-y-4",children:[h?.messages.length===0&&!j&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(Vn,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsxs("p",{className:"text-sm",children:[" ",h?.sessionInfo.bot_name||""," "]})]}),h?.messages.map(Z=>e.jsxs("div",{className:F("flex gap-2 sm:gap-3",Z.type==="user"&&"flex-row-reverse",Z.type==="system"&&"justify-center",Z.type==="error"&&"justify-center"),children:[Z.type==="system"&&e.jsx("div",{className:"text-xs text-muted-foreground bg-muted/50 px-3 py-1 rounded-full max-w-[90%]",children:Z.content}),Z.type==="error"&&e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30 px-3 py-1 rounded-full max-w-[90%]",children:Z.content}),Z.type==="thinking"&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Vn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:"flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",children:[e.jsx("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:e.jsx("span",{className:"hidden sm:inline",children:Z.sender?.name||h?.sessionInfo.bot_name})}),e.jsx("div",{className:"bg-muted rounded-2xl rounded-tl-sm px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"..."})]})})]})]}),(Z.type==="user"||Z.type==="bot")&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:F("text-xs",Z.type==="bot"?"bg-primary/10 text-primary":"bg-secondary text-secondary-foreground"),children:Z.type==="bot"?e.jsx(Vn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):e.jsx(jn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:F("flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",Z.type==="user"&&"items-end"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:Z.sender?.name||(Z.type==="bot"?h?.sessionInfo.bot_name:N)}),e.jsx("span",{children:ze(Z.timestamp)})]}),e.jsx("div",{className:F("rounded-2xl px-3 py-2 text-sm break-words",Z.type==="bot"?"bg-muted rounded-tl-sm":"bg-primary text-primary-foreground rounded-tr-sm"),children:e.jsx(AC,{message:Z,isBot:Z.type==="bot"})})]})]})]},Z.id)),e.jsx("div",{ref:ue})]})})}),e.jsx("div",{className:"shrink-0 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{value:f,onChange:Z=>p(Z.target.value),onKeyDown:Ue,placeholder:h?.isConnected?"...":"...",disabled:!h?.isConnected,className:"flex-1 h-10 sm:h-10"}),e.jsx(_,{onClick:se,disabled:!h?.isConnected||!f.trim(),size:"icon",className:"h-10 w-10 shrink-0",children:e.jsx(G_,{className:"h-4 w-4"})})]})})})]})}var kx="Radio",[RC,fN]=td(kx),[DC,OC]=RC(kx),pN=m.forwardRef((a,l)=>{const{__scopeRadio:r,name:c,checked:d=!1,required:u,disabled:h,value:f="on",onCheck:p,form:g,...b}=a,[j,y]=m.useState(null),N=ad(l,A=>y(A)),w=m.useRef(!1),M=j?g||!!j.closest("form"):!0;return e.jsxs(DC,{scope:r,checked:d,disabled:h,children:[e.jsx(Zn.button,{type:"button",role:"radio","aria-checked":d,"data-state":NN(d),"data-disabled":h?"":void 0,disabled:h,value:f,...b,ref:N,onClick:gn(a.onClick,A=>{d||p?.(),M&&(w.current=A.isPropagationStopped(),w.current||A.stopPropagation())})}),M&&e.jsx(vN,{control:j,bubbles:!w.current,name:c,value:f,checked:d,required:u,disabled:h,form:g,style:{transform:"translateX(-100%)"}})]})});pN.displayName=kx;var gN="RadioIndicator",jN=m.forwardRef((a,l)=>{const{__scopeRadio:r,forceMount:c,...d}=a,u=OC(gN,r);return e.jsx(o_,{present:c||u.checked,children:e.jsx(Zn.span,{"data-state":NN(u.checked),"data-disabled":u.disabled?"":void 0,...d,ref:l})})});jN.displayName=gN;var LC="RadioBubbleInput",vN=m.forwardRef(({__scopeRadio:a,control:l,checked:r,bubbles:c=!0,...d},u)=>{const h=m.useRef(null),f=ad(h,u),p=d_(r),g=u_(l);return m.useEffect(()=>{const b=h.current;if(!b)return;const j=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(j,"checked").set;if(p!==r&&N){const w=new Event("click",{bubbles:c});N.call(b,r),b.dispatchEvent(w)}},[p,r,c]),e.jsx(Zn.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...d,tabIndex:-1,ref:f,style:{...d.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});vN.displayName=LC;function NN(a){return a?"checked":"unchecked"}var UC=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],fd="RadioGroup",[$C]=td(fd,[Tj,fN]),bN=Tj(),yN=fN(),[BC,IC]=$C(fd),wN=m.forwardRef((a,l)=>{const{__scopeRadioGroup:r,name:c,defaultValue:d,value:u,required:h=!1,disabled:f=!1,orientation:p,dir:g,loop:b=!0,onValueChange:j,...y}=a,N=bN(r),w=qj(g),[M,A]=sd({prop:u,defaultProp:d??null,onChange:j,caller:fd});return e.jsx(BC,{scope:r,name:c,required:h,disabled:f,value:M,onValueChange:A,children:e.jsx(Sw,{asChild:!0,...N,orientation:p,dir:w,loop:b,children:e.jsx(Zn.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":f?"":void 0,dir:w,...y,ref:l})})})});wN.displayName=fd;var _N="RadioGroupItem",SN=m.forwardRef((a,l)=>{const{__scopeRadioGroup:r,disabled:c,...d}=a,u=IC(_N,r),h=u.disabled||c,f=bN(r),p=yN(r),g=m.useRef(null),b=ad(l,g),j=u.value===d.value,y=m.useRef(!1);return m.useEffect(()=>{const N=M=>{UC.includes(M.key)&&(y.current=!0)},w=()=>y.current=!1;return document.addEventListener("keydown",N),document.addEventListener("keyup",w),()=>{document.removeEventListener("keydown",N),document.removeEventListener("keyup",w)}},[]),e.jsx(kw,{asChild:!0,...f,focusable:!h,active:j,children:e.jsx(pN,{disabled:h,required:u.required,checked:j,...p,...d,name:u.name,ref:b,onCheck:()=>u.onValueChange(d.value),onKeyDown:gn(N=>{N.key==="Enter"&&N.preventDefault()}),onFocus:gn(d.onFocus,()=>{y.current&&g.current?.click()})})})});SN.displayName=_N;var PC="RadioGroupIndicator",kN=m.forwardRef((a,l)=>{const{__scopeRadioGroup:r,...c}=a,d=yN(r);return e.jsx(jN,{...d,...c,ref:l})});kN.displayName=PC;var CN=wN,TN=SN,FC=kN;const Cx=m.forwardRef(({className:a,...l},r)=>e.jsx(CN,{className:F("grid gap-2",a),...l,ref:r}));Cx.displayName=CN.displayName;const Xo=m.forwardRef(({className:a,...l},r)=>e.jsx(TN,{ref:r,className:F("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),...l,children:e.jsx(FC,{className:"flex items-center justify-center",children:e.jsx(Ho,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Xo.displayName=TN.displayName;function HC({question:a,value:l,onChange:r,error:c,disabled:d=!1}){const[u,h]=m.useState(null),f=d||a.readOnly,p=()=>{switch(a.type){case"single":return e.jsx(Cx,{value:l||"",onValueChange:r,disabled:f,className:"space-y-2",children:a.options?.map(g=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:g.value,id:`${a.id}-${g.id}`}),e.jsx(T,{htmlFor:`${a.id}-${g.id}`,className:"cursor-pointer font-normal",children:g.label})]},g.id))});case"multiple":{const g=l||[];return e.jsxs("div",{className:"space-y-2",children:[a.options?.map(b=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:`${a.id}-${b.id}`,checked:g.includes(b.value),disabled:f||a.maxSelections!==void 0&&g.length>=a.maxSelections&&!g.includes(b.value),onCheckedChange:j=>{r(j?[...g,b.value]:g.filter(y=>y!==b.value))}}),e.jsx(T,{htmlFor:`${a.id}-${b.id}`,className:"cursor-pointer font-normal",children:b.label})]},b.id)),a.maxSelections&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",a.maxSelections," "]})]})}case"text":return e.jsx(ae,{value:l||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,className:F(a.readOnly&&"bg-muted cursor-not-allowed")});case"textarea":return e.jsxs("div",{className:"space-y-1",children:[e.jsx(rt,{value:l||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,rows:4,className:F(a.readOnly&&"bg-muted cursor-not-allowed")}),a.maxLength&&e.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[(l||"").length," / ",a.maxLength]})]});case"rating":{const g=l||0,b=u!==null?u:g;return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(j=>e.jsx("button",{type:"button",disabled:f,className:F("p-1 transition-colors focus:outline-none focus:ring-2 focus:ring-ring rounded",f&&"cursor-not-allowed opacity-50"),onMouseEnter:()=>!f&&h(j),onMouseLeave:()=>h(null),onClick:()=>!f&&r(j),children:e.jsx(mn,{className:F("h-6 w-6 transition-colors",j<=b?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},j)),g>0&&e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:[g," / 5"]})]})}case"scale":{const g=a.min??1,b=a.max??10,j=a.step??1,y=l??g;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Qa,{value:[y],onValueChange:([N])=>r(N),min:g,max:b,step:j,disabled:f}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:a.minLabel||g}),e.jsx("span",{className:"font-medium text-foreground",children:y}),e.jsx("span",{children:a.maxLabel||b})]})]})}case"dropdown":return e.jsxs(Pe,{value:l||"",onValueChange:r,disabled:f,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:a.placeholder||"..."})}),e.jsx(Ie,{children:a.options?.map(g=>e.jsx(W,{value:g.value,children:g.label},g.id))})]});default:return e.jsx("div",{className:"text-muted-foreground",children:""})}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-base font-medium",children:[a.title,a.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),p(),c&&e.jsx("p",{className:"text-sm text-destructive",children:c})]})}const EN="https://maibot-plugin-stats.maibot-webui.workers.dev";function MN(){const a="maibot_user_id";let l=localStorage.getItem(a);if(!l){const r=Math.random().toString(36).substring(2,10),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,10);l=`fp_${r}_${c}_${d}`,localStorage.setItem(a,l)}return l}async function VC(a,l,r,c){try{const d=c?.userId||MN(),u={surveyId:a,surveyVersion:l,userId:d,answers:r,submittedAt:new Date().toISOString(),allowMultiple:c?.allowMultiple,metadata:{userAgent:navigator.userAgent,language:navigator.language}},h=await fetch(`${EN}/survey/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),f=await h.json();return h.status===429?{success:!1,error:""}:h.status===409?{success:!1,error:f.error||""}:h.ok?{success:!0,submissionId:f.submissionId,message:f.message}:{success:!1,error:f.error||""}}catch(d){return console.error("Error submitting survey:",d),{success:!1,error:""}}}async function GC(a,l){try{const r=l||MN(),c=new URLSearchParams({user_id:r,survey_id:a}),d=await fetch(`${EN}/survey/check?${c}`);return d.ok?{success:!0,hasSubmitted:(await d.json()).hasSubmitted}:{success:!1,error:(await d.json()).error||""}}catch(r){return console.error("Error checking submission:",r),{success:!1,error:""}}}function AN({config:a,initialAnswers:l,onSubmitSuccess:r,onSubmitError:c,showProgress:d=!0,paginateQuestions:u=!1,className:h}){const f=m.useCallback(()=>!l||l.length===0?{}:l.reduce(($,ue)=>($[ue.questionId]=ue.value,$),{}),[l]),[p,g]=m.useState(()=>f()),[b,j]=m.useState({}),[y,N]=m.useState(0),[w,M]=m.useState(!1),[A,S]=m.useState(!1),[U,E]=m.useState(null),[C,D]=m.useState(null),[P,O]=m.useState(!1),[J,L]=m.useState(!0);m.useEffect(()=>{l&&l.length>0&&g($=>({...$,...f()}))},[l,f]),m.useEffect(()=>{(async()=>{if(!a.settings?.allowMultiple){const ue=await GC(a.id);ue.success&&ue.hasSubmitted&&O(!0)}L(!1)})()},[a.id,a.settings?.allowMultiple]);const oe=m.useCallback(()=>{const $=new Date;return!(a.settings?.startTime&&new Date(a.settings.startTime)>$||a.settings?.endTime&&new Date(a.settings.endTime)<$)},[a.settings?.startTime,a.settings?.endTime]),Ne=a.questions.filter($=>{const ue=p[$.id];return ue==null?!1:Array.isArray(ue)?ue.length>0:typeof ue=="string"?ue.trim()!=="":!0}).length,je=Ne/a.questions.length*100,de=m.useCallback(($,ue)=>{g(G=>({...G,[$]:ue})),j(G=>{const Se={...G};return delete Se[$],Se})},[]),he=m.useCallback(()=>{const $={};for(const ue of a.questions){if(ue.required){const G=p[ue.id];if(G==null){$[ue.id]="";continue}if(Array.isArray(G)&&G.length===0){$[ue.id]="";continue}if(typeof G=="string"&&G.trim()===""){$[ue.id]="";continue}}ue.minLength&&typeof p[ue.id]=="string"&&p[ue.id].length<ue.minLength&&($[ue.id]=` ${ue.minLength} `)}return j($),Object.keys($).length===0},[a.questions,p]),ge=m.useCallback(async()=>{if(!he()){if(u){const $=a.questions.findIndex(ue=>b[ue.id]);$>=0&&N($)}return}M(!0),E(null);try{const $=a.questions.filter(G=>p[G.id]!==void 0).map(G=>({questionId:G.id,value:p[G.id]})),ue=await VC(a.id,a.version,$,{allowMultiple:a.settings?.allowMultiple});if(ue.success&&ue.submissionId)S(!0),D(ue.submissionId),r?.(ue.submissionId);else{const G=ue.error||"";E(G),c?.(G)}}catch($){const ue=$ instanceof Error?$.message:"";E(ue),c?.(ue)}finally{M(!1)}},[he,u,a,p,b,r,c]),R=m.useCallback($=>{$>=0&&$<a.questions.length&&N($)},[a.questions.length]);if(J)return e.jsx(ke,{className:F("w-full max-w-2xl mx-auto",h),children:e.jsx(Me,{className:"py-12 flex items-center justify-center",children:e.jsx(Os,{className:"h-6 w-6 animate-spin text-muted-foreground"})})});if(P&&!a.settings?.allowMultiple)return e.jsxs(ke,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(Re,{children:e.jsx(De,{children:a.title})}),e.jsx(Me,{className:"py-8",children:e.jsxs(it,{children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx(ct,{children:""})]})})]});if(!oe())return e.jsxs(ke,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(Re,{children:e.jsx(De,{children:a.title})}),e.jsx(Me,{className:"py-8",children:e.jsxs(it,{variant:"destructive",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx(ct,{children:""})]})})]});if(A)return e.jsxs(ke,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(Re,{children:e.jsxs(De,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(bt,{className:"h-6 w-6"}),""]})}),e.jsxs(Me,{className:"py-8",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:a.settings?.thankYouMessage||""}),C&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["",C]})]})]});const Q=u?[a.questions[y]]:a.questions;return e.jsxs("div",{className:F("h-full flex flex-col",h),children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 mb-4 shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:a.title}),a.description&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a.description}),d&&e.jsxs("div",{className:"space-y-1 pt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[Ne," / ",a.questions.length]})]}),e.jsx(Xn,{value:je,className:"h-2"})]})]}),e.jsx(Ze,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[Q.map(($,ue)=>e.jsxs("div",{className:F("p-4 rounded-lg border bg-card",b[$.id]?"border-destructive bg-destructive/5":"border-border"),children:[u&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[" ",y+1," / ",a.questions.length]}),!u&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[ue+1,"."]}),e.jsx(HC,{question:$,value:p[$.id],onChange:G=>de($.id,G),error:b[$.id],disabled:w})]},$.id)),U&&e.jsxs(it,{variant:"destructive",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx(ct,{children:U})]}),e.jsx("div",{className:"flex justify-between items-center py-4",children:u?e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"outline",onClick:()=>R(y-1),disabled:y===0||w,children:[e.jsx(Da,{className:"h-4 w-4 mr-1"}),""]}),y===a.questions.length-1?e.jsxs(_,{onClick:ge,disabled:w,children:[w&&e.jsx(Os,{className:"h-4 w-4 mr-2 animate-spin"}),""]}):e.jsxs(_,{onClick:()=>R(y+1),disabled:w,children:["",e.jsx(sa,{className:"h-4 w-4 ml-1"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Object.keys(b).length>0&&e.jsxs("span",{className:"text-destructive",children:[" ",Object.keys(b).length," "]})}),e.jsxs(_,{onClick:ge,disabled:w,size:"lg",children:[w&&e.jsx(Os,{className:"h-4 w-4 mr-2 animate-spin"}),""]})]})})]})})]})}const qC={id:"webui-feedback-v1",version:"1.0.0",title:" WebUI ",description:" WebUI",questions:[{id:"webui_version",type:"text",title:" WebUI ",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"ui_design_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"problems_encountered",type:"multiple",title:" WebUI ",description:"",required:!0,options:[{id:"lag",label:"",value:"lag"},{id:"incomplete",label:"",value:"incomplete"},{id:"complex",label:"",value:"complex"},{id:"bugs",label:" Bug",value:"bugs"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"useful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:" WebUI ",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}},KC={id:"maibot-feedback-v1",version:"1.0.0",title:"",description:" AI ",questions:[{id:"maibot_version",type:"text",title:"",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"improvement_areas",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"problems_encountered",type:"multiple",title:"",description:"",required:!0,options:[{id:"incomplete",label:"",value:"incomplete"},{id:"slow_response",label:"",value:"slow_response"},{id:"complex",label:"",value:"complex"},{id:"unstable",label:"",value:"unstable"},{id:"config_difficult",label:"",value:"config_difficult"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"helpful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:"",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:"",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}};function QC(){const[a,l]=m.useState(!0),r=m.useMemo(()=>JSON.parse(JSON.stringify(qC)),[]);m.useEffect(()=>{l(!1)},[]);const c=m.useMemo(()=>[{questionId:"webui_version",value:`v${od}`}],[]),d=m.useCallback(h=>{console.log("WebUI Survey submitted:",h)},[]),u=m.useCallback(h=>{console.error("WebUI Survey submission error:",h)},[]);return a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Os,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):r?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(dv,{className:"h-8 w-8",strokeWidth:2}),"WebUI "]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(AN,{config:r,initialAnswers:c,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:d,onSubmitError:u})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(it,{variant:"destructive",className:"max-w-md",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx(ct,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}function YC(){const[a,l]=m.useState(null),[r,c]=m.useState(!0),[d,u]=m.useState("");m.useEffect(()=>{(async()=>{try{const j=await $1();u(j.version||"")}catch(j){console.error("Failed to get MaiBot version:",j),u("")}const b=JSON.parse(JSON.stringify(KC));l(b),c(!1)})()},[]);const h=m.useMemo(()=>[{questionId:"maibot_version",value:d}],[d]),f=m.useCallback(g=>{console.log("MaiBot Survey submitted:",g)},[]),p=m.useCallback(g=>{console.error("MaiBot Survey submission error:",g)},[]);return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Os,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(dv,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" AI "})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(AN,{config:a,initialAnswers:h,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:f,onSubmitError:p})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(it,{variant:"destructive",className:"max-w-md",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx(ct,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}async function JC(a=2025){const l=await _e(`/api/webui/annual-report/full?year=${a}`);if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function XC(a,l){if(a.match(/^[a-z]+:\/\//i))return a;if(a.match(/^\/\//))return window.location.protocol+a;if(a.match(/^[a-z]+:/i))return a;const r=document.implementation.createHTMLDocument(),c=r.createElement("base"),d=r.createElement("a");return r.head.appendChild(c),r.body.appendChild(d),l&&(c.href=l),d.href=a,d.href}const ZC=(()=>{let a=0;const l=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(a+=1,`u${l()}${a}`)})();function pn(a){const l=[];for(let r=0,c=a.length;r<c;r++)l.push(a[r]);return l}let Pr=null;function zN(a={}){return Pr||(a.includeStyleProperties?(Pr=a.includeStyleProperties,Pr):(Pr=pn(window.getComputedStyle(document.documentElement)),Pr))}function Zo(a,l){const c=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(l);return c?parseFloat(c.replace("px","")):0}function WC(a){const l=Zo(a,"border-left-width"),r=Zo(a,"border-right-width");return a.clientWidth+l+r}function e3(a){const l=Zo(a,"border-top-width"),r=Zo(a,"border-bottom-width");return a.clientHeight+l+r}function RN(a,l={}){const r=l.width||WC(a),c=l.height||e3(a);return{width:r,height:c}}function s3(){let a,l;try{l=process}catch{}const r=l&&l.env?l.env.devicePixelRatio:null;return r&&(a=parseInt(r,10),Number.isNaN(a)&&(a=1)),a||window.devicePixelRatio||1}const Ca=16384;function t3(a){(a.width>Ca||a.height>Ca)&&(a.width>Ca&&a.height>Ca?a.width>a.height?(a.height*=Ca/a.width,a.width=Ca):(a.width*=Ca/a.height,a.height=Ca):a.width>Ca?(a.height*=Ca/a.width,a.width=Ca):(a.width*=Ca/a.height,a.height=Ca))}function Wo(a){return new Promise((l,r)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>l(c))})},c.onerror=r,c.crossOrigin="anonymous",c.decoding="async",c.src=a})}async function a3(a){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(a)).then(encodeURIComponent).then(l=>`data:image/svg+xml;charset=utf-8,${l}`)}async function l3(a,l,r){const c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg"),u=document.createElementNS(c,"foreignObject");return d.setAttribute("width",`${l}`),d.setAttribute("height",`${r}`),d.setAttribute("viewBox",`0 0 ${l} ${r}`),u.setAttribute("width","100%"),u.setAttribute("height","100%"),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("externalResourcesRequired","true"),d.appendChild(u),u.appendChild(a),a3(d)}const ga=(a,l)=>{if(a instanceof l)return!0;const r=Object.getPrototypeOf(a);return r===null?!1:r.constructor.name===l.name||ga(r,l)};function n3(a){const l=a.getPropertyValue("content");return`${a.cssText} content: '${l.replace(/'|"/g,"")}';`}function r3(a,l){return zN(l).map(r=>{const c=a.getPropertyValue(r),d=a.getPropertyPriority(r);return`${r}: ${c}${d?" !important":""};`}).join(" ")}function i3(a,l,r,c){const d=`.${a}:${l}`,u=r.cssText?n3(r):r3(r,c);return document.createTextNode(`${d}{${u}}`)}function ej(a,l,r,c){const d=window.getComputedStyle(a,r),u=d.getPropertyValue("content");if(u===""||u==="none")return;const h=ZC();try{l.className=`${l.className} ${h}`}catch{return}const f=document.createElement("style");f.appendChild(i3(h,r,d,c)),l.appendChild(f)}function c3(a,l,r){ej(a,l,":before",r),ej(a,l,":after",r)}const sj="application/font-woff",tj="image/jpeg",o3={woff:sj,woff2:sj,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:tj,jpeg:tj,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function d3(a){const l=/\.([^./]*?)$/g.exec(a);return l?l[1]:""}function Tx(a){const l=d3(a).toLowerCase();return o3[l]||""}function u3(a){return a.split(/,/)[1]}function ex(a){return a.search(/^(data:)/)!==-1}function m3(a,l){return`data:${l};base64,${a}`}async function DN(a,l,r){const c=await fetch(a,l);if(c.status===404)throw new Error(`Resource "${c.url}" not found`);const d=await c.blob();return new Promise((u,h)=>{const f=new FileReader;f.onerror=h,f.onloadend=()=>{try{u(r({res:c,result:f.result}))}catch(p){h(p)}},f.readAsDataURL(d)})}const Gm={};function x3(a,l,r){let c=a.replace(/\?.*/,"");return r&&(c=a),/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,"")),l?`[${l}]${c}`:c}async function Ex(a,l,r){const c=x3(a,l,r.includeQueryParams);if(Gm[c]!=null)return Gm[c];r.cacheBust&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());let d;try{const u=await DN(a,r.fetchRequestInit,({res:h,result:f})=>(l||(l=h.headers.get("Content-Type")||""),u3(f)));d=m3(u,l)}catch(u){d=r.imagePlaceholder||"";let h=`Failed to fetch resource: ${a}`;u&&(h=typeof u=="string"?u:u.message),h&&console.warn(h)}return Gm[c]=d,d}async function h3(a){const l=a.toDataURL();return l==="data:,"?a.cloneNode(!1):Wo(l)}async function f3(a,l){if(a.currentSrc){const u=document.createElement("canvas"),h=u.getContext("2d");u.width=a.clientWidth,u.height=a.clientHeight,h?.drawImage(a,0,0,u.width,u.height);const f=u.toDataURL();return Wo(f)}const r=a.poster,c=Tx(r),d=await Ex(r,c,l);return Wo(d)}async function p3(a,l){var r;try{if(!((r=a?.contentDocument)===null||r===void 0)&&r.body)return await pd(a.contentDocument.body,l,!0)}catch{}return a.cloneNode(!1)}async function g3(a,l){return ga(a,HTMLCanvasElement)?h3(a):ga(a,HTMLVideoElement)?f3(a,l):ga(a,HTMLIFrameElement)?p3(a,l):a.cloneNode(ON(a))}const j3=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SLOT",ON=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SVG";async function v3(a,l,r){var c,d;if(ON(l))return l;let u=[];return j3(a)&&a.assignedNodes?u=pn(a.assignedNodes()):ga(a,HTMLIFrameElement)&&(!((c=a.contentDocument)===null||c===void 0)&&c.body)?u=pn(a.contentDocument.body.childNodes):u=pn(((d=a.shadowRoot)!==null&&d!==void 0?d:a).childNodes),u.length===0||ga(a,HTMLVideoElement)||await u.reduce((h,f)=>h.then(()=>pd(f,r)).then(p=>{p&&l.appendChild(p)}),Promise.resolve()),l}function N3(a,l,r){const c=l.style;if(!c)return;const d=window.getComputedStyle(a);d.cssText?(c.cssText=d.cssText,c.transformOrigin=d.transformOrigin):zN(r).forEach(u=>{let h=d.getPropertyValue(u);u==="font-size"&&h.endsWith("px")&&(h=`${Math.floor(parseFloat(h.substring(0,h.length-2)))-.1}px`),ga(a,HTMLIFrameElement)&&u==="display"&&h==="inline"&&(h="block"),u==="d"&&l.getAttribute("d")&&(h=`path(${l.getAttribute("d")})`),c.setProperty(u,h,d.getPropertyPriority(u))})}function b3(a,l){ga(a,HTMLTextAreaElement)&&(l.innerHTML=a.value),ga(a,HTMLInputElement)&&l.setAttribute("value",a.value)}function y3(a,l){if(ga(a,HTMLSelectElement)){const c=Array.from(l.children).find(d=>a.value===d.getAttribute("value"));c&&c.setAttribute("selected","")}}function w3(a,l,r){return ga(l,Element)&&(N3(a,l,r),c3(a,l,r),b3(a,l),y3(a,l)),l}async function _3(a,l){const r=a.querySelectorAll?a.querySelectorAll("use"):[];if(r.length===0)return a;const c={};for(let u=0;u<r.length;u++){const f=r[u].getAttribute("xlink:href");if(f){const p=a.querySelector(f),g=document.querySelector(f);!p&&g&&!c[f]&&(c[f]=await pd(g,l,!0))}}const d=Object.values(c);if(d.length){const u="http://www.w3.org/1999/xhtml",h=document.createElementNS(u,"svg");h.setAttribute("xmlns",u),h.style.position="absolute",h.style.width="0",h.style.height="0",h.style.overflow="hidden",h.style.display="none";const f=document.createElementNS(u,"defs");h.appendChild(f);for(let p=0;p<d.length;p++)f.appendChild(d[p]);a.appendChild(h)}return a}async function pd(a,l,r){return!r&&l.filter&&!l.filter(a)?null:Promise.resolve(a).then(c=>g3(c,l)).then(c=>v3(a,c,l)).then(c=>w3(a,c,l)).then(c=>_3(c,l))}const LN=/url\((['"]?)([^'"]+?)\1\)/g,S3=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,k3=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function C3(a){const l=a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${l})(['"]?\\))`,"g")}function T3(a){const l=[];return a.replace(LN,(r,c,d)=>(l.push(d),r)),l.filter(r=>!ex(r))}async function E3(a,l,r,c,d){try{const u=r?XC(l,r):l,h=Tx(l);let f;return d||(f=await Ex(u,h,c)),a.replace(C3(l),`$1${f}$3`)}catch{}return a}function M3(a,{preferredFontFormat:l}){return l?a.replace(k3,r=>{for(;;){const[c,,d]=S3.exec(r)||[];if(!d)return"";if(d===l)return`src: ${c};`}}):a}function UN(a){return a.search(LN)!==-1}async function $N(a,l,r){if(!UN(a))return a;const c=M3(a,r);return T3(c).reduce((u,h)=>u.then(f=>E3(f,h,l,r)),Promise.resolve(c))}async function Fr(a,l,r){var c;const d=(c=l.style)===null||c===void 0?void 0:c.getPropertyValue(a);if(d){const u=await $N(d,null,r);return l.style.setProperty(a,u,l.style.getPropertyPriority(a)),!0}return!1}async function A3(a,l){await Fr("background",a,l)||await Fr("background-image",a,l),await Fr("mask",a,l)||await Fr("-webkit-mask",a,l)||await Fr("mask-image",a,l)||await Fr("-webkit-mask-image",a,l)}async function z3(a,l){const r=ga(a,HTMLImageElement);if(!(r&&!ex(a.src))&&!(ga(a,SVGImageElement)&&!ex(a.href.baseVal)))return;const c=r?a.src:a.href.baseVal,d=await Ex(c,Tx(c),l);await new Promise((u,h)=>{a.onload=u,a.onerror=l.onImageErrorHandler?(...p)=>{try{u(l.onImageErrorHandler(...p))}catch(g){h(g)}}:h;const f=a;f.decode&&(f.decode=u),f.loading==="lazy"&&(f.loading="eager"),r?(a.srcset="",a.src=d):a.href.baseVal=d})}async function R3(a,l){const c=pn(a.childNodes).map(d=>BN(d,l));await Promise.all(c).then(()=>a)}async function BN(a,l){ga(a,Element)&&(await A3(a,l),await z3(a,l),await R3(a,l))}function D3(a,l){const{style:r}=a;l.backgroundColor&&(r.backgroundColor=l.backgroundColor),l.width&&(r.width=`${l.width}px`),l.height&&(r.height=`${l.height}px`);const c=l.style;return c!=null&&Object.keys(c).forEach(d=>{r[d]=c[d]}),a}const aj={};async function lj(a){let l=aj[a];if(l!=null)return l;const c=await(await fetch(a)).text();return l={url:a,cssText:c},aj[a]=l,l}async function nj(a,l){let r=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,u=(r.match(/url\([^)]+\)/g)||[]).map(async h=>{let f=h.replace(c,"$1");return f.startsWith("https://")||(f=new URL(f,a.url).href),DN(f,l.fetchRequestInit,({result:p})=>(r=r.replace(h,`url(${p})`),[h,p]))});return Promise.all(u).then(()=>r)}function rj(a){if(a==null)return[];const l=[],r=/(\/\*[\s\S]*?\*\/)/gi;let c=a.replace(r,"");const d=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=d.exec(c);if(p===null)break;l.push(p[0])}c=c.replace(d,"");const u=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,h="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",f=new RegExp(h,"gi");for(;;){let p=u.exec(c);if(p===null){if(p=f.exec(c),p===null)break;u.lastIndex=f.lastIndex}else f.lastIndex=u.lastIndex;l.push(p[0])}return l}async function O3(a,l){const r=[],c=[];return a.forEach(d=>{if("cssRules"in d)try{pn(d.cssRules||[]).forEach((u,h)=>{if(u.type===CSSRule.IMPORT_RULE){let f=h+1;const p=u.href,g=lj(p).then(b=>nj(b,l)).then(b=>rj(b).forEach(j=>{try{d.insertRule(j,j.startsWith("@import")?f+=1:d.cssRules.length)}catch(y){console.error("Error inserting rule from remote css",{rule:j,error:y})}})).catch(b=>{console.error("Error loading remote css",b.toString())});c.push(g)}})}catch(u){const h=a.find(f=>f.href==null)||document.styleSheets[0];d.href!=null&&c.push(lj(d.href).then(f=>nj(f,l)).then(f=>rj(f).forEach(p=>{h.insertRule(p,h.cssRules.length)})).catch(f=>{console.error("Error loading remote stylesheet",f)})),console.error("Error inlining remote css file",u)}}),Promise.all(c).then(()=>(a.forEach(d=>{if("cssRules"in d)try{pn(d.cssRules||[]).forEach(u=>{r.push(u)})}catch(u){console.error(`Error while reading CSS rules from ${d.href}`,u)}}),r))}function L3(a){return a.filter(l=>l.type===CSSRule.FONT_FACE_RULE).filter(l=>UN(l.style.getPropertyValue("src")))}async function U3(a,l){if(a.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=pn(a.ownerDocument.styleSheets),c=await O3(r,l);return L3(c)}function IN(a){return a.trim().replace(/["']/g,"")}function $3(a){const l=new Set;function r(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(u=>{l.add(IN(u))}),Array.from(c.children).forEach(u=>{u instanceof HTMLElement&&r(u)})}return r(a),l}async function B3(a,l){const r=await U3(a,l),c=$3(a);return(await Promise.all(r.filter(u=>c.has(IN(u.style.fontFamily))).map(u=>{const h=u.parentStyleSheet?u.parentStyleSheet.href:null;return $N(u.cssText,h,l)}))).join(`
`)}async function I3(a,l){const r=l.fontEmbedCSS!=null?l.fontEmbedCSS:l.skipFonts?null:await B3(a,l);if(r){const c=document.createElement("style"),d=document.createTextNode(r);c.appendChild(d),a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}}async function P3(a,l={}){const{width:r,height:c}=RN(a,l),d=await pd(a,l,!0);return await I3(d,l),await BN(d,l),D3(d,l),await l3(d,r,c)}async function F3(a,l={}){const{width:r,height:c}=RN(a,l),d=await P3(a,l),u=await Wo(d),h=document.createElement("canvas"),f=h.getContext("2d"),p=l.pixelRatio||s3(),g=l.canvasWidth||r,b=l.canvasHeight||c;return h.width=g*p,h.height=b*p,l.skipAutoScale||t3(h),h.style.width=`${g}`,h.style.height=`${b}`,l.backgroundColor&&(f.fillStyle=l.backgroundColor,f.fillRect(0,0,h.width,h.height)),f.drawImage(u,0,0,h.width,h.height),h}async function H3(a,l={}){return(await F3(a,l)).toDataURL()}const Lo=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"];function V3(a){return a>=8760?"7x24":a>=5e3?"":a>=2e3?" 1000 ":a>=1e3?" 80 ":a>=500?" 100 ":a>=100?" 25 ":""}function G3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":""}function q3(a){const l=a/1e6;return l>=100?"":l>=50?"":l>=10?"":l>=1?"":""}function K3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":a>=10?"":""}function Q3(a){return a>=80?"":a>=60?"":a>=40?"":a>=20?"":""}function Y3(a){return a>=1e4?"":a>=5e3?"":a>=1e3?"":a>=500?"":a>=100?"":""}function J3(a){return a>=500?"":a>=200?"":a>=100?"":a>=50?"":a>=10?"":""}function X3(a){return a>=1?"":a>=.5?"":a>=.1?"":a>=.01?"":""}function Z3(a,l){return a>=100?"":a>=50?"":a>=20?`${l}`:a>=10?"":""}function W3(a,l){return a?l>=1e3?"":l>=500?"":l>=100?"":"":l<=10?"":l<=50?"":""}function e5(a){return a>=1e3?"":a>=500?"":a>=200?"":a>=100?"":a>=50?"":""}function s5(){const[a]=m.useState(2025),[l,r]=m.useState(null),[c,d]=m.useState(!0),[u,h]=m.useState(!1),[f,p]=m.useState(null),g=m.useRef(null),{toast:b}=Ws(),j=m.useCallback(async()=>{try{d(!0),p(null);const N=await JC(a);r(N)}catch(N){p(N instanceof Error?N:new Error(""))}finally{d(!1)}},[a]),y=m.useCallback(async()=>{if(!(!g.current||!l)){h(!0),b({title:"",description:"..."});try{const N=g.current,w=getComputedStyle(document.documentElement),M=w.getPropertyValue("--background").trim()?`hsl(${w.getPropertyValue("--background").trim()})`:document.documentElement.classList.contains("dark")?"#0a0a0a":"#ffffff",A=N.style.width,S=N.style.maxWidth;N.style.width="1024px",N.style.maxWidth="1024px";const U=await H3(N,{quality:1,pixelRatio:2,backgroundColor:M,cacheBust:!0,filter:C=>!(C instanceof HTMLElement&&C.hasAttribute("data-export-btn"))});N.style.width=A,N.style.maxWidth=S;const E=document.createElement("a");E.download=`${l.bot_name}_${l.year}_.png`,E.href=U,E.click(),b({title:"",description:""})}catch(N){console.error(":",N),b({title:"",description:"",variant:"destructive"})}finally{h(!1)}}},[l,b]);return m.useEffect(()=>{j()},[j]),c?e.jsx(t5,{}):f?e.jsxs("div",{className:"flex h-screen items-center justify-center text-red-500",children:[": ",f.message]}):l?e.jsx(Ze,{className:"h-[calc(100vh-4rem)]",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/50 p-4 md:p-8 print:p-0",ref:g,children:e.jsxs("div",{className:"mx-auto max-w-5xl space-y-8 print:space-y-4",children:[e.jsxs("header",{className:"relative overflow-hidden rounded-3xl bg-primary p-8 text-primary-foreground shadow-2xl print:rounded-none print:shadow-none",children:[e.jsx("div",{className:"absolute right-4 top-4 z-20 print:hidden","data-export-btn":!0,children:e.jsx(_,{variant:"secondary",size:"sm",onClick:y,disabled:u,className:"gap-2 bg-white/20 hover:bg-white/30 text-white border-white/30",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Os,{className:"h-4 w-4 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Wt,{className:"h-4 w-4"}),""]})})}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx(Vn,{className:"mb-4 h-16 w-16 animate-bounce"}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tighter sm:text-6xl",children:[l.bot_name," ",l.year," "]}),e.jsx("p",{className:"mt-4 max-w-2xl text-lg opacity-90",children:"  Connection & Growth"}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-sm opacity-75",children:[e.jsx(Go,{className:"h-4 w-4"}),e.jsxs("span",{children:[": ",l.generated_at]})]})]}),e.jsx("div",{className:"absolute -right-20 -top-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(na,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ta,{title:"",value:`${l.time_footprint.total_online_hours} `,description:V3(l.time_footprint.total_online_hours),icon:e.jsx(na,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:l.time_footprint.busiest_day||"N/A",description:e5(l.time_footprint.busiest_day_count),icon:e.jsx(Go,{className:"h-4 w-4"})}),e.jsx(Ta,{title:" (0-4)",value:`${l.time_footprint.midnight_chat_count} `,description:G3(l.time_footprint.midnight_chat_count),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:l.time_footprint.is_night_owl?"":"",description:W3(l.time_footprint.is_night_owl,l.time_footprint.midnight_chat_count),icon:l.time_footprint.is_night_owl?e.jsx(ec,{className:"h-4 w-4"}):e.jsx(lx,{className:"h-4 w-4"})})]}),e.jsxs(ke,{className:"overflow-hidden",children:[e.jsxs(Re,{children:[e.jsx(De,{children:"24"}),e.jsxs(is,{children:[l.bot_name,""]})]}),e.jsx(Me,{className:"h-[300px]",children:e.jsx(Aj,{width:"100%",height:"100%",children:e.jsxs(Uo,{data:l.time_footprint.hourly_distribution.map((N,w)=>({hour:`${w}`,count:N})),children:[e.jsx(Qi,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Yi,{dataKey:"hour"}),e.jsx(Hr,{}),e.jsx(zj,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},cursor:{fill:"transparent"}}),e.jsx(Ji,{dataKey:"count",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),l.time_footprint.first_message_time&&e.jsx(ke,{className:"bg-muted/30 border-dashed",children:e.jsxs(Me,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"2025"}),e.jsx("div",{className:"text-xl font-bold text-primary mb-1",children:l.time_footprint.first_message_time}),e.jsxs("p",{className:"text-lg",children:[e.jsx("span",{className:"font-semibold text-foreground",children:l.time_footprint.first_message_user})," ",e.jsxs("span",{className:"italic text-muted-foreground",children:['"',l.time_footprint.first_message_content,'"']})]})]})})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ic,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(Ta,{title:"",value:`${l.social_network.total_groups} `,description:`${l.bot_name}`,icon:e.jsx(ic,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:`${l.social_network.at_count+l.social_network.mentioned_count} `,description:"",icon:e.jsx(q_,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:l.social_network.longest_companion_user||"N/A",description:` ${l.social_network.longest_companion_days} `,icon:e.jsx(Xr,{className:"h-4 w-4 text-red-500"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsx(De,{children:" TOP5"})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:l.social_network.top_groups.length>0?l.social_network.top_groups.map((N,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{variant:w===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:w+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:N.group_name}),N.is_webui&&e.jsx(Ce,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[N.message_count," "]})]},N.group_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]}),e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsx(De,{children:" TOP5"})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:l.social_network.top_users.length>0?l.social_network.top_users.map((N,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{variant:w===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:w+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:N.user_nickname}),N.is_webui&&e.jsx(Ce,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[N.message_count," "]})]},N.user_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ox,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ta,{title:" Token ",value:(l.brain_power.total_tokens/1e6).toFixed(2)+" M",description:q3(l.brain_power.total_tokens),icon:e.jsx(el,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:`$${l.brain_power.total_cost.toFixed(2)}`,description:K3(l.brain_power.total_cost),icon:e.jsx("span",{className:"font-bold",children:"$"})}),e.jsx(Ta,{title:"",value:`${l.brain_power.silence_rate}%`,description:Q3(l.brain_power.silence_rate),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:l.brain_power.max_interest_value??"N/A",description:l.brain_power.max_interest_time?` ${l.brain_power.max_interest_time}`:"",icon:e.jsx(Xr,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(ke,{children:[e.jsx(Re,{children:e.jsx(De,{children:""})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:l.brain_power.model_distribution.slice(0,5).map((N,w)=>{const M=l.brain_power.model_distribution[0]?.count||1,A=Math.round(N.count/M*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:N.model}),e.jsxs("span",{className:"text-muted-foreground",children:[N.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${A}%`,backgroundColor:Lo[w%Lo.length]}})})]},N.model)})})})]}),l.brain_power.top_reply_models&&l.brain_power.top_reply_models.length>0&&e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:" TOP5"}),e.jsxs(is,{children:[l.bot_name,""]})]}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:l.brain_power.top_reply_models.map((N,w)=>{const M=l.brain_power.top_reply_models[0]?.count||1,A=Math.round(N.count/M*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:N.model}),e.jsxs("span",{className:"text-muted-foreground",children:[N.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${A}%`,backgroundColor:Lo[w%Lo.length]}})})]},N.model)})})})]}),l.brain_power.top_token_consumers&&l.brain_power.top_token_consumers.length>0&&e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:" TOP3"}),e.jsx(is,{children:" API "})]}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-6",children:l.brain_power.top_token_consumers.map(N=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsxs("span",{children:[" ",N.user_id]}),e.jsxs("span",{children:["$",N.cost.toFixed(2)]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-500",style:{width:`${N.cost/(l.brain_power.top_token_consumers[0]?.cost||1)*100}%`}})})]},N.user_id))})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(ke,{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20",children:[e.jsx(Re,{children:e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Me,{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-amber-600 dark:text-amber-400",children:["$",l.brain_power.most_expensive_cost.toFixed(4)]}),l.brain_power.most_expensive_time&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[" ",l.brain_power.most_expensive_time]}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:X3(l.brain_power.most_expensive_cost)})]})]}),e.jsxs(ke,{className:"bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-950/20 dark:to-blue-950/20",children:[e.jsx(Re,{children:e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Me,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:l.brain_power.avg_reasoning_length?.toFixed(0)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:l.brain_power.max_reasoning_length?.toLocaleString()||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]}),l.brain_power.max_reasoning_time&&e.jsxs("p",{className:"mt-4 text-center text-xs text-muted-foreground",children:[" ",l.brain_power.max_reasoning_time]})]})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ld,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),(l.expression_vibe.late_night_reply||l.expression_vibe.favorite_reply)&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[l.expression_vibe.late_night_reply&&e.jsxs(ke,{className:"bg-gradient-to-br from-indigo-50 to-violet-50 dark:from-indigo-950/20 dark:to-violet-950/20",children:[e.jsxs(Re,{children:[e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(is,{children:[" ",l.expression_vibe.late_night_reply.time,"",l.bot_name,"..."]})]}),e.jsxs(Me,{className:"text-center",children:[e.jsxs("p",{className:"text-lg italic text-muted-foreground",children:['"',l.expression_vibe.late_night_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:""})]})]}),l.expression_vibe.favorite_reply&&e.jsxs(ke,{className:"bg-gradient-to-br from-rose-50 to-pink-50 dark:from-rose-950/20 dark:to-pink-950/20",children:[e.jsxs(Re,{children:[e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(is,{children:[" ",l.expression_vibe.favorite_reply.count," "]})]}),e.jsxs(Me,{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-medium text-primary",children:['"',l.expression_vibe.favorite_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:Z3(l.expression_vibe.favorite_reply.count,l.bot_name)})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(ke,{className:"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/20 dark:to-purple-950/20",children:[e.jsxs(Re,{children:[e.jsx(De,{children:" TOP3"}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:l.expression_vibe.top_emojis&&l.expression_vibe.top_emojis.length>0?e.jsx("div",{className:"flex justify-center gap-4",children:l.expression_vibe.top_emojis.slice(0,3).map((N,w)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/api/webui/emoji/${N.id}/thumbnail?original=true`,alt:`TOP ${w+1}`,className:"h-24 w-24 rounded-lg object-cover shadow-md transition-transform hover:scale-105"}),e.jsx(Ce,{className:F("absolute -top-2 -right-2",w===0?"bg-yellow-500":w===1?"bg-gray-400":"bg-amber-700"),children:w+1})]}),e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[N.usage_count," "]})]},N.id))}):e.jsx("div",{className:"flex h-32 items-center justify-center text-muted-foreground",children:""})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsxs(is,{children:[l.bot_name,""]})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:l.expression_vibe.top_expressions.map((N,w)=>e.jsxs(Ce,{variant:"outline",className:F("px-3 py-1 text-sm",w===0&&"border-primary bg-primary/10 text-primary text-base px-4 py-2"),children:[N.style," (",N.count,")"]},N.style))})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ta,{title:"",value:`${l.expression_vibe.image_processed_count} `,description:Y3(l.expression_vibe.image_processed_count),icon:e.jsx(cx,{className:"h-4 w-4"})}),e.jsx(Ta,{title:"",value:`${l.expression_vibe.rejected_expression_count} `,description:J3(l.expression_vibe.rejected_expression_count),icon:e.jsx(el,{className:"h-4 w-4"})})]})]})]}),l.expression_vibe.action_types.length>0&&e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsxs(De,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:l.expression_vibe.action_types.map(N=>e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2",children:[e.jsx("span",{className:"font-medium text-primary",children:N.action}),e.jsxs(Ce,{variant:"secondary",children:[N.count," "]})]},N.action))})})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(K_,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(ke,{className:"col-span-1 md:col-span-2",children:[e.jsxs(Re,{children:[e.jsx(De,{children:'""'}),e.jsxs(is,{children:[" ",l.achievements.new_jargon_count," "]})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:l.achievements.sample_jargons.map(N=>e.jsxs("div",{className:"group relative rounded-lg border bg-card p-3 shadow-sm transition-all hover:shadow-md",children:[e.jsx("div",{className:"font-bold text-primary",children:N.content}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2 max-w-[200px]",children:N.meaning||""})]},N.content))})})]}),e.jsx(ke,{className:"flex flex-col justify-center items-center bg-primary text-primary-foreground",children:e.jsxs(Me,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Ra,{className:"h-12 w-12 mb-4 opacity-80"}),e.jsx("div",{className:"text-4xl font-bold mb-2",children:l.achievements.total_messages.toLocaleString()}),e.jsx("div",{className:"text-sm opacity-80",children:""}),e.jsxs("div",{className:"mt-4 text-xs opacity-60",children:[" ",l.achievements.total_replies.toLocaleString()," "]})]})})]})]}),e.jsxs("footer",{className:"mt-12 text-center text-muted-foreground",children:[e.jsx("p",{children:"MaiBot 2025 Annual Report"}),e.jsx("p",{className:"text-sm",children:"Generated with  by MaiBot Team"})]})]})})}):null}function Ta({title:a,value:l,description:r,icon:c}){return e.jsxs(ke,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(De,{className:"text-sm font-medium",children:a}),e.jsx("div",{className:"text-muted-foreground",children:c})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function t5(){return e.jsxs("div",{className:"container mx-auto space-y-8 p-8",children:[e.jsx(ws,{className:"h-64 w-full rounded-3xl"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((a,l)=>e.jsx(ws,{className:"h-32 w-full"},l))}),e.jsx(ws,{className:"h-96 w-full"})]})}var gd="DropdownMenu",[a5]=td(gd,[Ej]),oa=Ej(),[l5,PN]=a5(gd),FN=a=>{const{__scopeDropdownMenu:l,children:r,dir:c,open:d,defaultOpen:u,onOpenChange:h,modal:f=!0}=a,p=oa(l),g=m.useRef(null),[b,j]=sd({prop:d,defaultProp:u??!1,onChange:h,caller:gd});return e.jsx(l5,{scope:l,triggerId:Km(),triggerRef:g,contentId:Km(),open:b,onOpenChange:j,onOpenToggle:m.useCallback(()=>j(y=>!y),[j]),modal:f,children:e.jsx(Uw,{...p,open:b,onOpenChange:j,dir:c,modal:f,children:r})})};FN.displayName=gd;var HN="DropdownMenuTrigger",VN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,disabled:c=!1,...d}=a,u=PN(HN,r),h=oa(r);return e.jsx($w,{asChild:!0,...h,children:e.jsx(Zn.button,{type:"button",id:u.triggerId,"aria-haspopup":"menu","aria-expanded":u.open,"aria-controls":u.open?u.contentId:void 0,"data-state":u.open?"open":"closed","data-disabled":c?"":void 0,disabled:c,...d,ref:m_(l,u.triggerRef),onPointerDown:gn(a.onPointerDown,f=>{!c&&f.button===0&&f.ctrlKey===!1&&(u.onOpenToggle(),u.open||f.preventDefault())}),onKeyDown:gn(a.onKeyDown,f=>{c||(["Enter"," "].includes(f.key)&&u.onOpenToggle(),f.key==="ArrowDown"&&u.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});VN.displayName=HN;var n5="DropdownMenuPortal",GN=a=>{const{__scopeDropdownMenu:l,...r}=a,c=oa(l);return e.jsx(Ew,{...c,...r})};GN.displayName=n5;var qN="DropdownMenuContent",KN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=PN(qN,r),u=oa(r),h=m.useRef(!1);return e.jsx(Mw,{id:d.contentId,"aria-labelledby":d.triggerId,...u,...c,ref:l,onCloseAutoFocus:gn(a.onCloseAutoFocus,f=>{h.current||d.triggerRef.current?.focus(),h.current=!1,f.preventDefault()}),onInteractOutside:gn(a.onInteractOutside,f=>{const p=f.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,b=p.button===2||g;(!d.modal||b)&&(h.current=!0)}),style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});KN.displayName=qN;var r5="DropdownMenuGroup",i5=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Bw,{...d,...c,ref:l})});i5.displayName=r5;var c5="DropdownMenuLabel",QN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Ow,{...d,...c,ref:l})});QN.displayName=c5;var o5="DropdownMenuItem",YN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Aw,{...d,...c,ref:l})});YN.displayName=o5;var d5="DropdownMenuCheckboxItem",JN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(zw,{...d,...c,ref:l})});JN.displayName=d5;var u5="DropdownMenuRadioGroup",m5=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Iw,{...d,...c,ref:l})});m5.displayName=u5;var x5="DropdownMenuRadioItem",XN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Dw,{...d,...c,ref:l})});XN.displayName=x5;var h5="DropdownMenuItemIndicator",ZN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Rw,{...d,...c,ref:l})});ZN.displayName=h5;var f5="DropdownMenuSeparator",WN=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Lw,{...d,...c,ref:l})});WN.displayName=f5;var p5="DropdownMenuArrow",g5=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Pw,{...d,...c,ref:l})});g5.displayName=p5;var j5="DropdownMenuSubTrigger",eb=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Cw,{...d,...c,ref:l})});eb.displayName=j5;var v5="DropdownMenuSubContent",sb=m.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=oa(r);return e.jsx(Tw,{...d,...c,ref:l,style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});sb.displayName=v5;var N5=FN,b5=VN,y5=GN,tb=KN,ab=QN,lb=YN,nb=JN,rb=XN,ib=ZN,cb=WN,ob=eb,db=sb;const w5=N5,_5=b5,S5=m.forwardRef(({className:a,inset:l,children:r,...c},d)=>e.jsxs(ob,{ref:d,className:F("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",a),...c,children:[r,e.jsx(sa,{className:"ml-auto h-4 w-4"})]}));S5.displayName=ob.displayName;const k5=m.forwardRef(({className:a,...l},r)=>e.jsx(db,{ref:r,className:F("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l}));k5.displayName=db.displayName;const ub=m.forwardRef(({className:a,sideOffset:l=4,...r},c)=>e.jsx(y5,{children:e.jsx(tb,{ref:c,sideOffset:l,className:F("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}));ub.displayName=tb.displayName;const mb=m.forwardRef(({className:a,inset:l,...r},c)=>e.jsx(lb,{ref:c,className:F("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",a),...r}));mb.displayName=lb.displayName;const C5=m.forwardRef(({className:a,children:l,checked:r,...c},d)=>e.jsxs(nb,{ref:d,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ib,{children:e.jsx(Mt,{className:"h-4 w-4"})})}),l]}));C5.displayName=nb.displayName;const T5=m.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(rb,{ref:c,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ib,{children:e.jsx(Ho,{className:"h-2 w-2 fill-current"})})}),l]}));T5.displayName=rb.displayName;const E5=m.forwardRef(({className:a,inset:l,...r},c)=>e.jsx(ab,{ref:c,className:F("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",a),...r}));E5.displayName=ab.displayName;const M5=m.forwardRef(({className:a,...l},r)=>e.jsx(cb,{ref:r,className:F("-mx-1 my-1 h-px bg-muted",a),...l}));M5.displayName=cb.displayName;const qm=[{value:"created_at",label:"",icon:na},{value:"downloads",label:"",icon:Wt},{value:"likes",label:"",icon:Xr}];function A5(){const a=ca(),[l,r]=m.useState([]),[c,d]=m.useState(!0),[u,h]=m.useState(""),[f,p]=m.useState("downloads"),[g,b]=m.useState(1),[j,y]=m.useState(1),[N,w]=m.useState(0),[M,A]=m.useState(new Set),[S,U]=m.useState(new Set),E=Wv(),C=m.useCallback(async()=>{d(!0);try{const L=await n4({status:"approved",page:g,page_size:12,search:u||void 0,sort_by:f,sort_order:"desc"});r(L.packs),y(L.total_pages),w(L.total);const oe=new Set;for(const Ne of L.packs)await Zv(Ne.id,E)&&oe.add(Ne.id);A(oe)}catch(L){console.error(" Pack :",L),Xt({title:" Pack ",variant:"destructive"})}finally{d(!1)}},[g,u,f,E]);m.useEffect(()=>{C()},[C]);const D=L=>{L.preventDefault(),b(1),C()},P=async L=>{if(!S.has(L)){U(oe=>new Set(oe).add(L));try{const oe=await Xv(L,E);A(Ne=>{const je=new Set(Ne);return oe.liked?je.add(L):je.delete(L),je}),r(Ne=>Ne.map(je=>je.id===L?{...je,likes:oe.likes}:je))}catch(oe){console.error(":",oe),Xt({title:"",variant:"destructive"})}finally{U(oe=>{const Ne=new Set(oe);return Ne.delete(L),Ne})}}},O=L=>{a({to:"/config/pack-market/$packId",params:{packId:L}})},J=qm.find(L=>L.value===f)||qm[0];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ra,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" MaiBot"})]}),e.jsxs(_,{variant:"outline",onClick:C,disabled:c,className:"gap-2",children:[e.jsx(xt,{className:`h-4 w-4 ${c?"animate-spin":""}`}),""]})]})}),e.jsx(Ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("form",{onSubmit:D,className:"flex-1 min-w-[200px] max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(At,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"...",value:u,onChange:L=>h(L.target.value),className:"pl-10"})]})}),e.jsxs(w5,{children:[e.jsx(_5,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"min-w-[140px] gap-2",children:[e.jsx(Q_,{className:"w-4 h-4"}),J.label,e.jsx(za,{className:"w-4 h-4 ml-auto"})]})}),e.jsx(ub,{align:"end",children:qm.map(L=>e.jsxs(mb,{onClick:()=>{p(L.value),b(1)},children:[e.jsx(L.icon,{className:"w-4 h-4 mr-2"}),L.label]},L.value))})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",e.jsx("span",{className:"font-medium text-foreground",children:N})," "]}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((L,oe)=>e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(ws,{className:"h-6 w-3/4"}),e.jsx(ws,{className:"h-4 w-full mt-2"})]}),e.jsx(Me,{children:e.jsx(ws,{className:"h-20 w-full"})}),e.jsx(id,{children:e.jsx(ws,{className:"h-9 w-full"})})]},oe))}):l.length===0?e.jsx(ke,{className:"py-12",children:e.jsxs(Me,{className:"text-center text-muted-foreground",children:[e.jsx(ra,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:""}),e.jsx("p",{className:"mt-1",children:""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(L=>e.jsx(z5,{pack:L,liked:M.has(L.id),liking:S.has(L.id),onLike:()=>P(L.id),onView:()=>O(L.id)},L.id))}),j>1&&e.jsx(dx,{children:e.jsxs(ux,{children:[e.jsx(qn,{children:e.jsx(zv,{onClick:()=>b(L=>Math.max(1,L-1)),className:g===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:j},(L,oe)=>oe+1).filter(L=>L===1||L===j||Math.abs(L-g)<=1).map((L,oe,Ne)=>{const je=oe>0&&L-Ne[oe-1]>1;return e.jsxs(qn,{children:[je&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(pc,{onClick:()=>b(L),isActive:L===g,className:"cursor-pointer",children:L})]},L)}),e.jsx(qn,{children:e.jsx(Rv,{onClick:()=>b(L=>Math.min(j,L+1)),className:g===j?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})]})}function z5({pack:a,liked:l,liking:r,onLike:c,onView:d}){const u=h=>new Date(h).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(ke,{className:"flex flex-col hover:shadow-md transition-shadow",children:[e.jsxs(Re,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(De,{className:"text-lg line-clamp-1",children:a.name}),e.jsxs(Ce,{variant:"secondary",className:"text-xs",children:["v",a.version]})]}),e.jsx(is,{className:"line-clamp-2 min-h-[40px]",children:a.description})]}),e.jsxs(Me,{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(jn,{className:"w-3.5 h-3.5"}),a.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-3.5 h-3.5"}),u(a.created_at)]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Ll,{className:"w-3.5 h-3.5"}),a.provider_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Qn,{className:"w-3.5 h-3.5"}),a.model_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Yn,{className:"w-3.5 h-3.5"}),a.task_count]})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,3).map(h=>e.jsxs(Ce,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"w-2.5 h-2.5 mr-1"}),h]},h)),a.tags.length>3&&e.jsxs(Ce,{variant:"outline",className:"text-xs",children:["+",a.tags.length-3]})]})]}),e.jsx(id,{className:"pt-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"w-4 h-4"}),a.downloads]}),e.jsxs("button",{onClick:h=>{h.stopPropagation(),c()},disabled:r,className:`flex items-center gap-1 transition-colors ${l?"text-red-500":"hover:text-red-500"} ${r?"opacity-50":""}`,children:[e.jsx(Xr,{className:`w-4 h-4 ${l?"fill-current":""}`}),a.likes]})]}),e.jsx(_,{size:"sm",onClick:d,children:""})]})})]})}var al="Accordion",R5=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Mx,D5,O5]=x_(al),[jd]=td(al,[O5,Mj]),Ax=Mj(),xb=Ls.forwardRef((a,l)=>{const{type:r,...c}=a,d=c,u=c;return e.jsx(Mx.Provider,{scope:a.__scopeAccordion,children:r==="multiple"?e.jsx(B5,{...u,ref:l}):e.jsx($5,{...d,ref:l})})});xb.displayName=al;var[hb,L5]=jd(al),[fb,U5]=jd(al,{collapsible:!1}),$5=Ls.forwardRef((a,l)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},collapsible:u=!1,...h}=a,[f,p]=sd({prop:r,defaultProp:c??"",onChange:d,caller:al});return e.jsx(hb,{scope:a.__scopeAccordion,value:Ls.useMemo(()=>f?[f]:[],[f]),onItemOpen:p,onItemClose:Ls.useCallback(()=>u&&p(""),[u,p]),children:e.jsx(fb,{scope:a.__scopeAccordion,collapsible:u,children:e.jsx(pb,{...h,ref:l})})})}),B5=Ls.forwardRef((a,l)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},...u}=a,[h,f]=sd({prop:r,defaultProp:c??[],onChange:d,caller:al}),p=Ls.useCallback(b=>f((j=[])=>[...j,b]),[f]),g=Ls.useCallback(b=>f((j=[])=>j.filter(y=>y!==b)),[f]);return e.jsx(hb,{scope:a.__scopeAccordion,value:h,onItemOpen:p,onItemClose:g,children:e.jsx(fb,{scope:a.__scopeAccordion,collapsible:!0,children:e.jsx(pb,{...u,ref:l})})})}),[I5,vd]=jd(al),pb=Ls.forwardRef((a,l)=>{const{__scopeAccordion:r,disabled:c,dir:d,orientation:u="vertical",...h}=a,f=Ls.useRef(null),p=ad(f,l),g=D5(r),j=qj(d)==="ltr",y=gn(a.onKeyDown,N=>{if(!R5.includes(N.key))return;const w=N.target,M=g().filter(J=>!J.ref.current?.disabled),A=M.findIndex(J=>J.ref.current===w),S=M.length;if(A===-1)return;N.preventDefault();let U=A;const E=0,C=S-1,D=()=>{U=A+1,U>C&&(U=E)},P=()=>{U=A-1,U<E&&(U=C)};switch(N.key){case"Home":U=E;break;case"End":U=C;break;case"ArrowRight":u==="horizontal"&&(j?D():P());break;case"ArrowDown":u==="vertical"&&D();break;case"ArrowLeft":u==="horizontal"&&(j?P():D());break;case"ArrowUp":u==="vertical"&&P();break}const O=U%S;M[O].ref.current?.focus()});return e.jsx(I5,{scope:r,disabled:c,direction:d,orientation:u,children:e.jsx(Mx.Slot,{scope:r,children:e.jsx(Zn.div,{...h,"data-orientation":u,ref:p,onKeyDown:c?void 0:y})})})}),ed="AccordionItem",[P5,zx]=jd(ed),gb=Ls.forwardRef((a,l)=>{const{__scopeAccordion:r,value:c,...d}=a,u=vd(ed,r),h=L5(ed,r),f=Ax(r),p=Km(),g=c&&h.value.includes(c)||!1,b=u.disabled||a.disabled;return e.jsx(P5,{scope:r,open:g,disabled:b,triggerId:p,children:e.jsx(_j,{"data-orientation":u.orientation,"data-state":wb(g),...f,...d,ref:l,disabled:b,open:g,onOpenChange:j=>{j?h.onItemOpen(c):h.onItemClose(c)}})})});gb.displayName=ed;var jb="AccordionHeader",vb=Ls.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(al,r),u=zx(jb,r);return e.jsx(Zn.h3,{"data-orientation":d.orientation,"data-state":wb(u.open),"data-disabled":u.disabled?"":void 0,...c,ref:l})});vb.displayName=jb;var sx="AccordionTrigger",Nb=Ls.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(al,r),u=zx(sx,r),h=U5(sx,r),f=Ax(r);return e.jsx(Mx.ItemSlot,{scope:r,children:e.jsx(Fw,{"aria-disabled":u.open&&!h.collapsible||void 0,"data-orientation":d.orientation,id:u.triggerId,...f,...c,ref:l})})});Nb.displayName=sx;var bb="AccordionContent",yb=Ls.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(al,r),u=zx(bb,r),h=Ax(r);return e.jsx(Hw,{role:"region","aria-labelledby":u.triggerId,"data-orientation":d.orientation,...h,...c,ref:l,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...a.style}})});yb.displayName=bb;function wb(a){return a?"open":"closed"}var F5=xb,H5=gb,V5=vb,_b=Nb,Sb=yb;const G5=F5,kb=m.forwardRef(({className:a,...l},r)=>e.jsx(H5,{ref:r,className:F("border-b",a),...l}));kb.displayName="AccordionItem";const Cb=m.forwardRef(({className:a,children:l,...r},c)=>e.jsx(V5,{className:"flex",children:e.jsxs(_b,{ref:c,className:F("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...r,children:[l,e.jsx(za,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Cb.displayName=_b.displayName;const Tb=m.forwardRef(({className:a,children:l,...r},c)=>e.jsx(Sb,{ref:c,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:F("pb-4 pt-0",a),children:l})}));Tb.displayName=Sb.displayName;const q5={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""};function K5(){const{packId:a}=Rb.useParams(),l=ca(),[r,c]=m.useState(null),[d,u]=m.useState(!0),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[b,j]=m.useState(!1),[y,N]=m.useState(1),[w,M]=m.useState(null),[A,S]=m.useState(!1),[U,E]=m.useState(!1),[C,D]=m.useState({apply_providers:!0,apply_models:!0,apply_task_config:!0,task_mode:"append",selected_providers:void 0,selected_models:void 0,selected_tasks:void 0}),[P,O]=m.useState({}),[J,L]=m.useState({}),oe=Wv(),Ne=m.useCallback(async()=>{if(a){u(!0);try{const R=await r4(a);c(R);const Q=await Zv(a,oe);f(Q)}catch(R){console.error(" Pack :",R),Xt({title:"",variant:"destructive"})}finally{u(!1)}}},[a,oe]);m.useEffect(()=>{Ne()},[Ne]);const je=async()=>{if(!(!a||p)){g(!0);try{const R=await Xv(a,oe);f(R.liked),r&&c({...r,likes:R.likes})}catch(R){console.error(":",R),Xt({title:"",variant:"destructive"})}finally{g(!1)}}},de=async()=>{if(r){j(!0),N(1),S(!0);try{const R=await o4(r);M(R);const Q={};for(const ue of R.existing_providers)Q[ue.pack_provider.name]=ue.local_providers[0].name;O(Q);const $={};for(const ue of R.new_providers)$[ue.name]="";L($)}catch(R){console.error(":",R),Xt({title:"",variant:"destructive"}),j(!1)}finally{S(!1)}}},he=async()=>{if(r){if(C.apply_providers&&w){for(const R of w.new_providers)if(!J[R.name]){Xt({title:` "${R.name}"  API Key`,variant:"destructive"});return}}E(!0);try{await d4(r,C,P,J),await c4(r.id,oe),c({...r,downloads:r.downloads+1}),Xt({title:""}),j(!1)}catch(R){console.error(" Pack :",R),Xt({title:R instanceof Error?R.message:"",variant:"destructive"})}finally{E(!1)}}},ge=R=>new Date(R).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"});return d?e.jsx(Y5,{}):r?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>l({to:"/config/pack-market"}),className:"gap-2",children:[e.jsx(Ma,{className:"w-4 h-4"}),""]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ra,{className:"w-10 h-10 text-primary mt-1"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[r.name,e.jsxs(Ce,{variant:"secondary",children:["v",r.version]})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:r.description})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(jn,{className:"w-4 h-4"}),r.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-4 h-4"}),ge(r.created_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"w-4 h-4"}),r.downloads," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xr,{className:`w-4 h-4 ${h?"fill-red-500 text-red-500":""}`}),r.likes," "]})]}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map(R=>e.jsxs(Ce,{variant:"outline",children:[e.jsx(rd,{className:"w-3 h-3 mr-1"}),R]},R))})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsxs(_,{size:"lg",onClick:de,children:[e.jsx(Wt,{className:"w-4 h-4 mr-2"}),""]}),e.jsxs(_,{variant:"outline",onClick:je,disabled:p,className:h?"text-red-500 border-red-200":"",children:[e.jsx(Xr,{className:`w-4 h-4 mr-2 ${h?"fill-current":""}`}),h?"":""]})]})]}),e.jsx(Zt,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(ke,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Ll,{className:"w-8 h-8 text-blue-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.providers.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"API "})]})]})}),e.jsx(ke,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Qn,{className:"w-8 h-8 text-green-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.models.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})}),e.jsx(ke,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Yn,{className:"w-8 h-8 text-purple-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(r.task_config).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})})]}),e.jsxs(ea,{defaultValue:"providers",className:"space-y-4",children:[e.jsxs(Gt,{className:"w-full sm:w-auto grid grid-cols-3 sm:flex",children:[e.jsxs(Xe,{value:"providers",className:"gap-1 sm:gap-2",children:[e.jsx(Ll,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.providers.length,")"]})]}),e.jsxs(Xe,{value:"models",className:"gap-1 sm:gap-2",children:[e.jsx(Qn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.models.length,")"]})]}),e.jsxs(Xe,{value:"tasks",className:"gap-1 sm:gap-2",children:[e.jsx(Yn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",Object.keys(r.task_config).length,")"]})]})]}),e.jsx(vs,{value:"providers",children:e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:"API "}),e.jsx(is,{children:" API  API Key"})]}),e.jsx(Me,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{children:""}),e.jsx(ss,{children:"Base URL"}),e.jsx(ss,{children:""})]})}),e.jsx(Bl,{children:r.providers.map(R=>e.jsxs(ht,{children:[e.jsx(Ye,{className:"font-medium whitespace-nowrap",children:R.name}),e.jsx(Ye,{className:"text-muted-foreground font-mono text-sm max-w-[200px] truncate",children:R.base_url}),e.jsx(Ye,{children:e.jsx(Ce,{variant:"outline",children:R.client_type})})]},R.name))})]})})})]})}),e.jsx(vs,{value:"models",children:e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ul,{children:[e.jsx($l,{children:e.jsxs(ht,{children:[e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{children:""}),e.jsx(ss,{className:"text-right",children:" (/)"})]})}),e.jsx(Bl,{children:r.models.map(R=>e.jsxs(ht,{children:[e.jsx(Ye,{className:"font-medium whitespace-nowrap",children:R.name}),e.jsx(Ye,{className:"text-muted-foreground font-mono text-sm max-w-[150px] truncate",children:R.model_identifier}),e.jsx(Ye,{className:"whitespace-nowrap",children:R.api_provider}),e.jsxs(Ye,{className:"text-right text-muted-foreground whitespace-nowrap",children:["",R.price_in," / ",R.price_out]})]},R.name))})]})})})]})}),e.jsx(vs,{value:"tasks",children:e.jsxs(ke,{children:[e.jsxs(Re,{children:[e.jsx(De,{children:""}),e.jsx(is,{children:""})]}),e.jsx(Me,{children:e.jsx(G5,{type:"multiple",className:"w-full",children:Object.entries(r.task_config).map(([R,Q])=>e.jsxs(kb,{value:R,children:[e.jsx(Cb,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vn,{className:"w-4 h-4"}),q5[R]||R,e.jsxs(Ce,{variant:"secondary",className:"ml-2",children:[Q.model_list.length," "]})]})}),e.jsx(Tb,{children:e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.model_list.map($=>e.jsx(Ce,{variant:"outline",children:$},$))}),Q.temperature!==void 0&&e.jsxs("div",{className:"text-sm",children:["Temperature: ",e.jsx("span",{className:"font-mono",children:Q.temperature})]}),Q.max_tokens!==void 0&&e.jsxs("div",{className:"text-sm",children:["Max Tokens: ",e.jsx("span",{className:"font-mono",children:Q.max_tokens})]})]})})]},R))})})]})})]}),e.jsx(Q5,{open:b,onOpenChange:j,pack:r,step:y,setStep:N,conflicts:w,detectingConflicts:A,applying:U,options:C,setOptions:D,_providerMapping:P,_setProviderMapping:O,newProviderApiKeys:J,setNewProviderApiKeys:L,onApply:he})]})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ra,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-xl font-semibold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""}),e.jsxs(_,{className:"mt-4",onClick:()=>l({to:"/config/pack-market"}),children:[e.jsx(Ma,{className:"w-4 h-4 mr-2"}),""]})]})}function Q5({open:a,onOpenChange:l,pack:r,step:c,setStep:d,conflicts:u,detectingConflicts:h,applying:f,options:p,setOptions:g,_providerMapping:b,_setProviderMapping:j,newProviderApiKeys:y,setNewProviderApiKeys:N,onApply:w}){return e.jsx(Fs,{open:a,onOpenChange:l,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(ra,{className:"w-5 h-5"}),""]}),e.jsxs(Xs,{children:[" ",c," / ",3,"",c===1&&"",c===2&&"",c===3&&""]})]}),h?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Os,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"apply_providers",checked:p.apply_providers,onCheckedChange:A=>g({...p,apply_providers:A})}),e.jsxs(T,{htmlFor:"apply_providers",className:"flex items-center gap-2",children:[e.jsx(Ll,{className:"w-4 h-4"})," (",r.providers.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"apply_models",checked:p.apply_models,onCheckedChange:A=>g({...p,apply_models:A})}),e.jsxs(T,{htmlFor:"apply_models",className:"flex items-center gap-2",children:[e.jsx(Qn,{className:"w-4 h-4"})," (",r.models.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Js,{id:"apply_task_config",checked:p.apply_task_config,onCheckedChange:A=>g({...p,apply_task_config:A})}),e.jsxs(T,{htmlFor:"apply_task_config",className:"flex items-center gap-2",children:[e.jsx(Yn,{className:"w-4 h-4"})," (",Object.keys(r.task_config).length," )"]})]})]}),p.apply_task_config&&e.jsxs("div",{className:"pl-6 space-y-2 border-l-2 border-muted",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs(Cx,{value:p.task_mode,onValueChange:A=>g({...p,task_mode:A}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"append",id:"mode_append"}),e.jsx(T,{htmlFor:"mode_append",className:"font-normal",children:" - "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"replace",id:"mode_replace"}),e.jsx(T,{htmlFor:"mode_replace",className:"font-normal",children:" - "})]})]})]})]}),c===2&&u&&e.jsxs("div",{className:"space-y-4",children:[p.apply_providers&&u.existing_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(ct,{children:" URL "})]}),e.jsx("div",{className:"space-y-2",children:u.existing_providers.map(({pack_provider:A,local_providers:S})=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Mt,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"font-medium flex-shrink-0",children:A.name}),e.jsx(sa,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),S.length===1?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:S[0].name}),e.jsx(Ce,{variant:"outline",className:"ml-auto",children:"URL "})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{value:b[A.name]||S[0].name,onValueChange:U=>j({...b,[A.name]:U}),children:[e.jsx(Be,{className:"w-[200px]",children:e.jsx(Fe,{})}),e.jsx(Ie,{children:S.map(U=>e.jsx(W,{value:U.name,children:U.name},U.name))})]}),e.jsxs(Ce,{variant:"outline",className:"ml-auto",children:[S.length," "]})]})]},A.name))})]}),p.apply_providers&&u.new_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(it,{variant:"destructive",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(Gn,{children:" API Key"}),e.jsx(ct,{children:" API Key"})]}),e.jsx("div",{className:"space-y-4",children:u.new_providers.map(A=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(nx,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"font-medium",children:A.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",A.base_url,")"]})]}),e.jsx(ae,{type:"password",placeholder:` ${A.name}  API Key`,value:y[A.name]||"",onChange:S=>N({...y,[A.name]:S.target.value})})]},A.name))})]}),(!p.apply_providers||u.existing_providers.length===0&&u.new_providers.length===0)&&e.jsxs(it,{children:[e.jsx(Mt,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(ct,{children:""})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(it,{children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx(Gn,{children:""}),e.jsx(ct,{children:""})]}),e.jsxs("div",{className:"space-y-2",children:[p.apply_providers&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Mt,{className:"w-4 h-4 text-green-500"}),e.jsx(Ll,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.providers.length," "]})]}),p.apply_models&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Mt,{className:"w-4 h-4 text-green-500"}),e.jsx(Qn,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.models.length," "]})]}),p.apply_task_config&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Mt,{className:"w-4 h-4 text-green-500"}),e.jsx(Yn,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.task_mode==="append"?"":""," ",Object.keys(r.task_config).length," "]})]})]}),u&&u.new_providers.length>0&&e.jsxs(it,{variant:"destructive",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs(ct,{children:[" ",u.new_providers.length,"  API Key"]})]})]})]}),e.jsxs(nt,{className:"flex justify-between",children:[e.jsx("div",{children:c>1&&!h&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),disabled:f,children:""}),c<3?e.jsx(_,{onClick:()=>d(c+1),disabled:h,children:""}):e.jsxs(_,{onClick:w,disabled:f,children:[f&&e.jsx(Os,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})})}function Y5(){return e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Ze,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(ws,{className:"h-9 w-24"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ws,{className:"w-10 h-10"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(ws,{className:"h-8 w-2/3"}),e.jsx(ws,{className:"h-4 w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(ws,{className:"h-4 w-24"}),e.jsx(ws,{className:"h-4 w-32"}),e.jsx(ws,{className:"h-4 w-28"}),e.jsx(ws,{className:"h-4 w-20"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(ws,{className:"h-6 w-20"}),e.jsx(ws,{className:"h-6 w-24"}),e.jsx(ws,{className:"h-6 w-16"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsx(ws,{className:"h-10 w-full"}),e.jsx(ws,{className:"h-10 w-full"})]})]}),e.jsx(ws,{className:"h-px w-full"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(ws,{className:"h-24"}),e.jsx(ws,{className:"h-24"}),e.jsx(ws,{className:"h-24"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ws,{className:"h-10 w-32"}),e.jsx(ws,{className:"h-10 w-32"}),e.jsx(ws,{className:"h-10 w-32"})]}),e.jsx(ws,{className:"h-96 w-full"})]})]})})})}function J5(){const a=ca(),[l,r]=m.useState(!0);return m.useEffect(()=>{let c=!1;return(async()=>{try{const u=await cc();!c&&!u&&a({to:"/auth"})}catch{c||a({to:"/auth"})}finally{c||r(!1)}})(),()=>{c=!0}},[a]),{checking:l}}async function X5(){return await cc()}const Z5=Wr("pointer-events-none inline-flex select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono font-medium opacity-100",{variants:{size:{sm:"h-5 text-[10px]",default:"h-6 text-xs",lg:"h-7 text-sm"}},defaultVariants:{size:"default"}}),Eb=m.forwardRef(({className:a,size:l,abbrTitle:r,children:c,...d},u)=>e.jsx("kbd",{className:F(Z5({size:l,className:a})),ref:u,...d,children:r?e.jsx("abbr",{title:r,children:c}):c}));Eb.displayName="Kbd";const W5=[{icon:nd,title:"",description:"",path:"/",category:""},{icon:Ea,title:"",description:"",path:"/config/bot",category:""},{icon:Ll,title:"",description:"",path:"/config/modelProvider",category:""},{icon:uv,title:"",description:"",path:"/config/model",category:""},{icon:ld,title:"",description:"",path:"/resource/emoji",category:""},{icon:Ra,title:"",description:"",path:"/resource/expression",category:""},{icon:mv,title:"",description:"",path:"/resource/person",category:""},{icon:Jr,title:"",description:"",path:"/resource/jargon",category:""},{icon:Y_,title:"",description:"",path:"/statistics",category:""},{icon:ra,title:"",description:"",path:"/plugins",category:""},{icon:rx,title:"",description:"",path:"/logs",category:""},{icon:vn,title:"",description:"",path:"/settings",category:""}];function eT({open:a,onOpenChange:l}){const[r,c]=m.useState(""),[d,u]=m.useState(0),h=ca(),f=W5.filter(b=>b.title.toLowerCase().includes(r.toLowerCase())||b.description.toLowerCase().includes(r.toLowerCase())||b.category.toLowerCase().includes(r.toLowerCase())),p=m.useCallback(b=>{h({to:b}),l(!1),c(""),u(0)},[h,l]),g=m.useCallback(b=>{b.key==="ArrowDown"?(b.preventDefault(),u(j=>(j+1)%f.length)):b.key==="ArrowUp"?(b.preventDefault(),u(j=>(j-1+f.length)%f.length)):b.key==="Enter"&&f[d]&&(b.preventDefault(),p(f[d].path))},[f,d,p]);return e.jsx(Fs,{open:a,onOpenChange:l,children:e.jsxs(Us,{className:"max-w-2xl p-0 gap-0",children:[e.jsxs($s,{className:"px-4 pt-4 pb-0",children:[e.jsx(Bs,{className:"sr-only",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(At,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),e.jsx(ae,{value:r,onChange:b=>{c(b.target.value),u(0)},onKeyDown:g,placeholder:"...",className:"h-12 pl-11 text-base border-0 focus-visible:ring-0 shadow-none",autoFocus:!0})]})]}),e.jsx("div",{className:"border-t",children:e.jsx(Ze,{className:"h-[400px]",children:f.length>0?e.jsx("div",{className:"p-2",children:f.map((b,j)=>{const y=b.icon;return e.jsxs("button",{onClick:()=>p(b.path),onMouseEnter:()=>u(j),className:F("w-full flex items-center gap-3 px-3 py-2.5 rounded-md text-left transition-colors",j===d?"bg-accent text-accent-foreground":"hover:bg-accent/50"),children:[e.jsx(y,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:b.title}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:b.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1 bg-muted rounded",children:b.category})]},b.path)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(At,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?"":""})]})})}),e.jsx("div",{className:"border-t px-4 py-3 flex items-center justify-between text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Enter"}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Esc"}),""]})]})})]})})}function sT(){const a=window.location.protocol==="http:",l=window.location.hostname.toLowerCase(),r=l==="localhost"||l==="127.0.0.1"||l==="::1",c=sessionStorage.getItem("http-warning-dismissed")==="true",[d,u]=m.useState(a&&!r&&!c),[h,f]=m.useState(!1),p=()=>{f(!0),u(!1),sessionStorage.setItem("http-warning-dismissed","true")};return!d||h?null:e.jsx("div",{className:"relative bg-amber-500/10 border-b border-amber-500/20 backdrop-blur-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(It,{className:"h-5 w-5 text-amber-600 dark:text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-semibold",children:""})," ",e.jsx("strong",{children:"HTTP"}),"  MaiBot WebUI"]}),e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200 mt-1",children:" Token HTTPS "})]})]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:p,className:"h-8 w-8 text-amber-700 hover:text-amber-900 dark:text-amber-400 dark:hover:text-amber-200 flex-shrink-0","aria-label":"",children:e.jsx(Aa,{className:"h-4 w-4"})})]})})})}function tT(){const[a,l]=m.useState(0),[r,c]=m.useState(!1),d=m.useRef(null);m.useEffect(()=>{const g=b=>{const j=b.target;if(j.scrollHeight>j.clientHeight+100){d.current=j;const y=j.scrollTop,N=j.scrollHeight-j.clientHeight,w=N>0?y/N*100:0;l(w),c(y>300)}};return window.addEventListener("scroll",g,{capture:!0,passive:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})},[]);const u=()=>{d.current?.scrollTo({top:0,behavior:"smooth"})},h=18,f=2*Math.PI*h,p=f-a/100*f;return e.jsx("div",{className:F("fixed bottom-24 right-8 z-50 transition-all duration-500 ease-in-out transform",r?"translate-x-0 opacity-100":"translate-x-32 opacity-0 pointer-events-none"),children:e.jsxs(_,{variant:"outline",size:"icon",className:F("relative h-12 w-12 rounded-full shadow-xl","bg-background/80 backdrop-blur-md border-border/50","hover:bg-accent hover:scale-110 hover:shadow-2xl hover:border-primary/50","transition-all duration-300","group"),onClick:u,"aria-label":"",children:[e.jsxs("svg",{className:"absolute inset-0 h-full w-full -rotate-90 transform p-1",viewBox:"0 0 44 44",children:[e.jsx("circle",{className:"text-muted-foreground/10",strokeWidth:"3",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"}),e.jsx("circle",{className:"text-primary transition-all duration-100 ease-out",strokeWidth:"3",strokeDasharray:f,strokeDashoffset:p,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"})]}),e.jsx(J_,{className:"h-5 w-5 text-primary transition-transform duration-300 group-hover:-translate-y-1 group-hover:scale-110",strokeWidth:2.5}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})})}const aT=f_,lT=p_,nT=g_,Mb=m.forwardRef(({className:a,sideOffset:l=4,...r},c)=>e.jsx(h_,{children:e.jsx(Kj,{ref:c,sideOffset:l,className:F("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...r})}));Mb.displayName=Kj.displayName;function rT({children:a}){const{checking:l}=J5(),[r,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState(!1),{theme:b,setTheme:j}=hx(),y=X0();if(m.useEffect(()=>{if(r)g(!1);else{const S=setTimeout(()=>{g(!0)},350);return()=>clearTimeout(S)}},[r]),m.useEffect(()=>{const S=U=>{(U.metaKey||U.ctrlKey)&&U.key==="k"&&(U.preventDefault(),f(!0))};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[]),l)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-background",children:e.jsx("div",{className:"text-muted-foreground",children:"..."})});const N=[{title:"",items:[{icon:nd,label:"",path:"/"}]},{title:"",items:[{icon:Ea,label:"",path:"/config/bot"},{icon:Ll,label:"AI",path:"/config/modelProvider",tourId:"sidebar-model-provider"},{icon:uv,label:"",path:"/config/model",tourId:"sidebar-model-management"},{icon:kg,label:"",path:"/config/adapter"}]},{title:"",items:[{icon:ld,label:"",path:"/resource/emoji"},{icon:Ra,label:"",path:"/resource/expression"},{icon:Jr,label:"",path:"/resource/jargon"},{icon:mv,label:"",path:"/resource/person"},{icon:iv,label:"",path:"/resource/knowledge-graph"},{icon:Yr,label:"",path:"/resource/knowledge-base"}]},{title:"",items:[{icon:ra,label:"",path:"/plugins"},{icon:ov,label:"",path:"/config/pack-market"},{icon:kg,label:"",path:"/plugin-config"},{icon:rx,label:"",path:"/logs"},{icon:tx,label:"&",path:"/planner-monitor"},{icon:Ra,label:"",path:"/chat"}]},{title:"",items:[{icon:vn,label:"",path:"/settings"}]}],M=b==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":b,A=async()=>{await z1()};return e.jsx(aT,{delayDuration:300,children:e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsxs("aside",{className:F("fixed inset-y-0 left-0 z-50 flex flex-col border-r bg-card transition-all duration-300 lg:relative lg:z-0","w-64 lg:w-auto",r?"lg:w-64":"lg:w-16",d?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsx("div",{className:"flex h-16 items-center border-b px-4",children:e.jsxs("div",{className:F("relative flex items-center justify-center flex-1 transition-all overflow-hidden","lg:flex-1",!r&&"lg:flex-none lg:w-8"),children:[e.jsxs("div",{className:F("flex items-baseline gap-2",!r&&"lg:hidden"),children:[e.jsx("span",{className:"font-bold text-xl text-primary-gradient whitespace-nowrap",children:"MaiBot WebUI"}),e.jsx("span",{className:"text-xs text-primary/60 whitespace-nowrap",children:x2()})]}),!r&&e.jsx("span",{className:"hidden lg:block font-bold text-primary-gradient text-2xl",children:"M"})]})}),e.jsx(Ze,{className:F("flex-1 overflow-x-hidden",!r&&"lg:w-16"),children:e.jsx("nav",{className:F("p-4",!r&&"lg:p-2 lg:w-16"),children:e.jsx("ul",{className:F("space-y-6",!r&&"lg:space-y-3 lg:w-full"),children:N.map((S,U)=>e.jsxs("li",{children:[e.jsx("div",{className:F("px-3 h-[1.25rem]","mb-2",!r&&"lg:mb-1 lg:invisible"),children:e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground/60 whitespace-nowrap",children:S.title})}),!r&&U>0&&e.jsx("div",{className:"hidden lg:block mb-2 border-t border-border"}),e.jsx("ul",{className:"space-y-1",children:S.items.map(E=>{const C=y({to:E.path}),D=E.icon,P=e.jsxs(e.Fragment,{children:[C&&e.jsx("div",{className:"absolute left-0 top-1/2 h-8 w-1 -translate-y-1/2 rounded-r-full bg-primary transition-opacity duration-300"}),e.jsxs("div",{className:F("flex items-center transition-all duration-300",r?"gap-3":"gap-3 lg:gap-0"),children:[e.jsx(D,{className:F("h-5 w-5 flex-shrink-0",C&&"text-primary"),strokeWidth:2,fill:"none"}),e.jsx("span",{className:F("text-sm font-medium whitespace-nowrap transition-all duration-300",C&&"font-semibold",r?"opacity-100 max-w-[200px]":"opacity-100 max-w-[200px] lg:opacity-0 lg:max-w-0 lg:overflow-hidden"),children:E.label})]})]});return e.jsx("li",{className:"relative",children:e.jsxs(lT,{children:[e.jsx(nT,{asChild:!0,children:e.jsx(Fn,{to:E.path,"data-tour":E.tourId,className:F("relative flex items-center rounded-lg py-2 transition-all duration-300","hover:bg-accent hover:text-accent-foreground",C?"bg-accent text-foreground":"text-muted-foreground hover:text-foreground",r?"px-3":"px-3 lg:px-0 lg:justify-center lg:w-12 lg:mx-auto"),onClick:()=>u(!1),children:P})}),p&&e.jsx(Mb,{side:"right",className:"hidden lg:block",children:e.jsx("p",{children:E.label})})]})},E.path)})})]},S.title))})})})]}),d&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>u(!1)}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(sT,{}),e.jsxs("header",{className:"flex h-16 items-center justify-between border-b bg-card/80 backdrop-blur-md px-4 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u(!d),className:"rounded-lg p-2 hover:bg-accent lg:hidden",children:e.jsx(X_,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>c(!r),className:"hidden rounded-lg p-2 hover:bg-accent lg:block",title:r?"":"",children:e.jsx(Da,{className:F("h-5 w-5 transition-transform",!r&&"rotate-180")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fn,{to:"/annual-report",children:e.jsxs(_,{variant:"ghost",size:"sm",className:"gap-2 bg-gradient-to-r from-pink-500/10 to-purple-500/10 hover:from-pink-500/20 hover:to-purple-500/20 border border-pink-500/20",title:"",children:[e.jsx(Z_,{className:"h-4 w-4 text-pink-500"}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent font-medium",children:"2025 "})]})}),e.jsxs("button",{onClick:()=>f(!0),className:"relative hidden md:flex items-center w-64 h-9 pl-9 pr-16 bg-background/50 border rounded-md hover:bg-accent/50 transition-colors text-left",children:[e.jsx(At,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"..."}),e.jsxs(Eb,{size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2",children:[e.jsx("span",{className:"text-xs",children:""}),"K"]})]}),e.jsx(eT,{open:h,onOpenChange:f}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>window.open("https://docs.mai-mai.org","_blank"),className:"gap-2",title:"",children:[e.jsx(W_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx("button",{onClick:S=>{c2(M==="dark"?"light":"dark",j,S)},className:"rounded-lg p-2 hover:bg-accent",title:M==="dark"?"":"",children:M==="dark"?e.jsx(lx,{className:"h-5 w-5"}):e.jsx(ec,{className:"h-5 w-5"})}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:A,className:"gap-2",title:"",children:[e.jsx(e1,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden bg-background",children:a}),e.jsx(tT,{})]})]})})}function iT(a){const l=a.split(`
`).slice(1),r=[];for(const c of l){const d=c.trim();if(!d.startsWith("at "))continue;const u=d.match(/at\s+(?:(.+?)\s+\()?(.+?):(\d+):(\d+)\)?$/);u?r.push({functionName:u[1]||"<anonymous>",fileName:u[2],lineNumber:u[3],columnNumber:u[4],raw:d}):r.push({functionName:"<unknown>",fileName:"",lineNumber:"",columnNumber:"",raw:d})}return r}function cT({error:a,errorInfo:l}){const[r,c]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),p=a.stack?iT(a.stack):[],g=async()=>{const b=`
Error: ${a.name}
Message: ${a.message}

Stack Trace:
${a.stack||"No stack trace available"}

Component Stack:
${l?.componentStack||"No component stack available"}

URL: ${window.location.href}
User Agent: ${navigator.userAgent}
Time: ${new Date().toISOString()}
    `.trim();try{await navigator.clipboard.writeText(b),f(!0),setTimeout(()=>f(!1),2e3)}catch(j){console.error("Failed to copy:",j)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(it,{variant:"destructive",className:"border-red-500/50 bg-red-500/10",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs(ct,{className:"font-mono text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[a.name,":"]})," ",a.message]})]}),p.length>0&&e.jsxs(uc,{open:r,onOpenChange:c,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(s1,{className:"h-4 w-4"}),"Stack Trace (",p.length," frames)"]}),r?e.jsx(Qr,{className:"h-4 w-4"}):e.jsx(za,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(Ze,{className:"h-[280px] rounded-md border bg-muted/30",children:e.jsx("div",{className:"p-3 space-y-1",children:p.map((b,j)=>e.jsx("div",{className:"font-mono text-xs p-2 rounded hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"text-muted-foreground w-6 text-right flex-shrink-0",children:[j+1,"."]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-primary font-medium",children:b.functionName}),b.fileName&&e.jsxs("div",{className:"text-muted-foreground mt-0.5 break-all",children:[b.fileName,b.lineNumber&&e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:[":",b.lineNumber,":",b.columnNumber]})]})]})]})},j))})})})]}),l?.componentStack&&e.jsxs(uc,{open:d,onOpenChange:u,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(It,{className:"h-4 w-4"}),"Component Stack"]}),d?e.jsx(Qr,{className:"h-4 w-4"}):e.jsx(za,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(Ze,{className:"h-[200px] rounded-md border bg-muted/30",children:e.jsx("pre",{className:"p-3 font-mono text-xs whitespace-pre-wrap text-muted-foreground",children:l.componentStack})})})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:g,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"mr-2 h-4 w-4"}),""]})})]})}function Ab({error:a,errorInfo:l}){const r=()=>{window.location.href="/"},c=()=>{window.location.reload()};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(ke,{className:"w-full max-w-2xl shadow-lg",children:[e.jsxs(Re,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:e.jsx(It,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsx(De,{className:"text-2xl font-bold",children:""}),e.jsx(is,{className:"text-base mt-2",children:""})]}),e.jsxs(Me,{className:"space-y-4",children:[e.jsx(cT,{error:a,errorInfo:l}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[e.jsxs(_,{onClick:c,className:"flex-1",children:[e.jsx(xt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:r,variant:"outline",className:"flex-1",children:[e.jsx(nd,{className:"mr-2 h-4 w-4"}),""]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground pt-2",children:""})]})]})})}class oT extends m.Component{constructor(l){super(l),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(l){return{hasError:!0,error:l}}componentDidCatch(l,r){console.error("ErrorBoundary caught an error:",l,r),this.setState({errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError&&this.state.error?this.props.fallback?this.props.fallback:e.jsx(Ab,{error:this.state.error,errorInfo:this.state.errorInfo}):this.props.children}}function zb({error:a}){return e.jsx(Ab,{error:a,errorInfo:null})}const vc=Z0({component:()=>e.jsxs(e.Fragment,{children:[e.jsx(ij,{}),!1]}),beforeLoad:()=>{if(window.location.pathname==="/"&&!X5())throw ew({to:"/auth"})}}),dT=Zs({getParentRoute:()=>vc,path:"/auth",component:E2}),uT=Zs({getParentRoute:()=>vc,path:"/setup",component:G2}),ot=Zs({getParentRoute:()=>vc,id:"protected",component:()=>e.jsx(rT,{children:e.jsx(ij,{})}),errorComponent:({error:a})=>e.jsx(zb,{error:a})}),mT=Zs({getParentRoute:()=>ot,path:"/",component:l2}),xT=Zs({getParentRoute:()=>ot,path:"/config/bot",component:FS}),hT=Zs({getParentRoute:()=>ot,path:"/config/modelProvider",component:e4}),fT=Zs({getParentRoute:()=>ot,path:"/config/model",component:S4}),pT=Zs({getParentRoute:()=>ot,path:"/config/adapter",component:E4}),gT=Zs({getParentRoute:()=>ot,path:"/resource/emoji",component:Z4}),jT=Zs({getParentRoute:()=>ot,path:"/resource/expression",component:tk}),vT=Zs({getParentRoute:()=>ot,path:"/resource/person",component:kk}),NT=Zs({getParentRoute:()=>ot,path:"/resource/jargon",component:pk}),bT=Zs({getParentRoute:()=>ot,path:"/resource/knowledge-graph",component:Ok}),yT=Zs({getParentRoute:()=>ot,path:"/resource/knowledge-base",component:Lk}),wT=Zs({getParentRoute:()=>ot,path:"/logs",component:$k}),_T=Zs({getParentRoute:()=>ot,path:"/planner-monitor",component:Kk}),ST=Zs({getParentRoute:()=>ot,path:"/chat",component:zC}),kT=Zs({getParentRoute:()=>ot,path:"/plugins",component:xC}),CT=Zs({getParentRoute:()=>ot,path:"/plugin-detail",component:wC}),TT=Zs({getParentRoute:()=>ot,path:"/model-presets",component:fC}),ET=Zs({getParentRoute:()=>ot,path:"/plugin-config",component:jC}),MT=Zs({getParentRoute:()=>ot,path:"/plugin-mirrors",component:NC}),AT=Zs({getParentRoute:()=>ot,path:"/settings",component:y2}),zT=Zs({getParentRoute:()=>ot,path:"/config/pack-market",component:A5}),Rb=Zs({getParentRoute:()=>ot,path:"/config/pack-market/$packId",component:K5}),RT=Zs({getParentRoute:()=>ot,path:"/survey/webui-feedback",component:QC}),DT=Zs({getParentRoute:()=>ot,path:"/survey/maibot-feedback",component:YC}),OT=Zs({getParentRoute:()=>ot,path:"/annual-report",component:s5}),LT=Zs({getParentRoute:()=>vc,path:"*",component:Pv}),UT=vc.addChildren([dT,uT,ot.addChildren([mT,xT,hT,fT,pT,gT,jT,NT,vT,bT,yT,kT,CT,TT,ET,MT,wT,_T,ST,AT,zT,Rb,RT,DT,OT]),LT]),$T=W0({routeTree:UT,defaultNotFoundComponent:Pv,defaultErrorComponent:({error:a})=>e.jsx(zb,{error:a})});function BT({children:a,defaultTheme:l="system",storageKey:r="ui-theme",...c}){const[d,u]=m.useState(()=>localStorage.getItem(r)||l);m.useEffect(()=>{const f=window.document.documentElement;if(f.classList.remove("light","dark"),d==="system"){const p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";f.classList.add(p);return}f.classList.add(d)},[d]),m.useEffect(()=>{const f=localStorage.getItem("accent-color");if(f){const p=document.documentElement,b={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[f];b&&(p.style.setProperty("--primary",b.hsl),b.gradient?(p.style.setProperty("--primary-gradient",b.gradient),p.classList.add("has-gradient")):(p.style.removeProperty("--primary-gradient"),p.classList.remove("has-gradient")))}},[]);const h={theme:d,setTheme:f=>{localStorage.setItem(r,f),u(f)}};return e.jsx(Lv.Provider,{...c,value:h,children:a})}function IT({children:a,defaultEnabled:l=!0,defaultWavesEnabled:r=!0,storageKey:c="enable-animations",wavesStorageKey:d="enable-waves-background"}){const[u,h]=m.useState(()=>{const b=localStorage.getItem(c);return b!==null?b==="true":l}),[f,p]=m.useState(()=>{const b=localStorage.getItem(d);return b!==null?b==="true":r});m.useEffect(()=>{const b=document.documentElement;u?b.classList.remove("no-animations"):b.classList.add("no-animations"),localStorage.setItem(c,String(u))},[u,c]),m.useEffect(()=>{localStorage.setItem(d,String(f))},[f,d]);const g={enableAnimations:u,setEnableAnimations:h,enableWavesBackground:f,setEnableWavesBackground:p};return e.jsx(Uv.Provider,{value:g,children:a})}const PT=j_,Db=m.forwardRef(({className:a,...l},r)=>e.jsx(Qj,{ref:r,className:F("fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:max-w-[420px] gap-2",a),...l}));Db.displayName=Qj.displayName;const FT=Wr("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-slide-in-from-right data-[state=open]:animate-fade-in data-[state=closed]:animate-slide-out-to-right data-[state=closed]:animate-fade-out data-[swipe=end]:animate-slide-out-to-right",{variants:{variant:{default:"border bg-primary/5 text-foreground backdrop-blur-sm",destructive:"destructive group border-destructive bg-destructive/10 text-destructive-foreground backdrop-blur-sm"}},defaultVariants:{variant:"default"}}),Ob=m.forwardRef(({className:a,variant:l,...r},c)=>e.jsx(Yj,{ref:c,className:F(FT({variant:l}),a),...r}));Ob.displayName=Yj.displayName;const HT=m.forwardRef(({className:a,...l},r)=>e.jsx(Jj,{ref:r,className:F("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...l}));HT.displayName=Jj.displayName;const Lb=m.forwardRef(({className:a,...l},r)=>e.jsx(Xj,{ref:r,className:F("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...l,children:e.jsx(Aa,{className:"h-4 w-4"})}));Lb.displayName=Xj.displayName;const Ub=m.forwardRef(({className:a,...l},r)=>e.jsx(Zj,{ref:r,className:F("text-sm font-semibold [&+div]:text-xs",a),...l}));Ub.displayName=Zj.displayName;const $b=m.forwardRef(({className:a,...l},r)=>e.jsx(Wj,{ref:r,className:F("text-sm opacity-90",a),...l}));$b.displayName=Wj.displayName;function VT(){const{toasts:a}=Ws();return e.jsxs(PT,{children:[a.map(function({id:l,title:r,description:c,action:d,...u}){return e.jsxs(Ob,{...u,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Ub,{children:r}),c&&e.jsx($b,{children:c})]}),d,e.jsx(Lb,{})]},l)}),e.jsx(Db,{})]})}A1.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(oT,{children:e.jsx(BT,{defaultTheme:"system",children:e.jsx(IT,{children:e.jsxs(QS,{children:[e.jsx(sw,{router:$T}),e.jsx(XS,{}),e.jsx(VT,{})]})})})})}));
