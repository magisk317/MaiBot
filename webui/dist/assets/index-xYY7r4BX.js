import{r as m,j as e,L as Un,e as ia,R as zs,b as f0,f as p0,g as g0,h as j0,k as v0,l as qs,m as N0,n as b0,O as Lg,o as y0}from"./router-9vIXuQkh.js";import{a as w0,b as _0,g as S0}from"./react-vendor-BmxF9s7Q.js";import{N as k0,c as C0,O as qr,P as T0,g as vm}from"./utils-BqoaXoQ1.js";import{L as Ug,T as $g,C as Bg,R as E0,a as Ig,V as M0,b as A0,S as Pg,c as z0,d as Hg,I as O0,e as Fg,f as D0,g as Gg,h as R0,i as L0,j as U0,O as Vg,P as $0,k as qg,l as Kg,D as Qg,A as Yg,m as Jg,n as B0,o as I0,p as Xg,q as P0,r as Zg,s as H0,t as F0,u as Wg,v as G0,w as V0,x as ej,y as sj,F as tj,z as aj,B as q0,E as K0,G as lj,H as Q0,J as Y0,K as J0,M as X0,N as Z0,Q as W0,U as ew,W as sw,X as tw,Y as aw,Z as lw,_ as nw,$ as rw,a0 as iw,a1 as cw,a2 as nj,a3 as ow,a4 as dw}from"./radix-extra-CTMrA3du.js";import{R as rj,T as ij,L as uw,g as mw,C as Pi,X as Hi,Y as Rr,h as xw,B as Eo,j as Fi,P as hw,k as fw,l as pw}from"./charts-simvewUa.js";import{S as gw,H as cj,O as oj,o as jw,C as dj,p as vw,T as uj,D as mj,R as Nw,q as bw,I as xj,J as yw,K as hj,L as fj,M as ww,N as pj,V as _w,Q as gj,U as jj,X as Sw,Y as kw,Z as vj,_ as Cw,$ as Tw,a0 as Nj,a1 as Ew,e as bj,f as qo,c as Ko,P as qn,d as Qo,b as mn,h as Mw,l as Aw,m as zw,u as Lm,r as Ow,a as Dw,a2 as Rw,a3 as yj,a4 as Lw,a5 as Uw,a6 as $w,a7 as wj,a8 as _j,a9 as Sj,aa as kj,ab as Cj,ac as Tj,ad as Bw}from"./radix-core-BdJoVJLV.js";import{R as ft,a as Xi,C as St,b as Wt,L as Ls,P as cc,Z as Xa,F as ka,c as Iw,S as xn,d as Pw,M as Ea,A as Gm,D as Hw,e as Pr,f as Ca,T as Vm,X as Ma,g as Fw,h as Ej,I as Pt,i as Yt,j as _t,k as Ro,E as Zi,l as na,m as Wi,H as Gw,n as ns,o as Zt,U as ec,p as qm,q as Ki,r as lg,K as Km,s as Mj,t as Vw,u as Mo,v as qw,B as $r,w as In,x as Yo,y as Kw,z as Qw,G as Dt,J as Jo,N as Ta,O as Zs,Q as Aa,V as Hr,W as Qm,Y as Aj,_ as oc,$ as zj,a0 as Oj,a1 as Pn,a2 as hn,a3 as Va,a4 as sa,a5 as fn,a6 as Ym,a7 as Dj,a8 as la,a9 as zl,aa as Hn,ab as Fn,ac as Xo,ad as Yw,ae as Jw,af as Xw,ag as Jm,ah as Ao,ai as Gn,aj as Zw,ak as Fr,al as Lo,am as Ww,an as Uo,ao as sc,ap as Rj,aq as e_,ar as s_,as as $o,at as t_,au as Xm,av as a_,aw as ng,ax as l_,ay as n_,az as Lj,aA as r_,aB as cn,aC as Uj,aD as Nm,aE as rg,aF as i_,aG as bm,aH as c_,aI as o_,aJ as d_,aK as u_,aL as $j,aM as m_,aN as Gr,aO as x_,aP as h_,aQ as Bj,aR as Ij,aS as f_,aT as p_,aU as ig,aV as g_,aW as j_,aX as v_,aY as N_,aZ as b_}from"./icons-CPi42lhj.js";import{S as y_,p as w_,j as __,a as S_,E as cg,R as k_,o as C_}from"./codemirror-TZqPU532.js";import{u as Pj,a as Bo,s as Hj,K as Fj,P as Gj,b as Vj,D as qj,c as Kj,S as Qj,v as T_,d as Yj,C as Jj,h as E_}from"./dnd-BiPfFtVp.js";import{_ as pa,c as M_,g as Xj,D as A_,z as ko}from"./misc-CDy9pI_Y.js";import{D as z_,U as O_}from"./uppy-x-2TBvZ1.js";import{M as D_,r as R_,a as L_,b as U_}from"./markdown-CKA5gBQ9.js";import{c as $_,H as Io,P as Po,u as B_,d as I_,R as P_,B as H_,e as F_,C as G_,M as V_,f as q_}from"./reactflow-DtsZHOR4.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const x of u)if(x.type==="childList")for(const h of x.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function i(u){const x={};return u.integrity&&(x.integrity=u.integrity),u.referrerPolicy&&(x.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?x.credentials="include":u.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function c(u){if(u.ep)return;u.ep=!0;const x=i(u);fetch(u.href,x)}})();var ym={exports:{}},$i={},wm={exports:{}},_m={};var og;function K_(){return og||(og=1,(function(l){function n(z,Q){var I=z.length;z.push(Q);e:for(;0<I;){var L=I-1>>>1,B=z[L];if(0<u(B,Q))z[L]=Q,z[I]=B,I=L;else break e}}function i(z){return z.length===0?null:z[0]}function c(z){if(z.length===0)return null;var Q=z[0],I=z.pop();if(I!==Q){z[0]=I;e:for(var L=0,B=z.length,_e=B>>>1;L<_e;){var je=2*(L+1)-1,Ce=z[je],K=je+1,U=z[K];if(0>u(Ce,I))K<B&&0>u(U,Ce)?(z[L]=U,z[K]=I,L=K):(z[L]=Ce,z[je]=I,L=je);else if(K<B&&0>u(U,I))z[L]=U,z[K]=I,L=K;else break e}}return Q}function u(z,Q){var I=z.sortIndex-Q.sortIndex;return I!==0?I:z.id-Q.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var x=performance;l.unstable_now=function(){return x.now()}}else{var h=Date,f=h.now();l.unstable_now=function(){return h.now()-f}}var p=[],g=[],N=1,v=null,y=3,w=!1,b=!1,O=!1,A=!1,_=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(z){for(var Q=i(g);Q!==null;){if(Q.callback===null)c(g);else if(Q.startTime<=z)c(g),Q.sortIndex=Q.expirationTime,n(p,Q);else break;Q=i(g)}}function M(z){if(O=!1,C(z),!b)if(i(p)!==null)b=!0,G||(G=!0,ve());else{var Q=i(g);Q!==null&&fe(M,Q.startTime-z)}}var G=!1,D=-1,ee=5,R=-1;function me(){return A?!0:!(l.unstable_now()-R<ee)}function ce(){if(A=!1,G){var z=l.unstable_now();R=z;var Q=!0;try{e:{b=!1,O&&(O=!1,H(D),D=-1),w=!0;var I=y;try{s:{for(C(z),v=i(p);v!==null&&!(v.expirationTime>z&&me());){var L=v.callback;if(typeof L=="function"){v.callback=null,y=v.priorityLevel;var B=L(v.expirationTime<=z);if(z=l.unstable_now(),typeof B=="function"){v.callback=B,C(z),Q=!0;break s}v===i(p)&&c(p),C(z)}else c(p);v=i(p)}if(v!==null)Q=!0;else{var _e=i(g);_e!==null&&fe(M,_e.startTime-z),Q=!1}}break e}finally{v=null,y=I,w=!1}Q=void 0}}finally{Q?ve():G=!1}}}var ve;if(typeof E=="function")ve=function(){E(ce)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ge=se.port2;se.port1.onmessage=ce,ve=function(){ge.postMessage(null)}}else ve=function(){_(ce,0)};function fe(z,Q){D=_(function(){z(l.unstable_now())},Q)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(z){z.callback=null},l.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<z?Math.floor(1e3/z):5},l.unstable_getCurrentPriorityLevel=function(){return y},l.unstable_next=function(z){switch(y){case 1:case 2:case 3:var Q=3;break;default:Q=y}var I=y;y=Q;try{return z()}finally{y=I}},l.unstable_requestPaint=function(){A=!0},l.unstable_runWithPriority=function(z,Q){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var I=y;y=z;try{return Q()}finally{y=I}},l.unstable_scheduleCallback=function(z,Q,I){var L=l.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?L+I:L):I=L,z){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=I+B,z={id:N++,callback:Q,priorityLevel:z,startTime:I,expirationTime:B,sortIndex:-1},I>L?(z.sortIndex=I,n(g,z),i(p)===null&&z===i(g)&&(O?(H(D),D=-1):O=!0,fe(M,I-L))):(z.sortIndex=B,n(p,z),b||w||(b=!0,G||(G=!0,ve()))),z},l.unstable_shouldYield=me,l.unstable_wrapCallback=function(z){var Q=y;return function(){var I=y;y=Q;try{return z.apply(this,arguments)}finally{y=I}}}})(_m)),_m}var dg;function Q_(){return dg||(dg=1,wm.exports=K_()),wm.exports}var ug;function Y_(){if(ug)return $i;ug=1;var l=Q_(),n=w0(),i=_0();function c(s){var t="https://react.dev/errors/"+s;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+s+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function x(s){var t=s,a=s;if(s.alternate)for(;t.return;)t=t.return;else{s=t;do t=s,(t.flags&4098)!==0&&(a=t.return),s=t.return;while(s)}return t.tag===3?a:null}function h(s){if(s.tag===13){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function f(s){if(s.tag===31){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function p(s){if(x(s)!==s)throw Error(c(188))}function g(s){var t=s.alternate;if(!t){if(t=x(s),t===null)throw Error(c(188));return t!==s?null:s}for(var a=s,r=t;;){var o=a.return;if(o===null)break;var d=o.alternate;if(d===null){if(r=o.return,r!==null){a=r;continue}break}if(o.child===d.child){for(d=o.child;d;){if(d===a)return p(o),s;if(d===r)return p(o),t;d=d.sibling}throw Error(c(188))}if(a.return!==r.return)a=o,r=d;else{for(var j=!1,k=o.child;k;){if(k===a){j=!0,a=o,r=d;break}if(k===r){j=!0,r=o,a=d;break}k=k.sibling}if(!j){for(k=d.child;k;){if(k===a){j=!0,a=d,r=o;break}if(k===r){j=!0,r=d,a=o;break}k=k.sibling}if(!j)throw Error(c(189))}}if(a.alternate!==r)throw Error(c(190))}if(a.tag!==3)throw Error(c(188));return a.stateNode.current===a?s:t}function N(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s;for(s=s.child;s!==null;){if(t=N(s),t!==null)return t;s=s.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),me=Symbol.for("react.memo_cache_sentinel"),ce=Symbol.iterator;function ve(s){return s===null||typeof s!="object"?null:(s=ce&&s[ce]||s["@@iterator"],typeof s=="function"?s:null)}var se=Symbol.for("react.client.reference");function ge(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===se?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case O:return"Fragment";case _:return"Profiler";case A:return"StrictMode";case M:return"Suspense";case G:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case E:return s.displayName||"Context";case H:return(s._context.displayName||"Context")+".Consumer";case C:var t=s.render;return s=s.displayName,s||(s=t.displayName||t.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case D:return t=s.displayName||null,t!==null?t:ge(s.type)||"Memo";case ee:t=s._payload,s=s._init;try{return ge(s(t))}catch{}}return null}var fe=Array.isArray,z=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I={pending:!1,data:null,method:null,action:null},L=[],B=-1;function _e(s){return{current:s}}function je(s){0>B||(s.current=L[B],L[B]=null,B--)}function Ce(s,t){B++,L[B]=s.current,s.current=t}var K=_e(null),U=_e(null),V=_e(null),xe=_e(null);function Oe(s,t){switch(Ce(V,t),Ce(U,s),Ce(K,null),t.nodeType){case 9:case 11:s=(s=t.documentElement)&&(s=s.namespaceURI)?Cp(s):0;break;default:if(s=t.tagName,t=t.namespaceURI)t=Cp(t),s=Tp(t,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}je(K),Ce(K,s)}function X(){je(K),je(U),je(V)}function oe(s){s.memoizedState!==null&&Ce(xe,s);var t=K.current,a=Tp(t,s.type);t!==a&&(Ce(U,s),Ce(K,a))}function Ge(s){U.current===s&&(je(K),je(U)),xe.current===s&&(je(xe),Di._currentValue=I)}var Y,te;function Ue(s){if(Y===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);Y=t&&t[1]||"",te=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Y+s+te}var Le=!1;function Ae(s,t){if(!s||Le)return"";Le=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(ue){var ie=ue}Reflect.construct(s,[],be)}else{try{be.call()}catch(ue){ie=ue}s.call(be.prototype)}}else{try{throw Error()}catch(ue){ie=ue}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(ue){if(ue&&ie&&typeof ue.stack=="string")return[ue.stack,ie.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=r.DetermineComponentFrameRoot(),j=d[0],k=d[1];if(j&&k){var $=j.split(`
`),le=k.split(`
`);for(o=r=0;r<$.length&&!$[r].includes("DetermineComponentFrameRoot");)r++;for(;o<le.length&&!le[o].includes("DetermineComponentFrameRoot");)o++;if(r===$.length||o===le.length)for(r=$.length-1,o=le.length-1;1<=r&&0<=o&&$[r]!==le[o];)o--;for(;1<=r&&0<=o;r--,o--)if($[r]!==le[o]){if(r!==1||o!==1)do if(r--,o--,0>o||$[r]!==le[o]){var pe=`
`+$[r].replace(" at new "," at ");return s.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",s.displayName)),pe}while(1<=r&&0<=o);break}}}finally{Le=!1,Error.prepareStackTrace=a}return(a=s?s.displayName||s.name:"")?Ue(a):""}function de(s,t){switch(s.tag){case 26:case 27:case 5:return Ue(s.type);case 16:return Ue("Lazy");case 13:return s.child!==t&&t!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return Ae(s.type,!1);case 11:return Ae(s.type.render,!1);case 1:return Ae(s.type,!0);case 31:return Ue("Activity");default:return""}}function Te(s){try{var t="",a=null;do t+=de(s,a),a=s,s=s.return;while(s);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var rs=Object.prototype.hasOwnProperty,Rt=l.unstable_scheduleCallback,ta=l.unstable_cancelCallback,qa=l.unstable_shouldYield,Ht=l.unstable_requestPaint,ut=l.unstable_now,q=l.unstable_getCurrentPriorityLevel,qe=l.unstable_ImmediatePriority,Qe=l.unstable_UserBlockingPriority,We=l.unstable_NormalPriority,Os=l.unstable_LowPriority,as=l.unstable_IdlePriority,Cs=l.log,Ee=l.unstable_setDisableYieldValue,Ns=null,ls=null;function es(s){if(typeof Cs=="function"&&Ee(s),ls&&typeof ls.setStrictMode=="function")try{ls.setStrictMode(Ns,s)}catch{}}var bs=Math.clz32?Math.clz32:tt,pt=Math.log,Lt=Math.LN2;function tt(s){return s>>>=0,s===0?32:31-(pt(s)/Lt|0)|0}var Ms=256,kt=262144,Ut=4194304;function za(s){var t=s&42;if(t!==0)return t;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function el(s,t,a){var r=s.pendingLanes;if(r===0)return 0;var o=0,d=s.suspendedLanes,j=s.pingedLanes;s=s.warmLanes;var k=r&134217727;return k!==0?(r=k&~d,r!==0?o=za(r):(j&=k,j!==0?o=za(j):a||(a=k&~s,a!==0&&(o=za(a))))):(k=r&~d,k!==0?o=za(k):j!==0?o=za(j):a||(a=r&~s,a!==0&&(o=za(a)))),o===0?0:t!==0&&t!==o&&(t&d)===0&&(d=o&-o,a=t&-t,d>=a||d===32&&(a&4194048)!==0)?t:o}function ol(s,t){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&t)===0}function Yn(s,t){switch(s){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Z(){var s=Ut;return Ut<<=1,(Ut&62914560)===0&&(Ut=4194304),s}function ye(s){for(var t=[],a=0;31>a;a++)t.push(s);return t}function De(s,t){s.pendingLanes|=t,t!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Hs(s,t,a,r,o,d){var j=s.pendingLanes;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=a,s.entangledLanes&=a,s.errorRecoveryDisabledLanes&=a,s.shellSuspendCounter=0;var k=s.entanglements,$=s.expirationTimes,le=s.hiddenUpdates;for(a=j&~a;0<a;){var pe=31-bs(a),be=1<<pe;k[pe]=0,$[pe]=-1;var ie=le[pe];if(ie!==null)for(le[pe]=null,pe=0;pe<ie.length;pe++){var ue=ie[pe];ue!==null&&(ue.lane&=-536870913)}a&=~be}r!==0&&zt(s,r,0),d!==0&&o===0&&s.tag!==0&&(s.suspendedLanes|=d&~(j&~t))}function zt(s,t,a){s.pendingLanes|=t,s.suspendedLanes&=~t;var r=31-bs(t);s.entangledLanes|=t,s.entanglements[r]=s.entanglements[r]|1073741824|a&261930}function Jt(s,t){var a=s.entangledLanes|=t;for(s=s.entanglements;a;){var r=31-bs(a),o=1<<r;o&t|s[r]&t&&(s[r]|=t),a&=~o}}function it(s,t){var a=t&-t;return a=(a&42)!==0?1:Xt(a),(a&(s.suspendedLanes|t))!==0?0:a}function Xt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function mt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function re(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:Xp(s.type))}function he(s,t){var a=Q.p;try{return Q.p=s,t()}finally{Q.p=a}}var ss=Math.random().toString(36).slice(2),gs="__reactFiber$"+ss,cs="__reactProps$"+ss,Ct="__reactContainer$"+ss,Ka="__reactEvents$"+ss,Ul="__reactListeners$"+ss,Jn="__reactHandles$"+ss,Yr="__reactResources$"+ss,vn="__reactMarker$"+ss;function ud(s){delete s[gs],delete s[cs],delete s[Ka],delete s[Ul],delete s[Jn]}function Xn(s){var t=s[gs];if(t)return t;for(var a=s.parentNode;a;){if(t=a[Ct]||a[gs]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(s=Rp(s);s!==null;){if(a=s[gs])return a;s=Rp(s)}return t}s=a,a=s.parentNode}return null}function Zn(s){if(s=s[gs]||s[Ct]){var t=s.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return s}return null}function Jr(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s.stateNode;throw Error(c(33))}function Wn(s){var t=s[Yr];return t||(t=s[Yr]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function $t(s){s[vn]=!0}var hx=new Set,fx={};function Nn(s,t){er(s,t),er(s+"Capture",t)}function er(s,t){for(fx[s]=t,s=0;s<t.length;s++)hx.add(t[s])}var rb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),px={},gx={};function ib(s){return rs.call(gx,s)?!0:rs.call(px,s)?!1:rb.test(s)?gx[s]=!0:(px[s]=!0,!1)}function xc(s,t,a){if(ib(t))if(a===null)s.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":s.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){s.removeAttribute(t);return}}s.setAttribute(t,""+a)}}function hc(s,t,a){if(a===null)s.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(t);return}s.setAttribute(t,""+a)}}function dl(s,t,a,r){if(r===null)s.removeAttribute(a);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttributeNS(t,a,""+r)}}function Oa(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function jx(s){var t=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function cb(s,t,a){var r=Object.getOwnPropertyDescriptor(s.constructor.prototype,t);if(!s.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,d=r.set;return Object.defineProperty(s,t,{configurable:!0,get:function(){return o.call(this)},set:function(j){a=""+j,d.call(this,j)}}),Object.defineProperty(s,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(j){a=""+j},stopTracking:function(){s._valueTracker=null,delete s[t]}}}}function md(s){if(!s._valueTracker){var t=jx(s)?"checked":"value";s._valueTracker=cb(s,t,""+s[t])}}function vx(s){if(!s)return!1;var t=s._valueTracker;if(!t)return!0;var a=t.getValue(),r="";return s&&(r=jx(s)?s.checked?"true":"false":s.value),s=r,s!==a?(t.setValue(s),!0):!1}function fc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ob=/[\n"\\]/g;function Da(s){return s.replace(ob,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function xd(s,t,a,r,o,d,j,k){s.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?s.type=j:s.removeAttribute("type"),t!=null?j==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+Oa(t)):s.value!==""+Oa(t)&&(s.value=""+Oa(t)):j!=="submit"&&j!=="reset"||s.removeAttribute("value"),t!=null?hd(s,j,Oa(t)):a!=null?hd(s,j,Oa(a)):r!=null&&s.removeAttribute("value"),o==null&&d!=null&&(s.defaultChecked=!!d),o!=null&&(s.checked=o&&typeof o!="function"&&typeof o!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+Oa(k):s.removeAttribute("name")}function Nx(s,t,a,r,o,d,j,k){if(d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(s.type=d),t!=null||a!=null){if(!(d!=="submit"&&d!=="reset"||t!=null)){md(s);return}a=a!=null?""+Oa(a):"",t=t!=null?""+Oa(t):a,k||t===s.value||(s.value=t),s.defaultValue=t}r=r??o,r=typeof r!="function"&&typeof r!="symbol"&&!!r,s.checked=k?s.checked:!!r,s.defaultChecked=!!r,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(s.name=j),md(s)}function hd(s,t,a){t==="number"&&fc(s.ownerDocument)===s||s.defaultValue===""+a||(s.defaultValue=""+a)}function sr(s,t,a,r){if(s=s.options,t){t={};for(var o=0;o<a.length;o++)t["$"+a[o]]=!0;for(a=0;a<s.length;a++)o=t.hasOwnProperty("$"+s[a].value),s[a].selected!==o&&(s[a].selected=o),o&&r&&(s[a].defaultSelected=!0)}else{for(a=""+Oa(a),t=null,o=0;o<s.length;o++){if(s[o].value===a){s[o].selected=!0,r&&(s[o].defaultSelected=!0);return}t!==null||s[o].disabled||(t=s[o])}t!==null&&(t.selected=!0)}}function bx(s,t,a){if(t!=null&&(t=""+Oa(t),t!==s.value&&(s.value=t),a==null)){s.defaultValue!==t&&(s.defaultValue=t);return}s.defaultValue=a!=null?""+Oa(a):""}function yx(s,t,a,r){if(t==null){if(r!=null){if(a!=null)throw Error(c(92));if(fe(r)){if(1<r.length)throw Error(c(93));r=r[0]}a=r}a==null&&(a=""),t=a}a=Oa(t),s.defaultValue=a,r=s.textContent,r===a&&r!==""&&r!==null&&(s.value=r),md(s)}function tr(s,t){if(t){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=t;return}}s.textContent=t}var db=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wx(s,t,a){var r=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?r?s.setProperty(t,""):t==="float"?s.cssFloat="":s[t]="":r?s.setProperty(t,a):typeof a!="number"||a===0||db.has(t)?t==="float"?s.cssFloat=a:s[t]=(""+a).trim():s[t]=a+"px"}function _x(s,t,a){if(t!=null&&typeof t!="object")throw Error(c(62));if(s=s.style,a!=null){for(var r in a)!a.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="");for(var o in t)r=t[o],t.hasOwnProperty(o)&&a[o]!==r&&wx(s,o,r)}else for(var d in t)t.hasOwnProperty(d)&&wx(s,d,t[d])}function fd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ub=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pc(s){return mb.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ul(){}var pd=null;function gd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ar=null,lr=null;function Sx(s){var t=Zn(s);if(t&&(s=t.stateNode)){var a=s[cs]||null;e:switch(s=t.stateNode,t.type){case"input":if(xd(s,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Da(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var r=a[t];if(r!==s&&r.form===s.form){var o=r[cs]||null;if(!o)throw Error(c(90));xd(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<a.length;t++)r=a[t],r.form===s.form&&vx(r)}break e;case"textarea":bx(s,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&sr(s,!!a.multiple,t,!1)}}}var jd=!1;function kx(s,t,a){if(jd)return s(t,a);jd=!0;try{var r=s(t);return r}finally{if(jd=!1,(ar!==null||lr!==null)&&(ao(),ar&&(t=ar,s=lr,lr=ar=null,Sx(t),s)))for(t=0;t<s.length;t++)Sx(s[t])}}function Xr(s,t){var a=s.stateNode;if(a===null)return null;var r=a[cs]||null;if(r===null)return null;a=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(s=s.type,r=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!r;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(c(231,t,typeof a));return a}var ml=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vd=!1;if(ml)try{var Zr={};Object.defineProperty(Zr,"passive",{get:function(){vd=!0}}),window.addEventListener("test",Zr,Zr),window.removeEventListener("test",Zr,Zr)}catch{vd=!1}var $l=null,Nd=null,gc=null;function Cx(){if(gc)return gc;var s,t=Nd,a=t.length,r,o="value"in $l?$l.value:$l.textContent,d=o.length;for(s=0;s<a&&t[s]===o[s];s++);var j=a-s;for(r=1;r<=j&&t[a-r]===o[d-r];r++);return gc=o.slice(s,1<r?1-r:void 0)}function jc(s){var t=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&t===13&&(s=13)):s=t,s===10&&(s=13),32<=s||s===13?s:0}function vc(){return!0}function Tx(){return!1}function oa(s){function t(a,r,o,d,j){this._reactName=a,this._targetInst=o,this.type=r,this.nativeEvent=d,this.target=j,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(a=s[k],this[k]=a?a(d):d[k]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?vc:Tx,this.isPropagationStopped=Tx,this}return v(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=vc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=vc)},persist:function(){},isPersistent:vc}),t}var bn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=oa(bn),Wr=v({},bn,{view:0,detail:0}),xb=oa(Wr),bd,yd,ei,bc=v({},Wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_d,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ei&&(ei&&s.type==="mousemove"?(bd=s.screenX-ei.screenX,yd=s.screenY-ei.screenY):yd=bd=0,ei=s),bd)},movementY:function(s){return"movementY"in s?s.movementY:yd}}),Ex=oa(bc),hb=v({},bc,{dataTransfer:0}),fb=oa(hb),pb=v({},Wr,{relatedTarget:0}),wd=oa(pb),gb=v({},bn,{animationName:0,elapsedTime:0,pseudoElement:0}),jb=oa(gb),vb=v({},bn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Nb=oa(vb),bb=v({},bn,{data:0}),Mx=oa(bb),yb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_b={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sb(s){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(s):(s=_b[s])?!!t[s]:!1}function _d(){return Sb}var kb=v({},Wr,{key:function(s){if(s.key){var t=yb[s.key]||s.key;if(t!=="Unidentified")return t}return s.type==="keypress"?(s=jc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?wb[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_d,charCode:function(s){return s.type==="keypress"?jc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?jc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Cb=oa(kb),Tb=v({},bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ax=oa(Tb),Eb=v({},Wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_d}),Mb=oa(Eb),Ab=v({},bn,{propertyName:0,elapsedTime:0,pseudoElement:0}),zb=oa(Ab),Ob=v({},bc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Db=oa(Ob),Rb=v({},bn,{newState:0,oldState:0}),Lb=oa(Rb),Ub=[9,13,27,32],Sd=ml&&"CompositionEvent"in window,si=null;ml&&"documentMode"in document&&(si=document.documentMode);var $b=ml&&"TextEvent"in window&&!si,zx=ml&&(!Sd||si&&8<si&&11>=si),Ox=" ",Dx=!1;function Rx(s,t){switch(s){case"keyup":return Ub.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lx(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var nr=!1;function Bb(s,t){switch(s){case"compositionend":return Lx(t);case"keypress":return t.which!==32?null:(Dx=!0,Ox);case"textInput":return s=t.data,s===Ox&&Dx?null:s;default:return null}}function Ib(s,t){if(nr)return s==="compositionend"||!Sd&&Rx(s,t)?(s=Cx(),gc=Nd=$l=null,nr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zx&&t.locale!=="ko"?null:t.data;default:return null}}var Pb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ux(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t==="input"?!!Pb[s.type]:t==="textarea"}function $x(s,t,a,r){ar?lr?lr.push(r):lr=[r]:ar=r,t=uo(t,"onChange"),0<t.length&&(a=new Nc("onChange","change",null,a,r),s.push({event:a,listeners:t}))}var ti=null,ai=null;function Hb(s){bp(s,0)}function yc(s){var t=Jr(s);if(vx(t))return s}function Bx(s,t){if(s==="change")return t}var Ix=!1;if(ml){var kd;if(ml){var Cd="oninput"in document;if(!Cd){var Px=document.createElement("div");Px.setAttribute("oninput","return;"),Cd=typeof Px.oninput=="function"}kd=Cd}else kd=!1;Ix=kd&&(!document.documentMode||9<document.documentMode)}function Hx(){ti&&(ti.detachEvent("onpropertychange",Fx),ai=ti=null)}function Fx(s){if(s.propertyName==="value"&&yc(ai)){var t=[];$x(t,ai,s,gd(s)),kx(Hb,t)}}function Fb(s,t,a){s==="focusin"?(Hx(),ti=t,ai=a,ti.attachEvent("onpropertychange",Fx)):s==="focusout"&&Hx()}function Gb(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return yc(ai)}function Vb(s,t){if(s==="click")return yc(t)}function qb(s,t){if(s==="input"||s==="change")return yc(t)}function Kb(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var ga=typeof Object.is=="function"?Object.is:Kb;function li(s,t){if(ga(s,t))return!0;if(typeof s!="object"||s===null||typeof t!="object"||t===null)return!1;var a=Object.keys(s),r=Object.keys(t);if(a.length!==r.length)return!1;for(r=0;r<a.length;r++){var o=a[r];if(!rs.call(t,o)||!ga(s[o],t[o]))return!1}return!0}function Gx(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Vx(s,t){var a=Gx(s);s=0;for(var r;a;){if(a.nodeType===3){if(r=s+a.textContent.length,s<=t&&r>=t)return{node:a,offset:t-s};s=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Gx(a)}}function qx(s,t){return s&&t?s===t?!0:s&&s.nodeType===3?!1:t&&t.nodeType===3?qx(s,t.parentNode):"contains"in s?s.contains(t):s.compareDocumentPosition?!!(s.compareDocumentPosition(t)&16):!1:!1}function Kx(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var t=fc(s.document);t instanceof s.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)s=t.contentWindow;else break;t=fc(s.document)}return t}function Td(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t&&(t==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||t==="textarea"||s.contentEditable==="true")}var Qb=ml&&"documentMode"in document&&11>=document.documentMode,rr=null,Ed=null,ni=null,Md=!1;function Qx(s,t,a){var r=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Md||rr==null||rr!==fc(r)||(r=rr,"selectionStart"in r&&Td(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ni&&li(ni,r)||(ni=r,r=uo(Ed,"onSelect"),0<r.length&&(t=new Nc("onSelect","select",null,t,a),s.push({event:t,listeners:r}),t.target=rr)))}function yn(s,t){var a={};return a[s.toLowerCase()]=t.toLowerCase(),a["Webkit"+s]="webkit"+t,a["Moz"+s]="moz"+t,a}var ir={animationend:yn("Animation","AnimationEnd"),animationiteration:yn("Animation","AnimationIteration"),animationstart:yn("Animation","AnimationStart"),transitionrun:yn("Transition","TransitionRun"),transitionstart:yn("Transition","TransitionStart"),transitioncancel:yn("Transition","TransitionCancel"),transitionend:yn("Transition","TransitionEnd")},Ad={},Yx={};ml&&(Yx=document.createElement("div").style,"AnimationEvent"in window||(delete ir.animationend.animation,delete ir.animationiteration.animation,delete ir.animationstart.animation),"TransitionEvent"in window||delete ir.transitionend.transition);function wn(s){if(Ad[s])return Ad[s];if(!ir[s])return s;var t=ir[s],a;for(a in t)if(t.hasOwnProperty(a)&&a in Yx)return Ad[s]=t[a];return s}var Jx=wn("animationend"),Xx=wn("animationiteration"),Zx=wn("animationstart"),Yb=wn("transitionrun"),Jb=wn("transitionstart"),Xb=wn("transitioncancel"),Wx=wn("transitionend"),eh=new Map,zd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");zd.push("scrollEnd");function Qa(s,t){eh.set(s,t),Nn(t,[s])}var wc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ra=[],cr=0,Od=0;function _c(){for(var s=cr,t=Od=cr=0;t<s;){var a=Ra[t];Ra[t++]=null;var r=Ra[t];Ra[t++]=null;var o=Ra[t];Ra[t++]=null;var d=Ra[t];if(Ra[t++]=null,r!==null&&o!==null){var j=r.pending;j===null?o.next=o:(o.next=j.next,j.next=o),r.pending=o}d!==0&&sh(a,o,d)}}function Sc(s,t,a,r){Ra[cr++]=s,Ra[cr++]=t,Ra[cr++]=a,Ra[cr++]=r,Od|=r,s.lanes|=r,s=s.alternate,s!==null&&(s.lanes|=r)}function Dd(s,t,a,r){return Sc(s,t,a,r),kc(s)}function _n(s,t){return Sc(s,null,null,t),kc(s)}function sh(s,t,a){s.lanes|=a;var r=s.alternate;r!==null&&(r.lanes|=a);for(var o=!1,d=s.return;d!==null;)d.childLanes|=a,r=d.alternate,r!==null&&(r.childLanes|=a),d.tag===22&&(s=d.stateNode,s===null||s._visibility&1||(o=!0)),s=d,d=d.return;return s.tag===3?(d=s.stateNode,o&&t!==null&&(o=31-bs(a),s=d.hiddenUpdates,r=s[o],r===null?s[o]=[t]:r.push(t),t.lane=a|536870912),d):null}function kc(s){if(50<Ci)throw Ci=0,Fu=null,Error(c(185));for(var t=s.return;t!==null;)s=t,t=s.return;return s.tag===3?s.stateNode:null}var or={};function Zb(s,t,a,r){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ja(s,t,a,r){return new Zb(s,t,a,r)}function Rd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function xl(s,t){var a=s.alternate;return a===null?(a=ja(s.tag,t,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=t,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&65011712,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a.refCleanup=s.refCleanup,a}function th(s,t){s.flags&=65011714;var a=s.alternate;return a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s}function Cc(s,t,a,r,o,d){var j=0;if(r=s,typeof s=="function")Rd(s)&&(j=1);else if(typeof s=="string")j=a0(s,a,K.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=ja(31,a,t,o),s.elementType=R,s.lanes=d,s;case O:return Sn(a.children,o,d,t);case A:j=8,o|=24;break;case _:return s=ja(12,a,t,o|2),s.elementType=_,s.lanes=d,s;case M:return s=ja(13,a,t,o),s.elementType=M,s.lanes=d,s;case G:return s=ja(19,a,t,o),s.elementType=G,s.lanes=d,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:j=10;break e;case H:j=9;break e;case C:j=11;break e;case D:j=14;break e;case ee:j=16,r=null;break e}j=29,a=Error(c(130,s===null?"null":typeof s,"")),r=null}return t=ja(j,a,t,o),t.elementType=s,t.type=r,t.lanes=d,t}function Sn(s,t,a,r){return s=ja(7,s,r,t),s.lanes=a,s}function Ld(s,t,a){return s=ja(6,s,null,t),s.lanes=a,s}function ah(s){var t=ja(18,null,null,0);return t.stateNode=s,t}function Ud(s,t,a){return t=ja(4,s.children!==null?s.children:[],s.key,t),t.lanes=a,t.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},t}var lh=new WeakMap;function La(s,t){if(typeof s=="object"&&s!==null){var a=lh.get(s);return a!==void 0?a:(t={value:s,source:t,stack:Te(t)},lh.set(s,t),t)}return{value:s,source:t,stack:Te(t)}}var dr=[],ur=0,Tc=null,ri=0,Ua=[],$a=0,Bl=null,sl=1,tl="";function hl(s,t){dr[ur++]=ri,dr[ur++]=Tc,Tc=s,ri=t}function nh(s,t,a){Ua[$a++]=sl,Ua[$a++]=tl,Ua[$a++]=Bl,Bl=s;var r=sl;s=tl;var o=32-bs(r)-1;r&=~(1<<o),a+=1;var d=32-bs(t)+o;if(30<d){var j=o-o%5;d=(r&(1<<j)-1).toString(32),r>>=j,o-=j,sl=1<<32-bs(t)+o|a<<o|r,tl=d+s}else sl=1<<d|a<<o|r,tl=s}function $d(s){s.return!==null&&(hl(s,1),nh(s,1,0))}function Bd(s){for(;s===Tc;)Tc=dr[--ur],dr[ur]=null,ri=dr[--ur],dr[ur]=null;for(;s===Bl;)Bl=Ua[--$a],Ua[$a]=null,tl=Ua[--$a],Ua[$a]=null,sl=Ua[--$a],Ua[$a]=null}function rh(s,t){Ua[$a++]=sl,Ua[$a++]=tl,Ua[$a++]=Bl,sl=t.id,tl=t.overflow,Bl=s}var Ft=null,ct=null,As=!1,Il=null,Ba=!1,Id=Error(c(519));function Pl(s){var t=Error(c(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ii(La(t,s)),Id}function ih(s){var t=s.stateNode,a=s.type,r=s.memoizedProps;switch(t[gs]=s,t[cs]=r,a){case"dialog":Ss("cancel",t),Ss("close",t);break;case"iframe":case"object":case"embed":Ss("load",t);break;case"video":case"audio":for(a=0;a<Ei.length;a++)Ss(Ei[a],t);break;case"source":Ss("error",t);break;case"img":case"image":case"link":Ss("error",t),Ss("load",t);break;case"details":Ss("toggle",t);break;case"input":Ss("invalid",t),Nx(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Ss("invalid",t);break;case"textarea":Ss("invalid",t),yx(t,r.value,r.defaultValue,r.children)}a=r.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||r.suppressHydrationWarning===!0||Sp(t.textContent,a)?(r.popover!=null&&(Ss("beforetoggle",t),Ss("toggle",t)),r.onScroll!=null&&Ss("scroll",t),r.onScrollEnd!=null&&Ss("scrollend",t),r.onClick!=null&&(t.onclick=ul),t=!0):t=!1,t||Pl(s,!0)}function ch(s){for(Ft=s.return;Ft;)switch(Ft.tag){case 5:case 31:case 13:Ba=!1;return;case 27:case 3:Ba=!0;return;default:Ft=Ft.return}}function mr(s){if(s!==Ft)return!1;if(!As)return ch(s),As=!0,!1;var t=s.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=s.type,a=!(a!=="form"&&a!=="button")||lm(s.type,s.memoizedProps)),a=!a),a&&ct&&Pl(s),ch(s),t===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));ct=Dp(s)}else if(t===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));ct=Dp(s)}else t===27?(t=ct,sn(s.type)?(s=om,om=null,ct=s):ct=t):ct=Ft?Pa(s.stateNode.nextSibling):null;return!0}function kn(){ct=Ft=null,As=!1}function Pd(){var s=Il;return s!==null&&(xa===null?xa=s:xa.push.apply(xa,s),Il=null),s}function ii(s){Il===null?Il=[s]:Il.push(s)}var Hd=_e(null),Cn=null,fl=null;function Hl(s,t,a){Ce(Hd,t._currentValue),t._currentValue=a}function pl(s){s._currentValue=Hd.current,je(Hd)}function Fd(s,t,a){for(;s!==null;){var r=s.alternate;if((s.childLanes&t)!==t?(s.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),s===a)break;s=s.return}}function Gd(s,t,a,r){var o=s.child;for(o!==null&&(o.return=s);o!==null;){var d=o.dependencies;if(d!==null){var j=o.child;d=d.firstContext;e:for(;d!==null;){var k=d;d=o;for(var $=0;$<t.length;$++)if(k.context===t[$]){d.lanes|=a,k=d.alternate,k!==null&&(k.lanes|=a),Fd(d.return,a,s),r||(j=null);break e}d=k.next}}else if(o.tag===18){if(j=o.return,j===null)throw Error(c(341));j.lanes|=a,d=j.alternate,d!==null&&(d.lanes|=a),Fd(j,a,s),j=null}else j=o.child;if(j!==null)j.return=o;else for(j=o;j!==null;){if(j===s){j=null;break}if(o=j.sibling,o!==null){o.return=j.return,j=o;break}j=j.return}o=j}}function xr(s,t,a,r){s=null;for(var o=t,d=!1;o!==null;){if(!d){if((o.flags&524288)!==0)d=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var j=o.alternate;if(j===null)throw Error(c(387));if(j=j.memoizedProps,j!==null){var k=o.type;ga(o.pendingProps.value,j.value)||(s!==null?s.push(k):s=[k])}}else if(o===xe.current){if(j=o.alternate,j===null)throw Error(c(387));j.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(s!==null?s.push(Di):s=[Di])}o=o.return}s!==null&&Gd(t,s,a,r),t.flags|=262144}function Ec(s){for(s=s.firstContext;s!==null;){if(!ga(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Tn(s){Cn=s,fl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Gt(s){return oh(Cn,s)}function Mc(s,t){return Cn===null&&Tn(s),oh(s,t)}function oh(s,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},fl===null){if(s===null)throw Error(c(308));fl=t,s.dependencies={lanes:0,firstContext:t},s.flags|=524288}else fl=fl.next=t;return a}var Wb=typeof AbortController<"u"?AbortController:function(){var s=[],t=this.signal={aborted:!1,addEventListener:function(a,r){s.push(r)}};this.abort=function(){t.aborted=!0,s.forEach(function(a){return a()})}},ey=l.unstable_scheduleCallback,sy=l.unstable_NormalPriority,Tt={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vd(){return{controller:new Wb,data:new Map,refCount:0}}function ci(s){s.refCount--,s.refCount===0&&ey(sy,function(){s.controller.abort()})}var oi=null,qd=0,hr=0,fr=null;function ty(s,t){if(oi===null){var a=oi=[];qd=0,hr=Yu(),fr={status:"pending",value:void 0,then:function(r){a.push(r)}}}return qd++,t.then(dh,dh),t}function dh(){if(--qd===0&&oi!==null){fr!==null&&(fr.status="fulfilled");var s=oi;oi=null,hr=0,fr=null;for(var t=0;t<s.length;t++)(0,s[t])()}}function ay(s,t){var a=[],r={status:"pending",value:null,reason:null,then:function(o){a.push(o)}};return s.then(function(){r.status="fulfilled",r.value=t;for(var o=0;o<a.length;o++)(0,a[o])(t)},function(o){for(r.status="rejected",r.reason=o,o=0;o<a.length;o++)(0,a[o])(void 0)}),r}var uh=z.S;z.S=function(s,t){Yf=ut(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&ty(s,t),uh!==null&&uh(s,t)};var En=_e(null);function Kd(){var s=En.current;return s!==null?s:Xs.pooledCache}function Ac(s,t){t===null?Ce(En,En.current):Ce(En,t.pool)}function mh(){var s=Kd();return s===null?null:{parent:Tt._currentValue,pool:s}}var pr=Error(c(460)),Qd=Error(c(474)),zc=Error(c(542)),Oc={then:function(){}};function xh(s){return s=s.status,s==="fulfilled"||s==="rejected"}function hh(s,t,a){switch(a=s[a],a===void 0?s.push(t):a!==t&&(t.then(ul,ul),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,ph(s),s;default:if(typeof t.status=="string")t.then(ul,ul);else{if(s=Xs,s!==null&&100<s.shellSuspendCounter)throw Error(c(482));s=t,s.status="pending",s.then(function(r){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=r}},function(r){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,ph(s),s}throw An=t,pr}}function Mn(s){try{var t=s._init;return t(s._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(An=a,pr):a}}var An=null;function fh(){if(An===null)throw Error(c(459));var s=An;return An=null,s}function ph(s){if(s===pr||s===zc)throw Error(c(483))}var gr=null,di=0;function Dc(s){var t=di;return di+=1,gr===null&&(gr=[]),hh(gr,s,t)}function ui(s,t){t=t.props.ref,s.ref=t!==void 0?t:null}function Rc(s,t){throw t.$$typeof===y?Error(c(525)):(s=Object.prototype.toString.call(t),Error(c(31,s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)))}function gh(s){function t(J,F){if(s){var ae=J.deletions;ae===null?(J.deletions=[F],J.flags|=16):ae.push(F)}}function a(J,F){if(!s)return null;for(;F!==null;)t(J,F),F=F.sibling;return null}function r(J){for(var F=new Map;J!==null;)J.key!==null?F.set(J.key,J):F.set(J.index,J),J=J.sibling;return F}function o(J,F){return J=xl(J,F),J.index=0,J.sibling=null,J}function d(J,F,ae){return J.index=ae,s?(ae=J.alternate,ae!==null?(ae=ae.index,ae<F?(J.flags|=67108866,F):ae):(J.flags|=67108866,F)):(J.flags|=1048576,F)}function j(J){return s&&J.alternate===null&&(J.flags|=67108866),J}function k(J,F,ae,Ne){return F===null||F.tag!==6?(F=Ld(ae,J.mode,Ne),F.return=J,F):(F=o(F,ae),F.return=J,F)}function $(J,F,ae,Ne){var Ye=ae.type;return Ye===O?pe(J,F,ae.props.children,Ne,ae.key):F!==null&&(F.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===ee&&Mn(Ye)===F.type)?(F=o(F,ae.props),ui(F,ae),F.return=J,F):(F=Cc(ae.type,ae.key,ae.props,null,J.mode,Ne),ui(F,ae),F.return=J,F)}function le(J,F,ae,Ne){return F===null||F.tag!==4||F.stateNode.containerInfo!==ae.containerInfo||F.stateNode.implementation!==ae.implementation?(F=Ud(ae,J.mode,Ne),F.return=J,F):(F=o(F,ae.children||[]),F.return=J,F)}function pe(J,F,ae,Ne,Ye){return F===null||F.tag!==7?(F=Sn(ae,J.mode,Ne,Ye),F.return=J,F):(F=o(F,ae),F.return=J,F)}function be(J,F,ae){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=Ld(""+F,J.mode,ae),F.return=J,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case w:return ae=Cc(F.type,F.key,F.props,null,J.mode,ae),ui(ae,F),ae.return=J,ae;case b:return F=Ud(F,J.mode,ae),F.return=J,F;case ee:return F=Mn(F),be(J,F,ae)}if(fe(F)||ve(F))return F=Sn(F,J.mode,ae,null),F.return=J,F;if(typeof F.then=="function")return be(J,Dc(F),ae);if(F.$$typeof===E)return be(J,Mc(J,F),ae);Rc(J,F)}return null}function ie(J,F,ae,Ne){var Ye=F!==null?F.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Ye!==null?null:k(J,F,""+ae,Ne);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case w:return ae.key===Ye?$(J,F,ae,Ne):null;case b:return ae.key===Ye?le(J,F,ae,Ne):null;case ee:return ae=Mn(ae),ie(J,F,ae,Ne)}if(fe(ae)||ve(ae))return Ye!==null?null:pe(J,F,ae,Ne,null);if(typeof ae.then=="function")return ie(J,F,Dc(ae),Ne);if(ae.$$typeof===E)return ie(J,F,Mc(J,ae),Ne);Rc(J,ae)}return null}function ue(J,F,ae,Ne,Ye){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return J=J.get(ae)||null,k(F,J,""+Ne,Ye);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case w:return J=J.get(Ne.key===null?ae:Ne.key)||null,$(F,J,Ne,Ye);case b:return J=J.get(Ne.key===null?ae:Ne.key)||null,le(F,J,Ne,Ye);case ee:return Ne=Mn(Ne),ue(J,F,ae,Ne,Ye)}if(fe(Ne)||ve(Ne))return J=J.get(ae)||null,pe(F,J,Ne,Ye,null);if(typeof Ne.then=="function")return ue(J,F,ae,Dc(Ne),Ye);if(Ne.$$typeof===E)return ue(J,F,ae,Mc(F,Ne),Ye);Rc(F,Ne)}return null}function He(J,F,ae,Ne){for(var Ye=null,Ds=null,Ve=F,os=F=0,Es=null;Ve!==null&&os<ae.length;os++){Ve.index>os?(Es=Ve,Ve=null):Es=Ve.sibling;var Rs=ie(J,Ve,ae[os],Ne);if(Rs===null){Ve===null&&(Ve=Es);break}s&&Ve&&Rs.alternate===null&&t(J,Ve),F=d(Rs,F,os),Ds===null?Ye=Rs:Ds.sibling=Rs,Ds=Rs,Ve=Es}if(os===ae.length)return a(J,Ve),As&&hl(J,os),Ye;if(Ve===null){for(;os<ae.length;os++)Ve=be(J,ae[os],Ne),Ve!==null&&(F=d(Ve,F,os),Ds===null?Ye=Ve:Ds.sibling=Ve,Ds=Ve);return As&&hl(J,os),Ye}for(Ve=r(Ve);os<ae.length;os++)Es=ue(Ve,J,os,ae[os],Ne),Es!==null&&(s&&Es.alternate!==null&&Ve.delete(Es.key===null?os:Es.key),F=d(Es,F,os),Ds===null?Ye=Es:Ds.sibling=Es,Ds=Es);return s&&Ve.forEach(function(rn){return t(J,rn)}),As&&hl(J,os),Ye}function Xe(J,F,ae,Ne){if(ae==null)throw Error(c(151));for(var Ye=null,Ds=null,Ve=F,os=F=0,Es=null,Rs=ae.next();Ve!==null&&!Rs.done;os++,Rs=ae.next()){Ve.index>os?(Es=Ve,Ve=null):Es=Ve.sibling;var rn=ie(J,Ve,Rs.value,Ne);if(rn===null){Ve===null&&(Ve=Es);break}s&&Ve&&rn.alternate===null&&t(J,Ve),F=d(rn,F,os),Ds===null?Ye=rn:Ds.sibling=rn,Ds=rn,Ve=Es}if(Rs.done)return a(J,Ve),As&&hl(J,os),Ye;if(Ve===null){for(;!Rs.done;os++,Rs=ae.next())Rs=be(J,Rs.value,Ne),Rs!==null&&(F=d(Rs,F,os),Ds===null?Ye=Rs:Ds.sibling=Rs,Ds=Rs);return As&&hl(J,os),Ye}for(Ve=r(Ve);!Rs.done;os++,Rs=ae.next())Rs=ue(Ve,J,os,Rs.value,Ne),Rs!==null&&(s&&Rs.alternate!==null&&Ve.delete(Rs.key===null?os:Rs.key),F=d(Rs,F,os),Ds===null?Ye=Rs:Ds.sibling=Rs,Ds=Rs);return s&&Ve.forEach(function(h0){return t(J,h0)}),As&&hl(J,os),Ye}function Ys(J,F,ae,Ne){if(typeof ae=="object"&&ae!==null&&ae.type===O&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case w:e:{for(var Ye=ae.key;F!==null;){if(F.key===Ye){if(Ye=ae.type,Ye===O){if(F.tag===7){a(J,F.sibling),Ne=o(F,ae.props.children),Ne.return=J,J=Ne;break e}}else if(F.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===ee&&Mn(Ye)===F.type){a(J,F.sibling),Ne=o(F,ae.props),ui(Ne,ae),Ne.return=J,J=Ne;break e}a(J,F);break}else t(J,F);F=F.sibling}ae.type===O?(Ne=Sn(ae.props.children,J.mode,Ne,ae.key),Ne.return=J,J=Ne):(Ne=Cc(ae.type,ae.key,ae.props,null,J.mode,Ne),ui(Ne,ae),Ne.return=J,J=Ne)}return j(J);case b:e:{for(Ye=ae.key;F!==null;){if(F.key===Ye)if(F.tag===4&&F.stateNode.containerInfo===ae.containerInfo&&F.stateNode.implementation===ae.implementation){a(J,F.sibling),Ne=o(F,ae.children||[]),Ne.return=J,J=Ne;break e}else{a(J,F);break}else t(J,F);F=F.sibling}Ne=Ud(ae,J.mode,Ne),Ne.return=J,J=Ne}return j(J);case ee:return ae=Mn(ae),Ys(J,F,ae,Ne)}if(fe(ae))return He(J,F,ae,Ne);if(ve(ae)){if(Ye=ve(ae),typeof Ye!="function")throw Error(c(150));return ae=Ye.call(ae),Xe(J,F,ae,Ne)}if(typeof ae.then=="function")return Ys(J,F,Dc(ae),Ne);if(ae.$$typeof===E)return Ys(J,F,Mc(J,ae),Ne);Rc(J,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,F!==null&&F.tag===6?(a(J,F.sibling),Ne=o(F,ae),Ne.return=J,J=Ne):(a(J,F),Ne=Ld(ae,J.mode,Ne),Ne.return=J,J=Ne),j(J)):a(J,F)}return function(J,F,ae,Ne){try{di=0;var Ye=Ys(J,F,ae,Ne);return gr=null,Ye}catch(Ve){if(Ve===pr||Ve===zc)throw Ve;var Ds=ja(29,Ve,null,J.mode);return Ds.lanes=Ne,Ds.return=J,Ds}finally{}}}var zn=gh(!0),jh=gh(!1),Fl=!1;function Yd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jd(s,t){s=s.updateQueue,t.updateQueue===s&&(t.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Gl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Vl(s,t,a){var r=s.updateQueue;if(r===null)return null;if(r=r.shared,(Is&2)!==0){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,t=kc(s),sh(s,null,a),t}return Sc(s,r,t,a),kc(s)}function mi(s,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var r=t.lanes;r&=s.pendingLanes,a|=r,t.lanes=a,Jt(s,a)}}function Xd(s,t){var a=s.updateQueue,r=s.alternate;if(r!==null&&(r=r.updateQueue,a===r)){var o=null,d=null;if(a=a.firstBaseUpdate,a!==null){do{var j={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};d===null?o=d=j:d=d.next=j,a=a.next}while(a!==null);d===null?o=d=t:d=d.next=t}else o=d=t;a={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:d,shared:r.shared,callbacks:r.callbacks},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=t:s.next=t,a.lastBaseUpdate=t}var Zd=!1;function xi(){if(Zd){var s=fr;if(s!==null)throw s}}function hi(s,t,a,r){Zd=!1;var o=s.updateQueue;Fl=!1;var d=o.firstBaseUpdate,j=o.lastBaseUpdate,k=o.shared.pending;if(k!==null){o.shared.pending=null;var $=k,le=$.next;$.next=null,j===null?d=le:j.next=le,j=$;var pe=s.alternate;pe!==null&&(pe=pe.updateQueue,k=pe.lastBaseUpdate,k!==j&&(k===null?pe.firstBaseUpdate=le:k.next=le,pe.lastBaseUpdate=$))}if(d!==null){var be=o.baseState;j=0,pe=le=$=null,k=d;do{var ie=k.lane&-536870913,ue=ie!==k.lane;if(ue?(Ts&ie)===ie:(r&ie)===ie){ie!==0&&ie===hr&&(Zd=!0),pe!==null&&(pe=pe.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var He=s,Xe=k;ie=t;var Ys=a;switch(Xe.tag){case 1:if(He=Xe.payload,typeof He=="function"){be=He.call(Ys,be,ie);break e}be=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=Xe.payload,ie=typeof He=="function"?He.call(Ys,be,ie):He,ie==null)break e;be=v({},be,ie);break e;case 2:Fl=!0}}ie=k.callback,ie!==null&&(s.flags|=64,ue&&(s.flags|=8192),ue=o.callbacks,ue===null?o.callbacks=[ie]:ue.push(ie))}else ue={lane:ie,tag:k.tag,payload:k.payload,callback:k.callback,next:null},pe===null?(le=pe=ue,$=be):pe=pe.next=ue,j|=ie;if(k=k.next,k===null){if(k=o.shared.pending,k===null)break;ue=k,k=ue.next,ue.next=null,o.lastBaseUpdate=ue,o.shared.pending=null}}while(!0);pe===null&&($=be),o.baseState=$,o.firstBaseUpdate=le,o.lastBaseUpdate=pe,d===null&&(o.shared.lanes=0),Jl|=j,s.lanes=j,s.memoizedState=be}}function vh(s,t){if(typeof s!="function")throw Error(c(191,s));s.call(t)}function Nh(s,t){var a=s.callbacks;if(a!==null)for(s.callbacks=null,s=0;s<a.length;s++)vh(a[s],t)}var jr=_e(null),Lc=_e(0);function bh(s,t){s=Sl,Ce(Lc,s),Ce(jr,t),Sl=s|t.baseLanes}function Wd(){Ce(Lc,Sl),Ce(jr,jr.current)}function eu(){Sl=Lc.current,je(jr),je(Lc)}var va=_e(null),Ia=null;function ql(s){var t=s.alternate;Ce(yt,yt.current&1),Ce(va,s),Ia===null&&(t===null||jr.current!==null||t.memoizedState!==null)&&(Ia=s)}function su(s){Ce(yt,yt.current),Ce(va,s),Ia===null&&(Ia=s)}function yh(s){s.tag===22?(Ce(yt,yt.current),Ce(va,s),Ia===null&&(Ia=s)):Kl()}function Kl(){Ce(yt,yt.current),Ce(va,va.current)}function Na(s){je(va),Ia===s&&(Ia=null),je(yt)}var yt=_e(0);function Uc(s){for(var t=s;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||im(a)||cm(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gl=0,is=null,Ks=null,Et=null,$c=!1,vr=!1,On=!1,Bc=0,fi=0,Nr=null,ly=0;function gt(){throw Error(c(321))}function tu(s,t){if(t===null)return!1;for(var a=0;a<t.length&&a<s.length;a++)if(!ga(s[a],t[a]))return!1;return!0}function au(s,t,a,r,o,d){return gl=d,is=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,z.H=s===null||s.memoizedState===null?nf:ju,On=!1,d=a(r,o),On=!1,vr&&(d=_h(t,a,r,o)),wh(s),d}function wh(s){z.H=ji;var t=Ks!==null&&Ks.next!==null;if(gl=0,Et=Ks=is=null,$c=!1,fi=0,Nr=null,t)throw Error(c(300));s===null||Mt||(s=s.dependencies,s!==null&&Ec(s)&&(Mt=!0))}function _h(s,t,a,r){is=s;var o=0;do{if(vr&&(Nr=null),fi=0,vr=!1,25<=o)throw Error(c(301));if(o+=1,Et=Ks=null,s.updateQueue!=null){var d=s.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}z.H=rf,d=t(a,r)}while(vr);return d}function ny(){var s=z.H,t=s.useState()[0];return t=typeof t.then=="function"?pi(t):t,s=s.useState()[0],(Ks!==null?Ks.memoizedState:null)!==s&&(is.flags|=1024),t}function lu(){var s=Bc!==0;return Bc=0,s}function nu(s,t,a){t.updateQueue=s.updateQueue,t.flags&=-2053,s.lanes&=~a}function ru(s){if($c){for(s=s.memoizedState;s!==null;){var t=s.queue;t!==null&&(t.pending=null),s=s.next}$c=!1}gl=0,Et=Ks=is=null,vr=!1,fi=Bc=0,Nr=null}function aa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?is.memoizedState=Et=s:Et=Et.next=s,Et}function wt(){if(Ks===null){var s=is.alternate;s=s!==null?s.memoizedState:null}else s=Ks.next;var t=Et===null?is.memoizedState:Et.next;if(t!==null)Et=t,Ks=s;else{if(s===null)throw is.alternate===null?Error(c(467)):Error(c(310));Ks=s,s={memoizedState:Ks.memoizedState,baseState:Ks.baseState,baseQueue:Ks.baseQueue,queue:Ks.queue,next:null},Et===null?is.memoizedState=Et=s:Et=Et.next=s}return Et}function Ic(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pi(s){var t=fi;return fi+=1,Nr===null&&(Nr=[]),s=hh(Nr,s,t),t=is,(Et===null?t.memoizedState:Et.next)===null&&(t=t.alternate,z.H=t===null||t.memoizedState===null?nf:ju),s}function Pc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return pi(s);if(s.$$typeof===E)return Gt(s)}throw Error(c(438,String(s)))}function iu(s){var t=null,a=is.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var r=is.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=Ic(),is.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(s),r=0;r<s;r++)a[r]=me;return t.index++,a}function jl(s,t){return typeof t=="function"?t(s):t}function Hc(s){var t=wt();return cu(t,Ks,s)}function cu(s,t,a){var r=s.queue;if(r===null)throw Error(c(311));r.lastRenderedReducer=a;var o=s.baseQueue,d=r.pending;if(d!==null){if(o!==null){var j=o.next;o.next=d.next,d.next=j}t.baseQueue=o=d,r.pending=null}if(d=s.baseState,o===null)s.memoizedState=d;else{t=o.next;var k=j=null,$=null,le=t,pe=!1;do{var be=le.lane&-536870913;if(be!==le.lane?(Ts&be)===be:(gl&be)===be){var ie=le.revertLane;if(ie===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),be===hr&&(pe=!0);else if((gl&ie)===ie){le=le.next,ie===hr&&(pe=!0);continue}else be={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},$===null?(k=$=be,j=d):$=$.next=be,is.lanes|=ie,Jl|=ie;be=le.action,On&&a(d,be),d=le.hasEagerState?le.eagerState:a(d,be)}else ie={lane:be,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},$===null?(k=$=ie,j=d):$=$.next=ie,is.lanes|=be,Jl|=be;le=le.next}while(le!==null&&le!==t);if($===null?j=d:$.next=k,!ga(d,s.memoizedState)&&(Mt=!0,pe&&(a=fr,a!==null)))throw a;s.memoizedState=d,s.baseState=j,s.baseQueue=$,r.lastRenderedState=d}return o===null&&(r.lanes=0),[s.memoizedState,r.dispatch]}function ou(s){var t=wt(),a=t.queue;if(a===null)throw Error(c(311));a.lastRenderedReducer=s;var r=a.dispatch,o=a.pending,d=t.memoizedState;if(o!==null){a.pending=null;var j=o=o.next;do d=s(d,j.action),j=j.next;while(j!==o);ga(d,t.memoizedState)||(Mt=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),a.lastRenderedState=d}return[d,r]}function Sh(s,t,a){var r=is,o=wt(),d=As;if(d){if(a===void 0)throw Error(c(407));a=a()}else a=t();var j=!ga((Ks||o).memoizedState,a);if(j&&(o.memoizedState=a,Mt=!0),o=o.queue,mu(Th.bind(null,r,o,s),[s]),o.getSnapshot!==t||j||Et!==null&&Et.memoizedState.tag&1){if(r.flags|=2048,br(9,{destroy:void 0},Ch.bind(null,r,o,a,t),null),Xs===null)throw Error(c(349));d||(gl&127)!==0||kh(r,t,a)}return a}function kh(s,t,a){s.flags|=16384,s={getSnapshot:t,value:a},t=is.updateQueue,t===null?(t=Ic(),is.updateQueue=t,t.stores=[s]):(a=t.stores,a===null?t.stores=[s]:a.push(s))}function Ch(s,t,a,r){t.value=a,t.getSnapshot=r,Eh(t)&&Mh(s)}function Th(s,t,a){return a(function(){Eh(t)&&Mh(s)})}function Eh(s){var t=s.getSnapshot;s=s.value;try{var a=t();return!ga(s,a)}catch{return!0}}function Mh(s){var t=_n(s,2);t!==null&&ha(t,s,2)}function du(s){var t=aa();if(typeof s=="function"){var a=s;if(s=a(),On){es(!0);try{a()}finally{es(!1)}}}return t.memoizedState=t.baseState=s,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jl,lastRenderedState:s},t}function Ah(s,t,a,r){return s.baseState=a,cu(s,Ks,typeof r=="function"?r:jl)}function ry(s,t,a,r,o){if(Vc(s))throw Error(c(485));if(s=t.action,s!==null){var d={payload:o,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){d.listeners.push(j)}};z.T!==null?a(!0):d.isTransition=!1,r(d),a=t.pending,a===null?(d.next=t.pending=d,zh(t,d)):(d.next=a.next,t.pending=a.next=d)}}function zh(s,t){var a=t.action,r=t.payload,o=s.state;if(t.isTransition){var d=z.T,j={};z.T=j;try{var k=a(o,r),$=z.S;$!==null&&$(j,k),Oh(s,t,k)}catch(le){uu(s,t,le)}finally{d!==null&&j.types!==null&&(d.types=j.types),z.T=d}}else try{d=a(o,r),Oh(s,t,d)}catch(le){uu(s,t,le)}}function Oh(s,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(r){Dh(s,t,r)},function(r){return uu(s,t,r)}):Dh(s,t,a)}function Dh(s,t,a){t.status="fulfilled",t.value=a,Rh(t),s.state=a,t=s.pending,t!==null&&(a=t.next,a===t?s.pending=null:(a=a.next,t.next=a,zh(s,a)))}function uu(s,t,a){var r=s.pending;if(s.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=a,Rh(t),t=t.next;while(t!==r)}s.action=null}function Rh(s){s=s.listeners;for(var t=0;t<s.length;t++)(0,s[t])()}function Lh(s,t){return t}function Uh(s,t){if(As){var a=Xs.formState;if(a!==null){e:{var r=is;if(As){if(ct){s:{for(var o=ct,d=Ba;o.nodeType!==8;){if(!d){o=null;break s}if(o=Pa(o.nextSibling),o===null){o=null;break s}}d=o.data,o=d==="F!"||d==="F"?o:null}if(o){ct=Pa(o.nextSibling),r=o.data==="F!";break e}}Pl(r)}r=!1}r&&(t=a[0])}}return a=aa(),a.memoizedState=a.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lh,lastRenderedState:t},a.queue=r,a=tf.bind(null,is,r),r.dispatch=a,r=du(!1),d=gu.bind(null,is,!1,r.queue),r=aa(),o={state:t,dispatch:null,action:s,pending:null},r.queue=o,a=ry.bind(null,is,o,d,a),o.dispatch=a,r.memoizedState=s,[t,a,!1]}function $h(s){var t=wt();return Bh(t,Ks,s)}function Bh(s,t,a){if(t=cu(s,t,Lh)[0],s=Hc(jl)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=pi(t)}catch(j){throw j===pr?zc:j}else r=t;t=wt();var o=t.queue,d=o.dispatch;return a!==t.memoizedState&&(is.flags|=2048,br(9,{destroy:void 0},iy.bind(null,o,a),null)),[r,d,s]}function iy(s,t){s.action=t}function Ih(s){var t=wt(),a=Ks;if(a!==null)return Bh(t,a,s);wt(),t=t.memoizedState,a=wt();var r=a.queue.dispatch;return a.memoizedState=s,[t,r,!1]}function br(s,t,a,r){return s={tag:s,create:a,deps:r,inst:t,next:null},t=is.updateQueue,t===null&&(t=Ic(),is.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=s.next=s:(r=a.next,a.next=s,s.next=r,t.lastEffect=s),s}function Ph(){return wt().memoizedState}function Fc(s,t,a,r){var o=aa();is.flags|=s,o.memoizedState=br(1|t,{destroy:void 0},a,r===void 0?null:r)}function Gc(s,t,a,r){var o=wt();r=r===void 0?null:r;var d=o.memoizedState.inst;Ks!==null&&r!==null&&tu(r,Ks.memoizedState.deps)?o.memoizedState=br(t,d,a,r):(is.flags|=s,o.memoizedState=br(1|t,d,a,r))}function Hh(s,t){Fc(8390656,8,s,t)}function mu(s,t){Gc(2048,8,s,t)}function cy(s){is.flags|=4;var t=is.updateQueue;if(t===null)t=Ic(),is.updateQueue=t,t.events=[s];else{var a=t.events;a===null?t.events=[s]:a.push(s)}}function Fh(s){var t=wt().memoizedState;return cy({ref:t,nextImpl:s}),function(){if((Is&2)!==0)throw Error(c(440));return t.impl.apply(void 0,arguments)}}function Gh(s,t){return Gc(4,2,s,t)}function Vh(s,t){return Gc(4,4,s,t)}function qh(s,t){if(typeof t=="function"){s=s();var a=t(s);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return s=s(),t.current=s,function(){t.current=null}}function Kh(s,t,a){a=a!=null?a.concat([s]):null,Gc(4,4,qh.bind(null,t,s),a)}function xu(){}function Qh(s,t){var a=wt();t=t===void 0?null:t;var r=a.memoizedState;return t!==null&&tu(t,r[1])?r[0]:(a.memoizedState=[s,t],s)}function Yh(s,t){var a=wt();t=t===void 0?null:t;var r=a.memoizedState;if(t!==null&&tu(t,r[1]))return r[0];if(r=s(),On){es(!0);try{s()}finally{es(!1)}}return a.memoizedState=[r,t],r}function hu(s,t,a){return a===void 0||(gl&1073741824)!==0&&(Ts&261930)===0?s.memoizedState=t:(s.memoizedState=a,s=Xf(),is.lanes|=s,Jl|=s,a)}function Jh(s,t,a,r){return ga(a,t)?a:jr.current!==null?(s=hu(s,a,r),ga(s,t)||(Mt=!0),s):(gl&42)===0||(gl&1073741824)!==0&&(Ts&261930)===0?(Mt=!0,s.memoizedState=a):(s=Xf(),is.lanes|=s,Jl|=s,t)}function Xh(s,t,a,r,o){var d=Q.p;Q.p=d!==0&&8>d?d:8;var j=z.T,k={};z.T=k,gu(s,!1,t,a);try{var $=o(),le=z.S;if(le!==null&&le(k,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var pe=ay($,r);gi(s,t,pe,wa(s))}else gi(s,t,r,wa(s))}catch(be){gi(s,t,{then:function(){},status:"rejected",reason:be},wa())}finally{Q.p=d,j!==null&&k.types!==null&&(j.types=k.types),z.T=j}}function oy(){}function fu(s,t,a,r){if(s.tag!==5)throw Error(c(476));var o=Zh(s).queue;Xh(s,o,t,I,a===null?oy:function(){return Wh(s),a(r)})}function Zh(s){var t=s.memoizedState;if(t!==null)return t;t={memoizedState:I,baseState:I,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jl,lastRenderedState:I},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jl,lastRenderedState:a},next:null},s.memoizedState=t,s=s.alternate,s!==null&&(s.memoizedState=t),t}function Wh(s){var t=Zh(s);t.next===null&&(t=s.alternate.memoizedState),gi(s,t.next.queue,{},wa())}function pu(){return Gt(Di)}function ef(){return wt().memoizedState}function sf(){return wt().memoizedState}function dy(s){for(var t=s.return;t!==null;){switch(t.tag){case 24:case 3:var a=wa();s=Gl(a);var r=Vl(t,s,a);r!==null&&(ha(r,t,a),mi(r,t,a)),t={cache:Vd()},s.payload=t;return}t=t.return}}function uy(s,t,a){var r=wa();a={lane:r,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Vc(s)?af(t,a):(a=Dd(s,t,a,r),a!==null&&(ha(a,s,r),lf(a,t,r)))}function tf(s,t,a){var r=wa();gi(s,t,a,r)}function gi(s,t,a,r){var o={lane:r,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Vc(s))af(t,o);else{var d=s.alternate;if(s.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var j=t.lastRenderedState,k=d(j,a);if(o.hasEagerState=!0,o.eagerState=k,ga(k,j))return Sc(s,t,o,0),Xs===null&&_c(),!1}catch{}finally{}if(a=Dd(s,t,o,r),a!==null)return ha(a,s,r),lf(a,t,r),!0}return!1}function gu(s,t,a,r){if(r={lane:2,revertLane:Yu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Vc(s)){if(t)throw Error(c(479))}else t=Dd(s,a,r,2),t!==null&&ha(t,s,2)}function Vc(s){var t=s.alternate;return s===is||t!==null&&t===is}function af(s,t){vr=$c=!0;var a=s.pending;a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t}function lf(s,t,a){if((a&4194048)!==0){var r=t.lanes;r&=s.pendingLanes,a|=r,t.lanes=a,Jt(s,a)}}var ji={readContext:Gt,use:Pc,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useLayoutEffect:gt,useInsertionEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useSyncExternalStore:gt,useId:gt,useHostTransitionStatus:gt,useFormState:gt,useActionState:gt,useOptimistic:gt,useMemoCache:gt,useCacheRefresh:gt};ji.useEffectEvent=gt;var nf={readContext:Gt,use:Pc,useCallback:function(s,t){return aa().memoizedState=[s,t===void 0?null:t],s},useContext:Gt,useEffect:Hh,useImperativeHandle:function(s,t,a){a=a!=null?a.concat([s]):null,Fc(4194308,4,qh.bind(null,t,s),a)},useLayoutEffect:function(s,t){return Fc(4194308,4,s,t)},useInsertionEffect:function(s,t){Fc(4,2,s,t)},useMemo:function(s,t){var a=aa();t=t===void 0?null:t;var r=s();if(On){es(!0);try{s()}finally{es(!1)}}return a.memoizedState=[r,t],r},useReducer:function(s,t,a){var r=aa();if(a!==void 0){var o=a(t);if(On){es(!0);try{a(t)}finally{es(!1)}}}else o=t;return r.memoizedState=r.baseState=o,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},r.queue=s,s=s.dispatch=uy.bind(null,is,s),[r.memoizedState,s]},useRef:function(s){var t=aa();return s={current:s},t.memoizedState=s},useState:function(s){s=du(s);var t=s.queue,a=tf.bind(null,is,t);return t.dispatch=a,[s.memoizedState,a]},useDebugValue:xu,useDeferredValue:function(s,t){var a=aa();return hu(a,s,t)},useTransition:function(){var s=du(!1);return s=Xh.bind(null,is,s.queue,!0,!1),aa().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,t,a){var r=is,o=aa();if(As){if(a===void 0)throw Error(c(407));a=a()}else{if(a=t(),Xs===null)throw Error(c(349));(Ts&127)!==0||kh(r,t,a)}o.memoizedState=a;var d={value:a,getSnapshot:t};return o.queue=d,Hh(Th.bind(null,r,d,s),[s]),r.flags|=2048,br(9,{destroy:void 0},Ch.bind(null,r,d,a,t),null),a},useId:function(){var s=aa(),t=Xs.identifierPrefix;if(As){var a=tl,r=sl;a=(r&~(1<<32-bs(r)-1)).toString(32)+a,t="_"+t+"R_"+a,a=Bc++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=ly++,t="_"+t+"r_"+a.toString(32)+"_";return s.memoizedState=t},useHostTransitionStatus:pu,useFormState:Uh,useActionState:Uh,useOptimistic:function(s){var t=aa();t.memoizedState=t.baseState=s;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=gu.bind(null,is,!0,a),a.dispatch=t,[s,t]},useMemoCache:iu,useCacheRefresh:function(){return aa().memoizedState=dy.bind(null,is)},useEffectEvent:function(s){var t=aa(),a={impl:s};return t.memoizedState=a,function(){if((Is&2)!==0)throw Error(c(440));return a.impl.apply(void 0,arguments)}}},ju={readContext:Gt,use:Pc,useCallback:Qh,useContext:Gt,useEffect:mu,useImperativeHandle:Kh,useInsertionEffect:Gh,useLayoutEffect:Vh,useMemo:Yh,useReducer:Hc,useRef:Ph,useState:function(){return Hc(jl)},useDebugValue:xu,useDeferredValue:function(s,t){var a=wt();return Jh(a,Ks.memoizedState,s,t)},useTransition:function(){var s=Hc(jl)[0],t=wt().memoizedState;return[typeof s=="boolean"?s:pi(s),t]},useSyncExternalStore:Sh,useId:ef,useHostTransitionStatus:pu,useFormState:$h,useActionState:$h,useOptimistic:function(s,t){var a=wt();return Ah(a,Ks,s,t)},useMemoCache:iu,useCacheRefresh:sf};ju.useEffectEvent=Fh;var rf={readContext:Gt,use:Pc,useCallback:Qh,useContext:Gt,useEffect:mu,useImperativeHandle:Kh,useInsertionEffect:Gh,useLayoutEffect:Vh,useMemo:Yh,useReducer:ou,useRef:Ph,useState:function(){return ou(jl)},useDebugValue:xu,useDeferredValue:function(s,t){var a=wt();return Ks===null?hu(a,s,t):Jh(a,Ks.memoizedState,s,t)},useTransition:function(){var s=ou(jl)[0],t=wt().memoizedState;return[typeof s=="boolean"?s:pi(s),t]},useSyncExternalStore:Sh,useId:ef,useHostTransitionStatus:pu,useFormState:Ih,useActionState:Ih,useOptimistic:function(s,t){var a=wt();return Ks!==null?Ah(a,Ks,s,t):(a.baseState=s,[s,a.queue.dispatch])},useMemoCache:iu,useCacheRefresh:sf};rf.useEffectEvent=Fh;function vu(s,t,a,r){t=s.memoizedState,a=a(r,t),a=a==null?t:v({},t,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Nu={enqueueSetState:function(s,t,a){s=s._reactInternals;var r=wa(),o=Gl(r);o.payload=t,a!=null&&(o.callback=a),t=Vl(s,o,r),t!==null&&(ha(t,s,r),mi(t,s,r))},enqueueReplaceState:function(s,t,a){s=s._reactInternals;var r=wa(),o=Gl(r);o.tag=1,o.payload=t,a!=null&&(o.callback=a),t=Vl(s,o,r),t!==null&&(ha(t,s,r),mi(t,s,r))},enqueueForceUpdate:function(s,t){s=s._reactInternals;var a=wa(),r=Gl(a);r.tag=2,t!=null&&(r.callback=t),t=Vl(s,r,a),t!==null&&(ha(t,s,a),mi(t,s,a))}};function cf(s,t,a,r,o,d,j){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(r,d,j):t.prototype&&t.prototype.isPureReactComponent?!li(a,r)||!li(o,d):!0}function of(s,t,a,r){s=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,r),t.state!==s&&Nu.enqueueReplaceState(t,t.state,null)}function Dn(s,t){var a=t;if("ref"in t){a={};for(var r in t)r!=="ref"&&(a[r]=t[r])}if(s=s.defaultProps){a===t&&(a=v({},a));for(var o in s)a[o]===void 0&&(a[o]=s[o])}return a}function df(s){wc(s)}function uf(s){console.error(s)}function mf(s){wc(s)}function qc(s,t){try{var a=s.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function xf(s,t,a){try{var r=s.onCaughtError;r(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function bu(s,t,a){return a=Gl(a),a.tag=3,a.payload={element:null},a.callback=function(){qc(s,t)},a}function hf(s){return s=Gl(s),s.tag=3,s}function ff(s,t,a,r){var o=a.type.getDerivedStateFromError;if(typeof o=="function"){var d=r.value;s.payload=function(){return o(d)},s.callback=function(){xf(t,a,r)}}var j=a.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(s.callback=function(){xf(t,a,r),typeof o!="function"&&(Xl===null?Xl=new Set([this]):Xl.add(this));var k=r.stack;this.componentDidCatch(r.value,{componentStack:k!==null?k:""})})}function my(s,t,a,r,o){if(a.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=a.alternate,t!==null&&xr(t,a,o,!0),a=va.current,a!==null){switch(a.tag){case 31:case 13:return Ia===null?lo():a.alternate===null&&jt===0&&(jt=3),a.flags&=-257,a.flags|=65536,a.lanes=o,r===Oc?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([r]):t.add(r),qu(s,r,o)),!1;case 22:return a.flags|=65536,r===Oc?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([r]):a.add(r)),qu(s,r,o)),!1}throw Error(c(435,a.tag))}return qu(s,r,o),lo(),!1}if(As)return t=va.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,r!==Id&&(s=Error(c(422),{cause:r}),ii(La(s,a)))):(r!==Id&&(t=Error(c(423),{cause:r}),ii(La(t,a))),s=s.current.alternate,s.flags|=65536,o&=-o,s.lanes|=o,r=La(r,a),o=bu(s.stateNode,r,o),Xd(s,o),jt!==4&&(jt=2)),!1;var d=Error(c(520),{cause:r});if(d=La(d,a),ki===null?ki=[d]:ki.push(d),jt!==4&&(jt=2),t===null)return!0;r=La(r,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,s=o&-o,a.lanes|=s,s=bu(a.stateNode,r,s),Xd(a,s),!1;case 1:if(t=a.type,d=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(Xl===null||!Xl.has(d))))return a.flags|=65536,o&=-o,a.lanes|=o,o=hf(o),ff(o,s,a,r),Xd(a,o),!1}a=a.return}while(a!==null);return!1}var yu=Error(c(461)),Mt=!1;function Vt(s,t,a,r){t.child=s===null?jh(t,null,a,r):zn(t,s.child,a,r)}function pf(s,t,a,r,o){a=a.render;var d=t.ref;if("ref"in r){var j={};for(var k in r)k!=="ref"&&(j[k]=r[k])}else j=r;return Tn(t),r=au(s,t,a,j,d,o),k=lu(),s!==null&&!Mt?(nu(s,t,o),vl(s,t,o)):(As&&k&&$d(t),t.flags|=1,Vt(s,t,r,o),t.child)}function gf(s,t,a,r,o){if(s===null){var d=a.type;return typeof d=="function"&&!Rd(d)&&d.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=d,jf(s,t,d,r,o)):(s=Cc(a.type,null,r,t,t.mode,o),s.ref=t.ref,s.return=t,t.child=s)}if(d=s.child,!Mu(s,o)){var j=d.memoizedProps;if(a=a.compare,a=a!==null?a:li,a(j,r)&&s.ref===t.ref)return vl(s,t,o)}return t.flags|=1,s=xl(d,r),s.ref=t.ref,s.return=t,t.child=s}function jf(s,t,a,r,o){if(s!==null){var d=s.memoizedProps;if(li(d,r)&&s.ref===t.ref)if(Mt=!1,t.pendingProps=r=d,Mu(s,o))(s.flags&131072)!==0&&(Mt=!0);else return t.lanes=s.lanes,vl(s,t,o)}return wu(s,t,a,r,o)}function vf(s,t,a,r){var o=r.children,d=s!==null?s.memoizedState:null;if(s===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((t.flags&128)!==0){if(d=d!==null?d.baseLanes|a:a,s!==null){for(r=t.child=s.child,o=0;r!==null;)o=o|r.lanes|r.childLanes,r=r.sibling;r=o&~d}else r=0,t.child=null;return Nf(s,t,d,a,r)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},s!==null&&Ac(t,d!==null?d.cachePool:null),d!==null?bh(t,d):Wd(),yh(t);else return r=t.lanes=536870912,Nf(s,t,d!==null?d.baseLanes|a:a,a,r)}else d!==null?(Ac(t,d.cachePool),bh(t,d),Kl(),t.memoizedState=null):(s!==null&&Ac(t,null),Wd(),Kl());return Vt(s,t,o,a),t.child}function vi(s,t){return s!==null&&s.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Nf(s,t,a,r,o){var d=Kd();return d=d===null?null:{parent:Tt._currentValue,pool:d},t.memoizedState={baseLanes:a,cachePool:d},s!==null&&Ac(t,null),Wd(),yh(t),s!==null&&xr(s,t,r,!0),t.childLanes=o,null}function Kc(s,t){return t=Yc({mode:t.mode,children:t.children},s.mode),t.ref=s.ref,s.child=t,t.return=s,t}function bf(s,t,a){return zn(t,s.child,null,a),s=Kc(t,t.pendingProps),s.flags|=2,Na(t),t.memoizedState=null,s}function xy(s,t,a){var r=t.pendingProps,o=(t.flags&128)!==0;if(t.flags&=-129,s===null){if(As){if(r.mode==="hidden")return s=Kc(t,r),t.lanes=536870912,vi(null,s);if(su(t),(s=ct)?(s=Op(s,Ba),s=s!==null&&s.data==="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Bl!==null?{id:sl,overflow:tl}:null,retryLane:536870912,hydrationErrors:null},a=ah(s),a.return=t,t.child=a,Ft=t,ct=null)):s=null,s===null)throw Pl(t);return t.lanes=536870912,null}return Kc(t,r)}var d=s.memoizedState;if(d!==null){var j=d.dehydrated;if(su(t),o)if(t.flags&256)t.flags&=-257,t=bf(s,t,a);else if(t.memoizedState!==null)t.child=s.child,t.flags|=128,t=null;else throw Error(c(558));else if(Mt||xr(s,t,a,!1),o=(a&s.childLanes)!==0,Mt||o){if(r=Xs,r!==null&&(j=it(r,a),j!==0&&j!==d.retryLane))throw d.retryLane=j,_n(s,j),ha(r,s,j),yu;lo(),t=bf(s,t,a)}else s=d.treeContext,ct=Pa(j.nextSibling),Ft=t,As=!0,Il=null,Ba=!1,s!==null&&rh(t,s),t=Kc(t,r),t.flags|=4096;return t}return s=xl(s.child,{mode:r.mode,children:r.children}),s.ref=t.ref,t.child=s,s.return=t,s}function Qc(s,t){var a=t.ref;if(a===null)s!==null&&s.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(c(284));(s===null||s.ref!==a)&&(t.flags|=4194816)}}function wu(s,t,a,r,o){return Tn(t),a=au(s,t,a,r,void 0,o),r=lu(),s!==null&&!Mt?(nu(s,t,o),vl(s,t,o)):(As&&r&&$d(t),t.flags|=1,Vt(s,t,a,o),t.child)}function yf(s,t,a,r,o,d){return Tn(t),t.updateQueue=null,a=_h(t,r,a,o),wh(s),r=lu(),s!==null&&!Mt?(nu(s,t,d),vl(s,t,d)):(As&&r&&$d(t),t.flags|=1,Vt(s,t,a,d),t.child)}function wf(s,t,a,r,o){if(Tn(t),t.stateNode===null){var d=or,j=a.contextType;typeof j=="object"&&j!==null&&(d=Gt(j)),d=new a(r,d),t.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Nu,t.stateNode=d,d._reactInternals=t,d=t.stateNode,d.props=r,d.state=t.memoizedState,d.refs={},Yd(t),j=a.contextType,d.context=typeof j=="object"&&j!==null?Gt(j):or,d.state=t.memoizedState,j=a.getDerivedStateFromProps,typeof j=="function"&&(vu(t,a,j,r),d.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(j=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),j!==d.state&&Nu.enqueueReplaceState(d,d.state,null),hi(t,r,d,o),xi(),d.state=t.memoizedState),typeof d.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(s===null){d=t.stateNode;var k=t.memoizedProps,$=Dn(a,k);d.props=$;var le=d.context,pe=a.contextType;j=or,typeof pe=="object"&&pe!==null&&(j=Gt(pe));var be=a.getDerivedStateFromProps;pe=typeof be=="function"||typeof d.getSnapshotBeforeUpdate=="function",k=t.pendingProps!==k,pe||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(k||le!==j)&&of(t,d,r,j),Fl=!1;var ie=t.memoizedState;d.state=ie,hi(t,r,d,o),xi(),le=t.memoizedState,k||ie!==le||Fl?(typeof be=="function"&&(vu(t,a,be,r),le=t.memoizedState),($=Fl||cf(t,a,$,r,ie,le,j))?(pe||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=le),d.props=r,d.state=le,d.context=j,r=$):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{d=t.stateNode,Jd(s,t),j=t.memoizedProps,pe=Dn(a,j),d.props=pe,be=t.pendingProps,ie=d.context,le=a.contextType,$=or,typeof le=="object"&&le!==null&&($=Gt(le)),k=a.getDerivedStateFromProps,(le=typeof k=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(j!==be||ie!==$)&&of(t,d,r,$),Fl=!1,ie=t.memoizedState,d.state=ie,hi(t,r,d,o),xi();var ue=t.memoizedState;j!==be||ie!==ue||Fl||s!==null&&s.dependencies!==null&&Ec(s.dependencies)?(typeof k=="function"&&(vu(t,a,k,r),ue=t.memoizedState),(pe=Fl||cf(t,a,pe,r,ie,ue,$)||s!==null&&s.dependencies!==null&&Ec(s.dependencies))?(le||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(r,ue,$),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(r,ue,$)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||j===s.memoizedProps&&ie===s.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ie===s.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=ue),d.props=r,d.state=ue,d.context=$,r=pe):(typeof d.componentDidUpdate!="function"||j===s.memoizedProps&&ie===s.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ie===s.memoizedState||(t.flags|=1024),r=!1)}return d=r,Qc(s,t),r=(t.flags&128)!==0,d||r?(d=t.stateNode,a=r&&typeof a.getDerivedStateFromError!="function"?null:d.render(),t.flags|=1,s!==null&&r?(t.child=zn(t,s.child,null,o),t.child=zn(t,null,a,o)):Vt(s,t,a,o),t.memoizedState=d.state,s=t.child):s=vl(s,t,o),s}function _f(s,t,a,r){return kn(),t.flags|=256,Vt(s,t,a,r),t.child}var _u={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Su(s){return{baseLanes:s,cachePool:mh()}}function ku(s,t,a){return s=s!==null?s.childLanes&~a:0,t&&(s|=ya),s}function Sf(s,t,a){var r=t.pendingProps,o=!1,d=(t.flags&128)!==0,j;if((j=d)||(j=s!==null&&s.memoizedState===null?!1:(yt.current&2)!==0),j&&(o=!0,t.flags&=-129),j=(t.flags&32)!==0,t.flags&=-33,s===null){if(As){if(o?ql(t):Kl(),(s=ct)?(s=Op(s,Ba),s=s!==null&&s.data!=="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Bl!==null?{id:sl,overflow:tl}:null,retryLane:536870912,hydrationErrors:null},a=ah(s),a.return=t,t.child=a,Ft=t,ct=null)):s=null,s===null)throw Pl(t);return cm(s)?t.lanes=32:t.lanes=536870912,null}var k=r.children;return r=r.fallback,o?(Kl(),o=t.mode,k=Yc({mode:"hidden",children:k},o),r=Sn(r,o,a,null),k.return=t,r.return=t,k.sibling=r,t.child=k,r=t.child,r.memoizedState=Su(a),r.childLanes=ku(s,j,a),t.memoizedState=_u,vi(null,r)):(ql(t),Cu(t,k))}var $=s.memoizedState;if($!==null&&(k=$.dehydrated,k!==null)){if(d)t.flags&256?(ql(t),t.flags&=-257,t=Tu(s,t,a)):t.memoizedState!==null?(Kl(),t.child=s.child,t.flags|=128,t=null):(Kl(),k=r.fallback,o=t.mode,r=Yc({mode:"visible",children:r.children},o),k=Sn(k,o,a,null),k.flags|=2,r.return=t,k.return=t,r.sibling=k,t.child=r,zn(t,s.child,null,a),r=t.child,r.memoizedState=Su(a),r.childLanes=ku(s,j,a),t.memoizedState=_u,t=vi(null,r));else if(ql(t),cm(k)){if(j=k.nextSibling&&k.nextSibling.dataset,j)var le=j.dgst;j=le,r=Error(c(419)),r.stack="",r.digest=j,ii({value:r,source:null,stack:null}),t=Tu(s,t,a)}else if(Mt||xr(s,t,a,!1),j=(a&s.childLanes)!==0,Mt||j){if(j=Xs,j!==null&&(r=it(j,a),r!==0&&r!==$.retryLane))throw $.retryLane=r,_n(s,r),ha(j,s,r),yu;im(k)||lo(),t=Tu(s,t,a)}else im(k)?(t.flags|=192,t.child=s.child,t=null):(s=$.treeContext,ct=Pa(k.nextSibling),Ft=t,As=!0,Il=null,Ba=!1,s!==null&&rh(t,s),t=Cu(t,r.children),t.flags|=4096);return t}return o?(Kl(),k=r.fallback,o=t.mode,$=s.child,le=$.sibling,r=xl($,{mode:"hidden",children:r.children}),r.subtreeFlags=$.subtreeFlags&65011712,le!==null?k=xl(le,k):(k=Sn(k,o,a,null),k.flags|=2),k.return=t,r.return=t,r.sibling=k,t.child=r,vi(null,r),r=t.child,k=s.child.memoizedState,k===null?k=Su(a):(o=k.cachePool,o!==null?($=Tt._currentValue,o=o.parent!==$?{parent:$,pool:$}:o):o=mh(),k={baseLanes:k.baseLanes|a,cachePool:o}),r.memoizedState=k,r.childLanes=ku(s,j,a),t.memoizedState=_u,vi(s.child,r)):(ql(t),a=s.child,s=a.sibling,a=xl(a,{mode:"visible",children:r.children}),a.return=t,a.sibling=null,s!==null&&(j=t.deletions,j===null?(t.deletions=[s],t.flags|=16):j.push(s)),t.child=a,t.memoizedState=null,a)}function Cu(s,t){return t=Yc({mode:"visible",children:t},s.mode),t.return=s,s.child=t}function Yc(s,t){return s=ja(22,s,null,t),s.lanes=0,s}function Tu(s,t,a){return zn(t,s.child,null,a),s=Cu(t,t.pendingProps.children),s.flags|=2,t.memoizedState=null,s}function kf(s,t,a){s.lanes|=t;var r=s.alternate;r!==null&&(r.lanes|=t),Fd(s.return,t,a)}function Eu(s,t,a,r,o,d){var j=s.memoizedState;j===null?s.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:a,tailMode:o,treeForkCount:d}:(j.isBackwards=t,j.rendering=null,j.renderingStartTime=0,j.last=r,j.tail=a,j.tailMode=o,j.treeForkCount=d)}function Cf(s,t,a){var r=t.pendingProps,o=r.revealOrder,d=r.tail;r=r.children;var j=yt.current,k=(j&2)!==0;if(k?(j=j&1|2,t.flags|=128):j&=1,Ce(yt,j),Vt(s,t,r,a),r=As?ri:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=t.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&kf(s,a,t);else if(s.tag===19)kf(s,a,t);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(o){case"forwards":for(a=t.child,o=null;a!==null;)s=a.alternate,s!==null&&Uc(s)===null&&(o=a),a=a.sibling;a=o,a===null?(o=t.child,t.child=null):(o=a.sibling,a.sibling=null),Eu(t,!1,o,a,d,r);break;case"backwards":case"unstable_legacy-backwards":for(a=null,o=t.child,t.child=null;o!==null;){if(s=o.alternate,s!==null&&Uc(s)===null){t.child=o;break}s=o.sibling,o.sibling=a,a=o,o=s}Eu(t,!0,a,null,d,r);break;case"together":Eu(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function vl(s,t,a){if(s!==null&&(t.dependencies=s.dependencies),Jl|=t.lanes,(a&t.childLanes)===0)if(s!==null){if(xr(s,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(s!==null&&t.child!==s.child)throw Error(c(153));if(t.child!==null){for(s=t.child,a=xl(s,s.pendingProps),t.child=a,a.return=t;s.sibling!==null;)s=s.sibling,a=a.sibling=xl(s,s.pendingProps),a.return=t;a.sibling=null}return t.child}function Mu(s,t){return(s.lanes&t)!==0?!0:(s=s.dependencies,!!(s!==null&&Ec(s)))}function hy(s,t,a){switch(t.tag){case 3:Oe(t,t.stateNode.containerInfo),Hl(t,Tt,s.memoizedState.cache),kn();break;case 27:case 5:oe(t);break;case 4:Oe(t,t.stateNode.containerInfo);break;case 10:Hl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,su(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(ql(t),t.flags|=128,null):(a&t.child.childLanes)!==0?Sf(s,t,a):(ql(t),s=vl(s,t,a),s!==null?s.sibling:null);ql(t);break;case 19:var o=(s.flags&128)!==0;if(r=(a&t.childLanes)!==0,r||(xr(s,t,a,!1),r=(a&t.childLanes)!==0),o){if(r)return Cf(s,t,a);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ce(yt,yt.current),r)break;return null;case 22:return t.lanes=0,vf(s,t,a,t.pendingProps);case 24:Hl(t,Tt,s.memoizedState.cache)}return vl(s,t,a)}function Tf(s,t,a){if(s!==null)if(s.memoizedProps!==t.pendingProps)Mt=!0;else{if(!Mu(s,a)&&(t.flags&128)===0)return Mt=!1,hy(s,t,a);Mt=(s.flags&131072)!==0}else Mt=!1,As&&(t.flags&1048576)!==0&&nh(t,ri,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(s=Mn(t.elementType),t.type=s,typeof s=="function")Rd(s)?(r=Dn(s,r),t.tag=1,t=wf(null,t,s,r,a)):(t.tag=0,t=wu(null,t,s,r,a));else{if(s!=null){var o=s.$$typeof;if(o===C){t.tag=11,t=pf(null,t,s,r,a);break e}else if(o===D){t.tag=14,t=gf(null,t,s,r,a);break e}}throw t=ge(s)||s,Error(c(306,t,""))}}return t;case 0:return wu(s,t,t.type,t.pendingProps,a);case 1:return r=t.type,o=Dn(r,t.pendingProps),wf(s,t,r,o,a);case 3:e:{if(Oe(t,t.stateNode.containerInfo),s===null)throw Error(c(387));r=t.pendingProps;var d=t.memoizedState;o=d.element,Jd(s,t),hi(t,r,null,a);var j=t.memoizedState;if(r=j.cache,Hl(t,Tt,r),r!==d.cache&&Gd(t,[Tt],a,!0),xi(),r=j.element,d.isDehydrated)if(d={element:r,isDehydrated:!1,cache:j.cache},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){t=_f(s,t,r,a);break e}else if(r!==o){o=La(Error(c(424)),t),ii(o),t=_f(s,t,r,a);break e}else{switch(s=t.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ct=Pa(s.firstChild),Ft=t,As=!0,Il=null,Ba=!0,a=jh(t,null,r,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(kn(),r===o){t=vl(s,t,a);break e}Vt(s,t,r,a)}t=t.child}return t;case 26:return Qc(s,t),s===null?(a=Bp(t.type,null,t.pendingProps,null))?t.memoizedState=a:As||(a=t.type,s=t.pendingProps,r=mo(V.current).createElement(a),r[gs]=t,r[cs]=s,qt(r,a,s),$t(r),t.stateNode=r):t.memoizedState=Bp(t.type,s.memoizedProps,t.pendingProps,s.memoizedState),null;case 27:return oe(t),s===null&&As&&(r=t.stateNode=Lp(t.type,t.pendingProps,V.current),Ft=t,Ba=!0,o=ct,sn(t.type)?(om=o,ct=Pa(r.firstChild)):ct=o),Vt(s,t,t.pendingProps.children,a),Qc(s,t),s===null&&(t.flags|=4194304),t.child;case 5:return s===null&&As&&((o=r=ct)&&(r=Gy(r,t.type,t.pendingProps,Ba),r!==null?(t.stateNode=r,Ft=t,ct=Pa(r.firstChild),Ba=!1,o=!0):o=!1),o||Pl(t)),oe(t),o=t.type,d=t.pendingProps,j=s!==null?s.memoizedProps:null,r=d.children,lm(o,d)?r=null:j!==null&&lm(o,j)&&(t.flags|=32),t.memoizedState!==null&&(o=au(s,t,ny,null,null,a),Di._currentValue=o),Qc(s,t),Vt(s,t,r,a),t.child;case 6:return s===null&&As&&((s=a=ct)&&(a=Vy(a,t.pendingProps,Ba),a!==null?(t.stateNode=a,Ft=t,ct=null,s=!0):s=!1),s||Pl(t)),null;case 13:return Sf(s,t,a);case 4:return Oe(t,t.stateNode.containerInfo),r=t.pendingProps,s===null?t.child=zn(t,null,r,a):Vt(s,t,r,a),t.child;case 11:return pf(s,t,t.type,t.pendingProps,a);case 7:return Vt(s,t,t.pendingProps,a),t.child;case 8:return Vt(s,t,t.pendingProps.children,a),t.child;case 12:return Vt(s,t,t.pendingProps.children,a),t.child;case 10:return r=t.pendingProps,Hl(t,t.type,r.value),Vt(s,t,r.children,a),t.child;case 9:return o=t.type._context,r=t.pendingProps.children,Tn(t),o=Gt(o),r=r(o),t.flags|=1,Vt(s,t,r,a),t.child;case 14:return gf(s,t,t.type,t.pendingProps,a);case 15:return jf(s,t,t.type,t.pendingProps,a);case 19:return Cf(s,t,a);case 31:return xy(s,t,a);case 22:return vf(s,t,a,t.pendingProps);case 24:return Tn(t),r=Gt(Tt),s===null?(o=Kd(),o===null&&(o=Xs,d=Vd(),o.pooledCache=d,d.refCount++,d!==null&&(o.pooledCacheLanes|=a),o=d),t.memoizedState={parent:r,cache:o},Yd(t),Hl(t,Tt,o)):((s.lanes&a)!==0&&(Jd(s,t),hi(t,null,null,a),xi()),o=s.memoizedState,d=t.memoizedState,o.parent!==r?(o={parent:r,cache:r},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),Hl(t,Tt,r)):(r=d.cache,Hl(t,Tt,r),r!==o.cache&&Gd(t,[Tt],a,!0))),Vt(s,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(c(156,t.tag))}function Nl(s){s.flags|=4}function Au(s,t,a,r,o){if((t=(s.mode&32)!==0)&&(t=!1),t){if(s.flags|=16777216,(o&335544128)===o)if(s.stateNode.complete)s.flags|=8192;else if(sp())s.flags|=8192;else throw An=Oc,Qd}else s.flags&=-16777217}function Ef(s,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Gp(t))if(sp())s.flags|=8192;else throw An=Oc,Qd}function Jc(s,t){t!==null&&(s.flags|=4),s.flags&16384&&(t=s.tag!==22?Z():536870912,s.lanes|=t,Sr|=t)}function Ni(s,t){if(!As)switch(s.tailMode){case"hidden":t=s.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var r=null;a!==null;)a.alternate!==null&&(r=a),a=a.sibling;r===null?t||s.tail===null?s.tail=null:s.tail.sibling=null:r.sibling=null}}function ot(s){var t=s.alternate!==null&&s.alternate.child===s.child,a=0,r=0;if(t)for(var o=s.child;o!==null;)a|=o.lanes|o.childLanes,r|=o.subtreeFlags&65011712,r|=o.flags&65011712,o.return=s,o=o.sibling;else for(o=s.child;o!==null;)a|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=s,o=o.sibling;return s.subtreeFlags|=r,s.childLanes=a,t}function fy(s,t,a){var r=t.pendingProps;switch(Bd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ot(t),null;case 1:return ot(t),null;case 3:return a=t.stateNode,r=null,s!==null&&(r=s.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),pl(Tt),X(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(s===null||s.child===null)&&(mr(t)?Nl(t):s===null||s.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Pd())),ot(t),null;case 26:var o=t.type,d=t.memoizedState;return s===null?(Nl(t),d!==null?(ot(t),Ef(t,d)):(ot(t),Au(t,o,null,r,a))):d?d!==s.memoizedState?(Nl(t),ot(t),Ef(t,d)):(ot(t),t.flags&=-16777217):(s=s.memoizedProps,s!==r&&Nl(t),ot(t),Au(t,o,s,r,a)),null;case 27:if(Ge(t),a=V.current,o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==r&&Nl(t);else{if(!r){if(t.stateNode===null)throw Error(c(166));return ot(t),null}s=K.current,mr(t)?ih(t):(s=Lp(o,r,a),t.stateNode=s,Nl(t))}return ot(t),null;case 5:if(Ge(t),o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==r&&Nl(t);else{if(!r){if(t.stateNode===null)throw Error(c(166));return ot(t),null}if(d=K.current,mr(t))ih(t);else{var j=mo(V.current);switch(d){case 1:d=j.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:d=j.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":d=j.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":d=j.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":d=j.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof r.is=="string"?j.createElement("select",{is:r.is}):j.createElement("select"),r.multiple?d.multiple=!0:r.size&&(d.size=r.size);break;default:d=typeof r.is=="string"?j.createElement(o,{is:r.is}):j.createElement(o)}}d[gs]=t,d[cs]=r;e:for(j=t.child;j!==null;){if(j.tag===5||j.tag===6)d.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===t)break e;for(;j.sibling===null;){if(j.return===null||j.return===t)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}t.stateNode=d;e:switch(qt(d,o,r),o){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Nl(t)}}return ot(t),Au(t,t.type,s===null?null:s.memoizedProps,t.pendingProps,a),null;case 6:if(s&&t.stateNode!=null)s.memoizedProps!==r&&Nl(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(c(166));if(s=V.current,mr(t)){if(s=t.stateNode,a=t.memoizedProps,r=null,o=Ft,o!==null)switch(o.tag){case 27:case 5:r=o.memoizedProps}s[gs]=t,s=!!(s.nodeValue===a||r!==null&&r.suppressHydrationWarning===!0||Sp(s.nodeValue,a)),s||Pl(t,!0)}else s=mo(s).createTextNode(r),s[gs]=t,t.stateNode=s}return ot(t),null;case 31:if(a=t.memoizedState,s===null||s.memoizedState!==null){if(r=mr(t),a!==null){if(s===null){if(!r)throw Error(c(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(557));s[gs]=t}else kn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ot(t),s=!1}else a=Pd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=a),s=!0;if(!s)return t.flags&256?(Na(t),t):(Na(t),null);if((t.flags&128)!==0)throw Error(c(558))}return ot(t),null;case 13:if(r=t.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(o=mr(t),r!==null&&r.dehydrated!==null){if(s===null){if(!o)throw Error(c(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(c(317));o[gs]=t}else kn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ot(t),o=!1}else o=Pd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(Na(t),t):(Na(t),null)}return Na(t),(t.flags&128)!==0?(t.lanes=a,t):(a=r!==null,s=s!==null&&s.memoizedState!==null,a&&(r=t.child,o=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(o=r.alternate.memoizedState.cachePool.pool),d=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),d!==o&&(r.flags|=2048)),a!==s&&a&&(t.child.flags|=8192),Jc(t,t.updateQueue),ot(t),null);case 4:return X(),s===null&&Wu(t.stateNode.containerInfo),ot(t),null;case 10:return pl(t.type),ot(t),null;case 19:if(je(yt),r=t.memoizedState,r===null)return ot(t),null;if(o=(t.flags&128)!==0,d=r.rendering,d===null)if(o)Ni(r,!1);else{if(jt!==0||s!==null&&(s.flags&128)!==0)for(s=t.child;s!==null;){if(d=Uc(s),d!==null){for(t.flags|=128,Ni(r,!1),s=d.updateQueue,t.updateQueue=s,Jc(t,s),t.subtreeFlags=0,s=a,a=t.child;a!==null;)th(a,s),a=a.sibling;return Ce(yt,yt.current&1|2),As&&hl(t,r.treeForkCount),t.child}s=s.sibling}r.tail!==null&&ut()>so&&(t.flags|=128,o=!0,Ni(r,!1),t.lanes=4194304)}else{if(!o)if(s=Uc(d),s!==null){if(t.flags|=128,o=!0,s=s.updateQueue,t.updateQueue=s,Jc(t,s),Ni(r,!0),r.tail===null&&r.tailMode==="hidden"&&!d.alternate&&!As)return ot(t),null}else 2*ut()-r.renderingStartTime>so&&a!==536870912&&(t.flags|=128,o=!0,Ni(r,!1),t.lanes=4194304);r.isBackwards?(d.sibling=t.child,t.child=d):(s=r.last,s!==null?s.sibling=d:t.child=d,r.last=d)}return r.tail!==null?(s=r.tail,r.rendering=s,r.tail=s.sibling,r.renderingStartTime=ut(),s.sibling=null,a=yt.current,Ce(yt,o?a&1|2:a&1),As&&hl(t,r.treeForkCount),s):(ot(t),null);case 22:case 23:return Na(t),eu(),r=t.memoizedState!==null,s!==null?s.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?(a&536870912)!==0&&(t.flags&128)===0&&(ot(t),t.subtreeFlags&6&&(t.flags|=8192)):ot(t),a=t.updateQueue,a!==null&&Jc(t,a.retryQueue),a=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==a&&(t.flags|=2048),s!==null&&je(En),null;case 24:return a=null,s!==null&&(a=s.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),pl(Tt),ot(t),null;case 25:return null;case 30:return null}throw Error(c(156,t.tag))}function py(s,t){switch(Bd(t),t.tag){case 1:return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 3:return pl(Tt),X(),s=t.flags,(s&65536)!==0&&(s&128)===0?(t.flags=s&-65537|128,t):null;case 26:case 27:case 5:return Ge(t),null;case 31:if(t.memoizedState!==null){if(Na(t),t.alternate===null)throw Error(c(340));kn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 13:if(Na(t),s=t.memoizedState,s!==null&&s.dehydrated!==null){if(t.alternate===null)throw Error(c(340));kn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 19:return je(yt),null;case 4:return X(),null;case 10:return pl(t.type),null;case 22:case 23:return Na(t),eu(),s!==null&&je(En),s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 24:return pl(Tt),null;case 25:return null;default:return null}}function Mf(s,t){switch(Bd(t),t.tag){case 3:pl(Tt),X();break;case 26:case 27:case 5:Ge(t);break;case 4:X();break;case 31:t.memoizedState!==null&&Na(t);break;case 13:Na(t);break;case 19:je(yt);break;case 10:pl(t.type);break;case 22:case 23:Na(t),eu(),s!==null&&je(En);break;case 24:pl(Tt)}}function bi(s,t){try{var a=t.updateQueue,r=a!==null?a.lastEffect:null;if(r!==null){var o=r.next;a=o;do{if((a.tag&s)===s){r=void 0;var d=a.create,j=a.inst;r=d(),j.destroy=r}a=a.next}while(a!==o)}}catch(k){Vs(t,t.return,k)}}function Ql(s,t,a){try{var r=t.updateQueue,o=r!==null?r.lastEffect:null;if(o!==null){var d=o.next;r=d;do{if((r.tag&s)===s){var j=r.inst,k=j.destroy;if(k!==void 0){j.destroy=void 0,o=t;var $=a,le=k;try{le()}catch(pe){Vs(o,$,pe)}}}r=r.next}while(r!==d)}}catch(pe){Vs(t,t.return,pe)}}function Af(s){var t=s.updateQueue;if(t!==null){var a=s.stateNode;try{Nh(t,a)}catch(r){Vs(s,s.return,r)}}}function zf(s,t,a){a.props=Dn(s.type,s.memoizedProps),a.state=s.memoizedState;try{a.componentWillUnmount()}catch(r){Vs(s,t,r)}}function yi(s,t){try{var a=s.ref;if(a!==null){switch(s.tag){case 26:case 27:case 5:var r=s.stateNode;break;case 30:r=s.stateNode;break;default:r=s.stateNode}typeof a=="function"?s.refCleanup=a(r):a.current=r}}catch(o){Vs(s,t,o)}}function al(s,t){var a=s.ref,r=s.refCleanup;if(a!==null)if(typeof r=="function")try{r()}catch(o){Vs(s,t,o)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(o){Vs(s,t,o)}else a.current=null}function Of(s){var t=s.type,a=s.memoizedProps,r=s.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break e;case"img":a.src?r.src=a.src:a.srcSet&&(r.srcset=a.srcSet)}}catch(o){Vs(s,s.return,o)}}function zu(s,t,a){try{var r=s.stateNode;$y(r,s.type,a,t),r[cs]=t}catch(o){Vs(s,s.return,o)}}function Df(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&sn(s.type)||s.tag===4}function Ou(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Df(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&sn(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Du(s,t,a){var r=s.tag;if(r===5||r===6)s=s.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(s,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(s),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=ul));else if(r!==4&&(r===27&&sn(s.type)&&(a=s.stateNode,t=null),s=s.child,s!==null))for(Du(s,t,a),s=s.sibling;s!==null;)Du(s,t,a),s=s.sibling}function Xc(s,t,a){var r=s.tag;if(r===5||r===6)s=s.stateNode,t?a.insertBefore(s,t):a.appendChild(s);else if(r!==4&&(r===27&&sn(s.type)&&(a=s.stateNode),s=s.child,s!==null))for(Xc(s,t,a),s=s.sibling;s!==null;)Xc(s,t,a),s=s.sibling}function Rf(s){var t=s.stateNode,a=s.memoizedProps;try{for(var r=s.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);qt(t,r,a),t[gs]=s,t[cs]=a}catch(d){Vs(s,s.return,d)}}var bl=!1,At=!1,Ru=!1,Lf=typeof WeakSet=="function"?WeakSet:Set,Bt=null;function gy(s,t){if(s=s.containerInfo,tm=vo,s=Kx(s),Td(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var r=a.getSelection&&a.getSelection();if(r&&r.rangeCount!==0){a=r.anchorNode;var o=r.anchorOffset,d=r.focusNode;r=r.focusOffset;try{a.nodeType,d.nodeType}catch{a=null;break e}var j=0,k=-1,$=-1,le=0,pe=0,be=s,ie=null;s:for(;;){for(var ue;be!==a||o!==0&&be.nodeType!==3||(k=j+o),be!==d||r!==0&&be.nodeType!==3||($=j+r),be.nodeType===3&&(j+=be.nodeValue.length),(ue=be.firstChild)!==null;)ie=be,be=ue;for(;;){if(be===s)break s;if(ie===a&&++le===o&&(k=j),ie===d&&++pe===r&&($=j),(ue=be.nextSibling)!==null)break;be=ie,ie=be.parentNode}be=ue}a=k===-1||$===-1?null:{start:k,end:$}}else a=null}a=a||{start:0,end:0}}else a=null;for(am={focusedElem:s,selectionRange:a},vo=!1,Bt=t;Bt!==null;)if(t=Bt,s=t.child,(t.subtreeFlags&1028)!==0&&s!==null)s.return=t,Bt=s;else for(;Bt!==null;){switch(t=Bt,d=t.alternate,s=t.flags,t.tag){case 0:if((s&4)!==0&&(s=t.updateQueue,s=s!==null?s.events:null,s!==null))for(a=0;a<s.length;a++)o=s[a],o.ref.impl=o.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&d!==null){s=void 0,a=t,o=d.memoizedProps,d=d.memoizedState,r=a.stateNode;try{var He=Dn(a.type,o);s=r.getSnapshotBeforeUpdate(He,d),r.__reactInternalSnapshotBeforeUpdate=s}catch(Xe){Vs(a,a.return,Xe)}}break;case 3:if((s&1024)!==0){if(s=t.stateNode.containerInfo,a=s.nodeType,a===9)rm(s);else if(a===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":rm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(c(163))}if(s=t.sibling,s!==null){s.return=t.return,Bt=s;break}Bt=t.return}}function Uf(s,t,a){var r=a.flags;switch(a.tag){case 0:case 11:case 15:wl(s,a),r&4&&bi(5,a);break;case 1:if(wl(s,a),r&4)if(s=a.stateNode,t===null)try{s.componentDidMount()}catch(j){Vs(a,a.return,j)}else{var o=Dn(a.type,t.memoizedProps);t=t.memoizedState;try{s.componentDidUpdate(o,t,s.__reactInternalSnapshotBeforeUpdate)}catch(j){Vs(a,a.return,j)}}r&64&&Af(a),r&512&&yi(a,a.return);break;case 3:if(wl(s,a),r&64&&(s=a.updateQueue,s!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{Nh(s,t)}catch(j){Vs(a,a.return,j)}}break;case 27:t===null&&r&4&&Rf(a);case 26:case 5:wl(s,a),t===null&&r&4&&Of(a),r&512&&yi(a,a.return);break;case 12:wl(s,a);break;case 31:wl(s,a),r&4&&If(s,a);break;case 13:wl(s,a),r&4&&Pf(s,a),r&64&&(s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(a=ky.bind(null,a),qy(s,a))));break;case 22:if(r=a.memoizedState!==null||bl,!r){t=t!==null&&t.memoizedState!==null||At,o=bl;var d=At;bl=r,(At=t)&&!d?_l(s,a,(a.subtreeFlags&8772)!==0):wl(s,a),bl=o,At=d}break;case 30:break;default:wl(s,a)}}function $f(s){var t=s.alternate;t!==null&&(s.alternate=null,$f(t)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(t=s.stateNode,t!==null&&ud(t)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var xt=null,da=!1;function yl(s,t,a){for(a=a.child;a!==null;)Bf(s,t,a),a=a.sibling}function Bf(s,t,a){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(Ns,a)}catch{}switch(a.tag){case 26:At||al(a,t),yl(s,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:At||al(a,t);var r=xt,o=da;sn(a.type)&&(xt=a.stateNode,da=!1),yl(s,t,a),Ai(a.stateNode),xt=r,da=o;break;case 5:At||al(a,t);case 6:if(r=xt,o=da,xt=null,yl(s,t,a),xt=r,da=o,xt!==null)if(da)try{(xt.nodeType===9?xt.body:xt.nodeName==="HTML"?xt.ownerDocument.body:xt).removeChild(a.stateNode)}catch(d){Vs(a,t,d)}else try{xt.removeChild(a.stateNode)}catch(d){Vs(a,t,d)}break;case 18:xt!==null&&(da?(s=xt,Ap(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.stateNode),Or(s)):Ap(xt,a.stateNode));break;case 4:r=xt,o=da,xt=a.stateNode.containerInfo,da=!0,yl(s,t,a),xt=r,da=o;break;case 0:case 11:case 14:case 15:Ql(2,a,t),At||Ql(4,a,t),yl(s,t,a);break;case 1:At||(al(a,t),r=a.stateNode,typeof r.componentWillUnmount=="function"&&zf(a,t,r)),yl(s,t,a);break;case 21:yl(s,t,a);break;case 22:At=(r=At)||a.memoizedState!==null,yl(s,t,a),At=r;break;default:yl(s,t,a)}}function If(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Or(s)}catch(a){Vs(t,t.return,a)}}}function Pf(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Or(s)}catch(a){Vs(t,t.return,a)}}function jy(s){switch(s.tag){case 31:case 13:case 19:var t=s.stateNode;return t===null&&(t=s.stateNode=new Lf),t;case 22:return s=s.stateNode,t=s._retryCache,t===null&&(t=s._retryCache=new Lf),t;default:throw Error(c(435,s.tag))}}function Zc(s,t){var a=jy(s);t.forEach(function(r){if(!a.has(r)){a.add(r);var o=Cy.bind(null,s,r);r.then(o,o)}})}function ua(s,t){var a=t.deletions;if(a!==null)for(var r=0;r<a.length;r++){var o=a[r],d=s,j=t,k=j;e:for(;k!==null;){switch(k.tag){case 27:if(sn(k.type)){xt=k.stateNode,da=!1;break e}break;case 5:xt=k.stateNode,da=!1;break e;case 3:case 4:xt=k.stateNode.containerInfo,da=!0;break e}k=k.return}if(xt===null)throw Error(c(160));Bf(d,j,o),xt=null,da=!1,d=o.alternate,d!==null&&(d.return=null),o.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Hf(t,s),t=t.sibling}var Ya=null;function Hf(s,t){var a=s.alternate,r=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ua(t,s),ma(s),r&4&&(Ql(3,s,s.return),bi(3,s),Ql(5,s,s.return));break;case 1:ua(t,s),ma(s),r&512&&(At||a===null||al(a,a.return)),r&64&&bl&&(s=s.updateQueue,s!==null&&(r=s.callbacks,r!==null&&(a=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=a===null?r:a.concat(r))));break;case 26:var o=Ya;if(ua(t,s),ma(s),r&512&&(At||a===null||al(a,a.return)),r&4){var d=a!==null?a.memoizedState:null;if(r=s.memoizedState,a===null)if(r===null)if(s.stateNode===null){e:{r=s.type,a=s.memoizedProps,o=o.ownerDocument||o;s:switch(r){case"title":d=o.getElementsByTagName("title")[0],(!d||d[vn]||d[gs]||d.namespaceURI==="http://www.w3.org/2000/svg"||d.hasAttribute("itemprop"))&&(d=o.createElement(r),o.head.insertBefore(d,o.querySelector("head > title"))),qt(d,r,a),d[gs]=s,$t(d),r=d;break e;case"link":var j=Hp("link","href",o).get(r+(a.href||""));if(j){for(var k=0;k<j.length;k++)if(d=j[k],d.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&d.getAttribute("rel")===(a.rel==null?null:a.rel)&&d.getAttribute("title")===(a.title==null?null:a.title)&&d.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){j.splice(k,1);break s}}d=o.createElement(r),qt(d,r,a),o.head.appendChild(d);break;case"meta":if(j=Hp("meta","content",o).get(r+(a.content||""))){for(k=0;k<j.length;k++)if(d=j[k],d.getAttribute("content")===(a.content==null?null:""+a.content)&&d.getAttribute("name")===(a.name==null?null:a.name)&&d.getAttribute("property")===(a.property==null?null:a.property)&&d.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&d.getAttribute("charset")===(a.charSet==null?null:a.charSet)){j.splice(k,1);break s}}d=o.createElement(r),qt(d,r,a),o.head.appendChild(d);break;default:throw Error(c(468,r))}d[gs]=s,$t(d),r=d}s.stateNode=r}else Fp(o,s.type,s.stateNode);else s.stateNode=Pp(o,r,s.memoizedProps);else d!==r?(d===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):d.count--,r===null?Fp(o,s.type,s.stateNode):Pp(o,r,s.memoizedProps)):r===null&&s.stateNode!==null&&zu(s,s.memoizedProps,a.memoizedProps)}break;case 27:ua(t,s),ma(s),r&512&&(At||a===null||al(a,a.return)),a!==null&&r&4&&zu(s,s.memoizedProps,a.memoizedProps);break;case 5:if(ua(t,s),ma(s),r&512&&(At||a===null||al(a,a.return)),s.flags&32){o=s.stateNode;try{tr(o,"")}catch(He){Vs(s,s.return,He)}}r&4&&s.stateNode!=null&&(o=s.memoizedProps,zu(s,o,a!==null?a.memoizedProps:o)),r&1024&&(Ru=!0);break;case 6:if(ua(t,s),ma(s),r&4){if(s.stateNode===null)throw Error(c(162));r=s.memoizedProps,a=s.stateNode;try{a.nodeValue=r}catch(He){Vs(s,s.return,He)}}break;case 3:if(fo=null,o=Ya,Ya=xo(t.containerInfo),ua(t,s),Ya=o,ma(s),r&4&&a!==null&&a.memoizedState.isDehydrated)try{Or(t.containerInfo)}catch(He){Vs(s,s.return,He)}Ru&&(Ru=!1,Ff(s));break;case 4:r=Ya,Ya=xo(s.stateNode.containerInfo),ua(t,s),ma(s),Ya=r;break;case 12:ua(t,s),ma(s);break;case 31:ua(t,s),ma(s),r&4&&(r=s.updateQueue,r!==null&&(s.updateQueue=null,Zc(s,r)));break;case 13:ua(t,s),ma(s),s.child.flags&8192&&s.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(eo=ut()),r&4&&(r=s.updateQueue,r!==null&&(s.updateQueue=null,Zc(s,r)));break;case 22:o=s.memoizedState!==null;var $=a!==null&&a.memoizedState!==null,le=bl,pe=At;if(bl=le||o,At=pe||$,ua(t,s),At=pe,bl=le,ma(s),r&8192)e:for(t=s.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(a===null||$||bl||At||Rn(s)),a=null,t=s;;){if(t.tag===5||t.tag===26){if(a===null){$=a=t;try{if(d=$.stateNode,o)j=d.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{k=$.stateNode;var be=$.memoizedProps.style,ie=be!=null&&be.hasOwnProperty("display")?be.display:null;k.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(He){Vs($,$.return,He)}}}else if(t.tag===6){if(a===null){$=t;try{$.stateNode.nodeValue=o?"":$.memoizedProps}catch(He){Vs($,$.return,He)}}}else if(t.tag===18){if(a===null){$=t;try{var ue=$.stateNode;o?zp(ue,!0):zp($.stateNode,!1)}catch(He){Vs($,$.return,He)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===s)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=s.updateQueue,r!==null&&(a=r.retryQueue,a!==null&&(r.retryQueue=null,Zc(s,a))));break;case 19:ua(t,s),ma(s),r&4&&(r=s.updateQueue,r!==null&&(s.updateQueue=null,Zc(s,r)));break;case 30:break;case 21:break;default:ua(t,s),ma(s)}}function ma(s){var t=s.flags;if(t&2){try{for(var a,r=s.return;r!==null;){if(Df(r)){a=r;break}r=r.return}if(a==null)throw Error(c(160));switch(a.tag){case 27:var o=a.stateNode,d=Ou(s);Xc(s,d,o);break;case 5:var j=a.stateNode;a.flags&32&&(tr(j,""),a.flags&=-33);var k=Ou(s);Xc(s,k,j);break;case 3:case 4:var $=a.stateNode.containerInfo,le=Ou(s);Du(s,le,$);break;default:throw Error(c(161))}}catch(pe){Vs(s,s.return,pe)}s.flags&=-3}t&4096&&(s.flags&=-4097)}function Ff(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var t=s;Ff(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),s=s.sibling}}function wl(s,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Uf(s,t.alternate,t),t=t.sibling}function Rn(s){for(s=s.child;s!==null;){var t=s;switch(t.tag){case 0:case 11:case 14:case 15:Ql(4,t,t.return),Rn(t);break;case 1:al(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&zf(t,t.return,a),Rn(t);break;case 27:Ai(t.stateNode);case 26:case 5:al(t,t.return),Rn(t);break;case 22:t.memoizedState===null&&Rn(t);break;case 30:Rn(t);break;default:Rn(t)}s=s.sibling}}function _l(s,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,o=s,d=t,j=d.flags;switch(d.tag){case 0:case 11:case 15:_l(o,d,a),bi(4,d);break;case 1:if(_l(o,d,a),r=d,o=r.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(le){Vs(r,r.return,le)}if(r=d,o=r.updateQueue,o!==null){var k=r.stateNode;try{var $=o.shared.hiddenCallbacks;if($!==null)for(o.shared.hiddenCallbacks=null,o=0;o<$.length;o++)vh($[o],k)}catch(le){Vs(r,r.return,le)}}a&&j&64&&Af(d),yi(d,d.return);break;case 27:Rf(d);case 26:case 5:_l(o,d,a),a&&r===null&&j&4&&Of(d),yi(d,d.return);break;case 12:_l(o,d,a);break;case 31:_l(o,d,a),a&&j&4&&If(o,d);break;case 13:_l(o,d,a),a&&j&4&&Pf(o,d);break;case 22:d.memoizedState===null&&_l(o,d,a),yi(d,d.return);break;case 30:break;default:_l(o,d,a)}t=t.sibling}}function Lu(s,t){var a=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==a&&(s!=null&&s.refCount++,a!=null&&ci(a))}function Uu(s,t){s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&ci(s))}function Ja(s,t,a,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Gf(s,t,a,r),t=t.sibling}function Gf(s,t,a,r){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Ja(s,t,a,r),o&2048&&bi(9,t);break;case 1:Ja(s,t,a,r);break;case 3:Ja(s,t,a,r),o&2048&&(s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&ci(s)));break;case 12:if(o&2048){Ja(s,t,a,r),s=t.stateNode;try{var d=t.memoizedProps,j=d.id,k=d.onPostCommit;typeof k=="function"&&k(j,t.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch($){Vs(t,t.return,$)}}else Ja(s,t,a,r);break;case 31:Ja(s,t,a,r);break;case 13:Ja(s,t,a,r);break;case 23:break;case 22:d=t.stateNode,j=t.alternate,t.memoizedState!==null?d._visibility&2?Ja(s,t,a,r):wi(s,t):d._visibility&2?Ja(s,t,a,r):(d._visibility|=2,yr(s,t,a,r,(t.subtreeFlags&10256)!==0||!1)),o&2048&&Lu(j,t);break;case 24:Ja(s,t,a,r),o&2048&&Uu(t.alternate,t);break;default:Ja(s,t,a,r)}}function yr(s,t,a,r,o){for(o=o&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var d=s,j=t,k=a,$=r,le=j.flags;switch(j.tag){case 0:case 11:case 15:yr(d,j,k,$,o),bi(8,j);break;case 23:break;case 22:var pe=j.stateNode;j.memoizedState!==null?pe._visibility&2?yr(d,j,k,$,o):wi(d,j):(pe._visibility|=2,yr(d,j,k,$,o)),o&&le&2048&&Lu(j.alternate,j);break;case 24:yr(d,j,k,$,o),o&&le&2048&&Uu(j.alternate,j);break;default:yr(d,j,k,$,o)}t=t.sibling}}function wi(s,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=s,r=t,o=r.flags;switch(r.tag){case 22:wi(a,r),o&2048&&Lu(r.alternate,r);break;case 24:wi(a,r),o&2048&&Uu(r.alternate,r);break;default:wi(a,r)}t=t.sibling}}var _i=8192;function wr(s,t,a){if(s.subtreeFlags&_i)for(s=s.child;s!==null;)Vf(s,t,a),s=s.sibling}function Vf(s,t,a){switch(s.tag){case 26:wr(s,t,a),s.flags&_i&&s.memoizedState!==null&&l0(a,Ya,s.memoizedState,s.memoizedProps);break;case 5:wr(s,t,a);break;case 3:case 4:var r=Ya;Ya=xo(s.stateNode.containerInfo),wr(s,t,a),Ya=r;break;case 22:s.memoizedState===null&&(r=s.alternate,r!==null&&r.memoizedState!==null?(r=_i,_i=16777216,wr(s,t,a),_i=r):wr(s,t,a));break;default:wr(s,t,a)}}function qf(s){var t=s.alternate;if(t!==null&&(s=t.child,s!==null)){t.child=null;do t=s.sibling,s.sibling=null,s=t;while(s!==null)}}function Si(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var r=t[a];Bt=r,Qf(r,s)}qf(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Kf(s),s=s.sibling}function Kf(s){switch(s.tag){case 0:case 11:case 15:Si(s),s.flags&2048&&Ql(9,s,s.return);break;case 3:Si(s);break;case 12:Si(s);break;case 22:var t=s.stateNode;s.memoizedState!==null&&t._visibility&2&&(s.return===null||s.return.tag!==13)?(t._visibility&=-3,Wc(s)):Si(s);break;default:Si(s)}}function Wc(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var r=t[a];Bt=r,Qf(r,s)}qf(s)}for(s=s.child;s!==null;){switch(t=s,t.tag){case 0:case 11:case 15:Ql(8,t,t.return),Wc(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,Wc(t));break;default:Wc(t)}s=s.sibling}}function Qf(s,t){for(;Bt!==null;){var a=Bt;switch(a.tag){case 0:case 11:case 15:Ql(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var r=a.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:ci(a.memoizedState.cache)}if(r=a.child,r!==null)r.return=a,Bt=r;else e:for(a=s;Bt!==null;){r=Bt;var o=r.sibling,d=r.return;if($f(r),r===a){Bt=null;break e}if(o!==null){o.return=d,Bt=o;break e}Bt=d}}}var vy={getCacheForType:function(s){var t=Gt(Tt),a=t.data.get(s);return a===void 0&&(a=s(),t.data.set(s,a)),a},cacheSignal:function(){return Gt(Tt).controller.signal}},Ny=typeof WeakMap=="function"?WeakMap:Map,Is=0,Xs=null,_s=null,Ts=0,Gs=0,ba=null,Yl=!1,_r=!1,$u=!1,Sl=0,jt=0,Jl=0,Ln=0,Bu=0,ya=0,Sr=0,ki=null,xa=null,Iu=!1,eo=0,Yf=0,so=1/0,to=null,Xl=null,Ot=0,Zl=null,kr=null,kl=0,Pu=0,Hu=null,Jf=null,Ci=0,Fu=null;function wa(){return(Is&2)!==0&&Ts!==0?Ts&-Ts:z.T!==null?Yu():re()}function Xf(){if(ya===0)if((Ts&536870912)===0||As){var s=kt;kt<<=1,(kt&3932160)===0&&(kt=262144),ya=s}else ya=536870912;return s=va.current,s!==null&&(s.flags|=32),ya}function ha(s,t,a){(s===Xs&&(Gs===2||Gs===9)||s.cancelPendingCommit!==null)&&(Cr(s,0),Wl(s,Ts,ya,!1)),De(s,a),((Is&2)===0||s!==Xs)&&(s===Xs&&((Is&2)===0&&(Ln|=a),jt===4&&Wl(s,Ts,ya,!1)),ll(s))}function Zf(s,t,a){if((Is&6)!==0)throw Error(c(327));var r=!a&&(t&127)===0&&(t&s.expiredLanes)===0||ol(s,t),o=r?wy(s,t):Vu(s,t,!0),d=r;do{if(o===0){_r&&!r&&Wl(s,t,0,!1);break}else{if(a=s.current.alternate,d&&!by(a)){o=Vu(s,t,!1),d=!1;continue}if(o===2){if(d=t,s.errorRecoveryDisabledLanes&d)var j=0;else j=s.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){t=j;e:{var k=s;o=ki;var $=k.current.memoizedState.isDehydrated;if($&&(Cr(k,j).flags|=256),j=Vu(k,j,!1),j!==2){if($u&&!$){k.errorRecoveryDisabledLanes|=d,Ln|=d,o=4;break e}d=xa,xa=o,d!==null&&(xa===null?xa=d:xa.push.apply(xa,d))}o=j}if(d=!1,o!==2)continue}}if(o===1){Cr(s,0),Wl(s,t,0,!0);break}e:{switch(r=s,d=o,d){case 0:case 1:throw Error(c(345));case 4:if((t&4194048)!==t)break;case 6:Wl(r,t,ya,!Yl);break e;case 2:xa=null;break;case 3:case 5:break;default:throw Error(c(329))}if((t&62914560)===t&&(o=eo+300-ut(),10<o)){if(Wl(r,t,ya,!Yl),el(r,0,!0)!==0)break e;kl=t,r.timeoutHandle=Ep(Wf.bind(null,r,a,xa,to,Iu,t,ya,Ln,Sr,Yl,d,"Throttled",-0,0),o);break e}Wf(r,a,xa,to,Iu,t,ya,Ln,Sr,Yl,d,null,-0,0)}}break}while(!0);ll(s)}function Wf(s,t,a,r,o,d,j,k,$,le,pe,be,ie,ue){if(s.timeoutHandle=-1,be=t.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ul},Vf(t,d,be);var He=(d&62914560)===d?eo-ut():(d&4194048)===d?Yf-ut():0;if(He=n0(be,He),He!==null){kl=d,s.cancelPendingCommit=He(ip.bind(null,s,t,d,a,r,o,j,k,$,pe,be,null,ie,ue)),Wl(s,d,j,!le);return}}ip(s,t,d,a,r,o,j,k,$)}function by(s){for(var t=s;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var r=0;r<a.length;r++){var o=a[r],d=o.getSnapshot;o=o.value;try{if(!ga(d(),o))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wl(s,t,a,r){t&=~Bu,t&=~Ln,s.suspendedLanes|=t,s.pingedLanes&=~t,r&&(s.warmLanes|=t),r=s.expirationTimes;for(var o=t;0<o;){var d=31-bs(o),j=1<<d;r[d]=-1,o&=~j}a!==0&&zt(s,a,t)}function ao(){return(Is&6)===0?(Ti(0),!1):!0}function Gu(){if(_s!==null){if(Gs===0)var s=_s.return;else s=_s,fl=Cn=null,ru(s),gr=null,di=0,s=_s;for(;s!==null;)Mf(s.alternate,s),s=s.return;_s=null}}function Cr(s,t){var a=s.timeoutHandle;a!==-1&&(s.timeoutHandle=-1,Py(a)),a=s.cancelPendingCommit,a!==null&&(s.cancelPendingCommit=null,a()),kl=0,Gu(),Xs=s,_s=a=xl(s.current,null),Ts=t,Gs=0,ba=null,Yl=!1,_r=ol(s,t),$u=!1,Sr=ya=Bu=Ln=Jl=jt=0,xa=ki=null,Iu=!1,(t&8)!==0&&(t|=t&32);var r=s.entangledLanes;if(r!==0)for(s=s.entanglements,r&=t;0<r;){var o=31-bs(r),d=1<<o;t|=s[o],r&=~d}return Sl=t,_c(),a}function ep(s,t){is=null,z.H=ji,t===pr||t===zc?(t=fh(),Gs=3):t===Qd?(t=fh(),Gs=4):Gs=t===yu?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,ba=t,_s===null&&(jt=1,qc(s,La(t,s.current)))}function sp(){var s=va.current;return s===null?!0:(Ts&4194048)===Ts?Ia===null:(Ts&62914560)===Ts||(Ts&536870912)!==0?s===Ia:!1}function tp(){var s=z.H;return z.H=ji,s===null?ji:s}function ap(){var s=z.A;return z.A=vy,s}function lo(){jt=4,Yl||(Ts&4194048)!==Ts&&va.current!==null||(_r=!0),(Jl&134217727)===0&&(Ln&134217727)===0||Xs===null||Wl(Xs,Ts,ya,!1)}function Vu(s,t,a){var r=Is;Is|=2;var o=tp(),d=ap();(Xs!==s||Ts!==t)&&(to=null,Cr(s,t)),t=!1;var j=jt;e:do try{if(Gs!==0&&_s!==null){var k=_s,$=ba;switch(Gs){case 8:Gu(),j=6;break e;case 3:case 2:case 9:case 6:va.current===null&&(t=!0);var le=Gs;if(Gs=0,ba=null,Tr(s,k,$,le),a&&_r){j=0;break e}break;default:le=Gs,Gs=0,ba=null,Tr(s,k,$,le)}}yy(),j=jt;break}catch(pe){ep(s,pe)}while(!0);return t&&s.shellSuspendCounter++,fl=Cn=null,Is=r,z.H=o,z.A=d,_s===null&&(Xs=null,Ts=0,_c()),j}function yy(){for(;_s!==null;)lp(_s)}function wy(s,t){var a=Is;Is|=2;var r=tp(),o=ap();Xs!==s||Ts!==t?(to=null,so=ut()+500,Cr(s,t)):_r=ol(s,t);e:do try{if(Gs!==0&&_s!==null){t=_s;var d=ba;s:switch(Gs){case 1:Gs=0,ba=null,Tr(s,t,d,1);break;case 2:case 9:if(xh(d)){Gs=0,ba=null,np(t);break}t=function(){Gs!==2&&Gs!==9||Xs!==s||(Gs=7),ll(s)},d.then(t,t);break e;case 3:Gs=7;break e;case 4:Gs=5;break e;case 7:xh(d)?(Gs=0,ba=null,np(t)):(Gs=0,ba=null,Tr(s,t,d,7));break;case 5:var j=null;switch(_s.tag){case 26:j=_s.memoizedState;case 5:case 27:var k=_s;if(j?Gp(j):k.stateNode.complete){Gs=0,ba=null;var $=k.sibling;if($!==null)_s=$;else{var le=k.return;le!==null?(_s=le,no(le)):_s=null}break s}}Gs=0,ba=null,Tr(s,t,d,5);break;case 6:Gs=0,ba=null,Tr(s,t,d,6);break;case 8:Gu(),jt=6;break e;default:throw Error(c(462))}}_y();break}catch(pe){ep(s,pe)}while(!0);return fl=Cn=null,z.H=r,z.A=o,Is=a,_s!==null?0:(Xs=null,Ts=0,_c(),jt)}function _y(){for(;_s!==null&&!qa();)lp(_s)}function lp(s){var t=Tf(s.alternate,s,Sl);s.memoizedProps=s.pendingProps,t===null?no(s):_s=t}function np(s){var t=s,a=t.alternate;switch(t.tag){case 15:case 0:t=yf(a,t,t.pendingProps,t.type,void 0,Ts);break;case 11:t=yf(a,t,t.pendingProps,t.type.render,t.ref,Ts);break;case 5:ru(t);default:Mf(a,t),t=_s=th(t,Sl),t=Tf(a,t,Sl)}s.memoizedProps=s.pendingProps,t===null?no(s):_s=t}function Tr(s,t,a,r){fl=Cn=null,ru(t),gr=null,di=0;var o=t.return;try{if(my(s,o,t,a,Ts)){jt=1,qc(s,La(a,s.current)),_s=null;return}}catch(d){if(o!==null)throw _s=o,d;jt=1,qc(s,La(a,s.current)),_s=null;return}t.flags&32768?(As||r===1?s=!0:_r||(Ts&536870912)!==0?s=!1:(Yl=s=!0,(r===2||r===9||r===3||r===6)&&(r=va.current,r!==null&&r.tag===13&&(r.flags|=16384))),rp(t,s)):no(t)}function no(s){var t=s;do{if((t.flags&32768)!==0){rp(t,Yl);return}s=t.return;var a=fy(t.alternate,t,Sl);if(a!==null){_s=a;return}if(t=t.sibling,t!==null){_s=t;return}_s=t=s}while(t!==null);jt===0&&(jt=5)}function rp(s,t){do{var a=py(s.alternate,s);if(a!==null){a.flags&=32767,_s=a;return}if(a=s.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(s=s.sibling,s!==null)){_s=s;return}_s=s=a}while(s!==null);jt=6,_s=null}function ip(s,t,a,r,o,d,j,k,$){s.cancelPendingCommit=null;do ro();while(Ot!==0);if((Is&6)!==0)throw Error(c(327));if(t!==null){if(t===s.current)throw Error(c(177));if(d=t.lanes|t.childLanes,d|=Od,Hs(s,a,d,j,k,$),s===Xs&&(_s=Xs=null,Ts=0),kr=t,Zl=s,kl=a,Pu=d,Hu=o,Jf=r,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ty(We,function(){return mp(),null})):(s.callbackNode=null,s.callbackPriority=0),r=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||r){r=z.T,z.T=null,o=Q.p,Q.p=2,j=Is,Is|=4;try{gy(s,t,a)}finally{Is=j,Q.p=o,z.T=r}}Ot=1,cp(),op(),dp()}}function cp(){if(Ot===1){Ot=0;var s=Zl,t=kr,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=z.T,z.T=null;var r=Q.p;Q.p=2;var o=Is;Is|=4;try{Hf(t,s);var d=am,j=Kx(s.containerInfo),k=d.focusedElem,$=d.selectionRange;if(j!==k&&k&&k.ownerDocument&&qx(k.ownerDocument.documentElement,k)){if($!==null&&Td(k)){var le=$.start,pe=$.end;if(pe===void 0&&(pe=le),"selectionStart"in k)k.selectionStart=le,k.selectionEnd=Math.min(pe,k.value.length);else{var be=k.ownerDocument||document,ie=be&&be.defaultView||window;if(ie.getSelection){var ue=ie.getSelection(),He=k.textContent.length,Xe=Math.min($.start,He),Ys=$.end===void 0?Xe:Math.min($.end,He);!ue.extend&&Xe>Ys&&(j=Ys,Ys=Xe,Xe=j);var J=Vx(k,Xe),F=Vx(k,Ys);if(J&&F&&(ue.rangeCount!==1||ue.anchorNode!==J.node||ue.anchorOffset!==J.offset||ue.focusNode!==F.node||ue.focusOffset!==F.offset)){var ae=be.createRange();ae.setStart(J.node,J.offset),ue.removeAllRanges(),Xe>Ys?(ue.addRange(ae),ue.extend(F.node,F.offset)):(ae.setEnd(F.node,F.offset),ue.addRange(ae))}}}}for(be=[],ue=k;ue=ue.parentNode;)ue.nodeType===1&&be.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<be.length;k++){var Ne=be[k];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}vo=!!tm,am=tm=null}finally{Is=o,Q.p=r,z.T=a}}s.current=t,Ot=2}}function op(){if(Ot===2){Ot=0;var s=Zl,t=kr,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=z.T,z.T=null;var r=Q.p;Q.p=2;var o=Is;Is|=4;try{Uf(s,t.alternate,t)}finally{Is=o,Q.p=r,z.T=a}}Ot=3}}function dp(){if(Ot===4||Ot===3){Ot=0,Ht();var s=Zl,t=kr,a=kl,r=Jf;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ot=5:(Ot=0,kr=Zl=null,up(s,s.pendingLanes));var o=s.pendingLanes;if(o===0&&(Xl=null),mt(a),t=t.stateNode,ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(Ns,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=z.T,o=Q.p,Q.p=2,z.T=null;try{for(var d=s.onRecoverableError,j=0;j<r.length;j++){var k=r[j];d(k.value,{componentStack:k.stack})}}finally{z.T=t,Q.p=o}}(kl&3)!==0&&ro(),ll(s),o=s.pendingLanes,(a&261930)!==0&&(o&42)!==0?s===Fu?Ci++:(Ci=0,Fu=s):Ci=0,Ti(0)}}function up(s,t){(s.pooledCacheLanes&=t)===0&&(t=s.pooledCache,t!=null&&(s.pooledCache=null,ci(t)))}function ro(){return cp(),op(),dp(),mp()}function mp(){if(Ot!==5)return!1;var s=Zl,t=Pu;Pu=0;var a=mt(kl),r=z.T,o=Q.p;try{Q.p=32>a?32:a,z.T=null,a=Hu,Hu=null;var d=Zl,j=kl;if(Ot=0,kr=Zl=null,kl=0,(Is&6)!==0)throw Error(c(331));var k=Is;if(Is|=4,Kf(d.current),Gf(d,d.current,j,a),Is=k,Ti(0,!1),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(Ns,d)}catch{}return!0}finally{Q.p=o,z.T=r,up(s,t)}}function xp(s,t,a){t=La(a,t),t=bu(s.stateNode,t,2),s=Vl(s,t,2),s!==null&&(De(s,2),ll(s))}function Vs(s,t,a){if(s.tag===3)xp(s,s,a);else for(;t!==null;){if(t.tag===3){xp(t,s,a);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Xl===null||!Xl.has(r))){s=La(a,s),a=hf(2),r=Vl(t,a,2),r!==null&&(ff(a,r,t,s),De(r,2),ll(r));break}}t=t.return}}function qu(s,t,a){var r=s.pingCache;if(r===null){r=s.pingCache=new Ny;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(a)||($u=!0,o.add(a),s=Sy.bind(null,s,t,a),t.then(s,s))}function Sy(s,t,a){var r=s.pingCache;r!==null&&r.delete(t),s.pingedLanes|=s.suspendedLanes&a,s.warmLanes&=~a,Xs===s&&(Ts&a)===a&&(jt===4||jt===3&&(Ts&62914560)===Ts&&300>ut()-eo?(Is&2)===0&&Cr(s,0):Bu|=a,Sr===Ts&&(Sr=0)),ll(s)}function hp(s,t){t===0&&(t=Z()),s=_n(s,t),s!==null&&(De(s,t),ll(s))}function ky(s){var t=s.memoizedState,a=0;t!==null&&(a=t.retryLane),hp(s,a)}function Cy(s,t){var a=0;switch(s.tag){case 31:case 13:var r=s.stateNode,o=s.memoizedState;o!==null&&(a=o.retryLane);break;case 19:r=s.stateNode;break;case 22:r=s.stateNode._retryCache;break;default:throw Error(c(314))}r!==null&&r.delete(t),hp(s,a)}function Ty(s,t){return Rt(s,t)}var io=null,Er=null,Ku=!1,co=!1,Qu=!1,en=0;function ll(s){s!==Er&&s.next===null&&(Er===null?io=Er=s:Er=Er.next=s),co=!0,Ku||(Ku=!0,My())}function Ti(s,t){if(!Qu&&co){Qu=!0;do for(var a=!1,r=io;r!==null;){if(s!==0){var o=r.pendingLanes;if(o===0)var d=0;else{var j=r.suspendedLanes,k=r.pingedLanes;d=(1<<31-bs(42|s)+1)-1,d&=o&~(j&~k),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(a=!0,jp(r,d))}else d=Ts,d=el(r,r===Xs?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(d&3)===0||ol(r,d)||(a=!0,jp(r,d));r=r.next}while(a);Qu=!1}}function Ey(){fp()}function fp(){co=Ku=!1;var s=0;en!==0&&Iy()&&(s=en);for(var t=ut(),a=null,r=io;r!==null;){var o=r.next,d=pp(r,t);d===0?(r.next=null,a===null?io=o:a.next=o,o===null&&(Er=a)):(a=r,(s!==0||(d&3)!==0)&&(co=!0)),r=o}Ot!==0&&Ot!==5||Ti(s),en!==0&&(en=0)}function pp(s,t){for(var a=s.suspendedLanes,r=s.pingedLanes,o=s.expirationTimes,d=s.pendingLanes&-62914561;0<d;){var j=31-bs(d),k=1<<j,$=o[j];$===-1?((k&a)===0||(k&r)!==0)&&(o[j]=Yn(k,t)):$<=t&&(s.expiredLanes|=k),d&=~k}if(t=Xs,a=Ts,a=el(s,s===t?a:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),r=s.callbackNode,a===0||s===t&&(Gs===2||Gs===9)||s.cancelPendingCommit!==null)return r!==null&&r!==null&&ta(r),s.callbackNode=null,s.callbackPriority=0;if((a&3)===0||ol(s,a)){if(t=a&-a,t===s.callbackPriority)return t;switch(r!==null&&ta(r),mt(a)){case 2:case 8:a=Qe;break;case 32:a=We;break;case 268435456:a=as;break;default:a=We}return r=gp.bind(null,s),a=Rt(a,r),s.callbackPriority=t,s.callbackNode=a,t}return r!==null&&r!==null&&ta(r),s.callbackPriority=2,s.callbackNode=null,2}function gp(s,t){if(Ot!==0&&Ot!==5)return s.callbackNode=null,s.callbackPriority=0,null;var a=s.callbackNode;if(ro()&&s.callbackNode!==a)return null;var r=Ts;return r=el(s,s===Xs?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),r===0?null:(Zf(s,r,t),pp(s,ut()),s.callbackNode!=null&&s.callbackNode===a?gp.bind(null,s):null)}function jp(s,t){if(ro())return null;Zf(s,t,!0)}function My(){Hy(function(){(Is&6)!==0?Rt(qe,Ey):fp()})}function Yu(){if(en===0){var s=hr;s===0&&(s=Ms,Ms<<=1,(Ms&261888)===0&&(Ms=256)),en=s}return en}function vp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:pc(""+s)}function Np(s,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,s.id&&a.setAttribute("form",s.id),t.parentNode.insertBefore(a,t),s=new FormData(s),a.parentNode.removeChild(a),s}function Ay(s,t,a,r,o){if(t==="submit"&&a&&a.stateNode===o){var d=vp((o[cs]||null).action),j=r.submitter;j&&(t=(t=j[cs]||null)?vp(t.formAction):j.getAttribute("formAction"),t!==null&&(d=t,j=null));var k=new Nc("action","action",null,r,o);s.push({event:k,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(en!==0){var $=j?Np(o,j):new FormData(o);fu(a,{pending:!0,data:$,method:o.method,action:d},null,$)}}else typeof d=="function"&&(k.preventDefault(),$=j?Np(o,j):new FormData(o),fu(a,{pending:!0,data:$,method:o.method,action:d},d,$))},currentTarget:o}]})}}for(var Ju=0;Ju<zd.length;Ju++){var Xu=zd[Ju],zy=Xu.toLowerCase(),Oy=Xu[0].toUpperCase()+Xu.slice(1);Qa(zy,"on"+Oy)}Qa(Jx,"onAnimationEnd"),Qa(Xx,"onAnimationIteration"),Qa(Zx,"onAnimationStart"),Qa("dblclick","onDoubleClick"),Qa("focusin","onFocus"),Qa("focusout","onBlur"),Qa(Yb,"onTransitionRun"),Qa(Jb,"onTransitionStart"),Qa(Xb,"onTransitionCancel"),Qa(Wx,"onTransitionEnd"),er("onMouseEnter",["mouseout","mouseover"]),er("onMouseLeave",["mouseout","mouseover"]),er("onPointerEnter",["pointerout","pointerover"]),er("onPointerLeave",["pointerout","pointerover"]),Nn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Nn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Nn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Nn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Nn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Nn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ei="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ei));function bp(s,t){t=(t&4)!==0;for(var a=0;a<s.length;a++){var r=s[a],o=r.event;r=r.listeners;e:{var d=void 0;if(t)for(var j=r.length-1;0<=j;j--){var k=r[j],$=k.instance,le=k.currentTarget;if(k=k.listener,$!==d&&o.isPropagationStopped())break e;d=k,o.currentTarget=le;try{d(o)}catch(pe){wc(pe)}o.currentTarget=null,d=$}else for(j=0;j<r.length;j++){if(k=r[j],$=k.instance,le=k.currentTarget,k=k.listener,$!==d&&o.isPropagationStopped())break e;d=k,o.currentTarget=le;try{d(o)}catch(pe){wc(pe)}o.currentTarget=null,d=$}}}}function Ss(s,t){var a=t[Ka];a===void 0&&(a=t[Ka]=new Set);var r=s+"__bubble";a.has(r)||(yp(t,s,2,!1),a.add(r))}function Zu(s,t,a){var r=0;t&&(r|=4),yp(a,s,r,t)}var oo="_reactListening"+Math.random().toString(36).slice(2);function Wu(s){if(!s[oo]){s[oo]=!0,hx.forEach(function(a){a!=="selectionchange"&&(Dy.has(a)||Zu(a,!1,s),Zu(a,!0,s))});var t=s.nodeType===9?s:s.ownerDocument;t===null||t[oo]||(t[oo]=!0,Zu("selectionchange",!1,t))}}function yp(s,t,a,r){switch(Xp(t)){case 2:var o=c0;break;case 8:o=o0;break;default:o=hm}a=o.bind(null,t,a,s),o=void 0,!vd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?s.addEventListener(t,a,{capture:!0,passive:o}):s.addEventListener(t,a,!0):o!==void 0?s.addEventListener(t,a,{passive:o}):s.addEventListener(t,a,!1)}function em(s,t,a,r,o){var d=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var j=r.tag;if(j===3||j===4){var k=r.stateNode.containerInfo;if(k===o)break;if(j===4)for(j=r.return;j!==null;){var $=j.tag;if(($===3||$===4)&&j.stateNode.containerInfo===o)return;j=j.return}for(;k!==null;){if(j=Xn(k),j===null)return;if($=j.tag,$===5||$===6||$===26||$===27){r=d=j;continue e}k=k.parentNode}}r=r.return}kx(function(){var le=d,pe=gd(a),be=[];e:{var ie=eh.get(s);if(ie!==void 0){var ue=Nc,He=s;switch(s){case"keypress":if(jc(a)===0)break e;case"keydown":case"keyup":ue=Cb;break;case"focusin":He="focus",ue=wd;break;case"focusout":He="blur",ue=wd;break;case"beforeblur":case"afterblur":ue=wd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=Ex;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=fb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=Mb;break;case Jx:case Xx:case Zx:ue=jb;break;case Wx:ue=zb;break;case"scroll":case"scrollend":ue=xb;break;case"wheel":ue=Db;break;case"copy":case"cut":case"paste":ue=Nb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=Ax;break;case"toggle":case"beforetoggle":ue=Lb}var Xe=(t&4)!==0,Ys=!Xe&&(s==="scroll"||s==="scrollend"),J=Xe?ie!==null?ie+"Capture":null:ie;Xe=[];for(var F=le,ae;F!==null;){var Ne=F;if(ae=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||ae===null||J===null||(Ne=Xr(F,J),Ne!=null&&Xe.push(Mi(F,Ne,ae))),Ys)break;F=F.return}0<Xe.length&&(ie=new ue(ie,He,null,a,pe),be.push({event:ie,listeners:Xe}))}}if((t&7)===0){e:{if(ie=s==="mouseover"||s==="pointerover",ue=s==="mouseout"||s==="pointerout",ie&&a!==pd&&(He=a.relatedTarget||a.fromElement)&&(Xn(He)||He[Ct]))break e;if((ue||ie)&&(ie=pe.window===pe?pe:(ie=pe.ownerDocument)?ie.defaultView||ie.parentWindow:window,ue?(He=a.relatedTarget||a.toElement,ue=le,He=He?Xn(He):null,He!==null&&(Ys=x(He),Xe=He.tag,He!==Ys||Xe!==5&&Xe!==27&&Xe!==6)&&(He=null)):(ue=null,He=le),ue!==He)){if(Xe=Ex,Ne="onMouseLeave",J="onMouseEnter",F="mouse",(s==="pointerout"||s==="pointerover")&&(Xe=Ax,Ne="onPointerLeave",J="onPointerEnter",F="pointer"),Ys=ue==null?ie:Jr(ue),ae=He==null?ie:Jr(He),ie=new Xe(Ne,F+"leave",ue,a,pe),ie.target=Ys,ie.relatedTarget=ae,Ne=null,Xn(pe)===le&&(Xe=new Xe(J,F+"enter",He,a,pe),Xe.target=ae,Xe.relatedTarget=Ys,Ne=Xe),Ys=Ne,ue&&He)s:{for(Xe=Ry,J=ue,F=He,ae=0,Ne=J;Ne;Ne=Xe(Ne))ae++;Ne=0;for(var Ye=F;Ye;Ye=Xe(Ye))Ne++;for(;0<ae-Ne;)J=Xe(J),ae--;for(;0<Ne-ae;)F=Xe(F),Ne--;for(;ae--;){if(J===F||F!==null&&J===F.alternate){Xe=J;break s}J=Xe(J),F=Xe(F)}Xe=null}else Xe=null;ue!==null&&wp(be,ie,ue,Xe,!1),He!==null&&Ys!==null&&wp(be,Ys,He,Xe,!0)}}e:{if(ie=le?Jr(le):window,ue=ie.nodeName&&ie.nodeName.toLowerCase(),ue==="select"||ue==="input"&&ie.type==="file")var Ds=Bx;else if(Ux(ie))if(Ix)Ds=qb;else{Ds=Gb;var Ve=Fb}else ue=ie.nodeName,!ue||ue.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?le&&fd(le.elementType)&&(Ds=Bx):Ds=Vb;if(Ds&&(Ds=Ds(s,le))){$x(be,Ds,a,pe);break e}Ve&&Ve(s,ie,le),s==="focusout"&&le&&ie.type==="number"&&le.memoizedProps.value!=null&&hd(ie,"number",ie.value)}switch(Ve=le?Jr(le):window,s){case"focusin":(Ux(Ve)||Ve.contentEditable==="true")&&(rr=Ve,Ed=le,ni=null);break;case"focusout":ni=Ed=rr=null;break;case"mousedown":Md=!0;break;case"contextmenu":case"mouseup":case"dragend":Md=!1,Qx(be,a,pe);break;case"selectionchange":if(Qb)break;case"keydown":case"keyup":Qx(be,a,pe)}var os;if(Sd)e:{switch(s){case"compositionstart":var Es="onCompositionStart";break e;case"compositionend":Es="onCompositionEnd";break e;case"compositionupdate":Es="onCompositionUpdate";break e}Es=void 0}else nr?Rx(s,a)&&(Es="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&(Es="onCompositionStart");Es&&(zx&&a.locale!=="ko"&&(nr||Es!=="onCompositionStart"?Es==="onCompositionEnd"&&nr&&(os=Cx()):($l=pe,Nd="value"in $l?$l.value:$l.textContent,nr=!0)),Ve=uo(le,Es),0<Ve.length&&(Es=new Mx(Es,s,null,a,pe),be.push({event:Es,listeners:Ve}),os?Es.data=os:(os=Lx(a),os!==null&&(Es.data=os)))),(os=$b?Bb(s,a):Ib(s,a))&&(Es=uo(le,"onBeforeInput"),0<Es.length&&(Ve=new Mx("onBeforeInput","beforeinput",null,a,pe),be.push({event:Ve,listeners:Es}),Ve.data=os)),Ay(be,s,le,a,pe)}bp(be,t)})}function Mi(s,t,a){return{instance:s,listener:t,currentTarget:a}}function uo(s,t){for(var a=t+"Capture",r=[];s!==null;){var o=s,d=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||d===null||(o=Xr(s,a),o!=null&&r.unshift(Mi(s,o,d)),o=Xr(s,t),o!=null&&r.push(Mi(s,o,d))),s.tag===3)return r;s=s.return}return[]}function Ry(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function wp(s,t,a,r,o){for(var d=t._reactName,j=[];a!==null&&a!==r;){var k=a,$=k.alternate,le=k.stateNode;if(k=k.tag,$!==null&&$===r)break;k!==5&&k!==26&&k!==27||le===null||($=le,o?(le=Xr(a,d),le!=null&&j.unshift(Mi(a,le,$))):o||(le=Xr(a,d),le!=null&&j.push(Mi(a,le,$)))),a=a.return}j.length!==0&&s.push({event:t,listeners:j})}var Ly=/\r\n?/g,Uy=/\u0000|\uFFFD/g;function _p(s){return(typeof s=="string"?s:""+s).replace(Ly,`
`).replace(Uy,"")}function Sp(s,t){return t=_p(t),_p(s)===t}function Qs(s,t,a,r,o,d){switch(a){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||tr(s,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&tr(s,""+r);break;case"className":hc(s,"class",r);break;case"tabIndex":hc(s,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":hc(s,a,r);break;case"style":_x(s,r,d);break;case"data":if(t!=="object"){hc(s,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||a!=="href")){s.removeAttribute(a);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){s.removeAttribute(a);break}r=pc(""+r),s.setAttribute(a,r);break;case"action":case"formAction":if(typeof r=="function"){s.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof d=="function"&&(a==="formAction"?(t!=="input"&&Qs(s,t,"name",o.name,o,null),Qs(s,t,"formEncType",o.formEncType,o,null),Qs(s,t,"formMethod",o.formMethod,o,null),Qs(s,t,"formTarget",o.formTarget,o,null)):(Qs(s,t,"encType",o.encType,o,null),Qs(s,t,"method",o.method,o,null),Qs(s,t,"target",o.target,o,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){s.removeAttribute(a);break}r=pc(""+r),s.setAttribute(a,r);break;case"onClick":r!=null&&(s.onclick=ul);break;case"onScroll":r!=null&&Ss("scroll",s);break;case"onScrollEnd":r!=null&&Ss("scrollend",s);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(c(61));if(a=r.__html,a!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=a}}break;case"multiple":s.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":s.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){s.removeAttribute("xlink:href");break}a=pc(""+r),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?s.setAttribute(a,""+r):s.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?s.setAttribute(a,""):s.removeAttribute(a);break;case"capture":case"download":r===!0?s.setAttribute(a,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?s.setAttribute(a,r):s.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?s.setAttribute(a,r):s.removeAttribute(a);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?s.removeAttribute(a):s.setAttribute(a,r);break;case"popover":Ss("beforetoggle",s),Ss("toggle",s),xc(s,"popover",r);break;case"xlinkActuate":dl(s,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":dl(s,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":dl(s,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":dl(s,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":dl(s,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":dl(s,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":dl(s,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":dl(s,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":dl(s,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":xc(s,"is",r);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=ub.get(a)||a,xc(s,a,r))}}function sm(s,t,a,r,o,d){switch(a){case"style":_x(s,r,d);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(c(61));if(a=r.__html,a!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=a}}break;case"children":typeof r=="string"?tr(s,r):(typeof r=="number"||typeof r=="bigint")&&tr(s,""+r);break;case"onScroll":r!=null&&Ss("scroll",s);break;case"onScrollEnd":r!=null&&Ss("scrollend",s);break;case"onClick":r!=null&&(s.onclick=ul);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fx.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(o=a.endsWith("Capture"),t=a.slice(2,o?a.length-7:void 0),d=s[cs]||null,d=d!=null?d[a]:null,typeof d=="function"&&s.removeEventListener(t,d,o),typeof r=="function")){typeof d!="function"&&d!==null&&(a in s?s[a]=null:s.hasAttribute(a)&&s.removeAttribute(a)),s.addEventListener(t,r,o);break e}a in s?s[a]=r:r===!0?s.setAttribute(a,""):xc(s,a,r)}}}function qt(s,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ss("error",s),Ss("load",s);var r=!1,o=!1,d;for(d in a)if(a.hasOwnProperty(d)){var j=a[d];if(j!=null)switch(d){case"src":r=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:Qs(s,t,d,j,a,null)}}o&&Qs(s,t,"srcSet",a.srcSet,a,null),r&&Qs(s,t,"src",a.src,a,null);return;case"input":Ss("invalid",s);var k=d=j=o=null,$=null,le=null;for(r in a)if(a.hasOwnProperty(r)){var pe=a[r];if(pe!=null)switch(r){case"name":o=pe;break;case"type":j=pe;break;case"checked":$=pe;break;case"defaultChecked":le=pe;break;case"value":d=pe;break;case"defaultValue":k=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(c(137,t));break;default:Qs(s,t,r,pe,a,null)}}Nx(s,d,k,$,le,j,o,!1);return;case"select":Ss("invalid",s),r=j=d=null;for(o in a)if(a.hasOwnProperty(o)&&(k=a[o],k!=null))switch(o){case"value":d=k;break;case"defaultValue":j=k;break;case"multiple":r=k;default:Qs(s,t,o,k,a,null)}t=d,a=j,s.multiple=!!r,t!=null?sr(s,!!r,t,!1):a!=null&&sr(s,!!r,a,!0);return;case"textarea":Ss("invalid",s),d=o=r=null;for(j in a)if(a.hasOwnProperty(j)&&(k=a[j],k!=null))switch(j){case"value":r=k;break;case"defaultValue":o=k;break;case"children":d=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(c(91));break;default:Qs(s,t,j,k,a,null)}yx(s,r,o,d);return;case"option":for($ in a)if(a.hasOwnProperty($)&&(r=a[$],r!=null))switch($){case"selected":s.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:Qs(s,t,$,r,a,null)}return;case"dialog":Ss("beforetoggle",s),Ss("toggle",s),Ss("cancel",s),Ss("close",s);break;case"iframe":case"object":Ss("load",s);break;case"video":case"audio":for(r=0;r<Ei.length;r++)Ss(Ei[r],s);break;case"image":Ss("error",s),Ss("load",s);break;case"details":Ss("toggle",s);break;case"embed":case"source":case"link":Ss("error",s),Ss("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in a)if(a.hasOwnProperty(le)&&(r=a[le],r!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:Qs(s,t,le,r,a,null)}return;default:if(fd(t)){for(pe in a)a.hasOwnProperty(pe)&&(r=a[pe],r!==void 0&&sm(s,t,pe,r,a,void 0));return}}for(k in a)a.hasOwnProperty(k)&&(r=a[k],r!=null&&Qs(s,t,k,r,a,null))}function $y(s,t,a,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,d=null,j=null,k=null,$=null,le=null,pe=null;for(ue in a){var be=a[ue];if(a.hasOwnProperty(ue)&&be!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":$=be;default:r.hasOwnProperty(ue)||Qs(s,t,ue,null,r,be)}}for(var ie in r){var ue=r[ie];if(be=a[ie],r.hasOwnProperty(ie)&&(ue!=null||be!=null))switch(ie){case"type":d=ue;break;case"name":o=ue;break;case"checked":le=ue;break;case"defaultChecked":pe=ue;break;case"value":j=ue;break;case"defaultValue":k=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(c(137,t));break;default:ue!==be&&Qs(s,t,ie,ue,r,be)}}xd(s,j,k,$,le,pe,d,o);return;case"select":ue=j=k=ie=null;for(d in a)if($=a[d],a.hasOwnProperty(d)&&$!=null)switch(d){case"value":break;case"multiple":ue=$;default:r.hasOwnProperty(d)||Qs(s,t,d,null,r,$)}for(o in r)if(d=r[o],$=a[o],r.hasOwnProperty(o)&&(d!=null||$!=null))switch(o){case"value":ie=d;break;case"defaultValue":k=d;break;case"multiple":j=d;default:d!==$&&Qs(s,t,o,d,r,$)}t=k,a=j,r=ue,ie!=null?sr(s,!!a,ie,!1):!!r!=!!a&&(t!=null?sr(s,!!a,t,!0):sr(s,!!a,a?[]:"",!1));return;case"textarea":ue=ie=null;for(k in a)if(o=a[k],a.hasOwnProperty(k)&&o!=null&&!r.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Qs(s,t,k,null,r,o)}for(j in r)if(o=r[j],d=a[j],r.hasOwnProperty(j)&&(o!=null||d!=null))switch(j){case"value":ie=o;break;case"defaultValue":ue=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(c(91));break;default:o!==d&&Qs(s,t,j,o,r,d)}bx(s,ie,ue);return;case"option":for(var He in a)if(ie=a[He],a.hasOwnProperty(He)&&ie!=null&&!r.hasOwnProperty(He))switch(He){case"selected":s.selected=!1;break;default:Qs(s,t,He,null,r,ie)}for($ in r)if(ie=r[$],ue=a[$],r.hasOwnProperty($)&&ie!==ue&&(ie!=null||ue!=null))switch($){case"selected":s.selected=ie&&typeof ie!="function"&&typeof ie!="symbol";break;default:Qs(s,t,$,ie,r,ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in a)ie=a[Xe],a.hasOwnProperty(Xe)&&ie!=null&&!r.hasOwnProperty(Xe)&&Qs(s,t,Xe,null,r,ie);for(le in r)if(ie=r[le],ue=a[le],r.hasOwnProperty(le)&&ie!==ue&&(ie!=null||ue!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(c(137,t));break;default:Qs(s,t,le,ie,r,ue)}return;default:if(fd(t)){for(var Ys in a)ie=a[Ys],a.hasOwnProperty(Ys)&&ie!==void 0&&!r.hasOwnProperty(Ys)&&sm(s,t,Ys,void 0,r,ie);for(pe in r)ie=r[pe],ue=a[pe],!r.hasOwnProperty(pe)||ie===ue||ie===void 0&&ue===void 0||sm(s,t,pe,ie,r,ue);return}}for(var J in a)ie=a[J],a.hasOwnProperty(J)&&ie!=null&&!r.hasOwnProperty(J)&&Qs(s,t,J,null,r,ie);for(be in r)ie=r[be],ue=a[be],!r.hasOwnProperty(be)||ie===ue||ie==null&&ue==null||Qs(s,t,be,ie,r,ue)}function kp(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function By(){if(typeof performance.getEntriesByType=="function"){for(var s=0,t=0,a=performance.getEntriesByType("resource"),r=0;r<a.length;r++){var o=a[r],d=o.transferSize,j=o.initiatorType,k=o.duration;if(d&&k&&kp(j)){for(j=0,k=o.responseEnd,r+=1;r<a.length;r++){var $=a[r],le=$.startTime;if(le>k)break;var pe=$.transferSize,be=$.initiatorType;pe&&kp(be)&&($=$.responseEnd,j+=pe*($<k?1:(k-le)/($-le)))}if(--r,t+=8*(d+j)/(o.duration/1e3),s++,10<s)break}}if(0<s)return t/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var tm=null,am=null;function mo(s){return s.nodeType===9?s:s.ownerDocument}function Cp(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tp(s,t){if(s===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&t==="foreignObject"?0:s}function lm(s,t){return s==="textarea"||s==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var nm=null;function Iy(){var s=window.event;return s&&s.type==="popstate"?s===nm?!1:(nm=s,!0):(nm=null,!1)}var Ep=typeof setTimeout=="function"?setTimeout:void 0,Py=typeof clearTimeout=="function"?clearTimeout:void 0,Mp=typeof Promise=="function"?Promise:void 0,Hy=typeof queueMicrotask=="function"?queueMicrotask:typeof Mp<"u"?function(s){return Mp.resolve(null).then(s).catch(Fy)}:Ep;function Fy(s){setTimeout(function(){throw s})}function sn(s){return s==="head"}function Ap(s,t){var a=t,r=0;do{var o=a.nextSibling;if(s.removeChild(a),o&&o.nodeType===8)if(a=o.data,a==="/$"||a==="/&"){if(r===0){s.removeChild(o),Or(t);return}r--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")r++;else if(a==="html")Ai(s.ownerDocument.documentElement);else if(a==="head"){a=s.ownerDocument.head,Ai(a);for(var d=a.firstChild;d;){var j=d.nextSibling,k=d.nodeName;d[vn]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&d.rel.toLowerCase()==="stylesheet"||a.removeChild(d),d=j}}else a==="body"&&Ai(s.ownerDocument.body);a=o}while(a);Or(t)}function zp(s,t){var a=s;s=0;do{var r=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),r&&r.nodeType===8)if(a=r.data,a==="/$"){if(s===0)break;s--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||s++;a=r}while(a)}function rm(s){var t=s.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":rm(a),ud(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}s.removeChild(a)}}function Gy(s,t,a,r){for(;s.nodeType===1;){var o=a;if(s.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(r){if(!s[vn])switch(t){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(d=s.getAttribute("rel"),d==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(d!==o.rel||s.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||s.getAttribute("title")!==(o.title==null?null:o.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(d=s.getAttribute("src"),(d!==(o.src==null?null:o.src)||s.getAttribute("type")!==(o.type==null?null:o.type)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&d&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(t==="input"&&s.type==="hidden"){var d=o.name==null?null:""+o.name;if(o.type==="hidden"&&s.getAttribute("name")===d)return s}else return s;if(s=Pa(s.nextSibling),s===null)break}return null}function Vy(s,t,a){if(t==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Pa(s.nextSibling),s===null))return null;return s}function Op(s,t){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!t||(s=Pa(s.nextSibling),s===null))return null;return s}function im(s){return s.data==="$?"||s.data==="$~"}function cm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function qy(s,t){var a=s.ownerDocument;if(s.data==="$~")s._reactRetry=t;else if(s.data!=="$?"||a.readyState!=="loading")t();else{var r=function(){t(),a.removeEventListener("DOMContentLoaded",r)};a.addEventListener("DOMContentLoaded",r),s._reactRetry=r}}function Pa(s){for(;s!=null;s=s.nextSibling){var t=s.nodeType;if(t===1||t===3)break;if(t===8){if(t=s.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return s}var om=null;function Dp(s){s=s.nextSibling;for(var t=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"||a==="/&"){if(t===0)return Pa(s.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}s=s.nextSibling}return null}function Rp(s){s=s.previousSibling;for(var t=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return s;t--}else a!=="/$"&&a!=="/&"||t++}s=s.previousSibling}return null}function Lp(s,t,a){switch(t=mo(a),s){case"html":if(s=t.documentElement,!s)throw Error(c(452));return s;case"head":if(s=t.head,!s)throw Error(c(453));return s;case"body":if(s=t.body,!s)throw Error(c(454));return s;default:throw Error(c(451))}}function Ai(s){for(var t=s.attributes;t.length;)s.removeAttributeNode(t[0]);ud(s)}var Ha=new Map,Up=new Set;function xo(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Cl=Q.d;Q.d={f:Ky,r:Qy,D:Yy,C:Jy,L:Xy,m:Zy,X:e0,S:Wy,M:s0};function Ky(){var s=Cl.f(),t=ao();return s||t}function Qy(s){var t=Zn(s);t!==null&&t.tag===5&&t.type==="form"?Wh(t):Cl.r(s)}var Mr=typeof document>"u"?null:document;function $p(s,t,a){var r=Mr;if(r&&typeof t=="string"&&t){var o=Da(t);o='link[rel="'+s+'"][href="'+o+'"]',typeof a=="string"&&(o+='[crossorigin="'+a+'"]'),Up.has(o)||(Up.add(o),s={rel:s,crossOrigin:a,href:t},r.querySelector(o)===null&&(t=r.createElement("link"),qt(t,"link",s),$t(t),r.head.appendChild(t)))}}function Yy(s){Cl.D(s),$p("dns-prefetch",s,null)}function Jy(s,t){Cl.C(s,t),$p("preconnect",s,t)}function Xy(s,t,a){Cl.L(s,t,a);var r=Mr;if(r&&s&&t){var o='link[rel="preload"][as="'+Da(t)+'"]';t==="image"&&a&&a.imageSrcSet?(o+='[imagesrcset="'+Da(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(o+='[imagesizes="'+Da(a.imageSizes)+'"]')):o+='[href="'+Da(s)+'"]';var d=o;switch(t){case"style":d=Ar(s);break;case"script":d=zr(s)}Ha.has(d)||(s=v({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:s,as:t},a),Ha.set(d,s),r.querySelector(o)!==null||t==="style"&&r.querySelector(zi(d))||t==="script"&&r.querySelector(Oi(d))||(t=r.createElement("link"),qt(t,"link",s),$t(t),r.head.appendChild(t)))}}function Zy(s,t){Cl.m(s,t);var a=Mr;if(a&&s){var r=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Da(r)+'"][href="'+Da(s)+'"]',d=o;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":d=zr(s)}if(!Ha.has(d)&&(s=v({rel:"modulepreload",href:s},t),Ha.set(d,s),a.querySelector(o)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Oi(d)))return}r=a.createElement("link"),qt(r,"link",s),$t(r),a.head.appendChild(r)}}}function Wy(s,t,a){Cl.S(s,t,a);var r=Mr;if(r&&s){var o=Wn(r).hoistableStyles,d=Ar(s);t=t||"default";var j=o.get(d);if(!j){var k={loading:0,preload:null};if(j=r.querySelector(zi(d)))k.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":t},a),(a=Ha.get(d))&&dm(s,a);var $=j=r.createElement("link");$t($),qt($,"link",s),$._p=new Promise(function(le,pe){$.onload=le,$.onerror=pe}),$.addEventListener("load",function(){k.loading|=1}),$.addEventListener("error",function(){k.loading|=2}),k.loading|=4,ho(j,t,r)}j={type:"stylesheet",instance:j,count:1,state:k},o.set(d,j)}}}function e0(s,t){Cl.X(s,t);var a=Mr;if(a&&s){var r=Wn(a).hoistableScripts,o=zr(s),d=r.get(o);d||(d=a.querySelector(Oi(o)),d||(s=v({src:s,async:!0},t),(t=Ha.get(o))&&um(s,t),d=a.createElement("script"),$t(d),qt(d,"link",s),a.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},r.set(o,d))}}function s0(s,t){Cl.M(s,t);var a=Mr;if(a&&s){var r=Wn(a).hoistableScripts,o=zr(s),d=r.get(o);d||(d=a.querySelector(Oi(o)),d||(s=v({src:s,async:!0,type:"module"},t),(t=Ha.get(o))&&um(s,t),d=a.createElement("script"),$t(d),qt(d,"link",s),a.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},r.set(o,d))}}function Bp(s,t,a,r){var o=(o=V.current)?xo(o):null;if(!o)throw Error(c(446));switch(s){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=Ar(a.href),a=Wn(o).hoistableStyles,r=a.get(t),r||(r={type:"style",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){s=Ar(a.href);var d=Wn(o).hoistableStyles,j=d.get(s);if(j||(o=o.ownerDocument||o,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(s,j),(d=o.querySelector(zi(s)))&&!d._p&&(j.instance=d,j.state.loading=5),Ha.has(s)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Ha.set(s,a),d||t0(o,s,a,j.state))),t&&r===null)throw Error(c(528,""));return j}if(t&&r!==null)throw Error(c(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=zr(a),a=Wn(o).hoistableScripts,r=a.get(t),r||(r={type:"script",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,s))}}function Ar(s){return'href="'+Da(s)+'"'}function zi(s){return'link[rel="stylesheet"]['+s+"]"}function Ip(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function t0(s,t,a,r){s.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=s.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),qt(t,"link",a),$t(t),s.head.appendChild(t))}function zr(s){return'[src="'+Da(s)+'"]'}function Oi(s){return"script[async]"+s}function Pp(s,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var r=s.querySelector('style[data-href~="'+Da(a.href)+'"]');if(r)return t.instance=r,$t(r),r;var o=v({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return r=(s.ownerDocument||s).createElement("style"),$t(r),qt(r,"style",o),ho(r,a.precedence,s),t.instance=r;case"stylesheet":o=Ar(a.href);var d=s.querySelector(zi(o));if(d)return t.state.loading|=4,t.instance=d,$t(d),d;r=Ip(a),(o=Ha.get(o))&&dm(r,o),d=(s.ownerDocument||s).createElement("link"),$t(d);var j=d;return j._p=new Promise(function(k,$){j.onload=k,j.onerror=$}),qt(d,"link",r),t.state.loading|=4,ho(d,a.precedence,s),t.instance=d;case"script":return d=zr(a.src),(o=s.querySelector(Oi(d)))?(t.instance=o,$t(o),o):(r=a,(o=Ha.get(d))&&(r=v({},a),um(r,o)),s=s.ownerDocument||s,o=s.createElement("script"),$t(o),qt(o,"link",r),s.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(c(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(r=t.instance,t.state.loading|=4,ho(r,a.precedence,s));return t.instance}function ho(s,t,a){for(var r=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=r.length?r[r.length-1]:null,d=o,j=0;j<r.length;j++){var k=r[j];if(k.dataset.precedence===t)d=k;else if(d!==o)break}d?d.parentNode.insertBefore(s,d.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(s,t.firstChild))}function dm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.title==null&&(s.title=t.title)}function um(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.integrity==null&&(s.integrity=t.integrity)}var fo=null;function Hp(s,t,a){if(fo===null){var r=new Map,o=fo=new Map;o.set(a,r)}else o=fo,r=o.get(a),r||(r=new Map,o.set(a,r));if(r.has(s))return r;for(r.set(s,null),a=a.getElementsByTagName(s),o=0;o<a.length;o++){var d=a[o];if(!(d[vn]||d[gs]||s==="link"&&d.getAttribute("rel")==="stylesheet")&&d.namespaceURI!=="http://www.w3.org/2000/svg"){var j=d.getAttribute(t)||"";j=s+j;var k=r.get(j);k?k.push(d):r.set(j,[d])}}return r}function Fp(s,t,a){s=s.ownerDocument||s,s.head.insertBefore(a,t==="title"?s.querySelector("head > title"):null)}function a0(s,t,a){if(a===1||t.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return s=t.disabled,typeof t.precedence=="string"&&s==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Gp(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function l0(s,t,a,r){if(a.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var o=Ar(r.href),d=t.querySelector(zi(o));if(d){t=d._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(s.count++,s=po.bind(s),t.then(s,s)),a.state.loading|=4,a.instance=d,$t(d);return}d=t.ownerDocument||t,r=Ip(r),(o=Ha.get(o))&&dm(r,o),d=d.createElement("link"),$t(d);var j=d;j._p=new Promise(function(k,$){j.onload=k,j.onerror=$}),qt(d,"link",r),a.instance=d}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(s.count++,a=po.bind(s),t.addEventListener("load",a),t.addEventListener("error",a))}}var mm=0;function n0(s,t){return s.stylesheets&&s.count===0&&jo(s,s.stylesheets),0<s.count||0<s.imgCount?function(a){var r=setTimeout(function(){if(s.stylesheets&&jo(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4+t);0<s.imgBytes&&mm===0&&(mm=62500*By());var o=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&jo(s,s.stylesheets),s.unsuspend)){var d=s.unsuspend;s.unsuspend=null,d()}},(s.imgBytes>mm?50:800)+t);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(r),clearTimeout(o)}}:null}function po(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)jo(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var go=null;function jo(s,t){s.stylesheets=null,s.unsuspend!==null&&(s.count++,go=new Map,t.forEach(r0,s),go=null,po.call(s))}function r0(s,t){if(!(t.state.loading&4)){var a=go.get(s);if(a)var r=a.get(null);else{a=new Map,go.set(s,a);for(var o=s.querySelectorAll("link[data-precedence],style[data-precedence]"),d=0;d<o.length;d++){var j=o[d];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(a.set(j.dataset.precedence,j),r=j)}r&&a.set(null,r)}o=t.instance,j=o.getAttribute("data-precedence"),d=a.get(j)||r,d===r&&a.set(null,o),a.set(j,o),this.count++,r=po.bind(this),o.addEventListener("load",r),o.addEventListener("error",r),d?d.parentNode.insertBefore(o,d.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(o,s.firstChild)),t.state.loading|=4}}var Di={$$typeof:E,Provider:null,Consumer:null,_currentValue:I,_currentValue2:I,_threadCount:0};function i0(s,t,a,r,o,d,j,k,$){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ye(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ye(0),this.hiddenUpdates=ye(null),this.identifierPrefix=r,this.onUncaughtError=o,this.onCaughtError=d,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Vp(s,t,a,r,o,d,j,k,$,le,pe,be){return s=new i0(s,t,a,j,$,le,pe,be,k),t=1,d===!0&&(t|=24),d=ja(3,null,null,t),s.current=d,d.stateNode=s,t=Vd(),t.refCount++,s.pooledCache=t,t.refCount++,d.memoizedState={element:r,isDehydrated:a,cache:t},Yd(d),s}function qp(s){return s?(s=or,s):or}function Kp(s,t,a,r,o,d){o=qp(o),r.context===null?r.context=o:r.pendingContext=o,r=Gl(t),r.payload={element:a},d=d===void 0?null:d,d!==null&&(r.callback=d),a=Vl(s,r,t),a!==null&&(ha(a,s,t),mi(a,s,t))}function Qp(s,t){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<t?a:t}}function xm(s,t){Qp(s,t),(s=s.alternate)&&Qp(s,t)}function Yp(s){if(s.tag===13||s.tag===31){var t=_n(s,67108864);t!==null&&ha(t,s,67108864),xm(s,67108864)}}function Jp(s){if(s.tag===13||s.tag===31){var t=wa();t=Xt(t);var a=_n(s,t);a!==null&&ha(a,s,t),xm(s,t)}}var vo=!0;function c0(s,t,a,r){var o=z.T;z.T=null;var d=Q.p;try{Q.p=2,hm(s,t,a,r)}finally{Q.p=d,z.T=o}}function o0(s,t,a,r){var o=z.T;z.T=null;var d=Q.p;try{Q.p=8,hm(s,t,a,r)}finally{Q.p=d,z.T=o}}function hm(s,t,a,r){if(vo){var o=fm(r);if(o===null)em(s,t,r,No,a),Zp(s,r);else if(u0(o,s,t,a,r))r.stopPropagation();else if(Zp(s,r),t&4&&-1<d0.indexOf(s)){for(;o!==null;){var d=Zn(o);if(d!==null)switch(d.tag){case 3:if(d=d.stateNode,d.current.memoizedState.isDehydrated){var j=za(d.pendingLanes);if(j!==0){var k=d;for(k.pendingLanes|=2,k.entangledLanes|=2;j;){var $=1<<31-bs(j);k.entanglements[1]|=$,j&=~$}ll(d),(Is&6)===0&&(so=ut()+500,Ti(0))}}break;case 31:case 13:k=_n(d,2),k!==null&&ha(k,d,2),ao(),xm(d,2)}if(d=fm(r),d===null&&em(s,t,r,No,a),d===o)break;o=d}o!==null&&r.stopPropagation()}else em(s,t,r,null,a)}}function fm(s){return s=gd(s),pm(s)}var No=null;function pm(s){if(No=null,s=Xn(s),s!==null){var t=x(s);if(t===null)s=null;else{var a=t.tag;if(a===13){if(s=h(t),s!==null)return s;s=null}else if(a===31){if(s=f(t),s!==null)return s;s=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;s=null}else t!==s&&(s=null)}}return No=s,null}function Xp(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(q()){case qe:return 2;case Qe:return 8;case We:case Os:return 32;case as:return 268435456;default:return 32}default:return 32}}var gm=!1,tn=null,an=null,ln=null,Ri=new Map,Li=new Map,nn=[],d0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Zp(s,t){switch(s){case"focusin":case"focusout":tn=null;break;case"dragenter":case"dragleave":an=null;break;case"mouseover":case"mouseout":ln=null;break;case"pointerover":case"pointerout":Ri.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Li.delete(t.pointerId)}}function Ui(s,t,a,r,o,d){return s===null||s.nativeEvent!==d?(s={blockedOn:t,domEventName:a,eventSystemFlags:r,nativeEvent:d,targetContainers:[o]},t!==null&&(t=Zn(t),t!==null&&Yp(t)),s):(s.eventSystemFlags|=r,t=s.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),s)}function u0(s,t,a,r,o){switch(t){case"focusin":return tn=Ui(tn,s,t,a,r,o),!0;case"dragenter":return an=Ui(an,s,t,a,r,o),!0;case"mouseover":return ln=Ui(ln,s,t,a,r,o),!0;case"pointerover":var d=o.pointerId;return Ri.set(d,Ui(Ri.get(d)||null,s,t,a,r,o)),!0;case"gotpointercapture":return d=o.pointerId,Li.set(d,Ui(Li.get(d)||null,s,t,a,r,o)),!0}return!1}function Wp(s){var t=Xn(s.target);if(t!==null){var a=x(t);if(a!==null){if(t=a.tag,t===13){if(t=h(a),t!==null){s.blockedOn=t,he(s.priority,function(){Jp(a)});return}}else if(t===31){if(t=f(a),t!==null){s.blockedOn=t,he(s.priority,function(){Jp(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function bo(s){if(s.blockedOn!==null)return!1;for(var t=s.targetContainers;0<t.length;){var a=fm(s.nativeEvent);if(a===null){a=s.nativeEvent;var r=new a.constructor(a.type,a);pd=r,a.target.dispatchEvent(r),pd=null}else return t=Zn(a),t!==null&&Yp(t),s.blockedOn=a,!1;t.shift()}return!0}function eg(s,t,a){bo(s)&&a.delete(t)}function m0(){gm=!1,tn!==null&&bo(tn)&&(tn=null),an!==null&&bo(an)&&(an=null),ln!==null&&bo(ln)&&(ln=null),Ri.forEach(eg),Li.forEach(eg)}function yo(s,t){s.blockedOn===t&&(s.blockedOn=null,gm||(gm=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,m0)))}var wo=null;function sg(s){wo!==s&&(wo=s,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){wo===s&&(wo=null);for(var t=0;t<s.length;t+=3){var a=s[t],r=s[t+1],o=s[t+2];if(typeof r!="function"){if(pm(r||a)===null)continue;break}var d=Zn(a);d!==null&&(s.splice(t,3),t-=3,fu(d,{pending:!0,data:o,method:a.method,action:r},r,o))}}))}function Or(s){function t($){return yo($,s)}tn!==null&&yo(tn,s),an!==null&&yo(an,s),ln!==null&&yo(ln,s),Ri.forEach(t),Li.forEach(t);for(var a=0;a<nn.length;a++){var r=nn[a];r.blockedOn===s&&(r.blockedOn=null)}for(;0<nn.length&&(a=nn[0],a.blockedOn===null);)Wp(a),a.blockedOn===null&&nn.shift();if(a=(s.ownerDocument||s).$$reactFormReplay,a!=null)for(r=0;r<a.length;r+=3){var o=a[r],d=a[r+1],j=o[cs]||null;if(typeof d=="function")j||sg(a);else if(j){var k=null;if(d&&d.hasAttribute("formAction")){if(o=d,j=d[cs]||null)k=j.formAction;else if(pm(o)!==null)continue}else k=j.action;typeof k=="function"?a[r+1]=k:(a.splice(r,3),r-=3),sg(a)}}}function tg(){function s(d){d.canIntercept&&d.info==="react-transition"&&d.intercept({handler:function(){return new Promise(function(j){return o=j})},focusReset:"manual",scroll:"manual"})}function t(){o!==null&&(o(),o=null),r||setTimeout(a,20)}function a(){if(!r&&!navigation.transition){var d=navigation.currentEntry;d&&d.url!=null&&navigation.navigate(d.url,{state:d.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,o=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){r=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),o!==null&&(o(),o=null)}}}function jm(s){this._internalRoot=s}_o.prototype.render=jm.prototype.render=function(s){var t=this._internalRoot;if(t===null)throw Error(c(409));var a=t.current,r=wa();Kp(a,r,s,t,null,null)},_o.prototype.unmount=jm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var t=s.containerInfo;Kp(s.current,2,null,s,null,null),ao(),t[Ct]=null}};function _o(s){this._internalRoot=s}_o.prototype.unstable_scheduleHydration=function(s){if(s){var t=re();s={blockedOn:null,target:s,priority:t};for(var a=0;a<nn.length&&t!==0&&t<nn[a].priority;a++);nn.splice(a,0,s),a===0&&Wp(s)}};var ag=n.version;if(ag!=="19.2.1")throw Error(c(527,ag,"19.2.1"));Q.findDOMNode=function(s){var t=s._reactInternals;if(t===void 0)throw typeof s.render=="function"?Error(c(188)):(s=Object.keys(s).join(","),Error(c(268,s)));return s=g(t),s=s!==null?N(s):null,s=s===null?null:s.stateNode,s};var x0={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var So=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!So.isDisabled&&So.supportsFiber)try{Ns=So.inject(x0),ls=So}catch{}}return $i.createRoot=function(s,t){if(!u(s))throw Error(c(299));var a=!1,r="",o=df,d=uf,j=mf;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(d=t.onCaughtError),t.onRecoverableError!==void 0&&(j=t.onRecoverableError)),t=Vp(s,1,!1,null,null,a,r,null,o,d,j,tg),s[Ct]=t.current,Wu(s),new jm(t)},$i.hydrateRoot=function(s,t,a){if(!u(s))throw Error(c(299));var r=!1,o="",d=df,j=uf,k=mf,$=null;return a!=null&&(a.unstable_strictMode===!0&&(r=!0),a.identifierPrefix!==void 0&&(o=a.identifierPrefix),a.onUncaughtError!==void 0&&(d=a.onUncaughtError),a.onCaughtError!==void 0&&(j=a.onCaughtError),a.onRecoverableError!==void 0&&(k=a.onRecoverableError),a.formState!==void 0&&($=a.formState)),t=Vp(s,1,!0,t,a??null,r,o,$,d,j,k,tg),t.context=qp(null),a=t.current,r=wa(),r=Xt(r),o=Gl(r),o.callback=null,Vl(a,o,r),a=r,t.current.lanes=a,De(t,a),ll(t),s[Ct]=t.current,Wu(s),new _o(t)},$i.version="19.2.1",$i}var mg;function J_(){if(mg)return ym.exports;mg=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),ym.exports=Y_(),ym.exports}var X_=J_();function P(...l){return k0(C0(l))}const Se=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:P("rounded-xl border bg-card text-card-foreground shadow",l),...n}));Se.displayName="Card";const ze=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:P("flex flex-col space-y-1.5 p-6",l),...n}));ze.displayName="CardHeader";const Re=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:P("font-semibold leading-none tracking-tight",l),...n}));Re.displayName="CardTitle";const ws=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:P("text-sm text-muted-foreground",l),...n}));ws.displayName="CardDescription";const Me=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:P("p-6 pt-0",l),...n}));Me.displayName="CardContent";const Zo=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:P("flex items-center p-6 pt-0",l),...n}));Zo.displayName="CardFooter";const ra=E0,ea=m.forwardRef(({className:l,...n},i)=>e.jsx(Ug,{ref:i,className:P("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",l),...n}));ea.displayName=Ug.displayName;const ts=m.forwardRef(({className:l,...n},i)=>e.jsx($g,{ref:i,className:P("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",l),...n}));ts.displayName=$g.displayName;const ys=m.forwardRef(({className:l,...n},i)=>e.jsx(Bg,{ref:i,className:P("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 data-[state=active]:animate-in data-[state=active]:fade-in data-[state=active]:duration-300",l),...n}));ys.displayName=Bg.displayName;const Je=m.forwardRef(({className:l,children:n,viewportRef:i,...c},u)=>e.jsxs(Ig,{ref:u,className:P("relative overflow-hidden",l),...c,children:[e.jsx(M0,{ref:i,className:"h-full w-full rounded-[inherit]",children:n}),e.jsx(Um,{}),e.jsx(Um,{orientation:"horizontal"}),e.jsx(A0,{})]}));Je.displayName=Ig.displayName;const Um=m.forwardRef(({className:l,orientation:n="vertical",...i},c)=>e.jsx(Pg,{ref:c,orientation:n,className:P("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",l),...i,children:e.jsx(z0,{className:"relative flex-1 rounded-full bg-border"})}));Um.displayName=Pg.displayName;function js({className:l,...n}){return e.jsx("div",{className:P("animate-pulse rounded-md bg-primary/10",l),...n})}const Vn=m.forwardRef(({className:l,value:n,...i},c)=>e.jsx(Hg,{ref:c,className:P("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",l),...i,children:e.jsx(O0,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));Vn.displayName=Hg.displayName;async function we(l,n){const c=n?.body instanceof FormData?{...n?.headers}:{"Content-Type":"application/json",...n?.headers},u={...n,credentials:"include",headers:c},x=await fetch(l,u);if(x.status===401)throw window.location.href="/auth",new Error("");return x}function Fs(){return{"Content-Type":"application/json"}}async function Z_(){try{await fetch("/api/webui/auth/logout",{method:"POST",credentials:"include"})}catch(l){console.error(":",l)}window.location.href="/auth"}async function tc(){try{return(await(await fetch("/api/webui/auth/check",{method:"GET",credentials:"include"})).json()).authenticated===!0}catch{return!1}}const W_={light:"",dark:".dark"},Zj=m.createContext(null);function Wj(){const l=m.useContext(Zj);if(!l)throw new Error("useChart must be used within a <ChartContainer />");return l}const Lr=m.forwardRef(({id:l,className:n,children:i,config:c,...u},x)=>{const h=m.useId(),f=`chart-${l||h.replace(/:/g,"")}`;return e.jsx(Zj.Provider,{value:{config:c},children:e.jsxs("div",{"data-chart":f,ref:x,className:P("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",n),...u,children:[e.jsx(e2,{id:f,config:c}),e.jsx(rj,{children:i})]})})});Lr.displayName="Chart";const e2=({id:l,config:n})=>{const i=Object.entries(n).filter(([,c])=>c.theme||c.color);return i.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(W_).map(([c,u])=>`
${u} [data-chart=${l}] {
${i.map(([x,h])=>{const f=h.theme?.[c]||h.color;return f?`  --color-${x}: ${f};`:null}).join(`
`)}
}
`).join(`
`)}}):null},Bi=ij,Ur=m.forwardRef(({active:l,payload:n,className:i,indicator:c="dot",hideLabel:u=!1,hideIndicator:x=!1,label:h,labelFormatter:f,labelClassName:p,formatter:g,color:N,nameKey:v,labelKey:y},w)=>{const{config:b}=Wj(),O=m.useMemo(()=>{if(u||!n?.length)return null;const[_]=n,H=`${y||_?.dataKey||_?.name||"value"}`,E=$m(b,_,H),C=!y&&typeof h=="string"?b[h]?.label||h:E?.label;return f?e.jsx("div",{className:P("font-medium",p),children:f(C,n)}):C?e.jsx("div",{className:P("font-medium",p),children:C}):null},[h,f,n,u,p,b,y]);if(!l||!n?.length)return null;const A=n.length===1&&c!=="dot";return e.jsxs("div",{ref:w,className:P("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",i),children:[A?null:O,e.jsx("div",{className:"grid gap-1.5",children:n.filter(_=>_.type!=="none").map((_,H)=>{const E=`${v||_.name||_.dataKey||"value"}`,C=$m(b,_,E),M=N||_.payload.fill||_.color;return e.jsx("div",{className:P("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",c==="dot"&&"items-center"),children:g&&_?.value!==void 0&&_.name?g(_.value,_.name,_,H,_.payload):e.jsxs(e.Fragment,{children:[C?.icon?e.jsx(C.icon,{}):!x&&e.jsx("div",{className:P("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":c==="dot","w-1":c==="line","w-0 border-[1.5px] border-dashed bg-transparent":c==="dashed","my-0.5":A&&c==="dashed"}),style:{"--color-bg":M,"--color-border":M}}),e.jsxs("div",{className:P("flex flex-1 justify-between leading-none",A?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[A?O:null,e.jsx("span",{className:"text-muted-foreground",children:C?.label||_.name})]}),_.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:_.value.toLocaleString()})]})]})},_.dataKey)})})]})});Ur.displayName="ChartTooltip";const s2=uw,ev=m.forwardRef(({className:l,hideIcon:n=!1,payload:i,verticalAlign:c="bottom",nameKey:u},x)=>{const{config:h}=Wj();return i?.length?e.jsx("div",{ref:x,className:P("flex items-center justify-center gap-4",c==="top"?"pb-3":"pt-3",l),children:i.filter(f=>f.type!=="none").map(f=>{const p=`${u||f.dataKey||"value"}`,g=$m(h,f,p);return e.jsxs("div",{className:P("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[g?.icon&&!n?e.jsx(g.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:f.color}}),g?.label]},f.value)})}):null});ev.displayName="ChartLegend";function $m(l,n,i){if(typeof n!="object"||n===null)return;const c="payload"in n&&typeof n.payload=="object"&&n.payload!==null?n.payload:void 0;let u=i;return i in n&&typeof n[i]=="string"?u=n[i]:c&&i in c&&typeof c[i]=="string"&&(u=c[i]),u in l?l[u]:l[i]}const Vr=qr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),S=m.forwardRef(({className:l,variant:n,size:i,asChild:c=!1,...u},x)=>{const h=c?gw:"button";return e.jsx(h,{className:P(Vr({variant:n,size:i,className:l})),ref:x,...u})});S.displayName="Button";const t2=qr("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ke({className:l,variant:n,...i}){return e.jsx("div",{className:P(t2({variant:n}),l),...i})}async function a2(){const l=await we("/api/webui/system/restart",{method:"POST",headers:Fs()});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return await l.json()}async function l2(){const l=await we("/api/webui/system/status",{method:"GET",headers:Fs()});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return await l.json()}const Dr={INITIAL_DELAY:3e3,CHECK_INTERVAL:2e3,CHECK_TIMEOUT:3e3,MAX_ATTEMPTS:60,PROGRESS_INTERVAL:200,SUCCESS_REDIRECT_DELAY:1500},sv=m.createContext(null);function Kn({children:l,onRestartComplete:n,onRestartFailed:i,healthCheckUrl:c="/api/webui/system/status",maxAttempts:u=Dr.MAX_ATTEMPTS}){const[x,h]=m.useState({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:u}),[f,p]=m.useState({}),g=m.useCallback(()=>{f.progress&&clearInterval(f.progress),f.elapsed&&clearInterval(f.elapsed),f.check&&clearTimeout(f.check),p({})},[f]),N=m.useCallback(()=>{g(),h({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:u})},[g,u]),v=m.useCallback(async()=>{try{const A=new AbortController,_=setTimeout(()=>A.abort(),Dr.CHECK_TIMEOUT),H=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include",signal:A.signal});return clearTimeout(_),H.ok}catch{return!1}},[c]),y=m.useCallback(()=>{let A=0;const _=async()=>{if(A++,h(E=>({...E,status:"checking",checkAttempts:A})),await v())g(),h(E=>({...E,status:"success",progress:100})),setTimeout(()=>{n?.(),window.location.href="/auth"},Dr.SUCCESS_REDIRECT_DELAY);else if(A>=u){g();const E=` (${A}/${u})`;h(C=>({...C,status:"failed",error:E})),i?.(E)}else{const E=setTimeout(_,Dr.CHECK_INTERVAL);p(C=>({...C,check:E}))}};_()},[v,g,u,n,i]),w=m.useCallback(()=>{h(A=>({...A,status:"checking",checkAttempts:0,error:void 0})),y()},[y]),b=m.useCallback(async A=>{const{delay:_=0,skipApiCall:H=!1}=A??{};if(x.status!=="idle"&&x.status!=="failed")return;if(g(),h({status:"requesting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:u}),_>0&&await new Promise(M=>setTimeout(M,_)),H)h(M=>({...M,status:"restarting"}));else try{h(M=>({...M,status:"restarting"})),await Promise.race([a2(),new Promise(M=>setTimeout(M,5e3))])}catch{}const E=setInterval(()=>{h(M=>({...M,progress:M.progress>=90?M.progress:M.progress+1}))},Dr.PROGRESS_INTERVAL),C=setInterval(()=>{h(M=>({...M,elapsedTime:M.elapsedTime+1}))},1e3);p({progress:E,elapsed:C}),setTimeout(()=>{y()},Dr.INITIAL_DELAY)},[x.status,g,u,y]),O={state:x,isRestarting:x.status!=="idle",triggerRestart:b,resetState:N,retryHealthCheck:w};return e.jsx(sv.Provider,{value:O,children:l})}function pn(){const l=m.useContext(sv);if(!l)throw new Error("useRestart must be used within a RestartProvider");return l}function n2(){try{return pn()}catch{return null}}const r2=(l,n,i,c,u)=>({idle:{icon:null,title:"",description:"",tip:""},requesting:{icon:e.jsx(Ls,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:u??"...",tip:" ..."},restarting:{icon:e.jsx(Ls,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:u??"...",tip:" ..."},checking:{icon:e.jsx(Ls,{className:"h-16 w-16 text-primary animate-spin"}),title:"",description:`... (${n}/${i})`,tip:" ..."},success:{icon:e.jsx(Wt,{className:"h-16 w-16 text-green-500"}),title:"",description:"...",tip:" "},failed:{icon:e.jsx(St,{className:"h-16 w-16 text-destructive"}),title:"",description:"",tip:" "}})[l];function Qn({visible:l,onComplete:n,onFailed:i,title:c,description:u,showAnimation:x=!0,className:h}){const f=n2();return(f?f.isRestarting:l)?f?e.jsx(tv,{state:f.state,onRetry:f.retryHealthCheck,onComplete:n,onFailed:i,title:c,description:u,showAnimation:x,className:h}):e.jsx(i2,{onComplete:n,onFailed:i,title:c,description:u,showAnimation:x,className:h}):null}function tv({state:l,onRetry:n,onComplete:i,onFailed:c,title:u,description:x,showAnimation:h,className:f}){const{status:p,progress:g,elapsedTime:N,checkAttempts:v,maxAttempts:y}=l;m.useEffect(()=>{p==="success"&&i?i():p==="failed"&&c&&c()},[p,i,c]);const w=r2(p,v,y,u,x),b=O=>{const A=Math.floor(O/60),_=O%60;return`${A}:${_.toString().padStart(2,"0")}`};return e.jsxs("div",{className:P("fixed inset-0 bg-background/95 backdrop-blur-sm z-50 flex items-center justify-center",f),children:[h&&e.jsx(c2,{}),e.jsxs("div",{className:"max-w-md w-full mx-4 space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[w.icon,(p==="restarting"||p==="checking")&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/20 animate-ping"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:w.title}),e.jsx("p",{className:"text-muted-foreground text-center",children:w.description})]}),p!=="failed"&&p!=="idle"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vn,{value:g,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[g,"%"]}),e.jsxs("span",{children:[": ",b(N)]})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:w.tip})}),p==="failed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{onClick:()=>window.location.reload(),variant:"default",className:"flex-1",children:[e.jsx(ft,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(S,{onClick:n,variant:"secondary",className:"flex-1",children:[e.jsx(Xi,{className:"mr-2 h-4 w-4"}),""]})]})]})]})}function i2({onComplete:l,onFailed:n,title:i,description:c,showAnimation:u,className:x}){const[h,f]=m.useState({status:"restarting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:60}),p=m.useCallback(()=>{let g=0;const N=60,v=async()=>{g++,f(y=>({...y,status:"checking",checkAttempts:g}));try{if((await fetch("/api/webui/system/status",{method:"GET",signal:AbortSignal.timeout(3e3)})).ok){f(w=>({...w,status:"success",progress:100})),setTimeout(()=>{l?.(),window.location.href="/auth"},1500);return}}catch{}g>=N?(f(y=>({...y,status:"failed"})),n?.()):setTimeout(v,2e3)};v()},[l,n]);return m.useEffect(()=>{const g=setInterval(()=>{f(y=>({...y,progress:y.progress>=90?y.progress:y.progress+1}))},200),N=setInterval(()=>{f(y=>({...y,elapsedTime:y.elapsedTime+1}))},1e3),v=setTimeout(()=>{p()},3e3);return()=>{clearInterval(g),clearInterval(N),clearTimeout(v)}},[p]),e.jsx(tv,{state:h,onRetry:p,onComplete:l,onFailed:n,title:i,description:c,showAnimation:u,className:x})}function c2(){return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite]"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_0.5s]"}),e.jsx("div",{className:"absolute inset-16 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_1s]"})]}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-bounce"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-primary/15 rounded-full animate-bounce delay-150"}),e.jsx("div",{className:"absolute top-1/2 right-1/3 w-2 h-2 bg-primary/20 rounded-full animate-bounce delay-300"})]})}function o2(){return e.jsx(Kn,{children:e.jsx(u2,{})})}const d2=l=>{const n=[];for(let i=0;i<l;i++){const c=i*137.508%360;n.push(`hsl(${c}, 70%, 55%)`)}return n};function u2(){const[l,n]=m.useState(null),[i,c]=m.useState(!0),[u,x]=m.useState(0),[h,f]=m.useState(24),[p,g]=m.useState(!0),[N,v]=m.useState(null),[y,w]=m.useState(!0),[b,O]=m.useState(null),{triggerRestart:A,isRestarting:_}=pn(),H=m.useCallback(async()=>{try{w(!0);const L=await T0.get("https://v1.hitokoto.cn/?c=a&c=b&c=c&c=d&c=h&c=i&c=k");v({hitokoto:L.data.hitokoto,from:L.data.from||L.data.from_who||""})}catch(L){console.error(":",L),v({hitokoto:"",from:""})}finally{w(!1)}},[]),E=m.useCallback(async()=>{try{const L=await we("/api/webui/system/status");if(L.ok){const B=await L.json();O(B)}else O(null)}catch(L){console.error(":",L),O(null)}},[]),C=async()=>{await A()},M=m.useCallback(async()=>{try{const L=await we(`/api/webui/statistics/dashboard?hours=${h}`);if(L.ok){const B=await L.json();n(B)}c(!1),x(100)}catch(L){console.error("Failed to fetch dashboard data:",L),c(!1),x(100)}},[h]);if(m.useEffect(()=>{if(!i)return;x(0);const L=setTimeout(()=>x(15),200),B=setTimeout(()=>x(30),800),_e=setTimeout(()=>x(45),2e3),je=setTimeout(()=>x(60),4e3),Ce=setTimeout(()=>x(75),6500),K=setTimeout(()=>x(85),9e3),U=setTimeout(()=>x(92),11e3);return()=>{clearTimeout(L),clearTimeout(B),clearTimeout(_e),clearTimeout(je),clearTimeout(Ce),clearTimeout(K),clearTimeout(U)}},[i]),m.useEffect(()=>{M(),H(),E()},[M,H,E]),m.useEffect(()=>{if(!p)return;const L=setInterval(()=>{M(),E()},3e4);return()=>clearInterval(L)},[p,M,E]),i||!l)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"text-center space-y-6 w-full max-w-md px-4",children:[e.jsx(ft,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vn,{value:u,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u,"%"]})]})]})});const{summary:G,model_stats:D=[],hourly_data:ee=[],daily_data:R=[],recent_activity:me=[]}=l,ce=G??{total_requests:0,total_cost:0,total_tokens:0,online_time:0,total_messages:0,total_replies:0,avg_response_time:0,cost_per_hour:0,tokens_per_hour:0},ve=L=>{const B=Math.floor(L/3600),_e=Math.floor(L%3600/60);return`${B}${_e}`},se=L=>{const B=L.toLocaleString("zh-CN");return L>=1e9?{display:`${(L/1e9).toFixed(2)}B`,exact:B,needsExact:!0}:L>=1e6?{display:`${(L/1e6).toFixed(2)}M`,exact:B,needsExact:!0}:L>=1e4?{display:`${(L/1e3).toFixed(1)}K`,exact:B,needsExact:!0}:L>=1e3?{display:`${(L/1e3).toFixed(2)}K`,exact:B,needsExact:!0}:{display:B,exact:B,needsExact:!1}},ge=L=>{const B=`${L.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return L>=1e6?{display:`${(L/1e6).toFixed(2)}M`,exact:B,needsExact:!0}:L>=1e4?{display:`${(L/1e3).toFixed(1)}K`,exact:B,needsExact:!0}:L>=1e3?{display:`${(L/1e3).toFixed(2)}K`,exact:B,needsExact:!0}:{display:B,exact:B,needsExact:!1}},fe=L=>new Date(L).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),z=d2(D.length),Q=D.map((L,B)=>({name:L.model_name,value:L.request_count,fill:z[B]})),I={requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"},tokens:{label:"Tokens",color:"hsl(var(--chart-3))"}};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ra,{value:h.toString(),onValueChange:L=>f(Number(L)),children:e.jsxs(ea,{className:"grid grid-cols-3 w-full sm:w-auto",children:[e.jsx(ts,{value:"24",children:"24"}),e.jsx(ts,{value:"168",children:"7"}),e.jsx(ts,{value:"720",children:"30"})]})}),e.jsxs(S,{variant:p?"default":"outline",size:"sm",onClick:()=>g(!p),className:"gap-2",children:[e.jsx(ft,{className:`h-4 w-4 ${p?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:M,children:e.jsx(ft,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg border border-dashed border-muted-foreground/30 bg-muted/20",children:[y?e.jsx(js,{className:"h-5 flex-1"}):N?e.jsxs("p",{className:"flex-1 text-sm text-muted-foreground italic truncate",children:['"',N.hitokoto,'"  ',N.from]}):null,e.jsx(S,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:H,disabled:y,children:e.jsx(ft,{className:`h-3.5 w-3.5 ${y?"animate-spin":""}`})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-3",children:[e.jsxs(Se,{className:"lg:col-span-1",children:[e.jsx(ze,{className:"pb-3",children:e.jsxs(Re,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(cc,{className:"h-4 w-4"}),""]})}),e.jsx(Me,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:b?.running?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500 animate-pulse"}),e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[e.jsx(Wt,{className:"h-3 w-3 mr-1"}),""]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500"}),e.jsxs(ke,{variant:"outline",className:"text-red-600 border-red-300 bg-red-50",children:[e.jsx(St,{className:"h-3 w-3 mr-1"}),""]})]})}),b&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{children:["v",b.version]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{children:[" ",ve(b.uptime)]})]})]})})]}),e.jsxs(Se,{children:[e.jsx(ze,{className:"pb-3",children:e.jsxs(Re,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Xa,{className:"h-4 w-4"}),""]})}),e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:C,disabled:_,className:"gap-2",children:[e.jsx(Xi,{className:`h-4 w-4 ${_?"animate-spin":""}`}),_?"...":""]}),e.jsx(S,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Un,{to:"/logs",children:[e.jsx(ka,{className:"h-4 w-4"}),""]})}),e.jsx(S,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Un,{to:"/plugins",children:[e.jsx(Iw,{className:"h-4 w-4"}),""]})}),e.jsx(S,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Un,{to:"/settings",children:[e.jsx(xn,{className:"h-4 w-4"}),""]})})]})})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"pb-3",children:[e.jsxs(Re,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Pw,{className:"h-4 w-4"}),""]}),e.jsx(ws,{className:"text-xs",children:""})]}),e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Un,{to:"/survey/webui-feedback",children:[e.jsx(ka,{className:"h-4 w-4"}),"WebUI "]})}),e.jsx(S,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Un,{to:"/survey/maibot-feedback",children:[e.jsx(Ea,{className:"h-4 w-4"}),""]})})]})})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Gm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[se(ce.total_requests).display,se(ce.total_requests).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",se(ce.total_requests).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["",h<48?h+"":Math.floor(h/24)+""]})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Hw,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[ge(ce.total_cost).display,ge(ce.total_cost).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",ge(ce.total_cost).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:ce.cost_per_hour>0?`${ce.cost_per_hour.toFixed(2)}/`:""})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:"Token"}),e.jsx(Pr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[se(ce.total_tokens).display,se(ce.total_tokens).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",se(ce.total_tokens).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:ce.tokens_per_hour>0?`${se(ce.tokens_per_hour).display}/`:""})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Xa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[ce.avg_response_time.toFixed(2),"s"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"API"})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Ca,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:e.jsxs("div",{className:"text-xl font-bold",children:[ve(ce.online_time),e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",ce.online_time.toLocaleString(),")"]})]})})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Ea,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsxs("div",{className:"text-xl font-bold",children:[se(ce.total_messages).display,se(ce.total_messages).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",se(ce.total_messages).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",se(ce.total_replies).display,se(ce.total_replies).needsExact&&e.jsxs("span",{children:["(",se(ce.total_replies).exact,")"]})," "]})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Vm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-xl font-bold",children:ce.total_messages>0?`${(ce.total_cost/ce.total_messages*100).toFixed(2)}`:"0.00"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"100"})]})]})]}),e.jsxs(ra,{defaultValue:"trends",className:"space-y-4",children:[e.jsxs(ea,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[e.jsx(ts,{value:"trends",children:""}),e.jsx(ts,{value:"models",children:""}),e.jsx(ts,{value:"activity",children:""}),e.jsx(ts,{value:"daily",children:""})]}),e.jsxs(ys,{value:"trends",className:"space-y-4",children:[e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsxs(ws,{children:["",h,""]})]}),e.jsx(Me,{children:e.jsx(Lr,{config:I,className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(mw,{data:ee,children:[e.jsx(Pi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Hi,{dataKey:"timestamp",tickFormatter:L=>fe(L),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Rr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Bi,{content:e.jsx(Ur,{labelFormatter:L=>fe(L)})}),e.jsx(xw,{type:"monotone",dataKey:"requests",stroke:"var(--color-requests)",strokeWidth:2})]})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:"API"})]}),e.jsx(Me,{children:e.jsx(Lr,{config:I,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Eo,{data:ee,children:[e.jsx(Pi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Hi,{dataKey:"timestamp",tickFormatter:L=>fe(L),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Rr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Bi,{content:e.jsx(Ur,{labelFormatter:L=>fe(L)})}),e.jsx(Fi,{dataKey:"cost",fill:"var(--color-cost)"})]})})})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:"Token"}),e.jsx(ws,{children:"Token"})]}),e.jsx(Me,{children:e.jsx(Lr,{config:I,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Eo,{data:ee,children:[e.jsx(Pi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Hi,{dataKey:"timestamp",tickFormatter:L=>fe(L),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Rr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Bi,{content:e.jsx(Ur,{labelFormatter:L=>fe(L)})}),e.jsx(Fi,{dataKey:"tokens",fill:"var(--color-tokens)"})]})})})]})]})]}),e.jsx(ys,{value:"models",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsxs(ws,{children:[" ( ",D.length," )"]})]}),e.jsx(Me,{children:e.jsx(Lr,{config:Object.fromEntries(D.map((L,B)=>[L.model_name,{label:L.model_name,color:z[B]}])),className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(hw,{children:[e.jsx(Bi,{content:e.jsx(Ur,{})}),e.jsx(fw,{data:Q,cx:"50%",cy:"50%",labelLine:!1,label:({name:L,percent:B})=>B&&B<.05?"":`${L} ${B?(B*100).toFixed(0):0}%`,outerRadius:100,dataKey:"value",children:Q.map((L,B)=>e.jsx(pw,{fill:L.fill},`cell-${B}`))})]})})})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:e.jsx(Je,{className:"h-[300px] sm:h-[400px]",children:e.jsx("div",{className:"space-y-3",children:D.map((L,B)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm truncate flex-1 min-w-0",children:L.model_name}),e.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:`hsl(var(--chart-${B%5+1}))`}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-1 font-medium",children:L.request_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:["",L.total_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[(L.total_tokens/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:[L.avg_response_time.toFixed(2),"s"]})]})]})]},B))})})})]})]})}),e.jsx(ys,{value:"activity",children:e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:"API"})]}),e.jsx(Me,{children:e.jsx(Je,{className:"h-[400px] sm:h-[500px]",children:e.jsx("div",{className:"space-y-2",children:me.map((L,B)=>e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:L.model}),e.jsx("div",{className:"text-xs text-muted-foreground",children:L.request_type})]}),e.jsx("div",{className:"text-xs text-muted-foreground flex-shrink-0",children:fe(L.timestamp)})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsx("span",{className:"ml-1",children:L.tokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:["",L.cost.toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:[L.time_cost.toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:`ml-1 ${L.status==="success"?"text-green-600":"text-red-600"}`,children:L.status})]})]})]},B))})})})]})}),e.jsx(ys,{value:"daily",children:e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:"7"})]}),e.jsx(Me,{children:e.jsx(Lr,{config:{requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"}},className:"h-[400px] sm:h-[500px] w-full aspect-auto",children:e.jsxs(Eo,{data:R,children:[e.jsx(Pi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Hi,{dataKey:"timestamp",tickFormatter:L=>{const B=new Date(L);return`${B.getMonth()+1}/${B.getDate()}`},stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Rr,{yAxisId:"left",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Rr,{yAxisId:"right",orientation:"right",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Bi,{content:e.jsx(Ur,{labelFormatter:L=>new Date(L).toLocaleDateString("zh-CN")})}),e.jsx(s2,{content:e.jsx(ev,{})}),e.jsx(Fi,{yAxisId:"left",dataKey:"requests",fill:"var(--color-requests)"}),e.jsx(Fi,{yAxisId:"right",dataKey:"cost",fill:"var(--color-cost)"})]})})})]})})]}),e.jsx(Qn,{})]})})}const m2={theme:"system",setTheme:()=>null},av=m.createContext(m2),Zm=()=>{const l=m.useContext(av);if(l===void 0)throw new Error("useTheme must be used within a ThemeProvider");return l},x2=(l,n,i)=>{const c=document.documentElement.classList.contains("no-animations");if(!document.startViewTransition||c){n(l);return}const u=i.clientX,x=i.clientY,h=Math.hypot(Math.max(u,innerWidth-u),Math.max(x,innerHeight-x));document.startViewTransition(()=>{n(l)}).ready.then(()=>{document.documentElement.animate({clipPath:[`circle(0px at ${u}px ${x}px)`,`circle(${h}px at ${u}px ${x}px)`]},{duration:500,easing:"ease-in-out",pseudoElement:"::view-transition-new(root)"})})},lv=m.createContext(void 0),nv=()=>{const l=m.useContext(lv);if(l===void 0)throw new Error("useAnimation must be used within an AnimationProvider");return l},Fe=m.forwardRef(({className:l,...n},i)=>e.jsx(Fg,{className:P("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",l),...n,ref:i,children:e.jsx(D0,{className:P("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Fe.displayName=Fg.displayName;const h2=qr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),T=m.forwardRef(({className:l,...n},i)=>e.jsx(cj,{ref:i,className:P(h2(),l),...n}));T.displayName=cj.displayName;const ne=m.forwardRef(({className:l,type:n,...i},c)=>e.jsx("input",{type:n,className:P("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),ref:c,...i}));ne.displayName="Input";const f2=5,p2=5e3;let Sm=0;function g2(){return Sm=(Sm+1)%Number.MAX_SAFE_INTEGER,Sm.toString()}const km=new Map,xg=l=>{if(km.has(l))return;const n=setTimeout(()=>{km.delete(l),Qi({type:"REMOVE_TOAST",toastId:l})},p2);km.set(l,n)},j2=(l,n)=>{switch(n.type){case"ADD_TOAST":return{...l,toasts:[n.toast,...l.toasts].slice(0,f2)};case"UPDATE_TOAST":return{...l,toasts:l.toasts.map(i=>i.id===n.toast.id?{...i,...n.toast}:i)};case"DISMISS_TOAST":{const{toastId:i}=n;return i?xg(i):l.toasts.forEach(c=>{xg(c.id)}),{...l,toasts:l.toasts.map(c=>c.id===i||i===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return n.toastId===void 0?{...l,toasts:[]}:{...l,toasts:l.toasts.filter(i=>i.id!==n.toastId)}}},zo=[];let Oo={toasts:[]};function Qi(l){Oo=j2(Oo,l),zo.forEach(n=>{n(Oo)})}function Kt({...l}){const n=g2(),i=u=>Qi({type:"UPDATE_TOAST",toast:{...u,id:n}}),c=()=>Qi({type:"DISMISS_TOAST",toastId:n});return Qi({type:"ADD_TOAST",toast:{...l,id:n,open:!0,onOpenChange:u=>{u||c()}}}),{id:n,dismiss:c,update:i}}function st(){const[l,n]=m.useState(Oo);return m.useEffect(()=>(zo.push(n),()=>{const i=zo.indexOf(n);i>-1&&zo.splice(i,1)}),[l]),{...l,toast:Kt,dismiss:i=>Qi({type:"DISMISS_TOAST",toastId:i})}}const v2=[{id:"minLength",label:" 10 ",description:"Token  10 ",validate:l=>l.length>=10},{id:"hasUppercase",label:"",description:" (A-Z)",validate:l=>/[A-Z]/.test(l)},{id:"hasLowercase",label:"",description:" (a-z)",validate:l=>/[a-z]/.test(l)},{id:"hasSpecialChar",label:"",description:" (!@#$%^&*()_+-=[]{}|;:,.<>?/)",validate:l=>/[!@#$%^&*()_+\-=[\]{}|;:,.<>?/]/.test(l)}];function N2(l){const n=v2.map(c=>({id:c.id,label:c.label,description:c.description,passed:c.validate(l)}));return{isValid:n.every(c=>c.passed),rules:n}}const Wo="0.12.1",Wm="MaiBot Dashboard",b2=`${Wm} v${Wo}`,y2=(l="v")=>`${l}${Wo}`,fa={THEME:"maibot-ui-theme",ACCENT_COLOR:"accent-color",ENABLE_ANIMATIONS:"maibot-animations",ENABLE_WAVES_BACKGROUND:"maibot-waves-background",LOG_CACHE_SIZE:"maibot-log-cache-size",LOG_AUTO_SCROLL:"maibot-log-auto-scroll",LOG_FONT_SIZE:"maibot-log-font-size",LOG_LINE_SPACING:"maibot-log-line-spacing",DATA_SYNC_INTERVAL:"maibot-data-sync-interval",WS_RECONNECT_INTERVAL:"maibot-ws-reconnect-interval",WS_MAX_RECONNECT_ATTEMPTS:"maibot-ws-max-reconnect-attempts",COMPLETED_TOURS:"maibot-completed-tours"},rl={theme:"system",accentColor:"blue",enableAnimations:!0,enableWavesBackground:!0,logCacheSize:1e3,logAutoScroll:!0,logFontSize:"xs",logLineSpacing:4,dataSyncInterval:30,wsReconnectInterval:3e3,wsMaxReconnectAttempts:10};function Nt(l){const n=rv(l),i=localStorage.getItem(n);if(i===null)return rl[l];const c=rl[l];if(typeof c=="boolean")return i==="true";if(typeof c=="number"){const u=parseFloat(i);return isNaN(u)?c:u}return i}function Br(l,n){const i=rv(l);localStorage.setItem(i,String(n)),window.dispatchEvent(new CustomEvent("maibot-settings-change",{detail:{key:l,value:n}}))}function w2(){return{theme:Nt("theme"),accentColor:Nt("accentColor"),enableAnimations:Nt("enableAnimations"),enableWavesBackground:Nt("enableWavesBackground"),logCacheSize:Nt("logCacheSize"),logAutoScroll:Nt("logAutoScroll"),logFontSize:Nt("logFontSize"),logLineSpacing:Nt("logLineSpacing"),dataSyncInterval:Nt("dataSyncInterval"),wsReconnectInterval:Nt("wsReconnectInterval"),wsMaxReconnectAttempts:Nt("wsMaxReconnectAttempts")}}function _2(){const l=w2(),n=localStorage.getItem(fa.COMPLETED_TOURS),i=n?JSON.parse(n):[];return{...l,completedTours:i}}function S2(l){const n=[],i=[];for(const[c,u]of Object.entries(l)){if(c==="completedTours"){Array.isArray(u)?(localStorage.setItem(fa.COMPLETED_TOURS,JSON.stringify(u)),n.push("completedTours")):i.push("completedTours");continue}if(c in rl){const x=c,h=rl[x];if(typeof u==typeof h){if(x==="theme"&&!["light","dark","system"].includes(u)){i.push(c);continue}if(x==="logFontSize"&&!["xs","sm","base"].includes(u)){i.push(c);continue}Br(x,u),n.push(c)}else i.push(c)}else i.push(c)}return{success:n.length>0,imported:n,skipped:i}}function k2(){for(const l of Object.keys(rl))Br(l,rl[l]);localStorage.removeItem(fa.COMPLETED_TOURS),window.dispatchEvent(new CustomEvent("maibot-settings-reset"))}function C2(){const l=[],n=[],i=[];for(let c=0;c<localStorage.length;c++){const u=localStorage.key(c);u&&(u.startsWith("maibot")||u.startsWith("accent-color")||u==="access-token")&&i.push(u)}for(const c of i)localStorage.removeItem(c),l.push(c);return{clearedKeys:l,preservedKeys:n}}function hg(){let l=0;const n=[];for(let i=0;i<localStorage.length;i++){const c=localStorage.key(i);if(c){const u=localStorage.getItem(c)||"",x=(c.length+u.length)*2;l+=x,n.push({key:c,size:x})}}return n.sort((i,c)=>c.size-i.size),{used:l,items:localStorage.length,details:n}}function T2(l){if(l===0)return"0 B";const n=1024,i=["B","KB","MB"],c=Math.floor(Math.log(l)/Math.log(n));return parseFloat((l/Math.pow(n,c)).toFixed(2))+" "+i[c]}function rv(l){return{theme:fa.THEME,accentColor:fa.ACCENT_COLOR,enableAnimations:fa.ENABLE_ANIMATIONS,enableWavesBackground:fa.ENABLE_WAVES_BACKGROUND,logCacheSize:fa.LOG_CACHE_SIZE,logAutoScroll:fa.LOG_AUTO_SCROLL,logFontSize:fa.LOG_FONT_SIZE,logLineSpacing:fa.LOG_LINE_SPACING,dataSyncInterval:fa.DATA_SYNC_INTERVAL,wsReconnectInterval:fa.WS_RECONNECT_INTERVAL,wsMaxReconnectAttempts:fa.WS_MAX_RECONNECT_ATTEMPTS}[l]}const Sa=m.forwardRef(({className:l,...n},i)=>e.jsxs(Gg,{ref:i,className:P("relative flex w-full touch-none select-none items-center",l),...n,children:[e.jsx(R0,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(L0,{className:"absolute h-full bg-primary"})}),e.jsx(U0,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Sa.displayName=Gg.displayName;class E2{ws=null;reconnectTimeout=null;reconnectAttempts=0;heartbeatInterval=null;logCallbacks=new Set;connectionCallbacks=new Set;isConnected=!1;logCache=[];getMaxCacheSize(){return Nt("logCacheSize")}getMaxReconnectAttempts(){return Nt("wsMaxReconnectAttempts")}getReconnectInterval(){return Nt("wsReconnectInterval")}getWebSocketUrl(n){let i;{const c=window.location.protocol==="https:"?"wss:":"ws:",u=window.location.host;i=`${c}//${u}/ws/logs`}return n?`${i}?token=${encodeURIComponent(n)}`:i}async getWsToken(){try{const n=await we("/api/webui/ws-token",{method:"GET",credentials:"include"});if(!n.ok)return console.error(" WebSocket token :",n.status),null;const i=await n.json();return i.success&&i.token?i.token:null}catch(n){return console.error(" WebSocket token :",n),null}}async connect(){if(this.ws?.readyState===WebSocket.OPEN||this.ws?.readyState===WebSocket.CONNECTING)return;if(window.location.pathname==="/auth"){console.log("  WebSocket ");return}if(!await tc()){console.log("  WebSocket ");return}const i=await this.getWsToken();if(!i){console.log("  WebSocket token");return}const c=this.getWebSocketUrl(i);try{this.ws=new WebSocket(c),this.ws.onopen=()=>{this.isConnected=!0,this.reconnectAttempts=0,this.notifyConnection(!0),this.startHeartbeat()},this.ws.onmessage=u=>{try{if(u.data==="pong")return;const x=JSON.parse(u.data);this.notifyLog(x)}catch(x){console.error(":",x)}},this.ws.onerror=u=>{console.error(" WebSocket :",u),this.isConnected=!1,this.notifyConnection(!1)},this.ws.onclose=()=>{this.isConnected=!1,this.notifyConnection(!1),this.stopHeartbeat(),this.attemptReconnect()}}catch(u){console.error(" WebSocket :",u),this.attemptReconnect()}}attemptReconnect(){const n=this.getMaxReconnectAttempts();if(this.reconnectAttempts>=n)return;this.reconnectAttempts+=1;const i=this.getReconnectInterval(),c=Math.min(i*this.reconnectAttempts,3e4);this.reconnectTimeout=window.setTimeout(()=>{this.connect()},c)}startHeartbeat(){this.heartbeatInterval=window.setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.ws.send("ping")},3e4)}stopHeartbeat(){this.heartbeatInterval!==null&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}disconnect(){this.reconnectTimeout!==null&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.stopHeartbeat(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.reconnectAttempts=0}onLog(n){return this.logCallbacks.add(n),()=>this.logCallbacks.delete(n)}onConnectionChange(n){return this.connectionCallbacks.add(n),n(this.isConnected),()=>this.connectionCallbacks.delete(n)}notifyLog(n){if(!this.logCache.some(c=>c.id===n.id)){this.logCache.push(n);const c=this.getMaxCacheSize();this.logCache.length>c&&(this.logCache=this.logCache.slice(-c)),this.logCallbacks.forEach(u=>{try{u(n)}catch(x){console.error(":",x)}})}}notifyConnection(n){this.connectionCallbacks.forEach(i=>{try{i(n)}catch(c){console.error(":",c)}})}getAllLogs(){return[...this.logCache]}clearLogs(){this.logCache=[]}getConnectionStatus(){return this.isConnected}}const $n=new E2;typeof window<"u"&&setTimeout(()=>{$n.connect()},100);const Ps=Nw,ed=bw,M2=jw,iv=m.forwardRef(({className:l,...n},i)=>e.jsx(oj,{ref:i,className:P("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...n}));iv.displayName=oj.displayName;const Us=m.forwardRef(({className:l,children:n,preventOutsideClose:i=!1,...c},u)=>e.jsxs(M2,{children:[e.jsx(iv,{}),e.jsxs(dj,{ref:u,className:P("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),onPointerDownOutside:i?x=>x.preventDefault():void 0,onInteractOutside:i?x=>x.preventDefault():void 0,...c,children:[n,e.jsxs(vw,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ma,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Us.displayName=dj.displayName;const $s=({className:l,...n})=>e.jsx("div",{className:P("flex flex-col space-y-1.5 text-center sm:text-left",l),...n});$s.displayName="DialogHeader";const et=({className:l,...n})=>e.jsx("div",{className:P("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",l),...n});et.displayName="DialogFooter";const Bs=m.forwardRef(({className:l,...n},i)=>e.jsx(uj,{ref:i,className:P("text-lg font-semibold leading-none tracking-tight",l),...n}));Bs.displayName=uj.displayName;const Js=m.forwardRef(({className:l,...n},i)=>e.jsx(mj,{ref:i,className:P("text-sm text-muted-foreground",l),...n}));Js.displayName=mj.displayName;const vs=B0,bt=I0,A2=$0,cv=m.forwardRef(({className:l,...n},i)=>e.jsx(Vg,{className:P("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...n,ref:i}));cv.displayName=Vg.displayName;const ds=m.forwardRef(({className:l,...n},i)=>e.jsxs(A2,{children:[e.jsx(cv,{}),e.jsx(qg,{ref:i,className:P("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),...n})]}));ds.displayName=qg.displayName;const us=({className:l,...n})=>e.jsx("div",{className:P("flex flex-col space-y-2 text-center sm:text-left",l),...n});us.displayName="AlertDialogHeader";const ms=({className:l,...n})=>e.jsx("div",{className:P("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",l),...n});ms.displayName="AlertDialogFooter";const xs=m.forwardRef(({className:l,...n},i)=>e.jsx(Kg,{ref:i,className:P("text-lg font-semibold",l),...n}));xs.displayName=Kg.displayName;const hs=m.forwardRef(({className:l,...n},i)=>e.jsx(Qg,{ref:i,className:P("text-sm text-muted-foreground",l),...n}));hs.displayName=Qg.displayName;const fs=m.forwardRef(({className:l,variant:n,...i},c)=>e.jsx(Yg,{ref:c,className:P(Vr({variant:n}),l),...i}));fs.displayName=Yg.displayName;const ps=m.forwardRef(({className:l,...n},i)=>e.jsx(Jg,{ref:i,className:P(Vr({variant:"outline"}),"mt-2 sm:mt-0",l),...n}));ps.displayName=Jg.displayName;function z2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]})}),e.jsxs(ra,{defaultValue:"appearance",className:"w-full",children:[e.jsxs(ea,{className:"grid w-full grid-cols-2 sm:grid-cols-4 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(ts,{value:"appearance",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Fw,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(ts,{value:"security",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Ej,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(ts,{value:"other",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(xn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(ts,{value:"about",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Pt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Je,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(ys,{value:"appearance",className:"mt-0",children:e.jsx(O2,{})}),e.jsx(ys,{value:"security",className:"mt-0",children:e.jsx(D2,{})}),e.jsx(ys,{value:"other",className:"mt-0",children:e.jsx(R2,{})}),e.jsx(ys,{value:"about",className:"mt-0",children:e.jsx(L2,{})})]})]})]})}function fg(l){const n=document.documentElement,c={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[l];if(c)n.style.setProperty("--primary",c.hsl),c.gradient?(n.style.setProperty("--primary-gradient",c.gradient),n.classList.add("has-gradient")):(n.style.removeProperty("--primary-gradient"),n.classList.remove("has-gradient"));else if(l.startsWith("#")){const u=x=>{x=x.replace("#","");const h=parseInt(x.substring(0,2),16)/255,f=parseInt(x.substring(2,4),16)/255,p=parseInt(x.substring(4,6),16)/255,g=Math.max(h,f,p),N=Math.min(h,f,p);let v=0,y=0;const w=(g+N)/2;if(g!==N){const b=g-N;switch(y=w>.5?b/(2-g-N):b/(g+N),g){case h:v=((f-p)/b+(f<p?6:0))/6;break;case f:v=((p-h)/b+2)/6;break;case p:v=((h-f)/b+4)/6;break}}return`${Math.round(v*360)} ${Math.round(y*100)}% ${Math.round(w*100)}%`};n.style.setProperty("--primary",u(l)),n.style.removeProperty("--primary-gradient"),n.classList.remove("has-gradient")}}function O2(){const{theme:l,setTheme:n}=Zm(),{enableAnimations:i,setEnableAnimations:c,enableWavesBackground:u,setEnableWavesBackground:x}=nv(),[h,f]=m.useState(()=>localStorage.getItem("accent-color")||"blue");m.useEffect(()=>{const g=localStorage.getItem("accent-color")||"blue";fg(g)},[]);const p=g=>{f(g),localStorage.setItem("accent-color",g),fg(g)};return e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(Cm,{value:"light",current:l,onChange:n,label:"",description:""}),e.jsx(Cm,{value:"dark",current:l,onChange:n,label:"",description:""}),e.jsx(Cm,{value:"system",current:l,onChange:n,label:"",description:""})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Fa,{value:"blue",current:h,onChange:p,label:"",colorClass:"bg-blue-500"}),e.jsx(Fa,{value:"purple",current:h,onChange:p,label:"",colorClass:"bg-purple-500"}),e.jsx(Fa,{value:"green",current:h,onChange:p,label:"",colorClass:"bg-green-500"}),e.jsx(Fa,{value:"orange",current:h,onChange:p,label:"",colorClass:"bg-orange-500"}),e.jsx(Fa,{value:"pink",current:h,onChange:p,label:"",colorClass:"bg-pink-500"}),e.jsx(Fa,{value:"red",current:h,onChange:p,label:"",colorClass:"bg-red-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Fa,{value:"gradient-sunset",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-orange-500 to-pink-500"}),e.jsx(Fa,{value:"gradient-ocean",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-500"}),e.jsx(Fa,{value:"gradient-forest",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-green-500 to-emerald-500"}),e.jsx(Fa,{value:"gradient-aurora",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-purple-500 to-pink-500"}),e.jsx(Fa,{value:"gradient-fire",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-red-500 to-orange-500"}),e.jsx(Fa,{value:"gradient-twilight",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"color",value:h.startsWith("#")?h:"#3b82f6",onChange:g=>p(g.target.value),className:"h-10 sm:h-12 w-full rounded-lg border-2 border-border cursor-pointer",title:""})}),e.jsx("div",{className:"flex-1",children:e.jsx(ne,{type:"text",value:h,onChange:g=>p(g.target.value),placeholder:"#3b82f6",className:"font-mono text-sm"})})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-2",children:" HEX "})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"animations",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"animations",checked:i,onCheckedChange:c})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"waves-background",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"waves-background",checked:u,onCheckedChange:x})]})})]})]})]})}function D2(){const l=ia(),[n,i]=m.useState(""),[c,u]=m.useState(""),[x,h]=m.useState(!1),[f,p]=m.useState(!1),[g,N]=m.useState(!1),[v,y]=m.useState(!1),[w,b]=m.useState(!1),[O,A]=m.useState(!1),[_,H]=m.useState(""),[E,C]=m.useState(!1),{toast:M}=st(),G=m.useMemo(()=>N2(c),[c]),D=async se=>{if(!n){M({title:"",description:"Token  Cookie  Token",variant:"destructive"});return}try{await navigator.clipboard.writeText(se),b(!0),M({title:"",description:"Token "}),setTimeout(()=>b(!1),2e3)}catch{M({title:"",description:" Token",variant:"destructive"})}},ee=async()=>{if(!c.trim()){M({title:"",description:" Token",variant:"destructive"});return}if(!G.isValid){const se=G.rules.filter(ge=>!ge.passed).map(ge=>ge.label).join(", ");M({title:"",description:`Token : ${se}`,variant:"destructive"});return}N(!0);try{const se=await fetch("/api/webui/auth/update",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({new_token:c.trim()})}),ge=await se.json();se.ok&&ge.success?(u(""),i(c.trim()),M({title:"",description:"Access Token "}),setTimeout(()=>{l({to:"/auth"})},1500)):M({title:"",description:ge.message||" Token",variant:"destructive"})}catch(se){console.error(" Token :",se),M({title:"",description:"",variant:"destructive"})}finally{N(!1)}},R=async()=>{y(!0);try{const se=await fetch("/api/webui/auth/regenerate",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),ge=await se.json();se.ok&&ge.success?(i(ge.token),H(ge.token),A(!0),C(!1),M({title:"",description:" Access Token "})):M({title:"",description:ge.message||" Token",variant:"destructive"})}catch(se){console.error(" Token :",se),M({title:"",description:"",variant:"destructive"})}finally{y(!1)}},me=async()=>{try{await navigator.clipboard.writeText(_),C(!0),M({title:"",description:"Token "})}catch{M({title:"",description:" Token",variant:"destructive"})}},ce=()=>{A(!1),setTimeout(()=>{H(""),C(!1)},300),setTimeout(()=>{l({to:"/auth"})},500)},ve=se=>{se||ce()};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(Ps,{open:O,onOpenChange:ve,children:e.jsxs(Us,{className:"sm:max-w-md",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(Yt,{className:"h-5 w-5 text-yellow-500"})," Access Token"]}),e.jsx(Js,{children:" Token"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-2 border-primary/20 bg-primary/5 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-2 block",children:" Token (64)"}),e.jsx("div",{className:"font-mono text-sm break-all select-all bg-background p-3 rounded border",children:_})]}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Yt,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token "}),e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:" Token "})]})]})]})})]}),e.jsxs(et,{className:"gap-2 sm:gap-0",children:[e.jsx(S,{variant:"outline",onClick:me,className:"gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx(_t,{className:"h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Ro,{className:"h-4 w-4"})," Token"]})}),e.jsx(S,{onClick:ce,children:""})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"current-token",className:"text-sm",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ne,{id:"current-token",type:x?"text":"password",value:n||"",readOnly:!0,className:"pr-10 font-mono text-sm",placeholder:"Token  Cookie "}),e.jsx("button",{onClick:()=>{n?h(!x):M({title:"",description:'Token  Cookie  Token ""'})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:x?"":"",children:x?e.jsx(Zi,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(na,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(S,{variant:"outline",size:"icon",onClick:()=>D(n),title:"",className:"flex-shrink-0",disabled:!n,children:w?e.jsx(_t,{className:"h-4 w-4 text-green-500"}):e.jsx(Ro,{className:"h-4 w-4"})}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{variant:"outline",disabled:v,className:"gap-2 flex-1 sm:flex-none",children:[e.jsx(ft,{className:P("h-4 w-4",v&&"animate-spin")}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:" Token"}),e.jsx(hs,{children:" 64  Token   Token "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:R,children:""})]})]})]})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:" Access Token"})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"new-token",className:"text-sm",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{id:"new-token",type:f?"text":"password",value:c,onChange:se=>u(se.target.value),className:"pr-10 font-mono text-sm",placeholder:" Token"}),e.jsx("button",{onClick:()=>p(!f),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:f?"":"",children:f?e.jsx(Zi,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(na,{className:"h-4 w-4 text-muted-foreground"})})]}),c&&e.jsxs("div",{className:"mt-3 space-y-2 p-3 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Token :"}),e.jsx("div",{className:"space-y-1.5",children:G.rules.map(se=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[se.passed?e.jsx(Wt,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(Wi,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:P(se.passed?"text-green-600 dark:text-green-400":"text-muted-foreground"),children:se.label})]},se.id))}),G.isValid&&e.jsx("div",{className:"mt-2 pt-2 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Token "})]})})]})]}),e.jsx(S,{onClick:ee,disabled:g||!G.isValid||!c,className:"w-full sm:w-auto",children:g?"...":" Token"})]})]}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3 sm:p-4",children:[e.jsx("h4",{className:"text-sm sm:text-base font-semibold text-yellow-900 dark:text-yellow-200 mb-2",children:""}),e.jsxs("ul",{className:"text-xs sm:text-sm text-yellow-800 dark:text-yellow-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:" Token  64 "}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token  Token "}),e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token "})]})]})]})}function R2(){const l=ia(),{toast:n}=st(),[i,c]=m.useState(!1),[u,x]=m.useState(!1),[h,f]=m.useState(()=>Nt("logCacheSize")),[p,g]=m.useState(()=>Nt("wsReconnectInterval")),[N,v]=m.useState(()=>Nt("wsMaxReconnectAttempts")),[y,w]=m.useState(()=>Nt("dataSyncInterval")),[b,O]=m.useState(()=>hg()),[A,_]=m.useState(!1),[H,E]=m.useState(!1),C=m.useRef(null);if(u)throw new Error("");const M=()=>{O(hg())},G=z=>{const Q=z[0];f(Q),Br("logCacheSize",Q)},D=z=>{const Q=z[0];g(Q),Br("wsReconnectInterval",Q)},ee=z=>{const Q=z[0];v(Q),Br("wsMaxReconnectAttempts",Q)},R=z=>{const Q=z[0];w(Q),Br("dataSyncInterval",Q)},me=()=>{$n.clearLogs(),n({title:"",description:""})},ce=()=>{const z=C2();M(),n({title:"",description:` ${z.clearedKeys.length} `})},ve=()=>{_(!0);try{const z=_2(),Q=JSON.stringify(z,null,2),I=new Blob([Q],{type:"application/json"}),L=URL.createObjectURL(I),B=document.createElement("a");B.href=L,B.download=`maibot-webui-settings-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(L),n({title:"",description:" JSON "})}catch(z){console.error(":",z),n({title:"",description:"",variant:"destructive"})}finally{_(!1)}},se=z=>{const Q=z.target.files?.[0];if(!Q)return;E(!0);const I=new FileReader;I.onload=L=>{try{const B=L.target?.result,_e=JSON.parse(B),je=S2(_e);je.success?(f(Nt("logCacheSize")),g(Nt("wsReconnectInterval")),v(Nt("wsMaxReconnectAttempts")),w(Nt("dataSyncInterval")),M(),n({title:"",description:` ${je.imported.length} ${je.skipped.length>0?` ${je.skipped.length} `:""}`}),(je.imported.includes("theme")||je.imported.includes("accentColor"))&&n({title:"",description:""})):n({title:"",description:"",variant:"destructive"})}catch(B){console.error(":",B),n({title:"",description:"",variant:"destructive"})}finally{E(!1),C.current&&(C.current.value="")}},I.readAsText(Q)},ge=()=>{k2(),f(rl.logCacheSize),g(rl.wsReconnectInterval),v(rl.wsMaxReconnectAttempts),w(rl.dataSyncInterval),M(),n({title:"",description:""})},fe=async()=>{c(!0);try{const z=await we("/api/webui/setup/reset",{method:"POST"}),Q=await z.json();z.ok&&Q.success?(n({title:"",description:""}),setTimeout(()=>{l({to:"/setup"})},1e3)):n({title:"",description:Q.message||"",variant:"destructive"})}catch(z){console.error(":",z),n({title:"",description:"",variant:"destructive"})}finally{c(!1)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Pr,{className:"h-5 w-5"}),""]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Gw,{className:"h-4 w-4"}),""]}),e.jsx(S,{variant:"ghost",size:"sm",onClick:M,className:"h-7 px-2",children:e.jsx(ft,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:T2(b.used)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[b.items," "]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h," "]})]}),e.jsx(Sa,{value:[h],onValueChange:G,min:100,max:5e3,step:100,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y," "]})]}),e.jsx(Sa,{value:[y],onValueChange:R,min:10,max:120,step:5,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p/1e3," "]})]}),e.jsx(Sa,{value:[p],onValueChange:D,min:1e3,max:1e4,step:500,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" WebSocket "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[N," "]})]}),e.jsx(Sa,{value:[N],onValueChange:ee,min:3,max:30,step:1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:me,className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),""]}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:" "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:ce,children:""})]})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Zt,{className:"h-5 w-5"}),"/"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(S,{variant:"outline",onClick:ve,disabled:A,className:"gap-2",children:[e.jsx(Zt,{className:"h-4 w-4"}),A?"...":""]}),e.jsx("input",{ref:C,type:"file",accept:".json",onChange:se,className:"hidden"}),e.jsxs(S,{variant:"outline",onClick:()=>C.current?.click(),disabled:H,className:"gap-2",children:[e.jsx(ec,{className:"h-4 w-4"}),H?"...":""]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",className:"gap-2 text-destructive hover:text-destructive",children:[e.jsx(Xi,{className:"h-4 w-4"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:" "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:ge,children:""})]})]})]})})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{variant:"outline",disabled:i,className:"gap-2",children:[e.jsx(Xi,{className:P("h-4 w-4",i&&"animate-spin")}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:""})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:fe,children:""})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-dashed border-yellow-500/50 bg-yellow-500/5 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Yt,{className:"h-5 w-5 text-yellow-500"}),""]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{variant:"destructive",className:"gap-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:" React  "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>x(!0),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})]})]})]})]})}function L2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"rounded-lg border-2 border-primary/30 bg-gradient-to-r from-primary/5 to-primary/10 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-shrink-0 rounded-lg bg-primary/10 p-2 sm:p-3",children:e.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3",children:" GitHub  Star  "}),e.jsxs("a",{href:"https://github.com/Mai-with-u/MaiBot-Dashboard",target:"_blank",rel:"noopener noreferrer",className:P("inline-flex items-center gap-2 px-4 py-2 rounded-lg","bg-primary text-primary-foreground font-medium text-sm","hover:bg-primary/90 transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})," GitHub",e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:[" ",Wm]}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("p",{children:[": ",Wo]}),e.jsx("p",{children:"MaiBot Web "})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"MaiBot "}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Mai-with-u"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"WebUI"}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Mai-with-u ",e.jsx("a",{href:"https://github.com/DrSmoothl",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"@MotricSeven"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"React 19.2.0"}),e.jsx("li",{children:"TypeScript 5.7.2"}),e.jsx("li",{children:"Vite 6.0.7"}),e.jsx("li",{children:"TanStack Router 1.94.2"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:"UI "}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"shadcn/ui"}),e.jsx("li",{children:"Radix UI"}),e.jsx("li",{children:"Tailwind CSS 3.4.17"}),e.jsx("li",{children:"Lucide Icons"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Python 3.12+"}),e.jsx("li",{children:"FastAPI"}),e.jsx("li",{children:"Uvicorn"}),e.jsx("li",{children:"WebSocket"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Bun / npm"}),e.jsx("li",{children:"ESLint 9.17.0"}),e.jsx("li",{children:"PostCSS"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-3",children:""}),e.jsx(Je,{className:"h-[300px] sm:h-[400px]",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"UI "}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ht,{name:"React",description:"",license:"MIT"}),e.jsx(ht,{name:"shadcn/ui",description:" React ",license:"MIT"}),e.jsx(ht,{name:"Radix UI",description:"",license:"MIT"}),e.jsx(ht,{name:"Tailwind CSS",description:" CSS ",license:"MIT"}),e.jsx(ht,{name:"Lucide React",description:"",license:"ISC"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ht,{name:"TanStack Router",description:"",license:"MIT"}),e.jsx(ht,{name:"Zustand",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ht,{name:"React Hook Form",description:"",license:"MIT"}),e.jsx(ht,{name:"Zod",description:"TypeScript  schema ",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ht,{name:"clsx",description:" className ",license:"MIT"}),e.jsx(ht,{name:"tailwind-merge",description:"Tailwind ",license:"MIT"}),e.jsx(ht,{name:"class-variance-authority",description:"",license:"Apache-2.0"}),e.jsx(ht,{name:"date-fns",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ht,{name:"Framer Motion",description:"React ",license:"MIT"}),e.jsx(ht,{name:"vaul",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ht,{name:"FastAPI",description:" Python Web ",license:"MIT"}),e.jsx(ht,{name:"Uvicorn",description:"ASGI ",license:"BSD-3-Clause"}),e.jsx(ht,{name:"Pydantic",description:"",license:"MIT"}),e.jsx(ht,{name:"python-multipart",description:"",license:"Apache-2.0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ht,{name:"TypeScript",description:"JavaScript ",license:"Apache-2.0"}),e.jsx(ht,{name:"Vite",description:"",license:"MIT"}),e.jsx(ht,{name:"ESLint",description:"JavaScript ",license:"MIT"}),e.jsx(ht,{name:"PostCSS",description:"CSS ",license:"MIT"})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/5 border border-primary/20 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:"rounded-md bg-primary/10 px-2 py-1",children:e.jsx("span",{className:"text-xs sm:text-sm font-bold text-primary",children:"GPLv3"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm sm:text-base font-semibold text-foreground mb-1",children:"MaiBot WebUI"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" GNU General Public License v3.0  "})]})]})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"MITApache-2.0BSD  "})]})]})]})}function ht({name:l,description:n,license:i}){return e.jsxs("div",{className:"flex items-start justify-between gap-2 rounded-lg border bg-muted/30 p-2.5 sm:p-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:l}),e.jsx("p",{className:"text-muted-foreground text-xs mt-0.5",children:n})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary flex-shrink-0",children:i})]})}function Cm({value:l,current:n,onChange:i,label:c,description:u}){const x=n===l;return e.jsxs("button",{onClick:()=>i(l),className:P("relative rounded-lg border-2 p-3 sm:p-4 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",x?"border-primary bg-accent":"border-border"),children:[x&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3 h-2 w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm sm:text-base font-medium",children:c}),e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:u})]}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex gap-1",children:[l==="light"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-200"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-400"})]}),l==="dark"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"})]}),l==="system"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-200 to-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-300 to-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-400 to-slate-900"})]})]})]})}function Fa({value:l,current:n,onChange:i,label:c,colorClass:u}){const x=n===l;return e.jsxs("button",{onClick:()=>i(l),className:P("relative rounded-lg border-2 p-2 sm:p-3 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",x?"border-primary bg-accent":"border-border"),children:[x&&e.jsx("div",{className:"absolute top-1.5 right-1.5 sm:top-2 sm:right-2 h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"flex flex-col items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:P("h-8 w-8 sm:h-10 sm:w-10 rounded-full",u)}),e.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-center",children:c})]})]})}const U2=Date.now()%1e6;class $2{grad3;p;perm;constructor(n=0){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];for(let i=0;i<256;i++)this.p[i]=Math.floor(Math.random()*256);this.perm=[];for(let i=0;i<512;i++)this.perm[i]=this.p[i&255]}dot(n,i,c){return n[0]*i+n[1]*c}mix(n,i,c){return(1-c)*n+c*i}fade(n){return n*n*n*(n*(n*6-15)+10)}perlin2(n,i){const c=Math.floor(n)&255,u=Math.floor(i)&255;n-=Math.floor(n),i-=Math.floor(i);const x=this.fade(n),h=this.fade(i),f=this.perm[c]+u,p=this.perm[f],g=this.perm[f+1],N=this.perm[c+1]+u,v=this.perm[N],y=this.perm[N+1];return this.mix(this.mix(this.dot(this.grad3[p%12],n,i),this.dot(this.grad3[v%12],n-1,i),x),this.mix(this.dot(this.grad3[g%12],n,i-1),this.dot(this.grad3[y%12],n-1,i-1),x),h)}}function pg(){const l=m.useRef(null),n=m.useRef(null),i=m.useRef(void 0),[c]=m.useState(()=>new $2(U2)),u=m.useRef({mouse:{x:-10,y:0,lx:0,ly:0,sx:0,sy:0,v:0,vs:0,a:0,set:!1},lines:[],paths:[],noise:c,bounding:null});return m.useEffect(()=>{const x=n.current,h=l.current;if(!x||!h)return;const f=u.current;f.noise=c;const p=()=>{const A=x.getBoundingClientRect();f.bounding=A,h.style.width=`${A.width}px`,h.style.height=`${A.height}px`},g=()=>{if(!f.bounding)return;const{width:A,height:_}=f.bounding;f.lines=[],f.paths.forEach(me=>me.remove()),f.paths=[];const H=10,E=32,C=A+200,M=_+30,G=Math.ceil(C/H),D=Math.ceil(M/E),ee=(A-H*G)/2,R=(_-E*D)/2;for(let me=0;me<=G;me++){const ce=[];for(let se=0;se<=D;se++){const ge={x:ee+H*me,y:R+E*se,wave:{x:0,y:0},cursor:{x:0,y:0,vx:0,vy:0}};ce.push(ge)}const ve=document.createElementNS("http://www.w3.org/2000/svg","path");h.appendChild(ve),f.paths.push(ve),f.lines.push(ce)}},N=A=>{const{lines:_,mouse:H,noise:E}=f;_.forEach(C=>{C.forEach(M=>{const G=E.perlin2((M.x+A*.0125)*.002,(M.y+A*.005)*.0015)*12;M.wave.x=Math.cos(G)*32,M.wave.y=Math.sin(G)*16;const D=M.x-H.sx,ee=M.y-H.sy,R=Math.hypot(D,ee),me=Math.max(175,H.vs);if(R<me){const ce=1-R/me,ve=Math.cos(R*.001)*ce;M.cursor.vx+=Math.cos(H.a)*ve*me*H.vs*65e-5,M.cursor.vy+=Math.sin(H.a)*ve*me*H.vs*65e-5}M.cursor.vx+=(0-M.cursor.x)*.005,M.cursor.vy+=(0-M.cursor.y)*.005,M.cursor.vx*=.925,M.cursor.vy*=.925,M.cursor.x+=M.cursor.vx*2,M.cursor.y+=M.cursor.vy*2,M.cursor.x=Math.min(100,Math.max(-100,M.cursor.x)),M.cursor.y=Math.min(100,Math.max(-100,M.cursor.y))})})},v=(A,_=!0)=>{const H={x:A.x+A.wave.x+(_?A.cursor.x:0),y:A.y+A.wave.y+(_?A.cursor.y:0)};return H.x=Math.round(H.x*10)/10,H.y=Math.round(H.y*10)/10,H},y=()=>{const{lines:A,paths:_}=f;A.forEach((H,E)=>{let C=v(H[0],!1),M=`M ${C.x} ${C.y}`;H.forEach((G,D)=>{const ee=D===H.length-1;C=v(G,!ee),M+=`L ${C.x} ${C.y}`}),_[E].setAttribute("d",M)})},w=A=>{const{mouse:_}=f;_.sx+=(_.x-_.sx)*.1,_.sy+=(_.y-_.sy)*.1;const H=_.x-_.lx,E=_.y-_.ly,C=Math.hypot(H,E);_.v=C,_.vs+=(C-_.vs)*.1,_.vs=Math.min(100,_.vs),_.lx=_.x,_.ly=_.y,_.a=Math.atan2(E,H),x&&(x.style.setProperty("--x",`${_.sx}px`),x.style.setProperty("--y",`${_.sy}px`)),N(A),y(),i.current=requestAnimationFrame(w)},b=A=>{if(!f.bounding)return;const{mouse:_}=f;_.x=A.pageX-f.bounding.left,_.y=A.pageY-f.bounding.top+window.scrollY,_.set||(_.sx=_.x,_.sy=_.y,_.lx=_.x,_.ly=_.y,_.set=!0)},O=()=>{p(),g()};return p(),g(),window.addEventListener("resize",O),window.addEventListener("mousemove",b),i.current=requestAnimationFrame(w),()=>{window.removeEventListener("resize",O),window.removeEventListener("mousemove",b),i.current&&cancelAnimationFrame(i.current)}},[c]),e.jsxs("div",{ref:n,className:"waves-background",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},children:[e.jsx("div",{className:"waves-cursor",style:{position:"absolute",top:0,left:0,width:"0.5rem",height:"0.5rem",background:"hsl(var(--primary) / 0.3)",borderRadius:"50%",transform:"translate3d(calc(var(--x, -0.5rem) - 50%), calc(var(--y, 50%) - 50%), 0)",willChange:"transform",pointerEvents:"none"}}),e.jsx("svg",{ref:l,style:{display:"block",width:"100%",height:"100%"},children:e.jsx("style",{children:`
          path {
            fill: none;
            stroke: hsl(var(--primary) / 0.20);
            stroke-width: 1px;
          }
        `})})]})}function B2(){const[l,n]=m.useState(""),[i,c]=m.useState(!1),[u,x]=m.useState(""),[h,f]=m.useState(!0),p=ia(),{enableWavesBackground:g,setEnableWavesBackground:N}=nv(),{theme:v,setTheme:y}=Zm();m.useEffect(()=>{(async()=>{try{await tc()&&p({to:"/"})}catch{}finally{f(!1)}})()},[p]);const b=v==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":v,O=()=>{y(b==="dark"?"light":"dark")},A=async _=>{if(_.preventDefault(),x(""),!l.trim()){x(" Access Token");return}c(!0),console.log(" token...");try{const H=await fetch("/api/webui/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:l.trim()})});console.log("Token :",H.status);const E=await H.json();if(console.log("Token :",E),H.ok&&E.valid){console.log("Token ..."),console.log("is_first_setup:",E.is_first_setup),await new Promise(M=>setTimeout(M,100));const C=await tc();console.log(":",C),E.is_first_setup?(console.log(""),p({to:"/setup"})):(console.log(""),p({to:"/"}))}else console.error("Token :",E.message),x(E.message||"Token ")}catch(H){console.error("Token :",H),x("")}finally{c(!1)}};return h?e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(pg,{}),e.jsx("div",{className:"text-muted-foreground",children:"..."})]}):e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(pg,{}),e.jsxs(Se,{className:"relative z-10 w-full max-w-md shadow-2xl backdrop-blur-xl bg-card/80 border-border/50",children:[e.jsx("button",{onClick:O,className:"absolute right-4 top-4 rounded-lg p-2 hover:bg-accent transition-colors z-10 text-foreground",title:b==="dark"?"":"",children:b==="dark"?e.jsx(qm,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"}):e.jsx(Ki,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"})}),e.jsxs(ze,{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(lg,{className:"h-8 w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Re,{className:"text-2xl font-bold",children:" MaiBot"}),e.jsx(ws,{className:"text-base",children:" Access Token "})]})]}),e.jsx(Me,{children:e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"token",className:"text-sm font-medium",children:"Access Token"}),e.jsxs("div",{className:"relative",children:[e.jsx(Km,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground",strokeWidth:2,fill:"none"}),e.jsx(ne,{id:"token",type:"password",placeholder:" Access Token",value:l,onChange:_=>n(_.target.value),className:P("pl-10",u&&"border-red-500 focus-visible:ring-red-500"),disabled:i,autoFocus:!0,autoComplete:"off"})]})]}),u&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-red-50 p-3 text-sm text-red-600 dark:bg-red-950/50 dark:text-red-400",children:[e.jsx(St,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{children:u})]}),e.jsx(S,{type:"submit",className:"w-full",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):""}),e.jsxs(Ps,{children:[e.jsx(ed,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-primary hover:text-primary/80 transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(Mj,{className:"h-4 w-4",strokeWidth:2,fill:"none"})," Token Token"]})}),e.jsxs(Us,{className:"sm:max-w-md",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(lg,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"})," Access Token"]}),e.jsx(Js,{children:"Access Token  MaiBot WebUI "})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Vw,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" MaiBot  WebUI Access Token"}),e.jsxs("div",{className:"rounded bg-background p-2 font-mono text-xs",children:[e.jsx("p",{className:"text-muted-foreground",children:" WebUI Access Token: abc123..."}),e.jsx("p",{className:"text-muted-foreground",children:"  Token  WebUI"})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ka,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Token "}),e.jsx("div",{className:"rounded bg-background p-2 font-mono text-xs break-all",children:e.jsx("code",{className:"text-primary",children:"data/webui.json"})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",e.jsx("code",{className:"px-1 py-0.5 bg-background rounded",children:"access_token"})," "]})]})]})}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(St,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token"})]})]})]})})]})]})]}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(Xa,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsxs(xs,{className:"flex items-center gap-2",children:[e.jsx(Xa,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"}),""]}),e.jsx(hs,{children:""})]}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>N(!1),children:""})]})]})]})]})})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:b2})})]})}const at=m.forwardRef(({className:l,...n},i)=>e.jsx("textarea",{className:P("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),ref:i,...n}));at.displayName="Textarea";const Qt=m.forwardRef(({className:l,orientation:n="horizontal",decorative:i=!0,...c},u)=>e.jsx(Xg,{ref:u,decorative:i,orientation:n,className:P("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",l),...c}));Qt.displayName=Xg.displayName;function I2({config:l,onChange:n}){const i=u=>{u.trim()&&!l.alias_names.includes(u.trim())&&n({...l,alias_names:[...l.alias_names,u.trim()]})},c=u=>{n({...l,alias_names:l.alias_names.filter((x,h)=>h!==u)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ *"}),e.jsx(ne,{id:"qq_account",type:"number",placeholder:"QQ",value:l.qq_account||"",onChange:u=>n({...l,qq_account:Number(u.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"QQ"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"nickname",children:" *"}),e.jsx(ne,{id:"nickname",placeholder:"",value:l.nickname,onChange:u=>n({...l,nickname:u.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{children:""}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:l.alias_names.map((u,x)=>e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[u,e.jsx("button",{type:"button",onClick:()=>c(x),className:"ml-1 hover:text-destructive",children:e.jsx(Ma,{className:"h-3 w-3"})})]},x))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{id:"alias_input",placeholder:"",onKeyPress:u=>{u.key==="Enter"&&(i(u.target.value),u.target.value="")}}),e.jsx(S,{type:"button",variant:"outline",onClick:()=>{const u=document.getElementById("alias_input");u&&(i(u.value),u.value="")},children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function P2({config:l,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"personality",children:" *"}),e.jsx(at,{id:"personality",placeholder:"120",value:l.personality,onChange:i=>n({...l,personality:i.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"reply_style",children:" *"}),e.jsx(at,{id:"reply_style",placeholder:"",value:l.reply_style,onChange:i=>n({...l,reply_style:i.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"interest",children:" *"}),e.jsx(at,{id:"interest",placeholder:"",value:l.interest,onChange:i=>n({...l,interest:i.target.value}),rows:2}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"plan_style",children:" *"}),e.jsx(at,{id:"plan_style",placeholder:"",value:l.plan_style,onChange:i=>n({...l,plan_style:i.target.value}),rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"private_plan_style",children:" *"}),e.jsx(at,{id:"private_plan_style",placeholder:"",value:l.private_plan_style,onChange:i=>n({...l,private_plan_style:i.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function H2({config:l,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[(l.emoji_chance*100).toFixed(0),"%"]})]}),e.jsx(ne,{id:"emoji_chance",type:"range",min:"0",max:"1",step:"0.1",value:l.emoji_chance,onChange:i=>n({...l,emoji_chance:Number(i.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ne,{id:"max_reg_num",type:"number",min:"1",max:"200",value:l.max_reg_num,onChange:i=>n({...l,max_reg_num:Number(i.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"do_replace",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"do_replace",checked:l.do_replace,onCheckedChange:i=>n({...l,do_replace:i})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ne,{id:"check_interval",type:"number",min:"1",max:"120",value:l.check_interval,onChange:i=>n({...l,check_interval:Number(i.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"steal_emoji",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"steal_emoji",checked:l.steal_emoji,onCheckedChange:i=>n({...l,steal_emoji:i})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"content_filtration",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"content_filtration",checked:l.content_filtration,onCheckedChange:i=>n({...l,content_filtration:i})})]}),l.content_filtration&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ne,{id:"filtration_prompt",placeholder:"",value:l.filtration_prompt,onChange:i=>n({...l,filtration_prompt:i.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function F2({config:l,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"enable_tool",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"enable_tool",checked:l.enable_tool,onCheckedChange:i=>n({...l,enable_tool:i})})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"all_global",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"all_global",checked:l.all_global,onCheckedChange:i=>n({...l,all_global:i})})]})]})}function G2({config:l,onChange:n}){const[i,c]=m.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:" (SiliconFlow)"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 mb-2",children:" DeepSeek V3Qwen  API Key "}),e.jsxs("a",{href:"https://cloud.siliconflow.cn",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:underline font-medium",children:[" API Key",e.jsx(Mo,{className:"h-3 w-3"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"siliconflow_api_key",children:"SiliconFlow API Key *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{id:"siliconflow_api_key",type:i?"text":"password",placeholder:"sk-...",value:l.api_key,onChange:u=>n({api_key:u.target.value}),className:"font-mono pr-10"}),e.jsx(S,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!i),children:i?e.jsx(Zi,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(na,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" API "})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground ml-2",children:[e.jsx("li",{children:"DeepSeek V3 - "}),e.jsx("li",{children:"Qwen3 30B - "}),e.jsx("li",{children:"Qwen3 VL 30B - "}),e.jsx("li",{children:"SenseVoice - "}),e.jsx("li",{children:"BGE-M3 - "}),e.jsx("li",{children:" (LPMM)"})]})]}),e.jsx("div",{className:"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 p-4",children:e.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-medium",children:" "}),'"  " API ']})})]})}async function V2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("Bot");const i=(await l.json()).config.bot||{};return{qq_account:i.qq_account||0,nickname:i.nickname||"",alias_names:i.alias_names||[]}}async function q2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");const i=(await l.json()).config.personality||{};return{personality:i.personality||"",reply_style:i.reply_style||"",interest:i.interest||"",plan_style:i.plan_style||"",private_plan_style:i.private_plan_style||""}}async function K2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");const i=(await l.json()).config.emoji||{};return{emoji_chance:i.emoji_chance??.4,max_reg_num:i.max_reg_num??40,do_replace:i.do_replace??!0,check_interval:i.check_interval??10,steal_emoji:i.steal_emoji??!0,content_filtration:i.content_filtration??!1,filtration_prompt:i.filtration_prompt||""}}async function Q2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");const i=(await l.json()).config,c=i.tool||{},u=i.expression||{};return{enable_tool:c.enable_tool??!0,all_global:u.all_global_jargon??!0}}async function Y2(){const l=await we("/api/webui/config/model",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");return{api_key:((await l.json()).config.api_providers||[]).find(x=>x.name==="SiliconFlow")?.api_key||""}}async function J2(l){const n=await we("/api/webui/config/bot/section/bot",{method:"POST",headers:Fs(),body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"Bot")}return await n.json()}async function X2(l){const n=await we("/api/webui/config/bot/section/personality",{method:"POST",headers:Fs(),body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function Z2(l){const n=await we("/api/webui/config/bot/section/emoji",{method:"POST",headers:Fs(),body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function W2(l){const n=[];n.push(we("/api/webui/config/bot/section/tool",{method:"POST",headers:Fs(),body:JSON.stringify({enable_tool:l.enable_tool})})),n.push(we("/api/webui/config/bot/section/expression",{method:"POST",headers:Fs(),body:JSON.stringify({all_global_jargon:l.all_global})}));const i=await Promise.all(n);for(const c of i)if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return{success:!0}}async function e1(l){const n=await we("/api/webui/config/model",{method:"GET",headers:Fs()});if(!n.ok)throw new Error("");const c=(await n.json()).config,u=c.api_providers||[],x=u.findIndex(p=>p.name==="SiliconFlow");x>=0?u[x]={...u[x],api_key:l.api_key}:u.push({name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",api_key:l.api_key,client_type:"openai",max_retry:3,timeout:120,retry_interval:5});const h={...c,api_providers:u},f=await we("/api/webui/config/model",{method:"POST",headers:Fs(),body:JSON.stringify(h)});if(!f.ok){const p=await f.json();throw new Error(p.detail||"")}return await f.json()}async function gg(){const l=await we("/api/webui/setup/complete",{method:"POST"});if(!l.ok){const n=await l.json();throw new Error(n.message||"")}return await l.json()}function s1(){return e.jsx(Kn,{children:e.jsx(t1,{})})}function t1(){const l=ia(),{toast:n}=st(),{triggerRestart:i}=pn(),[c,u]=m.useState(0),[x,h]=m.useState(!1),[f,p]=m.useState(!1),[g,N]=m.useState(!0),[v,y]=m.useState({qq_account:0,nickname:"",alias_names:[]}),[w,b]=m.useState({personality:"",reply_style:"",interest:"",plan_style:`1.****action****
2.
3.
4.
5.`,private_plan_style:`1.****action****
2.
3.`}),[O,A]=m.useState({emoji_chance:.4,max_reg_num:40,do_replace:!0,check_interval:10,steal_emoji:!0,content_filtration:!1,filtration_prompt:""}),[_,H]=m.useState({enable_tool:!0,all_global:!0}),[E,C]=m.useState({api_key:""}),M=[{id:"bot-basic",title:"Bot",description:"",icon:$r},{id:"personality",title:"",description:"",icon:In},{id:"emoji",title:"",description:"",icon:Yo},{id:"other",title:"",description:"",icon:xn},{id:"siliconflow",title:"API",description:"API",icon:Km}],G=(c+1)/M.length*100;m.useEffect(()=>{(async()=>{try{N(!0);const[ge,fe,z,Q,I]=await Promise.all([V2(),q2(),K2(),Q2(),Y2()]);y(ge),b(fe),A(z),H(Q),C(I)}catch(ge){n({title:"",description:ge instanceof Error?ge.message:"",variant:"destructive"})}finally{N(!1)}})()},[n]);const D=async()=>{p(!0);try{switch(c){case 0:await J2(v);break;case 1:await X2(w);break;case 2:await Z2(O);break;case 3:await W2(_);break;case 4:await e1(E);break}return n({title:"",description:`${M[c].title}`}),!0}catch(se){return n({title:"",description:se instanceof Error?se.message:"",variant:"destructive"}),!1}finally{p(!1)}},ee=async()=>{await D()&&c<M.length-1&&u(c+1)},R=()=>{c>0&&u(c-1)},me=async()=>{h(!0);try{if(!await D()){h(!1);return}await gg(),n({title:"",description:"..."}),await i()}catch(se){n({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{h(!1)}},ce=async()=>{try{await gg(),l({to:"/"})}catch(se){n({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}},ve=()=>{switch(c){case 0:return e.jsx(I2,{config:v,onChange:y});case 1:return e.jsx(P2,{config:w,onChange:b});case 2:return e.jsx(H2,{config:O,onChange:A});case 3:return e.jsx(F2,{config:_,onChange:H});case 4:return e.jsx(G2,{config:E,onChange:C});default:return null}};return e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center justify-center overflow-hidden bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4 md:p-6",children:[e.jsx(Qn,{}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute left-1/4 top-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-primary/5 blur-3xl"}),e.jsx("div",{className:"absolute right-1/4 bottom-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-secondary/5 blur-3xl"})]}),g?e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center",children:e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative z-10 w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6 md:mb-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 md:h-16 md:w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(qw,{className:"h-6 w-6 md:h-8 md:w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsx("h1",{className:"mb-2 text-2xl md:text-3xl font-bold",children:""}),e.jsxs("p",{className:"text-sm md:text-base text-muted-foreground",children:[" ",Wm," "]})]}),e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs md:text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[" ",c+1," / ",M.length]}),e.jsxs("span",{className:"font-medium text-primary",children:[Math.round(G),"%"]})]}),e.jsx(Vn,{value:G,className:"h-2"})]}),e.jsx("div",{className:"mb-6 md:mb-8 flex justify-between",children:M.map((se,ge)=>{const fe=se.icon;return e.jsxs("div",{className:P("flex flex-1 flex-col items-center gap-1 md:gap-2",ge<M.length-1&&"relative"),children:[ge<M.length-1&&e.jsx("div",{className:P("absolute left-1/2 top-3 md:top-4 h-0.5 w-full",ge<c?"bg-primary":"bg-border")}),e.jsx("div",{className:P("relative z-10 flex h-6 w-6 md:h-8 md:w-8 items-center justify-center rounded-full border-2 transition-all",ge===c||ge<c?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-muted-foreground"),children:ge<c?e.jsx(Wt,{className:"h-3 w-3 md:h-4 md:w-4",strokeWidth:2.5,fill:"none"}):e.jsx(fe,{className:"h-3 w-3 md:h-4 md:w-4"})}),e.jsx("span",{className:P("text-[10px] md:text-xs text-center max-w-[60px] md:max-w-none truncate md:whitespace-normal",ge===c?"font-medium text-foreground":"text-muted-foreground"),title:se.title,children:se.title})]},se.id)})}),e.jsx(Se,{className:"mb-6 md:mb-8 shadow-lg",children:e.jsx(Me,{className:"p-4 md:p-8",children:e.jsxs("div",{className:"min-h-[300px] md:min-h-[400px]",children:[e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsx("h2",{className:"mb-2 text-xl md:text-2xl font-semibold",children:M[c].title}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:M[c].description})]}),e.jsx(Je,{className:"h-[400px] md:h-[500px]",children:e.jsx("div",{className:"pr-2",children:ve()})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx(S,{variant:"outline",onClick:R,disabled:c===0||f,className:"w-full sm:w-auto order-2 sm:order-1",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto order-1 sm:order-2",children:[e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{variant:"ghost",className:"flex-1 sm:flex-none gap-2",disabled:f||x,children:[e.jsx(Kw,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:""})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:ce,children:""})]})]})]}),c===M.length-1?e.jsx(S,{onClick:me,disabled:x||f,className:"flex-1 sm:flex-none",children:x||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),f?"...":"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(Wt,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})}):e.jsx(S,{onClick:ee,disabled:f,className:"flex-1 sm:flex-none",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(Qw,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})})]})]})]}),e.jsx("div",{className:"relative z-10 mt-6 md:mt-8 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:""})})]})]})}function ov(){const l=ia();return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("h1",{className:"text-[150px] font-black leading-none text-primary/10 select-none sm:text-[200px]",children:"404"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Dt,{className:"h-20 w-20 text-primary/30 sm:h-24 sm:w-24"})})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground sm:text-3xl",children:""}),e.jsx("p",{className:"text-base text-muted-foreground sm:text-lg max-w-md mx-auto",children:" URL "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs(S,{size:"lg",onClick:()=>l({to:"/"}),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Jo,{className:"h-4 w-4"}),""]}),e.jsxs(S,{size:"lg",variant:"outline",onClick:()=>window.history.back(),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Ta,{className:"h-4 w-4"}),""]})]}),e.jsx("div",{className:"mt-12 pt-8 border-t border-border",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})})]})})}const a1=zs.memo(function({config:n,onChange:i}){const c=n.platforms||[],u=n.alias_names||[],x=()=>{i({...n,platforms:[...c,""]})},h=v=>{i({...n,platforms:c.filter((y,w)=>w!==v)})},f=(v,y)=>{const w=[...c];w[v]=y,i({...n,platforms:w})},p=()=>{i({...n,alias_names:[...u,""]})},g=v=>{i({...n,alias_names:u.filter((y,w)=>w!==v)})},N=(v,y)=>{const w=[...u];w[v]=y,i({...n,alias_names:w})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"platform",children:""}),e.jsx(ne,{id:"platform",value:n.platform,onChange:v=>i({...n,platform:v.target.value}),placeholder:"qq"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ"}),e.jsx(ne,{id:"qq_account",value:n.qq_account,onChange:v=>i({...n,qq_account:v.target.value}),placeholder:"123456789"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ne,{id:"nickname",value:n.nickname,onChange:v=>i({...n,nickname:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(S,{onClick:x,size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((v,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:v,onChange:w=>f(y,w.target.value),placeholder:"wx:114514"}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',v||"()",'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>h(y),children:""})]})]})]})]},y)),c.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(S,{onClick:p,size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[u.map((v,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:v,onChange:w=>N(y,w.target.value),placeholder:""}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',v||"()",'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>g(y),children:""})]})]})]})]},y)),u.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})]})})}),l1=zs.memo(function({config:n,onChange:i}){const c=()=>{i({...n,states:[...n.states,""]})},u=h=>{i({...n,states:n.states.filter((f,p)=>p!==h)})},x=(h,f)=>{const p=[...n.states];p[h]=f,i({...n,states:p})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"personality",children:""}),e.jsx(at,{id:"personality",value:n.personality,onChange:h=>i({...n,personality:h.target.value}),placeholder:"120",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"120"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"reply_style",children:""}),e.jsx(at,{id:"reply_style",value:n.reply_style,onChange:h=>i({...n,reply_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"interest",children:""}),e.jsx(at,{id:"interest",value:n.interest,onChange:h=>i({...n,interest:h.target.value}),placeholder:"",rows:2})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_style",children:""}),e.jsx(at,{id:"plan_style",value:n.plan_style,onChange:h=>i({...n,plan_style:h.target.value}),placeholder:"",rows:5})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"visual_style",children:""}),e.jsx(at,{id:"visual_style",value:n.visual_style,onChange:h=>i({...n,visual_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"private_plan_style",children:""}),e.jsx(at,{id:"private_plan_style",value:n.private_plan_style,onChange:h=>i({...n,private_plan_style:h.target.value}),placeholder:"",rows:4})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(S,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsx("div",{className:"space-y-2",children:n.states.map((h,f)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(at,{value:h,onChange:p=>x(f,p.target.value),placeholder:"",rows:2}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:""})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>u(f),children:""})]})]})]})]},f))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"state_probability",children:""}),e.jsx(ne,{id:"state_probability",type:"number",step:"0.1",min:"0",max:"1",value:n.state_probability,onChange:h=>i({...n,state_probability:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" personality 0.0-1.0"})]})]})]})})}),Ie=Cw,Pe=Tw,$e=m.forwardRef(({className:l,children:n,...i},c)=>e.jsxs(xj,{ref:c,className:P("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",l),...i,children:[n,e.jsx(yw,{asChild:!0,children:e.jsx(Aa,{className:"h-4 w-4 opacity-50"})})]}));$e.displayName=xj.displayName;const dv=m.forwardRef(({className:l,...n},i)=>e.jsx(hj,{ref:i,className:P("flex cursor-default items-center justify-center py-1",l),...n,children:e.jsx(Hr,{className:"h-4 w-4"})}));dv.displayName=hj.displayName;const uv=m.forwardRef(({className:l,...n},i)=>e.jsx(fj,{ref:i,className:P("flex cursor-default items-center justify-center py-1",l),...n,children:e.jsx(Aa,{className:"h-4 w-4"})}));uv.displayName=fj.displayName;const Be=m.forwardRef(({className:l,children:n,position:i="popper",...c},u)=>e.jsx(ww,{children:e.jsxs(pj,{ref:u,className:P("relative z-[100] max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-hidden rounded-md border border-border bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",i==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",l),position:i,...c,children:[e.jsx(dv,{}),e.jsx(_w,{className:P("p-1",i==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(uv,{})]})}));Be.displayName=pj.displayName;const n1=m.forwardRef(({className:l,...n},i)=>e.jsx(gj,{ref:i,className:P("px-2 py-1.5 text-sm font-semibold",l),...n}));n1.displayName=gj.displayName;const W=m.forwardRef(({className:l,children:n,...i},c)=>e.jsxs(jj,{ref:c,className:P("relative flex w-full cursor-default select-none items-center rounded-sm py-2 pl-2 pr-8 text-sm outline-none bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-gray-100 dark:focus:bg-gray-800 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),...i,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Sw,{children:e.jsx(_t,{className:"h-4 w-4"})})}),e.jsx(kw,{children:n})]}));W.displayName=jj.displayName;const r1=m.forwardRef(({className:l,...n},i)=>e.jsx(vj,{ref:i,className:P("-mx-1 my-1 h-px bg-muted",l),...n}));r1.displayName=vj.displayName;const il=H0,cl=F0,Za=m.forwardRef(({className:l,align:n="center",sideOffset:i=4,...c},u)=>e.jsx(P0,{children:e.jsx(Zg,{ref:u,align:n,sideOffset:i,className:P("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",l),...c})}));Za.displayName=Zg.displayName;const i1=zs.memo(function({value:n,onChange:i}){const c=m.useMemo(()=>{const w=n.split("-");if(w.length===2){const[b,O]=w,[A,_]=b.split(":"),[H,E]=O.split(":");return{startHour:A?A.padStart(2,"0"):"00",startMinute:_?_.padStart(2,"0"):"00",endHour:H?H.padStart(2,"0"):"23",endMinute:E?E.padStart(2,"0"):"59"}}return{startHour:"00",startMinute:"00",endHour:"23",endMinute:"59"}},[n]),[u,x]=m.useState(c.startHour),[h,f]=m.useState(c.startMinute),[p,g]=m.useState(c.endHour),[N,v]=m.useState(c.endMinute);m.useEffect(()=>{x(c.startHour),f(c.startMinute),g(c.endHour),v(c.endMinute)},[c]);const y=(w,b,O,A)=>{const _=`${w}:${b}-${O}:${A}`;i(_)};return e.jsxs(il,{children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",className:"w-full justify-start font-mono text-sm",children:[e.jsx(Ca,{className:"h-4 w-4 mr-2"}),n||""]})}),e.jsx(Za,{className:"w-72 sm:w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:u,onValueChange:w=>{x(w),y(w,h,p,N)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:24},(w,b)=>b).map(w=>e.jsx(W,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:h,onValueChange:w=>{f(w),y(u,w,p,N)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:60},(w,b)=>b).map(w=>e.jsx(W,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:p,onValueChange:w=>{g(w),y(u,h,w,N)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:24},(w,b)=>b).map(w=>e.jsx(W,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Ie,{value:N,onValueChange:w=>{v(w),y(u,h,p,w)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:60},(w,b)=>b).map(w=>e.jsx(W,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]})]})]})]})})]})}),c1=zs.memo(function({rule:n}){const i=`{ target = "${n.target}", time = "${n.time}", value = ${n.value.toFixed(1)} }`;return e.jsxs(il,{children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Za,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:i}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})}),o1=zs.memo(function({config:n,onChange:i}){const c=()=>{i({...n,talk_value_rules:[...n.talk_value_rules,{target:"",time:"00:00-23:59",value:1}]})},u=h=>{i({...n,talk_value_rules:n.talk_value_rules.filter((f,p)=>p!==h)})},x=(h,f,p)=>{const g=[...n.talk_value_rules];g[h]={...g[h],[f]:p},i({...n,talk_value_rules:g})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"talk_value",children:""}),e.jsx(ne,{id:"talk_value",type:"number",step:"0.1",min:"0",max:"1",value:n.talk_value,onChange:h=>i({...n,talk_value:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"mentioned_bot_reply",checked:n.mentioned_bot_reply,onCheckedChange:h=>i({...n,mentioned_bot_reply:h})}),e.jsx(T,{htmlFor:"mentioned_bot_reply",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_context_size",children:""}),e.jsx(ne,{id:"max_context_size",type:"number",min:"1",value:n.max_context_size,onChange:h=>i({...n,max_context_size:parseInt(h.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"planner_smooth",children:""}),e.jsx(ne,{id:"planner_smooth",type:"number",step:"1",min:"0",value:n.planner_smooth,onChange:h=>i({...n,planner_smooth:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" planner  1-50 "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_talk_value_rules",checked:n.enable_talk_value_rules,onCheckedChange:h=>i({...n,enable_talk_value_rules:h})}),e.jsx(T,{htmlFor:"enable_talk_value_rules",className:"cursor-pointer",children:""})]})]})]}),n.enable_talk_value_rules&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ID"})]}),e.jsxs(S,{onClick:c,size:"sm",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),n.talk_value_rules&&n.talk_value_rules.length>0?e.jsx("div",{className:"space-y-4",children:n.talk_value_rules.map((h,f)=>e.jsxs("div",{className:"rounded-lg border p-4 bg-muted/50 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[" #",f+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c1,{rule:h}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"sm",children:e.jsx(ns,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" #",f+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>u(f),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:h.target===""?"global":"specific",onValueChange:p=>{p==="global"?x(f,"target",""):x(f,"target","qq::group")},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"global",children:""}),e.jsx(W,{value:"specific",children:""})]})]})]}),h.target!==""&&(()=>{const p=h.target.split(":"),g=p[0]||"qq",N=p[1]||"",v=p[2]||"group";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:g,onValueChange:y=>{x(f,"target",`${y}:${N}:${v}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ne,{value:N,onChange:y=>{x(f,"target",`${g}:${y.target.value}:${v}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:v,onValueChange:y=>{x(f,"target",`${g}:${N}:${y}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"group",children:"group"}),e.jsx(W,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",h.target||""]})]})})(),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" (Time)"}),e.jsx(i1,{value:h.time,onChange:p=>x(f,"time",p)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00-02:00"})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:`rule-value-${f}`,className:"text-xs font-medium",children:" (Value)"}),e.jsx(ne,{id:`rule-value-${f}`,type:"number",step:"0.01",min:"0.01",max:"1",value:h.value,onChange:p=>{const g=parseFloat(p.target.value);isNaN(g)||x(f,"value",Math.max(.01,Math.min(1,g)))},className:"w-20 h-8 text-xs"})]}),e.jsx(Sa,{value:[h.value],onValueChange:p=>x(f,"value",p[0]),min:.01,max:1,step:.01,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0.01 ()"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0 ()"})]})]})]})]},f))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:'""'})}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),"platform:id:type"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 23:00-02:00 112"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 0-10 1 "]})]})]})]})]})}),d1=zs.memo(function({config:n,onChange:i}){const c=_=>{if(!_||!_.includes(":"))return{platform:"qq",userId:""};const[H,E]=_.split(":");return{platform:H,userId:E}},{platform:u,userId:x}=c(n.dream_send),[h,f]=m.useState(u),[p,g]=m.useState(x),N=_=>{const[H,E]=_.split("-");return{startTime:H||"09:00",endTime:E||"22:00"}},v=(_,H)=>{const E=H?`${_}:${H}`:"";i({...n,dream_send:E})},y=_=>{f(_),v(_,p)},w=_=>{g(_),v(h,_)},b=()=>{i({...n,dream_time_ranges:[...n.dream_time_ranges,"09:00-22:00"]})},O=_=>{i({...n,dream_time_ranges:n.dream_time_ranges.filter((H,E)=>E!==_)})},A=(_,H,E)=>{const C=[...n.dream_time_ranges],M=N(C[_]);H==="startTime"?M.startTime=E:M.endTime=E,C[_]=`${M.startTime}-${M.endTime}`,i({...n,dream_time_ranges:C})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"interval_minutes",children:""}),e.jsx(ne,{id:"interval_minutes",type:"number",min:"1",value:n.interval_minutes,onChange:_=>i({...n,interval_minutes:Number(_.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"max_iterations",children:""}),e.jsx(ne,{id:"max_iterations",type:"number",min:"1",value:n.max_iterations,onChange:_=>i({...n,max_iterations:Number(_.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"first_delay_seconds",children:""}),e.jsx(ne,{id:"first_delay_seconds",type:"number",min:"0",value:n.first_delay_seconds,onChange:_=>i({...n,first_delay_seconds:Number(_.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ie,{value:h,onValueChange:y,children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""}),e.jsx(W,{value:"webui",children:"WebUI"})]})]}),e.jsx(ne,{type:"text",placeholder:"ID (: 123456)",value:p,onChange:_=>w(_.target.value),className:"flex-1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IDID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(S,{type:"button",size:"sm",onClick:b,children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00  02:00"}),e.jsxs("div",{className:"space-y-2",children:[n.dream_time_ranges.map((_,H)=>{const{startTime:E,endTime:C}=N(_);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"time",value:E,onChange:M=>A(H,"startTime",M.target.value),className:"w-[140px]"}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(ne,{type:"time",value:C,onChange:M=>A(H,"endTime",M.target.value),className:"w-[140px]"}),e.jsx(S,{type:"button",variant:"ghost",size:"icon",onClick:()=>O(H),children:e.jsx(Ma,{className:"h-4 w-4"})})]},H)}),n.dream_time_ranges.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})}),u1=zs.memo(function({config:n,onChange:i}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.enable,onCheckedChange:c=>i({...n,enable:c})}),e.jsx(T,{className:"cursor-pointer",children:" LPMM "})]}),n.enable&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"LPMM "}),e.jsxs(Ie,{value:n.lpmm_mode,onValueChange:c=>i({...n,lpmm_mode:c}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:" LPMM "})}),e.jsxs(Be,{children:[e.jsx(W,{value:"classic",children:""}),e.jsx(W,{value:"agent",children:"Agent "})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" TopK"}),e.jsx(ne,{type:"number",min:"1",value:n.rag_synonym_search_top_k,onChange:c=>i({...n,rag_synonym_search_top_k:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",step:"0.1",min:"0",max:"1",value:n.rag_synonym_threshold,onChange:c=>i({...n,rag_synonym_threshold:parseFloat(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:n.info_extraction_workers,onChange:c=>i({...n,info_extraction_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:n.embedding_dimension,onChange:c=>i({...n,embedding_dimension:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:n.max_embedding_workers,onChange:c=>i({...n,max_embedding_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:n.embedding_chunk_size,onChange:c=>i({...n,embedding_chunk_size:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:n.max_synonym_entities,onChange:c=>i({...n,max_synonym_entities:parseInt(c.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.enable_ppr,onCheckedChange:c=>i({...n,enable_ppr:c})}),e.jsx(T,{className:"cursor-pointer",children:" PPR ()"})]})]})]})]})}),m1=zs.memo(function({config:n,onChange:i}){const[c,u]=m.useState(""),[x,h]=m.useState("WARNING"),f=()=>{c&&!n.suppress_libraries.includes(c)&&(i({...n,suppress_libraries:[...n.suppress_libraries,c]}),u(""))},p=b=>{i({...n,suppress_libraries:n.suppress_libraries.filter(O=>O!==b)})},g=()=>{c&&!n.library_log_levels[c]&&(i({...n,library_log_levels:{...n.library_log_levels,[c]:x}}),u(""),h("WARNING"))},N=b=>{const O={...n.library_log_levels};delete O[b],i({...n,library_log_levels:O})},v=["DEBUG","INFO","WARNING","ERROR","CRITICAL"],y=["FULL","compact","lite"],w=["none","title","full"];return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{value:n.date_style,onChange:b=>i({...n,date_style:b.target.value}),placeholder:": m-d H:i:s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"m=, d=, H=, i=, s="})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:n.log_level_style,onValueChange:b=>i({...n,log_level_style:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:y.map(b=>e.jsx(W,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:n.color_text,onValueChange:b=>i({...n,color_text:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:w.map(b=>e.jsx(W,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:n.log_level,onValueChange:b=>i({...n,log_level:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(W,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:n.console_log_level,onValueChange:b=>i({...n,console_log_level:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(W,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:n.file_log_level,onValueChange:b=>i({...n,file_log_level:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(W,{value:b,children:b},b))})]})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:c,onChange:b=>u(b.target.value),placeholder:"",className:"flex-1",onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),f())}}),e.jsx(S,{onClick:f,size:"sm",className:"flex-shrink-0",children:e.jsx(Zs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.suppress_libraries.map(b=>e.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-3 py-1 rounded-md",children:[e.jsx("span",{className:"text-sm",children:b}),e.jsx(S,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>p(b),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},b))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:c,onChange:b=>u(b.target.value),placeholder:"",className:"flex-1"}),e.jsxs(Ie,{value:x,onValueChange:h,children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(W,{value:b,children:b},b))})]}),e.jsx(S,{onClick:g,size:"sm",children:e.jsx(Zs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(n.library_log_levels).map(([b,O])=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-medium",children:b}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:O}),e.jsx(S,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(b),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]})]},b))})]})]})}),x1=zs.memo(function({config:n,onChange:i}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_prompt,onCheckedChange:c=>i({...n,show_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_replyer_prompt,onCheckedChange:c=>i({...n,show_replyer_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_replyer_reasoning,onCheckedChange:c=>i({...n,show_replyer_reasoning:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Jargon Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_jargon_prompt,onCheckedChange:c=>i({...n,show_jargon_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_memory_prompt,onCheckedChange:c=>i({...n,show_memory_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Planner Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Planner "})]}),e.jsx(Fe,{checked:n.show_planner_prompt,onCheckedChange:c=>i({...n,show_planner_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" LPMM "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LPMM "})]}),e.jsx(Fe,{checked:n.show_lpmm_paragraph,onCheckedChange:c=>i({...n,show_lpmm_paragraph:c})})]})]})]})}),h1=zs.memo(function({config:n,onChange:i}){const[c,u]=m.useState(""),[x,h]=m.useState(""),f=()=>{c&&!n.auth_token.includes(c)&&(i({...n,auth_token:[...n.auth_token,c]}),u(""))},p=v=>{i({...n,auth_token:n.auth_token.filter((y,w)=>w!==v)})},g=()=>{x&&!n.api_server_allowed_api_keys.includes(x)&&(i({...n,api_server_allowed_api_keys:[...n.api_server_allowed_api_keys,x]}),h(""))},N=v=>{i({...n,api_server_allowed_api_keys:n.api_server_allowed_api_keys.filter((y,w)=>w!==v)})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:" API "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:" API "}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:c,onChange:v=>u(v.target.value),placeholder:"",onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),f())}}),e.jsx(S,{onClick:f,size:"sm",children:e.jsx(Zs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:n.auth_token.map((v,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:v}),e.jsx(S,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>p(y),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:" API Server "}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" API Server"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" API Server"})]}),e.jsx(Fe,{checked:n.enable_api_server,onCheckedChange:v=>i({...n,enable_api_server:v})})]}),n.enable_api_server&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{value:n.api_server_host,onChange:v=>i({...n,api_server_host:v.target.value}),placeholder:"0.0.0.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",value:n.api_server_port,onChange:v=>i({...n,api_server_port:parseInt(v.target.value)}),placeholder:"8090"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.api_server_use_wss,onCheckedChange:v=>i({...n,api_server_use_wss:v})}),e.jsx(T,{children:" WSS "})]}),n.api_server_use_wss&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ne,{value:n.api_server_cert_file,onChange:v=>i({...n,api_server_cert_file:v.target.value}),placeholder:"cert.pem"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ne,{value:n.api_server_key_file,onChange:v=>i({...n,api_server_key_file:v.target.value}),placeholder:"key.pem"})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:" API Key "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:x,onChange:v=>h(v.target.value),placeholder:" API Key",onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),g())}}),e.jsx(S,{onClick:g,size:"sm",children:e.jsx(Zs,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:n.api_server_allowed_api_keys.map((v,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:v}),e.jsx(S,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(y),children:e.jsx(ns,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]})]})]})]})]})}),f1=zs.memo(function({config:n,onChange:i}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.enable,onCheckedChange:c=>i({...n,enable:c})})]})]})}),p1=zs.memo(function({emojiConfig:n,memoryConfig:i,toolConfig:c,voiceConfig:u,onEmojiChange:x,onMemoryChange:h,onToolChange:f,onVoiceChange:p}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_tool",checked:c.enable_tool,onCheckedChange:g=>f({...c,enable_tool:g})}),e.jsx(T,{htmlFor:"enable_tool",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(Fe,{id:"enable_asr",checked:u.enable_asr,onCheckedChange:g=>p({...u,enable_asr:g})}),e.jsx(T,{htmlFor:"enable_asr",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_agent_iterations",children:""}),e.jsx(ne,{id:"max_agent_iterations",type:"number",min:"1",value:i.max_agent_iterations,onChange:g=>h({...i,max_agent_iterations:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"agent_timeout_seconds",children:""}),e.jsx(ne,{id:"agent_timeout_seconds",type:"number",min:"1",step:"0.1",value:i.agent_timeout_seconds??120,onChange:g=>h({...i,agent_timeout_seconds:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_jargon_detection",checked:i.enable_jargon_detection??!0,onCheckedChange:g=>h({...i,enable_jargon_detection:g})}),e.jsx(T,{htmlFor:"enable_jargon_detection",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"global_memory",checked:i.global_memory??!1,onCheckedChange:g=>h({...i,global_memory:g})}),e.jsx(T,{htmlFor:"global_memory",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsx(ne,{id:"emoji_chance",type:"number",step:"0.1",min:"0",max:"1",value:n.emoji_chance,onChange:g=>x({...n,emoji_chance:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ne,{id:"max_reg_num",type:"number",min:"1",value:n.max_reg_num,onChange:g=>x({...n,max_reg_num:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ne,{id:"check_interval",type:"number",min:"1",value:n.check_interval,onChange:g=>x({...n,check_interval:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"do_replace",checked:n.do_replace,onCheckedChange:g=>x({...n,do_replace:g})}),e.jsx(T,{htmlFor:"do_replace",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"steal_emoji",checked:n.steal_emoji,onCheckedChange:g=>x({...n,steal_emoji:g})}),e.jsx(T,{htmlFor:"steal_emoji",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"content_filtration",checked:n.content_filtration,onCheckedChange:g=>x({...n,content_filtration:g})}),e.jsx(T,{htmlFor:"content_filtration",className:"cursor-pointer",children:""})]}),n.content_filtration&&e.jsxs("div",{className:"grid gap-2 pl-6 border-l-2 border-primary/20",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ne,{id:"filtration_prompt",value:n.filtration_prompt,onChange:g=>x({...n,filtration_prompt:g.target.value}),placeholder:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})})]})}),g1=zs.memo(function({member:n,groupIndex:i,memberIndex:c,availableChatIds:u,onUpdate:x,onRemove:h}){const f=u.includes(n)||n==="*",[p,g]=m.useState(!f);return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 flex gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx(ne,{value:n,onChange:N=>x(i,c,N.target.value),placeholder:' "*"  "qq:123456:group"',className:"flex-1"}),u.length>0&&e.jsx(S,{size:"sm",variant:"outline",onClick:()=>g(!1),title:"",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{value:n,onValueChange:N=>x(i,c,N),children:[e.jsx($e,{className:"flex-1",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"*",children:"* ()"}),u.map((N,v)=>e.jsx(W,{value:N,children:N},v))]})]}),e.jsx(S,{size:"sm",variant:"outline",onClick:()=>g(!0),title:"",children:""})]})}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',n||"()",'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>h(i,c),children:""})]})]})]})]})}),j1=zs.memo(function({config:n,onChange:i}){const c=()=>{i({...n,learning_list:[...n.learning_list,["","enable","enable","1.0"]]})},u=y=>{i({...n,learning_list:n.learning_list.filter((w,b)=>b!==y)})},x=(y,w,b)=>{const O=[...n.learning_list];O[y][w]=b,i({...n,learning_list:O})},h=({rule:y})=>{const w=`["${y[0]}", "${y[1]}", "${y[2]}", "${y[3]}"]`;return e.jsxs(il,{children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Za,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:w}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},f=()=>{i({...n,expression_groups:[...n.expression_groups,[]]})},p=y=>{i({...n,expression_groups:n.expression_groups.filter((w,b)=>b!==y)})},g=y=>{const w=[...n.expression_groups];w[y]=[...w[y],""],i({...n,expression_groups:w})},N=(y,w)=>{const b=[...n.expression_groups];b[y]=b[y].filter((O,A)=>A!==w),i({...n,expression_groups:b})},v=(y,w,b)=>{const O=[...n.expression_groups];O[y][w]=b,i({...n,expression_groups:O})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(S,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[n.learning_list.map((y,w)=>{const b=n.learning_list.some((C,M)=>M!==w&&C[0]===""),O=y[0]==="",A=y[0].split(":"),_=A[0]||"qq",H=A[1]||"",E=A[2]||"group";return e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",w+1," ",O&&""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{rule:y}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",w+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>u(w),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:O?"global":"specific",onValueChange:C=>{C==="global"?x(w,0,""):x(w,0,"qq::group")},disabled:b&&!O,children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"global",children:""}),e.jsx(W,{value:"specific",disabled:b&&!O,children:""})]})]}),b&&!O&&e.jsx("p",{className:"text-xs text-amber-600",children:""})]}),!O&&e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:_,onValueChange:C=>{x(w,0,`${C}:${H}:${E}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ne,{value:H,onChange:C=>{x(w,0,`${_}:${C.target.value}:${E}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:E,onValueChange:C=>{x(w,0,`${_}:${H}:${C}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"group",children:"group"}),e.jsx(W,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",y[0]||""]})]}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Fe,{checked:y[1]==="enable",onCheckedChange:C=>x(w,1,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Fe,{checked:y[2]==="enable",onCheckedChange:C=>x(w,2,C?"enable":"disable")})]})}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(ne,{type:"number",step:"0.1",min:"0",max:"5",value:y[3],onChange:C=>{const M=parseFloat(C.target.value);isNaN(M)||x(w,3,Math.max(0,Math.min(5,M)).toFixed(1))},className:"w-20 h-8 text-xs"})]}),e.jsx(Sa,{value:[parseFloat(y[3])||1],onValueChange:C=>x(w,3,C[0].toFixed(1)),min:0,max:5,step:.1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0 ()"}),e.jsx("span",{children:"2.5"}),e.jsx("span",{children:"5.0 ()"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" = 300/"})]})]})]},w)}),n.learning_list.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_self_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"expression_self_reflect",checked:n.expression_self_reflect??!1,onCheckedChange:y=>i({...n,expression_self_reflect:y})})]}),n.expression_self_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_interval",children:""}),e.jsx(ne,{id:"expression_auto_check_interval",type:"number",min:"60",value:n.expression_auto_check_interval??3600,onChange:y=>i({...n,expression_auto_check_interval:parseInt(y.target.value)||3600})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 3600 1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_count",children:""}),e.jsx(ne,{id:"expression_auto_check_count",type:"number",min:"1",max:"100",value:n.expression_auto_check_count??10,onChange:y=>i({...n,expression_auto_check_count:parseInt(y.target.value)||10})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 10 "})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(S,{onClick:()=>{i({...n,expression_auto_check_custom_criteria:[...n.expression_auto_check_custom_criteria||[],""]})},size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(n.expression_auto_check_custom_criteria||[]).map((y,w)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:y,onChange:b=>{const O=[...n.expression_auto_check_custom_criteria||[]];O[w]=b.target.value,i({...n,expression_auto_check_custom_criteria:O})},placeholder:"",className:"flex-1"}),e.jsx(S,{onClick:()=>{i({...n,expression_auto_check_custom_criteria:(n.expression_auto_check_custom_criteria||[]).filter((b,O)=>O!==w)})},size:"icon",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})]},w)),(!n.expression_auto_check_custom_criteria||n.expression_auto_check_custom_criteria.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:'""'})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_checked_only",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" checked=True  rejected=False  rejected=True "})]}),e.jsx(Fe,{id:"expression_checked_only",checked:n.expression_checked_only??!1,onCheckedChange:y=>i({...n,expression_checked_only:y})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_manual_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"expression_manual_reflect",checked:n.expression_manual_reflect??!1,onCheckedChange:y=>i({...n,expression_manual_reflect:y})})]}),n.expression_manual_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-sm font-medium",children:""})}),e.jsx("div",{className:"space-y-4",children:(()=>{const w=(n.manual_reflect_operator_id||"").split(":"),b=w[0]||"qq",O=w[1]||"",A=w[2]||"private";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:b,onValueChange:_=>{i({...n,manual_reflect_operator_id:`${_}:${O}:${A}`})},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"/ ID"}),e.jsx(ne,{value:O,onChange:_=>{i({...n,manual_reflect_operator_id:`${b}:${_.target.value}:${A}`})},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:A,onValueChange:_=>{i({...n,manual_reflect_operator_id:`${b}:${O}:${_}`})},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"private",children:"private"}),e.jsx(W,{value:"group",children:"group"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",n.manual_reflect_operator_id||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})})()})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(S,{onClick:()=>{i({...n,allow_reflect:[...n.allow_reflect||[],"qq::group"]})},size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(n.allow_reflect||[]).map((y,w)=>{const b=y.split(":"),O=b[0]||"qq",A=b[1]||"",_=b[2]||"group";return e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-muted/50",children:[e.jsxs(Ie,{value:O,onValueChange:H=>{const E=[...n.allow_reflect];E[w]=`${H}:${A}:${_}`,i({...n,allow_reflect:E})},children:[e.jsx($e,{className:"w-24",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"qq",children:"QQ"}),e.jsx(W,{value:"wx",children:""})]})]}),e.jsx(ne,{value:A,onChange:H=>{const E=[...n.allow_reflect];E[w]=`${O}:${H.target.value}:${_}`,i({...n,allow_reflect:E})},placeholder:"ID",className:"flex-1 font-mono text-sm"}),e.jsxs(Ie,{value:_,onValueChange:H=>{const E=[...n.allow_reflect];E[w]=`${O}:${A}:${H}`,i({...n,allow_reflect:E})},children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"group",children:""}),e.jsx(W,{value:"private",children:""})]})]}),e.jsx(S,{onClick:()=>{i({...n,allow_reflect:n.allow_reflect.filter((H,E)=>E!==w)})},size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})]},w)}),(!n.allow_reflect||n.allow_reflect.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:""})]})]})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(S,{onClick:f,size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[n.expression_groups.map((y,w)=>{const b=n.learning_list.map(O=>O[0]).filter(O=>O!=="");return e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",w+1,y.length===1&&y[0]==="*"&&""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{onClick:()=>g(w),size:"sm",variant:"outline",children:e.jsx(Zs,{className:"h-4 w-4"})}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",w+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>p(w),children:""})]})]})]})]})]}),e.jsx("div",{className:"space-y-2",children:y.map((O,A)=>e.jsx(g1,{member:O,groupIndex:w,memberIndex:A,availableChatIds:b,onUpdate:v,onRemove:N},`${w}-${A}`))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' "*" '})]},w)}),n.expression_groups.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"all_global_jargon",checked:n.all_global_jargon??!1,onCheckedChange:y=>i({...n,all_global_jargon:y})}),e.jsx(T,{htmlFor:"all_global_jargon",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_jargon_explanation",checked:n.enable_jargon_explanation??!0,onCheckedChange:y=>i({...n,enable_jargon_explanation:y})}),e.jsx(T,{htmlFor:"enable_jargon_explanation",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"LLM"})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"jargon_mode",children:""}),e.jsxs(Ie,{value:n.jargon_mode??"context",onValueChange:y=>i({...n,jargon_mode:y}),children:[e.jsx($e,{id:"jargon_mode",className:"mt-2",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"context",children:""}),e.jsx(W,{value:"planner",children:"Plannerunknown_words"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["",e.jsx("br",{}),"PlannerPlannerreplyunknown_words"]})]})]})]})});function v1({regex:l,reaction:n,onRegexChange:i,onReactionChange:c}){const[u,x]=m.useState(!1),[h,f]=m.useState(""),[p,g]=m.useState(null),[N,v]=m.useState(""),[y,w]=m.useState({}),[b,O]=m.useState(""),A=m.useRef(null),[_,H]=m.useState("build"),E=D=>D.replace(/\(\?P<([^>]+)>/g,"(?<$1>"),C=(D,ee=0)=>{const R=A.current;if(!R)return;const me=R.selectionStart||0,ce=R.selectionEnd||0,ve=l.substring(0,me)+D+l.substring(ce);i(ve),setTimeout(()=>{const se=me+D.length+ee;R.setSelectionRange(se,se),R.focus()},0)};m.useEffect(()=>{if(!l||!h){p!==null&&g(null),Object.keys(y).length>0&&w({}),b!==n&&O(n),N!==""&&v("");return}try{const D=E(l),ee=new RegExp(D,"g"),R=h.match(ee);g(R),v("");const ce=new RegExp(D).exec(h);if(ce&&ce.groups){w(ce.groups);let ve=n;Object.entries(ce.groups).forEach(([se,ge])=>{ve=ve.replace(new RegExp(`\\[${se}\\]`,"g"),ge||"")}),O(ve)}else w({}),O(n)}catch(D){v(D.message),g(null),w({}),O(n)}},[l,h,n,p,y,b,N]);const M=()=>{if(!h||!p||p.length===0)return e.jsx("span",{className:"text-muted-foreground",children:h||""});try{const D=E(l),ee=new RegExp(D,"g");let R=0;const me=[];let ce;for(;(ce=ee.exec(h))!==null;)ce.index>R&&me.push(e.jsx("span",{children:h.substring(R,ce.index)},`text-${R}`)),me.push(e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-900 font-semibold",children:ce[0]},`match-${ce.index}`)),R=ce.index+ce[0].length;return R<h.length&&me.push(e.jsx("span",{children:h.substring(R)},`text-${R}`)),e.jsx(e.Fragment,{children:me})}catch{return e.jsx("span",{children:h})}},G=[{category:"",items:[{label:"",pattern:".",desc:""},{label:"",pattern:"\\d",desc:" 0-9"},{label:"",pattern:"\\D",desc:""},{label:"",pattern:"\\w",desc:""},{label:"",pattern:"\\W",desc:""},{label:"",pattern:"\\s",desc:""},{label:"",pattern:"\\S",desc:""}]},{category:"",items:[{label:"",pattern:"^",desc:""},{label:"",pattern:"$",desc:""},{label:"",pattern:"\\b",desc:""}]},{category:"",items:[{label:"0",pattern:"*",desc:"0"},{label:"1",pattern:"+",desc:"1"},{label:"01",pattern:"?",desc:"01"},{label:"",pattern:"{n}",desc:"nn"},{label:"",pattern:"{m,n}",desc:"mn"}]},{category:"",items:[{label:"",pattern:"()",desc:"",moveCursor:-1},{label:"",pattern:"(?P<name>)",desc:"Python",moveCursor:-1},{label:"",pattern:"(?:)",desc:"",moveCursor:-1}]},{category:"",items:[{label:"",pattern:"[]",desc:"",moveCursor:-1},{label:"",pattern:"[^]",desc:"",moveCursor:-1},{label:"",pattern:"[a-z]",desc:"az"},{label:"",pattern:"[\\u4e00-\\u9fa5]",desc:""}]},{category:"",items:[{label:"",pattern:"(?P<word>\\S+)",desc:""},{label:"",pattern:"(?P<sentence>.+)",desc:""},{label:"",pattern:"(?P<num>\\d+)",desc:""},{label:"",pattern:"(?:1|2)",desc:""}]}];return e.jsxs(Ps,{open:u,onOpenChange:x,children:[e.jsx(ed,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",children:[e.jsx(Qm,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Us,{className:"max-w-[95vw] sm:max-w-[900px] max-h-[90vh]",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{className:"text-sm",children:""})]}),e.jsx(Je,{className:"max-h-[calc(90vh-120px)]",children:e.jsxs(ra,{value:_,onValueChange:D=>H(D),className:"w-full",children:[e.jsxs(ea,{className:"grid w-full grid-cols-2",children:[e.jsx(ts,{value:"build",children:" "}),e.jsx(ts,{value:"test",children:" "})]}),e.jsxs(ys,{value:"build",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ne,{ref:A,value:l,onChange:D=>i(D.target.value),className:"font-mono text-sm",placeholder:"..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(at,{value:n,onChange:D=>c(D.target.value),placeholder:" [] ...",rows:3,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[G.map(D=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:D.category}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:D.items.map(ee=>e.jsx(S,{variant:"outline",size:"sm",className:"justify-start h-auto py-2 px-3",onClick:()=>C(ee.pattern,ee.moveCursor||0),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("span",{className:"text-xs font-medium",children:ee.label}),e.jsx("code",{className:"ml-auto text-xs bg-muted px-1.5 py-0.5 rounded font-mono",children:ee.pattern})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:ee.desc})]})},ee.label))})]},D.category)),e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>i("^(?P<n>\\S{1,20})$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:["^(?P<n>\\S","{1,20}",")$"]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(S,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>i("(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(S,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>i("(?P<subject>.+?)(?:||)"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?P<subject>.+?)(?:||)"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})})]})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsxs("li",{children:["",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"(?P<>)"})]}),e.jsxs("li",{children:[" reaction  ",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"[]"})," "]}),e.jsx("li",{children:""})]})]})]}),e.jsxs(ys,{value:"test",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:l||"()"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"test-text",className:"text-sm font-medium",children:""}),e.jsx(at,{id:"test-text",value:h,onChange:D=>f(D.target.value),placeholder:`...
`,className:"min-h-[100px] text-sm"})]}),N&&e.jsxs("div",{className:"rounded-md bg-destructive/10 border border-destructive/20 p-3",children:[e.jsx("p",{className:"text-sm text-destructive font-medium",children:""}),e.jsx("p",{className:"text-xs text-destructive/80 mt-1",children:N})]}),!N&&h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:p&&p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[" (",p.length," )"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:""})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(Je,{className:"h-40 rounded-md bg-muted p-3",children:e.jsx("div",{className:"text-sm break-words",children:M()})})]}),Object.keys(y).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(Je,{className:"h-32 rounded-md border p-3",children:e.jsx("div",{className:"space-y-2",children:Object.entries(y).map(([D,ee])=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsxs("span",{className:"font-mono font-semibold text-primary min-w-[80px]",children:["[",D,"]"]}),e.jsx("span",{className:"text-muted-foreground",children:"="}),e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded",children:ee})]},D))})})]}),Object.keys(y).length>0&&n&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(Je,{className:"h-48 rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3",children:e.jsx("div",{className:"text-sm break-words",children:b})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"reaction  [name] "})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:"Reaction "}),e.jsx("li",{children:""})]})]})]})]})})]})]})}const N1=zs.memo(function({keywordReactionConfig:n,responsePostProcessConfig:i,chineseTypoConfig:c,responseSplitterConfig:u,onKeywordReactionChange:x,onResponsePostProcessChange:h,onChineseTypoChange:f,onResponseSplitterChange:p}){const g=()=>{x({...n,regex_rules:[...n.regex_rules,{regex:[""],reaction:""}]})},N=C=>{x({...n,regex_rules:n.regex_rules.filter((M,G)=>G!==C)})},v=(C,M,G)=>{const D=[...n.regex_rules];M==="regex"&&typeof G=="string"?D[C]={...D[C],regex:[G]}:M==="reaction"&&typeof G=="string"&&(D[C]={...D[C],reaction:G}),x({...n,regex_rules:D})},y=()=>{x({...n,keyword_rules:[...n.keyword_rules,{keywords:[],reaction:""}]})},w=C=>{x({...n,keyword_rules:n.keyword_rules.filter((M,G)=>G!==C)})},b=(C,M,G)=>{const D=[...n.keyword_rules];typeof G=="string"&&(D[C]={...D[C],reaction:G}),x({...n,keyword_rules:D})},O=C=>{const M=[...n.keyword_rules];M[C]={...M[C],keywords:[...M[C].keywords||[],""]},x({...n,keyword_rules:M})},A=(C,M)=>{const G=[...n.keyword_rules];G[C]={...G[C],keywords:(G[C].keywords||[]).filter((D,ee)=>ee!==M)},x({...n,keyword_rules:G})},_=(C,M,G)=>{const D=[...n.keyword_rules],ee=[...D[C].keywords||[]];ee[M]=G,D[C]={...D[C],keywords:ee},x({...n,keyword_rules:D})},H=({rule:C})=>{const M=`{ regex = [${(C.regex||[]).map(G=>`"${G}"`).join(", ")}], reaction = "${C.reaction}" }`;return e.jsxs(il,{children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Za,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Je,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs break-all",children:M})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},E=({rule:C})=>{const M=`[[keyword_reaction.keyword_rules]]
keywords = [${(C.keywords||[]).map(G=>`"${G}"`).join(", ")}]
reaction = "${C.reaction}"`;return e.jsxs(il,{children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Za,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Je,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-all",children:M})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(S,{onClick:g,size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[n.regex_rules.map((C,M)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",M+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v1,{regex:C.regex&&C.regex[0]||"",reaction:C.reaction,onRegexChange:G=>v(M,"regex",G),onReactionChange:G=>v(M,"reaction",G)}),e.jsx(H,{rule:C}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",M+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>N(M),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"Python "}),e.jsx(ne,{value:C.regex&&C.regex[0]||"",onChange:G=>v(M,"regex",G.target.value),placeholder:"^(?P<n>\\\\S{1,20})$ ",className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' (?P<name>pattern) reaction  [name] ""'})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(at,{value:C.reaction,onChange:G=>v(M,"reaction",G.target.value),placeholder:`...
 [] `,rows:3,className:"text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" []  [n] "})]})]})]},M)),n.regex_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(S,{onClick:y,size:"sm",variant:"outline",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[n.keyword_rules.map((C,M)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",M+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{rule:C}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",M+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>w(M),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(S,{onClick:()=>O(M),size:"sm",variant:"ghost",children:[e.jsx(Zs,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(C.keywords||[]).map((G,D)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{value:G,onChange:ee=>_(M,D,ee.target.value),placeholder:"",className:"flex-1"}),e.jsx(S,{onClick:()=>A(M,D),size:"sm",variant:"ghost",children:e.jsx(ns,{className:"h-4 w-4"})})]},D)),(!C.keywords||C.keywords.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-2",children:'""'})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(at,{value:C.reaction,onChange:G=>b(M,"reaction",G.target.value),placeholder:"...",rows:3,className:"text-sm"})]})]})]},M)),n.keyword_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_response_post_process",checked:i.enable_response_post_process,onCheckedChange:C=>h({...i,enable_response_post_process:C})}),e.jsx(T,{htmlFor:"enable_response_post_process",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),i.enable_response_post_process&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Fe,{id:"enable_chinese_typo",checked:c.enable,onCheckedChange:C=>f({...c,enable:C})}),e.jsx(T,{htmlFor:"enable_chinese_typo",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),c.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"error_rate",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"error_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.error_rate,onChange:C=>f({...c,error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"min_freq",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"min_freq",type:"number",min:"0",value:c.min_freq,onChange:C=>f({...c,min_freq:parseInt(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"tone_error_rate",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"tone_error_rate",type:"number",step:"0.01",min:"0",max:"1",value:c.tone_error_rate,onChange:C=>f({...c,tone_error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"word_replace_rate",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"word_replace_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.word_replace_rate,onChange:C=>f({...c,word_replace_rate:parseFloat(C.target.value)})})]})]})]})}),e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Fe,{id:"enable_response_splitter",checked:u.enable,onCheckedChange:C=>p({...u,enable:C})}),e.jsx(T,{htmlFor:"enable_response_splitter",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),u.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_length",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"max_length",type:"number",min:"1",value:u.max_length,onChange:C=>p({...u,max_length:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_sentence_num",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"max_sentence_num",type:"number",min:"1",value:u.max_sentence_num,onChange:C=>p({...u,max_sentence_num:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_kaomoji_protection",checked:u.enable_kaomoji_protection,onCheckedChange:C=>p({...u,enable_kaomoji_protection:C})}),e.jsx(T,{htmlFor:"enable_kaomoji_protection",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_overflow_return_all",checked:u.enable_overflow_return_all,onCheckedChange:C=>p({...u,enable_overflow_return_all:C})}),e.jsx(T,{htmlFor:"enable_overflow_return_all",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})})]})]})]})}),b1=zs.memo(function({config:n,onChange:i}){const[c,u]=m.useState(""),[x,h]=m.useState(""),[f,p]=m.useState(!1),g=n.allowed_ips?n.allowed_ips.split(",").map(_=>_.trim()).filter(_=>_):[],N=n.trusted_proxies?n.trusted_proxies.split(",").map(_=>_.trim()).filter(_=>_):[],v=()=>{if(!c.trim())return;const _=[...g,c.trim()];i({...n,allowed_ips:_.join(",")}),u("")},y=_=>{const H=g.filter((E,C)=>C!==_);i({...n,allowed_ips:H.join(",")})},w=()=>{if(!x.trim())return;const _=[...N,x.trim()];i({...n,trusted_proxies:_.join(",")}),h("")},b=_=>{const H=N.filter((E,C)=>C!==_);i({...n,trusted_proxies:H.join(",")})},O=_=>{!_&&n.enabled?p(!0):i({...n,enabled:_})},A=()=>{i({...n,enabled:!1}),p(!1)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"WebUI "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.enabled,onCheckedChange:O}),e.jsx(T,{className:"cursor-pointer",children:" WebUI"})]}),n.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:n.mode,onValueChange:_=>i({...n,mode:_}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"development",children:""}),e.jsx(W,{value:"production",children:""})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": WebUI  .env  WEBUI_HOST  WEBUI_PORT"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:n.anti_crawler_mode,onValueChange:_=>i({...n,anti_crawler_mode:_}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"false",children:""}),e.jsx(W,{value:"basic",children:""}),e.jsx(W,{value:"loose",children:""}),e.jsx(W,{value:"strict",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:"IP "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:c,onChange:_=>u(_.target.value),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),v())},placeholder:"IP"}),e.jsx(S,{type:"button",size:"sm",onClick:v,disabled:!c.trim(),children:e.jsx(Zs,{className:"h-4 w-4"})})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:g.map((_,H)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[_,e.jsx("button",{type:"button",onClick:()=>y(H),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Ma,{className:"h-3 w-3"})})]},H))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPCIDR127.0.0.1192.168.1.0/24"})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:" IP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:x,onChange:_=>h(_.target.value),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),w())},placeholder:"IP"}),e.jsx(S,{type:"button",size:"sm",onClick:w,disabled:!x.trim(),children:e.jsx(Zs,{className:"h-4 w-4"})})]}),N.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:N.map((_,H)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[_,e.jsx("button",{type:"button",onClick:()=>b(H),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Ma,{className:"h-3 w-3"})})]},H))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPX-Forwarded-For"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.trust_xff,onCheckedChange:_=>i({...n,trust_xff:_})}),e.jsx(T,{className:"cursor-pointer",children:" X-Forwarded-For "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.secure_cookie,onCheckedChange:_=>i({...n,secure_cookie:_})}),e.jsx(T,{className:"cursor-pointer",children:" Cookie HTTPS"})]})]})]}),e.jsx(vs,{open:f,onOpenChange:p,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:" WebUI"}),e.jsxs(hs,{children:[" WebUI WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{variant:"destructive",onClick:A,children:""})]})]})})]})}),gn="/api/webui/config";async function jg(){const n=await(await we(`${gn}/bot`)).json();if(!n.success)throw new Error("");return n.config}async function on(){const n=await(await we(`${gn}/model`)).json();if(!n.success)throw new Error("");return n.config}async function vg(l){const i=await(await we(`${gn}/bot`,{method:"POST",body:JSON.stringify(l)})).json();if(!i.success)throw new Error(i.message||"")}async function y1(){const n=await(await we(`${gn}/bot/raw`)).json();if(!n.success)throw new Error("");return n.content}async function w1(l){const i=await(await we(`${gn}/bot/raw`,{method:"POST",body:JSON.stringify({raw_content:l})})).json();if(!i.success)throw new Error(i.message||"")}async function Yi(l){const i=await(await we(`${gn}/model`,{method:"POST",body:JSON.stringify(l)})).json();if(!i.success)throw new Error(i.message||"")}async function _1(l,n){const c=await(await we(`${gn}/bot/section/${l}`,{method:"POST",body:JSON.stringify(n)})).json();if(!c.success)throw new Error(c.message||` ${l} `)}async function Bm(l,n){const c=await(await we(`${gn}/model/section/${l}`,{method:"POST",body:JSON.stringify(n)})).json();if(!c.success)throw new Error(c.message||` ${l} `)}async function S1(l,n="openai",i="/models"){const c=new URLSearchParams({provider_name:l,parser:n,endpoint:i}),u=await we(`/api/webui/models/list?${c}`);if(!u.ok){const h=await u.json().catch(()=>({}));throw new Error(h.detail||` (${u.status})`)}const x=await u.json();if(!x.success)throw new Error("");return x.models}async function k1(l){const n=new URLSearchParams({provider_name:l}),i=await we(`/api/webui/models/test-connection-by-name?${n}`,{method:"POST"});if(!i.ok){const c=await i.json().catch(()=>({}));throw new Error(c.detail||` (${i.status})`)}return await i.json()}const C1=qr("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),lt=m.forwardRef(({className:l,variant:n,...i},c)=>e.jsx("div",{ref:c,role:"alert",className:P(C1({variant:n}),l),...i}));lt.displayName="Alert";const Bn=m.forwardRef(({className:l,...n},i)=>e.jsx("h5",{ref:i,className:P("mb-1 font-medium leading-none tracking-tight",l),...n}));Bn.displayName="AlertTitle";const nt=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:P("text-sm [&_p]:leading-relaxed",l),...n}));nt.displayName="AlertDescription";const T1={name:"toml",startState:function(){return{inString:!1,stringType:"",lhs:!0,inArray:0}},token:function(l,n){let i;if(!n.inString&&(i=l.match(/^('''|"""|'|")/))&&(n.stringType=i[0],n.inString=!0),l.sol()&&!n.inString&&n.inArray===0&&(n.lhs=!0),n.inString){for(;n.inString;)if(l.match(n.stringType))n.inString=!1;else if(l.peek()==="\\")l.next(),l.next();else{if(l.eol())break;l.match(/^.[^\\\"\']*/)}return n.lhs?"property":"string"}else{if(n.inArray&&l.peek()==="]")return l.next(),n.inArray--,"bracket";if(n.lhs&&l.peek()==="["&&l.skipTo("]"))return l.next(),l.peek()==="]"&&l.next(),"atom";if(l.peek()==="#")return l.skipToEnd(),"comment";if(l.eatSpace())return null;if(n.lhs&&l.eatWhile(function(c){return c!="="&&c!=" "}))return"property";if(n.lhs&&l.peek()==="=")return l.next(),n.lhs=!1,null;if(!n.lhs&&l.match(/^\d\d\d\d[\d\-\:\.T]*Z/))return"atom";if(!n.lhs&&(l.match("true")||l.match("false")))return"atom";if(!n.lhs&&l.peek()==="[")return n.inArray++,l.next(),"bracket";if(!n.lhs&&l.match(/^\-?\d+(?:\.\d+)?/))return"number";l.eatSpace()||l.next()}return null},languageData:{commentTokens:{line:"#"}}},E1={python:[w_()],json:[__(),S_()],toml:[y_.define(T1)],text:[]};function mv({value:l,onChange:n,language:i="text",readOnly:c=!1,height:u="400px",minHeight:x,maxHeight:h,placeholder:f,theme:p="dark",className:g=""}){const[N,v]=m.useState(!1);if(m.useEffect(()=>{v(!0)},[]),!N)return e.jsx("div",{className:`rounded-md border bg-muted animate-pulse ${g}`,style:{height:u,minHeight:x,maxHeight:h}});const y=[...E1[i]||[],cg.lineWrapping];return c&&y.push(cg.editable.of(!1)),e.jsx("div",{className:`rounded-md overflow-hidden border ${g}`,children:e.jsx(k_,{value:l,height:u,minHeight:x,maxHeight:h,theme:p==="dark"?C_:void 0,extensions:y,onChange:n,placeholder:f,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightSpecialChars:!0,history:!0,foldGutter:!0,drawSelection:!0,dropCursor:!0,allowMultipleSelections:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:!0,crosshairCursor:!0,highlightActiveLine:!0,highlightSelectionMatches:!0,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:!0,historyKeymap:!0,foldKeymap:!0,completionKeymap:!0,lintKeymap:!0}})})}function M1({id:l,index:n,itemType:i,itemFields:c,value:u,onChange:x,onRemove:h,disabled:f,canRemove:p,placeholder:g}){const{attributes:N,listeners:v,setNodeRef:y,transform:w,transition:b,isDragging:O}=Yj({id:l,disabled:f}),A={transform:Jj.Transform.toString(w),transition:b};return e.jsxs("div",{ref:y,style:A,className:P("flex items-start gap-2 group",O&&"opacity-50 z-50"),children:[e.jsx("button",{type:"button",className:P("flex-shrink-0 p-2 cursor-grab active:cursor-grabbing","text-muted-foreground hover:text-foreground transition-colors","opacity-0 group-hover:opacity-100 focus:opacity-100",f&&"cursor-not-allowed opacity-30"),...N,...v,children:e.jsx(Aj,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1 min-w-0",children:i==="object"&&c?e.jsx(A1,{value:u,onChange:x,fields:c,disabled:f}):i==="number"?e.jsx(ne,{type:"number",value:u??"",onChange:_=>x(parseFloat(_.target.value)||0),placeholder:g??` ${n+1} `,disabled:f,className:"font-mono"}):e.jsx(ne,{type:"text",value:u??"",onChange:_=>x(_.target.value),placeholder:g??` ${n+1} `,disabled:f})}),e.jsx(S,{type:"button",variant:"ghost",size:"icon",onClick:h,disabled:f||!p,className:P("flex-shrink-0 text-muted-foreground hover:text-destructive","opacity-0 group-hover:opacity-100 focus:opacity-100 transition-opacity"),children:e.jsx(ns,{className:"h-4 w-4"})})]})}function A1({value:l,onChange:n,fields:i,disabled:c}){const u=m.useCallback((h,f)=>{n({...l,[h]:f})},[l,n]),x=(h,f)=>{const p=l?.[h];if(f.type==="boolean"||f.type==="switch")return e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(Fe,{checked:!!(p??f.default),onCheckedChange:g=>u(h,g),disabled:c})]});if(f.type==="slider"||f.type==="number"&&f.min!=null&&f.max!=null){const g=p??f.default??f.min??0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g})]}),e.jsx(Sa,{value:[g],onValueChange:N=>u(h,N[0]),min:f.min??0,max:f.max??100,step:f.step??1,disabled:c,className:"py-1"})]})}return f.type==="select"&&f.choices?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsxs(Ie,{value:String(p??f.default??""),onValueChange:g=>u(h,g),disabled:c,children:[e.jsx($e,{className:"h-8 text-sm",children:e.jsx(Pe,{placeholder:f.placeholder??""})}),e.jsx(Be,{children:f.choices.map(g=>e.jsx(W,{value:String(g),children:String(g)},String(g)))})]})]}):f.type==="number"?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ne,{type:"number",value:p??f.default??"",onChange:g=>u(h,parseFloat(g.target.value)||0),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ne,{type:"text",value:p??f.default??"",onChange:g=>u(h,g.target.value),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]})};return e.jsx(Se,{className:"p-3 space-y-2 bg-muted/30",children:Object.entries(i).map(([h,f])=>e.jsx("div",{children:x(h,f)},h))})}function z1({value:l,onChange:n,itemType:i="string",itemFields:c,minItems:u,maxItems:x,disabled:h,placeholder:f}){const p=m.useMemo(()=>Array.isArray(l)?l:typeof l=="string"&&l.trim()?l.split(",").map(E=>E.trim()):[],[l]),[g]=m.useState(()=>new Map),N=m.useCallback(E=>(g.has(E)||g.set(E,`item-${Date.now()}-${E}-${Math.random().toString(36).slice(2)}`),g.get(E)),[g]),v=m.useMemo(()=>{const E=[];for(let C=0;C<p.length;C++)E.push(N(C));return E},[p.length,N]),y=Pj(Bo(Gj,{activationConstraint:{distance:8}}),Bo(Fj,{coordinateGetter:Hj})),w=m.useCallback(E=>{const{active:C,over:M}=E;if(M&&C.id!==M.id){const G=v.indexOf(C.id),D=v.indexOf(M.id),ee=Vj(p,G,D);n(ee)}},[p,v,n]),b=m.useCallback(()=>{if(x!=null&&p.length>=x)return;let E;i==="object"&&c?E=Object.fromEntries(Object.entries(c).map(([C,M])=>[C,M.default??""])):i==="number"?E=0:E="",n([...p,E])},[p,x,i,c,n]),O=m.useCallback((E,C)=>{const M=[...p];M[E]=C,n(M)},[p,n]),A=m.useCallback(E=>{if(u!=null&&p.length<=u)return;const C=p.filter((M,G)=>G!==E);g.delete(E),n(C)},[p,u,g,n]),_=x==null||p.length<x,H=u==null||p.length>u;return e.jsxs("div",{className:"space-y-2",children:[p.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-4 justify-center border border-dashed rounded-md",children:[e.jsx(St,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}):e.jsx(qj,{sensors:y,collisionDetection:Kj,onDragEnd:w,children:e.jsx(Qj,{items:v,strategy:T_,children:e.jsx("div",{className:"space-y-2",children:p.map((E,C)=>e.jsx(M1,{id:v[C],index:C,itemType:i,itemFields:c,value:E,onChange:M=>O(C,M),onRemove:()=>A(C),disabled:h,canRemove:H,placeholder:f},v[C]))})})}),e.jsxs(S,{type:"button",variant:"outline",size:"sm",onClick:b,disabled:h||!_,className:"w-full",children:[e.jsx(Zs,{className:"h-4 w-4 mr-1"}),"",x!==void 0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",p.length,"/",x,")"]})]}),(u!=null||x!=null)&&(u!==null||x!==null)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:u!=null&&x!=null?` ${u} - ${x} `:u!=null?` ${u} `:` ${x} `})]})}function ex({content:l,className:n=""}){return e.jsx("div",{className:`prose prose-sm dark:prose-invert max-w-none ${n}`,children:e.jsx(D_,{remarkPlugins:[L_,U_],rehypePlugins:[R_],components:{code({inline:i,className:c,children:u,...x}){return i?e.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded text-sm font-mono",...x,children:u}):e.jsx("code",{className:`${c} block bg-muted p-4 rounded-lg overflow-x-auto`,...x,children:u})},table({children:i,...c}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"border-collapse border border-border",...c,children:i})})},th({children:i,...c}){return e.jsx("th",{className:"border border-border bg-muted px-4 py-2 text-left font-semibold",...c,children:i})},td({children:i,...c}){return e.jsx("td",{className:"border border-border px-4 py-2",...c,children:i})},a({children:i,...c}){return e.jsx("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...c,children:i})},blockquote({children:i,...c}){return e.jsx("blockquote",{className:"border-l-4 border-primary pl-4 italic text-muted-foreground",...c,children:i})},h1({children:i,...c}){return e.jsx("h1",{className:"text-3xl font-bold mt-6 mb-4",...c,children:i})},h2({children:i,...c}){return e.jsx("h2",{className:"text-2xl font-bold mt-5 mb-3",...c,children:i})},h3({children:i,...c}){return e.jsx("h3",{className:"text-xl font-bold mt-4 mb-2",...c,children:i})},h4({children:i,...c}){return e.jsx("h4",{className:"text-lg font-semibold mt-3 mb-2",...c,children:i})},ul({children:i,...c}){return e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",...c,children:i})},ol({children:i,...c}){return e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",...c,children:i})},p({children:i,...c}){return e.jsx("p",{className:"my-2 leading-relaxed",...c,children:i})},hr({...i}){return e.jsx("hr",{className:"my-4 border-border",...i})}},children:l})})}function O1(l,n,i,c={}){const{debounceMs:u=2e3,onSaveSuccess:x,onSaveError:h}=c,f=m.useRef(null),p=m.useCallback(async(y,w)=>{try{n(!0),await _1(y,w),i(!1),x?.()}catch(b){console.error(` ${y} :`,b),i(!0),h?.(b instanceof Error?b:new Error(String(b)))}finally{n(!1)}},[n,i,x,h]),g=m.useCallback((y,w)=>{l||(i(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(y,w)},u))},[l,i,p,u]),N=m.useCallback(async(y,w)=>{f.current&&(clearTimeout(f.current),f.current=null),await p(y,w)},[p]),v=m.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);return m.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),{triggerAutoSave:g,saveNow:N,cancelPendingAutoSave:v}}function It(l,n,i,c){m.useEffect(()=>{l&&!i&&c(n,l)},[l])}const D1=500;function R1(){return e.jsx(Kn,{children:e.jsx(L1,{})})}function L1(){const[l,n]=m.useState(!0),[i,c]=m.useState(!1),[u,x]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState("visual"),[N,v]=m.useState(""),[y,w]=m.useState(!1),{toast:b}=st(),{triggerRestart:O,isRestarting:A}=pn(),[_,H]=m.useState(null),[E,C]=m.useState(null),[M,G]=m.useState(null),[D,ee]=m.useState(null),[R,me]=m.useState(null),[ce,ve]=m.useState(null),[se,ge]=m.useState(null),[fe,z]=m.useState(null),[Q,I]=m.useState(null),[L,B]=m.useState(null),[_e,je]=m.useState(null),[Ce,K]=m.useState(null),[U,V]=m.useState(null),[xe,Oe]=m.useState(null),[X,oe]=m.useState(null),[Ge,Y]=m.useState(null),[te,Ue]=m.useState(null),[Le,Ae]=m.useState(null),[de,Te]=m.useState(null),rs=m.useRef(!0),Rt=m.useRef({}),ta=m.useCallback(Ee=>{Rt.current=Ee,H(Ee.bot),C(Ee.personality);const Ns=Ee.chat;Ns.talk_value_rules||(Ns.talk_value_rules=[]),G(Ns),ee(Ee.expression),me(Ee.emoji),ve(Ee.memory),ge(Ee.tool),z(Ee.voice),I(Ee.dream),B(Ee.lpmm_knowledge),je(Ee.keyword_reaction),K(Ee.response_post_process),V(Ee.chinese_typo),Oe(Ee.response_splitter),oe(Ee.log),Y(Ee.debug),Ue(Ee.maim_message),Ae(Ee.telemetry),Te(Ee.webui)},[]),qa=m.useCallback(()=>({...Rt.current,bot:_,personality:E,chat:M,expression:D,emoji:R,memory:ce,tool:se,voice:fe,dream:Q,lpmm_knowledge:L,keyword_reaction:_e,response_post_process:Ce,chinese_typo:U,response_splitter:xe,log:X,debug:Ge,maim_message:te,telemetry:Le,webui:de}),[_,E,M,D,R,ce,se,fe,Q,L,_e,Ce,U,xe,X,Ge,te,Le,de]),Ht=m.useCallback(async()=>{try{const Ns=(await y1()).replace(/"([^"]*)"/g,(ls,es)=>`"${es.replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\"/g,'"').replace(/\\\\/g,"\\")}"`);v(Ns),w(!1)}catch(Ee){b({variant:"destructive",title:"",description:Ee instanceof Error?Ee.message:""})}},[b]),ut=m.useCallback(async()=>{try{n(!0);const Ee=await jg();ta(Ee),f(!1),rs.current=!1,await Ht()}catch(Ee){console.error(":",Ee),b({title:"",description:"",variant:"destructive"})}finally{n(!1)}},[b,Ht,ta]);m.useEffect(()=>{ut()},[ut]);const{triggerAutoSave:q,cancelPendingAutoSave:qe}=O1(rs.current,x,f);It(_,"bot",rs.current,q),It(E,"personality",rs.current,q),It(M,"chat",rs.current,q),It(D,"expression",rs.current,q),It(R,"emoji",rs.current,q),It(ce,"memory",rs.current,q),It(se,"tool",rs.current,q),It(fe,"voice",rs.current,q),It(L,"lpmm_knowledge",rs.current,q),It(_e,"keyword_reaction",rs.current,q),It(Ce,"response_post_process",rs.current,q),It(U,"chinese_typo",rs.current,q),It(xe,"response_splitter",rs.current,q),It(X,"log",rs.current,q),It(Ge,"debug",rs.current,q),It(te,"maim_message",rs.current,q),It(Le,"telemetry",rs.current,q),It(de,"webui",rs.current,q);const Qe=async()=>{try{c(!0);const Ee=N.replace(/"([^"]*)"/g,(Ns,ls)=>`"${ls.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}"`);await w1(Ee),f(!1),w(!1),b({title:"",description:""}),await ut()}catch(Ee){w(!0),b({variant:"destructive",title:"",description:Ee instanceof Error?Ee.message:""})}finally{c(!1)}},We=async Ee=>{if(h){b({variant:"destructive",title:"",description:""});return}if(g(Ee),Ee==="source")await Ht();else try{const Ns=await jg();ta(Ns),f(!1)}catch(Ns){console.error(":",Ns),b({title:"",description:"",variant:"destructive"})}},Os=async()=>{try{c(!0),qe(),await vg(qa()),f(!1),b({title:"",description:""})}catch(Ee){console.error(":",Ee),b({title:"",description:Ee.message,variant:"destructive"})}finally{c(!1)}},as=async()=>{await O()},Cs=async()=>{try{c(!0),qe(),await vg(qa()),f(!1),b({title:"",description:"..."}),await new Promise(Ee=>setTimeout(Ee,D1)),await as()}catch(Ee){console.error(":",Ee),b({title:"",description:Ee.message,variant:"destructive"})}finally{c(!1)}};return l?e.jsx(Je,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs sm:text-sm",children:""})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(S,{onClick:p==="visual"?Os:Qe,disabled:i||u||!h||A,size:"sm",variant:"outline",className:"w-20 sm:w-24",children:[e.jsx(oc,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:i?"":u?"":h?"":""})]}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{disabled:i||u||A,size:"sm",className:"w-20 sm:w-28",children:[e.jsx(cc,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:A?"":h?"":""})]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:h?",":","})})})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:h?Cs:as,children:h?"":""})]})]})]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(ra,{value:p,onValueChange:Ee=>We(Ee),className:"w-full",children:e.jsxs(ea,{className:"h-8 sm:h-9 w-full grid grid-cols-2",children:[e.jsxs(ts,{value:"visual",className:"text-xs sm:text-sm",children:[e.jsx(zj,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]}),e.jsxs(ts,{value:"source",className:"text-xs sm:text-sm",children:[e.jsx(Oj,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]})]})})})]}),e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs(nt,{children:["",e.jsx("strong",{children:""}),'""']})]}),p==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs(nt,{children:[e.jsx("strong",{children:""})," TOML  TOML ",y&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(mv,{value:N,onChange:Ee=>{v(Ee),f(!0),y&&w(!1)},language:"toml",theme:"dark",height:"calc(100vh - 280px)",minHeight:"500px",placeholder:"TOML "})]}),p==="visual"&&e.jsx(e.Fragment,{children:e.jsxs(ra,{defaultValue:"bot",className:"w-full",children:[e.jsxs(ea,{className:"flex flex-wrap h-auto gap-1 p-1 sm:grid sm:grid-cols-5 lg:grid-cols-10",children:[e.jsx(ts,{value:"bot",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"personality",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"chat",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"expression",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"features",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"processing",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"dream",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"lpmm",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"webui",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:"WebUI"}),e.jsx(ts,{value:"other",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""})]}),e.jsx(ys,{value:"bot",className:"space-y-4",children:_&&e.jsx(a1,{config:_,onChange:H})}),e.jsx(ys,{value:"personality",className:"space-y-4",children:E&&e.jsx(l1,{config:E,onChange:C})}),e.jsx(ys,{value:"chat",className:"space-y-4",children:M&&e.jsx(o1,{config:M,onChange:G})}),e.jsx(ys,{value:"expression",className:"space-y-4",children:D&&e.jsx(j1,{config:D,onChange:ee})}),e.jsx(ys,{value:"features",className:"space-y-4",children:R&&ce&&se&&fe&&e.jsx(p1,{emojiConfig:R,memoryConfig:ce,toolConfig:se,voiceConfig:fe,onEmojiChange:me,onMemoryChange:ve,onToolChange:ge,onVoiceChange:z})}),e.jsx(ys,{value:"processing",className:"space-y-4",children:_e&&Ce&&U&&xe&&e.jsx(N1,{keywordReactionConfig:_e,responsePostProcessConfig:Ce,chineseTypoConfig:U,responseSplitterConfig:xe,onKeywordReactionChange:je,onResponsePostProcessChange:K,onChineseTypoChange:V,onResponseSplitterChange:Oe})}),e.jsx(ys,{value:"dream",className:"space-y-4",children:Q&&e.jsx(d1,{config:Q,onChange:I})}),e.jsx(ys,{value:"lpmm",className:"space-y-4",children:L&&e.jsx(u1,{config:L,onChange:B})}),e.jsx(ys,{value:"webui",className:"space-y-4",children:de&&e.jsx(b1,{config:de,onChange:Te})}),e.jsxs(ys,{value:"other",className:"space-y-4",children:[X&&e.jsx(m1,{config:X,onChange:oe}),Ge&&e.jsx(x1,{config:Ge,onChange:Y}),te&&e.jsx(h1,{config:te,onChange:Ue}),Le&&e.jsx(f1,{config:Le,onChange:Ae})]})]})}),e.jsx(Qn,{})]})})}const Ol=m.forwardRef(({className:l,...n},i)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:i,className:P("w-full caption-bottom text-sm",l),...n})}));Ol.displayName="Table";const Dl=m.forwardRef(({className:l,...n},i)=>e.jsx("thead",{ref:i,className:P("[&_tr]:border-b",l),...n}));Dl.displayName="TableHeader";const Rl=m.forwardRef(({className:l,...n},i)=>e.jsx("tbody",{ref:i,className:P("[&_tr:last-child]:border-0",l),...n}));Rl.displayName="TableBody";const U1=m.forwardRef(({className:l,...n},i)=>e.jsx("tfoot",{ref:i,className:P("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...n}));U1.displayName="TableFooter";const dt=m.forwardRef(({className:l,...n},i)=>e.jsx("tr",{ref:i,className:P("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...n}));dt.displayName="TableRow";const Ze=m.forwardRef(({className:l,...n},i)=>e.jsx("th",{ref:i,className:P("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...n}));Ze.displayName="TableHead";const Ke=m.forwardRef(({className:l,...n},i)=>e.jsx("td",{ref:i,className:P("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...n}));Ke.displayName="TableCell";const $1=m.forwardRef(({className:l,...n},i)=>e.jsx("caption",{ref:i,className:P("mt-4 text-sm text-muted-foreground",l),...n}));$1.displayName="TableCaption";const sd=m.forwardRef(({className:l,...n},i)=>e.jsx(pa,{ref:i,className:P("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",l),...n}));sd.displayName=pa.displayName;const td=m.forwardRef(({className:l,...n},i)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Dt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(pa.Input,{ref:i,className:P("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",l),...n})]}));td.displayName=pa.Input.displayName;const ad=m.forwardRef(({className:l,...n},i)=>e.jsx(pa.List,{ref:i,className:P("max-h-[300px] overflow-y-auto overflow-x-hidden",l),...n}));ad.displayName=pa.List.displayName;const ld=m.forwardRef((l,n)=>e.jsx(pa.Empty,{ref:n,className:"py-6 text-center text-sm",...l}));ld.displayName=pa.Empty.displayName;const ac=m.forwardRef(({className:l,...n},i)=>e.jsx(pa.Group,{ref:i,className:P("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",l),...n}));ac.displayName=pa.Group.displayName;const B1=m.forwardRef(({className:l,...n},i)=>e.jsx(pa.Separator,{ref:i,className:P("-mx-1 h-px bg-border",l),...n}));B1.displayName=pa.Separator.displayName;const lc=m.forwardRef(({className:l,...n},i)=>e.jsx(pa.Item,{ref:i,className:P("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l),...n}));lc.displayName=pa.Item.displayName;const Ws=m.forwardRef(({className:l,...n},i)=>e.jsx(Nj,{ref:i,className:P("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",l),...n,children:e.jsx(Ew,{className:P("grid place-content-center text-current"),children:e.jsx(_t,{className:"h-4 w-4"})})}));Ws.displayName=Nj.displayName;const xv=m.createContext(null),hv="maibot-completed-tours";function I1(){try{const l=localStorage.getItem(hv);return l?new Set(JSON.parse(l)):new Set}catch{return new Set}}function Ng(l){localStorage.setItem(hv,JSON.stringify([...l]))}function P1({children:l}){const[n,i]=m.useState({activeTourId:null,stepIndex:0,isRunning:!1}),[c]=m.useState(()=>new Map),[u,x]=m.useState(I1),[,h]=m.useState(0),f=m.useCallback((E,C)=>{c.set(E,C),h(M=>M+1)},[c]),p=m.useCallback(E=>{c.delete(E),i(C=>C.activeTourId===E?{...C,activeTourId:null,isRunning:!1,stepIndex:0}:C)},[c]),g=m.useCallback((E,C=0)=>{c.has(E)&&i({activeTourId:E,stepIndex:C,isRunning:!0})},[c]),N=m.useCallback(()=>{i(E=>({...E,isRunning:!1}))},[]),v=m.useCallback(E=>{i(C=>({...C,stepIndex:E}))},[]),y=m.useCallback(()=>{i(E=>({...E,stepIndex:E.stepIndex+1}))},[]),w=m.useCallback(()=>{i(E=>({...E,stepIndex:Math.max(0,E.stepIndex-1)}))},[]),b=m.useCallback(()=>n.activeTourId?c.get(n.activeTourId)||[]:[],[n.activeTourId,c]),O=m.useCallback(E=>{x(C=>{const M=new Set(C);return M.add(E),Ng(M),M})},[]),A=m.useCallback(E=>{const{action:C,index:M,status:G,type:D}=E,ee=["finished","skipped"];if(C==="close"){i(R=>({...R,isRunning:!1,stepIndex:0}));return}ee.includes(G)?i(R=>(G==="finished"&&R.activeTourId&&setTimeout(()=>O(R.activeTourId),0),{...R,isRunning:!1,stepIndex:0})):D==="step:after"&&(C==="next"?i(R=>({...R,stepIndex:M+1})):C==="prev"&&i(R=>({...R,stepIndex:M-1})))},[O]),_=m.useCallback(E=>u.has(E),[u]),H=m.useCallback(E=>{x(C=>{const M=new Set(C);return M.delete(E),Ng(M),M})},[]);return e.jsx(xv.Provider,{value:{state:n,tours:c,registerTour:f,unregisterTour:p,startTour:g,stopTour:N,goToStep:v,nextStep:y,prevStep:w,getCurrentSteps:b,handleJoyrideCallback:A,isTourCompleted:_,markTourCompleted:O,resetTourCompleted:H},children:l})}function sx(){const l=m.useContext(xv);if(!l)throw new Error("useTour must be used within a TourProvider");return l}const H1={options:{zIndex:1e4,primaryColor:"hsl(var(--primary))",textColor:"hsl(var(--foreground))",backgroundColor:"hsl(var(--background))",arrowColor:"hsl(var(--background))",overlayColor:"rgba(0, 0, 0, 0.5)"},tooltip:{borderRadius:"var(--radius)",padding:"1rem"},tooltipContainer:{textAlign:"left"},tooltipTitle:{fontSize:"1rem",fontWeight:600,marginBottom:"0.5rem"},tooltipContent:{fontSize:"0.875rem",padding:"0.5rem 0"},buttonNext:{backgroundColor:"hsl(var(--primary))",color:"hsl(var(--primary-foreground))",borderRadius:"calc(var(--radius) - 2px)",fontSize:"0.875rem",padding:"0.5rem 1rem"},buttonBack:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem",marginRight:"0.5rem"},buttonSkip:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem"},buttonClose:{color:"hsl(var(--muted-foreground))"},spotlight:{borderRadius:"var(--radius)"}},F1={back:"",close:"",last:"",next:"",nextLabelWithProgress:" ({step}/{steps})",open:"",skip:""};function G1(){const{state:l,getCurrentSteps:n,handleJoyrideCallback:i}=sx(),c=n(),[u,x]=m.useState(!1),h=m.useRef(l.stepIndex),f=m.useRef(null);m.useEffect(()=>{h.current!==l.stepIndex&&(x(!1),h.current=l.stepIndex)},[l.stepIndex]),m.useEffect(()=>{if(!l.isRunning||c.length===0){x(!1);return}const v=c[l.stepIndex];if(!v){x(!1);return}const y=v.target;if(y==="body"){x(!0);return}x(!1);const w=setTimeout(()=>{const b=()=>{const H=document.querySelector(y);if(H){const E=H.getBoundingClientRect();if(E.width>0&&E.height>0)return!0}return!1};if(b()){setTimeout(()=>x(!0),100);return}const O=setInterval(()=>{b()&&(clearInterval(O),setTimeout(()=>x(!0),100))},100),A=setTimeout(()=>{clearInterval(O),x(!0)},5e3),_=()=>{clearInterval(O),clearTimeout(A)};f.current=_},150);return()=>{clearTimeout(w),f.current&&(f.current(),f.current=null)}},[l.isRunning,l.stepIndex,c]);const[p,g]=m.useState(null);if(m.useEffect(()=>{let v=document.getElementById("tour-portal-container");return v||(v=document.createElement("div"),v.id="tour-portal-container",v.style.cssText="position: fixed; top: 0; left: 0; z-index: 99999; pointer-events: none;",document.body.appendChild(v)),g(v),()=>{}},[]),!l.isRunning||c.length===0||!u)return null;const N=e.jsx(M_,{steps:c,stepIndex:l.stepIndex,run:l.isRunning,continuous:!0,showSkipButton:!0,showProgress:!0,disableOverlayClose:!0,disableScrolling:!1,disableScrollParentFix:!1,callback:i,styles:H1,locale:F1,scrollOffset:80,scrollToFirstStep:!0,floaterProps:{styles:{floater:{zIndex:99999}},disableAnimation:!0}},`tour-step-${l.stepIndex}`);return p?f0.createPortal(N,p):N}const nl="model-assignment-tour",fv=[{target:"body",content:"",placement:"center",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="sidebar-model-provider"]',content:' DeepSeek Siliconflow""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-provider-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="provider-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-apikey-input"]',content:" API  API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-url-input"]',content:" API API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-template-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="sidebar-model-management"]',content:'""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-model-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="model-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-provider-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-identifier-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="tasks-tab-trigger"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="task-model-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1}],pv={0:"/config/model",1:"/config/model",2:"/config/modelProvider",3:"/config/modelProvider",4:"/config/modelProvider",5:"/config/modelProvider",6:"/config/modelProvider",7:"/config/modelProvider",8:"/config/modelProvider",9:"/config/modelProvider",10:"/config/modelProvider",11:"/config/model",12:"/config/model",13:"/config/model",14:"/config/model",15:"/config/model",16:"/config/model",17:"/config/model",18:"/config/model",19:"/config/model"},Gi=[{id:"siliconflow",name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",client_type:"openai",display_name:" (SiliconFlow)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"deepseek",name:"DeepSeek",base_url:"https://api.deepseek.com",client_type:"openai",display_name:"DeepSeek",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"rinkoai",name:"RinkoAI",base_url:"https://rinkoai.com/v1",client_type:"openai",display_name:"RinkoAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"zhipu",name:"ZhipuAI",base_url:"https://open.bigmodel.cn/api/paas/v4",client_type:"openai",display_name:" AI (ZhipuAI / GLM)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"moonshot",name:"Moonshot",base_url:"https://api.moonshot.cn/v1",client_type:"openai",display_name:" (Moonshot / Kimi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"doubao",name:"Doubao",base_url:"https://ark.cn-beijing.volces.com/api/v3",client_type:"openai",display_name:" (Doubao)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"alibaba",name:"Alibaba",base_url:"https://dashscope.aliyuncs.com/compatible-mode/v1",client_type:"openai",display_name:" (Alibaba Qwen)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"baichuan",name:"Baichuan",base_url:"https://api.baichuan-ai.com/v1",client_type:"openai",display_name:" (Baichuan)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"minimax",name:"MiniMax",base_url:"https://api.minimax.chat/v1",client_type:"openai",display_name:"MiniMax ( AI)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"stepfun",name:"StepFun",base_url:"https://api.stepfun.com/v1",client_type:"openai",display_name:" (StepFun)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"lingyi",name:"Lingyi",base_url:"https://api.lingyiwanwu.com/v1",client_type:"openai",display_name:" (Lingyi / Yi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"openai",name:"OpenAI",base_url:"https://api.openai.com/v1",client_type:"openai",display_name:"OpenAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"xai",name:"xAI",base_url:"https://api.x.ai/v1",client_type:"openai",display_name:"xAI (Grok)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"anthropic",name:"Anthropic",base_url:"https://api.anthropic.com/v1",client_type:"openai",display_name:"Anthropic (Claude)"},{id:"gemini",name:"Gemini",base_url:"https://generativelanguage.googleapis.com/v1beta",client_type:"gemini",display_name:"Google Gemini",modelFetcher:{endpoint:"/models",parser:"gemini"}},{id:"cohere",name:"Cohere",base_url:"https://api.cohere.ai/v1",client_type:"openai",display_name:"Cohere"},{id:"groq",name:"Groq",base_url:"https://api.groq.com/openai/v1",client_type:"openai",display_name:"Groq",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"together",name:"Together AI",base_url:"https://api.together.xyz/v1",client_type:"openai",display_name:"Together AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"fireworks",name:"Fireworks",base_url:"https://api.fireworks.ai/inference/v1",client_type:"openai",display_name:"Fireworks AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"mistral",name:"Mistral",base_url:"https://api.mistral.ai/v1",client_type:"openai",display_name:"Mistral AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"perplexity",name:"Perplexity",base_url:"https://api.perplexity.ai",client_type:"openai",display_name:"Perplexity AI"},{id:"custom",name:"",base_url:"",client_type:"openai",display_name:""}];function bg(l){return l?l.replace(/\/+$/,"").toLowerCase():""}function V1(l){if(!l)return null;const n=bg(l);return Gi.find(i=>i.id!=="custom"&&bg(i.base_url)===n)||null}const Co=l=>({...l,max_retry:l.max_retry??2,timeout:l.timeout??30,retry_interval:l.retry_interval??10}),q1=l=>{const n={};return l?(l.name?.trim()||(n.name=""),l.base_url?.trim()||(n.base_url=" URL"),l.api_key?.trim()||(n.api_key=" API Key"),{isValid:Object.keys(n).length===0,errors:n}):{isValid:!1,errors:{name:""}}};function K1(){return e.jsx(Kn,{children:e.jsx(Q1,{})})}function Q1(){const[l,n]=m.useState([]),[i,c]=m.useState(!0),[u,x]=m.useState(!1),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[N,v]=m.useState(!1),[y,w]=m.useState(null),[b,O]=m.useState(null),[A,_]=m.useState("custom"),[H,E]=m.useState(!1),[C,M]=m.useState(!1),[G,D]=m.useState(null),[ee,R]=m.useState(!1),[me,ce]=m.useState(""),[ve,se]=m.useState(new Set),[ge,fe]=m.useState(!1),[z,Q]=m.useState(1),[I,L]=m.useState(20),[B,_e]=m.useState(""),[je,Ce]=m.useState({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),[K,U]=m.useState({}),[V,xe]=m.useState(new Set),[Oe,X]=m.useState(new Map),{toast:oe}=st(),Ge=ia(),{state:Y,goToStep:te,registerTour:Ue}=sx(),{triggerRestart:Le,isRestarting:Ae}=pn(),de=m.useRef(null),Te=m.useRef(!0);m.useEffect(()=>{Ue(nl,fv)},[Ue]),m.useEffect(()=>{if(Y.activeTourId===nl&&Y.isRunning){const Z=pv[Y.stepIndex];Z&&!window.location.pathname.endsWith(Z.replace("/config/",""))&&Ge({to:Z})}},[Y.stepIndex,Y.activeTourId,Y.isRunning,Ge]);const rs=m.useRef(Y.stepIndex);m.useEffect(()=>{if(Y.activeTourId===nl&&Y.isRunning){const Z=rs.current,ye=Y.stepIndex;Z>=3&&Z<=9&&ye<3&&v(!1),Z>=10&&ye>=3&&ye<=9&&(U({}),_("custom"),w({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10}),O(null),R(!1),v(!0)),rs.current=ye}},[Y.stepIndex,Y.activeTourId,Y.isRunning]),m.useEffect(()=>{if(Y.activeTourId!==nl||!Y.isRunning)return;const Z=ye=>{const De=ye.target,Hs=Y.stepIndex;Hs===2&&De.closest('[data-tour="add-provider-button"]')?setTimeout(()=>te(3),300):Hs===9&&De.closest('[data-tour="provider-cancel-button"]')&&setTimeout(()=>te(10),300)};return document.addEventListener("click",Z,!0),()=>document.removeEventListener("click",Z,!0)},[Y,te]),m.useEffect(()=>{Rt()},[]);const Rt=async()=>{try{c(!0);const Z=await on();n(Z.api_providers||[]),g(!1),Te.current=!1}catch(Z){console.error(":",Z)}finally{c(!1)}},ta=async()=>{await Le()},qa=async()=>{try{x(!0),de.current&&clearTimeout(de.current);const Z=l.map(it=>({...it,max_retry:it.max_retry??2,timeout:it.timeout??30,retry_interval:it.retry_interval??10})),{shouldProceed:ye}=await Ht(Z,"restart");if(!ye){x(!1);return}const De=await on(),Hs=new Set(Z.map(it=>it.name)),Jt=(De.models||[]).filter(it=>Hs.has(it.api_provider));De.api_providers=Z,De.models=Jt,await Yi(De),g(!1),oe({title:"",description:"..."}),await ta()}catch(Z){console.error(":",Z),oe({title:"",description:Z.message,variant:"destructive"}),x(!1)}},Ht=m.useCallback(async(Z,ye="auto")=>{try{const De=await on(),Hs=new Set(l.map(mt=>mt.name)),zt=new Set(Z.map(mt=>mt.name)),Jt=Array.from(Hs).filter(mt=>!zt.has(mt));if(Jt.length===0)return{shouldProceed:!0,providers:Z};const Xt=(De.models||[]).filter(mt=>Jt.includes(mt.api_provider));return Xt.length===0?{shouldProceed:!0,providers:Z}:(Ce({isOpen:!0,providersToDelete:Jt,affectedModels:Xt,pendingProviders:Z,context:ye,oldProviders:[...l]}),{shouldProceed:!1,providers:Z})}catch(De){return console.error(":",De),{shouldProceed:!0,providers:Z}}},[l]),ut=async()=>{try{(je.context==="auto"?f:x)(!0),Ce(mt=>({...mt,isOpen:!1}));const ye=await on(),De=je.pendingProviders.map(Co),Hs=new Set(De.map(mt=>mt.name)),Jt=(ye.models||[]).filter(mt=>Hs.has(mt.api_provider)),it=new Set(je.affectedModels.map(mt=>mt.name)),Xt=ye.model_task_config;Xt&&Object.keys(Xt).forEach(mt=>{const re=Xt[mt];re&&Array.isArray(re.model_list)&&(re.model_list=re.model_list.filter(he=>!it.has(he)))}),ye.api_providers=De,ye.models=Jt,ye.model_task_config=Xt,await Yi(ye),n(je.pendingProviders),g(!1),oe({title:"",description:` ${je.providersToDelete.length}  ${je.affectedModels.length} `}),Ce({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),se(new Set),je.context==="restart"&&await ta()}catch(Z){console.error(":",Z),oe({title:"",description:Z.message,variant:"destructive"})}finally{je.context==="auto"?f(!1):x(!1)}},q=()=>{je.oldProviders.length>0&&n(je.oldProviders),Ce({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),g(!1)},qe=m.useCallback(async Z=>{if(Te.current)return;const{shouldProceed:ye}=await Ht(Z,"auto");if(!ye){g(!0);return}try{f(!0);const De=Z.map(Co);await Bm("api_providers",De),g(!1)}catch(De){console.error(":",De),oe({title:"",description:De.message,variant:"destructive"}),g(!0)}finally{f(!1)}},[l,Ht]);m.useEffect(()=>{if(!Te.current)return g(!0),de.current&&clearTimeout(de.current),de.current=setTimeout(()=>{qe(l)},2e3),()=>{de.current&&clearTimeout(de.current)}},[l,qe]);const Qe=async()=>{try{x(!0),de.current&&clearTimeout(de.current);const Z=l.map(Co),{shouldProceed:ye}=await Ht(Z,"manual");if(!ye){x(!1);return}const De=await on(),Hs=new Set(Z.map(it=>it.name)),zt=De.models||[],Jt=zt.filter(it=>{const Xt=Hs.has(it.api_provider);return Xt||console.warn(` "${it.name}"  "${it.api_provider}"`),Xt});if(zt.length!==Jt.length){const it=zt.length-Jt.length;oe({title:"",description:` ${it} `,variant:"default"})}console.log(" providers :",Z),De.api_providers=Z,De.models=Jt,console.log(":",De),await Yi(De),g(!1),oe({title:"",description:""})}catch(Z){console.error(":",Z),oe({title:"",description:Z.message,variant:"destructive"})}finally{x(!1)}},We=(Z,ye)=>{if(U({}),Z){const De=Gi.find(Hs=>Hs.base_url===Z.base_url&&Hs.client_type===Z.client_type);_(De?.id||"custom"),w(Z)}else _("custom"),w({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10});O(ye),R(!1),v(!0)},Os=m.useCallback(Z=>{_(Z),E(!1);const ye=Gi.find(De=>De.id===Z);ye&&ye.id!=="custom"?w(De=>({...De,name:ye.name,base_url:ye.base_url,client_type:ye.client_type})):ye?.id==="custom"&&w(De=>({...De,name:"",base_url:"",client_type:"openai"}))},[]),as=m.useMemo(()=>A!=="custom",[A]),Cs=m.useCallback(async()=>{if(y?.api_key)try{await navigator.clipboard.writeText(y.api_key),oe({title:"",description:"API Key "})}catch{oe({title:"",description:"",variant:"destructive"})}},[y?.api_key,oe]),Ee=()=>{if(!y)return;const{isValid:Z,errors:ye}=q1(y);if(!Z){U(ye);return}U({});const De=Co(y);if(b!==null){const Hs=[...l];Hs[b]=De,n(Hs)}else n([...l,De]);v(!1),w(null),O(null)},Ns=Z=>{if(!Z&&y){const ye={...y,max_retry:y.max_retry??2,timeout:y.timeout??30,retry_interval:y.retry_interval??10};w(ye)}v(Z)},ls=Z=>{D(Z),M(!0)},es=async()=>{if(G!==null){const Z=l.filter((De,Hs)=>Hs!==G),{shouldProceed:ye}=await Ht(Z,"manual");ye&&(n(Z),oe({title:"",description:""}))}M(!1),D(null)},bs=Z=>{const ye=new Set(ve);ye.has(Z)?ye.delete(Z):ye.add(Z),se(ye)},pt=()=>{if(ve.size===Ms.length)se(new Set);else{const Z=Ms.map((ye,De)=>l.findIndex(Hs=>Hs===Ms[De]));se(new Set(Z))}},Lt=()=>{if(ve.size===0){oe({title:"",description:"",variant:"default"});return}fe(!0)},tt=async()=>{const Z=l.filter((De,Hs)=>!ve.has(Hs)),{shouldProceed:ye}=await Ht(Z,"manual");ye&&(n(Z),se(new Set),oe({title:"",description:` ${ve.size} `})),fe(!1)},Ms=m.useMemo(()=>{if(!me)return l;const Z=me.toLowerCase();return l.filter(ye=>ye.name.toLowerCase().includes(Z)||ye.base_url.toLowerCase().includes(Z)||ye.client_type.toLowerCase().includes(Z))},[l,me]),{totalPages:kt,paginatedProviders:Ut}=m.useMemo(()=>{const Z=Math.ceil(Ms.length/I),ye=Ms.slice((z-1)*I,z*I);return{totalPages:Z,paginatedProviders:ye}},[Ms,z,I]),za=m.useCallback(()=>{const Z=parseInt(B);Z>=1&&Z<=kt&&(Q(Z),_e(""))},[B,kt]),el=async Z=>{xe(ye=>new Set(ye).add(Z));try{const ye=await k1(Z);X(De=>new Map(De).set(Z,ye)),ye.network_ok?ye.api_key_valid===!0?oe({title:"",description:`${Z} API Key  (${ye.latency_ms}ms)`}):ye.api_key_valid===!1?oe({title:" Key ",description:`${Z}  API Key `,variant:"destructive"}):oe({title:"",description:`${Z}  (${ye.latency_ms}ms)`}):oe({title:"",description:ye.error||"",variant:"destructive"})}catch(ye){oe({title:"",description:ye.message,variant:"destructive"})}finally{xe(ye=>{const De=new Set(ye);return De.delete(Z),De})}},ol=async()=>{for(const Z of l)await el(Z.name)},Yn=Z=>{const ye=V.has(Z),De=Oe.get(Z);return ye?e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[e.jsx(Ls,{className:"h-3 w-3 animate-spin"}),""]}):De?De.network_ok?De.api_key_valid===!0?e.jsxs(ke,{className:"gap-1 bg-green-600 hover:bg-green-700",children:[e.jsx(Wt,{className:"h-3 w-3"}),""]}):De.api_key_valid===!1?e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(St,{className:"h-3 w-3"}),"Key"]}):e.jsxs(ke,{className:"gap-1 bg-blue-600 hover:bg-blue-700",children:[e.jsx(Wt,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(Wi,{className:"h-3 w-3"}),""]}):null};return i?e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"AI"}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" AI  API "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[ve.size>0&&e.jsxs(S,{onClick:Lt,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ns,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",ve.size,")"]}),e.jsxs(S,{onClick:ol,size:"sm",variant:"outline",className:"w-full sm:w-auto",disabled:l.length===0||V.size>0,children:[e.jsx(Xa,{className:"mr-2 h-4 w-4"}),V.size>0?` (${V.size})`:""]}),e.jsxs(S,{onClick:()=>We(null,null),size:"sm",className:"w-full sm:w-auto","data-tour":"add-provider-button",children:[e.jsx(Zs,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]}),e.jsxs(S,{onClick:Qe,disabled:u||h||!p||Ae,size:"sm",variant:"outline",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(oc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),u?"...":h?"...":p?"":""]}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{disabled:u||h||Ae,size:"sm",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(cc,{className:"mr-2 h-4 w-4"}),Ae?"...":p?"":""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:p?",":","})})})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:p?qa:ta,children:p?"":""})]})]})]})]})]}),e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs(nt,{children:["",e.jsx("strong",{children:""}),'""']})]}),e.jsxs(Je,{className:"h-[calc(100vh-260px)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"URL ...",value:me,onChange:Z=>ce(Z.target.value),className:"pl-9"})]}),me&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Ms.length," "]})]}),e.jsx("div",{className:"md:hidden space-y-3",children:Ms.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8 rounded-lg border bg-card",children:me?"":'""'}):Ut.map((Z,ye)=>{const De=l.findIndex(Hs=>Hs===Z);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-base truncate",children:Z.name}),Yn(Z.name)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 break-all",children:Z.base_url})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>el(Z.name),disabled:V.has(Z.name),title:"",children:V.has(Z.name)?e.jsx(Ls,{className:"h-4 w-4 animate-spin"}):e.jsx(Xa,{className:"h-4 w-4"})}),e.jsx(S,{variant:"default",size:"sm",onClick:()=>We(Z,De),children:e.jsx(Pn,{className:"h-4 w-4",strokeWidth:2,fill:"none"})}),e.jsx(S,{size:"sm",onClick:()=>ls(De),className:"bg-red-600 hover:bg-red-700 text-white",children:e.jsx(ns,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:Z.client_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:Z.max_retry})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:Z.timeout})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:Z.retry_interval})]})]})]},ye)})}),e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(Ws,{checked:ve.size===Ms.length&&Ms.length>0,onCheckedChange:pt})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"URL"}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""}),e.jsx(Ze,{className:"text-right",children:"()"}),e.jsx(Ze,{className:"text-right",children:"()"}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Rl,{children:Ut.length===0?e.jsx(dt,{children:e.jsx(Ke,{colSpan:9,className:"text-center text-muted-foreground py-8",children:me?"":'""'})}):Ut.map((Z,ye)=>{const De=l.findIndex(Hs=>Hs===Z);return e.jsxs(dt,{children:[e.jsx(Ke,{children:e.jsx(Ws,{checked:ve.has(De),onCheckedChange:()=>bs(De)})}),e.jsx(Ke,{children:Yn(Z.name)||e.jsx(ke,{variant:"outline",className:"text-muted-foreground",children:""})}),e.jsx(Ke,{className:"font-medium",children:Z.name}),e.jsx(Ke,{className:"max-w-xs truncate",title:Z.base_url,children:Z.base_url}),e.jsx(Ke,{children:Z.client_type}),e.jsx(Ke,{className:"text-right",children:Z.max_retry}),e.jsx(Ke,{className:"text-right",children:Z.timeout}),e.jsx(Ke,{className:"text-right",children:Z.retry_interval}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>el(Z.name),disabled:V.has(Z.name),title:"",children:V.has(Z.name)?e.jsx(Ls,{className:"h-4 w-4 animate-spin"}):e.jsx(Xa,{className:"h-4 w-4"})}),e.jsxs(S,{variant:"default",size:"sm",onClick:()=>We(Z,De),children:[e.jsx(Pn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(S,{size:"sm",onClick:()=>ls(De),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},ye)})})]})})}),Ms.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-provider",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:I.toString(),onValueChange:Z=>{L(parseInt(Z)),Q(1),se(new Set)},children:[e.jsx($e,{id:"page-size-provider",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(z-1)*I+1," "," ",Math.min(z*I,Ms.length),"  ",Ms.length," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Q(1),disabled:z===1,className:"hidden sm:flex",children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>Q(Z=>Math.max(1,Z-1)),disabled:z===1,children:[e.jsx(Va,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:B,onChange:Z=>_e(Z.target.value),onKeyDown:Z=>Z.key==="Enter"&&za(),placeholder:z.toString(),className:"w-16 h-8 text-center",min:1,max:kt}),e.jsx(S,{variant:"outline",size:"sm",onClick:za,disabled:!B,className:"h-8",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>Q(Z=>Z+1),disabled:z>=kt,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Q(kt),disabled:z>=kt,className:"hidden sm:flex",children:e.jsx(fn,{className:"h-4 w-4"})})]})]})]}),e.jsx(Ps,{open:N,onOpenChange:Ns,children:e.jsxs(Us,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"provider-dialog",preventOutsideClose:Y.isRunning,children:[e.jsxs($s,{children:[e.jsx(Bs,{children:b!==null?"":""}),e.jsx(Js,{children:" API "})]}),e.jsxs("form",{onSubmit:Z=>{Z.preventDefault(),Ee()},autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"provider-template-select",children:[e.jsx(T,{htmlFor:"template",children:""}),e.jsxs(il,{open:H,onOpenChange:E,children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",role:"combobox","aria-expanded":H,className:"w-full justify-between",children:[A?Gi.find(Z=>Z.id===A)?.display_name:"...",e.jsx(Ym,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Za,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(sd,{children:[e.jsx(td,{placeholder:"..."}),e.jsx(Je,{className:"h-[300px]",children:e.jsxs(ad,{className:"max-h-none overflow-visible",children:[e.jsx(ld,{children:""}),e.jsx(ac,{children:Gi.map(Z=>e.jsxs(lc,{value:Z.display_name,onSelect:()=>Os(Z.id),children:[e.jsx(_t,{className:`mr-2 h-4 w-4 ${A===Z.id?"opacity-100":"opacity-0"}`}),Z.display_name]},Z.id))})]})})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" URL ,"})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-name-input",children:[e.jsx(T,{htmlFor:"name",className:K.name?"text-destructive":"",children:" *"}),e.jsx(ne,{id:"name",value:y?.name||"",onChange:Z=>{w(ye=>ye?{...ye,name:Z.target.value}:null),K.name&&U(ye=>({...ye,name:void 0}))},placeholder:": DeepSeek, SiliconFlow",className:K.name?"border-destructive focus-visible:ring-destructive":""}),K.name&&e.jsx("p",{className:"text-xs text-destructive",children:K.name})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-url-input",children:[e.jsx(T,{htmlFor:"base_url",className:K.base_url?"text-destructive":"",children:" URL *"}),e.jsx(ne,{id:"base_url",value:y?.base_url||"",onChange:Z=>{w(ye=>ye?{...ye,base_url:Z.target.value}:null),K.base_url&&U(ye=>({...ye,base_url:void 0}))},placeholder:"https://api.example.com/v1",disabled:as,className:`${as?"bg-muted cursor-not-allowed":""} ${K.base_url?"border-destructive focus-visible:ring-destructive":""}`}),K.base_url&&e.jsx("p",{className:"text-xs text-destructive",children:K.base_url}),as&&!K.base_url&&e.jsx("p",{className:"text-xs text-muted-foreground",children:' URL ,""'})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-apikey-input",children:[e.jsx(T,{htmlFor:"api_key",className:K.api_key?"text-destructive":"",children:"API Key *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{id:"api_key",type:ee?"text":"password",value:y?.api_key||"",onChange:Z=>{w(ye=>ye?{...ye,api_key:Z.target.value}:null),K.api_key&&U(ye=>({...ye,api_key:void 0}))},placeholder:"sk-...",className:`flex-1 ${K.api_key?"border-destructive focus-visible:ring-destructive":""}`}),e.jsx(S,{type:"button",variant:"outline",size:"icon",onClick:()=>R(!ee),title:ee?"":"",children:ee?e.jsx(Zi,{className:"h-4 w-4"}):e.jsx(na,{className:"h-4 w-4"})}),e.jsx(S,{type:"button",variant:"outline",size:"icon",onClick:Cs,title:"",children:e.jsx(Ro,{className:"h-4 w-4"})})]}),K.api_key&&e.jsx("p",{className:"text-xs text-destructive",children:K.api_key})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"client_type",children:""}),e.jsxs(Ie,{value:y?.client_type||"openai",onValueChange:Z=>w(ye=>ye?{...ye,client_type:Z}:null),disabled:as,children:[e.jsx($e,{id:"client_type",className:as?"bg-muted cursor-not-allowed":"",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"openai",children:"OpenAI"}),e.jsx(W,{value:"gemini",children:"Gemini"})]})]}),as&&e.jsx("p",{className:"text-xs text-muted-foreground",children:',""'})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_retry",children:""}),e.jsx(ne,{id:"max_retry",type:"number",min:"0",value:y?.max_retry??"",onChange:Z=>{const ye=Z.target.value===""?null:parseInt(Z.target.value);w(De=>De?{...De,max_retry:ye}:null)},placeholder:": 2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"timeout",children:"()"}),e.jsx(ne,{id:"timeout",type:"number",min:"1",value:y?.timeout??"",onChange:Z=>{const ye=Z.target.value===""?null:parseInt(Z.target.value);w(De=>De?{...De,timeout:ye}:null)},placeholder:": 30"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"retry_interval",children:"()"}),e.jsx(ne,{id:"retry_interval",type:"number",min:"1",value:y?.retry_interval??"",onChange:Z=>{const ye=Z.target.value===""?null:parseInt(Z.target.value);w(De=>De?{...De,retry_interval:ye}:null)},placeholder:": 10"})]})]})]}),e.jsxs(et,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>v(!1),"data-tour":"provider-cancel-button",children:""}),e.jsx(S,{type:"submit","data-tour":"provider-save-button",children:""})]})]})]})}),e.jsx(vs,{open:C,onOpenChange:M,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',G!==null?l[G]?.name:"",'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:es,children:""})]})]})}),e.jsx(vs,{open:ge,onOpenChange:fe,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",ve.size,"  "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:tt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:je.isOpen,onOpenChange:Z=>Ce(ye=>({...ye,isOpen:Z})),children:e.jsxs(ds,{className:"max-w-2xl",children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:["",e.jsx("strong",{className:"text-foreground ml-1",children:je.providersToDelete.join(", ")})]}),e.jsxs("p",{className:"text-yellow-600 dark:text-yellow-500 font-medium",children:["  ",je.affectedModels.length," "]}),e.jsx(Je,{className:"h-32 w-full rounded border p-3",children:e.jsx("div",{className:"space-y-1",children:je.affectedModels.map((Z,ye)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-mono text-muted-foreground",children:""}),e.jsx("span",{className:"ml-2 font-medium",children:Z.name}),e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",Z.model_identifier,")"]})]},ye))})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:q,children:""}),e.jsx(fs,{onClick:ut,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Qn,{})]})}function Ji(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,11)}`}function Tm(l){return l===null?"null":Array.isArray(l)?"array":typeof l=="object"?"object":typeof l=="boolean"?"boolean":typeof l=="number"?"number":"string"}function Im(l){return Object.entries(l).map(([n,i])=>{const c=Tm(i),u={id:Ji(),key:n,value:i,type:c,expanded:!0};return c==="object"&&i&&typeof i=="object"?u.children=Im(i):c==="array"&&Array.isArray(i)&&(u.children=i.map((x,h)=>{const f=Tm(x),p={id:Ji(),key:String(h),value:x,type:f,expanded:!0};return f==="object"&&x&&typeof x=="object"?p.children=Im(x):f==="array"&&Array.isArray(x)&&(p.children=x.map((g,N)=>({id:Ji(),key:String(N),value:g,type:Tm(g),expanded:!0}))),p})),u})}function Pm(l){const n={};for(const i of l)i.key.trim()&&(i.type==="object"&&i.children?n[i.key]=Pm(i.children):i.type==="array"&&i.children?n[i.key]=i.children.map(c=>c.type==="object"&&c.children?Pm(c.children):c.type==="array"&&c.children?c.children.map(u=>u.value):c.value):i.type==="null"?n[i.key]=null:n[i.key]=i.value);return n}function yg(l,n){switch(n){case"boolean":return l==="true";case"number":{const i=parseFloat(l);return isNaN(i)?0:i}case"null":return null;default:return l}}function gv({node:l,level:n,onUpdate:i,onRemove:c,onAddChild:u,onToggleExpand:x}){const h=l.type==="object"||l.type==="array",f=l.children&&l.children.length>0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 items-center",style:{gridTemplateColumns:h?"32px 1fr 90px 64px":"32px 1fr 1fr 90px 32px",paddingLeft:`${n*20}px`},children:[e.jsx(S,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>x(l.id),disabled:!h||!f,children:h&&f?l.expanded?e.jsx(Aa,{className:"h-4 w-4"}):e.jsx(sa,{className:"h-4 w-4"}):e.jsx("span",{className:"w-4"})}),e.jsx(ne,{value:l.key,onChange:p=>i(l.id,"key",p.target.value),placeholder:"key",className:"h-8 text-sm"}),!h&&e.jsx(e.Fragment,{children:l.type==="boolean"?e.jsxs("div",{className:"flex items-center h-8 px-3 border rounded-md bg-background",children:[e.jsx(Fe,{checked:l.value===!0,onCheckedChange:p=>i(l.id,"value",p)}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:l.value?"true":"false"})]}):l.type==="null"?e.jsx("div",{className:"flex items-center h-8 px-3 border rounded-md bg-muted text-sm text-muted-foreground",children:"null"}):e.jsx(ne,{type:l.type==="number"?"number":"text",value:l.value,onChange:p=>i(l.id,"value",p.target.value),placeholder:"value",className:"h-8 text-sm",step:l.type==="number"?"any":void 0})}),e.jsxs(Ie,{value:l.type,onValueChange:p=>i(l.id,"type",p),children:[e.jsx($e,{className:"h-8 text-xs",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"string",children:""}),e.jsx(W,{value:"number",children:""}),e.jsx(W,{value:"boolean",children:""}),e.jsx(W,{value:"null",children:"Null"}),e.jsx(W,{value:"object",children:""}),e.jsx(W,{value:"array",children:""})]})]}),e.jsxs("div",{className:"flex gap-1 justify-end",children:[h&&e.jsx(S,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>u(l.id),title:"",children:e.jsx(Zs,{className:"h-4 w-4"})}),e.jsx(S,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>c(l.id),title:"",children:e.jsx(ns,{className:"h-4 w-4"})})]})]}),h&&l.expanded&&l.children&&l.children.length>0&&e.jsx("div",{className:"space-y-1",children:l.children.map(p=>e.jsx(gv,{node:p,level:n+1,onUpdate:i,onRemove:c,onAddChild:u,onToggleExpand:x},p.id))})]})}function Y1({value:l,onChange:n,placeholder:i="..."}){const[c,u]=m.useState(()=>Im(l||{})),x=m.useCallback(v=>{u(v),n(Pm(v))},[n]),h=m.useCallback(()=>{const v={id:Ji(),key:"",value:"",type:"string",expanded:!1};x([...c,v])},[c,x]),f=m.useCallback((v,y,w)=>{const b=O=>O.map(A=>{if(A.id===v)if(y==="type"){const _=w;if(_==="object")return{...A,type:_,value:{},children:[]};if(_==="array")return{...A,type:_,value:[],children:[]};if(_==="null")return{...A,type:_,value:null};{const H=yg(String(A.value),_);return{...A,type:_,value:H,children:void 0}}}else if(y==="value"){const _=yg(String(w),A.type);return{...A,value:_}}else return{...A,[y]:String(w)};return A.children?{...A,children:b(A.children)}:A});x(b(c))},[c,x]),p=m.useCallback(v=>{const y=w=>w.filter(b=>b.id!==v).map(b=>b.children?{...b,children:y(b.children)}:b);x(y(c))},[c,x]),g=m.useCallback(v=>{const y=w=>w.map(b=>{if(b.id===v){const O={id:Ji(),key:b.type==="array"?String(b.children?.length||0):"",value:"",type:"string",expanded:!0};return{...b,children:[...b.children||[],O]}}return b.children?{...b,children:y(b.children)}:b});x(y(c))},[c,x]),N=m.useCallback(v=>{const y=w=>w.map(b=>b.id===v?{...b,expanded:!b.expanded}:b.children?{...b,children:y(b.children)}:b);u(y(c))},[c]);return e.jsxs("div",{className:"h-full flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c.length," "]}),e.jsxs(S,{type:"button",size:"sm",variant:"outline",onClick:h,className:"h-7 text-xs",children:[e.jsx(Zs,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",children:c.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border border-dashed rounded-md",children:i}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 text-xs text-muted-foreground px-1 sticky top-0 bg-background z-10",style:{gridTemplateColumns:"32px 1fr 1fr 90px 32px"},children:[e.jsx("span",{}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{})]}),c.map(v=>e.jsx(gv,{node:v,level:0,onUpdate:f,onRemove:p,onAddChild:g,onToggleExpand:N},v.id))]})})]})}function wg(l){if(!l.trim())return{valid:!0,parsed:{}};try{const n=JSON.parse(l);return typeof n!="object"||n===null||Array.isArray(n)?{valid:!1,error:" JSON  {}"}:{valid:!0,parsed:n}}catch{return{valid:!1,error:"JSON "}}}function J1({value:l,onChange:n,className:i,placeholder:c="..."}){const[u,x]=m.useState("list"),h=m.useMemo(()=>Object.keys(l||{}).length>0?JSON.stringify(l,null,2):"",[l]),[f,p]=m.useState(h),[g,N]=m.useState(null);m.useEffect(()=>{p(h)},[h]);const v=m.useMemo(()=>{const b=wg(f);return b.valid&&b.parsed?{success:!0,data:b.parsed}:{success:!1,data:{}}},[f]),y=m.useCallback(b=>{const O=b;O==="json"&&u==="list"&&(p(Object.keys(l).length>0?JSON.stringify(l,null,2):""),N(null)),x(O)},[u,l]),w=m.useCallback(b=>{p(b);const O=wg(b);O.valid&&O.parsed?(N(null),n(O.parsed)):N(O.error||"JSON ")},[n]);return e.jsx("div",{className:P("h-full flex flex-col",i),children:e.jsxs(ra,{value:u,onValueChange:y,className:"w-full flex-1 flex flex-col",children:[e.jsxs(ea,{className:"h-8 p-0.5 bg-muted/60 w-fit",children:[e.jsx(ts,{value:"list",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:""}),e.jsx(ts,{value:"json",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"JSON "})]}),e.jsx(ys,{value:"list",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsx(Y1,{value:l,onChange:n,placeholder:c})}),e.jsx(ys,{value:"json",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),g?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-destructive",children:[e.jsx(St,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:g})]}):f.trim()&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[e.jsx(_t,{className:"h-3 w-3"}),e.jsx("span",{children:""})]})]}),e.jsx(at,{value:f,onChange:b=>w(b.target.value),placeholder:`{
  "key": "value"
}`,className:P("font-mono text-sm flex-1 resize-none",g&&"border-destructive focus-visible:ring-destructive")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" JSON "})]}),e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"flex-1 rounded-md border bg-muted/30 p-3 overflow-auto",children:v.success&&Object.keys(v.data).length>0?e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-words",children:JSON.stringify(v.data,null,2)}):v.success?e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:""}):e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-destructive",children:"JSON "})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})})]})})}function X1({open:l,onOpenChange:n,value:i,onChange:c}){const[u,x]=m.useState(i),h=g=>{g&&x(i),n(g)},f=()=>{c(u),n(!1)},p=()=>{x(i),n(!1)};return e.jsx(Ps,{open:l,onOpenChange:h,children:e.jsxs(Us,{className:"max-w-3xl h-[70vh] flex flex-col",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:e.jsx(J1,{value:u,onChange:x,placeholder:" thinkingtop_p ..."})}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:p,children:""}),e.jsx(S,{onClick:f,children:""})]})]})})}const Kr="https://maibot-plugin-stats.maibot-webui.workers.dev";async function Z1(l){const n=new URLSearchParams;l?.status&&n.set("status",l.status),l?.page&&n.set("page",l.page.toString()),l?.page_size&&n.set("page_size",l.page_size.toString()),l?.search&&n.set("search",l.search),l?.sort_by&&n.set("sort_by",l.sort_by),l?.sort_order&&n.set("sort_order",l.sort_order);const i=await fetch(`${Kr}/pack?${n.toString()}`);if(!i.ok)throw new Error(` Pack : ${i.status}`);return i.json()}async function W1(l){const n=await fetch(`${Kr}/pack/${l}`);if(!n.ok)throw new Error(` Pack : ${n.status}`);const i=await n.json();if(!i.success)throw new Error(i.error||" Pack ");return i.pack}async function eS(l){const i=await(await fetch(`${Kr}/pack`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();if(!i.success)throw new Error(i.error||" Pack ");return i}async function sS(l,n){await fetch(`${Kr}/pack/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:l,user_id:n})})}async function jv(l,n){const c=await(await fetch(`${Kr}/pack/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:l,user_id:n})})).json();if(!c.success)throw new Error(c.error||"");return{likes:c.likes,liked:c.liked}}async function vv(l,n){return(await(await fetch(`${Kr}/pack/like/check?pack_id=${l}&user_id=${n}`)).json()).liked||!1}async function tS(l){const n=await we("/api/webui/config/model");if(!n.ok)throw new Error("");const i=await n.json(),c=i.config||i;console.log("=== Pack Conflict Detection ==="),console.log("Pack providers:",l.providers),console.log("Local providers:",c.api_providers);const u={existing_providers:[],new_providers:[],conflicting_models:[]},x=c.api_providers||[];for(const f of l.providers){console.log(`
Checking pack provider: ${f.name}`),console.log(`  Pack URL: ${f.base_url}`),console.log(`  Normalized: ${Em(f.base_url)}`);const p=x.filter(g=>{const N=Em(g.base_url),v=Em(f.base_url);return console.log(`  Comparing with local "${g.name}": ${g.base_url}`),console.log(`    Local normalized: ${N}`),console.log(`    Match: ${N===v}`),N===v});p.length>0?(console.log(`   Matched with ${p.length} local provider(s):`,p.map(g=>g.name).join(", ")),u.existing_providers.push({pack_provider:f,local_providers:p.map(g=>({name:g.name,base_url:g.base_url}))})):(console.log("   No match found - will need API key"),u.new_providers.push(f))}const h=c.models||[];console.log(`
=== Model Conflict Detection ===`);for(const f of l.models){const p=h.find(g=>g.name===f.name);p&&(console.log(`Model conflict: ${f.name}`),u.conflicting_models.push({pack_model:f.name,local_model:p.name}))}return console.log(`
=== Detection Summary ===`),console.log(`Existing providers: ${u.existing_providers.length}`),console.log(`New providers: ${u.new_providers.length}`),console.log(`Conflicting models: ${u.conflicting_models.length}`),console.log(`===========================
`),u}async function aS(l,n,i,c){const u=await we("/api/webui/config/model");if(!u.ok)throw new Error("");const x=await u.json(),h=x.config||x;if(n.apply_providers){const p=n.selected_providers?l.providers.filter(g=>n.selected_providers.includes(g.name)):l.providers;for(const g of p){if(i[g.name])continue;const N=c[g.name];if(!N)throw new Error(` "${g.name}"  API Key`);const v={...g,api_key:N},y=h.api_providers.findIndex(w=>w.name===g.name);y>=0?h.api_providers[y]=v:h.api_providers.push(v)}}if(n.apply_models){const p=n.selected_models?l.models.filter(g=>n.selected_models.includes(g.name)):l.models;for(const g of p){const N=i[g.api_provider]||g.api_provider,v={...g,api_provider:N},y=h.models.findIndex(w=>w.name===g.name);y>=0?h.models[y]=v:h.models.push(v)}}if(n.apply_task_config){const p=n.selected_tasks||Object.keys(l.task_config);for(const g of p){const N=l.task_config[g];if(!N)continue;const v=new Set(n.selected_models||l.models.map(b=>b.name)),y=N.model_list.filter(b=>v.has(b));if(y.length===0)continue;const w={...N,model_list:y};if(n.task_mode==="replace")h.model_task_config[g]=w;else{const b=h.model_task_config[g];if(b){const O=[...new Set([...b.model_list,...y])];h.model_task_config[g]={...b,model_list:O}}else h.model_task_config[g]=w}}}if(!(await we("/api/webui/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("")}async function lS(l){const n=await we("/api/webui/config/model");if(!n.ok)throw new Error("");const i=await n.json();if(!i.success||!i.config)throw new Error("");const c=i.config;let u=(c.api_providers||[]).map(g=>({name:g.name,base_url:g.base_url,client_type:g.client_type,max_retry:g.max_retry,timeout:g.timeout,retry_interval:g.retry_interval}));l.selectedProviders&&(u=u.filter(g=>l.selectedProviders.includes(g.name)));let x=c.models||[];l.selectedModels&&(x=x.filter(g=>l.selectedModels.includes(g.name)));const h={},f=c.model_task_config||{},p=l.selectedTasks||Object.keys(f);for(const g of p)f[g]&&(h[g]=f[g]);return{providers:u,models:x,task_config:h}}function Em(l){try{const n=new URL(l);return`${n.protocol}//${n.host}${n.pathname}`.replace(/\/$/,"").toLowerCase()}catch{return l.toLowerCase().replace(/\/$/,"")}}function Nv(){const l="maibot_pack_user_id";let n=localStorage.getItem(l);return n||(n="pack_user_"+Math.random().toString(36).substring(2,15),localStorage.setItem(l,n)),n}const nS={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""},rS=["","","","","","","OpenAI","Claude","Gemini","","",""];function iS({trigger:l}){const[n,i]=m.useState(!1),[c,u]=m.useState(1),[x,h]=m.useState(!1),[f,p]=m.useState(!1),[g,N]=m.useState([]),[v,y]=m.useState([]),[w,b]=m.useState({}),[O,A]=m.useState(new Set),[_,H]=m.useState(new Set),[E,C]=m.useState(new Set),[M,G]=m.useState(""),[D,ee]=m.useState(""),[R,me]=m.useState(""),[ce,ve]=m.useState([]);m.useEffect(()=>{n&&c===1&&se()},[n,c]);const se=async()=>{h(!0);try{const K=await lS({name:"",description:"",author:""});N(K.providers),y(K.models),b(K.task_config),A(new Set(K.providers.map(U=>U.name))),H(new Set(K.models.map(U=>U.name))),C(new Set(Object.keys(K.task_config)))}catch(K){console.error(":",K),Kt({title:"",variant:"destructive"})}finally{h(!1)}},ge=K=>{const U=new Set(O),V=new Set(_),xe=new Set(E);U.has(K)?(U.delete(K),v.filter(X=>X.api_provider===K).forEach(X=>V.delete(X.name)),Object.entries(w).forEach(([X,oe])=>{oe.model_list&&(oe.model_list.some(Y=>V.has(Y))||xe.delete(X))})):(U.add(K),v.filter(X=>X.api_provider===K).forEach(X=>V.add(X.name)),Object.entries(w).forEach(([X,oe])=>{oe.model_list&&oe.model_list.some(Y=>{const te=v.find(Ue=>Ue.name===Y);return te&&te.api_provider===K})&&xe.add(X)})),A(U),H(V),C(xe)},fe=K=>{const U=new Set(_),V=new Set(E);U.has(K)?(U.delete(K),Object.entries(w).forEach(([xe,Oe])=>{Oe.model_list&&(Oe.model_list.some(oe=>U.has(oe))||V.delete(xe))})):(U.add(K),Object.entries(w).forEach(([xe,Oe])=>{Oe.model_list&&Oe.model_list.includes(K)&&V.add(xe)})),H(U),C(V)},z=K=>{const U=new Set(E);U.has(K)?U.delete(K):U.add(K),C(U)},Q=K=>{ce.includes(K)?ve(ce.filter(U=>U!==K)):ce.length<5?ve([...ce,K]):Kt({title:" 5 ",variant:"destructive"})},I=()=>{O.size===g.length?A(new Set):A(new Set(g.map(K=>K.name)))},L=()=>{_.size===v.length?H(new Set):H(new Set(v.map(K=>K.name)))},B=()=>{const K=Object.keys(w);E.size===K.length?C(new Set):C(new Set(K))},_e=async()=>{if(!M.trim()){Kt({title:"",variant:"destructive"});return}if(!D.trim()){Kt({title:"",variant:"destructive"});return}if(!R.trim()){Kt({title:"",variant:"destructive"});return}if(O.size===0&&_.size===0&&E.size===0){Kt({title:"",variant:"destructive"});return}p(!0);try{const K=g.filter(xe=>O.has(xe.name)),U=v.filter(xe=>_.has(xe.name)),V={};for(const[xe,Oe]of Object.entries(w))E.has(xe)&&(V[xe]=Oe);await eS({name:M.trim(),description:D.trim(),author:R.trim(),tags:ce,providers:K,models:U,task_config:V}),Kt({title:""}),i(!1),je()}catch(K){console.error(":",K),Kt({title:K instanceof Error?K.message:"",variant:"destructive"})}finally{p(!1)}},je=()=>{u(1),G(""),ee(""),me(""),ve([]),A(new Set),H(new Set),C(new Set)},Ce=2;return e.jsxs(Ps,{open:n,onOpenChange:i,children:[e.jsx(ed,{asChild:!0,children:l||e.jsxs(S,{variant:"outline",children:[e.jsx(Dj,{className:"w-4 h-4 mr-2"}),""]})}),e.jsxs(Us,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(la,{className:"w-5 h-5"}),""]}),e.jsxs(Js,{children:[" ",c," / ",Ce,"",c===1&&"",c===2&&""]})]}),e.jsx(Je,{className:"h-[calc(85vh-220px)] pr-4",children:x?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Ls,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx(Bn,{children:""}),e.jsxs(nt,{children:["",e.jsx("strong",{children:""})," API Key"]})]}),e.jsxs(ra,{defaultValue:"providers",className:"w-full",children:[e.jsxs(ea,{className:"grid w-full grid-cols-3",children:[e.jsxs(ts,{value:"providers",children:[e.jsx(zl,{className:"w-4 h-4 mr-2"}),"API ",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[O.size,"/",g.length]})]}),e.jsxs(ts,{value:"models",children:[e.jsx(Hn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[_.size,"/",v.length]})]}),e.jsxs(ts,{value:"tasks",children:[e.jsx(Fn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[E.size,"/",Object.keys(w).length]})]})]}),e.jsx(ys,{value:"providers",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{variant:"ghost",size:"sm",onClick:I,children:O.size===g.length?"":""})}),g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):g.map(K=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(Ws,{id:`provider-${K.name}`,checked:O.has(K.name),onCheckedChange:()=>ge(K.name)}),e.jsxs(T,{htmlFor:`provider-${K.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:K.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:K.base_url})]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:K.client_type})]},K.name))]})}),e.jsx(ys,{value:"models",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{variant:"ghost",size:"sm",onClick:L,children:_.size===v.length?"":""})}),v.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):v.map(K=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(Ws,{id:`model-${K.name}`,checked:_.has(K.name),onCheckedChange:()=>fe(K.name)}),e.jsxs(T,{htmlFor:`model-${K.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:K.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:K.model_identifier})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:K.api_provider})]},K.name))]})}),e.jsx(ys,{value:"tasks",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{variant:"ghost",size:"sm",onClick:B,children:E.size===Object.keys(w).length?"":""})}),Object.keys(w).length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):Object.entries(w).map(([K,U])=>e.jsxs("div",{className:"space-y-2 p-2 rounded hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:`task-${K}`,checked:E.has(K),onCheckedChange:()=>z(K)}),e.jsx(T,{htmlFor:`task-${K}`,className:"flex-1 cursor-pointer",children:e.jsx("span",{className:"font-medium",children:nS[K]||K})}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[U.model_list.length," "]})]}),U.model_list&&U.model_list.length>0&&e.jsx("div",{className:"ml-6 flex flex-wrap gap-1",children:U.model_list.map(V=>{const xe=v.find(X=>X.name===V),Oe=_.has(V);return e.jsxs(ke,{variant:Oe?"default":"outline",className:"text-xs cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>fe(V),children:[V,xe&&e.jsxs("span",{className:"ml-1 opacity-70",children:["(",xe.api_provider,")"]})]},V)})})]},K))]})})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm p-3 bg-muted rounded-lg",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(zl,{className:"w-4 h-4"}),O.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Hn,{className:"w-4 h-4"}),_.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Fn,{className:"w-4 h-4"}),E.size," "]})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-name",children:" *"}),e.jsx(ne,{id:"pack-name",placeholder:"",value:M,onChange:K=>G(K.target.value),maxLength:50}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[M.length,"/50"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-description",children:" *"}),e.jsx(at,{id:"pack-description",placeholder:"...",value:D,onChange:K=>ee(K.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[D.length,"/500"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-author",children:" *"}),e.jsx(ne,{id:"pack-author",placeholder:" ID",value:R,onChange:K=>me(K.target.value),maxLength:30})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" 5 "}),e.jsx("div",{className:"flex flex-wrap gap-2",children:rS.map(K=>e.jsxs(ke,{variant:ce.includes(K)?"default":"outline",className:"cursor-pointer transition-colors",onClick:()=>Q(K),children:[ce.includes(K)&&e.jsx(_t,{className:"w-3 h-3 mr-1"}),e.jsx(Xo,{className:"w-3 h-3 mr-1"}),K]},K))})]})]}),e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx(Bn,{children:""}),e.jsx(nt,{children:" 1-3 "})]})]})]})}),e.jsxs(et,{className:"flex justify-between pt-4 border-t",children:[e.jsx("div",{children:c>1&&e.jsx(S,{variant:"outline",onClick:()=>u(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",onClick:()=>{i(!1),je()},disabled:f,children:""}),c<Ce?e.jsx(S,{onClick:()=>u(c+1),disabled:x||O.size===0&&_.size===0&&E.size===0,children:""}):e.jsxs(S,{onClick:_e,disabled:f,children:[f&&e.jsx(Ls,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})]})}function cS({value:l,label:n,onRemove:i}){const{attributes:c,listeners:u,setNodeRef:x,transform:h,transition:f,isDragging:p}=Yj({id:l}),g={transform:Jj.Transform.toString(h),transition:f,opacity:p?.5:1},N=y=>{y.preventDefault(),y.stopPropagation(),i(l)},v=y=>{y.stopPropagation()};return e.jsx("div",{ref:x,style:g,className:P("inline-flex items-center gap-1",p&&"shadow-lg"),children:e.jsxs(ke,{variant:"secondary",className:"cursor-move hover:bg-secondary/80 flex items-center gap-1",children:[e.jsx("div",{...c,...u,className:"cursor-grab active:cursor-grabbing flex items-center",children:e.jsx(Aj,{className:"h-3 w-3 text-muted-foreground"})}),e.jsx("span",{children:n}),e.jsx("span",{role:"button",tabIndex:0,className:"ml-1 rounded-sm hover:bg-destructive/20 focus:outline-none focus:ring-1 focus:ring-destructive cursor-pointer",onClick:N,onPointerDown:v,onMouseDown:y=>y.stopPropagation(),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),N(y))},children:e.jsx(Ma,{className:"h-3 w-3 hover:text-destructive",strokeWidth:2,fill:"none"})})]})})}function oS({options:l,selected:n,onChange:i,placeholder:c="...",emptyText:u="",className:x}){const[h,f]=m.useState(!1),p=Pj(Bo(Gj,{activationConstraint:{distance:8}}),Bo(Fj,{coordinateGetter:Hj})),g=y=>{n.includes(y)?i(n.filter(w=>w!==y)):i([...n,y])},N=y=>{i(n.filter(w=>w!==y))},v=y=>{const{active:w,over:b}=y;if(b&&w.id!==b.id){const O=n.indexOf(w.id),A=n.indexOf(b.id);i(Vj(n,O,A))}};return e.jsxs(il,{open:h,onOpenChange:f,children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",role:"combobox","aria-expanded":h,className:P("w-full justify-between min-h-10 h-auto",x),children:[e.jsx(qj,{sensors:p,collisionDetection:Kj,onDragEnd:v,children:e.jsx(Qj,{items:n,strategy:E_,children:e.jsx("div",{className:"flex gap-1 flex-wrap flex-1",children:n.length===0?e.jsx("span",{className:"text-muted-foreground",children:c}):n.map(y=>{const w=l.find(b=>b.value===y);return e.jsx(cS,{value:y,label:w?.label||y,onRemove:N},y)})})})}),e.jsx(Ym,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:2,fill:"none"})]})}),e.jsx(Za,{className:"w-full p-0",align:"start",children:e.jsxs(sd,{children:[e.jsx(td,{placeholder:"...",className:"h-9"}),e.jsxs(ad,{children:[e.jsx(ld,{children:u}),e.jsx(ac,{children:l.map(y=>{const w=n.includes(y.value);return e.jsxs(lc,{value:y.value,onSelect:()=>g(y.value),children:[e.jsx("div",{className:P("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",w?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(_t,{className:"h-3 w-3",strokeWidth:2,fill:"none"})}),e.jsx("span",{children:y.label})]},y.value)})})]})]})})]})}const Tl=zs.memo(function({title:n,description:i,taskConfig:c,modelNames:u,onChange:x,hideTemperature:h=!1,hideMaxTokens:f=!1,dataTour:p}){const g=N=>{x("model_list",N)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-base sm:text-lg",children:n}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:i})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":p,children:[e.jsx(T,{children:""}),e.jsx(oS,{options:u.map(N=>({label:N,value:N})),selected:c.model_list||[],onChange:g,placeholder:"...",emptyText:""})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!h&&e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",step:"0.1",min:"0",max:"1",value:c.temperature??.3,onChange:N=>{const v=parseFloat(N.target.value);!isNaN(v)&&v>=0&&v<=1&&x("temperature",v)},className:"w-20 h-8 text-sm"})]}),e.jsx(Sa,{value:[c.temperature??.3],onValueChange:N=>x("temperature",N[0]),min:0,max:1,step:.1,className:"w-full"})]}),!f&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" Token"}),e.jsx(ne,{type:"number",step:"1",min:"1",value:c.max_tokens??1024,onChange:N=>x("max_tokens",parseInt(N.target.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:" ()"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(ne,{type:"number",step:"1",min:"1",value:c.slow_threshold??15,onChange:N=>{const v=parseInt(N.target.value);!isNaN(v)&&v>=1&&x("slow_threshold",v)},placeholder:"15"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:c.selection_strategy??"balance",onValueChange:N=>x("selection_strategy",N),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"balance",children:"balance"}),e.jsx(W,{value:"random",children:"random"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})}),dS=zs.memo(function({paginatedModels:n,allModels:i,onEdit:c,onDelete:u,isModelUsed:x,searchQuery:h}){return n.length===0?e.jsx("div",{className:"md:hidden text-center text-muted-foreground py-8 rounded-lg border bg-card",children:h?"":""}):e.jsx("div",{className:"md:hidden space-y-3",children:n.map((f,p)=>{const g=i.findIndex(v=>v===f),N=x(f.name);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:f.name}),e.jsx(ke,{variant:N?"default":"secondary",className:N?"bg-green-600 hover:bg-green-700":"",children:N?"":""})]}),e.jsx("p",{className:"text-xs text-muted-foreground break-all",title:f.model_identifier,children:f.model_identifier})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(S,{variant:"default",size:"sm",onClick:()=>c(f,g),children:[e.jsx(Pn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(S,{size:"sm",onClick:()=>u(g),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.api_provider})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.temperature!=null?f.temperature:e.jsx("span",{className:"text-muted-foreground",children:""})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_in,"/M"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_out,"/M"]})]})]})]},p)})})}),uS=zs.memo(function({paginatedModels:n,allModels:i,filteredModels:c,selectedModels:u,onEdit:x,onDelete:h,onToggleSelection:f,onToggleSelectAll:p,isModelUsed:g,searchQuery:N}){return e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(Ws,{checked:u.size===c.length&&c.length>0,onCheckedChange:p})}),e.jsx(Ze,{className:"w-24",children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-center",children:""}),e.jsx(Ze,{className:"text-right",children:""}),e.jsx(Ze,{className:"text-right",children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Rl,{children:n.length===0?e.jsx(dt,{children:e.jsx(Ke,{colSpan:9,className:"text-center text-muted-foreground py-8",children:N?"":""})}):n.map((v,y)=>{const w=i.findIndex(O=>O===v),b=g(v.name);return e.jsxs(dt,{children:[e.jsx(Ke,{children:e.jsx(Ws,{checked:u.has(w),onCheckedChange:()=>f(w)})}),e.jsx(Ke,{children:e.jsx(ke,{variant:b?"default":"secondary",className:b?"bg-green-600 hover:bg-green-700":"",children:b?"":""})}),e.jsx(Ke,{className:"font-medium",children:v.name}),e.jsx(Ke,{className:"max-w-xs truncate",title:v.model_identifier,children:v.model_identifier}),e.jsx(Ke,{children:v.api_provider}),e.jsx(Ke,{className:"text-center",children:v.temperature!=null?v.temperature:e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(Ke,{className:"text-right",children:["",v.price_in,"/M"]}),e.jsxs(Ke,{className:"text-right",children:["",v.price_out,"/M"]}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(S,{variant:"default",size:"sm",onClick:()=>x(v,w),children:[e.jsx(Pn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(S,{size:"sm",onClick:()=>h(w),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},y)})})]})})})}),mS=300*1e3,_g=new Map,xS=[10,20,50,100],hS=zs.memo(function({page:n,pageSize:i,totalItems:c,jumpToPage:u,onPageChange:x,onPageSizeChange:h,onJumpToPageChange:f,onJumpToPage:p,onSelectionClear:g}){const N=Math.ceil(c/i),v=w=>{h(parseInt(w)),x(1),g?.()},y=w=>{w.key==="Enter"&&p()};return c===0?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-model",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:i.toString(),onValueChange:v,children:[e.jsx($e,{id:"page-size-model",className:"w-20",children:e.jsx(Pe,{})}),e.jsx(Be,{children:xS.map(w=>e.jsx(W,{value:w.toString(),children:w},w))})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(n-1)*i+1," "," ",Math.min(n*i,c),"  ",c," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>x(1),disabled:n===1,className:"hidden sm:flex",children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>x(Math.max(1,n-1)),disabled:n===1,children:[e.jsx(Va,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:u,onChange:w=>f(w.target.value),onKeyDown:y,placeholder:n.toString(),className:"w-16 h-8 text-center",min:1,max:N}),e.jsx(S,{variant:"outline",size:"sm",onClick:p,disabled:!u,className:"h-8",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>x(n+1),disabled:n>=N,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>x(N),disabled:n>=N,className:"hidden sm:flex",children:e.jsx(fn,{className:"h-4 w-4"})})]})]})});function fS(l){const{models:n,taskConfig:i,debounceMs:c=2e3,onSavingChange:u,onUnsavedChange:x}=l,h=m.useRef(null),f=m.useRef(null),p=m.useRef(!0),g=m.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current&&(clearTimeout(f.current),f.current=null)},[]),N=m.useCallback(w=>{const b={model_identifier:w.model_identifier,name:w.name,api_provider:w.api_provider,price_in:w.price_in??0,price_out:w.price_out??0,force_stream_mode:w.force_stream_mode??!1,extra_params:w.extra_params??{}};return w.temperature!=null&&(b.temperature=w.temperature),w.max_tokens!=null&&(b.max_tokens=w.max_tokens),b},[]),v=m.useCallback(async w=>{try{u?.(!0);const b=w.map(N);await Bm("models",b),x?.(!1)}catch(b){console.error(":",b),x?.(!0)}finally{u?.(!1)}},[u,x,N]),y=m.useCallback(async w=>{try{u?.(!0),await Bm("model_task_config",w),x?.(!1)}catch(b){console.error(":",b),x?.(!0)}finally{u?.(!1)}},[u,x]);return m.useEffect(()=>{if(!p.current)return x?.(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{v(n)},c),()=>{h.current&&clearTimeout(h.current)}},[n,v,c,x]),m.useEffect(()=>{if(!(p.current||!i))return x?.(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{y(i)},c),()=>{f.current&&clearTimeout(f.current)}},[i,y,c,x]),m.useEffect(()=>()=>{g()},[g]),{clearTimers:g,initialLoadRef:p}}function pS(l={}){const{onCloseEditDialog:n}=l,i=ia(),{registerTour:c,startTour:u,state:x,goToStep:h}=sx(),f=m.useRef(x.stepIndex);return m.useEffect(()=>{c(nl,fv)},[c]),m.useEffect(()=>{if(x.activeTourId===nl&&x.isRunning){const g=pv[x.stepIndex];g&&!window.location.pathname.endsWith(g.replace("/config/",""))&&i({to:g})}},[x.stepIndex,x.activeTourId,x.isRunning,i]),m.useEffect(()=>{if(x.activeTourId===nl&&x.isRunning){const g=f.current,N=x.stepIndex;g>=12&&g<=17&&N<12&&n?.(),f.current=N}},[x.stepIndex,x.activeTourId,x.isRunning,n]),m.useEffect(()=>{if(x.activeTourId!==nl||!x.isRunning)return;const g=N=>{const v=N.target,y=x.stepIndex;y===2&&v.closest('[data-tour="add-provider-button"]')?setTimeout(()=>h(3),300):y===9&&v.closest('[data-tour="provider-cancel-button"]')?setTimeout(()=>h(10),300):y===11&&v.closest('[data-tour="add-model-button"]')?setTimeout(()=>h(12),300):y===17&&v.closest('[data-tour="model-cancel-button"]')?setTimeout(()=>h(18),300):y===18&&v.closest('[data-tour="tasks-tab-trigger"]')&&setTimeout(()=>h(19),300)};return document.addEventListener("click",g,!0),()=>document.removeEventListener("click",g,!0)},[x,h]),{startTour:m.useCallback(()=>{u(nl)},[u]),isRunning:x.isRunning&&x.activeTourId===nl,stepIndex:x.stepIndex}}function gS(l){const{getProviderConfig:n}=l,[i,c]=m.useState([]),[u,x]=m.useState(!1),[h,f]=m.useState(null),[p,g]=m.useState(null),N=m.useCallback(()=>{c([]),f(null),g(null)},[]),v=m.useCallback(async(y,w=!1)=>{const b=n(y);if(!b?.base_url){c([]),g(null),f('""');return}if(!b.api_key){c([]),g(null),f(' API Key""');return}const O=V1(b.base_url);if(g(O),!O?.modelFetcher){c([]),f(null);return}const A=`${y}:${b.base_url}`,_=_g.get(A);if(!w&&_&&Date.now()-_.timestamp<mS){c(_.models),f(null);return}x(!0),f(null);try{const H=await S1(y,O.modelFetcher.parser,O.modelFetcher.endpoint);c(H),_g.set(A,{models:H,timestamp:Date.now()})}catch(H){console.error(":",H);const E=H.message||"";E.includes("")||E.includes("")||E.includes("API Key")?f('API Key ""'):E.includes("")?f(" API Key "):E.includes("timeout")||E.includes("")?f(""):E.includes("")?f(""):f(E),c([])}finally{x(!1)}},[n]);return{availableModels:i,fetchingModels:u,modelFetchError:h,matchedTemplate:p,fetchModelsForProvider:v,clearModels:N}}function jS(){return e.jsx(Kn,{children:e.jsx(vS,{})})}function vS(){const[l,n]=m.useState([]),[i,c]=m.useState([]),[u,x]=m.useState([]),[h,f]=m.useState([]),[p,g]=m.useState(null),[N,v]=m.useState(!0),[y,w]=m.useState(!1),[b,O]=m.useState(!1),[A,_]=m.useState(!1),[H,E]=m.useState(!1),[C,M]=m.useState(null),[G,D]=m.useState(null),[ee,R]=m.useState(!1),[me,ce]=m.useState(!1),[ve,se]=m.useState(null),[ge,fe]=m.useState(""),[z,Q]=m.useState(new Set),[I,L]=m.useState(!1),[B,_e]=m.useState(1),[je,Ce]=m.useState(20),[K,U]=m.useState(""),[V,xe]=m.useState(!1),[Oe,X]=m.useState(!1),oe=m.useRef([]),Ge=m.useRef(null),[Y,te]=m.useState([]),[Ue,Le]=m.useState([]),[Ae,de]=m.useState({}),{toast:Te}=st(),{triggerRestart:rs,isRestarting:Rt}=pn(),{startTour:ta,isRunning:qa}=pS({onCloseEditDialog:()=>E(!1)}),{clearTimers:Ht,initialLoadRef:ut}=fS({models:l,taskConfig:p,onSavingChange:O,onUnsavedChange:_}),q=m.useCallback((re,he)=>{if(!re)return;const ss=new Set(he.map(Ka=>Ka.name)),gs=[],cs=[],Ct=[{key:"utils",label:""},{key:"tool_use",label:""},{key:"replyer",label:""},{key:"planner",label:""},{key:"vlm",label:""},{key:"voice",label:""},{key:"embedding",label:""},{key:"lpmm_entity_extract",label:"LPMM"},{key:"lpmm_rdf_build",label:"LPMM"}];for(const{key:Ka,label:Ul}of Ct){const Jn=re[Ka];if(!Jn)continue;if(!Jn.model_list||Jn.model_list.length===0){cs.push(Ul);continue}const Yr=Jn.model_list.filter(vn=>!ss.has(vn));Yr.length>0&&gs.push({taskName:Ul,invalidModels:Yr})}te(gs),Le(cs)},[]),qe=m.useCallback(async()=>{try{v(!0);const re=await on(),he=re.models||[];n(he),f(he.map(Ct=>Ct.name));const ss=re.api_providers||[];c(ss.map(Ct=>Ct.name)),x(ss);const gs=re.model_task_config||null;g(gs),q(gs,he);const cs=gs?.embedding?.model_list||[];oe.current=[...cs],_(!1),ut.current=!1}catch(re){console.error(":",re)}finally{v(!1)}},[ut,q]);m.useEffect(()=>{qe()},[qe]);const Qe=m.useCallback(re=>u.find(he=>he.name===re),[u]),{availableModels:We,fetchingModels:Os,modelFetchError:as,matchedTemplate:Cs,fetchModelsForProvider:Ee,clearModels:Ns}=gS({getProviderConfig:Qe});m.useEffect(()=>{H&&C?.api_provider&&Ee(C.api_provider)},[H,C?.api_provider,Ee]);const ls=async()=>{await rs()},es=m.useCallback(()=>{if(!p)return;const re=new Set(l.map(gs=>gs.name)),he={...p},ss=Object.keys(he);for(const gs of ss){const cs=he[gs];cs&&cs.model_list&&(cs.model_list=cs.model_list.filter(Ct=>re.has(Ct)))}g(he),te([]),Te({title:"",description:""})},[p,l,Te]),bs=re=>{const he={model_identifier:re.model_identifier,name:re.name,api_provider:re.api_provider,price_in:re.price_in??0,price_out:re.price_out??0,force_stream_mode:re.force_stream_mode??!1,extra_params:re.extra_params??{}};return re.temperature!=null&&(he.temperature=re.temperature),re.max_tokens!=null&&(he.max_tokens=re.max_tokens),he},pt=async()=>{try{w(!0),Ht();const re=await on();re.models=l.map(bs),re.model_task_config=p,await Yi(re),_(!1),Te({title:"",description:"..."}),await ls()}catch(re){console.error(":",re),Te({title:"",description:re.message,variant:"destructive"}),w(!1)}},Lt=async()=>{try{w(!0),Ht();const re=await on();re.models=l.map(bs),re.model_task_config=p,await Yi(re),_(!1),Te({title:"",description:""}),await qe()}catch(re){console.error(":",re),Te({title:"",description:re.message,variant:"destructive"})}finally{w(!1)}},tt=(re,he)=>{de({}),M(re||{model_identifier:"",name:"",api_provider:i[0]||"",price_in:0,price_out:0,temperature:null,max_tokens:null,force_stream_mode:!1,extra_params:{}}),D(he),E(!0)},Ms=()=>{if(!C)return;const re={};if(C.name?.trim()||(re.name=""),C.api_provider?.trim()||(re.api_provider=" API "),C.model_identifier?.trim()||(re.model_identifier=""),Object.keys(re).length>0){de(re);return}de({});const he={model_identifier:C.model_identifier,name:C.name,api_provider:C.api_provider,price_in:C.price_in??0,price_out:C.price_out??0,force_stream_mode:C.force_stream_mode??!1,extra_params:C.extra_params??{}};C.temperature!=null&&(he.temperature=C.temperature),C.max_tokens!=null&&(he.max_tokens=C.max_tokens);let ss,gs=null;if(G!==null?(gs=l[G].name,ss=[...l],ss[G]=he):ss=[...l,he],n(ss),f(ss.map(cs=>cs.name)),gs&&gs!==he.name&&p){const cs=Ct=>Ct.map(Ka=>Ka===gs?he.name:Ka);g({...p,utils:{...p.utils,model_list:cs(p.utils?.model_list||[])},tool_use:{...p.tool_use,model_list:cs(p.tool_use?.model_list||[])},replyer:{...p.replyer,model_list:cs(p.replyer?.model_list||[])},planner:{...p.planner,model_list:cs(p.planner?.model_list||[])},vlm:{...p.vlm,model_list:cs(p.vlm?.model_list||[])},voice:{...p.voice,model_list:cs(p.voice?.model_list||[])},embedding:{...p.embedding,model_list:cs(p.embedding?.model_list||[])},lpmm_entity_extract:{...p.lpmm_entity_extract,model_list:cs(p.lpmm_entity_extract?.model_list||[])},lpmm_rdf_build:{...p.lpmm_rdf_build,model_list:cs(p.lpmm_rdf_build?.model_list||[])}})}E(!1),M(null),D(null),Te({title:G!==null?"":"",description:' 2 ""'})},kt=re=>{if(!re&&C){const he={...C,price_in:C.price_in??0,price_out:C.price_out??0};M(he)}E(re)},Ut=re=>{se(re),ce(!0)},za=()=>{if(ve!==null){const re=l.filter((he,ss)=>ss!==ve);n(re),f(re.map(he=>he.name)),q(p,re),Te({title:"",description:' 2 ""'})}ce(!1),se(null)},el=re=>{const he=new Set(z);he.has(re)?he.delete(re):he.add(re),Q(he)},ol=()=>{if(z.size===zt.length)Q(new Set);else{const re=zt.map((he,ss)=>l.findIndex(gs=>gs===zt[ss]));Q(new Set(re))}},Yn=()=>{if(z.size===0){Te({title:"",description:"",variant:"default"});return}L(!0)},Z=()=>{const re=z.size,he=l.filter((ss,gs)=>!z.has(gs));n(he),f(he.map(ss=>ss.name)),q(p,he),Q(new Set),L(!1),Te({title:"",description:` ${re}  2 `})},ye=(re,he,ss)=>{if(!p)return;if(re==="embedding"&&he==="model_list"&&Array.isArray(ss)){const cs=oe.current,Ct=ss;if((cs.length!==Ct.length||cs.some(Ul=>!Ct.includes(Ul))||Ct.some(Ul=>!cs.includes(Ul)))&&cs.length>0){Ge.current={field:he,value:ss},X(!0);return}}const gs={...p,[re]:{...p[re],[he]:ss}};g(gs),q(gs,l),re==="embedding"&&he==="model_list"&&Array.isArray(ss)&&(oe.current=[...ss])},De=()=>{if(!p||!Ge.current)return;const{field:re,value:he}=Ge.current,ss={...p,embedding:{...p.embedding,[re]:he}};g(ss),q(ss,l),re==="model_list"&&Array.isArray(he)&&(oe.current=[...he]),Ge.current=null,X(!1),Te({title:"",description:""})},Hs=()=>{Ge.current=null,X(!1)},zt=l.filter(re=>{if(!ge)return!0;const he=ge.toLowerCase();return re.name.toLowerCase().includes(he)||re.model_identifier.toLowerCase().includes(he)||re.api_provider.toLowerCase().includes(he)}),Jt=Math.ceil(zt.length/je),it=zt.slice((B-1)*je,B*je),Xt=()=>{const re=parseInt(K);re>=1&&re<=Jt&&(_e(re),U(""))},mt=re=>p?[p.utils?.model_list||[],p.tool_use?.model_list||[],p.replyer?.model_list||[],p.planner?.model_list||[],p.vlm?.model_list||[],p.voice?.model_list||[],p.embedding?.model_list||[],p.lpmm_entity_extract?.model_list||[],p.lpmm_rdf_build?.model_list||[]].some(ss=>ss.includes(re)):!1;return N?e.jsx(Je,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(iS,{trigger:e.jsxs(S,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(Dj,{className:"mr-2 h-4 w-4"}),""]})}),e.jsxs(S,{onClick:Lt,disabled:y||b||!A||Rt,size:"sm",variant:"outline",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(oc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),y?"...":b?"...":A?"":""]}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsxs(S,{disabled:y||b||Rt,size:"sm",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(cc,{className:"mr-2 h-4 w-4"}),Rt?"...":A?"":""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:A?",":","})})})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:A?pt:ls,children:A?"":""})]})]})]})]})]}),e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs(nt,{children:["",e.jsx("strong",{children:""}),'""']})]}),Y.length>0&&e.jsxs(lt,{variant:"destructive",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(nt,{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:Y.map(({taskName:re,invalidModels:he})=>e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:re})," : ",he.join(", ")]},re))})]}),e.jsx(S,{variant:"outline",size:"sm",className:"shrink-0 bg-background hover:bg-accent",onClick:es,children:""})]})]}),Ue.length>0&&e.jsxs(lt,{variant:"default",className:"border-yellow-500/50 bg-yellow-500/10",children:[e.jsx(Yt,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(nt,{children:[e.jsx("strong",{className:"text-yellow-600",children:""}),e.jsxs("div",{className:"mt-2 text-sm",children:[Ue.join("")," "]})]})]}),e.jsxs(lt,{className:"hidden lg:flex border-primary/30 bg-primary/5 cursor-pointer hover:bg-primary/10 transition-colors",onClick:ta,children:[e.jsx(Yw,{className:"h-4 w-4 text-primary"}),e.jsxs(nt,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[e.jsx("strong",{className:"text-primary",children:""}),""]}),e.jsx(S,{variant:"outline",size:"sm",className:"ml-4 shrink-0",children:""})]})]}),e.jsxs(ra,{defaultValue:"models",className:"w-full",children:[e.jsxs(ea,{className:"grid w-full max-w-full sm:max-w-md grid-cols-2",children:[e.jsx(ts,{value:"models",children:""}),e.jsx(ts,{value:"tasks","data-tour":"tasks-tab-trigger",children:""})]}),e.jsxs(ys,{value:"models",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[z.size>0&&e.jsxs(S,{onClick:Yn,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ns,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",z.size,")"]}),e.jsxs(S,{onClick:()=>tt(null,null),size:"sm",variant:"outline",className:"w-full sm:w-auto","data-tour":"add-model-button",children:[e.jsx(Zs,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:ge,onChange:re=>fe(re.target.value),className:"pl-9"})]}),ge&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",zt.length," "]})]}),e.jsx(dS,{paginatedModels:it,allModels:l,onEdit:tt,onDelete:Ut,isModelUsed:mt,searchQuery:ge}),e.jsx(uS,{paginatedModels:it,allModels:l,filteredModels:zt,selectedModels:z,onEdit:tt,onDelete:Ut,onToggleSelection:el,onToggleSelectAll:ol,isModelUsed:mt,searchQuery:ge}),e.jsx(hS,{page:B,pageSize:je,totalItems:zt.length,jumpToPage:K,onPageChange:_e,onPageSizeChange:Ce,onJumpToPageChange:U,onJumpToPage:Xt,onSelectionClear:()=>Q(new Set)})]}),e.jsxs(ys,{value:"tasks",className:"space-y-6 mt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),p&&e.jsxs("div",{className:"grid gap-4 sm:gap-6",children:[e.jsx(Tl,{title:" (utils)",description:"",taskConfig:p.utils,modelNames:h,onChange:(re,he)=>ye("utils",re,he),dataTour:"task-model-select"}),e.jsx(Tl,{title:" (tool_use)",description:"",taskConfig:p.tool_use,modelNames:h,onChange:(re,he)=>ye("tool_use",re,he)}),e.jsx(Tl,{title:" (replyer)",description:"",taskConfig:p.replyer,modelNames:h,onChange:(re,he)=>ye("replyer",re,he)}),e.jsx(Tl,{title:" (planner)",description:"",taskConfig:p.planner,modelNames:h,onChange:(re,he)=>ye("planner",re,he)}),e.jsx(Tl,{title:" (vlm)",description:"",taskConfig:p.vlm,modelNames:h,onChange:(re,he)=>ye("vlm",re,he),hideTemperature:!0}),e.jsx(Tl,{title:" (voice)",description:"",taskConfig:p.voice,modelNames:h,onChange:(re,he)=>ye("voice",re,he),hideTemperature:!0,hideMaxTokens:!0}),e.jsx(Tl,{title:" (embedding)",description:"",taskConfig:p.embedding,modelNames:h,onChange:(re,he)=>ye("embedding",re,he),hideTemperature:!0,hideMaxTokens:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsx(Tl,{title:" (lpmm_entity_extract)",description:"",taskConfig:p.lpmm_entity_extract,modelNames:h,onChange:(re,he)=>ye("lpmm_entity_extract",re,he)}),e.jsx(Tl,{title:"RDF  (lpmm_rdf_build)",description:"",taskConfig:p.lpmm_rdf_build,modelNames:h,onChange:(re,he)=>ye("lpmm_rdf_build",re,he)})]})]})]})]}),e.jsx(Ps,{open:H,onOpenChange:kt,children:e.jsxs(Us,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"model-dialog",preventOutsideClose:qa,children:[e.jsxs($s,{children:[e.jsx(Bs,{children:G!==null?"":""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"model-name-input",children:[e.jsx(T,{htmlFor:"model_name",className:Ae.name?"text-destructive":"",children:" *"}),e.jsx(ne,{id:"model_name",value:C?.name||"",onChange:re=>{M(he=>he?{...he,name:re.target.value}:null),Ae.name&&de(he=>({...he,name:void 0}))},placeholder:": qwen3-30b",className:Ae.name?"border-destructive focus-visible:ring-destructive":""}),Ae.name?e.jsx("p",{className:"text-xs text-destructive",children:Ae.name}):e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-provider-select",children:[e.jsx(T,{htmlFor:"api_provider",className:Ae.api_provider?"text-destructive":"",children:"API  *"}),e.jsxs(Ie,{value:C?.api_provider||"",onValueChange:re=>{M(he=>he?{...he,api_provider:re}:null),Ns(),Ae.api_provider&&de(he=>({...he,api_provider:void 0}))},children:[e.jsx($e,{id:"api_provider",className:Ae.api_provider?"border-destructive focus-visible:ring-destructive":"",children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:i.map(re=>e.jsx(W,{value:re,children:re},re))})]}),Ae.api_provider&&e.jsx("p",{className:"text-xs text-destructive",children:Ae.api_provider})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-identifier-input",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"model_identifier",className:Ae.model_identifier?"text-destructive":"",children:" *"}),Cs?.modelFetcher&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{variant:"secondary",className:"text-xs",children:Cs.display_name}),e.jsx(S,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>C?.api_provider&&Ee(C.api_provider,!0),disabled:Os,children:Os?e.jsx(Ls,{className:"h-3 w-3 animate-spin"}):e.jsx(ft,{className:"h-3 w-3"})})]})]}),Cs?.modelFetcher?e.jsxs(il,{open:V,onOpenChange:xe,children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",role:"combobox","aria-expanded":V,className:"w-full justify-between font-normal",disabled:Os||!!as,children:[Os?e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ls,{className:"h-4 w-4 animate-spin"}),"..."]}):as?e.jsx("span",{className:"text-muted-foreground text-sm",children:""}):C?.model_identifier?e.jsx("span",{className:"truncate",children:C.model_identifier}):e.jsx("span",{className:"text-muted-foreground",children:"..."}),e.jsx(Ym,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Za,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(sd,{children:[e.jsx(td,{placeholder:"..."}),e.jsx(Je,{className:"h-[300px]",children:e.jsxs(ad,{className:"max-h-none overflow-visible",children:[e.jsx(ld,{children:as?e.jsxs("div",{className:"py-4 px-2 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:as}),!as.includes("API Key")&&e.jsx(S,{variant:"link",size:"sm",onClick:()=>C?.api_provider&&Ee(C.api_provider,!0),children:""})]}):""}),e.jsx(ac,{heading:"",children:We.map(re=>e.jsxs(lc,{value:re.id,onSelect:()=>{M(he=>he?{...he,model_identifier:re.id}:null),xe(!1)},children:[e.jsx(_t,{className:`mr-2 h-4 w-4 ${C?.model_identifier===re.id?"opacity-100":"opacity-0"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:re.id}),re.name!==re.id&&e.jsx("span",{className:"text-xs text-muted-foreground",children:re.name})]})]},re.id))}),e.jsx(ac,{heading:"",children:e.jsxs(lc,{value:"__manual_input__",onSelect:()=>{xe(!1)},children:[e.jsx(Pn,{className:"mr-2 h-4 w-4"}),"..."]})})]})})]})})]}):e.jsx(ne,{id:"model_identifier",value:C?.model_identifier||"",onChange:re=>{M(he=>he?{...he,model_identifier:re.target.value}:null),Ae.model_identifier&&de(he=>({...he,model_identifier:void 0}))},placeholder:"Qwen/Qwen3-30B-A3B-Instruct-2507",className:Ae.model_identifier?"border-destructive focus-visible:ring-destructive":""}),Ae.model_identifier&&e.jsx("p",{className:"text-xs text-destructive",children:Ae.model_identifier}),as&&Cs?.modelFetcher&&!Ae.model_identifier&&e.jsxs(lt,{variant:"destructive",className:"mt-2 py-2",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx(nt,{className:"text-xs",children:as})]}),Cs?.modelFetcher&&e.jsx(ne,{value:C?.model_identifier||"",onChange:re=>{M(he=>he?{...he,model_identifier:re.target.value}:null),Ae.model_identifier&&de(he=>({...he,model_identifier:void 0}))},placeholder:"",className:`mt-2 ${Ae.model_identifier?"border-destructive focus-visible:ring-destructive":""}`}),!Ae.model_identifier&&e.jsx("p",{className:"text-xs text-muted-foreground",children:as?'"" API Key':Cs?.modelFetcher?` ${Cs.display_name}`:"API  ID"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_in",children:" (/M token)"}),e.jsx(ne,{id:"price_in",type:"number",step:"0.1",min:"0",value:C?.price_in??"",onChange:re=>{const he=re.target.value===""?null:parseFloat(re.target.value);M(ss=>ss?{...ss,price_in:he}:null)},placeholder:": 0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_out",children:" (/M token)"}),e.jsx(ne,{id:"price_out",type:"number",step:"0.1",min:"0",value:C?.price_out??"",onChange:re=>{const he=re.target.value===""?null:parseFloat(re.target.value);M(ss=>ss?{...ss,price_out:he}:null)},placeholder:": 0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_temperature",className:"cursor-pointer",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"enable_model_temperature",checked:C?.temperature!=null,onCheckedChange:re=>{M(re?he=>he?{...he,temperature:.5}:null:he=>he?{...he,temperature:null}:null)}})]}),C?.temperature!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:""}),e.jsx("span",{className:"text-sm font-medium tabular-nums",children:C.temperature.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"0"}),e.jsx(Sa,{value:[C.temperature],onValueChange:re=>M(he=>he?{...he,temperature:re[0]}:null),min:0,max:1,step:.1,className:"flex-1"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.1-0.30.7-1.0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_max_tokens",className:"cursor-pointer",children:" Token"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Token "})]}),e.jsx(Fe,{id:"enable_model_max_tokens",checked:C?.max_tokens!=null,onCheckedChange:re=>{M(re?he=>he?{...he,max_tokens:2048}:null:he=>he?{...he,max_tokens:null}:null)}})]}),C?.max_tokens!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:" Token "}),e.jsx(ne,{type:"number",min:"1",max:"128000",value:C.max_tokens,onChange:re=>{const he=parseInt(re.target.value);!isNaN(he)&&he>=1&&M(ss=>ss?{...ss,max_tokens:he}:null)},className:"w-28 h-8 text-sm"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" token "})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"force_stream_mode",checked:C?.force_stream_mode||!1,onCheckedChange:re=>M(he=>he?{...he,force_stream_mode:re}:null)}),e.jsx(T,{htmlFor:"force_stream_mode",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(S,{type:"button",variant:"outline",size:"sm",className:"flex-1 justify-start h-9",onClick:()=>R(!0),children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),Object.keys(C?.extra_params||{}).length>0?e.jsxs("span",{children:[" ",Object.keys(C?.extra_params||{}).length," "]}):e.jsx("span",{className:"text-muted-foreground",children:""})]})}),Object.keys(C?.extra_params||{}).length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:[Object.keys(C?.extra_params||{}).slice(0,3).map(re=>e.jsx("span",{className:"inline-block mr-2",children:e.jsx("code",{className:"px-1.5 py-0.5 bg-muted rounded",children:re})},re)),Object.keys(C?.extra_params||{}).length>3&&e.jsx("span",{children:"..."})]})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>E(!1),"data-tour":"model-cancel-button",children:""}),e.jsx(S,{onClick:Ms,"data-tour":"model-save-button",children:""})]})]})}),e.jsx(vs,{open:me,onOpenChange:ce,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',ve!==null?l[ve]?.name:"",'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:za,children:""})]})]})}),e.jsx(vs,{open:I,onOpenChange:L,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",z.size,"  "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:Z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:Oe,onOpenChange:X,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsxs(xs,{className:"flex items-center gap-2",children:[e.jsx(Yt,{className:"h-5 w-5 text-amber-500"}),""]}),e.jsx(hs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-foreground",children:""}),""]}),e.jsxs("ul",{className:"space-y-2 ml-4 list-disc text-muted-foreground",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"text-foreground font-medium",children:""})]})})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:Hs,children:""}),e.jsx(fs,{onClick:De,className:"bg-amber-600 hover:bg-amber-700",children:""})]})]})}),e.jsx(X1,{open:ee,onOpenChange:R,value:C?.extra_params||{},onChange:re=>M(he=>he?{...he,extra_params:re}:null)}),e.jsx(Qn,{})]})})}const nc=Wg,rc=G0,ic=V0,nd="/api/webui/config";async function NS(){const n=await(await we(`${nd}/adapter-config/path`)).json();return!n.success||!n.path?null:{path:n.path,lastModified:n.lastModified}}async function Sg(l){const i=await(await we(`${nd}/adapter-config/path`,{method:"POST",headers:Fs(),body:JSON.stringify({path:l})})).json();if(!i.success)throw new Error(i.message||"")}async function kg(l){const i=await(await we(`${nd}/adapter-config?path=${encodeURIComponent(l)}`)).json();if(!i.success)throw new Error("");return i.content}async function Cg(l,n){const c=await(await we(`${nd}/adapter-config`,{method:"POST",headers:Fs(),body:JSON.stringify({path:l,content:n})})).json();if(!c.success)throw new Error(c.message||"")}const vt={inner:{version:"0.1.2"},nickname:{nickname:""},napcat_server:{host:"localhost",port:8095,token:"",heartbeat_interval:30},maibot_server:{host:"localhost",port:8e3},chat:{group_list_type:"whitelist",group_list:[],private_list_type:"whitelist",private_list:[],ban_user_id:[],ban_qq_bot:!1,enable_poke:!0},voice:{use_tts:!1},debug:{level:"INFO"}},Mm={oneclick:{name:"",description:"",path:"../MaiBot-Napcat-Adapter/config.toml",icon:la},docker:{name:"Docker",description:"Docker Compose ",path:"/MaiMBot/adapters-config/config.toml",icon:Jw}};function bS(l,n){let i=l.slice(0,n).split(/\r\n|\n|\r/g);return[i.length,i.pop().length+1]}function yS(l,n,i){let c=l.split(/\r\n|\n|\r/g),u="",x=(Math.log10(n+1)|0)+1;for(let h=n-1;h<=n+1;h++){let f=c[h-1];f&&(u+=h.toString().padEnd(x," "),u+=":  ",u+=f,u+=`
`,h===n&&(u+=" ".repeat(x+i+2),u+=`^
`))}return u}class ks extends Error{line;column;codeblock;constructor(n,i){const[c,u]=bS(i.toml,i.ptr),x=yS(i.toml,c,u);super(`Invalid TOML document: ${n}

${x}`,i),this.line=c,this.column=u,this.codeblock=x}}function wS(l,n){let i=0;for(;l[n-++i]==="\\";);return--i&&i%2}function Ho(l,n=0,i=l.length){let c=l.indexOf(`
`,n);return l[c-1]==="\r"&&c--,c<=i?c:-1}function tx(l,n){for(let i=n;i<l.length;i++){let c=l[i];if(c===`
`)return i;if(c==="\r"&&l[i+1]===`
`)return i+1;if(c<" "&&c!=="	"||c==="")throw new ks("control characters are not allowed in comments",{toml:l,ptr:n})}return l.length}function Al(l,n,i,c){let u;for(;(u=l[n])===" "||u==="	"||!i&&(u===`
`||u==="\r"&&l[n+1]===`
`);)n++;return c||u!=="#"?n:Al(l,tx(l,n),i)}function Tg(l,n,i,c,u=!1){if(!c)return n=Ho(l,n),n<0?l.length:n;for(let x=n;x<l.length;x++){let h=l[x];if(h==="#")x=Ho(l,x);else{if(h===i)return x+1;if(h===c||u&&(h===`
`||h==="\r"&&l[x+1]===`
`))return x}}throw new ks("cannot find end of structure",{toml:l,ptr:n})}function bv(l,n){let i=l[n],c=i===l[n+1]&&l[n+1]===l[n+2]?l.slice(n,n+3):i;n+=c.length-1;do n=l.indexOf(c,++n);while(n>-1&&i!=="'"&&wS(l,n));return n>-1&&(n+=c.length,c.length>1&&(l[n]===i&&n++,l[n]===i&&n++)),n}let _S=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i;class Ir extends Date{#s=!1;#t=!1;#e=null;constructor(n){let i=!0,c=!0,u="Z";if(typeof n=="string"){let x=n.match(_S);x?(x[1]||(i=!1,n=`0000-01-01T${n}`),c=!!x[2],c&&n[10]===" "&&(n=n.replace(" ","T")),x[2]&&+x[2]>23?n="":(u=x[3]||null,n=n.toUpperCase(),!u&&c&&(n+="Z"))):n=""}super(n),isNaN(this.getTime())||(this.#s=i,this.#t=c,this.#e=u)}isDateTime(){return this.#s&&this.#t}isLocal(){return!this.#s||!this.#t||!this.#e}isDate(){return this.#s&&!this.#t}isTime(){return this.#t&&!this.#s}isValid(){return this.#s||this.#t}toISOString(){let n=super.toISOString();if(this.isDate())return n.slice(0,10);if(this.isTime())return n.slice(11,23);if(this.#e===null)return n.slice(0,-1);if(this.#e==="Z")return n;let i=+this.#e.slice(1,3)*60+ +this.#e.slice(4,6);return i=this.#e[0]==="-"?i:-i,new Date(this.getTime()-i*6e4).toISOString().slice(0,-1)+this.#e}static wrapAsOffsetDateTime(n,i="Z"){let c=new Ir(n);return c.#e=i,c}static wrapAsLocalDateTime(n){let i=new Ir(n);return i.#e=null,i}static wrapAsLocalDate(n){let i=new Ir(n);return i.#t=!1,i.#e=null,i}static wrapAsLocalTime(n){let i=new Ir(n);return i.#s=!1,i.#e=null,i}}let SS=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,kS=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,CS=/^[+-]?0[0-9_]/,TS=/^[0-9a-f]{4,8}$/i,Eg={b:"\b",t:"	",n:`
`,f:"\f",r:"\r",'"':'"',"\\":"\\"};function yv(l,n=0,i=l.length){let c=l[n]==="'",u=l[n++]===l[n]&&l[n]===l[n+1];u&&(i-=2,l[n+=2]==="\r"&&n++,l[n]===`
`&&n++);let x=0,h,f="",p=n;for(;n<i-1;){let g=l[n++];if(g===`
`||g==="\r"&&l[n]===`
`){if(!u)throw new ks("newlines are not allowed in strings",{toml:l,ptr:n-1})}else if(g<" "&&g!=="	"||g==="")throw new ks("control characters are not allowed in strings",{toml:l,ptr:n-1});if(h){if(h=!1,g==="u"||g==="U"){let N=l.slice(n,n+=g==="u"?4:8);if(!TS.test(N))throw new ks("invalid unicode escape",{toml:l,ptr:x});try{f+=String.fromCodePoint(parseInt(N,16))}catch{throw new ks("invalid unicode escape",{toml:l,ptr:x})}}else if(u&&(g===`
`||g===" "||g==="	"||g==="\r")){if(n=Al(l,n-1,!0),l[n]!==`
`&&l[n]!=="\r")throw new ks("invalid escape: only line-ending whitespace may be escaped",{toml:l,ptr:x});n=Al(l,n)}else if(g in Eg)f+=Eg[g];else throw new ks("unrecognized escape sequence",{toml:l,ptr:x});p=n}else!c&&g==="\\"&&(x=n-1,h=!0,f+=l.slice(p,x))}return f+l.slice(p,i-1)}function ES(l,n,i,c){if(l==="true")return!0;if(l==="false")return!1;if(l==="-inf")return-1/0;if(l==="inf"||l==="+inf")return 1/0;if(l==="nan"||l==="+nan"||l==="-nan")return NaN;if(l==="-0")return c?0n:0;let u=SS.test(l);if(u||kS.test(l)){if(CS.test(l))throw new ks("leading zeroes are not allowed",{toml:n,ptr:i});l=l.replace(/_/g,"");let h=+l;if(isNaN(h))throw new ks("invalid number",{toml:n,ptr:i});if(u){if((u=!Number.isSafeInteger(h))&&!c)throw new ks("integer value cannot be represented losslessly",{toml:n,ptr:i});(u||c===!0)&&(h=BigInt(l))}return h}const x=new Ir(l);if(!x.isValid())throw new ks("invalid value",{toml:n,ptr:i});return x}function MS(l,n,i,c){let u=l.slice(n,i),x=u.indexOf("#");x>-1&&(tx(l,x),u=u.slice(0,x));let h=u.trimEnd();if(!c){let f=u.indexOf(`
`,h.length);if(f>-1)throw new ks("newlines are not allowed in inline tables",{toml:l,ptr:n+f})}return[h,x]}function ax(l,n,i,c,u){if(c===0)throw new ks("document contains excessively nested structures. aborting.",{toml:l,ptr:n});let x=l[n];if(x==="["||x==="{"){let[p,g]=x==="["?OS(l,n,c,u):zS(l,n,c,u),N=i?Tg(l,g,",",i):g;if(g-N&&i==="}"){let v=Ho(l,g,N);if(v>-1)throw new ks("newlines are not allowed in inline tables",{toml:l,ptr:v})}return[p,N]}let h;if(x==='"'||x==="'"){h=bv(l,n);let p=yv(l,n,h);if(i){if(h=Al(l,h,i!=="]"),l[h]&&l[h]!==","&&l[h]!==i&&l[h]!==`
`&&l[h]!=="\r")throw new ks("unexpected character encountered",{toml:l,ptr:h});h+=+(l[h]===",")}return[p,h]}h=Tg(l,n,",",i);let f=MS(l,n,h-+(l[h-1]===","),i==="]");if(!f[0])throw new ks("incomplete key-value declaration: no value specified",{toml:l,ptr:n});return i&&f[1]>-1&&(h=Al(l,n+f[1]),h+=+(l[h]===",")),[ES(f[0],l,n,u),h]}let AS=/^[a-zA-Z0-9-_]+[ \t]*$/;function Hm(l,n,i="="){let c=n-1,u=[],x=l.indexOf(i,n);if(x<0)throw new ks("incomplete key-value: cannot find end of key",{toml:l,ptr:n});do{let h=l[n=++c];if(h!==" "&&h!=="	")if(h==='"'||h==="'"){if(h===l[n+1]&&h===l[n+2])throw new ks("multiline strings are not allowed in keys",{toml:l,ptr:n});let f=bv(l,n);if(f<0)throw new ks("unfinished string encountered",{toml:l,ptr:n});c=l.indexOf(".",f);let p=l.slice(f,c<0||c>x?x:c),g=Ho(p);if(g>-1)throw new ks("newlines are not allowed in keys",{toml:l,ptr:n+c+g});if(p.trimStart())throw new ks("found extra tokens after the string part",{toml:l,ptr:f});if(x<f&&(x=l.indexOf(i,f),x<0))throw new ks("incomplete key-value: cannot find end of key",{toml:l,ptr:n});u.push(yv(l,n,f))}else{c=l.indexOf(".",n);let f=l.slice(n,c<0||c>x?x:c);if(!AS.test(f))throw new ks("only letter, numbers, dashes and underscores are allowed in keys",{toml:l,ptr:n});u.push(f.trimEnd())}}while(c+1&&c<x);return[u,Al(l,x+1,!0,!0)]}function zS(l,n,i,c){let u={},x=new Set,h,f=0;for(n++;(h=l[n++])!=="}"&&h;){let p={toml:l,ptr:n-1};if(h===`
`)throw new ks("newlines are not allowed in inline tables",p);if(h==="#")throw new ks("inline tables cannot contain comments",p);if(h===",")throw new ks("expected key-value, found comma",p);if(h!==" "&&h!=="	"){let g,N=u,v=!1,[y,w]=Hm(l,n-1);for(let A=0;A<y.length;A++){if(A&&(N=v?N[g]:N[g]={}),g=y[A],(v=Object.hasOwn(N,g))&&(typeof N[g]!="object"||x.has(N[g])))throw new ks("trying to redefine an already defined value",{toml:l,ptr:n});!v&&g==="__proto__"&&Object.defineProperty(N,g,{enumerable:!0,configurable:!0,writable:!0})}if(v)throw new ks("trying to redefine an already defined value",{toml:l,ptr:n});let[b,O]=ax(l,w,"}",i-1,c);x.add(b),N[g]=b,n=O,f=l[n-1]===","?n-1:0}}if(f)throw new ks("trailing commas are not allowed in inline tables",{toml:l,ptr:f});if(!h)throw new ks("unfinished table encountered",{toml:l,ptr:n});return[u,n]}function OS(l,n,i,c){let u=[],x;for(n++;(x=l[n++])!=="]"&&x;){if(x===",")throw new ks("expected value, found comma",{toml:l,ptr:n-1});if(x==="#")n=tx(l,n);else if(x!==" "&&x!=="	"&&x!==`
`&&x!=="\r"){let h=ax(l,n-1,"]",i-1,c);u.push(h[0]),n=h[1]}}if(!x)throw new ks("unfinished array encountered",{toml:l,ptr:n});return[u,n]}function Mg(l,n,i,c){let u=n,x=i,h,f=!1,p;for(let g=0;g<l.length;g++){if(g){if(u=f?u[h]:u[h]={},x=(p=x[h]).c,c===0&&(p.t===1||p.t===2))return null;if(p.t===2){let N=u.length-1;u=u[N],x=x[N].c}}if(h=l[g],(f=Object.hasOwn(u,h))&&x[h]?.t===0&&x[h]?.d)return null;f||(h==="__proto__"&&(Object.defineProperty(u,h,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(x,h,{enumerable:!0,configurable:!0,writable:!0})),x[h]={t:g<l.length-1&&c===2?3:c,d:!1,i:0,c:{}})}if(p=x[h],p.t!==c&&!(c===1&&p.t===3)||(c===2&&(p.d||(p.d=!0,u[h]=[]),u[h].push(u={}),p.c[p.i++]=p={t:1,d:!1,i:0,c:{}}),p.d))return null;if(p.d=!0,c===1)u=f?u[h]:u[h]={};else if(c===0&&f)return null;return[h,u,p.c]}function wv(l,{maxDepth:n=1e3,integersAsBigInt:i}={}){let c={},u={},x=c,h=u;for(let f=Al(l,0);f<l.length;){if(l[f]==="["){let p=l[++f]==="[",g=Hm(l,f+=+p,"]");if(p){if(l[g[1]-1]!=="]")throw new ks("expected end of table declaration",{toml:l,ptr:g[1]-1});g[1]++}let N=Mg(g[0],c,u,p?2:1);if(!N)throw new ks("trying to redefine an already defined table or value",{toml:l,ptr:f});h=N[2],x=N[1],f=g[1]}else{let p=Hm(l,f),g=Mg(p[0],x,h,0);if(!g)throw new ks("trying to redefine an already defined table or value",{toml:l,ptr:f});let N=ax(l,p[1],void 0,n,i);g[1][g[0]]=N[0],f=N[1]}if(f=Al(l,f,!0),l[f]&&l[f]!==`
`&&l[f]!=="\r")throw new ks("each key-value declaration must be followed by an end-of-line",{toml:l,ptr:f});f=Al(l,f)}return c}let _v=/^[a-z0-9-_]+$/i;function dc(l){let n=typeof l;if(n==="object"){if(Array.isArray(l))return"array";if(l instanceof Date)return"date"}return n}function DS(l){for(let n=0;n<l.length;n++)if(dc(l[n])!=="object")return!1;return l.length!=0}function lx(l){return JSON.stringify(l).replace(/\x7f/g,"\\u007f")}function nx(l,n,i,c){if(i===0)throw new Error("Could not stringify the object: maximum object depth exceeded");if(n==="number")return isNaN(l)?"nan":l===1/0?"inf":l===-1/0?"-inf":c&&Number.isInteger(l)?l.toFixed(1):l.toString();if(n==="bigint"||n==="boolean")return l.toString();if(n==="string")return lx(l);if(n==="date"){if(isNaN(l.getTime()))throw new TypeError("cannot serialize invalid date");return l.toISOString()}if(n==="object")return RS(l,i,c);if(n==="array")return LS(l,i,c)}function RS(l,n,i){let c=Object.keys(l);if(c.length===0)return"{}";let u="{ ";for(let x=0;x<c.length;x++){let h=c[x];x&&(u+=", "),u+=_v.test(h)?h:lx(h),u+=" = ",u+=nx(l[h],dc(l[h]),n-1,i)}return u+" }"}function LS(l,n,i){if(l.length===0)return"[]";let c="[ ";for(let u=0;u<l.length;u++){if(u&&(c+=", "),l[u]===null||l[u]===void 0)throw new TypeError("arrays cannot contain null or undefined values");c+=nx(l[u],dc(l[u]),n-1,i)}return c+" ]"}function US(l,n,i,c){if(i===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let u="";for(let x=0;x<l.length;x++)u+=`${u&&`
`}[[${n}]]
`,u+=rx(0,l[x],n,i,c);return u}function rx(l,n,i,c,u){if(c===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let x="",h="",f=Object.keys(n);for(let p=0;p<f.length;p++){let g=f[p];if(n[g]!==null&&n[g]!==void 0){let N=dc(n[g]);if(N==="symbol"||N==="function")throw new TypeError(`cannot serialize values of type '${N}'`);let v=_v.test(g)?g:lx(g);if(N==="array"&&DS(n[g]))h+=(h&&`
`)+US(n[g],i?`${i}.${v}`:v,c-1,u);else if(N==="object"){let y=i?`${i}.${v}`:v;h+=(h&&`
`)+rx(y,n[g],y,c-1,u)}else x+=v,x+=" = ",x+=nx(n[g],N,c,u),x+=`
`}}return l&&(x||!h)&&(x=x?`[${l}]
${x}`:`[${l}]`),x&&h?`${x}
${h}`:x||h}function $S(l,{maxDepth:n=1e3,numbersAsFloat:i=!1}={}){if(dc(l)!=="object")throw new TypeError("stringify can only be called with an object");let c=rx(0,l,"",n,i);return c[c.length-1]!==`
`?c+`
`:c}function Am(l){try{const n=wv(l);return{inner:{...vt.inner,...n.inner},nickname:{...vt.nickname,...n.nickname},napcat_server:{...vt.napcat_server,...n.napcat_server},maibot_server:{...vt.maibot_server,...n.maibot_server},chat:{...vt.chat,...n.chat},voice:{...vt.voice,...n.voice},debug:{...vt.debug,...n.debug}}}catch(n){throw console.error("TOML :",n),new Error(` TOML : ${n instanceof Error?n.message:""}`)}}function zm(l){try{const n=(u,x)=>u===""||u===null||u===void 0?x:u,i={inner:{version:n(l.inner.version,vt.inner.version)},nickname:{nickname:n(l.nickname.nickname,vt.nickname.nickname)},napcat_server:{host:n(l.napcat_server.host,vt.napcat_server.host),port:n(l.napcat_server.port||0,vt.napcat_server.port),token:n(l.napcat_server.token,vt.napcat_server.token),heartbeat_interval:n(l.napcat_server.heartbeat_interval||0,vt.napcat_server.heartbeat_interval)},maibot_server:{host:n(l.maibot_server.host,vt.maibot_server.host),port:n(l.maibot_server.port||0,vt.maibot_server.port)},chat:{group_list_type:n(l.chat.group_list_type,vt.chat.group_list_type),group_list:l.chat.group_list||[],private_list_type:n(l.chat.private_list_type,vt.chat.private_list_type),private_list:l.chat.private_list||[],ban_user_id:l.chat.ban_user_id||[],ban_qq_bot:l.chat.ban_qq_bot??vt.chat.ban_qq_bot,enable_poke:l.chat.enable_poke??vt.chat.enable_poke},voice:{use_tts:l.voice.use_tts??vt.voice.use_tts},debug:{level:n(l.debug.level,vt.debug.level)}};let c=$S(i);return c=BS(c),c}catch(n){throw console.error("TOML :",n),new Error(` TOML : ${n instanceof Error?n.message:""}`)}}function BS(l){const n=l.split(`
`),i=[];for(let c=0;c<n.length;c++){const u=n[c];if(u==="[inner]"){i.push(u);continue}if(u.startsWith("version = ")){i.push(`${u} # `),i.push("# ");continue}if(u==="[nickname]"){i.push("[nickname] # ");continue}if(u==="[napcat_server]"){i.push("[napcat_server] # Napcatws");continue}if(u.startsWith("host = ")&&i[i.length-1]?.includes("[napcat_server]")){i.push(`${u}      # Napcat`);continue}if(u.startsWith("port = ")&&n[c-1]?.includes("host")){i.push(`${u}             # Napcat`);continue}if(u.startsWith("token = ")){i.push(`${u}              # Napcat`);continue}if(u.startsWith("heartbeat_interval = ")){i.push(`${u} # Napcat`);continue}if(u==="[maibot_server]"){i.push("[maibot_server] # ws");continue}if(u.startsWith("host = ")&&i[i.length-1]?.includes("[maibot_server]")){i.push(`${u} # .envHOST`);continue}if(u.startsWith("port = ")&&i[i.length-1]?.includes(".env")){i.push(`${u}        # .envPORT`);continue}if(u==="[chat]"){i.push("[chat] # ");continue}if(u.startsWith("group_list_type = ")){i.push(`${u} # whitelist, blacklist`);continue}if(u.startsWith("group_list = ")){i.push(`${u}               # `),i.push("# group_list_typewhitelist"),i.push("# group_list_typeblacklist");continue}if(u.startsWith("private_list_type = ")){i.push(`${u} # whitelist, blacklist`);continue}if(u.startsWith("private_list = ")){i.push(`${u}               # `),i.push("# private_list_typewhitelist"),i.push("# private_list_typeblacklist");continue}if(u.startsWith("ban_user_id = ")){i.push(`${u}   # `);continue}if(u.startsWith("ban_qq_bot = ")){i.push(`${u} # QQ`);continue}if(u.startsWith("enable_poke = ")){i.push(`${u} # `);continue}if(u==="[voice]"){i.push("[voice] # ");continue}if(u.startsWith("use_tts = ")){i.push(`${u} # ttsttsadapter`);continue}if(u.startsWith("level = ")&&i[i.length-1]==="[debug]"){i.push(`${u} # DEBUG, INFO, WARNING, ERROR, CRITICAL`);continue}i.push(u)}return i.join(`
`)}function Om(l){if(!l.trim())return{valid:!1,error:""};if(!l.toLowerCase().endsWith(".toml"))return{valid:!1,error:" .toml "};const n=/^([a-zA-Z]:\\|\\\\[^\\]+\\[^\\]+\\).+\.toml$/i,i=/^(\/|~\/).+\.toml$/i,c=/^(\.{1,2}[\\/]|[^:\\/]).+\.toml$/i,u=n.test(l),x=i.test(l),h=c.test(l);return!u&&!x&&!h?{valid:!1,error:""}:/[<>"|?*\x00-\x1F]/.test(l)?{valid:!1,error:""}:{valid:!0,error:""}}function IS(){const[l,n]=m.useState("upload"),[i,c]=m.useState(null),[u,x]=m.useState(""),[h,f]=m.useState(""),[p,g]=m.useState("oneclick"),[N,v]=m.useState(""),[y,w]=m.useState(!1),[b,O]=m.useState(!1),[A,_]=m.useState(!1),[H,E]=m.useState(!1),[C,M]=m.useState(null),[G,D]=m.useState(!1),ee=m.useRef(null),{toast:R}=st(),me=m.useRef(null),ce=V=>{if(f(V),V.trim()){const xe=Om(V);v(xe.error)}else v("")},ve=m.useCallback(async V=>{const xe=Mm[V];O(!0);try{const Oe=await kg(xe.path),X=Am(Oe);c(X),g(V),f(xe.path),await Sg(xe.path),R({title:"",description:`${xe.name}`})}catch(Oe){console.error(":",Oe),R({title:"",description:Oe instanceof Error?Oe.message:"",variant:"destructive"})}finally{O(!1)}},[R]),se=m.useCallback(async V=>{const xe=Om(V);if(!xe.valid){v(xe.error),R({title:"",description:xe.error,variant:"destructive"});return}v(""),O(!0);try{const Oe=await kg(V),X=Am(Oe);c(X),f(V),await Sg(V),R({title:"",description:""})}catch(Oe){console.error(":",Oe),R({title:"",description:Oe instanceof Error?Oe.message:"",variant:"destructive"})}finally{O(!1)}},[R]);m.useEffect(()=>{(async()=>{try{const xe=await NS();if(xe&&xe.path){f(xe.path);const Oe=Object.entries(Mm).find(([,X])=>X.path===xe.path);Oe?(n("preset"),g(Oe[0]),await ve(Oe[0])):(n("path"),await se(xe.path))}}catch(xe){console.error(":",xe)}})()},[se,ve]);const ge=m.useCallback(V=>{l!=="path"&&l!=="preset"||!h||(me.current&&clearTimeout(me.current),me.current=setTimeout(async()=>{w(!0);try{const xe=zm(V);await Cg(h,xe),R({title:"",description:""})}catch(xe){console.error(":",xe),R({title:"",description:xe instanceof Error?xe.message:"",variant:"destructive"})}finally{w(!1)}},1e3))},[l,h,R]),fe=async()=>{if(!i||!h)return;const V=Om(h);if(!V.valid){R({title:"",description:V.error,variant:"destructive"});return}w(!0);try{const xe=zm(i);await Cg(h,xe),R({title:"",description:""})}catch(xe){console.error(":",xe),R({title:"",description:xe instanceof Error?xe.message:"",variant:"destructive"})}finally{w(!1)}},z=async()=>{h&&await se(h)},Q=V=>{if(V!==l){if(i){M(V),_(!0);return}I(V)}},I=V=>{c(null),x(""),v(""),n(V),V==="preset"&&ve("oneclick"),R({title:"",description:{upload:"",path:"",preset:""}[V]})},L=()=>{C&&(I(C),M(null)),_(!1)},B=()=>{if(i){E(!0);return}_e()},_e=()=>{f(""),c(null),v(""),R({title:"",description:""})},je=()=>{_e(),E(!1)},Ce=V=>{const xe=V.target.files?.[0];if(!xe)return;const Oe=new FileReader;Oe.onload=X=>{try{const oe=X.target?.result,Ge=Am(oe);c(Ge),x(xe.name),R({title:"",description:`${xe.name}`})}catch(oe){console.error(":",oe),R({title:"",description:"",variant:"destructive"})}},Oe.readAsText(xe)},K=()=>{if(!i)return;const V=zm(i),xe=new Blob([V],{type:"text/plain;charset=utf-8"}),Oe=URL.createObjectURL(xe),X=document.createElement("a");X.href=Oe,X.download=u||"config.toml",document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(Oe),R({title:"",description:""})},U=()=>{c(JSON.parse(JSON.stringify(vt))),x("config.toml"),R({title:"",description:""})};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" QQ "})]})}),e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg border border-amber-500/50 bg-amber-500/10 text-amber-700 dark:text-amber-400",children:[e.jsx(St,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:" WebUI "})]}),e.jsx(nc,{open:G,onOpenChange:D,children:e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(rc,{asChild:!0,children:e.jsxs(S,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx(Aa,{className:`h-4 w-4 transition-transform duration-200 ${G?"transform rotate-180":""}`}),e.jsx("span",{className:"sr-only",children:""})]})})]})}),e.jsx(ic,{children:e.jsxs(Me,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${l==="preset"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("preset"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(la,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${l==="upload"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("upload"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(ec,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${l==="path"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>Q("path"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(Xw,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})})]}),l==="preset"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(Mm).map(([V,xe])=>{const Oe=xe.icon,X=p===V;return e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-all ${X?"border-primary bg-primary/5":"border-muted hover:border-primary/50"}`,onClick:()=>{g(V),ve(V)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Oe,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:xe.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:xe.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 font-mono break-all",children:xe.path})]})]})},V)})})]}),l==="path"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"config-path",className:"text-sm md:text-base",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(ne,{id:"config-path",value:h,onChange:V=>ce(V.target.value),placeholder:": C:\\Adapter\\config.toml",className:`text-sm ${N?"border-destructive":""}`}),N&&e.jsx("p",{className:"text-xs text-destructive",children:N})]}),e.jsx(S,{onClick:()=>se(h),disabled:b||!h||!!N,className:"w-full sm:w-auto",children:b?e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sm:hidden",children:""}),e.jsx("span",{className:"hidden sm:inline",children:""})]})})]})]}),e.jsxs("details",{className:"rounded-lg bg-muted/50 p-3 group",children:[e.jsxs("summary",{className:"text-xs font-medium cursor-pointer select-none list-none flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx("svg",{className:"h-4 w-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Windows"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"C:\\Adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"D:\\MaiBot\\adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"\\\\server\\share\\config.toml"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Linux"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"/opt/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"/home/user/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"~/adapter/config.toml"})]})]}),e.jsx("p",{className:"pt-1 border-t text-[10px] md:text-xs",children:"  1 "})]})]})]})]})})]})}),e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx(nt,{children:l==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]}):l==="upload"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""}),"      "]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]})})]}),l==="upload"&&!i&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx("input",{ref:ee,type:"file",accept:".toml",className:"hidden",onChange:Ce}),e.jsxs(S,{onClick:()=>ee.current?.click(),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(ec,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(S,{onClick:U,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(ka,{className:"mr-2 h-4 w-4"}),""]})]}),l==="upload"&&i&&e.jsx("div",{className:"flex gap-2",children:e.jsxs(S,{onClick:K,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Zt,{className:"mr-2 h-4 w-4"}),""]})}),(l==="preset"||l==="path")&&i&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(S,{onClick:fe,size:"sm",disabled:y||!!N,className:"w-full sm:w-auto",children:[e.jsx(oc,{className:"mr-2 h-4 w-4"}),y?"...":""]}),e.jsxs(S,{onClick:z,size:"sm",variant:"outline",disabled:b,className:"w-full sm:w-auto",children:[e.jsx(ft,{className:`mr-2 h-4 w-4 ${b?"animate-spin":""}`}),""]}),l==="path"&&e.jsxs(S,{onClick:B,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ns,{className:"mr-2 h-4 w-4"}),""]})]}),i?e.jsxs(ra,{defaultValue:"napcat",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(ea,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:grid-cols-5",children:[e.jsxs(ts,{value:"napcat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Napcat "}),e.jsx("span",{className:"sm:hidden",children:"Napcat"})]}),e.jsxs(ts,{value:"maibot",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(ts,{value:"chat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(ts,{value:"voice",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(ts,{value:"debug",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:""})]})}),e.jsx(ys,{value:"napcat",className:"space-y-4",children:e.jsx(PS,{config:i,onChange:V=>{c(V),ge(V)}})}),e.jsx(ys,{value:"maibot",className:"space-y-4",children:e.jsx(HS,{config:i,onChange:V=>{c(V),ge(V)}})}),e.jsx(ys,{value:"chat",className:"space-y-4",children:e.jsx(FS,{config:i,onChange:V=>{c(V),ge(V)}})}),e.jsx(ys,{value:"voice",className:"space-y-4",children:e.jsx(GS,{config:i,onChange:V=>{c(V),ge(V)}})}),e.jsx(ys,{value:"debug",className:"space-y-4",children:e.jsx(VS,{config:i,onChange:V=>{c(V),ge(V)}})})]}):e.jsx("div",{className:"rounded-lg border bg-card p-6 md:p-12",children:e.jsxs("div",{className:"text-center space-y-3 md:space-y-4",children:[e.jsx(ka,{className:"h-12 w-12 md:h-16 md:w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-2 px-4",children:l==="preset"?"":l==="upload"?"":""})]})]})}),e.jsx(vs,{open:A,onOpenChange:_,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-destructive font-medium",children:""})]})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>{_(!1),M(null)},children:""}),e.jsx(fs,{onClick:L,children:""})]})]})}),e.jsx(vs,{open:H,onOpenChange:E,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground text-sm",children:""})]})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>E(!1),children:""}),e.jsx(fs,{onClick:je,className:"bg-destructive hover:bg-destructive/90",children:""})]})]})})]})})}function PS({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:"Napcat WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-host",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"napcat-host",value:l.napcat_server.host,onChange:i=>n({...l,napcat_server:{...l.napcat_server,host:i.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-port",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"napcat-port",type:"number",value:l.napcat_server.port||"",onChange:i=>n({...l,napcat_server:{...l.napcat_server,port:i.target.value?parseInt(i.target.value):0}}),placeholder:"8095",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat  8095"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-token",className:"text-sm md:text-base",children:"Token"}),e.jsx(ne,{id:"napcat-token",type:"password",value:l.napcat_server.token,onChange:i=>n({...l,napcat_server:{...l.napcat_server,token:i.target.value}}),placeholder:"",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-heartbeat",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"napcat-heartbeat",type:"number",value:l.napcat_server.heartbeat_interval||"",onChange:i=>n({...l,napcat_server:{...l.napcat_server,heartbeat_interval:i.target.value?parseInt(i.target.value):0}}),placeholder:"30",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Napcat  30"})]})]})]})})}function HS({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:" WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-host",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"maibot-host",value:l.maibot_server.host,onChange:i=>n({...l,maibot_server:{...l.maibot_server,host:i.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  HOST "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-port",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"maibot-port",type:"number",value:l.maibot_server.port||"",onChange:i=>n({...l,maibot_server:{...l.maibot_server,port:i.target.value?parseInt(i.target.value):0}}),placeholder:"8000",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  PORT  8000"})]})]})]})})}function FS({config:l,onChange:n}){const i=x=>{const h={...l};x==="group"?h.chat.group_list=[...h.chat.group_list,0]:x==="private"?h.chat.private_list=[...h.chat.private_list,0]:h.chat.ban_user_id=[...h.chat.ban_user_id,0],n(h)},c=(x,h)=>{const f={...l};x==="group"?f.chat.group_list=f.chat.group_list.filter((p,g)=>g!==h):x==="private"?f.chat.private_list=f.chat.private_list.filter((p,g)=>g!==h):f.chat.ban_user_id=f.chat.ban_user_id.filter((p,g)=>g!==h),n(f)},u=(x,h,f)=>{const p={...l};x==="group"?p.chat.group_list[h]=f:x==="private"?p.chat.private_list[h]=f:p.chat.ban_user_id[h]=f,n(p)};return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"grid gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:l.chat.group_list_type,onValueChange:x=>n({...l,chat:{...l.chat,group_list_type:x}}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"whitelist",children:""}),e.jsx(W,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(S,{onClick:()=>i("group"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(ka,{className:"mr-1 h-4 w-4"}),""]})]}),l.chat.group_list.map((x,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{type:"number",value:x,onChange:f=>u("group",h,parseInt(f.target.value)||0),placeholder:"",className:"text-sm md:text-base"}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",x," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>c("group",h),children:""})]})]})]})]},h)),l.chat.group_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:l.chat.private_list_type,onValueChange:x=>n({...l,chat:{...l.chat,private_list_type:x}}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"whitelist",children:""}),e.jsx(W,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(S,{onClick:()=>i("private"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(ka,{className:"mr-1 h-4 w-4"}),""]})]}),l.chat.private_list.map((x,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{type:"number",value:x,onChange:f=>u("private",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",x," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>c("private",h),children:""})]})]})]})]},h)),l.chat.private_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(S,{onClick:()=>i("ban"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(ka,{className:"mr-1 h-4 w-4"}),""]})]}),l.chat.ban_user_id.map((x,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{type:"number",value:x,onChange:f=>u("ban",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(vs,{children:[e.jsx(bt,{asChild:!0,children:e.jsx(S,{size:"icon",variant:"outline",children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",x," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>c("ban",h),children:""})]})]})]})]},h)),l.chat.ban_user_id.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:"QQ"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"QQ"})]}),e.jsx(Fe,{checked:l.chat.ban_qq_bot,onCheckedChange:x=>n({...l,chat:{...l.chat,ban_qq_bot:x}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Fe,{checked:l.chat.enable_poke,onCheckedChange:x=>n({...l,chat:{...l.chat,enable_poke:x}})})]})]})]})})}function GS({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:" TTS "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" TTS "})]}),e.jsx(Fe,{checked:l.voice.use_tts,onCheckedChange:i=>n({...l,voice:{use_tts:i}})})]})]})})}function VS({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:l.debug.level,onValueChange:i=>n({...l,debug:{level:i}}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"DEBUG",children:"DEBUG"}),e.jsx(W,{value:"INFO",children:"INFO"}),e.jsx(W,{value:"WARNING",children:"WARNING"}),e.jsx(W,{value:"ERROR",children:"ERROR"}),e.jsx(W,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})})]})})}const qS=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],KS=/^(aria-|data-)/,Sv=l=>Object.fromEntries(Object.entries(l).filter(([n])=>KS.test(n)||qS.includes(n)));function QS(l,n){const i=Sv(l);return Object.keys(l).some(c=>!Object.hasOwn(i,c)&&l[c]!==n[c])}class YS extends m.Component{container;plugin;componentDidMount(){this.installPlugin()}componentDidUpdate(n){if(n.uppy!==this.props.uppy)this.uninstallPlugin(n),this.installPlugin();else if(QS(this.props,n)){const{uppy:i,...c}={...this.props,target:this.container};this.plugin.setOptions(c)}}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{uppy:n,...i}={id:"Dashboard",...this.props,inline:!0,target:this.container};n.use(z_,i),this.plugin=n.getPlugin(i.id)}uninstallPlugin(n=this.props){const{uppy:i}=n;i.removePlugin(this.plugin)}render(){return m.createElement("div",{className:"uppy-Container",ref:n=>{this.container=n},...Sv(this.props)})}}function JS({src:l,alt:n="",className:i,maxRetries:c=5,retryInterval:u=1500}){const[x,h]=m.useState("loading"),[f,p]=m.useState(0),[g,N]=m.useState(null),[v,y]=m.useState(l);l!==v&&(h("loading"),p(0),N(null),y(l));const w=m.useCallback(async()=>{try{const b=await fetch(l,{credentials:"include"});if(b.status===202){h("generating"),f<c?setTimeout(()=>{p(_=>_+1)},u):h("error");return}if(!b.ok){h("error");return}const O=await b.blob(),A=URL.createObjectURL(O);N(A),h("loaded")}catch(b){console.error(":",b),h("error")}},[l,f,c,u]);return m.useEffect(()=>{w()},[w]),m.useEffect(()=>()=>{g&&URL.revokeObjectURL(g)},[g]),x==="loading"||x==="generating"?e.jsx(js,{className:P("w-full h-full",i)}):x==="error"||!g?e.jsx("div",{className:P("w-full h-full flex items-center justify-center bg-muted",i),children:e.jsx(Jm,{className:"h-8 w-8 text-muted-foreground"})}):e.jsx("img",{src:g,alt:n,className:P("w-full h-full object-contain",i)})}function XS({children:l,className:n}){return e.jsx(ex,{content:l,className:n})}const Ga="/api/webui/emoji";async function ZS(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.is_registered!==void 0&&n.append("is_registered",l.is_registered.toString()),l.is_banned!==void 0&&n.append("is_banned",l.is_banned.toString()),l.format&&n.append("format",l.format),l.sort_by&&n.append("sort_by",l.sort_by),l.sort_order&&n.append("sort_order",l.sort_order);const i=await we(`${Ga}/list?${n}`,{});if(!i.ok)throw new Error(`: ${i.statusText}`);return i.json()}async function WS(l){const n=await we(`${Ga}/${l}`,{});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function e4(l,n){const i=await we(`${Ga}/${l}`,{method:"PATCH",body:JSON.stringify(n)});if(!i.ok)throw new Error(`: ${i.statusText}`);return i.json()}async function s4(l){const n=await we(`${Ga}/${l}`,{method:"DELETE"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function t4(){const l=await we(`${Ga}/stats/summary`,{});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function a4(l){const n=await we(`${Ga}/${l}/register`,{method:"POST"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function l4(l){const n=await we(`${Ga}/${l}/ban`,{method:"POST"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}function n4(l,n=!1){return n?`${Ga}/${l}/thumbnail?original=true`:`${Ga}/${l}/thumbnail`}function r4(l){return`${Ga}/${l}/thumbnail?original=true`}async function i4(l){const n=await we(`${Ga}/batch/delete`,{method:"POST",body:JSON.stringify({emoji_ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}function c4(){return`${Ga}/upload`}function o4(){const[l,n]=m.useState([]),[i,c]=m.useState(null),[u,x]=m.useState(!1),[h,f]=m.useState(1),[p,g]=m.useState(0),[N,v]=m.useState(20),[y,w]=m.useState("all"),[b,O]=m.useState("all"),[A,_]=m.useState("all"),[H,E]=m.useState("usage_count"),[C,M]=m.useState("desc"),[G,D]=m.useState(null),[ee,R]=m.useState(!1),[me,ce]=m.useState(!1),[ve,se]=m.useState(!1),[ge,fe]=m.useState(new Set),[z,Q]=m.useState(!1),[I,L]=m.useState(""),[B,_e]=m.useState("medium"),[je,Ce]=m.useState(!1),{toast:K}=st(),U=m.useCallback(async()=>{try{x(!0);const de=await ZS({page:h,page_size:N,is_registered:y==="all"?void 0:y==="registered",is_banned:b==="all"?void 0:b==="banned",format:A==="all"?void 0:A,sort_by:H,sort_order:C});n(de.data),g(de.total)}catch(de){const Te=de instanceof Error?de.message:"";K({title:"",description:Te,variant:"destructive"})}finally{x(!1)}},[h,N,y,b,A,H,C,K]),V=async()=>{try{const de=await t4();c(de.data)}catch(de){console.error(":",de)}};m.useEffect(()=>{U()},[U]),m.useEffect(()=>{V()},[]);const xe=async de=>{try{const Te=await WS(de.id);D(Te.data),R(!0)}catch(Te){const rs=Te instanceof Error?Te.message:"";K({title:"",description:rs,variant:"destructive"})}},Oe=de=>{D(de),ce(!0)},X=de=>{D(de),se(!0)},oe=async()=>{if(G)try{await s4(G.id),K({title:"",description:""}),se(!1),D(null),U(),V()}catch(de){const Te=de instanceof Error?de.message:"";K({title:"",description:Te,variant:"destructive"})}},Ge=async de=>{try{await a4(de.id),K({title:"",description:""}),U(),V()}catch(Te){const rs=Te instanceof Error?Te.message:"";K({title:"",description:rs,variant:"destructive"})}},Y=async de=>{try{await l4(de.id),K({title:"",description:""}),U(),V()}catch(Te){const rs=Te instanceof Error?Te.message:"";K({title:"",description:rs,variant:"destructive"})}},te=de=>{const Te=new Set(ge);Te.has(de)?Te.delete(de):Te.add(de),fe(Te)},Ue=async()=>{try{const de=await i4(Array.from(ge));K({title:"",description:de.message}),fe(new Set),Q(!1),U(),V()}catch(de){K({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}},Le=()=>{const de=parseInt(I),Te=Math.ceil(p/N);de>=1&&de<=Te?(f(de),L("")):K({title:"",description:`1-${Te}`,variant:"destructive"})},Ae=i?.formats?Object.keys(i.formats):[];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(S,{onClick:()=>Ce(!0),className:"gap-2",children:[e.jsx(ec,{className:"h-4 w-4"}),""]})]}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[i&&e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(Se,{children:e.jsxs(ze,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Re,{className:"text-2xl",children:i.total})]})}),e.jsx(Se,{children:e.jsxs(ze,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Re,{className:"text-2xl text-green-600",children:i.registered})]})}),e.jsx(Se,{children:e.jsxs(ze,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Re,{className:"text-2xl text-red-600",children:i.banned})]})}),e.jsx(Se,{children:e.jsxs(ze,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Re,{className:"text-2xl text-gray-600",children:i.unregistered})]})})]}),e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(Ao,{className:"h-5 w-5"}),""]})}),e.jsxs(Me,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:`${H}-${C}`,onValueChange:de=>{const[Te,rs]=de.split("-");E(Te),M(rs),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"usage_count-desc",children:" ()"}),e.jsx(W,{value:"usage_count-asc",children:" ()"}),e.jsx(W,{value:"register_time-desc",children:" ()"}),e.jsx(W,{value:"register_time-asc",children:" ()"}),e.jsx(W,{value:"record_time-desc",children:" ()"}),e.jsx(W,{value:"record_time-asc",children:" ()"}),e.jsx(W,{value:"last_used_time-desc",children:" ()"}),e.jsx(W,{value:"last_used_time-asc",children:" ()"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:y,onValueChange:de=>{w(de),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"registered",children:""}),e.jsx(W,{value:"unregistered",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:b,onValueChange:de=>{O(de),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"banned",children:""}),e.jsx(W,{value:"unbanned",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:A,onValueChange:de=>{_(de),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),Ae.map(de=>e.jsxs(W,{value:de,children:[de.toUpperCase()," (",i?.formats[de],")"]},de))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[ge.size>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",ge.size," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:B,onValueChange:de=>_e(de),children:[e.jsx($e,{className:"w-24",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"small",children:""}),e.jsx(W,{value:"medium",children:""}),e.jsx(W,{value:"large",children:""})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"emoji-page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:N.toString(),onValueChange:de=>{v(parseInt(de)),f(1),fe(new Set)},children:[e.jsx($e,{id:"emoji-page-size",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"40",children:"40"}),e.jsx(W,{value:"60",children:"60"}),e.jsx(W,{value:"100",children:"100"})]})]}),ge.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>fe(new Set),children:""}),e.jsxs(S,{variant:"destructive",size:"sm",onClick:()=>Q(!0),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs(S,{variant:"outline",size:"sm",onClick:U,disabled:u,children:[e.jsx(ft,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),""]})})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsxs(ws,{children:[" ",p,"  ",h," "]})]}),e.jsxs(Me,{children:[l.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""}):e.jsx("div",{className:`grid gap-3 ${B==="small"?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10":B==="medium"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8":"grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"}`,children:l.map(de=>e.jsxs("div",{className:`group relative rounded-lg border bg-card overflow-hidden hover:ring-2 hover:ring-primary transition-all cursor-pointer ${ge.has(de.id)?"ring-2 ring-primary bg-primary/5":""}`,onClick:()=>te(de.id),children:[e.jsx("div",{className:`absolute top-1 left-1 z-10 transition-opacity ${ge.has(de.id)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${ge.has(de.id)?"bg-primary border-primary text-primary-foreground":"bg-background/80 border-muted-foreground/50"}`,children:ge.has(de.id)&&e.jsx(Wt,{className:"h-3 w-3"})})}),e.jsxs("div",{className:"absolute top-1 right-1 z-10 flex flex-col gap-0.5",children:[de.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600 text-[10px] px-1 py-0",children:""}),de.is_banned&&e.jsx(ke,{variant:"destructive",className:"text-[10px] px-1 py-0",children:""})]}),e.jsx("div",{className:`aspect-square bg-muted flex items-center justify-center overflow-hidden ${B==="small"?"p-1":B==="medium"?"p-2":"p-3"}`,children:e.jsx(JS,{src:n4(de.id),alt:""})}),e.jsxs("div",{className:`border-t bg-card ${B==="small"?"p-1":"p-2"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-1 text-xs text-muted-foreground mb-1",children:[e.jsx(ke,{variant:"outline",className:"text-[10px] px-1 py-0",children:de.format.toUpperCase()}),e.jsxs("span",{className:"font-mono",children:[de.usage_count,""]})]}),e.jsxs("div",{className:`flex gap-1 justify-center opacity-0 group-hover:opacity-100 transition-opacity ${B==="small"?"flex-wrap":""}`,children:[e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Te=>{Te.stopPropagation(),Oe(de)},title:"",children:e.jsx(Gn,{className:"h-3 w-3"})}),e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Te=>{Te.stopPropagation(),xe(de)},title:"",children:e.jsx(Pt,{className:"h-3 w-3"})}),!de.is_registered&&e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-green-700",onClick:Te=>{Te.stopPropagation(),Ge(de)},title:"",children:e.jsx(Wt,{className:"h-3 w-3"})}),!de.is_banned&&e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6 text-orange-600 hover:text-orange-700",onClick:Te=>{Te.stopPropagation(),Y(de)},title:"",children:e.jsx(Zw,{className:"h-3 w-3"})}),e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600 hover:text-red-700",onClick:Te=>{Te.stopPropagation(),X(de)},title:"",children:e.jsx(ns,{className:"h-3 w-3"})})]})]})]},de.id))}),p>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(h-1)*N+1," "," ",Math.min(h*N,p),"  ",p," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(de=>Math.max(1,de-1)),disabled:h===1,children:[e.jsx(Va,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:I,onChange:de=>L(de.target.value),onKeyDown:de=>de.key==="Enter"&&Le(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(p/N)}),e.jsx(S,{variant:"outline",size:"sm",onClick:Le,disabled:!I,className:"h-8",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(de=>de+1),disabled:h>=Math.ceil(p/N),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(p/N)),disabled:h>=Math.ceil(p/N),className:"hidden sm:flex",children:e.jsx(fn,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(d4,{emoji:G,open:ee,onOpenChange:R}),e.jsx(u4,{emoji:G,open:me,onOpenChange:ce,onSuccess:()=>{U(),V()}}),e.jsx(m4,{open:je,onOpenChange:Ce,onSuccess:()=>{U(),V()}})]})}),e.jsx(vs,{open:z,onOpenChange:Q,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",ge.size," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:Ue,children:""})]})]})}),e.jsx(Ps,{open:ve,onOpenChange:se,children:e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>se(!1),children:""}),e.jsx(S,{variant:"destructive",onClick:oe,children:""})]})]})})]})}function d4({emoji:l,open:n,onOpenChange:i}){if(!l)return null;const c=u=>u?new Date(u*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl max-h-[90vh]",children:[e.jsx($s,{children:e.jsx(Bs,{children:""})}),e.jsx(Je,{className:"max-h-[calc(90vh-8rem)] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:r4(l.id),alt:l.description||"",className:"w-full h-full object-cover",onError:u=>{const x=u.target;x.style.display="none";const h=x.parentElement;h&&(h.innerHTML='<svg class="h-16 w-16 text-muted-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>')}})})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:"ID"}),e.jsx("div",{className:"mt-1 font-mono",children:l.id})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",children:l.format.toUpperCase()})})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:l.full_path})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:l.emoji_hash})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),l.description?e.jsx("div",{className:"mt-1 rounded-lg border bg-muted/50 p-3",children:e.jsx(XS,{className:"prose-sm",children:l.description})}):e.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:"-"})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:l.emotion?e.jsx("span",{className:"text-sm",children:l.emotion}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[l.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),l.is_banned&&e.jsx(ke,{variant:"destructive",children:""}),!l.is_registered&&!l.is_banned&&e.jsx(ke,{variant:"outline",children:""})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-lg",children:l.usage_count})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(l.record_time)})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(l.register_time)})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(l.last_used_time)})]})]})})]})})}function u4({emoji:l,open:n,onOpenChange:i,onSuccess:c}){const[u,x]=m.useState(""),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[N,v]=m.useState(!1),{toast:y}=st();m.useEffect(()=>{l&&(x(l.emotion||""),f(l.is_registered),g(l.is_banned))},[l]);const w=async()=>{if(l)try{v(!0);const b=u.split(/[,,]/).map(O=>O.trim()).filter(Boolean).join(",");await e4(l.id,{emotion:b||void 0,is_registered:h,is_banned:p}),y({title:"",description:""}),i(!1),c()}catch(b){const O=b instanceof Error?b.message:"";y({title:"",description:O,variant:"destructive"})}finally{v(!1)}};return l?e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:""}),e.jsx(at,{value:u,onChange:b=>x(b.target.value),placeholder:"...",rows:2,className:"mt-1"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"is_registered",checked:h,onCheckedChange:b=>{b===!0?(f(!0),g(!1)):f(!1)}}),e.jsx(T,{htmlFor:"is_registered",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"is_banned",checked:p,onCheckedChange:b=>{b===!0?(g(!0),f(!1)):g(!1)}}),e.jsx(T,{htmlFor:"is_banned",className:"cursor-pointer",children:""})]})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(S,{onClick:w,disabled:N,children:N?"...":""})]})]})}):null}function m4({open:l,onOpenChange:n,onSuccess:i}){const[c,u]=m.useState("select"),[x,h]=m.useState([]),[f,p]=m.useState(null),[g,N]=m.useState(!1),{toast:v}=st(),y=m.useMemo(()=>new O_({id:"emoji-uploader",autoProceed:!1,restrictions:{maxFileSize:10485760,allowedFileTypes:["image/jpeg","image/png","image/gif","image/webp"],maxNumberOfFiles:20},locale:{pluralize:()=>0,strings:{addMoreFiles:"",addingMoreFiles:"",allowedFileTypes:"%{types}",cancel:"",closeModal:"",complete:"",connectedToInternet:"",copyLink:"",copyLinkToClipboardFallback:"",copyLinkToClipboardSuccess:"",dashboardTitle:"",dashboardWindowTitle:" ESC ",done:"",dropHereOr:" %{browse}",dropHint:"",dropPasteFiles:" %{browseFiles}",dropPasteFolders:" %{browseFolders}",dropPasteBoth:"%{browseFiles}  %{browseFolders}",dropPasteImportFiles:"%{browseFiles} ",dropPasteImportFolders:"%{browseFolders} ",dropPasteImportBoth:"%{browseFiles}%{browseFolders} ",editFile:"",editing:" %{file}",emptyFolderAdded:"",exceedsSize:"%{file}  %{size}",failedToUpload:" %{file} ",fileSource:"%{name}",filesUploadedOfTotal:{0:" %{complete} / %{smart_count} ",1:" %{complete} / %{smart_count} "},filter:"",finishEditingFile:"",folderAdded:{0:" %{folder}  %{smart_count} ",1:" %{folder}  %{smart_count} "},generatingThumbnails:"...",import:"",importFiles:"",importFrom:" %{name} ",loading:"...",logOut:"",myDevice:"",noFilesFound:"",noInternetConnection:"",openFolderNamed:" %{name}",pause:"",pauseUpload:"",paused:"",poweredBy:"%{uppy}",processingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},recording:"",removeFile:"",resetFilter:"",resume:"",resumeUpload:"",retry:"",retryUpload:"",save:"",saveChanges:"",selectFileNamed:" %{name}",selectX:{0:" %{smart_count}",1:" %{smart_count}"},smile:"",startRecording:"",stopRecording:"",takePicture:"",timedOut:" %{seconds} ",upload:"",uploadComplete:"",uploadFailed:"",uploadPaused:"",uploadXFiles:{0:"%{smart_count} ",1:"%{smart_count} "},uploadXNewFiles:{0:"+%{smart_count} ",1:"+%{smart_count} "},uploading:"",uploadingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},xFilesSelected:{0:" %{smart_count} ",1:" %{smart_count} "},xMoreFilesAdded:{0:" %{smart_count} ",1:" %{smart_count} "},xTimeLeft:" %{time}",youCanOnlyUploadFileTypes:"%{types}",youCanOnlyUploadX:{0:" %{smart_count} ",1:" %{smart_count} "},youHaveToAtLeastSelectX:{0:" %{smart_count} ",1:" %{smart_count} "},browseFiles:"",browseFolders:"",cancelUpload:"",addMore:"",back:"",editFileWithFilename:" %{file}"}}}),[]);m.useEffect(()=>{const G=()=>{const D=y.getFiles();if(D.length===0)return;const ee=D.map(R=>({id:R.id,name:R.name,previewUrl:R.preview||URL.createObjectURL(R.data),emotion:"",description:"",isRegistered:!0,file:R.data}));h(ee),D.length===1?(p(ee[0].id),u("edit-single")):u("edit-multiple")};return y.on("upload",G),()=>{y.off("upload",G)}},[y]),m.useEffect(()=>{l||(y.cancelAll(),u("select"),h([]),p(null),N(!1))},[l,y]);const w=m.useCallback((G,D)=>{h(ee=>ee.map(R=>R.id===G?{...R,...D}:R))},[]),b=m.useCallback(G=>G.emotion.trim().length>0,[]),O=m.useMemo(()=>x.length>0&&x.every(b),[x,b]),A=m.useMemo(()=>x.find(G=>G.id===f)||null,[x,f]),_=m.useCallback(()=>{(c==="edit-single"||c==="edit-multiple")&&(u("select"),h([]),p(null))},[c]),H=m.useCallback(async()=>{if(!O){v({title:"",description:"",variant:"destructive"});return}N(!0);let G=0,D=0;try{for(const ee of x){const R=new FormData;R.append("file",ee.file),R.append("emotion",ee.emotion),R.append("description",ee.description),R.append("is_registered",ee.isRegistered.toString());try{(await we(c4(),{method:"POST",body:R})).ok?G++:D++}catch{D++}}D===0?(v({title:"",description:` ${G} `}),n(!1),i()):(v({title:"",description:` ${G}  ${D} `,variant:"destructive"}),i())}finally{N(!1)}},[O,x,v,n,i]),E=()=>e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"border rounded-lg overflow-hidden w-full",children:e.jsx(YS,{uppy:y,proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!0,height:350,width:"100%",theme:"auto",note:" JPGPNGGIFWebP  20 "})})}),C=()=>{const G=x[0];return G?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(S,{variant:"ghost",size:"sm",onClick:_,children:[e.jsx(Ta,{className:"h-4 w-4 mr-1"}),""]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"w-32 h-32 rounded-lg border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:G.previewUrl,alt:G.name,className:"max-w-full max-h-full object-contain"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center truncate max-w-32",children:G.name})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"single-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"single-emotion",value:G.emotion,onChange:D=>w(G.id,{emotion:D.target.value}),placeholder:",",className:G.emotion.trim()?"":"border-destructive"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"single-description",children:""}),e.jsx(ne,{id:"single-description",value:G.description,onChange:D=>w(G.id,{description:D.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"single-is-registered",checked:G.isRegistered,onCheckedChange:D=>w(G.id,{isRegistered:D===!0})}),e.jsx(T,{htmlFor:"single-is-registered",className:"cursor-pointer",children:""})]})]})]}),e.jsx(et,{children:e.jsx(S,{onClick:H,disabled:!O||g,children:g?"...":""})})]}):null},M=()=>{const G=x.filter(b).length,D=x.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(S,{variant:"ghost",size:"sm",onClick:_,children:[e.jsx(Ta,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["",G,"/",D," "]})]}),e.jsx(ke,{variant:O?"default":"secondary",children:O?e.jsxs(e.Fragment,{children:[e.jsx(_t,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Ma,{className:"h-3 w-3 mr-1"}),""]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Je,{className:"h-[350px] pr-2",children:e.jsx("div",{className:"space-y-2",children:x.map(ee=>{const R=b(ee),me=f===ee.id;return e.jsxs("div",{onClick:()=>p(ee.id),className:`
                      flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all
                      ${me?"ring-2 ring-primary":""}
                      ${R?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-border hover:border-muted-foreground/50"}
                    `,children:[e.jsx("div",{className:"w-12 h-12 rounded border overflow-hidden bg-muted flex-shrink-0 flex items-center justify-center",children:e.jsx("img",{src:ee.previewUrl,alt:ee.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:ee.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:ee.emotion||""})]}),R?e.jsx(Wt,{className:"h-5 w-5 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-muted-foreground/30 flex-shrink-0"})]},ee.id)})})}),e.jsx("div",{className:"border rounded-lg p-4",children:A?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:A.previewUrl,alt:A.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:A.name}),b(A)&&e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(_t,{className:"h-3 w-3 mr-1"}),""]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"multi-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"multi-emotion",value:A.emotion,onChange:ee=>w(A.id,{emotion:ee.target.value}),placeholder:",",className:A.emotion.trim()?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"multi-description",children:""}),e.jsx(ne,{id:"multi-description",value:A.description,onChange:ee=>w(A.id,{description:ee.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"multi-is-registered",checked:A.isRegistered,onCheckedChange:ee=>w(A.id,{isRegistered:ee===!0})}),e.jsx(T,{htmlFor:"multi-is-registered",className:"cursor-pointer text-sm",children:""})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jm,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:""})]})})})]}),e.jsx(et,{children:e.jsx(S,{onClick:H,disabled:!O||g,children:g?"...":` (${D})`})})]})};return e.jsx(Ps,{open:l,onOpenChange:n,children:e.jsxs(Us,{className:"max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(ec,{className:"h-5 w-5"}),c==="select"&&" - ",c==="edit-single"&&" - ",c==="edit-multiple"&&" - "]}),e.jsxs(Js,{children:[c==="select"&&" JPGPNGGIFWebP  10MB",c==="edit-single"&&"",c==="edit-multiple"&&""]})]}),e.jsxs("div",{className:"overflow-y-auto pr-1",children:[c==="select"&&E(),c==="edit-single"&&C(),c==="edit-multiple"&&M()]})]})})}const jn="/api/webui/expression";async function kv(){const l=await we(`${jn}/chats`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function x4(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.chat_id&&n.append("chat_id",l.chat_id);const i=await we(`${jn}/list?${n}`,{});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function h4(l){const n=await we(`${jn}/${l}`,{});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function f4(l){const n=await we(`${jn}/`,{method:"POST",body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function p4(l,n){const i=await we(`${jn}/${l}`,{method:"PATCH",body:JSON.stringify(n)});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function g4(l){const n=await we(`${jn}/${l}`,{method:"DELETE"});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function j4(l){const n=await we(`${jn}/batch/delete`,{method:"POST",body:JSON.stringify({ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function v4(){const l=await we(`${jn}/stats/summary`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}function N4(){const[l,n]=m.useState([]),[i,c]=m.useState(!0),[u,x]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[N,v]=m.useState(""),[y,w]=m.useState(null),[b,O]=m.useState(!1),[A,_]=m.useState(!1),[H,E]=m.useState(!1),[C,M]=m.useState(null),[G,D]=m.useState(new Set),[ee,R]=m.useState(!1),[me,ce]=m.useState(""),[ve,se]=m.useState({total:0,recent_7days:0,chat_count:0,top_chats:{}}),[ge,fe]=m.useState([]),[z,Q]=m.useState(new Map),{toast:I}=st(),L=async()=>{try{c(!0);const oe=await x4({page:h,page_size:p,search:N||void 0});n(oe.data),x(oe.total)}catch(oe){I({title:"",description:oe instanceof Error?oe.message:"",variant:"destructive"})}finally{c(!1)}},B=async()=>{try{const oe=await v4();oe?.data&&se(oe.data)}catch(oe){console.error(":",oe)}},_e=async()=>{try{const oe=await kv();if(oe?.data){fe(oe.data);const Ge=new Map;oe.data.forEach(Y=>{Ge.set(Y.chat_id,Y.chat_name)}),Q(Ge)}}catch(oe){console.error(":",oe)}},je=oe=>z.get(oe)||oe;m.useEffect(()=>{L(),B(),_e()},[h,p,N]);const Ce=async oe=>{try{const Ge=await h4(oe.id);w(Ge.data),O(!0)}catch(Ge){I({title:"",description:Ge instanceof Error?Ge.message:"",variant:"destructive"})}},K=oe=>{w(oe),_(!0)},U=async oe=>{try{await g4(oe.id),I({title:"",description:`: ${oe.situation}`}),M(null),L(),B()}catch(Ge){I({title:"",description:Ge instanceof Error?Ge.message:"",variant:"destructive"})}},V=oe=>{const Ge=new Set(G);Ge.has(oe)?Ge.delete(oe):Ge.add(oe),D(Ge)},xe=()=>{G.size===l.length&&l.length>0?D(new Set):D(new Set(l.map(oe=>oe.id)))},Oe=async()=>{try{await j4(Array.from(G)),I({title:"",description:` ${G.size} `}),D(new Set),R(!1),L(),B()}catch(oe){I({title:"",description:oe instanceof Error?oe.message:"",variant:"destructive"})}},X=()=>{const oe=parseInt(me),Ge=Math.ceil(u/p);oe>=1&&oe<=Ge?(f(oe),ce("")):I({title:"",description:`1-${Ge}`,variant:"destructive"})};return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ea,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs(S,{onClick:()=>E(!0),className:"gap-2",children:[e.jsx(Zs,{className:"h-4 w-4"}),""]})]})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:ve.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"7"}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:ve.recent_7days})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-blue-600",children:ve.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 mt-1.5",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Dt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{id:"search",placeholder:"...",value:N,onChange:oe=>v(oe.target.value),className:"pl-9"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:G.size>0&&e.jsxs("span",{children:[" ",G.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:oe=>{g(parseInt(oe)),f(1),D(new Set)},children:[e.jsx($e,{id:"page-size",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),G.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>D(new Set),children:""}),e.jsxs(S,{variant:"destructive",size:"sm",onClick:()=>R(!0),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(Ws,{checked:G.size===l.length&&l.length>0,onCheckedChange:xe})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Rl,{children:i?e.jsx(dt,{children:e.jsx(Ke,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"..."})}):l.length===0?e.jsx(dt,{children:e.jsx(Ke,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:""})}):l.map(oe=>e.jsxs(dt,{children:[e.jsx(Ke,{children:e.jsx(Ws,{checked:G.has(oe.id),onCheckedChange:()=>V(oe.id)})}),e.jsx(Ke,{className:"font-medium max-w-xs truncate",children:oe.situation}),e.jsx(Ke,{className:"max-w-xs truncate",children:oe.style}),e.jsx(Ke,{className:"max-w-[200px] truncate",title:je(oe.chat_id),style:{wordBreak:"keep-all"},children:e.jsx("span",{className:"whitespace-nowrap overflow-hidden text-ellipsis block",children:je(oe.chat_id)})}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(S,{variant:"default",size:"sm",onClick:()=>K(oe),children:[e.jsx(Gn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(S,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Ce(oe),title:"",children:e.jsx(na,{className:"h-4 w-4"})}),e.jsxs(S,{size:"sm",onClick:()=>M(oe),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})})]},oe.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):l.map(oe=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ws,{checked:G.has(oe.id),onCheckedChange:()=>V(oe.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 overflow-hidden space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 w-full break-all",title:oe.situation,children:oe.situation})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm line-clamp-2 w-full break-all",title:oe.style,children:oe.style})]})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm truncate",title:je(oe.chat_id),style:{wordBreak:"keep-all"},children:je(oe.chat_id)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>K(oe),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Gn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Ce(oe),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:e.jsx(na,{className:"h-3 w-3"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>M(oe),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),""]})]})]},oe.id))}),u>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",u,"  ",h," / ",Math.ceil(u/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Va,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:me,onChange:oe=>ce(oe.target.value),onKeyDown:oe=>oe.key==="Enter"&&X(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(u/p)}),e.jsx(S,{variant:"outline",size:"sm",onClick:X,disabled:!me,className:"h-8",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(u/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(u/p)),disabled:h>=Math.ceil(u/p),className:"hidden sm:flex",children:e.jsx(fn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(b4,{expression:y,open:b,onOpenChange:O,chatNameMap:z}),e.jsx(y4,{open:H,onOpenChange:E,chatList:ge,onSuccess:()=>{L(),B(),E(!1)}}),e.jsx(w4,{expression:y,open:A,onOpenChange:_,chatList:ge,onSuccess:()=>{L(),B(),_(!1)}}),e.jsx(vs,{open:!!C,onOpenChange:()=>M(null),children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',C?.situation,'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>C&&U(C),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(_4,{open:ee,onOpenChange:R,onConfirm:Oe,count:G.size})]})}function b4({expression:l,open:n,onOpenChange:i,chatNameMap:c}){if(!l)return null;const u=h=>h?new Date(h*1e3).toLocaleString("zh-CN"):"-",x=h=>c.get(h)||h;return e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ii,{label:"",value:l.situation}),e.jsx(Ii,{label:"",value:l.style}),e.jsx(Ii,{label:"",value:x(l.chat_id)}),e.jsx(Ii,{icon:Fr,label:"ID",value:l.id.toString(),mono:!0})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(Ii,{icon:Ca,label:"",value:u(l.create_date)})}),e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-3 block",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:P("flex h-8 w-8 items-center justify-center rounded-full",l.checked?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:l.checked?e.jsx(Wt,{className:"h-5 w-5"}):e.jsx(Lo,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.checked?"AI":""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:P("flex h-8 w-8 items-center justify-center rounded-full",l.rejected?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:l.rejected?e.jsx(Wi,{className:"h-5 w-5"}):e.jsx(Lo,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.rejected?"":""})]})]})]})]})]}),e.jsx(et,{children:e.jsx(S,{onClick:()=>i(!1),children:""})})]})})}function Ii({icon:l,label:n,value:i,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[l&&e.jsx(l,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:P("text-sm",c&&"font-mono",!i&&"text-muted-foreground"),children:i||"-"})]})}function y4({open:l,onOpenChange:n,chatList:i,onSuccess:c}){const[u,x]=m.useState({situation:"",style:"",chat_id:""}),[h,f]=m.useState(!1),{toast:p}=st(),g=async()=>{if(!u.situation||!u.style||!u.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await f4(u),p({title:"",description:""}),x({situation:"",style:"",chat_id:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Ps,{open:l,onOpenChange:n,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"situation",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"situation",value:u.situation,onChange:N=>x({...u,situation:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"style",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"style",value:u.style,onChange:N=>x({...u,style:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Ie,{value:u.chat_id,onValueChange:N=>x({...u,chat_id:N}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:i.map(N=>e.jsx(W,{value:N.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[N.chat_name,N.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},N.chat_id))})]})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>n(!1),children:""}),e.jsx(S,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function w4({expression:l,open:n,onOpenChange:i,chatList:c,onSuccess:u}){const[x,h]=m.useState({}),[f,p]=m.useState(!1),{toast:g}=st();m.useEffect(()=>{l&&h({situation:l.situation,style:l.style,chat_id:l.chat_id,checked:l.checked,rejected:l.rejected})},[l]);const N=async()=>{if(l)try{p(!0),await p4(l.id,x),g({title:"",description:""}),u()}catch(v){g({title:"",description:v instanceof Error?v.message:"",variant:"destructive"})}finally{p(!1)}};return l?e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_situation",children:""}),e.jsx(ne,{id:"edit_situation",value:x.situation||"",onChange:v=>h({...x,situation:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_style",children:""}),e.jsx(ne,{id:"edit_style",value:x.style||"",onChange:v=>h({...x,style:v.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Ie,{value:x.chat_id||"",onValueChange:v=>h({...x,chat_id:v}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:c.map(v=>e.jsx(W,{value:v.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[v.chat_name,v.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},v.chat_id))})]})]}),e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx(nt,{className:"text-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:""})}),e.jsx("p",{children:" AI"}),e.jsx("p",{children:" "}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:['""',e.jsx("br",{}),' "=""="',e.jsx("br",{}),' "="']})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_checked",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AI"})]}),e.jsx(Fe,{id:"edit_checked",checked:x.checked??!1,onCheckedChange:v=>h({...x,checked:v})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_rejected",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"edit_rejected",checked:x.rejected??!1,onCheckedChange:v=>h({...x,rejected:v})})]})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(S,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}function _4({open:l,onOpenChange:n,onConfirm:i,count:c}){return e.jsx(vs,{open:l,onOpenChange:n,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",c," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:i,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})}const Ll="/api/webui/jargon";async function S4(){const l=await we(`${Ll}/chats`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function k4(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.chat_id&&n.append("chat_id",l.chat_id),l.is_jargon!==void 0&&l.is_jargon!==null&&n.append("is_jargon",l.is_jargon.toString()),l.is_global!==void 0&&n.append("is_global",l.is_global.toString());const i=await we(`${Ll}/list?${n}`,{});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function C4(l){const n=await we(`${Ll}/${l}`,{});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function T4(l){const n=await we(`${Ll}/`,{method:"POST",body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function E4(l,n){const i=await we(`${Ll}/${l}`,{method:"PATCH",body:JSON.stringify(n)});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function M4(l){const n=await we(`${Ll}/${l}`,{method:"DELETE"});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function A4(l){const n=await we(`${Ll}/batch/delete`,{method:"POST",body:JSON.stringify({ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function z4(){const l=await we(`${Ll}/stats/summary`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function O4(l,n){const i=new URLSearchParams;l.forEach(u=>i.append("ids",u.toString())),i.append("is_jargon",n.toString());const c=await we(`${Ll}/batch/set-jargon?${i}`,{method:"POST"});if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return c.json()}function D4(){const[l,n]=m.useState([]),[i,c]=m.useState(!0),[u,x]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[N,v]=m.useState(""),[y,w]=m.useState("all"),[b,O]=m.useState("all"),[A,_]=m.useState(null),[H,E]=m.useState(!1),[C,M]=m.useState(!1),[G,D]=m.useState(!1),[ee,R]=m.useState(null),[me,ce]=m.useState(new Set),[ve,se]=m.useState(!1),[ge,fe]=m.useState(""),[z,Q]=m.useState({total:0,confirmed_jargon:0,confirmed_not_jargon:0,pending:0,global_count:0,complete_count:0,chat_count:0,top_chats:{}}),[I,L]=m.useState([]),{toast:B}=st(),_e=async()=>{try{c(!0);const te=await k4({page:h,page_size:p,search:N||void 0,chat_id:y==="all"?void 0:y,is_jargon:b==="all"?void 0:b==="true"?!0:b==="false"?!1:void 0});n(te.data),x(te.total)}catch(te){B({title:"",description:te instanceof Error?te.message:"",variant:"destructive"})}finally{c(!1)}},je=async()=>{try{const te=await z4();te?.data&&Q(te.data)}catch(te){console.error(":",te)}},Ce=async()=>{try{const te=await S4();te?.data&&L(te.data)}catch(te){console.error(":",te)}};m.useEffect(()=>{_e(),je(),Ce()},[h,p,N,y,b]);const K=async te=>{try{const Ue=await C4(te.id);_(Ue.data),E(!0)}catch(Ue){B({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},U=te=>{_(te),M(!0)},V=async te=>{try{await M4(te.id),B({title:"",description:`: ${te.content}`}),R(null),_e(),je()}catch(Ue){B({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},xe=te=>{const Ue=new Set(me);Ue.has(te)?Ue.delete(te):Ue.add(te),ce(Ue)},Oe=()=>{me.size===l.length&&l.length>0?ce(new Set):ce(new Set(l.map(te=>te.id)))},X=async()=>{try{await A4(Array.from(me)),B({title:"",description:` ${me.size} `}),ce(new Set),se(!1),_e(),je()}catch(te){B({title:"",description:te instanceof Error?te.message:"",variant:"destructive"})}},oe=async te=>{try{await O4(Array.from(me),te),B({title:"",description:` ${me.size} ${te?"":""}`}),ce(new Set),_e(),je()}catch(Ue){B({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},Ge=()=>{const te=parseInt(ge),Ue=Math.ceil(u/p);te>=1&&te<=Ue?(f(te),fe("")):B({title:"",description:`1-${Ue}`,variant:"destructive"})},Y=te=>te===!0?e.jsxs(ke,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(_t,{className:"h-3 w-3 mr-1"}),""]}):te===!1?e.jsxs(ke,{variant:"secondary",children:[e.jsx(Ma,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"outline",children:[e.jsx(Mj,{className:"h-3 w-3 mr-1"}),""]});return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ww,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs(S,{onClick:()=>D(!0),className:"gap-2",children:[e.jsx(Zs,{className:"h-4 w-4"}),""]})]})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:z.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-green-600",children:z.confirmed_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-gray-500",children:z.confirmed_not_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-yellow-600",children:z.pending})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-blue-600",children:z.global_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-purple-600",children:z.complete_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:z.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Dt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{id:"search",placeholder:"...",value:N,onChange:te=>v(te.target.value),className:"pl-9"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:y,onValueChange:w,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),I.map(te=>e.jsx(W,{value:te.chat_id,children:te.chat_name},te.chat_id))]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:b,onValueChange:O,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"true",children:""}),e.jsx(W,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"page-size",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:te=>{g(parseInt(te)),f(1),ce(new Set)},children:[e.jsx($e,{id:"page-size",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]})]})]}),me.size>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",me.size," "]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>oe(!0),children:[e.jsx(_t,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>oe(!1),children:[e.jsx(Ma,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>ce(new Set),children:""}),e.jsxs(S,{variant:"destructive",size:"sm",onClick:()=>se(!0),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(Ws,{checked:me.size===l.length&&l.length>0,onCheckedChange:Oe})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-center",children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Rl,{children:i?e.jsx(dt,{children:e.jsx(Ke,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"..."})}):l.length===0?e.jsx(dt,{children:e.jsx(Ke,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:""})}):l.map(te=>e.jsxs(dt,{children:[e.jsx(Ke,{children:e.jsx(Ws,{checked:me.has(te.id),onCheckedChange:()=>xe(te.id)})}),e.jsx(Ke,{className:"font-medium max-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[te.is_global&&e.jsx("span",{title:"",children:e.jsx(Uo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"})}),e.jsx("span",{className:"truncate",title:te.content,children:te.content})]})}),e.jsx(Ke,{className:"max-w-[200px] truncate",title:te.meaning||"",children:te.meaning||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ke,{className:"max-w-[150px] truncate",title:te.chat_name||te.chat_id,children:te.chat_name||te.chat_id}),e.jsx(Ke,{children:Y(te.is_jargon)}),e.jsx(Ke,{className:"text-center",children:te.count}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(S,{variant:"default",size:"sm",onClick:()=>U(te),children:[e.jsx(Gn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(S,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>K(te),title:"",children:e.jsx(na,{className:"h-4 w-4"})}),e.jsxs(S,{size:"sm",onClick:()=>R(te),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})})]},te.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):l.map(te=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ws,{checked:me.has(te.id),onCheckedChange:()=>xe(te.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[te.is_global&&e.jsx(Uo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),e.jsx("h3",{className:"font-semibold text-sm break-all",children:te.content})]}),te.meaning&&e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:te.meaning}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[Y(te.is_jargon),e.jsxs("span",{className:"text-muted-foreground",children:[": ",te.count]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[": ",te.chat_name||te.chat_id]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>U(te),className:"text-xs px-2 py-1 h-auto",children:[e.jsx(Gn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>K(te),className:"text-xs px-2 py-1 h-auto",children:e.jsx(na,{className:"h-3 w-3"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>R(te),className:"text-xs px-2 py-1 h-auto text-destructive hover:text-destructive",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),""]})]})]},te.id))}),u>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",u,"  ",h," / ",Math.ceil(u/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Va,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:ge,onChange:te=>fe(te.target.value),onKeyDown:te=>te.key==="Enter"&&Ge(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(u/p)}),e.jsx(S,{variant:"outline",size:"sm",onClick:Ge,disabled:!ge,className:"h-8",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(u/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(u/p)),disabled:h>=Math.ceil(u/p),className:"hidden sm:flex",children:e.jsx(fn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(R4,{jargon:A,open:H,onOpenChange:E}),e.jsx(L4,{open:G,onOpenChange:D,chatList:I,onSuccess:()=>{_e(),je(),D(!1)}}),e.jsx(U4,{jargon:A,open:C,onOpenChange:M,chatList:I,onSuccess:()=>{_e(),je(),M(!1)}}),e.jsx(vs,{open:!!ee,onOpenChange:()=>R(null),children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',ee?.content,'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>ee&&V(ee),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:ve,onOpenChange:se,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",me.size," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:X,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function R4({jargon:l,open:n,onOpenChange:i}){return l?e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsx(Je,{className:"h-full pr-4",children:e.jsxs("div",{className:"space-y-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Dm,{icon:Fr,label:"ID",value:l.id.toString(),mono:!0}),e.jsx(Dm,{label:"",value:l.count.toString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all whitespace-pre-wrap",children:l.content})]}),l.raw_content&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:(()=>{try{const c=JSON.parse(l.raw_content);return Array.isArray(c)?c.map((u,x)=>e.jsxs("div",{children:[x>0&&e.jsx("hr",{className:"my-3 border-border"}),e.jsx("div",{className:"whitespace-pre-wrap",children:u})]},x)):e.jsx("div",{className:"whitespace-pre-wrap",children:l.raw_content})}catch{return e.jsx("div",{className:"whitespace-pre-wrap",children:l.raw_content})}})()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:l.meaning?e.jsx(ex,{content:l.meaning}):"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Dm,{label:"",value:l.chat_name||l.chat_id}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.is_jargon===!0&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),l.is_jargon===!1&&e.jsx(ke,{variant:"secondary",children:""}),l.is_jargon===null&&e.jsx(ke,{variant:"outline",children:""}),l.is_global&&e.jsx(ke,{variant:"outline",className:"border-blue-500 text-blue-500",children:""}),l.is_complete&&e.jsx(ke,{variant:"outline",className:"border-purple-500 text-purple-500",children:""})]})]})]}),l.inference_with_context&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:l.inference_with_context})]}),l.inference_content_only&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:l.inference_content_only})]})]})}),e.jsx(et,{className:"flex-shrink-0",children:e.jsx(S,{onClick:()=>i(!1),children:""})})]})}):null}function Dm({icon:l,label:n,value:i,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[l&&e.jsx(l,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:P("text-sm",c&&"font-mono",!i&&"text-muted-foreground"),children:i||"-"})]})}function L4({open:l,onOpenChange:n,chatList:i,onSuccess:c}){const[u,x]=m.useState({content:"",meaning:"",chat_id:"",is_global:!1}),[h,f]=m.useState(!1),{toast:p}=st(),g=async()=>{if(!u.content||!u.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await T4(u),p({title:"",description:""}),x({content:"",meaning:"",chat_id:"",is_global:!1}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Ps,{open:l,onOpenChange:n,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"content",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"content",value:u.content,onChange:N=>x({...u,content:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"meaning",children:""}),e.jsx(at,{id:"meaning",value:u.meaning||"",onChange:N=>x({...u,meaning:N.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Ie,{value:u.chat_id,onValueChange:N=>x({...u,chat_id:N}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:i.map(N=>e.jsx(W,{value:N.chat_id,children:N.chat_name},N.chat_id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"is_global",checked:u.is_global,onCheckedChange:N=>x({...u,is_global:N})}),e.jsx(T,{htmlFor:"is_global",children:""})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>n(!1),children:""}),e.jsx(S,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function U4({jargon:l,open:n,onOpenChange:i,chatList:c,onSuccess:u}){const[x,h]=m.useState({}),[f,p]=m.useState(!1),{toast:g}=st();m.useEffect(()=>{l&&h({content:l.content,meaning:l.meaning||"",chat_id:l.stream_id||l.chat_id,is_global:l.is_global,is_jargon:l.is_jargon})},[l]);const N=async()=>{if(l)try{p(!0),await E4(l.id,x),g({title:"",description:""}),u()}catch(v){g({title:"",description:v instanceof Error?v.message:"",variant:"destructive"})}finally{p(!1)}};return l?e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_content",children:""}),e.jsx(ne,{id:"edit_content",value:x.content||"",onChange:v=>h({...x,content:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_meaning",children:""}),e.jsx(at,{id:"edit_meaning",value:x.meaning||"",onChange:v=>h({...x,meaning:v.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Ie,{value:x.chat_id||"",onValueChange:v=>h({...x,chat_id:v}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:c.map(v=>e.jsx(W,{value:v.chat_id,children:v.chat_name},v.chat_id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Ie,{value:x.is_jargon===null?"null":x.is_jargon?.toString()||"null",onValueChange:v=>h({...x,is_jargon:v==="null"?null:v==="true"}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"null",children:""}),e.jsx(W,{value:"true",children:""}),e.jsx(W,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"edit_is_global",checked:x.is_global,onCheckedChange:v=>h({...x,is_global:v})}),e.jsx(T,{htmlFor:"edit_is_global",children:""})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(S,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}const Qr="/api/webui/person";async function $4(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.is_known!==void 0&&n.append("is_known",l.is_known.toString()),l.platform&&n.append("platform",l.platform);const i=await we(`${Qr}/list?${n}`,{headers:Fs()});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function B4(l){const n=await we(`${Qr}/${l}`,{headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function I4(l,n){const i=await we(`${Qr}/${l}`,{method:"PATCH",headers:Fs(),body:JSON.stringify(n)});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function P4(l){const n=await we(`${Qr}/${l}`,{method:"DELETE",headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function H4(){const l=await we(`${Qr}/stats/summary`,{headers:Fs()});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function F4(l){const n=await we(`${Qr}/batch/delete`,{method:"POST",headers:Fs(),body:JSON.stringify({person_ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}function G4(){const[l,n]=m.useState([]),[i,c]=m.useState(!0),[u,x]=m.useState(0),[h,f]=m.useState(1),[p,g]=m.useState(20),[N,v]=m.useState(""),[y,w]=m.useState(void 0),[b,O]=m.useState(void 0),[A,_]=m.useState(null),[H,E]=m.useState(!1),[C,M]=m.useState(!1),[G,D]=m.useState(null),[ee,R]=m.useState({total:0,known:0,unknown:0,platforms:{}}),[me,ce]=m.useState(new Set),[ve,se]=m.useState(!1),[ge,fe]=m.useState(""),{toast:z}=st(),Q=async()=>{try{c(!0);const X=await $4({page:h,page_size:p,search:N||void 0,is_known:y,platform:b});n(X.data),x(X.total)}catch(X){z({title:"",description:X instanceof Error?X.message:"",variant:"destructive"})}finally{c(!1)}},I=async()=>{try{const X=await H4();X?.data&&R(X.data)}catch(X){console.error(":",X)}};m.useEffect(()=>{Q(),I()},[h,p,N,y,b]);const L=async X=>{try{const oe=await B4(X.person_id);_(oe.data),E(!0)}catch(oe){z({title:"",description:oe instanceof Error?oe.message:"",variant:"destructive"})}},B=X=>{_(X),M(!0)},_e=async X=>{try{await P4(X.person_id),z({title:"",description:`: ${X.person_name||X.nickname||X.user_id}`}),D(null),Q(),I()}catch(oe){z({title:"",description:oe instanceof Error?oe.message:"",variant:"destructive"})}},je=m.useMemo(()=>Object.keys(ee.platforms),[ee.platforms]),Ce=X=>{const oe=new Set(me);oe.has(X)?oe.delete(X):oe.add(X),ce(oe)},K=()=>{me.size===l.length&&l.length>0?ce(new Set):ce(new Set(l.map(X=>X.person_id)))},U=()=>{if(me.size===0){z({title:"",description:"",variant:"destructive"});return}se(!0)},V=async()=>{try{const X=await F4(Array.from(me));z({title:"",description:X.message}),ce(new Set),se(!1),Q(),I()}catch(X){z({title:"",description:X instanceof Error?X.message:"",variant:"destructive"})}},xe=()=>{const X=parseInt(ge),oe=Math.ceil(u/p);X>=1&&X<=oe?(f(X),fe("")):z({title:"",description:`1-${oe}`,variant:"destructive"})},Oe=X=>X?new Date(X*1e3).toLocaleString("zh-CN"):"-";return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(sc,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:ee.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:ee.known})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-muted-foreground",children:ee.unknown})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative mt-1.5",children:[e.jsx(Dt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{id:"search",placeholder:"ID...",value:N,onChange:X=>v(X.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-known",children:""}),e.jsxs(Ie,{value:y===void 0?"all":y.toString(),onValueChange:X=>{w(X==="all"?void 0:X==="true"),f(1)},children:[e.jsx($e,{id:"filter-known",className:"mt-1.5",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"true",children:""}),e.jsx(W,{value:"false",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-platform",children:""}),e.jsxs(Ie,{value:b||"all",onValueChange:X=>{O(X==="all"?void 0:X),f(1)},children:[e.jsx($e,{id:"filter-platform",className:"mt-1.5",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),je.map(X=>e.jsxs(W,{value:X,children:[X," (",ee.platforms[X],")"]},X))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:me.size>0&&e.jsxs("span",{children:[" ",me.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:X=>{g(parseInt(X)),f(1),ce(new Set)},children:[e.jsx($e,{id:"page-size",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),me.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>ce(new Set),children:""}),e.jsxs(S,{variant:"destructive",size:"sm",onClick:U,children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(Ws,{checked:l.length>0&&me.size===l.length,onCheckedChange:K,"aria-label":""})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"ID"}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Rl,{children:i?e.jsx(dt,{children:e.jsx(Ke,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"..."})}):l.length===0?e.jsx(dt,{children:e.jsx(Ke,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:""})}):l.map(X=>e.jsxs(dt,{children:[e.jsx(Ke,{children:e.jsx(Ws,{checked:me.has(X.person_id),onCheckedChange:()=>Ce(X.person_id),"aria-label":` ${X.person_name||X.nickname||X.user_id}`})}),e.jsx(Ke,{children:e.jsx("div",{className:P("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",X.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:X.is_known?"":""})}),e.jsx(Ke,{className:"font-medium",children:X.person_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ke,{children:X.nickname||"-"}),e.jsx(Ke,{children:X.platform}),e.jsx(Ke,{className:"font-mono text-sm",children:X.user_id}),e.jsx(Ke,{className:"text-sm text-muted-foreground",children:Oe(X.last_know)}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(S,{variant:"default",size:"sm",onClick:()=>L(X),children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(S,{variant:"default",size:"sm",onClick:()=>B(X),children:[e.jsx(Gn,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(S,{size:"sm",onClick:()=>D(X),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]})]})})]},X.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):l.map(X=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ws,{checked:me.has(X.person_id),onCheckedChange:()=>Ce(X.person_id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:P("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium mb-2",X.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:X.is_known?"":""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-1 w-full break-all",children:X.person_name||e.jsx("span",{className:"text-muted-foreground",children:""})}),X.nickname&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1 w-full break-all",children:[": ",X.nickname]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"font-medium text-xs",children:X.platform})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ID"}),e.jsx("p",{className:"font-mono text-xs truncate",title:X.user_id,children:X.user_id})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-xs",children:Oe(X.last_know)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>L(X),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(na,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>B(X),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Gn,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>D(X),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),""]})]})]},X.id))}),u>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",u,"  ",h," / ",Math.ceil(u/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Va,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:ge,onChange:X=>fe(X.target.value),onKeyDown:X=>X.key==="Enter"&&xe(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(u/p)}),e.jsx(S,{variant:"outline",size:"sm",onClick:xe,disabled:!ge,className:"h-8",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(u/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(sa,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(u/p)),disabled:h>=Math.ceil(u/p),className:"hidden sm:flex",children:e.jsx(fn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(V4,{person:A,open:H,onOpenChange:E}),e.jsx(q4,{person:A,open:C,onOpenChange:M,onSuccess:()=>{Q(),I(),M(!1)}}),e.jsx(vs,{open:!!G,onOpenChange:()=>D(null),children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',G?.person_name||G?.nickname||G?.user_id,'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>G&&_e(G),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:ve,onOpenChange:se,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",me.size,"  "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:V,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function V4({person:l,open:n,onOpenChange:i}){if(!l)return null;const c=u=>u?new Date(u*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsxs(Js,{children:[" ",l.person_name||l.nickname||l.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(El,{icon:In,label:"",value:l.person_name}),e.jsx(El,{icon:Ea,label:"",value:l.nickname}),e.jsx(El,{icon:Fr,label:"ID",value:l.user_id,mono:!0}),e.jsx(El,{icon:Fr,label:"ID",value:l.person_id,mono:!0}),e.jsx(El,{label:"",value:l.platform}),e.jsx(El,{label:"",value:l.is_known?"":""})]}),l.name_reason&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm",children:l.name_reason})]}),l.memory_points&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:l.memory_points})]}),l.group_nick_name&&l.group_nick_name.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:l.group_nick_name.map((u,x)=>e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:u.group_id}),e.jsx("span",{children:""}),e.jsx("span",{children:u.group_nick_name})]},x))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(El,{icon:Ca,label:"",value:c(l.know_times)}),e.jsx(El,{icon:Ca,label:"",value:c(l.know_since)}),e.jsx(El,{icon:Ca,label:"",value:c(l.last_know)})]})]}),e.jsx(et,{children:e.jsx(S,{onClick:()=>i(!1),children:""})})]})})}function El({icon:l,label:n,value:i,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[l&&e.jsx(l,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:P("text-sm",c&&"font-mono",!i&&"text-muted-foreground"),children:i||"-"})]})}function q4({person:l,open:n,onOpenChange:i,onSuccess:c}){const[u,x]=m.useState({}),[h,f]=m.useState(!1),{toast:p}=st();m.useEffect(()=>{l&&x({person_name:l.person_name||"",name_reason:l.name_reason||"",nickname:l.nickname||"",is_known:l.is_known})},[l]);const g=async()=>{if(l)try{f(!0),await I4(l.person_id,u),p({title:"",description:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return l?e.jsx(Ps,{open:n,onOpenChange:i,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsxs(Js,{children:[" ",l.person_name||l.nickname||l.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"person_name",children:""}),e.jsx(ne,{id:"person_name",value:u.person_name||"",onChange:N=>x({...u,person_name:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ne,{id:"nickname",value:u.nickname||"",onChange:N=>x({...u,nickname:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"name_reason",children:""}),e.jsx(at,{id:"name_reason",value:u.name_reason||"",onChange:N=>x({...u,name_reason:N.target.value}),placeholder:"",rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"is_known",className:"text-base font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"is_known",checked:u.is_known,onCheckedChange:N=>x({...u,is_known:N})})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(S,{onClick:g,disabled:h,children:h?"...":""})]})]})}):null}var K4=$_();const Ag=S0(K4),ix="/api/webui";async function Q4(l=100,n="all"){const i=`${ix}/knowledge/graph?limit=${l}&node_type=${n}`,c=await fetch(i);if(!c.ok)throw new Error(`: ${c.status}`);return c.json()}async function Y4(){const l=await fetch(`${ix}/knowledge/stats`);if(!l.ok)throw new Error("");return l.json()}async function J4(l){const n=await fetch(`${ix}/knowledge/search?query=${encodeURIComponent(l)}`);if(!n.ok)throw new Error("");return n.json()}const Cv=m.memo(({data:l})=>e.jsxs("div",{className:"px-4 py-2 shadow-md rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700 min-w-[120px]",children:[e.jsx(Io,{type:"target",position:Po.Top}),e.jsx("div",{className:"font-semibold text-white text-sm truncate max-w-[200px]",title:l.content,children:l.label}),e.jsx(Io,{type:"source",position:Po.Bottom})]}));Cv.displayName="EntityNode";const Tv=m.memo(({data:l})=>e.jsxs("div",{className:"px-3 py-2 shadow-md rounded-md bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700 min-w-[100px]",children:[e.jsx(Io,{type:"target",position:Po.Top}),e.jsx("div",{className:"font-medium text-white text-xs truncate max-w-[150px]",title:l.content,children:l.label}),e.jsx(Io,{type:"source",position:Po.Bottom})]}));Tv.displayName="ParagraphNode";const X4={entity:Cv,paragraph:Tv};function Z4(l,n){const i=new Ag.graphlib.Graph;i.setDefaultEdgeLabel(()=>({})),i.setGraph({rankdir:"TB",ranksep:100,nodesep:80});const c=[],u=[];return l.forEach(x=>{i.setNode(x.id,{width:150,height:50})}),n.forEach(x=>{i.setEdge(x.source,x.target)}),Ag.layout(i),l.forEach(x=>{const h=i.node(x.id);c.push({id:x.id,type:x.type,position:{x:h.x-75,y:h.y-25},data:{label:x.content.slice(0,20)+(x.content.length>20?"...":""),content:x.content}})}),n.forEach((x,h)=>{const f={id:`edge-${h}`,source:x.source,target:x.target,animated:l.length<=200&&x.weight>5,style:{strokeWidth:Math.min(x.weight/2,5),opacity:.6}};x.weight>10&&l.length<100&&(f.label=`${x.weight.toFixed(0)}`),u.push(f)}),{nodes:c,edges:u}}function W4(){const l=ia(),[n,i]=m.useState(!1),[c,u]=m.useState(null),[x,h]=m.useState(""),[f,p]=m.useState("all"),[g,N]=m.useState(50),[v,y]=m.useState("50"),[w,b]=m.useState(!1),[O,A]=m.useState(!0),[_,H]=m.useState(!1),[E,C]=m.useState(!1),[M,G,D]=B_([]),[ee,R,me]=I_([]),[ce,ve]=m.useState(0),[se,ge]=m.useState(null),[fe,z]=m.useState(null),{toast:Q}=st(),I=m.useCallback(V=>V.type==="entity"?"#6366f1":V.type==="paragraph"?"#10b981":"#6b7280",[]),L=m.useCallback(async(V=!1)=>{try{if(!V&&g>200){C(!0);return}i(!0);const[xe,Oe]=await Promise.all([Q4(g,f),Y4()]);if(u(Oe),xe.nodes.length===0){Q({title:"",description:""}),G([]),R([]);return}const{nodes:X,edges:oe}=Z4(xe.nodes,xe.edges);G(X),R(oe),ve(X.length),Oe&&Oe.total_nodes>g&&Q({title:"",description:` ${Oe.total_nodes}  ${X.length} `}),Q({title:"",description:` ${X.length} ${oe.length} `})}catch(xe){console.error(":",xe),Q({title:"",description:xe instanceof Error?xe.message:"",variant:"destructive"})}finally{i(!1)}},[g,f,Q]),B=m.useCallback(async()=>{if(!x.trim()){Q({title:"",description:""});return}try{const V=await J4(x);if(V.length===0){Q({title:"",description:""});return}const xe=new Set(V.map(Oe=>Oe.id));G(Oe=>Oe.map(X=>({...X,style:{...X.style,opacity:xe.has(X.id)?1:.3,filter:xe.has(X.id)?"brightness(1.2)":"brightness(0.8)"}}))),Q({title:"",description:` ${V.length} `})}catch(V){console.error(":",V),Q({title:"",description:V instanceof Error?V.message:"",variant:"destructive"})}},[x,Q]),_e=m.useCallback(()=>{G(V=>V.map(xe=>({...xe,style:{...xe.style,opacity:1,filter:"brightness(1)"}})))},[]),je=m.useCallback(()=>{A(!1),H(!0),L()},[L]),Ce=m.useCallback(()=>{C(!1),setTimeout(()=>{L(!0)},0)},[L]),K=m.useCallback((V,xe)=>{M.find(X=>X.id===xe.id)&&ge({id:xe.id,type:xe.type,content:xe.data.content})},[M]);m.useEffect(()=>{O||_&&L()},[g,f,O,_]);const U=m.useCallback((V,xe)=>{const Oe=M.find(Ge=>Ge.id===xe.source),X=M.find(Ge=>Ge.id===xe.target),oe=ee.find(Ge=>Ge.id===xe.id);Oe&&X&&oe&&z({source:{id:Oe.id,type:Oe.type,content:Oe.data.content},target:{id:X.id,type:X.type,content:X.data.content},edge:{source:xe.source,target:xe.target,weight:parseFloat(xe.label||"0")}})},[M,ee]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b bg-background",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1",children:""})]}),c&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Pr,{className:"h-3 w-3"}),": ",c.total_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Rj,{className:"h-3 w-3"}),": ",c.total_edges]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Pt,{className:"h-3 w-3"}),": ",c.entity_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(ka,{className:"h-3 w-3"}),": ",c.paragraph_nodes]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(ne,{placeholder:"...",value:x,onChange:V=>h(V.target.value),onKeyDown:V=>V.key==="Enter"&&B(),className:"flex-1"}),e.jsx(S,{onClick:B,size:"sm",children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx(S,{onClick:_e,variant:"outline",size:"sm",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ie,{value:f,onValueChange:V=>p(V),children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"entity",children:""}),e.jsx(W,{value:"paragraph",children:""})]})]}),e.jsxs(Ie,{value:g===1e4?"all":w?"custom":g.toString(),onValueChange:V=>{V==="custom"?(b(!0),y(g.toString())):V==="all"?(b(!1),N(1e4)):(b(!1),N(Number(V)))},children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"50",children:"50 "}),e.jsx(W,{value:"100",children:"100 "}),e.jsx(W,{value:"200",children:"200 "}),e.jsx(W,{value:"500",children:"500 "}),e.jsx(W,{value:"1000",children:"1000 "}),e.jsx(W,{value:"all",children:" (10000)"}),e.jsx(W,{value:"custom",children:"..."})]})]}),w&&e.jsx(ne,{type:"number",min:"50",value:v,onChange:V=>y(V.target.value),onBlur:()=>{const V=parseInt(v);!isNaN(V)&&V>=50?N(V):(y("50"),N(50))},onKeyDown:V=>{if(V.key==="Enter"){const xe=parseInt(v);!isNaN(xe)&&xe>=50?N(xe):(y("50"),N(50))}},placeholder:"50",className:"w-[120px]"}),e.jsx(S,{onClick:()=>L(),variant:"outline",size:"sm",disabled:n,children:e.jsx(ft,{className:P("h-4 w-4",n&&"animate-spin")})})]})]})]}),e.jsx("div",{className:"flex-1 relative",children:n?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ft,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):M.length===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Pr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]})}):e.jsxs(P_,{nodes:M,edges:ee,onNodesChange:D,onEdgesChange:me,onNodeClick:K,onEdgeClick:U,nodeTypes:X4,fitView:!0,minZoom:.05,maxZoom:1.5,defaultViewport:{x:0,y:0,zoom:.5},elevateNodesOnSelect:ce<=500,nodesDraggable:ce<=1e3,attributionPosition:"bottom-left",children:[e.jsx(H_,{variant:F_.Dots,gap:12,size:1}),e.jsx(G_,{}),ce<=500&&e.jsx(V_,{nodeColor:I,nodeBorderRadius:8,pannable:!0,zoomable:!0}),e.jsxs(q_,{position:"top-right",className:"bg-background/95 backdrop-blur-sm rounded-lg border p-3 shadow-lg",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:""}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700"}),e.jsx("span",{children:""})]}),ce>200&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-yellow-600 dark:text-yellow-500",children:[e.jsx("div",{className:"font-semibold",children:""}),e.jsx("div",{children:""}),ce>500&&e.jsx("div",{children:""})]})]})]})]})}),e.jsx(Ps,{open:!!se,onOpenChange:V=>!V&&ge(null),children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx($s,{children:e.jsx(Bs,{children:""})}),se&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:se.type==="entity"?"default":"secondary",children:se.type==="entity"?" ":" "})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ID"}),e.jsx("code",{className:"mt-1 block p-2 bg-muted rounded text-xs break-all",children:se.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx(Je,{className:"mt-1 h-40 p-3 bg-muted rounded",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:se.content})})]})]})]})}),e.jsx(Ps,{open:!!fe,onOpenChange:V=>!V&&z(null),children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx($s,{children:e.jsx(Bs,{children:""})}),fe&&e.jsx(Je,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-blue-50 dark:bg-blue-950 rounded border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:fe.source.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[fe.source.id.slice(0,40),"..."]})]}),e.jsx("div",{className:"text-2xl text-muted-foreground flex-shrink-0",children:""}),e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-green-50 dark:bg-green-950 rounded border-2 border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:fe.target.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[fe.target.id.slice(0,40),"..."]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",className:"text-base font-mono",children:fe.edge.weight.toFixed(4)})})]})]})})]})}),e.jsx(vs,{open:O,onOpenChange:A,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:["",e.jsx("br",{}),"?"]})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>l({to:"/"}),children:" ()"}),e.jsx(fs,{onClick:je,children:""})]})]})}),e.jsx(vs,{open:E,onOpenChange:C,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:" "}),e.jsx(hs,{asChild:!0,children:e.jsxs("div",{children:[e.jsxs("p",{children:[" ",e.jsx("strong",{className:"text-orange-600",children:g>=1e4?" (10000)":g})," "]}),e.jsx("p",{className:"mt-4",children:":"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"mt-4",children:" (50-200 )"})]})})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>{C(!1),g>200&&(N(50),b(!1))},children:""}),e.jsx(fs,{onClick:Ce,className:"bg-orange-600 hover:bg-orange-700",children:""})]})]})})]})}function ek(){return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-none border-b bg-card/50 px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:""})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"mx-auto max-w-4xl",children:e.jsxs(Se,{children:[e.jsxs(ze,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Pr,{className:"h-10 w-10 text-primary"})}),e.jsx(Re,{className:"text-2xl",children:""}),e.jsx(ws,{className:"text-base",children:""})]}),e.jsx(Me,{className:"text-center text-sm text-muted-foreground",children:e.jsx("p",{children:""})})]})})})]})}function zg({className:l,classNames:n,showOutsideDays:i=!0,captionLayout:c="label",buttonVariant:u="ghost",formatters:x,components:h,...f}){const p=Xj();return e.jsx(A_,{showOutsideDays:i,className:P("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,l),captionLayout:c,formatters:{formatMonthDropdown:g=>g.toLocaleString("default",{month:"short"}),...x},classNames:{root:P("w-fit",p.root),months:P("relative flex flex-col gap-4 md:flex-row",p.months),month:P("flex w-full flex-col gap-4",p.month),nav:P("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",p.nav),button_previous:P(Vr({variant:u}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_previous),button_next:P(Vr({variant:u}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_next),month_caption:P("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",p.month_caption),dropdowns:P("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",p.dropdowns),dropdown_root:P("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",p.dropdown_root),dropdown:P("bg-popover absolute inset-0 opacity-0",p.dropdown),caption_label:P("select-none font-medium",c==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",p.caption_label),table:"w-full border-collapse",weekdays:P("flex",p.weekdays),weekday:P("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",p.weekday),week:P("mt-2 flex w-full",p.week),week_number_header:P("w-[--cell-size] select-none",p.week_number_header),week_number:P("text-muted-foreground select-none text-[0.8rem]",p.week_number),day:P("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",p.day),range_start:P("bg-accent rounded-l-md",p.range_start),range_middle:P("rounded-none",p.range_middle),range_end:P("bg-accent rounded-r-md",p.range_end),today:P("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",p.today),outside:P("text-muted-foreground aria-selected:text-muted-foreground",p.outside),disabled:P("text-muted-foreground opacity-50",p.disabled),hidden:P("invisible",p.hidden),...n},components:{Root:({className:g,rootRef:N,...v})=>e.jsx("div",{"data-slot":"calendar",ref:N,className:P(g),...v}),Chevron:({className:g,orientation:N,...v})=>N==="left"?e.jsx(Va,{className:P("size-4",g),...v}):N==="right"?e.jsx(sa,{className:P("size-4",g),...v}):e.jsx(Aa,{className:P("size-4",g),...v}),DayButton:sk,WeekNumber:({children:g,...N})=>e.jsx("td",{...N,children:e.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:g})}),...h},...f})}function sk({className:l,day:n,modifiers:i,...c}){const u=Xj(),x=m.useRef(null);return m.useEffect(()=>{i.focused&&x.current?.focus()},[i.focused]),e.jsx(S,{ref:x,variant:"ghost",size:"icon","data-day":n.date.toLocaleDateString(),"data-selected-single":i.selected&&!i.range_start&&!i.range_end&&!i.range_middle,"data-range-start":i.range_start,"data-range-end":i.range_end,"data-range-middle":i.range_middle,className:P("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",u.day,l),...c})}const To={xs:{label:"",rowHeight:28,class:"text-[10px] sm:text-xs"},sm:{label:"",rowHeight:36,class:"text-xs sm:text-sm"},base:{label:"",rowHeight:44,class:"text-sm sm:text-base"}};function tk(){const[l,n]=m.useState([]),[i,c]=m.useState(""),[u,x]=m.useState("all"),[h,f]=m.useState("all"),[p,g]=m.useState(void 0),[N,v]=m.useState(void 0),[y,w]=m.useState(!0),[b,O]=m.useState(!1),[A,_]=m.useState("xs"),[H,E]=m.useState(4),[C,M]=m.useState(!1),G=m.useRef(null);m.useEffect(()=>{const B=$n.getAllLogs();n(B);const _e=$n.onLog(()=>{n($n.getAllLogs())}),je=$n.onConnectionChange(Ce=>{O(Ce)});return()=>{_e(),je()}},[]);const D=m.useMemo(()=>{const B=new Set(l.map(_e=>_e.module).filter(_e=>_e&&_e.trim()!==""));return Array.from(B).sort()},[l]),ee=B=>{switch(B){case"DEBUG":return"text-muted-foreground";case"INFO":return"text-blue-500 dark:text-blue-400";case"WARNING":return"text-yellow-600 dark:text-yellow-500";case"ERROR":return"text-red-600 dark:text-red-500";case"CRITICAL":return"text-red-700 dark:text-red-400 font-bold";default:return"text-foreground"}},R=B=>{switch(B){case"DEBUG":return"bg-gray-800/30 dark:bg-gray-800/50";case"INFO":return"bg-blue-900/20 dark:bg-blue-500/20";case"WARNING":return"bg-yellow-900/20 dark:bg-yellow-500/20";case"ERROR":return"bg-red-900/20 dark:bg-red-500/20";case"CRITICAL":return"bg-red-900/30 dark:bg-red-600/30";default:return"bg-gray-800/20 dark:bg-gray-800/30"}},me=()=>{window.location.reload()},ce=()=>{$n.clearLogs(),n([])},ve=()=>{const B=fe.map(K=>`${K.timestamp} [${K.level.padEnd(8)}] [${K.module}] ${K.message}`).join(`
`),_e=new Blob([B],{type:"text/plain;charset=utf-8"}),je=URL.createObjectURL(_e),Ce=document.createElement("a");Ce.href=je,Ce.download=`logs-${vm(new Date,"yyyy-MM-dd-HHmmss")}.txt`,Ce.click(),URL.revokeObjectURL(je)},se=()=>{w(!y)},ge=()=>{g(void 0),v(void 0)},fe=m.useMemo(()=>l.filter(B=>{const _e=i===""||B.message.toLowerCase().includes(i.toLowerCase())||B.module.toLowerCase().includes(i.toLowerCase()),je=u==="all"||B.level===u,Ce=h==="all"||B.module===h;let K=!0;if(p||N){const U=new Date(B.timestamp);if(p){const V=new Date(p);V.setHours(0,0,0,0),K=K&&U>=V}if(N){const V=new Date(N);V.setHours(23,59,59,999),K=K&&U<=V}}return _e&&je&&Ce&&K}),[l,i,u,h,p,N]),z=To[A].rowHeight+H,Q=p0({count:fe.length,getScrollElement:()=>G.current,estimateSize:()=>z,overscan:50}),I=m.useRef(!1),L=m.useRef(fe.length);return m.useEffect(()=>{const B=G.current;if(!B)return;const _e=()=>{if(I.current)return;const{scrollTop:je,scrollHeight:Ce,clientHeight:K}=B,U=Ce-je-K;U>100&&y?w(!1):U<50&&!y&&w(!0)};return B.addEventListener("scroll",_e,{passive:!0}),()=>B.removeEventListener("scroll",_e)},[y]),m.useEffect(()=>{const B=fe.length>L.current;L.current=fe.length,y&&fe.length>0&&B&&(I.current=!0,Q.scrollToIndex(fe.length-1,{align:"end",behavior:"auto"}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{I.current=!1})}))},[fe.length,y,Q]),e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 space-y-2 sm:space-y-3 p-2 sm:p-3 lg:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 hidden sm:block",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:P("h-2 w-2 sm:h-2.5 sm:w-2.5 rounded-full",b?"bg-green-500 animate-pulse":"bg-red-500")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:b?"":""})]})]}),e.jsx(Se,{className:"p-2 sm:p-3",children:e.jsx(nc,{open:C,onOpenChange:M,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(Dt,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:i,onChange:B=>c(B.target.value),className:"pl-8 h-8 text-xs sm:text-sm"})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(S,{variant:y?"default":"outline",size:"sm",onClick:se,className:"h-8 px-2",title:y?"":"",children:[y?e.jsx(e_,{className:"h-3.5 w-3.5"}):e.jsx(s_,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden sm:inline",children:y?"":""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:ce,className:"h-8 px-2",title:"",children:[e.jsx(ns,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden md:inline",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:ve,className:"h-8 px-2 hidden sm:flex",title:"",children:[e.jsx(Zt,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden lg:inline",children:""})]}),e.jsx(rc,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",className:"h-8 px-2",title:C?"":"",children:[e.jsx(Ao,{className:"h-3.5 w-3.5"}),C?e.jsx(Hr,{className:"h-3.5 w-3.5 ml-1"}):e.jsx(Aa,{className:"h-3.5 w-3.5 ml-1"})]})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center sm:text-right -mt-1",children:[e.jsxs("span",{className:"font-mono",children:[fe.length," / ",l.length]}),e.jsx("span",{className:"ml-1",children:""})]}),e.jsxs(ic,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(Ie,{value:u,onValueChange:x,children:[e.jsxs($e,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Ao,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Pe,{placeholder:""})]}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"DEBUG",children:"DEBUG"}),e.jsx(W,{value:"INFO",children:"INFO"}),e.jsx(W,{value:"WARNING",children:"WARNING"}),e.jsx(W,{value:"ERROR",children:"ERROR"}),e.jsx(W,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsxs(Ie,{value:h,onValueChange:f,children:[e.jsxs($e,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Ao,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Pe,{placeholder:""})]}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),D.map(B=>e.jsx(W,{value:B,children:B},B))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(il,{children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",className:P("w-full sm:flex-1 justify-start text-left font-normal h-8",!p&&"text-muted-foreground"),children:[e.jsx($o,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:p?vm(p,"PP",{locale:ko}):""})]})}),e.jsx(Za,{className:"w-auto p-0",align:"start",children:e.jsx(zg,{mode:"single",selected:p,onSelect:g,initialFocus:!0,locale:ko})})]}),e.jsxs(il,{children:[e.jsx(cl,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",className:P("w-full sm:flex-1 justify-start text-left font-normal h-8",!N&&"text-muted-foreground"),children:[e.jsx($o,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:N?vm(N,"PP",{locale:ko}):""})]})}),e.jsx(Za,{className:"w-auto p-0",align:"start",children:e.jsx(zg,{mode:"single",selected:N,onSelect:v,initialFocus:!0,locale:ko})})]}),(p||N)&&e.jsxs(S,{variant:"outline",size:"sm",onClick:ge,className:"w-full sm:w-auto h-8",children:[e.jsx(Ma,{className:"h-3.5 w-3.5 sm:mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3 pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(t_,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:""})]}),e.jsx("div",{className:"flex gap-1",children:Object.keys(To).map(B=>e.jsx(S,{variant:A===B?"default":"outline",size:"sm",onClick:()=>_(B),className:"h-6 px-2 text-xs",children:To[B].label},B))})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:""}),e.jsx(Sa,{value:[H],onValueChange:([B])=>E(B),min:0,max:12,step:2,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-7",children:[H,"px"]})]}),e.jsxs("div",{className:"flex gap-2 sm:hidden",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:me,className:"flex-1 h-8",children:[e.jsx(ft,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:ve,className:"flex-1 h-8",children:[e.jsx(Zt,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]})]})]})]})})})]}),e.jsx("div",{className:"flex-1 min-h-0 px-2 sm:px-3 lg:px-4 pb-2 sm:pb-3 lg:pb-4",children:e.jsx(Se,{className:"bg-black dark:bg-gray-950 border-gray-800 dark:border-gray-900 h-full overflow-hidden",children:e.jsx("div",{ref:G,className:P("h-full overflow-auto","[&::-webkit-scrollbar]:w-2.5","[&::-webkit-scrollbar-track]:bg-transparent","[&::-webkit-scrollbar-thumb]:bg-border [&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-thumb:hover]:bg-border/80"),children:e.jsx("div",{className:P("p-2 sm:p-3 font-mono relative",To[A].class),style:{height:`${Q.getTotalSize()}px`},children:fe.length===0?e.jsx("div",{className:"text-gray-500 dark:text-gray-600 text-center py-8 text-xs sm:text-sm",children:""}):Q.getVirtualItems().map(B=>{const _e=fe[B.index];return e.jsxs("div",{"data-index":B.index,ref:Q.measureElement,className:P("absolute top-0 left-0 w-full px-2 sm:px-3 rounded hover:bg-white/5 transition-colors",R(_e.level)),style:{transform:`translateY(${B.start}px)`,paddingTop:`${H/2}px`,paddingBottom:`${H/2}px`},children:[e.jsxs("div",{className:"flex flex-col gap-0.5 sm:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 text-[10px]",children:_e.timestamp}),e.jsxs("span",{className:P("font-semibold text-[10px]",ee(_e.level)),children:["[",_e.level,"]"]})]}),e.jsx("div",{className:"text-cyan-400 dark:text-cyan-500 truncate text-[10px]",children:_e.module}),e.jsx("div",{className:"text-gray-300 dark:text-gray-400 whitespace-pre-wrap break-words text-[10px]",children:_e.message})]}),e.jsxs("div",{className:"hidden sm:flex gap-2 items-start",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 flex-shrink-0 w-[130px] lg:w-[160px]",children:_e.timestamp}),e.jsxs("span",{className:P("flex-shrink-0 w-[65px] lg:w-[75px] font-semibold",ee(_e.level)),children:["[",_e.level,"]"]}),e.jsx("span",{className:"text-cyan-400 dark:text-cyan-500 flex-shrink-0 w-[100px] lg:w-[130px] truncate",children:_e.module}),e.jsx("span",{className:"text-gray-300 dark:text-gray-400 flex-1 whitespace-pre-wrap break-words",children:_e.message})]})]},B.key)})})})})})]})}async function ak(){return(await we("/api/planner/overview")).json()}async function lk(l,n=1,i=20,c){const u=new URLSearchParams({page:n.toString(),page_size:i.toString()});return c&&u.append("search",c),(await we(`/api/planner/chat/${l}/logs?${u}`)).json()}async function nk(l,n){return(await we(`/api/planner/log/${l}/${n}`)).json()}async function rk(){return(await we("/api/replier/overview")).json()}async function ik(l,n=1,i=20,c){const u=new URLSearchParams({page:n.toString(),page_size:i.toString()});return c&&u.append("search",c),(await we(`/api/replier/chat/${l}/logs?${u}`)).json()}async function ck(l,n){return(await we(`/api/replier/log/${l}/${n}`)).json()}function Ev(){const[l,n]=m.useState(new Map),[i,c]=m.useState(!0),u=m.useCallback(async()=>{try{c(!0);const h=await kv();if(h?.data){const f=new Map;h.data.forEach(p=>{f.set(p.chat_id,p.chat_name)}),n(f)}}catch(h){console.error(":",h)}finally{c(!1)}},[]);m.useEffect(()=>{u()},[u]);const x=m.useCallback(h=>l.get(h)||h,[l]);return{chatNameMap:l,getChatName:x,loading:i,reload:u}}function Fo(l){return new Date(l*1e3).toLocaleString("zh-CN")}function Mv(l){const i=Date.now()/1e3-l;return i<60?"":i<3600?`${Math.floor(i/60)} `:i<86400?`${Math.floor(i/3600)} `:`${Math.floor(i/86400)} `}function Av(l,n,i=1e4){m.useEffect(()=>{if(!l)return;const c=setInterval(n,i);return()=>clearInterval(c)},[l,n,i])}function ok({autoRefresh:l,refreshKey:n}){const[i,c]=m.useState("overview"),[u,x]=m.useState(null),{getChatName:h}=Ev(),[f,p]=m.useState(null),[g,N]=m.useState(!0),[v,y]=m.useState(null),[w,b]=m.useState(!1),[O,A]=m.useState(1),[_,H]=m.useState(20),[E,C]=m.useState(""),[M,G]=m.useState(""),[D,ee]=m.useState(""),[R,me]=m.useState(null),[ce,ve]=m.useState(!1),[se,ge]=m.useState(!1),fe=m.useCallback(async()=>{try{N(!0);const U=await ak();p(U)}catch(U){console.error(":",U)}finally{N(!1)}},[]),z=m.useCallback(async()=>{if(u)try{b(!0);const U=await lk(u.chat_id,O,_,M||void 0);y(U)}catch(U){console.error(":",U)}finally{b(!1)}},[u,O,_,M]);m.useEffect(()=>{fe()},[fe]),m.useEffect(()=>{n>0&&(i==="overview"?fe():z())},[n,i,fe,z]),m.useEffect(()=>{i==="chat-logs"&&u&&z()},[i,u,z]),Av(l,m.useCallback(()=>{i==="overview"?fe():z()},[i,fe,z]));const Q=U=>{x(U),A(1),G(""),ee(""),c("chat-logs")},I=()=>{c("overview"),x(null),y(null),G(""),ee("")},L=()=>{G(D),A(1)},B=()=>{ee(""),G(""),A(1)},_e=async(U,V)=>{try{ge(!0),ve(!0);const xe=await nk(U,V);me(xe)}catch(xe){console.error(":",xe)}finally{ge(!1)}},je=U=>{H(Number(U)),A(1)},Ce=()=>{const U=parseInt(E),V=v?Math.ceil(v.total/v.page_size):0;!isNaN(U)&&U>=1&&U<=V&&(A(U),C(""))},K=v?Math.ceil(v.total/v.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:i==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Ea,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Vm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_plans||0})})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((U,V)=>e.jsx(js,{className:"h-24 w-full"},V))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(U=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Q(U),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ea,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(U.chat_id),children:h(U.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:U.plan_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",Mv(U.latest_timestamp)]})]},U.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:I,children:[e.jsx(Ta,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:u?h(u.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",v?.total||0," "]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:u?h(u.chat_id):""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{placeholder:"...",value:D,onChange:U=>ee(U.target.value),onKeyDown:U=>U.key==="Enter"&&L(),className:"w-48"}),e.jsx(S,{variant:"outline",size:"icon",onClick:L,children:e.jsx(Dt,{className:"h-4 w-4"})}),M&&e.jsx(S,{variant:"ghost",size:"sm",onClick:B,children:""})]}),e.jsxs(Ie,{value:_.toString(),onValueChange:je,children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"10",children:"10/"}),e.jsx(W,{value:"20",children:"20/"}),e.jsx(W,{value:"50",children:"50/"}),e.jsx(W,{value:"100",children:"100/"})]})]})]})]}),M&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',M,'"']})]})]}),e.jsx(Me,{children:w?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((U,V)=>e.jsx(js,{className:"h-20 w-full"},V))}):v?.data&&v.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:v.data.map(U=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e(U.chat_id,U.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Fo(U.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[U.action_count," "]}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[U.total_plan_ms.toFixed(0),"ms"]})]})]}),U.action_types&&U.action_types.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:U.action_types.map((V,xe)=>e.jsx(ke,{variant:"outline",className:"text-xs bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800",children:V},xe))}),e.jsx("p",{className:"text-sm line-clamp-2",children:U.reasoning_preview||""})]},U.filename))}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",v.total,"  ",O," / ",K," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(1),disabled:O===1,children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(U=>Math.max(1,U-1)),disabled:O===1,children:e.jsx(Va,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",min:1,max:K,value:E,onChange:U=>C(U.target.value),onKeyDown:U=>U.key==="Enter"&&Ce(),placeholder:"",className:"w-20 h-8"}),e.jsx(S,{size:"sm",variant:"outline",onClick:Ce,children:""})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(U=>Math.min(K,U+1)),disabled:O===K,children:e.jsx(sa,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(K),disabled:O===K,children:e.jsx(fn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Ps,{open:ce,onOpenChange:ve,children:e.jsxs(Us,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-5 w-5"}),""]}),e.jsx(Js,{children:""})]}),e.jsx(Je,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:se?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((U,V)=>e.jsx(js,{className:"h-24 w-full"},V))}):R?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Ca,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:R.chat_id,children:h(R.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Fo(R.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx(ke,{variant:"outline",children:R.type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{children:[R.actions.length," "]})]})]})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Xa,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(Se,{children:[e.jsx(ze,{className:"p-4 pb-2",children:e.jsx(Re,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[R.timing.prompt_build_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Se,{children:[e.jsx(ze,{className:"p-4 pb-2",children:e.jsx(Re,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[R.timing.llm_duration_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Se,{children:[e.jsx(ze,{className:"p-4 pb-2",children:e.jsx(Re,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[R.timing.total_plan_ms?.toFixed(2)||0,"ms"]})})]})]})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Xm,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:R.reasoning||""})})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(a_,{className:"h-4 w-4"})," (",R.actions.length,")"]}),e.jsx("div",{className:"space-y-3",children:R.actions.map((U,V)=>e.jsxs(Se,{children:[e.jsx(ze,{className:"p-4 pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ke,{variant:"default",children:[" ",V+1]}),e.jsx(ke,{variant:"outline",children:U.action_type})]})})}),e.jsxs(Me,{className:"p-4 pt-0 space-y-3",children:[U.reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof U.reasoning=="string"?U.reasoning:JSON.stringify(U.reasoning)})]}),U.action_message&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),typeof U.action_message=="string"?e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded break-all whitespace-pre-wrap",children:U.action_message}):e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify(U.action_message,null,2)})]}),U.action_data&&Object.keys(U.action_data).length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto",children:JSON.stringify(U.action_data,null,2)})]}),U.action_reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof U.action_reasoning=="string"?U.action_reasoning:JSON.stringify(U.action_reasoning)})]})]})]},V))})]}),e.jsx(Qt,{}),R.raw_output&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:R.raw_output})})]})]}),R.prompt&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:R.prompt})})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(et,{className:"flex-shrink-0",children:e.jsx(S,{onClick:()=>ve(!1),children:""})})]})})]})}function dk({autoRefresh:l,refreshKey:n}){const[i,c]=m.useState("overview"),[u,x]=m.useState(null),{getChatName:h}=Ev(),[f,p]=m.useState(null),[g,N]=m.useState(!0),[v,y]=m.useState(null),[w,b]=m.useState(!1),[O,A]=m.useState(1),[_,H]=m.useState(20),[E,C]=m.useState(""),[M,G]=m.useState(""),[D,ee]=m.useState(""),[R,me]=m.useState(null),[ce,ve]=m.useState(!1),[se,ge]=m.useState(!1),fe=m.useCallback(async()=>{try{N(!0);const U=await rk();p(U)}catch(U){console.error(":",U)}finally{N(!1)}},[]),z=m.useCallback(async()=>{if(u)try{b(!0);const U=await ik(u.chat_id,O,_,M||void 0);y(U)}catch(U){console.error(":",U)}finally{b(!1)}},[u,O,_,M]);m.useEffect(()=>{fe()},[fe]),m.useEffect(()=>{n>0&&(i==="overview"?fe():z())},[n,i,fe,z]),m.useEffect(()=>{i==="chat-logs"&&u&&z()},[i,u,z]),Av(l,m.useCallback(()=>{i==="overview"?fe():z()},[i,fe,z]));const Q=U=>{x(U),A(1),G(""),ee(""),c("chat-logs")},I=()=>{c("overview"),x(null),y(null),G(""),ee("")},L=()=>{G(D),A(1)},B=()=>{ee(""),G(""),A(1)},_e=async(U,V)=>{try{ge(!0),ve(!0);const xe=await ck(U,V);me(xe)}catch(xe){console.error(":",xe)}finally{ge(!1)}},je=U=>{H(Number(U)),A(1)},Ce=()=>{const U=parseInt(E),V=v?Math.ceil(v.total/v.page_size):0;!isNaN(U)&&U>=1&&U<=V&&(A(U),C(""))},K=v?Math.ceil(v.total/v.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:i==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Ea,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Vm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Me,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_replies||0})})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((U,V)=>e.jsx(js,{className:"h-24 w-full"},V))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(U=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>Q(U),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ea,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(U.chat_id),children:h(U.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:U.reply_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",Mv(U.latest_timestamp)]})]},U.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:I,children:[e.jsx(Ta,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:u?h(u.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",v?.total||0," "]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:u?h(u.chat_id):""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{placeholder:"...",value:D,onChange:U=>ee(U.target.value),onKeyDown:U=>U.key==="Enter"&&L(),className:"w-48"}),e.jsx(S,{variant:"outline",size:"icon",onClick:L,children:e.jsx(Dt,{className:"h-4 w-4"})}),M&&e.jsx(S,{variant:"ghost",size:"sm",onClick:B,children:""})]}),e.jsxs(Ie,{value:_.toString(),onValueChange:je,children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(W,{value:"10",children:"10/"}),e.jsx(W,{value:"20",children:"20/"}),e.jsx(W,{value:"50",children:"50/"}),e.jsx(W,{value:"100",children:"100/"})]})]})]})]}),M&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',M,'"']})]})]}),e.jsx(Me,{children:w?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((U,V)=>e.jsx(js,{className:"h-20 w-full"},V))}):v?.data&&v.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:v.data.map(U=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e(U.chat_id,U.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Fo(U.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[U.success?e.jsxs(ke,{variant:"default",className:"text-xs bg-green-600",children:[e.jsx(ng,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",className:"text-xs",children:[e.jsx(Wi,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:U.model}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[U.overall_ms.toFixed(0),"ms"]})]})]}),e.jsx("p",{className:"text-sm line-clamp-2",children:U.output_preview||""})]},U.filename))}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",v.total,"  ",O," / ",K," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(1),disabled:O===1,children:e.jsx(hn,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(U=>Math.max(1,U-1)),disabled:O===1,children:e.jsx(Va,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",min:1,max:K,value:E,onChange:U=>C(U.target.value),onKeyDown:U=>U.key==="Enter"&&Ce(),placeholder:"",className:"w-20 h-8"}),e.jsx(S,{size:"sm",variant:"outline",onClick:Ce,children:""})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(U=>Math.min(K,U+1)),disabled:O===K,children:e.jsx(sa,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>A(K),disabled:O===K,children:e.jsx(fn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Ps,{open:ce,onOpenChange:ve,children:e.jsxs(Us,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-5 w-5"}),""]}),e.jsx(Js,{children:""})]}),e.jsx(Je,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:se?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((U,V)=>e.jsx(js,{className:"h-24 w-full"},V))}):R?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Ca,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:R.chat_id,children:h(R.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Fo(R.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),R.success?e.jsxs(ke,{variant:"default",className:"bg-green-600",children:[e.jsx(ng,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",children:[e.jsx(Wi,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{variant:"outline",children:["Level ",R.think_level]})]})]})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(l_,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx(ke,{variant:"secondary",className:"text-sm",children:R.model})})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Xa,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(Se,{children:[e.jsx(ze,{className:"p-4 pb-2",children:e.jsx(Re,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[R.timing.prompt_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Se,{children:[e.jsx(ze,{className:"p-4 pb-2",children:e.jsx(Re,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[R.timing.llm_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Se,{children:[e.jsx(ze,{className:"p-4 pb-2",children:e.jsx(Re,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Me,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[R.timing.overall_ms?.toFixed(2)||0,"ms"]})})]})]}),R.timing.timing_logs&&R.timing.timing_logs.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"space-y-1",children:R.timing.timing_logs.map((U,V)=>e.jsx("div",{className:"text-xs text-muted-foreground",children:U},V))})]}),R.timing.almost_zero&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),R.timing.almost_zero]})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Xm,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:R.output||""})})]}),R.processed_output&&R.processed_output.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-2",children:R.processed_output.map((U,V)=>e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:U})},V))})]})]}),R.reasoning&&e.jsxs(e.Fragment,{children:[e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:R.reasoning})})]})]}),R.error&&e.jsxs(e.Fragment,{children:[e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-destructive",children:""}),e.jsx("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:e.jsx("p",{className:"text-sm text-destructive whitespace-pre-wrap",children:R.error})})]})]}),R.prompt&&e.jsxs(e.Fragment,{children:[e.jsx(Qt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:R.prompt})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(et,{className:"flex-shrink-0",children:e.jsx(S,{onClick:()=>ve(!1),children:""})})]})})]})}function uk(){const[l,n]=m.useState("planner"),[i,c]=m.useState(!1),[u,x]=m.useState(0),h=m.useCallback(()=>{x(f=>f+1)},[]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:" & "}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{variant:i?"default":"outline",size:"sm",onClick:()=>c(!i),children:[e.jsx(ft,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),i?"":""]}),e.jsx(S,{variant:"outline",size:"sm",onClick:h,children:e.jsx(ft,{className:"h-4 w-4"})})]})]}),e.jsxs(ra,{value:l,onValueChange:f=>n(f),className:"w-full",children:[e.jsxs(ea,{className:"grid w-full grid-cols-2 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(ts,{value:"planner",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Gm,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(ts,{value:"replier",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(n_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Je,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(ys,{value:"planner",className:"mt-0",children:e.jsx(ok,{autoRefresh:i,refreshKey:u})}),e.jsx(ys,{value:"replier",className:"mt-0",children:e.jsx(dk,{autoRefresh:i,refreshKey:u})})]})]})]})}const mk="Mai-with-u",xk="plugin-repo",hk="main",fk="plugin_details.json";async function pk(){try{const l=await we("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:mk,repo:xk,branch:hk,file_path:fk})});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const n=await l.json();if(!n.success||!n.data)throw new Error(n.error||"");return JSON.parse(n.data).filter(u=>!u?.id||!u?.manifest?(console.warn(":",u),!1):!u.manifest.name||!u.manifest.version?(console.warn(":",u.id),!1):!0).map(u=>({id:u.id,manifest:{manifest_version:u.manifest.manifest_version||1,name:u.manifest.name,version:u.manifest.version,description:u.manifest.description||"",author:u.manifest.author||{name:"Unknown"},license:u.manifest.license||"Unknown",host_application:u.manifest.host_application||{min_version:"0.0.0"},homepage_url:u.manifest.homepage_url,repository_url:u.manifest.repository_url,keywords:u.manifest.keywords||[],categories:u.manifest.categories||[],default_locale:u.manifest.default_locale||"zh-CN",locales_path:u.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()}))}catch(l){throw console.error("Failed to fetch plugin list:",l),l}}async function zv(){try{const l=await we("/api/webui/plugins/git-status");if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){return console.error("Failed to check Git status:",l),{installed:!1,error:" Git "}}}async function Ov(){try{const l=await we("/api/webui/plugins/version");if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){return console.error("Failed to get Maimai version:",l),{version:"0.0.0",version_major:0,version_minor:0,version_patch:0}}}function Dv(l,n,i){const c=l.split(".").map(f=>parseInt(f)||0),u=c[0]||0,x=c[1]||0,h=c[2]||0;if(i.version_major<u||i.version_major===u&&i.version_minor<x||i.version_major===u&&i.version_minor===x&&i.version_patch<h)return!1;if(n){const f=n.split(".").map(v=>parseInt(v)||0),p=f[0]||0,g=f[1]||0,N=f[2]||0;if(i.version_major>p||i.version_major===p&&i.version_minor>g||i.version_major===p&&i.version_minor===g&&i.version_patch>N)return!1}return!0}async function gk(){try{const l=await we("/api/webui/ws-token");if(!l.ok)return console.error(" WebSocket token :",l.status),null;const n=await l.json();return n.success&&n.token?n.token:null}catch(l){return console.error(" WebSocket token :",l),null}}async function jk(l,n){const i=await gk();if(!i)return console.warn(" WebSocket token"),null;const c=window.location.protocol==="https:"?"wss:":"ws:",u=window.location.host,x=`${c}//${u}/api/webui/ws/plugin-progress?token=${encodeURIComponent(i)}`;try{const h=new WebSocket(x);return h.onopen=()=>{console.log("Plugin progress WebSocket connected");const f=setInterval(()=>{h.readyState===WebSocket.OPEN?h.send("ping"):clearInterval(f)},3e4)},h.onmessage=f=>{try{if(f.data==="pong")return;const p=JSON.parse(f.data);l(p)}catch(p){console.error("Failed to parse progress data:",p)}},h.onerror=f=>{console.error("Plugin progress WebSocket error:",f),n?.(f)},h.onclose=()=>{console.log("Plugin progress WebSocket disconnected")},h}catch(h){return console.error(" WebSocket :",h),null}}async function Ml(){try{const l=await we("/api/webui/plugins/installed",{headers:Fs()});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const n=await l.json();if(!n.success)throw new Error(n.message||"");return n.plugins||[]}catch(l){return console.error("Failed to get installed plugins:",l),[]}}function dn(l,n){return n.some(i=>i.id===l)}function un(l,n){const i=n.find(c=>c.id===l);if(i)return i.manifest?.version||i.version}async function Rv(l,n,i="main"){const c=await we("/api/webui/plugins/install",{method:"POST",body:JSON.stringify({plugin_id:l,repository_url:n,branch:i})});if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return await c.json()}async function Lv(l){const n=await we("/api/webui/plugins/uninstall",{method:"POST",body:JSON.stringify({plugin_id:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function Uv(l,n,i="main"){const c=await we("/api/webui/plugins/update",{method:"POST",body:JSON.stringify({plugin_id:l,repository_url:n,branch:i})});if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return await c.json()}async function vk(l){const n=await we(`/api/webui/plugins/config/${l}/schema`,{headers:Fs()});if(!n.ok){const c=await n.text();try{const u=JSON.parse(c);throw new Error(u.detail||" Schema ")}catch{throw new Error(` Schema  (${n.status})`)}}const i=await n.json();if(!i.success)throw new Error(i.message||" Schema ");return i.schema}async function Nk(l){const n=await we(`/api/webui/plugins/config/${l}`,{headers:Fs()});if(!n.ok){const c=await n.text();try{const u=JSON.parse(c);throw new Error(u.detail||"")}catch{throw new Error(` (${n.status})`)}}const i=await n.json();if(!i.success)throw new Error(i.message||"");return i.config}async function bk(l){const n=await we(`/api/webui/plugins/config/${l}/raw`,{headers:Fs()});if(!n.ok){const c=await n.text();try{const u=JSON.parse(c);throw new Error(u.detail||"")}catch{throw new Error(` (${n.status})`)}}const i=await n.json();if(!i.success)throw new Error(i.message||"");return i.config}async function yk(l,n){const i=await we(`/api/webui/plugins/config/${l}`,{method:"PUT",headers:Fs(),body:JSON.stringify({config:n})});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return await i.json()}async function wk(l,n){const i=await we(`/api/webui/plugins/config/${l}/raw`,{method:"PUT",headers:Fs(),body:JSON.stringify({config:n})});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return await i.json()}async function _k(l){const n=await we(`/api/webui/plugins/config/${l}/reset`,{method:"POST",headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function Sk(l){const n=await we(`/api/webui/plugins/config/${l}/toggle`,{method:"POST",headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}const uc="https://maibot-plugin-stats.maibot-webui.workers.dev";async function $v(l){try{const n=await fetch(`${uc}/stats/${l}`);return n.ok?await n.json():(console.error("Failed to fetch plugin stats:",n.statusText),null)}catch(n){return console.error("Error fetching plugin stats:",n),null}}async function kk(l,n){try{const i=n||cx(),c=await fetch(`${uc}/stats/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l,user_id:i})}),u=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...u}:{success:!1,error:u.error||""}}catch(i){return console.error("Error liking plugin:",i),{success:!1,error:""}}}async function Ck(l,n){try{const i=n||cx(),c=await fetch(`${uc}/stats/dislike`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l,user_id:i})}),u=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...u}:{success:!1,error:u.error||""}}catch(i){return console.error("Error disliking plugin:",i),{success:!1,error:""}}}async function Tk(l,n,i,c){if(n<1||n>5)return{success:!1,error:" 1-5 "};try{const u=c||cx(),x=await fetch(`${uc}/stats/rate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l,rating:n,comment:i,user_id:u})}),h=await x.json();return x.status===429?{success:!1,error:" 3 "}:x.ok?{success:!0,...h}:{success:!1,error:h.error||""}}catch(u){return console.error("Error rating plugin:",u),{success:!1,error:""}}}async function Bv(l){try{const n=await fetch(`${uc}/stats/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l})}),i=await n.json();return n.status===429?(console.warn("Download recording rate limited"),{success:!0}):n.ok?{success:!0,...i}:(console.error("Failed to record download:",i.error),{success:!1,error:i.error})}catch(n){return console.error("Error recording download:",n),{success:!1,error:""}}}function Ek(){const l=navigator,n=[navigator.userAgent,navigator.language,navigator.languages?.join(",")||"",navigator.platform,navigator.hardwareConcurrency||0,screen.width,screen.height,screen.colorDepth,screen.pixelDepth,new Date().getTimezoneOffset(),Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.maxTouchPoints||0,l.deviceMemory||0].join("|");let i=0;for(let c=0;c<n.length;c++){const u=n.charCodeAt(c);i=(i<<5)-i+u,i=i&i}return`fp_${Math.abs(i).toString(36)}`}function cx(){const l="maibot_user_id";let n=localStorage.getItem(l);if(!n){const i=Ek(),c=Date.now().toString(36),u=Math.random().toString(36).substring(2,15);n=`${i}_${c}_${u}`,localStorage.setItem(l,n)}return n}const Mk={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function Ak(){return e.jsx(Kn,{children:e.jsx(zk,{})})}function zk(){const l=ia(),{triggerRestart:n,isRestarting:i}=pn(),[c,u]=m.useState(""),[x,h]=m.useState("all"),[f,p]=m.useState("all"),[g,N]=m.useState(!0),[v,y]=m.useState([]),[w,b]=m.useState(!0),[O,A]=m.useState(null),[_,H]=m.useState(null),[E,C]=m.useState(null),[M,G]=m.useState(null),[,D]=m.useState([]),[ee,R]=m.useState({}),[me,ce]=m.useState(!1),[ve,se]=m.useState(null),[ge,fe]=m.useState("main"),[z,Q]=m.useState(""),[I,L]=m.useState("preset"),[B,_e]=m.useState(!1),{toast:je}=st(),Ce=async Y=>{const te=Y.map(async Ae=>{try{const de=await $v(Ae.id);return{id:Ae.id,stats:de}}catch(de){return console.warn(`Failed to load stats for ${Ae.id}:`,de),{id:Ae.id,stats:null}}}),Ue=await Promise.all(te),Le={};Ue.forEach(({id:Ae,stats:de})=>{de&&(Le[Ae]=de)}),R(Le)};m.useEffect(()=>{let Y=null,te=!1;return(async()=>{if(Y=await jk(Le=>{te||(C(Le),Le.stage==="success"?setTimeout(()=>{te||C(null)},2e3):Le.stage==="error"&&(b(!1),A(Le.error||"")))},Le=>{console.error("WebSocket error:",Le),te||je({title:"WebSocket ",description:"",variant:"destructive"})}),await new Promise(Le=>{if(!Y){Le();return}const Ae=()=>{Y&&Y.readyState===WebSocket.OPEN?(console.log("WebSocket connected, starting to load plugins"),Le()):Y&&Y.readyState===WebSocket.CLOSED?(console.warn("WebSocket closed before loading plugins"),Le()):setTimeout(Ae,100)};Ae()}),!te){const Le=await zv();H(Le),Le.installed||je({title:"Git ",description:Le.error||" Git ",variant:"destructive"})}if(!te){const Le=await Ov();G(Le)}if(!te)try{b(!0),A(null);const Le=await pk();if(!te){const Ae=await Ml();D(Ae);const de=Le.map(Te=>{const rs=dn(Te.id,Ae),Rt=un(Te.id,Ae);return{...Te,installed:rs,installed_version:Rt}});for(const Te of Ae)!de.some(Rt=>Rt.id===Te.id)&&Te.manifest&&de.push({id:Te.id,manifest:{manifest_version:Te.manifest.manifest_version||1,name:Te.manifest.name,version:Te.manifest.version,description:Te.manifest.description||"",author:Te.manifest.author,license:Te.manifest.license||"Unknown",host_application:Te.manifest.host_application,homepage_url:Te.manifest.homepage_url,repository_url:Te.manifest.repository_url,keywords:Te.manifest.keywords||[],categories:Te.manifest.categories||[],default_locale:Te.manifest.default_locale||"zh-CN",locales_path:Te.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!0,installed_version:Te.manifest.version,published_at:new Date().toISOString(),updated_at:new Date().toISOString()});y(de),Ce(de)}}catch(Le){if(!te){const Ae=Le instanceof Error?Le.message:"";A(Ae),je({title:"",description:Ae,variant:"destructive"})}}finally{te||b(!1)}})(),()=>{te=!0,Y&&Y.close()}},[je]);const K=Y=>{if(!Y.installed&&M&&!U(Y))return e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(St,{className:"h-3 w-3"}),""]});if(Y.installed){const te=Y.installed_version?.trim(),Ue=Y.manifest.version?.trim();if(te!==Ue){const Le=te?.split(".").map(Number)||[0,0,0],Ae=Ue?.split(".").map(Number)||[0,0,0];for(let de=0;de<3;de++){if((Ae[de]||0)>(Le[de]||0))return e.jsxs(ke,{variant:"outline",className:"gap-1 text-orange-600 border-orange-600",children:[e.jsx(St,{className:"h-3 w-3"}),""]});if((Ae[de]||0)<(Le[de]||0))break}}return e.jsxs(ke,{variant:"default",className:"gap-1",children:[e.jsx(Wt,{className:"h-3 w-3"}),""]})}return null},U=Y=>!M||!Y.manifest?.host_application?!0:Dv(Y.manifest.host_application.min_version,Y.manifest.host_application.max_version,M),V=Y=>{if(!Y.installed||!Y.installed_version||!Y.manifest?.version)return!1;const te=Y.installed_version.trim(),Ue=Y.manifest.version.trim();if(te===Ue)return!1;const Le=te.split(".").map(Number),Ae=Ue.split(".").map(Number);for(let de=0;de<3;de++){if((Ae[de]||0)>(Le[de]||0))return!0;if((Ae[de]||0)<(Le[de]||0))return!1}return!1},xe=v.filter(Y=>{if(!Y.manifest)return console.warn("[]  manifest :",Y.id),!1;const te=c===""||Y.manifest.name?.toLowerCase().includes(c.toLowerCase())||Y.manifest.description?.toLowerCase().includes(c.toLowerCase())||Y.manifest.keywords&&Y.manifest.keywords.some(de=>de.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Y.manifest.categories&&Y.manifest.categories.includes(x);let Le=!0;f==="installed"?Le=Y.installed===!0:f==="updates"&&(Le=Y.installed===!0&&V(Y));const Ae=!g||!M||U(Y);return te&&Ue&&Le&&Ae}),Oe=Y=>{if(!_?.installed){je({title:"",description:"Git ",variant:"destructive"});return}if(M&&!U(Y)){je({title:"",description:"",variant:"destructive"});return}se(Y),fe("main"),Q(""),L("preset"),_e(!1),ce(!0)},X=async()=>{if(!ve)return;const Y=I==="custom"?z:ge;if(!Y||Y.trim()===""){je({title:"",variant:"destructive"});return}try{ce(!1),await Rv(ve.id,ve.manifest.repository_url||"",Y),Bv(ve.id).catch(Ue=>{console.warn("Failed to record download:",Ue)}),je({title:"",description:`${ve.manifest.name} `});const te=await Ml();D(te),y(Ue=>Ue.map(Le=>{if(Le.id===ve.id){const Ae=dn(Le.id,te),de=un(Le.id,te);return{...Le,installed:Ae,installed_version:de}}return Le}))}catch(te){je({title:"",description:te instanceof Error?te.message:"",variant:"destructive"})}finally{se(null)}},oe=async Y=>{try{await Lv(Y.id),je({title:"",description:`${Y.manifest.name} `});const te=await Ml();D(te),y(Ue=>Ue.map(Le=>{if(Le.id===Y.id){const Ae=dn(Le.id,te),de=un(Le.id,te);return{...Le,installed:Ae,installed_version:de}}return Le}))}catch(te){je({title:"",description:te instanceof Error?te.message:"",variant:"destructive"})}},Ge=async Y=>{if(!_?.installed){je({title:"",description:"Git ",variant:"destructive"});return}try{const te=await Uv(Y.id,Y.manifest.repository_url||"","main");je({title:"",description:`${Y.manifest.name}  ${te.old_version}  ${te.new_version}`});const Ue=await Ml();D(Ue),y(Le=>Le.map(Ae=>{if(Ae.id===Y.id){const de=dn(Ae.id,Ue),Te=un(Ae.id,Ue);return{...Ae,installed:de,installed_version:Te}}return Ae}))}catch(te){je({title:"",description:te instanceof Error?te.message:"",variant:"destructive"})}};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{variant:"outline",onClick:()=>n(),disabled:i,children:[e.jsx(Lj,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),""]}),e.jsxs(S,{onClick:()=>l({to:"/plugin-mirrors"}),children:[e.jsx(r_,{className:"h-4 w-4 mr-2"}),""]})]})]}),e.jsx(Se,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900",children:e.jsx(Me,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pt,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["",e.jsx("span",{className:"font-semibold",children:""}),""]})]})})}),_&&!_.installed&&e.jsxs(Se,{className:"border-orange-600 bg-orange-50 dark:bg-orange-950/20",children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Yt,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx(Re,{className:"text-lg text-orange-900 dark:text-orange-100",children:"Git "}),e.jsx(ws,{className:"text-orange-800 dark:text-orange-200",children:_.error||" Git "})]})]})}),e.jsx(Me,{children:e.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[" ",e.jsx("a",{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer",className:"underline font-medium",children:"git-scm.com"}),"  Git "]})})]}),e.jsx(Se,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:c,onChange:Y=>u(Y.target.value),className:"pl-9"})]}),e.jsxs(Ie,{value:x,onValueChange:h,children:[e.jsx($e,{className:"w-full sm:w-[200px]",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"all",children:""}),e.jsx(W,{value:"Group Management",children:""}),e.jsx(W,{value:"Entertainment & Interaction",children:""}),e.jsx(W,{value:"Utility Tools",children:""}),e.jsx(W,{value:"Content Generation",children:""}),e.jsx(W,{value:"Multimedia",children:""}),e.jsx(W,{value:"External Integration",children:""}),e.jsx(W,{value:"Data Analysis & Insights",children:""}),e.jsx(W,{value:"Other",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"compatible-only",checked:g,onCheckedChange:Y=>N(Y===!0)}),e.jsx("label",{htmlFor:"compatible-only",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:""})]})]})}),e.jsx(ra,{value:f,onValueChange:p,className:"w-full",children:e.jsxs(ea,{className:"grid w-full grid-cols-3",children:[e.jsxs(ts,{value:"all",children:[" (",v.filter(Y=>{if(!Y.manifest)return!1;const te=c===""||Y.manifest.name?.toLowerCase().includes(c.toLowerCase())||Y.manifest.description?.toLowerCase().includes(c.toLowerCase())||Y.manifest.keywords&&Y.manifest.keywords.some(Ae=>Ae.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Y.manifest.categories&&Y.manifest.categories.includes(x),Le=!g||!M||U(Y);return te&&Ue&&Le}).length,")"]}),e.jsxs(ts,{value:"installed",children:[" (",v.filter(Y=>{if(!Y.manifest)return!1;const te=c===""||Y.manifest.name?.toLowerCase().includes(c.toLowerCase())||Y.manifest.description?.toLowerCase().includes(c.toLowerCase())||Y.manifest.keywords&&Y.manifest.keywords.some(Ae=>Ae.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Y.manifest.categories&&Y.manifest.categories.includes(x),Le=!g||!M||U(Y);return Y.installed&&te&&Ue&&Le}).length,")"]}),e.jsxs(ts,{value:"updates",children:[" (",v.filter(Y=>{if(!Y.manifest)return!1;const te=c===""||Y.manifest.name?.toLowerCase().includes(c.toLowerCase())||Y.manifest.description?.toLowerCase().includes(c.toLowerCase())||Y.manifest.keywords&&Y.manifest.keywords.some(Ae=>Ae.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Y.manifest.categories&&Y.manifest.categories.includes(x),Le=!g||!M||U(Y);return Y.installed&&V(Y)&&te&&Ue&&Le}).length,")"]})]})}),E&&E.stage==="loading"&&E.operation==="fetch"&&e.jsx(Se,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:""})]}),e.jsxs("span",{className:"text-sm font-medium",children:[E.progress,"%"]})]}),e.jsx(Vn,{value:E.progress,className:"h-2"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:E.message}),E.total_plugins>0&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[" ",E.loaded_plugins," / ",E.total_plugins," "]})]})}),E&&E.stage==="error"&&E.error&&e.jsx(Se,{className:"border-destructive bg-destructive/10",children:e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Yt,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx(Re,{className:"text-lg text-destructive",children:""}),e.jsx(ws,{className:"text-destructive/80",children:E.error})]})]})})}),w?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Ls,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]}):O?e.jsx(Se,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Yt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:O}),e.jsx(S,{onClick:()=>window.location.reload(),children:""})]})}):xe.length===0?e.jsx(Se,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Dt,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||x!=="all"?"":""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:xe.map(Y=>e.jsxs(Se,{className:"flex flex-col hover:shadow-lg transition-shadow h-full",children:[e.jsxs(ze,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(Re,{className:"text-xl",children:Y.manifest?.name||Y.id}),e.jsxs("div",{className:"flex flex-col gap-1",children:[Y.manifest?.categories&&Y.manifest.categories[0]&&e.jsx(ke,{variant:"secondary",className:"text-xs whitespace-nowrap",children:Mk[Y.manifest.categories[0]]||Y.manifest.categories[0]}),K(Y)]})]}),e.jsx(ws,{className:"line-clamp-2",children:Y.manifest?.description||""})]}),e.jsx(Me,{className:"flex-1",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsx("span",{children:(ee[Y.id]?.downloads??Y.downloads??0).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(cn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:(ee[Y.id]?.rating??Y.rating??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Y.manifest?.keywords&&Y.manifest.keywords.slice(0,3).map(te=>e.jsx(ke,{variant:"outline",className:"text-xs",children:te},te)),Y.manifest?.keywords&&Y.manifest.keywords.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",Y.manifest.keywords.length-3]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t space-y-1",children:[e.jsxs("div",{children:["v",Y.manifest?.version||"unknown","  ",Y.manifest?.author?.name||"Unknown"]}),Y.manifest?.host_application&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:":"}),e.jsxs("span",{className:"font-medium",children:[Y.manifest.host_application.min_version,Y.manifest.host_application.max_version?` - ${Y.manifest.host_application.max_version}`:" - "]})]})]})]})}),e.jsx(Zo,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>l({to:"/plugin-detail",search:{pluginId:Y.id}}),children:""}),Y.installed?V(Y)?e.jsxs(S,{size:"sm",disabled:!_?.installed,title:_?.installed?void 0:"Git ",onClick:()=>Ge(Y),children:[e.jsx(ft,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(S,{variant:"destructive",size:"sm",disabled:!_?.installed,title:_?.installed?void 0:"Git ",onClick:()=>oe(Y),children:[e.jsx(ns,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(S,{size:"sm",disabled:!_?.installed||E?.operation==="install"||M!==null&&!U(Y),title:_?.installed?M!==null&&!U(Y)?` ( ${Y.manifest?.host_application?.min_version||""}${Y.manifest?.host_application?.max_version?` - ${Y.manifest.host_application.max_version}`:"+"} ${M?.version})`:void 0:"Git ",onClick:()=>Oe(Y),children:[e.jsx(Zt,{className:"h-4 w-4 mr-1"}),E?.operation==="install"&&E?.plugin_id===Y.id?"...":""]})]})}),E&&(E.stage==="loading"||E.stage==="success"||E.stage==="error")&&E.operation!=="fetch"&&E.plugin_id===Y.id&&e.jsx("div",{className:"px-6 pb-4 -mt-2",children:e.jsxs("div",{className:`space-y-2 p-3 rounded-lg border ${E.stage==="success"?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-900":E.stage==="error"?"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-900":"bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[E.stage==="loading"?e.jsx(Ls,{className:"h-3 w-3 animate-spin"}):E.stage==="success"?e.jsx(Wt,{className:"h-3 w-3 text-green-600"}):e.jsx(St,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":E.stage==="error"?"text-red-700 dark:text-red-300":""}`,children:E.stage==="loading"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):E.stage==="success"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]})})]}),E.stage!=="error"&&e.jsxs("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":""}`,children:[E.progress,"%"]})]}),E.stage!=="error"&&e.jsx(Vn,{value:E.progress,className:`h-1.5 ${E.stage==="success"?"[&>div]:bg-green-500":""}`}),e.jsx("div",{className:`text-xs ${E.stage==="success"?"text-green-600 dark:text-green-400 truncate":E.stage==="error"?"text-red-600 dark:text-red-400":"text-muted-foreground truncate"}`,children:E.stage==="error"?E.error||E.message||"":E.message})]})})]},Y.id))}),e.jsx(Ps,{open:me,onOpenChange:ce,children:e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsxs(Js,{children:[" ",ve?.manifest.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",ve?.manifest.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",typeof ve?.manifest.author=="string"?ve.manifest.author:ve?.manifest.author?.name]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"advanced-options",checked:B,onCheckedChange:Y=>_e(Y)}),e.jsx("label",{htmlFor:"advanced-options",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:""})]}),B&&e.jsx("div",{className:"space-y-4 p-4 border rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:""}),e.jsxs(ra,{value:I,onValueChange:Y=>L(Y),children:[e.jsxs(ea,{className:"grid w-full grid-cols-2",children:[e.jsx(ts,{value:"preset",className:"text-xs",children:""}),e.jsx(ts,{value:"custom",className:"text-xs",children:""})]}),I==="preset"&&e.jsx("div",{className:"mt-3",children:e.jsxs(Ie,{value:ge,onValueChange:fe,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(W,{value:"main",children:"main ()"}),e.jsx(W,{value:"master",children:"master"}),e.jsx(W,{value:"dev",children:"dev ()"}),e.jsx(W,{value:"develop",children:"develop"}),e.jsx(W,{value:"beta",children:"beta ()"}),e.jsx(W,{value:"stable",children:"stable ()"})]})]})}),I==="custom"&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:": feature/new-feature",value:z,onChange:Y=>Q(Y.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Git "})]})]})]})}),!B&&e.jsx("p",{className:"text-sm text-muted-foreground",children:" (main) "})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>ce(!1),children:""}),e.jsxs(S,{onClick:X,children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),""]})]})]})}),e.jsx(Qn,{})]})})}function Ok(){return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Uj,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Je,{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)]",children:e.jsxs(Se,{className:"max-w-2xl w-full border-dashed",children:[e.jsxs(ze,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(la,{className:"h-16 w-16 text-muted-foreground"})}),e.jsx(Re,{className:"text-2xl",children:""}),e.jsx(ws,{className:"text-base",children:""})]}),e.jsx(Me,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:" "}),e.jsxs("ul",{className:"space-y-2 ml-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]})]})]})})]})})})]})}function Dk({field:l,value:n,onChange:i}){const[c,u]=m.useState(!1);switch(l.ui_type){case"switch":return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:l.label}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]}),e.jsx(Fe,{checked:!!n,onCheckedChange:i,disabled:l.disabled})]});case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:l.label}),e.jsx(ne,{type:"number",value:n??l.default,onChange:x=>i(parseFloat(x.target.value)||0),min:l.min,max:l.max,step:l.step??1,placeholder:l.placeholder,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"slider":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:l.label}),e.jsx("span",{className:"text-sm text-muted-foreground",children:n??l.default})]}),e.jsx(Sa,{value:[n??l.default],onValueChange:x=>i(x[0]),min:l.min??0,max:l.max??100,step:l.step??1,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:l.label}),e.jsxs(Ie,{value:String(n??l.default),onValueChange:i,disabled:l.disabled,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:l.placeholder??""})}),e.jsx(Be,{children:l.choices?.map(x=>e.jsx(W,{value:String(x),children:String(x)},String(x)))})]}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:l.label}),e.jsx(at,{value:n??l.default,onChange:x=>i(x.target.value),placeholder:l.placeholder,rows:l.rows??3,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"password":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:l.label}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{type:c?"text":"password",value:n??"",onChange:x=>i(x.target.value),placeholder:l.placeholder,disabled:l.disabled,className:"pr-10"}),e.jsx(S,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>u(!c),children:c?e.jsx(Zi,{className:"h-4 w-4"}):e.jsx(na,{className:"h-4 w-4"})})]}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"list":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:l.label}),e.jsx(z1,{value:Array.isArray(n)?n:[],onChange:x=>i(x),itemType:l.item_type??"string",itemFields:l.item_fields,minItems:l.min_items,maxItems:l.max_items,disabled:l.disabled,placeholder:l.placeholder}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"text":default:return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:l.label}),e.jsx(ne,{type:"text",value:n??l.default??"",onChange:x=>i(x.target.value),placeholder:l.placeholder,maxLength:l.max_length,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]})}}function Og({section:l,config:n,onChange:i}){const[c,u]=m.useState(!l.collapsed),x=Object.entries(l.fields).filter(([,h])=>!h.hidden).sort(([,h],[,f])=>h.order-f.order);return e.jsx(nc,{open:c,onOpenChange:u,children:e.jsxs(Se,{children:[e.jsx(rc,{asChild:!0,children:e.jsxs(ze,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx(Aa,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(sa,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(Re,{className:"text-lg",children:l.title})]}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[x.length," "]})]}),l.description&&e.jsx(ws,{className:"ml-6",children:l.description})]})}),e.jsx(ic,{children:e.jsx(Me,{className:"space-y-4 pt-0",children:x.map(([h,f])=>e.jsx(Dk,{field:f,value:n[l.name]?.[h],onChange:p=>i(l.name,h,p),sectionName:l.name},h))})})]})})}function Rk({plugin:l,onBack:n}){const{toast:i}=st(),{triggerRestart:c,isRestarting:u}=pn(),[x,h]=m.useState("visual"),[f,p]=m.useState(null),[g,N]=m.useState({}),[v,y]=m.useState({}),[w,b]=m.useState(""),[O,A]=m.useState(""),[_,H]=m.useState(!0),[E,C]=m.useState(!1),[M,G]=m.useState(!1),[D,ee]=m.useState(!1),[R,me]=m.useState(!1),ce=m.useCallback(async()=>{H(!0);try{const[I,L,B]=await Promise.all([vk(l.id),Nk(l.id),bk(l.id)]);p(I),N(L),y(JSON.parse(JSON.stringify(L))),b(B),A(B)}catch(I){i({title:"",description:I instanceof Error?I.message:"",variant:"destructive"})}finally{H(!1)}},[l.id,i]);m.useEffect(()=>{ce()},[ce]),m.useEffect(()=>{G(x==="visual"?JSON.stringify(g)!==JSON.stringify(v):w!==O)},[g,v,w,O,x]);const ve=(I,L,B)=>{N(_e=>({..._e,[I]:{..._e[I]||{},[L]:B}}))},se=async()=>{C(!0);try{if(x==="source"){try{wv(w)}catch(I){ee(!0),i({title:"TOML ",description:I instanceof Error?I.message:" TOML ",variant:"destructive"}),C(!1);return}await wk(l.id,w),A(w),ee(!1)}else await yk(l.id,g),y(JSON.parse(JSON.stringify(g)));i({title:"",description:""})}catch(I){i({title:"",description:I instanceof Error?I.message:"",variant:"destructive"})}finally{C(!1)}},ge=async()=>{try{await _k(l.id),i({title:"",description:""}),me(!1),ce()}catch(I){i({title:"",description:I instanceof Error?I.message:"",variant:"destructive"})}},fe=async()=>{try{const I=await Sk(l.id);i({title:I.message,description:I.note}),ce()}catch(I){i({title:"",description:I instanceof Error?I.message:"",variant:"destructive"})}};if(_)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Ls,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!f)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx(St,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsxs(S,{onClick:n,variant:"outline",children:[e.jsx(Ta,{className:"h-4 w-4 mr-2"}),""]})]});const z=Object.values(f.sections).sort((I,L)=>I.order-L.order),Q=g.plugin?.enabled!==!1;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:n,children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:f.plugin_info.name||l.manifest.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ke,{variant:Q?"default":"secondary",children:Q?"":""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["v",f.plugin_info.version||l.manifest.version]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-10 sm:ml-0",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>h(x==="visual"?"source":"visual"),children:x==="visual"?e.jsxs(e.Fragment,{children:[e.jsx(Oj,{className:"h-4 w-4 mr-2"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(zj,{className:"h-4 w-4 mr-2"}),""]})}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>c(),disabled:u,children:[e.jsx(Lj,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),""]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:fe,children:[e.jsx(cc,{className:"h-4 w-4 mr-2"}),Q?"":""]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>me(!0),children:[e.jsx(Xi,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs(S,{size:"sm",onClick:se,disabled:!M||E,children:[E?e.jsx(Ls,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(oc,{className:"h-4 w-4 mr-2"}),""]})]})]}),M&&e.jsx(Se,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20 dark:border-orange-900",children:e.jsx(Me,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pt,{className:"h-4 w-4 text-orange-600"}),e.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:""})]})})}),x==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(lt,{children:[e.jsx(St,{className:"h-4 w-4"}),e.jsxs(nt,{children:[e.jsx("strong",{children:""})," TOML ",D&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(mv,{value:w,onChange:I=>{b(I),D&&ee(!1)},language:"toml",theme:"dark",height:"calc(100vh - 350px)",minHeight:"500px",placeholder:"TOML "})]}),x==="visual"&&e.jsxs(e.Fragment,{children:[e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs(nt,{children:[e.jsx("strong",{children:""}),"WebUI  "]})]}),f.layout.type==="tabs"&&f.layout.tabs.length>0?e.jsxs(ra,{defaultValue:f.layout.tabs[0]?.id,children:[e.jsx(ea,{children:f.layout.tabs.map(I=>e.jsxs(ts,{value:I.id,children:[I.title,I.badge&&e.jsx(ke,{variant:"secondary",className:"ml-2 text-xs",children:I.badge})]},I.id))}),f.layout.tabs.map(I=>e.jsx(ys,{value:I.id,className:"space-y-4 mt-4",children:I.sections.map(L=>{const B=f.sections[L];return B?e.jsx(Og,{section:B,config:g,onChange:ve},L):null})},I.id))]}):e.jsx("div",{className:"space-y-4",children:z.map(I=>e.jsx(Og,{section:I,config:g,onChange:ve},I.name))})]}),e.jsx(Ps,{open:R,onOpenChange:me,children:e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>me(!1),children:""}),e.jsx(S,{variant:"destructive",onClick:ge,children:""})]})]})})]})}function Lk(){return e.jsx(Kn,{children:e.jsx(Uk,{})})}function Uk(){const{toast:l}=st(),[n,i]=m.useState([]),[c,u]=m.useState(!0),[x,h]=m.useState(""),[f,p]=m.useState(null),g=async()=>{u(!0);try{const b=await Ml();i(b)}catch(b){l({title:"",description:b instanceof Error?b.message:"",variant:"destructive"})}finally{u(!1)}};m.useEffect(()=>{g()},[]);const v=n.filter(b=>{const O=x.toLowerCase();return b.id.toLowerCase().includes(O)||b.manifest.name.toLowerCase().includes(O)||b.manifest.description?.toLowerCase().includes(O)}).filter((b,O,A)=>O===A.findIndex(_=>_.id===b.id)),y=n.length,w=0;return f?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-full",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(Rk,{plugin:f,onBack:()=>p(null)})})}),e.jsx(Qn,{})]}):e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:g,children:[e.jsx(ft,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),""]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(la,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c?"...":""})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(Wt,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]}),e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:""}),e.jsx(St,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:w}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:x,onChange:b=>h(b.target.value),className:"pl-9"})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Ls,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):v.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(la,{className:"h-16 w-16 text-muted-foreground/50"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:x?"":""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x?"":""})]})]}):e.jsx("div",{className:"space-y-2",children:v.map(b=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>p(b),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(la,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:b.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs flex-shrink-0",children:["v",b.manifest.version]})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:b.manifest.description||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(S,{variant:"ghost",size:"sm",children:e.jsx(xn,{className:"h-4 w-4"})}),e.jsx(sa,{className:"h-4 w-4 text-muted-foreground"})]})]},b.id))})})]})]})})}function $k(){const l=ia(),{toast:n}=st(),[i,c]=m.useState([]),[u,x]=m.useState(!0),[h,f]=m.useState(null),[p,g]=m.useState(null),[N,v]=m.useState(!1),[y,w]=m.useState(!1),[b,O]=m.useState({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),A=m.useCallback(async()=>{try{x(!0),f(null);const D=await we("/api/webui/plugins/mirrors");if(!D.ok)throw new Error("");const ee=await D.json();c(ee.mirrors||[])}catch(D){const ee=D instanceof Error?D.message:"";f(ee),n({title:"",description:ee,variant:"destructive"})}finally{x(!1)}},[n]);m.useEffect(()=>{A()},[A]);const _=async()=>{try{const D=await we("/api/webui/plugins/mirrors",{method:"POST",body:JSON.stringify(b)});if(!D.ok){const ee=await D.json();throw new Error(ee.detail||"")}n({title:"",description:""}),v(!1),O({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),A()}catch(D){n({title:"",description:D instanceof Error?D.message:"",variant:"destructive"})}},H=async()=>{if(p)try{if(!(await we(`/api/webui/plugins/mirrors/${p.id}`,{method:"PUT",body:JSON.stringify({name:b.name,raw_prefix:b.raw_prefix,clone_prefix:b.clone_prefix,enabled:b.enabled,priority:b.priority})})).ok)throw new Error("");n({title:"",description:""}),w(!1),g(null),A()}catch(D){n({title:"",description:D instanceof Error?D.message:"",variant:"destructive"})}},E=async D=>{if(confirm(""))try{if(!(await we(`/api/webui/plugins/mirrors/${D}`,{method:"DELETE"})).ok)throw new Error("");n({title:"",description:""}),A()}catch(ee){n({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}},C=async D=>{try{if(!(await we(`/api/webui/plugins/mirrors/${D.id}`,{method:"PUT",body:JSON.stringify({enabled:!D.enabled})})).ok)throw new Error("");A()}catch(ee){n({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}},M=D=>{g(D),O({id:D.id,name:D.name,raw_prefix:D.raw_prefix,clone_prefix:D.clone_prefix,enabled:D.enabled,priority:D.priority}),w(!0)},G=async(D,ee)=>{const R=ee==="up"?D.priority-1:D.priority+1;if(!(R<1))try{if(!(await we(`/api/webui/plugins/mirrors/${D.id}`,{method:"PUT",body:JSON.stringify({priority:R})})).ok)throw new Error("");A()}catch(me){n({title:"",description:me instanceof Error?me.message:"",variant:"destructive"})}};return e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:" Git "})]})]}),e.jsxs(S,{onClick:()=>v(!0),children:[e.jsx(Zs,{className:"h-4 w-4 mr-2"}),""]})]}),u?e.jsx(Se,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Ls,{className:"h-8 w-8 animate-spin text-primary"})})}):h?e.jsx(Se,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Yt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h}),e.jsx(S,{onClick:A,children:""})]})}):e.jsxs(Se,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"ID"}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Rl,{children:i.map(D=>e.jsxs(dt,{children:[e.jsx(Ke,{children:e.jsx(Fe,{checked:D.enabled,onCheckedChange:()=>C(D)})}),e.jsx(Ke,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:D.name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Raw: ",D.raw_prefix]})]})}),e.jsx(Ke,{children:e.jsx(ke,{variant:"outline",children:D.id})}),e.jsx(Ke,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono",children:D.priority}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(S,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>G(D,"up"),disabled:D.priority===1,children:e.jsx(Hr,{className:"h-3 w-3"})}),e.jsx(S,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>G(D,"down"),children:e.jsx(Aa,{className:"h-3 w-3"})})]})]})}),e.jsx(Ke,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>M(D),children:e.jsx(Pn,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>E(D.id),children:e.jsx(ns,{className:"h-4 w-4 text-destructive"})})]})})]},D.id))})]})}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:i.map(D=>e.jsx(Se,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:D.name}),D.enabled&&e.jsx(ke,{variant:"default",className:"text-xs",children:""})]}),e.jsx(ke,{variant:"outline",className:"mt-1 text-xs",children:D.id})]}),e.jsx(Fe,{checked:D.enabled,onCheckedChange:()=>C(D)})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Raw: "}),e.jsx("span",{className:"break-all",children:D.raw_prefix})]}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),e.jsx("span",{className:"font-mono",children:D.priority})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[e.jsxs(S,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>M(D),children:[e.jsx(Pn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>G(D,"up"),disabled:D.priority===1,children:e.jsx(Hr,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>G(D,"down"),children:e.jsx(Aa,{className:"h-4 w-4"})}),e.jsx(S,{variant:"destructive",size:"sm",onClick:()=>E(D.id),children:e.jsx(ns,{className:"h-4 w-4"})})]})]})},D.id))})]}),e.jsx(Ps,{open:N,onOpenChange:v,children:e.jsxs(Us,{className:"max-w-lg",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:" Git "})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-id",children:" ID *"}),e.jsx(ne,{id:"add-id",placeholder:": my-mirror",value:b.id,onChange:D=>O({...b,id:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-name",children:" *"}),e.jsx(ne,{id:"add-name",placeholder:": ",value:b.name,onChange:D=>O({...b,name:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-raw",children:"Raw  *"}),e.jsx(ne,{id:"add-raw",placeholder:"https://example.com/raw",value:b.raw_prefix,onChange:D=>O({...b,raw_prefix:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-clone",children:" *"}),e.jsx(ne,{id:"add-clone",placeholder:"https://example.com/clone",value:b.clone_prefix,onChange:D=>O({...b,clone_prefix:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-priority",children:""}),e.jsx(ne,{id:"add-priority",type:"number",min:"1",value:b.priority,onChange:D=>O({...b,priority:parseInt(D.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"add-enabled",checked:b.enabled,onCheckedChange:D=>O({...b,enabled:D})}),e.jsx(T,{htmlFor:"add-enabled",children:""})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>v(!1),children:""}),e.jsx(S,{onClick:_,children:""})]})]})}),e.jsx(Ps,{open:y,onOpenChange:w,children:e.jsxs(Us,{className:"max-w-lg",children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" ID"}),e.jsx(ne,{value:b.id,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-name",children:" *"}),e.jsx(ne,{id:"edit-name",value:b.name,onChange:D=>O({...b,name:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-raw",children:"Raw  *"}),e.jsx(ne,{id:"edit-raw",value:b.raw_prefix,onChange:D=>O({...b,raw_prefix:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-clone",children:" *"}),e.jsx(ne,{id:"edit-clone",value:b.clone_prefix,onChange:D=>O({...b,clone_prefix:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-priority",children:""}),e.jsx(ne,{id:"edit-priority",type:"number",min:"1",value:b.priority,onChange:D=>O({...b,priority:parseInt(D.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"edit-enabled",checked:b.enabled,onCheckedChange:D=>O({...b,enabled:D})}),e.jsx(T,{htmlFor:"edit-enabled",children:""})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>w(!1),children:""}),e.jsx(S,{onClick:H,children:""})]})]})})]})})}function Bk({pluginId:l,compact:n=!1}){const[i,c]=m.useState(null),[u,x]=m.useState(!0),[h,f]=m.useState(0),[p,g]=m.useState(""),[N,v]=m.useState(!1),{toast:y}=st(),w=async()=>{x(!0);const _=await $v(l);_&&c(_),x(!1)};m.useEffect(()=>{w()},[l]);const b=async()=>{const _=await kk(l);_.success?(y({title:"",description:""}),w()):y({title:"",description:_.error||"",variant:"destructive"})},O=async()=>{const _=await Ck(l);_.success?(y({title:"",description:""}),w()):y({title:"",description:_.error||"",variant:"destructive"})},A=async()=>{if(h===0){y({title:"",description:" 1 ",variant:"destructive"});return}const _=await Tk(l,h,p||void 0);_.success?(y({title:"",description:""}),v(!1),f(0),g(""),w()):y({title:"",description:_.error||"",variant:"destructive"})};return u?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(cn,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]})]}):i?n?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",title:`: ${i.downloads.toLocaleString()}`,children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsx("span",{children:i.downloads.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${i.rating.toFixed(1)} (${i.rating_count} )`,children:[e.jsx(cn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:i.rating.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${i.likes}`,children:[e.jsx(Nm,{className:"h-4 w-4"}),e.jsx("span",{children:i.likes})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Zt,{className:"h-5 w-5 text-muted-foreground mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:i.downloads.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(cn,{className:"h-5 w-5 text-yellow-400 mb-1 fill-yellow-400"}),e.jsx("span",{className:"text-2xl font-bold",children:i.rating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.rating_count," "]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Nm,{className:"h-5 w-5 text-green-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:i.likes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(rg,{className:"h-5 w-5 text-red-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:i.dislikes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:b,children:[e.jsx(Nm,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:O,children:[e.jsx(rg,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(Ps,{open:N,onOpenChange:v,children:[e.jsx(ed,{asChild:!0,children:e.jsxs(S,{variant:"default",size:"sm",children:[e.jsx(cn,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Us,{children:[e.jsxs($s,{children:[e.jsx(Bs,{children:""}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(_=>e.jsx("button",{onClick:()=>f(_),className:"focus:outline-none",children:e.jsx(cn,{className:`h-8 w-8 transition-colors ${_<=h?"fill-yellow-400 text-yellow-400":"text-muted-foreground hover:text-yellow-300"}`})},_))}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h===0&&"",h===1&&"",h===2&&"",h===3&&"",h===4&&"",h===5&&""]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),e.jsx(at,{value:p,onChange:_=>g(_.target.value),placeholder:"...",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[p.length," / 500"]})]})]}),e.jsxs(et,{children:[e.jsx(S,{variant:"outline",onClick:()=>v(!1),children:""}),e.jsx(S,{onClick:A,disabled:h===0,children:""})]})]})]})]}),i.recent_ratings&&i.recent_ratings.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-3",children:i.recent_ratings.map((_,H)=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>e.jsx(cn,{className:`h-3 w-3 ${E<=_.rating?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`},E))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(_.created_at).toLocaleDateString()})]}),_.comment&&e.jsx("p",{className:"text-sm text-muted-foreground",children:_.comment})]},H))})]})]}):null}const Ik={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function Pk(){const l=ia(),n=g0({strict:!1}),{toast:i}=st(),[c,u]=m.useState(null),[x,h]=m.useState(""),[f,p]=m.useState(!0),[g,N]=m.useState(!0),[v,y]=m.useState(null),[w,b]=m.useState(null),[O,A]=m.useState(null),[_,H]=m.useState(!1),[E,C]=m.useState(),[M,G]=m.useState(!1);m.useEffect(()=>{(async()=>{if(!n.pluginId){y(" ID"),p(!1);return}try{p(!0),y(null);const ge=await we("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:"Mai-with-u",repo:"plugin-repo",branch:"main",file_path:"plugin_details.json"})});if(!ge.ok)throw new Error("");const fe=await ge.json();if(!fe.success||!fe.data)throw new Error(fe.error||"");const Q=JSON.parse(fe.data).find(je=>je.id===n.pluginId);if(!Q)throw new Error("");const I={id:Q.id,manifest:Q.manifest,downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()};u(I);const[L,B,_e]=await Promise.all([zv(),Ov(),Ml()]);b(L),A(B),H(dn(n.pluginId,_e)),C(un(n.pluginId,_e))}catch(ge){y(ge instanceof Error?ge.message:"")}finally{p(!1)}})()},[n.pluginId]),m.useEffect(()=>{(async()=>{if(!c?.manifest?.repository_url){N(!1);return}try{if(N(!0),_&&n.pluginId)try{const B=await we(`/api/webui/plugins/local-readme/${n.pluginId}`);if(B.ok){const _e=await B.json();if(_e.success&&_e.data){h(_e.data),N(!1);return}}}catch(B){console.log(" README :",B)}const ge=c.manifest.repository_url.match(/github\.com\/([^/]+)\/([^/\s]+)/);if(!ge){h("");return}const[,fe,z]=ge,Q=z.replace(/\.git$/,""),I=await we("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:fe,repo:Q,branch:"main",file_path:"README.md"})});if(!I.ok)throw new Error(" README ");const L=await I.json();L.success&&L.data?h(L.data):h(" README ")}catch(ge){console.error(" README :",ge),h(" README ")}finally{N(!1)}})()},[c,_,n.pluginId]);const D=()=>!c||!_||!E?!1:E!==c.manifest.version,ee=()=>!c||!O?!0:Dv(c.manifest.host_application.min_version,c.manifest.host_application.max_version,O),R=async()=>{if(!(!c||!w?.installed))try{G(!0),await Rv(c.id,c.manifest.repository_url||"","main"),Bv(c.id).catch(ge=>{console.warn("Failed to record download:",ge)}),i({title:"",description:`${c.manifest.name} `});const se=await Ml();H(dn(c.id,se)),C(un(c.id,se))}catch(se){i({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{G(!1)}},me=async()=>{if(c)try{G(!0),await Lv(c.id),i({title:"",description:`${c.manifest.name} `});const se=await Ml();H(dn(c.id,se)),C(un(c.id,se))}catch(se){i({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{G(!1)}},ce=async()=>{if(!(!c||!w?.installed))try{G(!0);const se=await Uv(c.id,c.manifest.repository_url||"","main");i({title:"",description:`${c.manifest.name}  ${se.old_version}  ${se.new_version}`});const ge=await Ml();H(dn(c.id,ge)),C(un(c.id,ge))}catch(se){i({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{G(!1)}};if(f)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Ls,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]})]});if(v||!c)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsx(Se,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(St,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:v}),e.jsx(S,{onClick:()=>l({to:"/plugins"}),children:""})]})})]});const ve=ee();return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),className:"shrink-0",children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:c.manifest.name})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_?e.jsxs(e.Fragment,{children:[D()?e.jsx(S,{disabled:!w?.installed||M,onClick:ce,title:w?.installed?void 0:"Git ",children:M?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"h-4 w-4 mr-2"}),""]})}):null,e.jsx(S,{variant:"destructive",disabled:!w?.installed||M,onClick:me,title:w?.installed?void 0:"Git ",children:M?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),""]})})]}):e.jsx(S,{disabled:!w?.installed||!ve||M,onClick:R,title:w?.installed?ve?void 0:` ( ${c.manifest.host_application.min_version}${c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:"+"} ${O?.version})`:"Git ",children:M?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),""]})})})]}),e.jsx(Je,{className:"h-[calc(100vh-200px)] sm:h-[calc(100vh-220px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsx(Se,{children:e.jsx(ze,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(Re,{className:"text-2xl",children:c.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-sm",children:["v",c.manifest.version]}),_&&e.jsxs(ke,{variant:"default",className:"text-sm",children:[e.jsx(Wt,{className:"h-3 w-3 mr-1"})," ",E&&`(v${E})`]}),D()&&e.jsxs(ke,{variant:"outline",className:"text-sm border-orange-500 text-orange-500",children:[e.jsx(ft,{className:"h-3 w-3 mr-1"}),""]}),!ve&&e.jsxs(ke,{variant:"destructive",className:"text-sm",children:[e.jsx(St,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx(ws,{className:"text-base",children:c.manifest.description})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsx(Re,{className:"text-lg",children:""})}),e.jsx(Me,{children:e.jsx(Bk,{pluginId:c.id})})]}),e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsx(Re,{className:"text-lg",children:""})}),e.jsx(Me,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(In,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.author?.name||"Unknown"}),c.manifest.author?.url&&e.jsx("a",{href:c.manifest.author.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:e.jsx(Mo,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(la,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-medium",children:["v",c.manifest.version]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ej,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.license})]}),c.manifest.homepage_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Uo,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.homepage_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["",e.jsx(Mo,{className:"h-3 w-3"})]})]}),c.manifest.repository_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(i_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.repository_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["GitHub",e.jsx(Mo,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx(Pt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"})]}),e.jsxs("div",{className:"text-sm pl-6 font-medium",children:[c.manifest.host_application.min_version,c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:" - "]})]})]})})]}),(c.manifest.categories||c.manifest.keywords)&&e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsx(Re,{className:"text-lg",children:""})}),e.jsxs(Me,{className:"space-y-4",children:[c.manifest.categories&&c.manifest.categories.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.categories.map(se=>e.jsx(ke,{variant:"secondary",children:Ik[se]||se},se))})]}),c.manifest.keywords&&c.manifest.keywords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.keywords.map(se=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(Xo,{className:"h-3 w-3 mr-1"}),se]},se))})]})]})]})]}),e.jsxs(Se,{className:"lg:col-span-2",children:[e.jsx(ze,{children:e.jsx(Re,{className:"text-lg",children:""})}),e.jsx(Me,{children:e.jsx(Je,{className:"h-[600px] pr-4",children:g?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Ls,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-sm text-muted-foreground",children:"..."})]}):x?e.jsx(ex,{content:x}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:""})})})]})]})]})})]})}const Vi=m.forwardRef(({className:l,...n},i)=>e.jsx(ej,{ref:i,className:P("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",l),...n}));Vi.displayName=ej.displayName;const Hk=m.forwardRef(({className:l,...n},i)=>e.jsx(sj,{ref:i,className:P("aspect-square h-full w-full",l),...n}));Hk.displayName=sj.displayName;const qi=m.forwardRef(({className:l,...n},i)=>e.jsx(tj,{ref:i,className:P("flex h-full w-full items-center justify-center rounded-full bg-muted",l),...n}));qi.displayName=tj.displayName;function Fk(){return"webui_"+Math.random().toString(36).substr(2,9)+"_"+Date.now().toString(36)}function Gk(){const l="maibot_webui_user_id";let n=localStorage.getItem(l);return n||(n=Fk(),localStorage.setItem(l,n)),n}function Vk(){return localStorage.getItem("maibot_webui_user_name")||"WebUI"}function qk(l){localStorage.setItem("maibot_webui_user_name",l)}const Iv="maibot_webui_virtual_tabs";function Kk(){try{const l=localStorage.getItem(Iv);if(l)return JSON.parse(l)}catch(l){console.error("[Chat] :",l)}return[]}function Dg(l){try{localStorage.setItem(Iv,JSON.stringify(l))}catch(n){console.error("[Chat] :",n)}}function Qk({segment:l}){switch(l.type){case"text":return e.jsx("span",{className:"whitespace-pre-wrap",children:String(l.data)});case"image":case"emoji":return e.jsx("img",{src:String(l.data),alt:l.type==="emoji"?"":"",className:P("rounded-lg max-w-full",l.type==="emoji"?"max-h-32":"max-h-64"),loading:"lazy",onError:n=>{const i=n.target;i.style.display="none",i.parentElement?.insertAdjacentHTML("beforeend",`<span class="text-muted-foreground text-xs">[${l.type==="emoji"?"":""}]</span>`)}});case"voice":return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("audio",{controls:!0,src:String(l.data),className:"max-w-[200px] h-8",children:""})});case"video":return e.jsx("video",{controls:!0,src:String(l.data),className:"rounded-lg max-w-full max-h-64",children:""});case"face":return e.jsxs("span",{className:"text-muted-foreground",children:["[:",String(l.data),"]"]});case"music":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"file":return e.jsxs("span",{className:"text-muted-foreground",children:["[: ",String(l.data),"]"]});case"reply":return e.jsx("span",{className:"text-muted-foreground text-xs",children:"[]"});case"forward":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"unknown":default:return e.jsxs("span",{className:"text-muted-foreground",children:["[",l.original_type||"","]"]})}}function Yk({message:l,isBot:n}){return l.message_type==="rich"&&l.segments&&l.segments.length>0?e.jsx("div",{className:"flex flex-col gap-2",children:l.segments.map((i,c)=>e.jsx(Qk,{segment:i},c))}):e.jsx("span",{className:"whitespace-pre-wrap",children:l.content})}function Jk(){const l={id:"webui-default",type:"webui",label:"WebUI",messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}},n=()=>{const qe=Kk().map(Qe=>{const We=Qe.virtualConfig;return!We.groupId&&We.platform&&We.userId&&(We.groupId=`webui_virtual_group_${We.platform}_${We.userId}`),{id:Qe.id,type:"virtual",label:Qe.label,virtualConfig:We,messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}}});return[l,...qe]},[i,c]=m.useState(n),[u,x]=m.useState("webui-default"),h=i.find(q=>q.id===u)||i[0],[f,p]=m.useState(""),[g,N]=m.useState(!1),[v,y]=m.useState(!0),[w,b]=m.useState(Vk()),[O,A]=m.useState(!1),[_,H]=m.useState(""),[E,C]=m.useState(!1),[M,G]=m.useState([]),[D,ee]=m.useState([]),[R,me]=m.useState(!1),[ce,ve]=m.useState(!1),[se,ge]=m.useState(""),[fe,z]=m.useState({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),Q=m.useRef(Gk()),I=m.useRef(new Map),L=m.useRef(null),B=m.useRef(new Map),_e=m.useRef(0),je=m.useRef(new Map),{toast:Ce}=st(),K=q=>(_e.current+=1,`${q}-${Date.now()}-${_e.current}-${Math.random().toString(36).substr(2,9)}`),U=m.useCallback((q,qe)=>{c(Qe=>Qe.map(We=>We.id===q?{...We,...qe}:We))},[]),V=m.useCallback((q,qe)=>{c(Qe=>Qe.map(We=>We.id===q?{...We,messages:[...We.messages,qe]}:We))},[]),xe=m.useCallback(()=>{L.current?.scrollIntoView({behavior:"smooth"})},[]);m.useEffect(()=>{xe()},[h?.messages,xe]);const Oe=m.useCallback(async()=>{me(!0);try{const q=await we("/api/chat/platforms");if(console.log("[Chat] :",q.status,q.headers.get("content-type")),q.ok){const qe=q.headers.get("content-type");if(qe&&qe.includes("application/json")){const Qe=await q.json();console.log("[Chat] :",Qe),G(Qe.platforms||[])}else{const Qe=await q.text();console.error("[Chat] :  JSON :",Qe.substring(0,200)),Ce({title:"",description:" MaiBot ",variant:"destructive"})}}else console.error("[Chat] : HTTP",q.status),Ce({title:"",description:`: ${q.status}`,variant:"destructive"})}catch(q){console.error("[Chat] :",q),Ce({title:"",description:"",variant:"destructive"})}finally{me(!1)}},[Ce]),X=m.useCallback(async(q,qe)=>{ve(!0);try{const Qe=new URLSearchParams;q&&Qe.append("platform",q),qe&&Qe.append("search",qe),Qe.append("limit","50");const We=await we(`/api/chat/persons?${Qe.toString()}`);if(We.ok){const Os=We.headers.get("content-type");if(Os&&Os.includes("application/json")){const as=await We.json();ee(as.persons||[])}else console.error("[Chat] :  JSON ")}}catch(Qe){console.error("[Chat] :",Qe)}finally{ve(!1)}},[]);m.useEffect(()=>{fe.platform&&X(fe.platform,se)},[fe.platform,se,X]);const oe=m.useCallback(async(q,qe)=>{y(!0);try{const Qe=new URLSearchParams;Qe.append("user_id",Q.current),Qe.append("limit","50"),qe&&Qe.append("group_id",qe);const We=`/api/chat/history?${Qe.toString()}`;console.log("[Chat] :",We);const Os=await we(We);if(Os.ok){const as=await Os.text();try{const Cs=JSON.parse(as);if(Cs.messages&&Cs.messages.length>0){const Ee=Cs.messages.map(ls=>({id:ls.id,type:ls.type,content:ls.content,timestamp:ls.timestamp,sender:{name:ls.sender_name||(ls.is_bot?"":"WebUI"),user_id:ls.user_id,is_bot:ls.is_bot}}));U(q,{messages:Ee});const Ns=je.current.get(q)||new Set;Ee.forEach(ls=>{if(ls.type==="bot"){const es=`bot-${ls.content}-${Math.floor(ls.timestamp*1e3)}`;Ns.add(es)}}),je.current.set(q,Ns)}}catch(Cs){console.error("[Chat] JSON :",Cs)}}}catch(Qe){console.error("[Chat] :",Qe)}finally{y(!1)}},[U]),Ge=m.useCallback(async(q,qe,Qe)=>{const We=I.current.get(q);if(We?.readyState===WebSocket.OPEN||We?.readyState===WebSocket.CONNECTING){console.log(`[Tab ${q}] WebSocket `);return}N(!0);let Os=null;try{const Ns=await we("/api/webui/ws-token");if(Ns.ok){const ls=await Ns.json();if(ls.success&&ls.token)Os=ls.token;else{console.warn(`[Tab ${q}]  WebSocket token : ${ls.message||""}`),N(!1);return}}}catch(Ns){console.error(`[Tab ${q}]  WebSocket token :`,Ns),N(!1);return}if(!Os){N(!1);return}const as=window.location.protocol==="https:"?"wss:":"ws:",Cs=new URLSearchParams;Cs.append("token",Os),qe==="virtual"&&Qe?(Cs.append("user_id",Qe.userId),Cs.append("user_name",Qe.userName),Cs.append("platform",Qe.platform),Cs.append("person_id",Qe.personId),Cs.append("group_name",Qe.groupName||"WebUI"),Qe.groupId&&Cs.append("group_id",Qe.groupId)):(Cs.append("user_id",Q.current),Cs.append("user_name",w));const Ee=`${as}//${window.location.host}/api/chat/ws?${Cs.toString()}`;console.log(`[Tab ${q}]  WebSocket:`,Ee);try{const Ns=new WebSocket(Ee);I.current.set(q,Ns),Ns.onopen=()=>{U(q,{isConnected:!0}),N(!1),console.log(`[Tab ${q}] WebSocket `)},Ns.onmessage=ls=>{try{const es=JSON.parse(ls.data);switch(es.type){case"session_info":U(q,{sessionInfo:{session_id:es.session_id,user_id:es.user_id,user_name:es.user_name,bot_name:es.bot_name}});break;case"system":V(q,{id:K("sys"),type:"system",content:es.content||"",timestamp:es.timestamp||Date.now()/1e3});break;case"user_message":{const bs=es.sender?.user_id,pt=qe==="virtual"&&Qe?Qe.userId:Q.current;console.log(`[Tab ${q}]  user_message, sender: ${bs}, current: ${pt}`);const Lt=bs?bs.replace(/^webui_user_/,""):"",tt=pt?pt.replace(/^webui_user_/,""):"";if(Lt&&tt&&Lt===tt){console.log(`[Tab ${q}] user_id `);break}const Ms=je.current.get(q)||new Set,kt=`user-${es.content}-${Math.floor((es.timestamp||0)*1e3)}`;if(Ms.has(kt)){console.log(`[Tab ${q}] `);break}if(Ms.add(kt),je.current.set(q,Ms),Ms.size>100){const Ut=Ms.values().next().value;Ut&&Ms.delete(Ut)}V(q,{id:es.message_id||K("user"),type:"user",content:es.content||"",timestamp:es.timestamp||Date.now()/1e3,sender:es.sender});break}case"bot_message":{U(q,{isTyping:!1});const bs=je.current.get(q)||new Set,pt=`bot-${es.content}-${Math.floor((es.timestamp||0)*1e3)}`;if(bs.has(pt))break;if(bs.add(pt),je.current.set(q,bs),bs.size>100){const Lt=bs.values().next().value;Lt&&bs.delete(Lt)}c(Lt=>Lt.map(tt=>{if(tt.id!==q)return tt;const Ms=tt.messages.filter(Ut=>Ut.type!=="thinking"),kt={id:K("bot"),type:"bot",content:es.content||"",message_type:es.message_type==="rich"?"rich":"text",segments:es.segments,timestamp:es.timestamp||Date.now()/1e3,sender:es.sender};return{...tt,messages:[...Ms,kt]}}));break}case"typing":U(q,{isTyping:es.is_typing||!1});break;case"error":c(bs=>bs.map(pt=>{if(pt.id!==q)return pt;const Lt=pt.messages.filter(tt=>tt.type!=="thinking");return{...pt,messages:[...Lt,{id:K("error"),type:"error",content:es.content||"",timestamp:es.timestamp||Date.now()/1e3}]}})),Ce({title:"",description:es.content,variant:"destructive"});break;case"pong":break;case"history":{const bs=es.messages||[];if(bs.length>0){const pt=je.current.get(q)||new Set,Lt=bs.map(tt=>{const Ms=tt.is_bot||!1,kt=tt.id||K(Ms?"bot":"user"),Ut=`${Ms?"bot":"user"}-${tt.content}-${Math.floor(tt.timestamp*1e3)}`;return pt.add(Ut),{id:kt,type:Ms?"bot":"user",content:tt.content,timestamp:tt.timestamp,sender:{name:tt.sender_name||(Ms?"":""),user_id:tt.sender_id,is_bot:Ms}}});je.current.set(q,pt),U(q,{messages:Lt}),console.log(`[Tab ${q}]  ${Lt.length} `)}break}default:console.log(":",es.type)}}catch(es){console.error(":",es)}},Ns.onclose=()=>{U(q,{isConnected:!1}),N(!1),I.current.delete(q),console.log(`[Tab ${q}] WebSocket `);const ls=B.current.get(q);ls&&clearTimeout(ls);const es=window.setTimeout(()=>{if(!Y.current){const bs=i.find(pt=>pt.id===q);bs&&Ge(q,bs.type,bs.virtualConfig)}},5e3);B.current.set(q,es)},Ns.onerror=ls=>{console.error(`[Tab ${q}] WebSocket :`,ls),N(!1)}}catch(Ns){console.error(`[Tab ${q}]  WebSocket :`,Ns),N(!1)}},[w,U,V,Ce,i]),Y=m.useRef(!1);m.useEffect(()=>{Y.current=!1;const q=I.current,qe=B.current,Qe=je.current;oe("webui-default");const We=setTimeout(()=>{Y.current||(Ge("webui-default","webui"),i.forEach(as=>{as.type==="virtual"&&as.virtualConfig&&(Qe.set(as.id,new Set),setTimeout(()=>{Y.current||Ge(as.id,"virtual",as.virtualConfig)},200))}))},100),Os=setInterval(()=>{q.forEach(as=>{as.readyState===WebSocket.OPEN&&as.send(JSON.stringify({type:"ping"}))})},3e4);return()=>{Y.current=!0,clearTimeout(We),clearInterval(Os),qe.forEach(as=>{clearTimeout(as)}),qe.clear(),q.forEach(as=>{as.close()}),q.clear()}},[]);const te=m.useCallback(()=>{const q=I.current.get(u);if(!f.trim()||!q||q.readyState!==WebSocket.OPEN)return;const qe=h?.type==="virtual"&&h.virtualConfig?.userName||w,Qe=f.trim(),We=Date.now()/1e3;q.send(JSON.stringify({type:"message",content:Qe,user_name:qe}));const Os=je.current.get(u)||new Set,as=`user-${Qe}-${Math.floor(We*1e3)}`;if(Os.add(as),je.current.set(u,Os),Os.size>100){const Ns=Os.values().next().value;Ns&&Os.delete(Ns)}const Cs={id:K("user"),type:"user",content:Qe,timestamp:We,sender:{name:qe,is_bot:!1}};V(u,Cs);const Ee={id:K("thinking"),type:"thinking",content:"",timestamp:We+.001,sender:{name:h?.sessionInfo.bot_name||"",is_bot:!0}};V(u,Ee),p("")},[f,w,u,h,V]),Ue=q=>{q.key==="Enter"&&!q.shiftKey&&(q.preventDefault(),te())},Le=()=>{H(w),A(!0)},Ae=()=>{const q=_.trim()||"WebUI";b(q),qk(q),A(!1);const qe=I.current.get(u);qe?.readyState===WebSocket.OPEN&&qe.send(JSON.stringify({type:"update_nickname",user_name:q}))},de=()=>{H(""),A(!1)},Te=q=>new Date(q*1e3).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),rs=()=>{const q=I.current.get(u);q&&(q.close(),I.current.delete(u)),Ge(u,h?.type||"webui",h?.virtualConfig)},Rt=()=>{z({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),ge(""),Oe(),C(!0)},ta=()=>{if(!fe.platform||!fe.personId){Ce({title:"",description:"",variant:"destructive"});return}const q=`webui_virtual_group_${fe.platform}_${fe.userId}`,qe=`virtual-${fe.platform}-${fe.userId}-${Date.now()}`,Qe=fe.userName||fe.userId,We={id:qe,type:"virtual",label:Qe,virtualConfig:{...fe,groupId:q},messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}};c(Os=>{const as=[...Os,We],Cs=as.filter(Ee=>Ee.type==="virtual"&&Ee.virtualConfig).map(Ee=>({id:Ee.id,label:Ee.label,virtualConfig:Ee.virtualConfig,createdAt:Date.now()}));return Dg(Cs),as}),x(qe),C(!1),je.current.set(qe,new Set),setTimeout(()=>{Ge(qe,"virtual",fe)},100),Ce({title:"",description:` ${Qe} `})},qa=(q,qe)=>{if(qe?.stopPropagation(),q==="webui-default")return;const Qe=I.current.get(q);Qe&&(Qe.close(),I.current.delete(q));const We=B.current.get(q);We&&(clearTimeout(We),B.current.delete(q)),je.current.delete(q),c(Os=>{const as=Os.filter(Ee=>Ee.id!==q),Cs=as.filter(Ee=>Ee.type==="virtual"&&Ee.virtualConfig).map(Ee=>({id:Ee.id,label:Ee.label,virtualConfig:Ee.virtualConfig,createdAt:Date.now()}));return Dg(Cs),as}),u===q&&x("webui-default")},Ht=q=>{x(q)},ut=q=>{z(qe=>({...qe,personId:q.person_id,userId:q.user_id,userName:q.nickname||q.person_name}))};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(Ps,{open:E,onOpenChange:C,children:e.jsxs(Us,{className:"sm:max-w-[500px] max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(bm,{className:"h-5 w-5"}),""]}),e.jsx(Js,{children:""})]}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Uo,{className:"h-4 w-4"}),""]}),e.jsxs(Ie,{value:fe.platform,onValueChange:q=>{z(qe=>({...qe,platform:q,personId:"",userId:"",userName:""})),ee([])},children:[e.jsx($e,{disabled:R,children:e.jsx(Pe,{placeholder:R?"...":""})}),e.jsx(Be,{children:M.map(q=>e.jsxs(W,{value:q.platform,children:[q.platform," (",q.count," )"]},q.platform))})]})]}),fe.platform&&e.jsxs("div",{className:"space-y-2 flex-1 overflow-hidden flex flex-col",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(sc,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"relative",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:se,onChange:q=>ge(q.target.value),className:"pl-9"})]}),e.jsx(Je,{className:"h-[250px] border rounded-md",children:e.jsx("div",{className:"p-2",children:ce?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Ls,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):D.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(sc,{className:"h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:""})]}):e.jsx("div",{className:"space-y-1",children:D.map(q=>e.jsxs("button",{onClick:()=>ut(q),className:P("w-full flex items-center gap-3 p-2 rounded-md text-left transition-colors",fe.personId===q.person_id?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(Vi,{className:"h-8 w-8 shrink-0",children:e.jsx(qi,{className:P("text-xs",fe.personId===q.person_id?"bg-primary-foreground/20":"bg-muted"),children:(q.nickname||q.person_name||"?").charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate",children:q.nickname||q.person_name}),e.jsxs("div",{className:P("text-xs truncate",fe.personId===q.person_id?"text-primary-foreground/70":"text-muted-foreground"),children:["ID: ",q.user_id,q.is_known&&"  "]})]})]},q.person_id))})})})]}),fe.personId&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{placeholder:"WebUI",value:fe.groupName,onChange:q=>z(qe=>({...qe,groupName:q.target.value}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs(et,{className:"gap-2 sm:gap-0",children:[e.jsx(S,{variant:"outline",onClick:()=>C(!1),children:""}),e.jsx(S,{onClick:ta,disabled:!fe.platform||!fe.personId,children:""})]})]})}),e.jsx("div",{className:"shrink-0 border-b bg-muted/30",children:e.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto py-1.5 scrollbar-thin",children:[i.map(q=>e.jsxs("div",{className:P("flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm whitespace-nowrap transition-colors cursor-pointer","hover:bg-muted",u===q.id?"bg-background shadow-sm border":"text-muted-foreground"),onClick:()=>Ht(q.id),children:[q.type==="webui"?e.jsx(Ea,{className:"h-3.5 w-3.5"}):e.jsx(bm,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"max-w-[100px] truncate",children:q.label}),e.jsx("span",{className:P("w-1.5 h-1.5 rounded-full",q.isConnected?"bg-green-500":"bg-muted-foreground/50")}),q.id!=="webui-default"&&e.jsx("span",{onClick:qe=>qa(q.id,qe),className:"ml-0.5 p-0.5 rounded hover:bg-muted-foreground/20 cursor-pointer",role:"button",tabIndex:0,onKeyDown:qe=>{(qe.key==="Enter"||qe.key===" ")&&(qe.preventDefault(),qa(q.id,qe))},children:e.jsx(Ma,{className:"h-3 w-3"})})]},q.id)),e.jsx("button",{onClick:Rt,className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-sm text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",title:"",children:e.jsx(Zs,{className:"h-3.5 w-3.5"})})]})})}),e.jsx("div",{className:"shrink-0 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(Vi,{className:"h-8 w-8 sm:h-10 sm:w-10 shrink-0",children:e.jsx(qi,{className:"bg-primary/10 text-primary",children:e.jsx($r,{className:"h-4 w-4 sm:h-5 sm:w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:h?.sessionInfo.bot_name||""}),e.jsx("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:h?.isConnected?e.jsxs(e.Fragment,{children:[e.jsx(c_,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:""})]}):g?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(o_,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:""})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[v&&e.jsx(Ls,{className:"h-4 w-4 animate-spin text-muted-foreground"}),e.jsx(S,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:rs,disabled:g,title:"",children:e.jsx(ft,{className:P("h-4 w-4",g&&"animate-spin")})})]})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:h?.type==="virtual"&&h.virtualConfig?e.jsxs(e.Fragment,{children:[e.jsx(bm,{className:"h-3 w-3 text-primary"}),e.jsx("span",{children:""}),e.jsx("span",{className:"font-medium text-primary",children:h.virtualConfig.userName}),e.jsxs("span",{className:"text-xs",children:["(",h.virtualConfig.platform,")"]}),h.virtualConfig.groupName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:""}),e.jsxs("span",{className:"text-xs",children:["",h.virtualConfig.groupName]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(In,{className:"h-3 w-3"}),e.jsx("span",{children:""}),O?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{value:_,onChange:q=>H(q.target.value),onKeyDown:q=>{q.key==="Enter"&&Ae(),q.key==="Escape"&&de()},className:"h-7 w-32",placeholder:"",autoFocus:!0}),e.jsx(S,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:Ae,children:""}),e.jsx(S,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:de,children:""})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:w}),e.jsx(S,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:Le,title:"",children:e.jsx(d_,{className:"h-3 w-3"})})]})]})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(Je,{className:"h-full",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto space-y-3 sm:space-y-4",children:[h?.messages.length===0&&!v&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx($r,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsxs("p",{className:"text-sm",children:[" ",h?.sessionInfo.bot_name||""," "]})]}),h?.messages.map(q=>e.jsxs("div",{className:P("flex gap-2 sm:gap-3",q.type==="user"&&"flex-row-reverse",q.type==="system"&&"justify-center",q.type==="error"&&"justify-center"),children:[q.type==="system"&&e.jsx("div",{className:"text-xs text-muted-foreground bg-muted/50 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="error"&&e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="thinking"&&e.jsxs(e.Fragment,{children:[e.jsx(Vi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(qi,{className:"bg-primary/10 text-primary",children:e.jsx($r,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:"flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",children:[e.jsx("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||h?.sessionInfo.bot_name})}),e.jsx("div",{className:"bg-muted rounded-2xl rounded-tl-sm px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"..."})]})})]})]}),(q.type==="user"||q.type==="bot")&&e.jsxs(e.Fragment,{children:[e.jsx(Vi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(qi,{className:P("text-xs",q.type==="bot"?"bg-primary/10 text-primary":"bg-secondary text-secondary-foreground"),children:q.type==="bot"?e.jsx($r,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):e.jsx(In,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:P("flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",q.type==="user"&&"items-end"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||(q.type==="bot"?h?.sessionInfo.bot_name:w)}),e.jsx("span",{children:Te(q.timestamp)})]}),e.jsx("div",{className:P("rounded-2xl px-3 py-2 text-sm break-words",q.type==="bot"?"bg-muted rounded-tl-sm":"bg-primary text-primary-foreground rounded-tr-sm"),children:e.jsx(Yk,{message:q,isBot:q.type==="bot"})})]})]})]},q.id)),e.jsx("div",{ref:L})]})})}),e.jsx("div",{className:"shrink-0 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:f,onChange:q=>p(q.target.value),onKeyDown:Ue,placeholder:h?.isConnected?"...":"...",disabled:!h?.isConnected,className:"flex-1 h-10 sm:h-10"}),e.jsx(S,{onClick:te,disabled:!h?.isConnected||!f.trim(),size:"icon",className:"h-10 w-10 shrink-0",children:e.jsx(u_,{className:"h-4 w-4"})})]})})})]})}var ox="Radio",[Xk,Pv]=Ko(ox),[Zk,Wk]=Xk(ox),Hv=m.forwardRef((l,n)=>{const{__scopeRadio:i,name:c,checked:u=!1,required:x,disabled:h,value:f="on",onCheck:p,form:g,...N}=l,[v,y]=m.useState(null),w=Qo(n,A=>y(A)),b=m.useRef(!1),O=v?g||!!v.closest("form"):!0;return e.jsxs(Zk,{scope:i,checked:u,disabled:h,children:[e.jsx(qn.button,{type:"button",role:"radio","aria-checked":u,"data-state":qv(u),"data-disabled":h?"":void 0,disabled:h,value:f,...N,ref:w,onClick:mn(l.onClick,A=>{u||p?.(),O&&(b.current=A.isPropagationStopped(),b.current||A.stopPropagation())})}),O&&e.jsx(Vv,{control:v,bubbles:!b.current,name:c,value:f,checked:u,required:x,disabled:h,form:g,style:{transform:"translateX(-100%)"}})]})});Hv.displayName=ox;var Fv="RadioIndicator",Gv=m.forwardRef((l,n)=>{const{__scopeRadio:i,forceMount:c,...u}=l,x=Wk(Fv,i);return e.jsx(Mw,{present:c||x.checked,children:e.jsx(qn.span,{"data-state":qv(x.checked),"data-disabled":x.disabled?"":void 0,...u,ref:n})})});Gv.displayName=Fv;var eC="RadioBubbleInput",Vv=m.forwardRef(({__scopeRadio:l,control:n,checked:i,bubbles:c=!0,...u},x)=>{const h=m.useRef(null),f=Qo(h,x),p=Aw(i),g=zw(n);return m.useEffect(()=>{const N=h.current;if(!N)return;const v=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(v,"checked").set;if(p!==i&&w){const b=new Event("click",{bubbles:c});w.call(N,i),N.dispatchEvent(b)}},[p,i,c]),e.jsx(qn.input,{type:"radio","aria-hidden":!0,defaultChecked:i,...u,tabIndex:-1,ref:f,style:{...u.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Vv.displayName=eC;function qv(l){return l?"checked":"unchecked"}var sC=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],rd="RadioGroup",[tC]=Ko(rd,[aj,Pv]),Kv=aj(),Qv=Pv(),[aC,lC]=tC(rd),Yv=m.forwardRef((l,n)=>{const{__scopeRadioGroup:i,name:c,defaultValue:u,value:x,required:h=!1,disabled:f=!1,orientation:p,dir:g,loop:N=!0,onValueChange:v,...y}=l,w=Kv(i),b=bj(g),[O,A]=qo({prop:x,defaultProp:u??null,onChange:v,caller:rd});return e.jsx(aC,{scope:i,name:c,required:h,disabled:f,value:O,onValueChange:A,children:e.jsx(q0,{asChild:!0,...w,orientation:p,dir:b,loop:N,children:e.jsx(qn.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":f?"":void 0,dir:b,...y,ref:n})})})});Yv.displayName=rd;var Jv="RadioGroupItem",Xv=m.forwardRef((l,n)=>{const{__scopeRadioGroup:i,disabled:c,...u}=l,x=lC(Jv,i),h=x.disabled||c,f=Kv(i),p=Qv(i),g=m.useRef(null),N=Qo(n,g),v=x.value===u.value,y=m.useRef(!1);return m.useEffect(()=>{const w=O=>{sC.includes(O.key)&&(y.current=!0)},b=()=>y.current=!1;return document.addEventListener("keydown",w),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",w),document.removeEventListener("keyup",b)}},[]),e.jsx(K0,{asChild:!0,...f,focusable:!h,active:v,children:e.jsx(Hv,{disabled:h,required:x.required,checked:v,...p,...u,name:x.name,ref:N,onCheck:()=>x.onValueChange(u.value),onKeyDown:mn(w=>{w.key==="Enter"&&w.preventDefault()}),onFocus:mn(u.onFocus,()=>{y.current&&g.current?.click()})})})});Xv.displayName=Jv;var nC="RadioGroupIndicator",Zv=m.forwardRef((l,n)=>{const{__scopeRadioGroup:i,...c}=l,u=Qv(i);return e.jsx(Gv,{...u,...c,ref:n})});Zv.displayName=nC;var Wv=Yv,eN=Xv,rC=Zv;const dx=m.forwardRef(({className:l,...n},i)=>e.jsx(Wv,{className:P("grid gap-2",l),...n,ref:i}));dx.displayName=Wv.displayName;const Go=m.forwardRef(({className:l,...n},i)=>e.jsx(eN,{ref:i,className:P("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",l),...n,children:e.jsx(rC,{className:"flex items-center justify-center",children:e.jsx(Lo,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Go.displayName=eN.displayName;function iC({question:l,value:n,onChange:i,error:c,disabled:u=!1}){const[x,h]=m.useState(null),f=u||l.readOnly,p=()=>{switch(l.type){case"single":return e.jsx(dx,{value:n||"",onValueChange:i,disabled:f,className:"space-y-2",children:l.options?.map(g=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Go,{value:g.value,id:`${l.id}-${g.id}`}),e.jsx(T,{htmlFor:`${l.id}-${g.id}`,className:"cursor-pointer font-normal",children:g.label})]},g.id))});case"multiple":{const g=n||[];return e.jsxs("div",{className:"space-y-2",children:[l.options?.map(N=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:`${l.id}-${N.id}`,checked:g.includes(N.value),disabled:f||l.maxSelections!==void 0&&g.length>=l.maxSelections&&!g.includes(N.value),onCheckedChange:v=>{i(v?[...g,N.value]:g.filter(y=>y!==N.value))}}),e.jsx(T,{htmlFor:`${l.id}-${N.id}`,className:"cursor-pointer font-normal",children:N.label})]},N.id)),l.maxSelections&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",l.maxSelections," "]})]})}case"text":return e.jsx(ne,{value:n||"",onChange:g=>i(g.target.value),placeholder:l.placeholder||"...",disabled:f,readOnly:l.readOnly,maxLength:l.maxLength,className:P(l.readOnly&&"bg-muted cursor-not-allowed")});case"textarea":return e.jsxs("div",{className:"space-y-1",children:[e.jsx(at,{value:n||"",onChange:g=>i(g.target.value),placeholder:l.placeholder||"...",disabled:f,readOnly:l.readOnly,maxLength:l.maxLength,rows:4,className:P(l.readOnly&&"bg-muted cursor-not-allowed")}),l.maxLength&&e.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[(n||"").length," / ",l.maxLength]})]});case"rating":{const g=n||0,N=x!==null?x:g;return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(v=>e.jsx("button",{type:"button",disabled:f,className:P("p-1 transition-colors focus:outline-none focus:ring-2 focus:ring-ring rounded",f&&"cursor-not-allowed opacity-50"),onMouseEnter:()=>!f&&h(v),onMouseLeave:()=>h(null),onClick:()=>!f&&i(v),children:e.jsx(cn,{className:P("h-6 w-6 transition-colors",v<=N?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},v)),g>0&&e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:[g," / 5"]})]})}case"scale":{const g=l.min??1,N=l.max??10,v=l.step??1,y=n??g;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Sa,{value:[y],onValueChange:([w])=>i(w),min:g,max:N,step:v,disabled:f}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:l.minLabel||g}),e.jsx("span",{className:"font-medium text-foreground",children:y}),e.jsx("span",{children:l.maxLabel||N})]})]})}case"dropdown":return e.jsxs(Ie,{value:n||"",onValueChange:i,disabled:f,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:l.placeholder||"..."})}),e.jsx(Be,{children:l.options?.map(g=>e.jsx(W,{value:g.value,children:g.label},g.id))})]});default:return e.jsx("div",{className:"text-muted-foreground",children:""})}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-base font-medium",children:[l.title,l.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),l.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:l.description})]}),p(),c&&e.jsx("p",{className:"text-sm text-destructive",children:c})]})}const sN="https://maibot-plugin-stats.maibot-webui.workers.dev";function tN(){const l="maibot_user_id";let n=localStorage.getItem(l);if(!n){const i=Math.random().toString(36).substring(2,10),c=Date.now().toString(36),u=Math.random().toString(36).substring(2,10);n=`fp_${i}_${c}_${u}`,localStorage.setItem(l,n)}return n}async function cC(l,n,i,c){try{const u=c?.userId||tN(),x={surveyId:l,surveyVersion:n,userId:u,answers:i,submittedAt:new Date().toISOString(),allowMultiple:c?.allowMultiple,metadata:{userAgent:navigator.userAgent,language:navigator.language}},h=await fetch(`${sN}/survey/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}),f=await h.json();return h.status===429?{success:!1,error:""}:h.status===409?{success:!1,error:f.error||""}:h.ok?{success:!0,submissionId:f.submissionId,message:f.message}:{success:!1,error:f.error||""}}catch(u){return console.error("Error submitting survey:",u),{success:!1,error:""}}}async function oC(l,n){try{const i=n||tN(),c=new URLSearchParams({user_id:i,survey_id:l}),u=await fetch(`${sN}/survey/check?${c}`);return u.ok?{success:!0,hasSubmitted:(await u.json()).hasSubmitted}:{success:!1,error:(await u.json()).error||""}}catch(i){return console.error("Error checking submission:",i),{success:!1,error:""}}}function aN({config:l,initialAnswers:n,onSubmitSuccess:i,onSubmitError:c,showProgress:u=!0,paginateQuestions:x=!1,className:h}){const f=m.useCallback(()=>!n||n.length===0?{}:n.reduce((I,L)=>(I[L.questionId]=L.value,I),{}),[n]),[p,g]=m.useState(()=>f()),[N,v]=m.useState({}),[y,w]=m.useState(0),[b,O]=m.useState(!1),[A,_]=m.useState(!1),[H,E]=m.useState(null),[C,M]=m.useState(null),[G,D]=m.useState(!1),[ee,R]=m.useState(!0);m.useEffect(()=>{n&&n.length>0&&g(I=>({...I,...f()}))},[n,f]),m.useEffect(()=>{(async()=>{if(!l.settings?.allowMultiple){const L=await oC(l.id);L.success&&L.hasSubmitted&&D(!0)}R(!1)})()},[l.id,l.settings?.allowMultiple]);const me=m.useCallback(()=>{const I=new Date;return!(l.settings?.startTime&&new Date(l.settings.startTime)>I||l.settings?.endTime&&new Date(l.settings.endTime)<I)},[l.settings?.startTime,l.settings?.endTime]),ce=l.questions.filter(I=>{const L=p[I.id];return L==null?!1:Array.isArray(L)?L.length>0:typeof L=="string"?L.trim()!=="":!0}).length,ve=ce/l.questions.length*100,se=m.useCallback((I,L)=>{g(B=>({...B,[I]:L})),v(B=>{const _e={...B};return delete _e[I],_e})},[]),ge=m.useCallback(()=>{const I={};for(const L of l.questions){if(L.required){const B=p[L.id];if(B==null){I[L.id]="";continue}if(Array.isArray(B)&&B.length===0){I[L.id]="";continue}if(typeof B=="string"&&B.trim()===""){I[L.id]="";continue}}L.minLength&&typeof p[L.id]=="string"&&p[L.id].length<L.minLength&&(I[L.id]=` ${L.minLength} `)}return v(I),Object.keys(I).length===0},[l.questions,p]),fe=m.useCallback(async()=>{if(!ge()){if(x){const I=l.questions.findIndex(L=>N[L.id]);I>=0&&w(I)}return}O(!0),E(null);try{const I=l.questions.filter(B=>p[B.id]!==void 0).map(B=>({questionId:B.id,value:p[B.id]})),L=await cC(l.id,l.version,I,{allowMultiple:l.settings?.allowMultiple});if(L.success&&L.submissionId)_(!0),M(L.submissionId),i?.(L.submissionId);else{const B=L.error||"";E(B),c?.(B)}}catch(I){const L=I instanceof Error?I.message:"";E(L),c?.(L)}finally{O(!1)}},[ge,x,l,p,N,i,c]),z=m.useCallback(I=>{I>=0&&I<l.questions.length&&w(I)},[l.questions.length]);if(ee)return e.jsx(Se,{className:P("w-full max-w-2xl mx-auto",h),children:e.jsx(Me,{className:"py-12 flex items-center justify-center",children:e.jsx(Ls,{className:"h-6 w-6 animate-spin text-muted-foreground"})})});if(G&&!l.settings?.allowMultiple)return e.jsxs(Se,{className:P("w-full max-w-2xl mx-auto",h),children:[e.jsx(ze,{children:e.jsx(Re,{children:l.title})}),e.jsx(Me,{className:"py-8",children:e.jsxs(lt,{children:[e.jsx(St,{className:"h-4 w-4"}),e.jsx(nt,{children:""})]})})]});if(!me())return e.jsxs(Se,{className:P("w-full max-w-2xl mx-auto",h),children:[e.jsx(ze,{children:e.jsx(Re,{children:l.title})}),e.jsx(Me,{className:"py-8",children:e.jsxs(lt,{variant:"destructive",children:[e.jsx(St,{className:"h-4 w-4"}),e.jsx(nt,{children:""})]})})]});if(A)return e.jsxs(Se,{className:P("w-full max-w-2xl mx-auto",h),children:[e.jsx(ze,{children:e.jsxs(Re,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(Wt,{className:"h-6 w-6"}),""]})}),e.jsxs(Me,{className:"py-8",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:l.settings?.thankYouMessage||""}),C&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["",C]})]})]});const Q=x?[l.questions[y]]:l.questions;return e.jsxs("div",{className:P("h-full flex flex-col",h),children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 mb-4 shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:l.title}),l.description&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:l.description}),u&&e.jsxs("div",{className:"space-y-1 pt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[ce," / ",l.questions.length]})]}),e.jsx(Vn,{value:ve,className:"h-2"})]})]}),e.jsx(Je,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[Q.map((I,L)=>e.jsxs("div",{className:P("p-4 rounded-lg border bg-card",N[I.id]?"border-destructive bg-destructive/5":"border-border"),children:[x&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[" ",y+1," / ",l.questions.length]}),!x&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[L+1,"."]}),e.jsx(iC,{question:I,value:p[I.id],onChange:B=>se(I.id,B),error:N[I.id],disabled:b})]},I.id)),H&&e.jsxs(lt,{variant:"destructive",children:[e.jsx(St,{className:"h-4 w-4"}),e.jsx(nt,{children:H})]}),e.jsx("div",{className:"flex justify-between items-center py-4",children:x?e.jsxs(e.Fragment,{children:[e.jsxs(S,{variant:"outline",onClick:()=>z(y-1),disabled:y===0||b,children:[e.jsx(Va,{className:"h-4 w-4 mr-1"}),""]}),y===l.questions.length-1?e.jsxs(S,{onClick:fe,disabled:b,children:[b&&e.jsx(Ls,{className:"h-4 w-4 mr-2 animate-spin"}),""]}):e.jsxs(S,{onClick:()=>z(y+1),disabled:b,children:["",e.jsx(sa,{className:"h-4 w-4 ml-1"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Object.keys(N).length>0&&e.jsxs("span",{className:"text-destructive",children:[" ",Object.keys(N).length," "]})}),e.jsxs(S,{onClick:fe,disabled:b,size:"lg",children:[b&&e.jsx(Ls,{className:"h-4 w-4 mr-2 animate-spin"}),""]})]})})]})})]})}const dC={id:"webui-feedback-v1",version:"1.0.0",title:" WebUI ",description:" WebUI",questions:[{id:"webui_version",type:"text",title:" WebUI ",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"ui_design_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"problems_encountered",type:"multiple",title:" WebUI ",description:"",required:!0,options:[{id:"lag",label:"",value:"lag"},{id:"incomplete",label:"",value:"incomplete"},{id:"complex",label:"",value:"complex"},{id:"bugs",label:" Bug",value:"bugs"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"useful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:" WebUI ",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}},uC={id:"maibot-feedback-v1",version:"1.0.0",title:"",description:" AI ",questions:[{id:"maibot_version",type:"text",title:"",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"improvement_areas",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"problems_encountered",type:"multiple",title:"",description:"",required:!0,options:[{id:"incomplete",label:"",value:"incomplete"},{id:"slow_response",label:"",value:"slow_response"},{id:"complex",label:"",value:"complex"},{id:"unstable",label:"",value:"unstable"},{id:"config_difficult",label:"",value:"config_difficult"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"helpful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:"",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:"",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}};function mC(){const[l,n]=m.useState(!0),i=m.useMemo(()=>JSON.parse(JSON.stringify(dC)),[]);m.useEffect(()=>{n(!1)},[]);const c=m.useMemo(()=>[{questionId:"webui_version",value:`v${Wo}`}],[]),u=m.useCallback(h=>{console.log("WebUI Survey submitted:",h)},[]),x=m.useCallback(h=>{console.error("WebUI Survey submission error:",h)},[]);return l?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Ls,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):i?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx($j,{className:"h-8 w-8",strokeWidth:2}),"WebUI "]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(aN,{config:i,initialAnswers:c,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:u,onSubmitError:x})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(lt,{variant:"destructive",className:"max-w-md",children:[e.jsx(St,{className:"h-4 w-4"}),e.jsx(nt,{children:""})]}),e.jsx(S,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}function xC(){const[l,n]=m.useState(null),[i,c]=m.useState(!0),[u,x]=m.useState("");m.useEffect(()=>{(async()=>{try{const v=await l2();x(v.version||"")}catch(v){console.error("Failed to get MaiBot version:",v),x("")}const N=JSON.parse(JSON.stringify(uC));n(N),c(!1)})()},[]);const h=m.useMemo(()=>[{questionId:"maibot_version",value:u}],[u]),f=m.useCallback(g=>{console.log("MaiBot Survey submitted:",g)},[]),p=m.useCallback(g=>{console.error("MaiBot Survey submission error:",g)},[]);return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Ls,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):l?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx($j,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" AI "})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(aN,{config:l,initialAnswers:h,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:f,onSubmitError:p})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(lt,{variant:"destructive",className:"max-w-md",children:[e.jsx(St,{className:"h-4 w-4"}),e.jsx(nt,{children:""})]}),e.jsx(S,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}async function hC(l=2025){const n=await we(`/api/webui/annual-report/full?year=${l}`);if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}const Rg=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"];function fC(){const[l]=m.useState(2025),[n,i]=m.useState(null),[c,u]=m.useState(!0),[x,h]=m.useState(null),f=m.useRef(null),p=m.useCallback(async()=>{try{u(!0),h(null);const g=await hC(l);i(g)}catch(g){h(g instanceof Error?g:new Error(""))}finally{u(!1)}},[l]);return m.useEffect(()=>{p()},[p]),c?e.jsx(pC,{}):x?e.jsxs("div",{className:"flex h-screen items-center justify-center text-red-500",children:[": ",x.message]}):n?e.jsx(Je,{className:"h-[calc(100vh-4rem)]",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/50 p-4 md:p-8 print:p-0",children:e.jsxs("div",{className:"mx-auto max-w-5xl space-y-8 print:space-y-4",ref:f,children:[e.jsxs("header",{className:"relative overflow-hidden rounded-3xl bg-primary p-8 text-primary-foreground shadow-2xl print:rounded-none print:shadow-none",children:[e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx($r,{className:"mb-4 h-16 w-16 animate-bounce"}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tighter sm:text-6xl",children:[" ",n.year," "]}),e.jsx("p",{className:"mt-4 max-w-2xl text-lg opacity-90",children:"  Connection & Growth"}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-sm opacity-75",children:[e.jsx($o,{className:"h-4 w-4"}),e.jsxs("span",{children:[": ",n.generated_at]})]})]}),e.jsx("div",{className:"absolute -right-20 -top-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(Ca,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(_a,{title:"",value:`${n.time_footprint.total_online_hours} `,description:"",icon:e.jsx(Ca,{className:"h-4 w-4"})}),e.jsx(_a,{title:"",value:n.time_footprint.busiest_day||"N/A",description:` ${n.time_footprint.busiest_day_count} `,icon:e.jsx($o,{className:"h-4 w-4"})}),e.jsx(_a,{title:" (0-4)",value:`${n.time_footprint.midnight_chat_count} `,description:"",icon:e.jsx(Ki,{className:"h-4 w-4"})}),e.jsx(_a,{title:"",value:n.time_footprint.is_night_owl?"":"",description:n.time_footprint.is_night_owl?"":"",icon:n.time_footprint.is_night_owl?e.jsx(Ki,{className:"h-4 w-4"}):e.jsx(qm,{className:"h-4 w-4"})})]}),e.jsxs(Se,{className:"overflow-hidden",children:[e.jsxs(ze,{children:[e.jsx(Re,{children:"24"}),e.jsx(ws,{children:""})]}),e.jsx(Me,{className:"h-[300px]",children:e.jsx(rj,{width:"100%",height:"100%",children:e.jsxs(Eo,{data:n.time_footprint.hourly_distribution.map((g,N)=>({hour:`${N}`,count:g})),children:[e.jsx(Pi,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Hi,{dataKey:"hour"}),e.jsx(Rr,{}),e.jsx(ij,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},cursor:{fill:"transparent"}}),e.jsx(Fi,{dataKey:"count",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),n.time_footprint.first_message_time&&e.jsx(Se,{className:"bg-muted/30 border-dashed",children:e.jsxs(Me,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"2025"}),e.jsx("div",{className:"text-xl font-bold text-primary mb-1",children:n.time_footprint.first_message_time}),e.jsxs("p",{className:"text-lg",children:[e.jsx("span",{className:"font-semibold text-foreground",children:n.time_footprint.first_message_user})," ",e.jsxs("span",{className:"italic text-muted-foreground",children:['"',n.time_footprint.first_message_content,'"']})]})]})})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(sc,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(_a,{title:"",value:`${n.social_network.total_groups} `,description:` ${n.social_network.new_friends_count} `,icon:e.jsx(sc,{className:"h-4 w-4"})}),e.jsx(_a,{title:"",value:`${n.social_network.at_count+n.social_network.mentioned_count} `,description:"",icon:e.jsx(m_,{className:"h-4 w-4"})}),e.jsx(_a,{title:"",value:n.social_network.longest_companion_user||"N/A",description:` ${n.social_network.longest_companion_days} `,icon:e.jsx(Gr,{className:"h-4 w-4 text-red-500"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsx(Re,{children:" TOP3"})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-4",children:n.social_network.top_groups.map((g,N)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:N===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center",children:N+1}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:g.group_name})]}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[g.message_count," "]})]},g.group_id))})})]}),e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsx(Re,{children:" TOP3"})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-4",children:n.social_network.top_users.map((g,N)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:N===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center",children:N+1}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:g.user_nickname})]}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[g.message_count," "]})]},g.user_id))})})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(Xm,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(_a,{title:" Token ",value:(n.brain_power.total_tokens/1e6).toFixed(2)+" M",description:" 0.5 ",icon:e.jsx(Xa,{className:"h-4 w-4"})}),e.jsx(_a,{title:"",value:`$${n.brain_power.total_cost.toFixed(2)}`,description:"",icon:e.jsx("span",{className:"font-bold",children:"$"})}),e.jsx(_a,{title:"",value:`${n.brain_power.silence_rate}%`,description:` ${n.brain_power.no_reply_count} `,icon:e.jsx(Ki,{className:"h-4 w-4"})}),e.jsx(_a,{title:"",value:n.brain_power.max_interest_value??"N/A",description:n.brain_power.max_interest_time?` ${n.brain_power.max_interest_time}`:"",icon:e.jsx(Gr,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Se,{children:[e.jsx(ze,{children:e.jsx(Re,{children:""})}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-3",children:n.brain_power.model_distribution.slice(0,5).map((g,N)=>{const v=n.brain_power.model_distribution[0]?.count||1,y=Math.round(g.count/v*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:g.model}),e.jsxs("span",{className:"text-muted-foreground",children:[g.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${y}%`,backgroundColor:Rg[N%Rg.length]}})})]},g.model)})})})]}),e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:" TOP3"}),e.jsx(ws,{children:" API "})]}),e.jsx(Me,{children:e.jsx("div",{className:"space-y-6",children:n.brain_power.top_token_consumers.map(g=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsxs("span",{children:[" ",g.user_id]}),e.jsxs("span",{children:["$",g.cost.toFixed(2)]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-500",style:{width:`${g.cost/(n.brain_power.top_token_consumers[0]?.cost||1)*100}%`}})})]},g.user_id))})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Se,{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20",children:[e.jsx(ze,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Me,{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-amber-600 dark:text-amber-400",children:["$",n.brain_power.most_expensive_cost.toFixed(4)]}),n.brain_power.most_expensive_time&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[" ",n.brain_power.most_expensive_time]}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:""})]})]}),e.jsxs(Se,{className:"bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-950/20 dark:to-blue-950/20",children:[e.jsx(ze,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Me,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:n.brain_power.avg_reasoning_length?.toFixed(0)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:n.brain_power.max_reasoning_length?.toLocaleString()||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]}),n.brain_power.max_reasoning_time&&e.jsxs("p",{className:"mt-4 text-center text-xs text-muted-foreground",children:[" ",n.brain_power.max_reasoning_time]})]})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(Yo,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Se,{className:"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/20 dark:to-purple-950/20",children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{className:"flex flex-col items-center justify-center",children:n.expression_vibe.top_emoji?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-4 h-48 w-48 overflow-hidden rounded-lg shadow-lg transition-transform hover:scale-105",children:[e.jsx("img",{src:`/api/webui/emoji/${n.expression_vibe.top_emoji.id}/thumbnail?original=true`,alt:"Top Emoji",className:"h-full w-full object-cover"}),e.jsx(ke,{className:"absolute right-2 top-2 bg-yellow-500",children:"NO.1"})]}),e.jsxs("p",{className:"text-center font-medium text-lg",children:['"',n.expression_vibe.top_emoji.description,'"']}),e.jsxs("p",{className:"text-muted-foreground",children:[" ",n.expression_vibe.top_emoji.usage_count," "]})]}):e.jsx("div",{className:"flex h-48 items-center justify-center text-muted-foreground",children:""})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:n.expression_vibe.top_expressions.map((g,N)=>e.jsxs(ke,{variant:"outline",className:P("px-3 py-1 text-sm",N===0&&"border-primary bg-primary/10 text-primary text-base px-4 py-2"),children:[g.style," (",g.count,")"]},g.style))})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(_a,{title:"",value:`${n.expression_vibe.image_processed_count} `,description:"",icon:e.jsx(Jm,{className:"h-4 w-4"})}),e.jsx(_a,{title:"",value:`${n.expression_vibe.rejected_expression_count} `,description:"",icon:e.jsx(Xa,{className:"h-4 w-4"})})]})]})]}),n.expression_vibe.action_types.length>0&&e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:n.expression_vibe.action_types.map(g=>e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2",children:[e.jsx("span",{className:"font-medium text-primary",children:g.action}),e.jsxs(ke,{variant:"secondary",children:[g.count," "]})]},g.action))})})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(x_,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(Se,{className:"col-span-1 md:col-span-2",children:[e.jsxs(ze,{children:[e.jsx(Re,{children:'""'}),e.jsxs(ws,{children:[" ",n.achievements.new_jargon_count," "]})]}),e.jsx(Me,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:n.achievements.sample_jargons.map(g=>e.jsxs("div",{className:"group relative rounded-lg border bg-card p-3 shadow-sm transition-all hover:shadow-md",children:[e.jsx("div",{className:"font-bold text-primary",children:g.content}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2 max-w-[200px]",children:g.meaning||""})]},g.content))})})]}),e.jsx(Se,{className:"flex flex-col justify-center items-center bg-primary text-primary-foreground",children:e.jsxs(Me,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Ea,{className:"h-12 w-12 mb-4 opacity-80"}),e.jsx("div",{className:"text-4xl font-bold mb-2",children:n.achievements.total_messages.toLocaleString()}),e.jsx("div",{className:"text-sm opacity-80",children:""}),e.jsxs("div",{className:"mt-4 text-xs opacity-60",children:[" ",n.achievements.total_replies.toLocaleString()," "]})]})})]})]}),e.jsxs("footer",{className:"mt-12 text-center text-muted-foreground",children:[e.jsx("p",{children:"MaiBot 2025 Annual Report"}),e.jsx("p",{className:"text-sm",children:"Generated with  by MaiBot Team"})]})]})})}):null}function _a({title:l,value:n,description:i,icon:c}){return e.jsxs(Se,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Re,{className:"text-sm font-medium",children:l}),e.jsx("div",{className:"text-muted-foreground",children:c})]}),e.jsxs(Me,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i})]})]})}function pC(){return e.jsxs("div",{className:"container mx-auto space-y-8 p-8",children:[e.jsx(js,{className:"h-64 w-full rounded-3xl"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((l,n)=>e.jsx(js,{className:"h-32 w-full"},n))}),e.jsx(js,{className:"h-96 w-full"})]})}var id="DropdownMenu",[gC]=Ko(id,[lj]),ca=lj(),[jC,lN]=gC(id),nN=l=>{const{__scopeDropdownMenu:n,children:i,dir:c,open:u,defaultOpen:x,onOpenChange:h,modal:f=!0}=l,p=ca(n),g=m.useRef(null),[N,v]=qo({prop:u,defaultProp:x??!1,onChange:h,caller:id});return e.jsx(jC,{scope:n,triggerId:Lm(),triggerRef:g,contentId:Lm(),open:N,onOpenChange:v,onOpenToggle:m.useCallback(()=>v(y=>!y),[v]),modal:f,children:e.jsx(lw,{...p,open:N,onOpenChange:v,dir:c,modal:f,children:i})})};nN.displayName=id;var rN="DropdownMenuTrigger",iN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,disabled:c=!1,...u}=l,x=lN(rN,i),h=ca(i);return e.jsx(nw,{asChild:!0,...h,children:e.jsx(qn.button,{type:"button",id:x.triggerId,"aria-haspopup":"menu","aria-expanded":x.open,"aria-controls":x.open?x.contentId:void 0,"data-state":x.open?"open":"closed","data-disabled":c?"":void 0,disabled:c,...u,ref:Ow(n,x.triggerRef),onPointerDown:mn(l.onPointerDown,f=>{!c&&f.button===0&&f.ctrlKey===!1&&(x.onOpenToggle(),x.open||f.preventDefault())}),onKeyDown:mn(l.onKeyDown,f=>{c||(["Enter"," "].includes(f.key)&&x.onOpenToggle(),f.key==="ArrowDown"&&x.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});iN.displayName=rN;var vC="DropdownMenuPortal",cN=l=>{const{__scopeDropdownMenu:n,...i}=l,c=ca(n);return e.jsx(J0,{...c,...i})};cN.displayName=vC;var oN="DropdownMenuContent",dN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=lN(oN,i),x=ca(i),h=m.useRef(!1);return e.jsx(X0,{id:u.contentId,"aria-labelledby":u.triggerId,...x,...c,ref:n,onCloseAutoFocus:mn(l.onCloseAutoFocus,f=>{h.current||u.triggerRef.current?.focus(),h.current=!1,f.preventDefault()}),onInteractOutside:mn(l.onInteractOutside,f=>{const p=f.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,N=p.button===2||g;(!u.modal||N)&&(h.current=!0)}),style:{...l.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});dN.displayName=oN;var NC="DropdownMenuGroup",bC=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(rw,{...u,...c,ref:n})});bC.displayName=NC;var yC="DropdownMenuLabel",uN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(tw,{...u,...c,ref:n})});uN.displayName=yC;var wC="DropdownMenuItem",mN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(Z0,{...u,...c,ref:n})});mN.displayName=wC;var _C="DropdownMenuCheckboxItem",xN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(W0,{...u,...c,ref:n})});xN.displayName=_C;var SC="DropdownMenuRadioGroup",kC=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(iw,{...u,...c,ref:n})});kC.displayName=SC;var CC="DropdownMenuRadioItem",hN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(sw,{...u,...c,ref:n})});hN.displayName=CC;var TC="DropdownMenuItemIndicator",fN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(ew,{...u,...c,ref:n})});fN.displayName=TC;var EC="DropdownMenuSeparator",pN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(aw,{...u,...c,ref:n})});pN.displayName=EC;var MC="DropdownMenuArrow",AC=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(cw,{...u,...c,ref:n})});AC.displayName=MC;var zC="DropdownMenuSubTrigger",gN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(Q0,{...u,...c,ref:n})});gN.displayName=zC;var OC="DropdownMenuSubContent",jN=m.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=ca(i);return e.jsx(Y0,{...u,...c,ref:n,style:{...l.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});jN.displayName=OC;var DC=nN,RC=iN,LC=cN,vN=dN,NN=uN,bN=mN,yN=xN,wN=hN,_N=fN,SN=pN,kN=gN,CN=jN;const UC=DC,$C=RC,BC=m.forwardRef(({className:l,inset:n,children:i,...c},u)=>e.jsxs(kN,{ref:u,className:P("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",l),...c,children:[i,e.jsx(sa,{className:"ml-auto h-4 w-4"})]}));BC.displayName=kN.displayName;const IC=m.forwardRef(({className:l,...n},i)=>e.jsx(CN,{ref:i,className:P("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...n}));IC.displayName=CN.displayName;const TN=m.forwardRef(({className:l,sideOffset:n=4,...i},c)=>e.jsx(LC,{children:e.jsx(vN,{ref:c,sideOffset:n,className:P("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...i})}));TN.displayName=vN.displayName;const EN=m.forwardRef(({className:l,inset:n,...i},c)=>e.jsx(bN,{ref:c,className:P("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",l),...i}));EN.displayName=bN.displayName;const PC=m.forwardRef(({className:l,children:n,checked:i,...c},u)=>e.jsxs(yN,{ref:u,className:P("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),checked:i,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(_N,{children:e.jsx(_t,{className:"h-4 w-4"})})}),n]}));PC.displayName=yN.displayName;const HC=m.forwardRef(({className:l,children:n,...i},c)=>e.jsxs(wN,{ref:c,className:P("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),...i,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(_N,{children:e.jsx(Lo,{className:"h-2 w-2 fill-current"})})}),n]}));HC.displayName=wN.displayName;const FC=m.forwardRef(({className:l,inset:n,...i},c)=>e.jsx(NN,{ref:c,className:P("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",l),...i}));FC.displayName=NN.displayName;const GC=m.forwardRef(({className:l,...n},i)=>e.jsx(SN,{ref:i,className:P("-mx-1 my-1 h-px bg-muted",l),...n}));GC.displayName=SN.displayName;const MN=({className:l,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:P("mx-auto flex w-full justify-center",l),...n});MN.displayName="Pagination";const AN=m.forwardRef(({className:l,...n},i)=>e.jsx("ul",{ref:i,className:P("flex flex-row items-center gap-1",l),...n}));AN.displayName="PaginationContent";const Do=m.forwardRef(({className:l,...n},i)=>e.jsx("li",{ref:i,className:P("",l),...n}));Do.displayName="PaginationItem";const cd=({className:l,isActive:n,size:i="icon",...c})=>e.jsx("a",{"aria-current":n?"page":void 0,className:P(Vr({variant:n?"outline":"ghost",size:i}),l),...c});cd.displayName="PaginationLink";const zN=({className:l,...n})=>e.jsxs(cd,{"aria-label":"Go to previous page",size:"default",className:P("gap-1 pl-2.5",l),...n,children:[e.jsx(Va,{className:"h-4 w-4"}),e.jsx("span",{children:""})]});zN.displayName="PaginationPrevious";const ON=({className:l,...n})=>e.jsxs(cd,{"aria-label":"Go to next page",size:"default",className:P("gap-1 pr-2.5",l),...n,children:[e.jsx("span",{children:""}),e.jsx(sa,{className:"h-4 w-4"})]});ON.displayName="PaginationNext";const Rm=[{value:"created_at",label:"",icon:Ca},{value:"downloads",label:"",icon:Zt},{value:"likes",label:"",icon:Gr}];function VC(){const l=ia(),[n,i]=m.useState([]),[c,u]=m.useState(!0),[x,h]=m.useState(""),[f,p]=m.useState("downloads"),[g,N]=m.useState(1),[v,y]=m.useState(1),[w,b]=m.useState(0),[O,A]=m.useState(new Set),[_,H]=m.useState(new Set),E=Nv(),C=m.useCallback(async()=>{u(!0);try{const R=await Z1({status:"approved",page:g,page_size:12,search:x||void 0,sort_by:f,sort_order:"desc"});i(R.packs),y(R.total_pages),b(R.total);const me=new Set;for(const ce of R.packs)await vv(ce.id,E)&&me.add(ce.id);A(me)}catch(R){console.error(" Pack :",R),Kt({title:" Pack ",variant:"destructive"})}finally{u(!1)}},[g,x,f,E]);m.useEffect(()=>{C()},[C]);const M=R=>{R.preventDefault(),N(1),C()},G=async R=>{if(!_.has(R)){H(me=>new Set(me).add(R));try{const me=await jv(R,E);A(ce=>{const ve=new Set(ce);return me.liked?ve.add(R):ve.delete(R),ve}),i(ce=>ce.map(ve=>ve.id===R?{...ve,likes:me.likes}:ve))}catch(me){console.error(":",me),Kt({title:"",variant:"destructive"})}finally{H(me=>{const ce=new Set(me);return ce.delete(R),ce})}}},D=R=>{l({to:"/config/pack-market/$packId",params:{packId:R}})},ee=Rm.find(R=>R.value===f)||Rm[0];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(la,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" MaiBot"})]}),e.jsxs(S,{variant:"outline",onClick:C,disabled:c,className:"gap-2",children:[e.jsx(ft,{className:`h-4 w-4 ${c?"animate-spin":""}`}),""]})]})}),e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("form",{onSubmit:M,className:"flex-1 min-w-[200px] max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:x,onChange:R=>h(R.target.value),className:"pl-10"})]})}),e.jsxs(UC,{children:[e.jsx($C,{asChild:!0,children:e.jsxs(S,{variant:"outline",className:"min-w-[140px] gap-2",children:[e.jsx(h_,{className:"w-4 h-4"}),ee.label,e.jsx(Aa,{className:"w-4 h-4 ml-auto"})]})}),e.jsx(TN,{align:"end",children:Rm.map(R=>e.jsxs(EN,{onClick:()=>{p(R.value),N(1)},children:[e.jsx(R.icon,{className:"w-4 h-4 mr-2"}),R.label]},R.value))})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",e.jsx("span",{className:"font-medium text-foreground",children:w})," "]}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((R,me)=>e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(js,{className:"h-6 w-3/4"}),e.jsx(js,{className:"h-4 w-full mt-2"})]}),e.jsx(Me,{children:e.jsx(js,{className:"h-20 w-full"})}),e.jsx(Zo,{children:e.jsx(js,{className:"h-9 w-full"})})]},me))}):n.length===0?e.jsx(Se,{className:"py-12",children:e.jsxs(Me,{className:"text-center text-muted-foreground",children:[e.jsx(la,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:""}),e.jsx("p",{className:"mt-1",children:""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(R=>e.jsx(qC,{pack:R,liked:O.has(R.id),liking:_.has(R.id),onLike:()=>G(R.id),onView:()=>D(R.id)},R.id))}),v>1&&e.jsx(MN,{children:e.jsxs(AN,{children:[e.jsx(Do,{children:e.jsx(zN,{onClick:()=>N(R=>Math.max(1,R-1)),className:g===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:v},(R,me)=>me+1).filter(R=>R===1||R===v||Math.abs(R-g)<=1).map((R,me,ce)=>{const ve=me>0&&R-ce[me-1]>1;return e.jsxs(Do,{children:[ve&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(cd,{onClick:()=>N(R),isActive:R===g,className:"cursor-pointer",children:R})]},R)}),e.jsx(Do,{children:e.jsx(ON,{onClick:()=>N(R=>Math.min(v,R+1)),className:g===v?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})]})}function qC({pack:l,liked:n,liking:i,onLike:c,onView:u}){const x=h=>new Date(h).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(Se,{className:"flex flex-col hover:shadow-md transition-shadow",children:[e.jsxs(ze,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(Re,{className:"text-lg line-clamp-1",children:l.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:["v",l.version]})]}),e.jsx(ws,{className:"line-clamp-2 min-h-[40px]",children:l.description})]}),e.jsxs(Me,{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(In,{className:"w-3.5 h-3.5"}),l.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ca,{className:"w-3.5 h-3.5"}),x(l.created_at)]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(zl,{className:"w-3.5 h-3.5"}),l.provider_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Hn,{className:"w-3.5 h-3.5"}),l.model_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Fn,{className:"w-3.5 h-3.5"}),l.task_count]})]}),l.tags&&l.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.tags.slice(0,3).map(h=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(Xo,{className:"w-2.5 h-2.5 mr-1"}),h]},h)),l.tags.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",l.tags.length-3]})]})]}),e.jsx(Zo,{className:"pt-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Zt,{className:"w-4 h-4"}),l.downloads]}),e.jsxs("button",{onClick:h=>{h.stopPropagation(),c()},disabled:i,className:`flex items-center gap-1 transition-colors ${n?"text-red-500":"hover:text-red-500"} ${i?"opacity-50":""}`,children:[e.jsx(Gr,{className:`w-4 h-4 ${n?"fill-current":""}`}),l.likes]})]}),e.jsx(S,{size:"sm",onClick:u,children:""})]})})]})}var Wa="Accordion",KC=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ux,QC,YC]=Dw(Wa),[od]=Ko(Wa,[YC,nj]),mx=nj(),DN=zs.forwardRef((l,n)=>{const{type:i,...c}=l,u=c,x=c;return e.jsx(ux.Provider,{scope:l.__scopeAccordion,children:i==="multiple"?e.jsx(WC,{...x,ref:n}):e.jsx(ZC,{...u,ref:n})})});DN.displayName=Wa;var[RN,JC]=od(Wa),[LN,XC]=od(Wa,{collapsible:!1}),ZC=zs.forwardRef((l,n)=>{const{value:i,defaultValue:c,onValueChange:u=()=>{},collapsible:x=!1,...h}=l,[f,p]=qo({prop:i,defaultProp:c??"",onChange:u,caller:Wa});return e.jsx(RN,{scope:l.__scopeAccordion,value:zs.useMemo(()=>f?[f]:[],[f]),onItemOpen:p,onItemClose:zs.useCallback(()=>x&&p(""),[x,p]),children:e.jsx(LN,{scope:l.__scopeAccordion,collapsible:x,children:e.jsx(UN,{...h,ref:n})})})}),WC=zs.forwardRef((l,n)=>{const{value:i,defaultValue:c,onValueChange:u=()=>{},...x}=l,[h,f]=qo({prop:i,defaultProp:c??[],onChange:u,caller:Wa}),p=zs.useCallback(N=>f((v=[])=>[...v,N]),[f]),g=zs.useCallback(N=>f((v=[])=>v.filter(y=>y!==N)),[f]);return e.jsx(RN,{scope:l.__scopeAccordion,value:h,onItemOpen:p,onItemClose:g,children:e.jsx(LN,{scope:l.__scopeAccordion,collapsible:!0,children:e.jsx(UN,{...x,ref:n})})})}),[e3,dd]=od(Wa),UN=zs.forwardRef((l,n)=>{const{__scopeAccordion:i,disabled:c,dir:u,orientation:x="vertical",...h}=l,f=zs.useRef(null),p=Qo(f,n),g=QC(i),v=bj(u)==="ltr",y=mn(l.onKeyDown,w=>{if(!KC.includes(w.key))return;const b=w.target,O=g().filter(ee=>!ee.ref.current?.disabled),A=O.findIndex(ee=>ee.ref.current===b),_=O.length;if(A===-1)return;w.preventDefault();let H=A;const E=0,C=_-1,M=()=>{H=A+1,H>C&&(H=E)},G=()=>{H=A-1,H<E&&(H=C)};switch(w.key){case"Home":H=E;break;case"End":H=C;break;case"ArrowRight":x==="horizontal"&&(v?M():G());break;case"ArrowDown":x==="vertical"&&M();break;case"ArrowLeft":x==="horizontal"&&(v?G():M());break;case"ArrowUp":x==="vertical"&&G();break}const D=H%_;O[D].ref.current?.focus()});return e.jsx(e3,{scope:i,disabled:c,direction:u,orientation:x,children:e.jsx(ux.Slot,{scope:i,children:e.jsx(qn.div,{...h,"data-orientation":x,ref:p,onKeyDown:c?void 0:y})})})}),Vo="AccordionItem",[s3,xx]=od(Vo),$N=zs.forwardRef((l,n)=>{const{__scopeAccordion:i,value:c,...u}=l,x=dd(Vo,i),h=JC(Vo,i),f=mx(i),p=Lm(),g=c&&h.value.includes(c)||!1,N=x.disabled||l.disabled;return e.jsx(s3,{scope:i,open:g,disabled:N,triggerId:p,children:e.jsx(Wg,{"data-orientation":x.orientation,"data-state":GN(g),...f,...u,ref:n,disabled:N,open:g,onOpenChange:v=>{v?h.onItemOpen(c):h.onItemClose(c)}})})});$N.displayName=Vo;var BN="AccordionHeader",IN=zs.forwardRef((l,n)=>{const{__scopeAccordion:i,...c}=l,u=dd(Wa,i),x=xx(BN,i);return e.jsx(qn.h3,{"data-orientation":u.orientation,"data-state":GN(x.open),"data-disabled":x.disabled?"":void 0,...c,ref:n})});IN.displayName=BN;var Fm="AccordionTrigger",PN=zs.forwardRef((l,n)=>{const{__scopeAccordion:i,...c}=l,u=dd(Wa,i),x=xx(Fm,i),h=XC(Fm,i),f=mx(i);return e.jsx(ux.ItemSlot,{scope:i,children:e.jsx(ow,{"aria-disabled":x.open&&!h.collapsible||void 0,"data-orientation":u.orientation,id:x.triggerId,...f,...c,ref:n})})});PN.displayName=Fm;var HN="AccordionContent",FN=zs.forwardRef((l,n)=>{const{__scopeAccordion:i,...c}=l,u=dd(Wa,i),x=xx(HN,i),h=mx(i);return e.jsx(dw,{role:"region","aria-labelledby":x.triggerId,"data-orientation":u.orientation,...h,...c,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...l.style}})});FN.displayName=HN;function GN(l){return l?"open":"closed"}var t3=DN,a3=$N,l3=IN,VN=PN,qN=FN;const n3=t3,KN=m.forwardRef(({className:l,...n},i)=>e.jsx(a3,{ref:i,className:P("border-b",l),...n}));KN.displayName="AccordionItem";const QN=m.forwardRef(({className:l,children:n,...i},c)=>e.jsx(l3,{className:"flex",children:e.jsxs(VN,{ref:c,className:P("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",l),...i,children:[n,e.jsx(Aa,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));QN.displayName=VN.displayName;const YN=m.forwardRef(({className:l,children:n,...i},c)=>e.jsx(qN,{ref:c,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:e.jsx("div",{className:P("pb-4 pt-0",l),children:n})}));YN.displayName=qN.displayName;const r3={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""};function i3(){const{packId:l}=eb.useParams(),n=ia(),[i,c]=m.useState(null),[u,x]=m.useState(!0),[h,f]=m.useState(!1),[p,g]=m.useState(!1),[N,v]=m.useState(!1),[y,w]=m.useState(1),[b,O]=m.useState(null),[A,_]=m.useState(!1),[H,E]=m.useState(!1),[C,M]=m.useState({apply_providers:!0,apply_models:!0,apply_task_config:!0,task_mode:"append",selected_providers:void 0,selected_models:void 0,selected_tasks:void 0}),[G,D]=m.useState({}),[ee,R]=m.useState({}),me=Nv(),ce=m.useCallback(async()=>{if(l){x(!0);try{const z=await W1(l);c(z);const Q=await vv(l,me);f(Q)}catch(z){console.error(" Pack :",z),Kt({title:"",variant:"destructive"})}finally{x(!1)}}},[l,me]);m.useEffect(()=>{ce()},[ce]);const ve=async()=>{if(!(!l||p)){g(!0);try{const z=await jv(l,me);f(z.liked),i&&c({...i,likes:z.likes})}catch(z){console.error(":",z),Kt({title:"",variant:"destructive"})}finally{g(!1)}}},se=async()=>{if(i){v(!0),w(1),_(!0);try{const z=await tS(i);O(z);const Q={};for(const L of z.existing_providers)Q[L.pack_provider.name]=L.local_providers[0].name;D(Q);const I={};for(const L of z.new_providers)I[L.name]="";R(I)}catch(z){console.error(":",z),Kt({title:"",variant:"destructive"}),v(!1)}finally{_(!1)}}},ge=async()=>{if(i){if(C.apply_providers&&b){for(const z of b.new_providers)if(!ee[z.name]){Kt({title:` "${z.name}"  API Key`,variant:"destructive"});return}}E(!0);try{await aS(i,C,G,ee),await sS(i.id,me),c({...i,downloads:i.downloads+1}),Kt({title:""}),v(!1)}catch(z){console.error(" Pack :",z),Kt({title:z instanceof Error?z.message:"",variant:"destructive"})}finally{E(!1)}}},fe=z=>new Date(z).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"});return u?e.jsx(o3,{}):i?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(S,{variant:"ghost",size:"sm",onClick:()=>n({to:"/config/pack-market"}),className:"gap-2",children:[e.jsx(Ta,{className:"w-4 h-4"}),""]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(la,{className:"w-10 h-10 text-primary mt-1"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[i.name,e.jsxs(ke,{variant:"secondary",children:["v",i.version]})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:i.description})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(In,{className:"w-4 h-4"}),i.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ca,{className:"w-4 h-4"}),fe(i.created_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Zt,{className:"w-4 h-4"}),i.downloads," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Gr,{className:`w-4 h-4 ${h?"fill-red-500 text-red-500":""}`}),i.likes," "]})]}),i.tags&&i.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:i.tags.map(z=>e.jsxs(ke,{variant:"outline",children:[e.jsx(Xo,{className:"w-3 h-3 mr-1"}),z]},z))})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsxs(S,{size:"lg",onClick:se,children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),""]}),e.jsxs(S,{variant:"outline",onClick:ve,disabled:p,className:h?"text-red-500 border-red-200":"",children:[e.jsx(Gr,{className:`w-4 h-4 mr-2 ${h?"fill-current":""}`}),h?"":""]})]})]}),e.jsx(Qt,{}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Se,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(zl,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i.providers.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"API "})]})]})}),e.jsx(Se,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Hn,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i.models.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})}),e.jsx(Se,{children:e.jsxs(Me,{className:"flex items-center gap-3 py-4",children:[e.jsx(Fn,{className:"w-8 h-8 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(i.task_config).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})})]}),e.jsxs(ra,{defaultValue:"providers",className:"space-y-4",children:[e.jsxs(ea,{children:[e.jsxs(ts,{value:"providers",children:[e.jsx(zl,{className:"w-4 h-4 mr-2"})," (",i.providers.length,")"]}),e.jsxs(ts,{value:"models",children:[e.jsx(Hn,{className:"w-4 h-4 mr-2"})," (",i.models.length,")"]}),e.jsxs(ts,{value:"tasks",children:[e.jsx(Fn,{className:"w-4 h-4 mr-2"})," (",Object.keys(i.task_config).length,")"]})]}),e.jsx(ys,{value:"providers",children:e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:"API "}),e.jsx(ws,{children:" API  API Key"})]}),e.jsx(Me,{children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"Base URL"}),e.jsx(Ze,{children:""})]})}),e.jsx(Rl,{children:i.providers.map(z=>e.jsxs(dt,{children:[e.jsx(Ke,{className:"font-medium",children:z.name}),e.jsx(Ke,{className:"text-muted-foreground font-mono text-sm",children:z.base_url}),e.jsx(Ke,{children:e.jsx(ke,{variant:"outline",children:z.client_type})})]},z.name))})]})})]})}),e.jsx(ys,{value:"models",children:e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:e.jsxs(Ol,{children:[e.jsx(Dl,{children:e.jsxs(dt,{children:[e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:" (/)"})]})}),e.jsx(Rl,{children:i.models.map(z=>e.jsxs(dt,{children:[e.jsx(Ke,{className:"font-medium",children:z.name}),e.jsx(Ke,{className:"text-muted-foreground font-mono text-sm",children:z.model_identifier}),e.jsx(Ke,{children:z.api_provider}),e.jsxs(Ke,{className:"text-right text-muted-foreground",children:["",z.price_in," / ",z.price_out]})]},z.name))})]})})]})}),e.jsx(ys,{value:"tasks",children:e.jsxs(Se,{children:[e.jsxs(ze,{children:[e.jsx(Re,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Me,{children:e.jsx(n3,{type:"multiple",className:"w-full",children:Object.entries(i.task_config).map(([z,Q])=>e.jsxs(KN,{value:z,children:[e.jsx(QN,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xn,{className:"w-4 h-4"}),r3[z]||z,e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[Q.model_list.length," "]})]})}),e.jsx(YN,{children:e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.model_list.map(I=>e.jsx(ke,{variant:"outline",children:I},I))}),Q.temperature!==void 0&&e.jsxs("div",{className:"text-sm",children:["Temperature: ",e.jsx("span",{className:"font-mono",children:Q.temperature})]}),Q.max_tokens!==void 0&&e.jsxs("div",{className:"text-sm",children:["Max Tokens: ",e.jsx("span",{className:"font-mono",children:Q.max_tokens})]})]})})]},z))})})]})})]}),e.jsx(c3,{open:N,onOpenChange:v,pack:i,step:y,setStep:w,conflicts:b,detectingConflicts:A,applying:H,options:C,setOptions:M,_providerMapping:G,_setProviderMapping:D,newProviderApiKeys:ee,setNewProviderApiKeys:R,onApply:ge})]})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(la,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-xl font-semibold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""}),e.jsxs(S,{className:"mt-4",onClick:()=>n({to:"/config/pack-market"}),children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),""]})]})}function c3({open:l,onOpenChange:n,pack:i,step:c,setStep:u,conflicts:x,detectingConflicts:h,applying:f,options:p,setOptions:g,_providerMapping:N,_setProviderMapping:v,newProviderApiKeys:y,setNewProviderApiKeys:w,onApply:b}){return e.jsx(Ps,{open:l,onOpenChange:n,children:e.jsxs(Us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs($s,{children:[e.jsxs(Bs,{className:"flex items-center gap-2",children:[e.jsx(la,{className:"w-5 h-5"}),""]}),e.jsxs(Js,{children:[" ",c," / ",3,"",c===1&&"",c===2&&"",c===3&&""]})]}),h?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Ls,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"apply_providers",checked:p.apply_providers,onCheckedChange:A=>g({...p,apply_providers:A})}),e.jsxs(T,{htmlFor:"apply_providers",className:"flex items-center gap-2",children:[e.jsx(zl,{className:"w-4 h-4"})," (",i.providers.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"apply_models",checked:p.apply_models,onCheckedChange:A=>g({...p,apply_models:A})}),e.jsxs(T,{htmlFor:"apply_models",className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"w-4 h-4"})," (",i.models.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:"apply_task_config",checked:p.apply_task_config,onCheckedChange:A=>g({...p,apply_task_config:A})}),e.jsxs(T,{htmlFor:"apply_task_config",className:"flex items-center gap-2",children:[e.jsx(Fn,{className:"w-4 h-4"})," (",Object.keys(i.task_config).length," )"]})]})]}),p.apply_task_config&&e.jsxs("div",{className:"pl-6 space-y-2 border-l-2 border-muted",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs(dx,{value:p.task_mode,onValueChange:A=>g({...p,task_mode:A}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Go,{value:"append",id:"mode_append"}),e.jsx(T,{htmlFor:"mode_append",className:"font-normal",children:" - "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Go,{value:"replace",id:"mode_replace"}),e.jsx(T,{htmlFor:"mode_replace",className:"font-normal",children:" - "})]})]})]})]}),c===2&&x&&e.jsxs("div",{className:"space-y-4",children:[p.apply_providers&&x.existing_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx(Bn,{children:""}),e.jsx(nt,{children:" URL "})]}),e.jsx("div",{className:"space-y-2",children:x.existing_providers.map(({pack_provider:A,local_providers:_})=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(_t,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"font-medium flex-shrink-0",children:A.name}),e.jsx(sa,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),_.length===1?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:_[0].name}),e.jsx(ke,{variant:"outline",className:"ml-auto",children:"URL "})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{value:N[A.name]||_[0].name,onValueChange:H=>v({...N,[A.name]:H}),children:[e.jsx($e,{className:"w-[200px]",children:e.jsx(Pe,{})}),e.jsx(Be,{children:_.map(H=>e.jsx(W,{value:H.name,children:H.name},H.name))})]}),e.jsxs(ke,{variant:"outline",className:"ml-auto",children:[_.length," "]})]})]},A.name))})]}),p.apply_providers&&x.new_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(lt,{variant:"destructive",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx(Bn,{children:" API Key"}),e.jsx(nt,{children:" API Key"})]}),e.jsx("div",{className:"space-y-4",children:x.new_providers.map(A=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Km,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"font-medium",children:A.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",A.base_url,")"]})]}),e.jsx(ne,{type:"password",placeholder:` ${A.name}  API Key`,value:y[A.name]||"",onChange:_=>w({...y,[A.name]:_.target.value})})]},A.name))})]}),(!p.apply_providers||x.existing_providers.length===0&&x.new_providers.length===0)&&e.jsxs(lt,{children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(Bn,{children:""}),e.jsx(nt,{children:""})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(lt,{children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx(Bn,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-2",children:[p.apply_providers&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(_t,{className:"w-4 h-4 text-green-500"}),e.jsx(zl,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",i.providers.length," "]})]}),p.apply_models&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(_t,{className:"w-4 h-4 text-green-500"}),e.jsx(Hn,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",i.models.length," "]})]}),p.apply_task_config&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(_t,{className:"w-4 h-4 text-green-500"}),e.jsx(Fn,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.task_mode==="append"?"":""," ",Object.keys(i.task_config).length," "]})]})]}),x&&x.new_providers.length>0&&e.jsxs(lt,{variant:"destructive",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(nt,{children:[" ",x.new_providers.length,"  API Key"]})]})]})]}),e.jsxs(et,{className:"flex justify-between",children:[e.jsx("div",{children:c>1&&!h&&e.jsx(S,{variant:"outline",onClick:()=>u(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",onClick:()=>n(!1),disabled:f,children:""}),c<3?e.jsx(S,{onClick:()=>u(c+1),disabled:h,children:""}):e.jsxs(S,{onClick:b,disabled:f,children:[f&&e.jsx(Ls,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})})}function o3(){return e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Je,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(js,{className:"h-9 w-24"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(js,{className:"w-10 h-10"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(js,{className:"h-8 w-2/3"}),e.jsx(js,{className:"h-4 w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(js,{className:"h-4 w-24"}),e.jsx(js,{className:"h-4 w-32"}),e.jsx(js,{className:"h-4 w-28"}),e.jsx(js,{className:"h-4 w-20"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(js,{className:"h-6 w-20"}),e.jsx(js,{className:"h-6 w-24"}),e.jsx(js,{className:"h-6 w-16"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsx(js,{className:"h-10 w-full"}),e.jsx(js,{className:"h-10 w-full"})]})]}),e.jsx(js,{className:"h-px w-full"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(js,{className:"h-24"}),e.jsx(js,{className:"h-24"}),e.jsx(js,{className:"h-24"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(js,{className:"h-10 w-32"}),e.jsx(js,{className:"h-10 w-32"}),e.jsx(js,{className:"h-10 w-32"})]}),e.jsx(js,{className:"h-96 w-full"})]})]})})})}function d3(){const l=ia(),[n,i]=m.useState(!0);return m.useEffect(()=>{let c=!1;return(async()=>{try{const x=await tc();!c&&!x&&l({to:"/auth"})}catch{c||l({to:"/auth"})}finally{c||i(!1)}})(),()=>{c=!0}},[l]),{checking:n}}async function u3(){return await tc()}const m3=qr("pointer-events-none inline-flex select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono font-medium opacity-100",{variants:{size:{sm:"h-5 text-[10px]",default:"h-6 text-xs",lg:"h-7 text-sm"}},defaultVariants:{size:"default"}}),JN=m.forwardRef(({className:l,size:n,abbrTitle:i,children:c,...u},x)=>e.jsx("kbd",{className:P(m3({size:n,className:l})),ref:x,...u,children:i?e.jsx("abbr",{title:i,children:c}):c}));JN.displayName="Kbd";const x3=[{icon:Jo,title:"",description:"",path:"/",category:""},{icon:ka,title:"",description:"",path:"/config/bot",category:""},{icon:zl,title:"",description:"",path:"/config/modelProvider",category:""},{icon:Bj,title:"",description:"",path:"/config/model",category:""},{icon:Yo,title:"",description:"",path:"/resource/emoji",category:""},{icon:Ea,title:"",description:"",path:"/resource/expression",category:""},{icon:Ij,title:"",description:"",path:"/resource/person",category:""},{icon:Fr,title:"",description:"",path:"/resource/jargon",category:""},{icon:f_,title:"",description:"",path:"/statistics",category:""},{icon:la,title:"",description:"",path:"/plugins",category:""},{icon:Qm,title:"",description:"",path:"/logs",category:""},{icon:xn,title:"",description:"",path:"/settings",category:""}];function h3({open:l,onOpenChange:n}){const[i,c]=m.useState(""),[u,x]=m.useState(0),h=ia(),f=x3.filter(N=>N.title.toLowerCase().includes(i.toLowerCase())||N.description.toLowerCase().includes(i.toLowerCase())||N.category.toLowerCase().includes(i.toLowerCase())),p=m.useCallback(N=>{h({to:N}),n(!1),c(""),x(0)},[h,n]),g=m.useCallback(N=>{N.key==="ArrowDown"?(N.preventDefault(),x(v=>(v+1)%f.length)):N.key==="ArrowUp"?(N.preventDefault(),x(v=>(v-1+f.length)%f.length)):N.key==="Enter"&&f[u]&&(N.preventDefault(),p(f[u].path))},[f,u,p]);return e.jsx(Ps,{open:l,onOpenChange:n,children:e.jsxs(Us,{className:"max-w-2xl p-0 gap-0",children:[e.jsxs($s,{className:"px-4 pt-4 pb-0",children:[e.jsx(Bs,{className:"sr-only",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),e.jsx(ne,{value:i,onChange:N=>{c(N.target.value),x(0)},onKeyDown:g,placeholder:"...",className:"h-12 pl-11 text-base border-0 focus-visible:ring-0 shadow-none",autoFocus:!0})]})]}),e.jsx("div",{className:"border-t",children:e.jsx(Je,{className:"h-[400px]",children:f.length>0?e.jsx("div",{className:"p-2",children:f.map((N,v)=>{const y=N.icon;return e.jsxs("button",{onClick:()=>p(N.path),onMouseEnter:()=>x(v),className:P("w-full flex items-center gap-3 px-3 py-2.5 rounded-md text-left transition-colors",v===u?"bg-accent text-accent-foreground":"hover:bg-accent/50"),children:[e.jsx(y,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:N.title}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:N.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1 bg-muted rounded",children:N.category})]},N.path)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Dt,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i?"":""})]})})}),e.jsx("div",{className:"border-t px-4 py-3 flex items-center justify-between text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Enter"}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Esc"}),""]})]})})]})})}function f3(){const l=window.location.protocol==="http:",n=window.location.hostname.toLowerCase(),i=n==="localhost"||n==="127.0.0.1"||n==="::1",c=sessionStorage.getItem("http-warning-dismissed")==="true",[u,x]=m.useState(l&&!i&&!c),[h,f]=m.useState(!1),p=()=>{f(!0),x(!1),sessionStorage.setItem("http-warning-dismissed","true")};return!u||h?null:e.jsx("div",{className:"relative bg-amber-500/10 border-b border-amber-500/20 backdrop-blur-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Yt,{className:"h-5 w-5 text-amber-600 dark:text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-semibold",children:""})," ",e.jsx("strong",{children:"HTTP"}),"  MaiBot WebUI"]}),e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200 mt-1",children:" Token HTTPS "})]})]}),e.jsx(S,{variant:"ghost",size:"icon",onClick:p,className:"h-8 w-8 text-amber-700 hover:text-amber-900 dark:text-amber-400 dark:hover:text-amber-200 flex-shrink-0","aria-label":"",children:e.jsx(Ma,{className:"h-4 w-4"})})]})})})}function p3(){const[l,n]=m.useState(0),[i,c]=m.useState(!1),u=m.useRef(null);m.useEffect(()=>{const g=N=>{const v=N.target;if(v.scrollHeight>v.clientHeight+100){u.current=v;const y=v.scrollTop,w=v.scrollHeight-v.clientHeight,b=w>0?y/w*100:0;n(b),c(y>300)}};return window.addEventListener("scroll",g,{capture:!0,passive:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})},[]);const x=()=>{u.current?.scrollTo({top:0,behavior:"smooth"})},h=18,f=2*Math.PI*h,p=f-l/100*f;return e.jsx("div",{className:P("fixed bottom-24 right-8 z-50 transition-all duration-500 ease-in-out transform",i?"translate-x-0 opacity-100":"translate-x-32 opacity-0 pointer-events-none"),children:e.jsxs(S,{variant:"outline",size:"icon",className:P("relative h-12 w-12 rounded-full shadow-xl","bg-background/80 backdrop-blur-md border-border/50","hover:bg-accent hover:scale-110 hover:shadow-2xl hover:border-primary/50","transition-all duration-300","group"),onClick:x,"aria-label":"",children:[e.jsxs("svg",{className:"absolute inset-0 h-full w-full -rotate-90 transform p-1",viewBox:"0 0 44 44",children:[e.jsx("circle",{className:"text-muted-foreground/10",strokeWidth:"3",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"}),e.jsx("circle",{className:"text-primary transition-all duration-100 ease-out",strokeWidth:"3",strokeDasharray:f,strokeDashoffset:p,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"})]}),e.jsx(p_,{className:"h-5 w-5 text-primary transition-transform duration-300 group-hover:-translate-y-1 group-hover:scale-110",strokeWidth:2.5}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})})}const g3=Lw,j3=Uw,v3=$w,XN=m.forwardRef(({className:l,sideOffset:n=4,...i},c)=>e.jsx(Rw,{children:e.jsx(yj,{ref:c,sideOffset:n,className:P("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",l),...i})}));XN.displayName=yj.displayName;function N3({children:l}){const{checking:n}=d3(),[i,c]=m.useState(!0),[u,x]=m.useState(!1),[h,f]=m.useState(!1),{theme:p,setTheme:g}=Zm(),N=j0();if(m.useEffect(()=>{const O=A=>{(A.metaKey||A.ctrlKey)&&A.key==="k"&&(A.preventDefault(),f(!0))};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[]),n)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-background",children:e.jsx("div",{className:"text-muted-foreground",children:"..."})});const v=[{title:"",items:[{icon:Jo,label:"",path:"/"}]},{title:"",items:[{icon:ka,label:"",path:"/config/bot"},{icon:zl,label:"AI",path:"/config/modelProvider",tourId:"sidebar-model-provider"},{icon:Bj,label:"",path:"/config/model",tourId:"sidebar-model-management"},{icon:ig,label:"",path:"/config/adapter"}]},{title:"",items:[{icon:Yo,label:"",path:"/resource/emoji"},{icon:Ea,label:"",path:"/resource/expression"},{icon:Fr,label:"",path:"/resource/jargon"},{icon:Ij,label:"",path:"/resource/person"},{icon:Rj,label:"",path:"/resource/knowledge-graph"},{icon:Pr,label:"",path:"/resource/knowledge-base"}]},{title:"",items:[{icon:la,label:"",path:"/plugins"},{icon:Uj,label:"",path:"/config/pack-market"},{icon:ig,label:"",path:"/plugin-config"},{icon:Qm,label:"",path:"/logs"},{icon:Gm,label:"&",path:"/planner-monitor"},{icon:Ea,label:"",path:"/chat"}]},{title:"",items:[{icon:xn,label:"",path:"/settings"}]}],w=p==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":p,b=async()=>{await Z_()};return e.jsx(g3,{delayDuration:300,children:e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsxs("aside",{className:P("fixed inset-y-0 left-0 z-50 flex flex-col border-r bg-card transition-all duration-300 lg:relative lg:z-0","w-64 lg:w-auto",i?"lg:w-64":"lg:w-16",u?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsx("div",{className:"flex h-16 items-center border-b px-4",children:e.jsxs("div",{className:P("relative flex items-center justify-center flex-1 transition-all overflow-hidden","lg:flex-1",!i&&"lg:flex-none lg:w-8"),children:[e.jsxs("div",{className:P("flex items-baseline gap-2",!i&&"lg:hidden"),children:[e.jsx("span",{className:"font-bold text-xl text-primary-gradient whitespace-nowrap",children:"MaiBot WebUI"}),e.jsx("span",{className:"text-xs text-primary/60 whitespace-nowrap",children:y2()})]}),!i&&e.jsx("span",{className:"hidden lg:block font-bold text-primary-gradient text-2xl",children:"M"})]})}),e.jsx(Je,{className:P("flex-1 overflow-x-hidden",!i&&"lg:w-16"),children:e.jsx("nav",{className:P("p-4",!i&&"lg:p-2 lg:w-16"),children:e.jsx("ul",{className:P("space-y-6",!i&&"lg:space-y-3 lg:w-full"),children:v.map((O,A)=>e.jsxs("li",{children:[e.jsx("div",{className:P("px-3 h-[1.25rem]","mb-2",!i&&"lg:mb-1 lg:invisible"),children:e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground/60 whitespace-nowrap",children:O.title})}),!i&&A>0&&e.jsx("div",{className:"hidden lg:block mb-2 border-t border-border"}),e.jsx("ul",{className:"space-y-1",children:O.items.map(_=>{const H=N({to:_.path}),E=_.icon,C=e.jsxs(e.Fragment,{children:[H&&e.jsx("div",{className:"absolute left-0 top-1/2 h-8 w-1 -translate-y-1/2 rounded-r-full bg-primary transition-opacity duration-300"}),e.jsxs("div",{className:P("flex items-center transition-all duration-300",i?"gap-3":"gap-3 lg:gap-0"),children:[e.jsx(E,{className:P("h-5 w-5 flex-shrink-0",H&&"text-primary"),strokeWidth:2,fill:"none"}),e.jsx("span",{className:P("text-sm font-medium whitespace-nowrap transition-all duration-300",H&&"font-semibold",i?"opacity-100 max-w-[200px]":"opacity-100 max-w-[200px] lg:opacity-0 lg:max-w-0 lg:overflow-hidden"),children:_.label})]})]});return e.jsx("li",{className:"relative",children:e.jsxs(j3,{children:[e.jsx(v3,{asChild:!0,children:e.jsx(Un,{to:_.path,"data-tour":_.tourId,className:P("relative flex items-center rounded-lg py-2 transition-all duration-300","hover:bg-accent hover:text-accent-foreground",H?"bg-accent text-foreground":"text-muted-foreground hover:text-foreground",i?"px-3":"px-3 lg:px-0 lg:justify-center lg:w-12 lg:mx-auto"),onClick:()=>x(!1),children:C})}),!i&&e.jsx(XN,{side:"right",className:"hidden lg:block",children:e.jsx("p",{children:_.label})})]})},_.path)})})]},O.title))})})})]}),u&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>x(!1)}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(f3,{}),e.jsxs("header",{className:"flex h-16 items-center justify-between border-b bg-card/80 backdrop-blur-md px-4 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>x(!u),className:"rounded-lg p-2 hover:bg-accent lg:hidden",children:e.jsx(g_,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>c(!i),className:"hidden rounded-lg p-2 hover:bg-accent lg:block",title:i?"":"",children:e.jsx(Va,{className:P("h-5 w-5 transition-transform",!i&&"rotate-180")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Un,{to:"/annual-report",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"gap-2 bg-gradient-to-r from-pink-500/10 to-purple-500/10 hover:from-pink-500/20 hover:to-purple-500/20 border border-pink-500/20",title:"",children:[e.jsx(j_,{className:"h-4 w-4 text-pink-500"}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent font-medium",children:"2025 "})]})}),e.jsxs("button",{onClick:()=>f(!0),className:"relative hidden md:flex items-center w-64 h-9 pl-9 pr-16 bg-background/50 border rounded-md hover:bg-accent/50 transition-colors text-left",children:[e.jsx(Dt,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"..."}),e.jsxs(JN,{size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2",children:[e.jsx("span",{className:"text-xs",children:""}),"K"]})]}),e.jsx(h3,{open:h,onOpenChange:f}),e.jsxs(S,{variant:"ghost",size:"sm",onClick:()=>window.open("https://docs.mai-mai.org","_blank"),className:"gap-2",title:"",children:[e.jsx(v_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx("button",{onClick:O=>{x2(w==="dark"?"light":"dark",g,O)},className:"rounded-lg p-2 hover:bg-accent",title:w==="dark"?"":"",children:w==="dark"?e.jsx(qm,{className:"h-5 w-5"}):e.jsx(Ki,{className:"h-5 w-5"})}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs(S,{variant:"ghost",size:"sm",onClick:b,className:"gap-2",title:"",children:[e.jsx(N_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden bg-background",children:l}),e.jsx(p3,{})]})]})})}function b3(l){const n=l.split(`
`).slice(1),i=[];for(const c of n){const u=c.trim();if(!u.startsWith("at "))continue;const x=u.match(/at\s+(?:(.+?)\s+\()?(.+?):(\d+):(\d+)\)?$/);x?i.push({functionName:x[1]||"<anonymous>",fileName:x[2],lineNumber:x[3],columnNumber:x[4],raw:u}):i.push({functionName:"<unknown>",fileName:"",lineNumber:"",columnNumber:"",raw:u})}return i}function y3({error:l,errorInfo:n}){const[i,c]=m.useState(!0),[u,x]=m.useState(!1),[h,f]=m.useState(!1),p=l.stack?b3(l.stack):[],g=async()=>{const N=`
Error: ${l.name}
Message: ${l.message}

Stack Trace:
${l.stack||"No stack trace available"}

Component Stack:
${n?.componentStack||"No component stack available"}

URL: ${window.location.href}
User Agent: ${navigator.userAgent}
Time: ${new Date().toISOString()}
    `.trim();try{await navigator.clipboard.writeText(N),f(!0),setTimeout(()=>f(!1),2e3)}catch(v){console.error("Failed to copy:",v)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(lt,{variant:"destructive",className:"border-red-500/50 bg-red-500/10",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsxs(nt,{className:"font-mono text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[l.name,":"]})," ",l.message]})]}),p.length>0&&e.jsxs(nc,{open:i,onOpenChange:c,children:[e.jsx(rc,{asChild:!0,children:e.jsxs(S,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(b_,{className:"h-4 w-4"}),"Stack Trace (",p.length," frames)"]}),i?e.jsx(Hr,{className:"h-4 w-4"}):e.jsx(Aa,{className:"h-4 w-4"})]})}),e.jsx(ic,{children:e.jsx(Je,{className:"h-[280px] rounded-md border bg-muted/30",children:e.jsx("div",{className:"p-3 space-y-1",children:p.map((N,v)=>e.jsx("div",{className:"font-mono text-xs p-2 rounded hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"text-muted-foreground w-6 text-right flex-shrink-0",children:[v+1,"."]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-primary font-medium",children:N.functionName}),N.fileName&&e.jsxs("div",{className:"text-muted-foreground mt-0.5 break-all",children:[N.fileName,N.lineNumber&&e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:[":",N.lineNumber,":",N.columnNumber]})]})]})]})},v))})})})]}),n?.componentStack&&e.jsxs(nc,{open:u,onOpenChange:x,children:[e.jsx(rc,{asChild:!0,children:e.jsxs(S,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),"Component Stack"]}),u?e.jsx(Hr,{className:"h-4 w-4"}):e.jsx(Aa,{className:"h-4 w-4"})]})}),e.jsx(ic,{children:e.jsx(Je,{className:"h-[200px] rounded-md border bg-muted/30",children:e.jsx("pre",{className:"p-3 font-mono text-xs whitespace-pre-wrap text-muted-foreground",children:n.componentStack})})})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:g,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(_t,{className:"mr-2 h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Ro,{className:"mr-2 h-4 w-4"}),""]})})]})}function ZN({error:l,errorInfo:n}){const i=()=>{window.location.href="/"},c=()=>{window.location.reload()};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(Se,{className:"w-full max-w-2xl shadow-lg",children:[e.jsxs(ze,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:e.jsx(Yt,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsx(Re,{className:"text-2xl font-bold",children:""}),e.jsx(ws,{className:"text-base mt-2",children:""})]}),e.jsxs(Me,{className:"space-y-4",children:[e.jsx(y3,{error:l,errorInfo:n}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[e.jsxs(S,{onClick:c,className:"flex-1",children:[e.jsx(ft,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(S,{onClick:i,variant:"outline",className:"flex-1",children:[e.jsx(Jo,{className:"mr-2 h-4 w-4"}),""]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground pt-2",children:""})]})]})})}class w3 extends m.Component{constructor(n){super(n),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,i){console.error("ErrorBoundary caught an error:",n,i),this.setState({errorInfo:i})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError&&this.state.error?this.props.fallback?this.props.fallback:e.jsx(ZN,{error:this.state.error,errorInfo:this.state.errorInfo}):this.props.children}}function WN({error:l}){return e.jsx(ZN,{error:l,errorInfo:null})}const mc=v0({component:()=>e.jsxs(e.Fragment,{children:[e.jsx(Lg,{}),!1]}),beforeLoad:()=>{if(window.location.pathname==="/"&&!u3())throw b0({to:"/auth"})}}),_3=qs({getParentRoute:()=>mc,path:"/auth",component:B2}),S3=qs({getParentRoute:()=>mc,path:"/setup",component:s1}),rt=qs({getParentRoute:()=>mc,id:"protected",component:()=>e.jsx(N3,{children:e.jsx(Lg,{})}),errorComponent:({error:l})=>e.jsx(WN,{error:l})}),k3=qs({getParentRoute:()=>rt,path:"/",component:o2}),C3=qs({getParentRoute:()=>rt,path:"/config/bot",component:R1}),T3=qs({getParentRoute:()=>rt,path:"/config/modelProvider",component:K1}),E3=qs({getParentRoute:()=>rt,path:"/config/model",component:jS}),M3=qs({getParentRoute:()=>rt,path:"/config/adapter",component:IS}),A3=qs({getParentRoute:()=>rt,path:"/resource/emoji",component:o4}),z3=qs({getParentRoute:()=>rt,path:"/resource/expression",component:N4}),O3=qs({getParentRoute:()=>rt,path:"/resource/person",component:G4}),D3=qs({getParentRoute:()=>rt,path:"/resource/jargon",component:D4}),R3=qs({getParentRoute:()=>rt,path:"/resource/knowledge-graph",component:W4}),L3=qs({getParentRoute:()=>rt,path:"/resource/knowledge-base",component:ek}),U3=qs({getParentRoute:()=>rt,path:"/logs",component:tk}),$3=qs({getParentRoute:()=>rt,path:"/planner-monitor",component:uk}),B3=qs({getParentRoute:()=>rt,path:"/chat",component:Jk}),I3=qs({getParentRoute:()=>rt,path:"/plugins",component:Ak}),P3=qs({getParentRoute:()=>rt,path:"/plugin-detail",component:Pk}),H3=qs({getParentRoute:()=>rt,path:"/model-presets",component:Ok}),F3=qs({getParentRoute:()=>rt,path:"/plugin-config",component:Lk}),G3=qs({getParentRoute:()=>rt,path:"/plugin-mirrors",component:$k}),V3=qs({getParentRoute:()=>rt,path:"/settings",component:z2}),q3=qs({getParentRoute:()=>rt,path:"/config/pack-market",component:VC}),eb=qs({getParentRoute:()=>rt,path:"/config/pack-market/$packId",component:i3}),K3=qs({getParentRoute:()=>rt,path:"/survey/webui-feedback",component:mC}),Q3=qs({getParentRoute:()=>rt,path:"/survey/maibot-feedback",component:xC}),Y3=qs({getParentRoute:()=>rt,path:"/annual-report",component:fC}),J3=qs({getParentRoute:()=>mc,path:"*",component:ov}),X3=mc.addChildren([_3,S3,rt.addChildren([k3,C3,T3,E3,M3,A3,z3,D3,O3,R3,L3,I3,P3,H3,F3,G3,U3,$3,B3,V3,q3,eb,K3,Q3,Y3]),J3]),Z3=N0({routeTree:X3,defaultNotFoundComponent:ov,defaultErrorComponent:({error:l})=>e.jsx(WN,{error:l})});function W3({children:l,defaultTheme:n="system",storageKey:i="ui-theme",...c}){const[u,x]=m.useState(()=>localStorage.getItem(i)||n);m.useEffect(()=>{const f=window.document.documentElement;if(f.classList.remove("light","dark"),u==="system"){const p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";f.classList.add(p);return}f.classList.add(u)},[u]),m.useEffect(()=>{const f=localStorage.getItem("accent-color");if(f){const p=document.documentElement,N={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[f];N&&(p.style.setProperty("--primary",N.hsl),N.gradient?(p.style.setProperty("--primary-gradient",N.gradient),p.classList.add("has-gradient")):(p.style.removeProperty("--primary-gradient"),p.classList.remove("has-gradient")))}},[]);const h={theme:u,setTheme:f=>{localStorage.setItem(i,f),x(f)}};return e.jsx(av.Provider,{...c,value:h,children:l})}function e5({children:l,defaultEnabled:n=!0,defaultWavesEnabled:i=!0,storageKey:c="enable-animations",wavesStorageKey:u="enable-waves-background"}){const[x,h]=m.useState(()=>{const N=localStorage.getItem(c);return N!==null?N==="true":n}),[f,p]=m.useState(()=>{const N=localStorage.getItem(u);return N!==null?N==="true":i});m.useEffect(()=>{const N=document.documentElement;x?N.classList.remove("no-animations"):N.classList.add("no-animations"),localStorage.setItem(c,String(x))},[x,c]),m.useEffect(()=>{localStorage.setItem(u,String(f))},[f,u]);const g={enableAnimations:x,setEnableAnimations:h,enableWavesBackground:f,setEnableWavesBackground:p};return e.jsx(lv.Provider,{value:g,children:l})}const s5=Bw,sb=m.forwardRef(({className:l,...n},i)=>e.jsx(wj,{ref:i,className:P("fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:max-w-[420px] gap-2",l),...n}));sb.displayName=wj.displayName;const t5=qr("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-slide-in-from-right data-[state=open]:animate-fade-in data-[state=closed]:animate-slide-out-to-right data-[state=closed]:animate-fade-out data-[swipe=end]:animate-slide-out-to-right",{variants:{variant:{default:"border bg-primary/5 text-foreground backdrop-blur-sm",destructive:"destructive group border-destructive bg-destructive/10 text-destructive-foreground backdrop-blur-sm"}},defaultVariants:{variant:"default"}}),tb=m.forwardRef(({className:l,variant:n,...i},c)=>e.jsx(_j,{ref:c,className:P(t5({variant:n}),l),...i}));tb.displayName=_j.displayName;const a5=m.forwardRef(({className:l,...n},i)=>e.jsx(Sj,{ref:i,className:P("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",l),...n}));a5.displayName=Sj.displayName;const ab=m.forwardRef(({className:l,...n},i)=>e.jsx(kj,{ref:i,className:P("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",l),"toast-close":"",...n,children:e.jsx(Ma,{className:"h-4 w-4"})}));ab.displayName=kj.displayName;const lb=m.forwardRef(({className:l,...n},i)=>e.jsx(Cj,{ref:i,className:P("text-sm font-semibold [&+div]:text-xs",l),...n}));lb.displayName=Cj.displayName;const nb=m.forwardRef(({className:l,...n},i)=>e.jsx(Tj,{ref:i,className:P("text-sm opacity-90",l),...n}));nb.displayName=Tj.displayName;function l5(){const{toasts:l}=st();return e.jsxs(s5,{children:[l.map(function({id:n,title:i,description:c,action:u,...x}){return e.jsxs(tb,{...x,children:[e.jsxs("div",{className:"grid gap-1",children:[i&&e.jsx(lb,{children:i}),c&&e.jsx(nb,{children:c})]}),u,e.jsx(ab,{})]},n)}),e.jsx(sb,{})]})}X_.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(w3,{children:e.jsx(W3,{defaultTheme:"system",children:e.jsx(e5,{children:e.jsxs(P1,{children:[e.jsx(y0,{router:Z3}),e.jsx(G1,{}),e.jsx(l5,{})]})})})})}));
