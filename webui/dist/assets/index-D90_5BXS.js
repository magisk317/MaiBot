import{r as u,j as e,L as Vn,e as xa,R as Hs,b as X0,f as Z0,g as W0,h as ew,k as sw,l as rt,m as tw,n as aw,O as cj,o as lw}from"./router-9vIXuQkh.js";import{a as nw,b as rw,g as iw}from"./react-vendor-BmxF9s7Q.js";import{N as cw,c as ow,O as ei,P as dw,g as Tm}from"./utils-BqoaXoQ1.js";import{L as oj,T as dj,C as uj,R as uw,a as mj,V as mw,b as xw,S as xj,c as hw,d as hj,I as fw,e as fj,f as pw,g as pj,h as gw,i as jw,j as vw,O as gj,P as Nw,k as jj,l as vj,D as Nj,A as bj,m as yj,n as bw,o as yw,p as wj,q as ww,r as _j,s as _w,t as Sw,u as Sj,v as kw,w as Cw,x as kj,y as Cj,F as Tj,z as Ej,B as Tw,E as Ew,G as Mj,H as Mw,J as Aw,K as zw,M as Rw,N as Dw,Q as Ow,U as Lw,W as Uw,X as $w,Y as Bw,Z as Iw,_ as Pw,$ as Fw,a0 as Hw,a1 as qw,a2 as Aj,a3 as Vw,a4 as Gw}from"./radix-extra-DmmnfeQE.js";import{R as zj,T as Rj,L as Kw,g as Qw,C as Qi,X as Yi,Y as qr,h as Yw,B as Uo,j as Ji,P as Jw,k as Xw,l as Zw}from"./charts-simvewUa.js";import{S as Ww,O as Dj,o as e1,C as Oj,p as s1,T as Lj,D as Uj,R as t1,q as a1,H as $j,I as l1,J as Bj,K as n1,L as Ij,M as Pj,N as r1,Q as Fj,V as i1,U as Hj,X as qj,Y as c1,Z as o1,_ as Vj,$ as d1,a0 as u1,a1 as Gj,e as Kj,f as sd,c as td,P as sr,d as ad,b as Nn,h as m1,l as x1,m as h1,u as Qm,r as f1,a as p1,a2 as g1,a3 as Qj,a4 as j1,a5 as v1,a6 as N1,a7 as Yj,a8 as Jj,a9 as Xj,aa as Zj,ab as Wj,ac as ev,ad as b1}from"./radix-core-DyJi0yyw.js";import{R as ut,a as lc,C as Rt,b as tt,L as Fs,X as _a,c as Lt,d as $a,e as Yr,f as Ia,g as ra,E as y1,h as sv,Z as el,i as ia,j as ta,S as Ut,B as tv,U as $l,k as Kn,P as hc,l as av,F as La,m as w1,n as bn,o as _1,M as Ba,A as ax,D as S1,p as Jr,T as lx,q as k1,r as lv,I as Qt,s as qt,t as Fo,u as nc,v as ma,H as C1,w as us,x as na,y as rc,z as nx,G as ec,J as _g,K as rx,N as nv,O as T1,Q as $o,V as E1,W as ld,Y as M1,_ as A1,$ as nd,a0 as Ua,a1 as at,a2 as ix,a3 as rv,a4 as fc,a5 as iv,a6 as cv,a7 as Jn,a8 as yn,a9 as wn,aa as cx,ab as ov,ac as ua,ad as Bl,ae as Xn,af as Zn,ag as rd,ah as z1,ai as R1,aj as D1,ak as ox,al as Bo,am as Wn,an as Xr,ao as Ho,ap as O1,aq as qo,ar as ic,as as dv,at as L1,au as U1,av as Vo,aw as $1,ax as dx,ay as Sg,az as B1,aA as I1,aB as uv,aC as P1,aD as fn,aE as mv,aF as Em,aG as kg,aH as F1,aI as Mm,aJ as H1,aK as q1,aL as V1,aM as G1,aN as xv,aO as K1,aP as Zr,aQ as Q1,aR as Y1,aS as hv,aT as fv,aU as J1,aV as X1,aW as Cg,aX as Z1,aY as W1,aZ as e_,a_ as s_,a$ as t_}from"./icons-CmIU8FzD.js";import{S as a_,p as l_,j as n_,a as r_,E as Am,R as i_,o as c_}from"./codemirror-TZqPU532.js";import{u as pv,a as Go,s as gv,K as jv,P as vv,b as Nv,D as bv,c as yv,S as wv,v as o_,d as _v,C as Sv,h as d_}from"./dnd-BiPfFtVp.js";import{_ as Sa,c as u_,g as kv,D as m_,z as Ro}from"./misc-CJqnlRwD.js";import{D as x_,U as h_}from"./uppy-DFP_VzYR.js";import{M as f_,r as p_,a as g_,b as j_}from"./markdown-CKA5gBQ9.js";import{c as v_,H as Ko,P as Qo,u as N_,d as b_,R as y_,B as w_,e as __,C as S_,M as k_,f as C_}from"./reactflow-DtsZHOR4.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const h of m.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function r(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function c(d){if(d.ep)return;d.ep=!0;const m=r(d);fetch(d.href,m)}})();var zm={exports:{}},Vi={},Rm={exports:{}},Dm={};var Tg;function T_(){return Tg||(Tg=1,(function(a){function l(D,K){var B=D.length;D.push(K);e:for(;0<B;){var ue=B-1>>>1,Q=D[ue];if(0<d(Q,K))D[ue]=K,D[B]=Q,B=ue;else break e}}function r(D){return D.length===0?null:D[0]}function c(D){if(D.length===0)return null;var K=D[0],B=D.pop();if(B!==K){D[0]=B;e:for(var ue=0,Q=D.length,_e=Q>>>1;ue<_e;){var he=2*(ue+1)-1,Te=D[he],V=he+1,$=D[V];if(0>d(Te,B))V<Q&&0>d($,Te)?(D[ue]=$,D[V]=B,ue=V):(D[ue]=Te,D[he]=B,ue=he);else if(V<Q&&0>d($,B))D[ue]=$,D[V]=B,ue=V;else break e}}return K}function d(D,K){var B=D.sortIndex-K.sortIndex;return B!==0?B:D.id-K.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;a.unstable_now=function(){return m.now()}}else{var h=Date,f=h.now();a.unstable_now=function(){return h.now()-f}}var p=[],g=[],N=1,j=null,y=3,b=!1,w=!1,A=!1,M=!1,S=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function C(D){for(var K=r(g);K!==null;){if(K.callback===null)c(g);else if(K.startTime<=D)c(g),K.sortIndex=K.expirationTime,l(p,K);else break;K=r(g)}}function R(D){if(A=!1,C(D),!w)if(r(p)!==null)w=!0,H||(H=!0,je());else{var K=r(g);K!==null&&pe(R,K.startTime-D)}}var H=!1,O=-1,X=5,L=-1;function me(){return M?!0:!(a.unstable_now()-L<X)}function Ne(){if(M=!1,H){var D=a.unstable_now();L=D;var K=!0;try{e:{w=!1,A&&(A=!1,P(O),O=-1),b=!0;var B=y;try{s:{for(C(D),j=r(p);j!==null&&!(j.expirationTime>D&&me());){var ue=j.callback;if(typeof ue=="function"){j.callback=null,y=j.priorityLevel;var Q=ue(j.expirationTime<=D);if(D=a.unstable_now(),typeof Q=="function"){j.callback=Q,C(D),K=!0;break s}j===r(p)&&c(p),C(D)}else c(p);j=r(p)}if(j!==null)K=!0;else{var _e=r(g);_e!==null&&pe(R,_e.startTime-D),K=!1}}break e}finally{j=null,y=B,b=!1}K=void 0}}finally{K?je():H=!1}}}var je;if(typeof E=="function")je=function(){E(Ne)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ge=ce.port2;ce.port1.onmessage=Ne,je=function(){ge.postMessage(null)}}else je=function(){S(Ne,0)};function pe(D,K){O=S(function(){D(a.unstable_now())},K)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(D){D.callback=null},a.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<D?Math.floor(1e3/D):5},a.unstable_getCurrentPriorityLevel=function(){return y},a.unstable_next=function(D){switch(y){case 1:case 2:case 3:var K=3;break;default:K=y}var B=y;y=K;try{return D()}finally{y=B}},a.unstable_requestPaint=function(){M=!0},a.unstable_runWithPriority=function(D,K){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var B=y;y=D;try{return K()}finally{y=B}},a.unstable_scheduleCallback=function(D,K,B){var ue=a.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?ue+B:ue):B=ue,D){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=B+Q,D={id:N++,callback:K,priorityLevel:D,startTime:B,expirationTime:Q,sortIndex:-1},B>ue?(D.sortIndex=B,l(g,D),r(p)===null&&D===r(g)&&(A?(P(O),O=-1):A=!0,pe(R,B-ue))):(D.sortIndex=Q,l(p,D),w||b||(w=!0,H||(H=!0,je()))),D},a.unstable_shouldYield=me,a.unstable_wrapCallback=function(D){var K=y;return function(){var B=y;y=K;try{return D.apply(this,arguments)}finally{y=B}}}})(Dm)),Dm}var Eg;function E_(){return Eg||(Eg=1,Rm.exports=T_()),Rm.exports}var Mg;function M_(){if(Mg)return Vi;Mg=1;var a=E_(),l=nw(),r=rw();function c(s){var t="https://react.dev/errors/"+s;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+s+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function m(s){var t=s,n=s;if(s.alternate)for(;t.return;)t=t.return;else{s=t;do t=s,(t.flags&4098)!==0&&(n=t.return),s=t.return;while(s)}return t.tag===3?n:null}function h(s){if(s.tag===13){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function f(s){if(s.tag===31){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function p(s){if(m(s)!==s)throw Error(c(188))}function g(s){var t=s.alternate;if(!t){if(t=m(s),t===null)throw Error(c(188));return t!==s?null:s}for(var n=s,i=t;;){var o=n.return;if(o===null)break;var x=o.alternate;if(x===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===x.child){for(x=o.child;x;){if(x===n)return p(o),s;if(x===i)return p(o),t;x=x.sibling}throw Error(c(188))}if(n.return!==i.return)n=o,i=x;else{for(var v=!1,k=o.child;k;){if(k===n){v=!0,n=o,i=x;break}if(k===i){v=!0,i=o,n=x;break}k=k.sibling}if(!v){for(k=x.child;k;){if(k===n){v=!0,n=x,i=o;break}if(k===i){v=!0,i=x,n=o;break}k=k.sibling}if(!v)throw Error(c(189))}}if(n.alternate!==i)throw Error(c(190))}if(n.tag!==3)throw Error(c(188));return n.stateNode.current===n?s:t}function N(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s;for(s=s.child;s!==null;){if(t=N(s),t!==null)return t;s=s.sibling}return null}var j=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),P=Symbol.for("react.consumer"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),me=Symbol.for("react.memo_cache_sentinel"),Ne=Symbol.iterator;function je(s){return s===null||typeof s!="object"?null:(s=Ne&&s[Ne]||s["@@iterator"],typeof s=="function"?s:null)}var ce=Symbol.for("react.client.reference");function ge(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ce?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case S:return"Profiler";case M:return"StrictMode";case R:return"Suspense";case H:return"SuspenseList";case L:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case E:return s.displayName||"Context";case P:return(s._context.displayName||"Context")+".Consumer";case C:var t=s.render;return s=s.displayName,s||(s=t.displayName||t.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return t=s.displayName||null,t!==null?t:ge(s.type)||"Memo";case X:t=s._payload,s=s._init;try{return ge(s(t))}catch{}}return null}var pe=Array.isArray,D=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},ue=[],Q=-1;function _e(s){return{current:s}}function he(s){0>Q||(s.current=ue[Q],ue[Q]=null,Q--)}function Te(s,t){Q++,ue[Q]=s.current,s.current=t}var V=_e(null),$=_e(null),z=_e(null),G=_e(null);function Re(s,t){switch(Te(z,t),Te($,s),Te(V,null),t.nodeType){case 9:case 11:s=(s=t.documentElement)&&(s=s.namespaceURI)?Kp(s):0;break;default:if(s=t.tagName,t=t.namespaceURI)t=Kp(t),s=Qp(t,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(V),Te(V,s)}function se(){he(V),he($),he(z)}function Oe(s){s.memoizedState!==null&&Te(G,s);var t=V.current,n=Qp(t,s.type);t!==n&&(Te($,s),Te(V,n))}function ns(s){$.current===s&&(he(V),he($)),G.current===s&&(he(G),Pi._currentValue=B)}var J,Z;function Le(s){if(J===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);J=t&&t[1]||"",Z=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+J+s+Z}var ae=!1;function Ee(s,t){if(!s||ae)return"";ae=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(xe){var oe=xe}Reflect.construct(s,[],we)}else{try{we.call()}catch(xe){oe=xe}s.call(we.prototype)}}else{try{throw Error()}catch(xe){oe=xe}(we=s())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(xe){if(xe&&oe&&typeof xe.stack=="string")return[xe.stack,oe.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=i.DetermineComponentFrameRoot(),v=x[0],k=x[1];if(v&&k){var I=v.split(`
`),ie=k.split(`
`);for(o=i=0;i<I.length&&!I[i].includes("DetermineComponentFrameRoot");)i++;for(;o<ie.length&&!ie[o].includes("DetermineComponentFrameRoot");)o++;if(i===I.length||o===ie.length)for(i=I.length-1,o=ie.length-1;1<=i&&0<=o&&I[i]!==ie[o];)o--;for(;1<=i&&0<=o;i--,o--)if(I[i]!==ie[o]){if(i!==1||o!==1)do if(i--,o--,0>o||I[i]!==ie[o]){var ve=`
`+I[i].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=i&&0<=o);break}}}finally{ae=!1,Error.prepareStackTrace=n}return(n=s?s.displayName||s.name:"")?Le(n):""}function de(s,t){switch(s.tag){case 26:case 27:case 5:return Le(s.type);case 16:return Le("Lazy");case 13:return s.child!==t&&t!==null?Le("Suspense Fallback"):Le("Suspense");case 19:return Le("SuspenseList");case 0:case 15:return Ee(s.type,!1);case 11:return Ee(s.type.render,!1);case 1:return Ee(s.type,!0);case 31:return Le("Activity");default:return""}}function ze(s){try{var t="",n=null;do t+=de(s,n),n=s,s=s.return;while(s);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var ws=Object.prototype.hasOwnProperty,Zs=a.unstable_scheduleCallback,St=a.unstable_cancelCallback,fa=a.unstable_shouldYield,xs=a.unstable_requestPaint,Is=a.unstable_now,Y=a.unstable_getCurrentPriorityLevel,qe=a.unstable_ImmediatePriority,Ke=a.unstable_UserBlockingPriority,Ze=a.unstable_NormalPriority,Ts=a.unstable_LowPriority,He=a.unstable_IdlePriority,zs=a.log,Ls=a.unstable_setDisableYieldValue,Ks=null,cs=null;function ts(s){if(typeof zs=="function"&&Ls(s),cs&&typeof cs.setStrictMode=="function")try{cs.setStrictMode(Ks,s)}catch{}}var _s=Math.clz32?Math.clz32:os,$e=Math.log,ms=Math.LN2;function os(s){return s>>>=0,s===0?32:31-($e(s)/ms|0)|0}var rs=256,ht=262144,Tt=4194304;function ca(s){var t=s&42;if(t!==0)return t;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ka(s,t,n){var i=s.pendingLanes;if(i===0)return 0;var o=0,x=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var k=i&134217727;return k!==0?(i=k&~x,i!==0?o=ca(i):(v&=k,v!==0?o=ca(v):n||(n=k&~s,n!==0&&(o=ca(n))))):(k=i&~x,k!==0?o=ca(k):v!==0?o=ca(v):n||(n=i&~s,n!==0&&(o=ca(n)))),o===0?0:t!==0&&t!==o&&(t&x)===0&&(x=o&-o,n=t&-t,x>=n||x===32&&(n&4194048)!==0)?t:o}function Pa(s,t){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&t)===0}function Jt(s,t){switch(s){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function te(){var s=Tt;return Tt<<=1,(Tt&62914560)===0&&(Tt=4194304),s}function ye(s){for(var t=[],n=0;31>n;n++)t.push(s);return t}function U(s,t){s.pendingLanes|=t,t!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Me(s,t,n,i,o,x){var v=s.pendingLanes;s.pendingLanes=n,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=n,s.entangledLanes&=n,s.errorRecoveryDisabledLanes&=n,s.shellSuspendCounter=0;var k=s.entanglements,I=s.expirationTimes,ie=s.hiddenUpdates;for(n=v&~n;0<n;){var ve=31-_s(n),we=1<<ve;k[ve]=0,I[ve]=-1;var oe=ie[ve];if(oe!==null)for(ie[ve]=null,ve=0;ve<oe.length;ve++){var xe=oe[ve];xe!==null&&(xe.lane&=-536870913)}n&=~we}i!==0&&Xe(s,i,0),x!==0&&o===0&&s.tag!==0&&(s.suspendedLanes|=x&~(v&~t))}function Xe(s,t,n){s.pendingLanes|=t,s.suspendedLanes&=~t;var i=31-_s(t);s.entangledLanes|=t,s.entanglements[i]=s.entanglements[i]|1073741824|n&261930}function ds(s,t){var n=s.entangledLanes|=t;for(s=s.entanglements;n;){var i=31-_s(n),o=1<<i;o&t|s[i]&t&&(s[i]|=t),n&=~o}}function is(s,t){var n=t&-t;return n=(n&42)!==0?1:kt(n),(n&(s.suspendedLanes|t))!==0?0:n}function kt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ps(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function le(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:gg(s.type))}function fe(s,t){var n=K.p;try{return K.p=s,t()}finally{K.p=n}}var es=Math.random().toString(36).slice(2),Ss="__reactFiber$"+es,hs="__reactProps$"+es,yt="__reactContainer$"+es,oa="__reactEvents$"+es,Xt="__reactListeners$"+es,ql="__reactHandles$"+es,kn="__reactResources$"+es,Cn="__reactMarker$"+es;function Nd(s){delete s[Ss],delete s[hs],delete s[oa],delete s[Xt],delete s[ql]}function lr(s){var t=s[Ss];if(t)return t;for(var n=s.parentNode;n;){if(t=n[yt]||n[Ss]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(s=sg(s);s!==null;){if(n=s[Ss])return n;s=sg(s)}return t}s=n,n=s.parentNode}return null}function nr(s){if(s=s[Ss]||s[yt]){var t=s.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return s}return null}function ai(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s.stateNode;throw Error(c(33))}function rr(s){var t=s[kn];return t||(t=s[kn]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Gt(s){s[Cn]=!0}var Dx=new Set,Ox={};function Tn(s,t){ir(s,t),ir(s+"Capture",t)}function ir(s,t){for(Ox[s]=t,s=0;s<t.length;s++)Dx.add(t[s])}var Fb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lx={},Ux={};function Hb(s){return ws.call(Ux,s)?!0:ws.call(Lx,s)?!1:Fb.test(s)?Ux[s]=!0:(Lx[s]=!0,!1)}function Nc(s,t,n){if(Hb(t))if(n===null)s.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":s.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){s.removeAttribute(t);return}}s.setAttribute(t,""+n)}}function bc(s,t,n){if(n===null)s.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(t);return}s.setAttribute(t,""+n)}}function pl(s,t,n,i){if(i===null)s.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(n);return}s.setAttributeNS(t,n,""+i)}}function Fa(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function $x(s){var t=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function qb(s,t,n){var i=Object.getOwnPropertyDescriptor(s.constructor.prototype,t);if(!s.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var o=i.get,x=i.set;return Object.defineProperty(s,t,{configurable:!0,get:function(){return o.call(this)},set:function(v){n=""+v,x.call(this,v)}}),Object.defineProperty(s,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(v){n=""+v},stopTracking:function(){s._valueTracker=null,delete s[t]}}}}function bd(s){if(!s._valueTracker){var t=$x(s)?"checked":"value";s._valueTracker=qb(s,t,""+s[t])}}function Bx(s){if(!s)return!1;var t=s._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return s&&(i=$x(s)?s.checked?"true":"false":s.value),s=i,s!==n?(t.setValue(s),!0):!1}function yc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Vb=/[\n"\\]/g;function Ha(s){return s.replace(Vb,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function yd(s,t,n,i,o,x,v,k){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),t!=null?v==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+Fa(t)):s.value!==""+Fa(t)&&(s.value=""+Fa(t)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),t!=null?wd(s,v,Fa(t)):n!=null?wd(s,v,Fa(n)):i!=null&&s.removeAttribute("value"),o==null&&x!=null&&(s.defaultChecked=!!x),o!=null&&(s.checked=o&&typeof o!="function"&&typeof o!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+Fa(k):s.removeAttribute("name")}function Ix(s,t,n,i,o,x,v,k){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),t!=null||n!=null){if(!(x!=="submit"&&x!=="reset"||t!=null)){bd(s);return}n=n!=null?""+Fa(n):"",t=t!=null?""+Fa(t):n,k||t===s.value||(s.value=t),s.defaultValue=t}i=i??o,i=typeof i!="function"&&typeof i!="symbol"&&!!i,s.checked=k?s.checked:!!i,s.defaultChecked=!!i,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),bd(s)}function wd(s,t,n){t==="number"&&yc(s.ownerDocument)===s||s.defaultValue===""+n||(s.defaultValue=""+n)}function cr(s,t,n,i){if(s=s.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<s.length;n++)o=t.hasOwnProperty("$"+s[n].value),s[n].selected!==o&&(s[n].selected=o),o&&i&&(s[n].defaultSelected=!0)}else{for(n=""+Fa(n),t=null,o=0;o<s.length;o++){if(s[o].value===n){s[o].selected=!0,i&&(s[o].defaultSelected=!0);return}t!==null||s[o].disabled||(t=s[o])}t!==null&&(t.selected=!0)}}function Px(s,t,n){if(t!=null&&(t=""+Fa(t),t!==s.value&&(s.value=t),n==null)){s.defaultValue!==t&&(s.defaultValue=t);return}s.defaultValue=n!=null?""+Fa(n):""}function Fx(s,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(c(92));if(pe(i)){if(1<i.length)throw Error(c(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=Fa(t),s.defaultValue=n,i=s.textContent,i===n&&i!==""&&i!==null&&(s.value=i),bd(s)}function or(s,t){if(t){var n=s.firstChild;if(n&&n===s.lastChild&&n.nodeType===3){n.nodeValue=t;return}}s.textContent=t}var Gb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hx(s,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?s.setProperty(t,""):t==="float"?s.cssFloat="":s[t]="":i?s.setProperty(t,n):typeof n!="number"||n===0||Gb.has(t)?t==="float"?s.cssFloat=n:s[t]=(""+n).trim():s[t]=n+"px"}function qx(s,t,n){if(t!=null&&typeof t!="object")throw Error(c(62));if(s=s.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="");for(var o in t)i=t[o],t.hasOwnProperty(o)&&n[o]!==i&&Hx(s,o,i)}else for(var x in t)t.hasOwnProperty(x)&&Hx(s,x,t[x])}function _d(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wc(s){return Qb.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function gl(){}var Sd=null;function kd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var dr=null,ur=null;function Vx(s){var t=nr(s);if(t&&(s=t.stateNode)){var n=s[hs]||null;e:switch(s=t.stateNode,t.type){case"input":if(yd(s,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=s;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Ha(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==s&&i.form===s.form){var o=i[hs]||null;if(!o)throw Error(c(90));yd(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===s.form&&Bx(i)}break e;case"textarea":Px(s,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&cr(s,!!n.multiple,t,!1)}}}var Cd=!1;function Gx(s,t,n){if(Cd)return s(t,n);Cd=!0;try{var i=s(t);return i}finally{if(Cd=!1,(dr!==null||ur!==null)&&(uo(),dr&&(t=dr,s=ur,ur=dr=null,Vx(t),s)))for(t=0;t<s.length;t++)Vx(s[t])}}function li(s,t){var n=s.stateNode;if(n===null)return null;var i=n[hs]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(s=s.type,i=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!i;break e;default:s=!1}if(s)return null;if(n&&typeof n!="function")throw Error(c(231,t,typeof n));return n}var jl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Td=!1;if(jl)try{var ni={};Object.defineProperty(ni,"passive",{get:function(){Td=!0}}),window.addEventListener("test",ni,ni),window.removeEventListener("test",ni,ni)}catch{Td=!1}var Vl=null,Ed=null,_c=null;function Kx(){if(_c)return _c;var s,t=Ed,n=t.length,i,o="value"in Vl?Vl.value:Vl.textContent,x=o.length;for(s=0;s<n&&t[s]===o[s];s++);var v=n-s;for(i=1;i<=v&&t[n-i]===o[x-i];i++);return _c=o.slice(s,1<i?1-i:void 0)}function Sc(s){var t=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&t===13&&(s=13)):s=t,s===10&&(s=13),32<=s||s===13?s:0}function kc(){return!0}function Qx(){return!1}function pa(s){function t(n,i,o,x,v){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=x,this.target=v,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(n=s[k],this[k]=n?n(x):x[k]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?kc:Qx,this.isPropagationStopped=Qx,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kc)},persist:function(){},isPersistent:kc}),t}var En={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cc=pa(En),ri=j({},En,{view:0,detail:0}),Yb=pa(ri),Md,Ad,ii,Tc=j({},ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ii&&(ii&&s.type==="mousemove"?(Md=s.screenX-ii.screenX,Ad=s.screenY-ii.screenY):Ad=Md=0,ii=s),Md)},movementY:function(s){return"movementY"in s?s.movementY:Ad}}),Yx=pa(Tc),Jb=j({},Tc,{dataTransfer:0}),Xb=pa(Jb),Zb=j({},ri,{relatedTarget:0}),zd=pa(Zb),Wb=j({},En,{animationName:0,elapsedTime:0,pseudoElement:0}),ey=pa(Wb),sy=j({},En,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ty=pa(sy),ay=j({},En,{data:0}),Jx=pa(ay),ly={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ny={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ry={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iy(s){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(s):(s=ry[s])?!!t[s]:!1}function Rd(){return iy}var cy=j({},ri,{key:function(s){if(s.key){var t=ly[s.key]||s.key;if(t!=="Unidentified")return t}return s.type==="keypress"?(s=Sc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ny[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rd,charCode:function(s){return s.type==="keypress"?Sc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Sc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),oy=pa(cy),dy=j({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xx=pa(dy),uy=j({},ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rd}),my=pa(uy),xy=j({},En,{propertyName:0,elapsedTime:0,pseudoElement:0}),hy=pa(xy),fy=j({},Tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),py=pa(fy),gy=j({},En,{newState:0,oldState:0}),jy=pa(gy),vy=[9,13,27,32],Dd=jl&&"CompositionEvent"in window,ci=null;jl&&"documentMode"in document&&(ci=document.documentMode);var Ny=jl&&"TextEvent"in window&&!ci,Zx=jl&&(!Dd||ci&&8<ci&&11>=ci),Wx=" ",eh=!1;function sh(s,t){switch(s){case"keyup":return vy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function th(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var mr=!1;function by(s,t){switch(s){case"compositionend":return th(t);case"keypress":return t.which!==32?null:(eh=!0,Wx);case"textInput":return s=t.data,s===Wx&&eh?null:s;default:return null}}function yy(s,t){if(mr)return s==="compositionend"||!Dd&&sh(s,t)?(s=Kx(),_c=Ed=Vl=null,mr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Zx&&t.locale!=="ko"?null:t.data;default:return null}}var wy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ah(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t==="input"?!!wy[s.type]:t==="textarea"}function lh(s,t,n,i){dr?ur?ur.push(i):ur=[i]:dr=i,t=jo(t,"onChange"),0<t.length&&(n=new Cc("onChange","change",null,n,i),s.push({event:n,listeners:t}))}var oi=null,di=null;function _y(s){Pp(s,0)}function Ec(s){var t=ai(s);if(Bx(t))return s}function nh(s,t){if(s==="change")return t}var rh=!1;if(jl){var Od;if(jl){var Ld="oninput"in document;if(!Ld){var ih=document.createElement("div");ih.setAttribute("oninput","return;"),Ld=typeof ih.oninput=="function"}Od=Ld}else Od=!1;rh=Od&&(!document.documentMode||9<document.documentMode)}function ch(){oi&&(oi.detachEvent("onpropertychange",oh),di=oi=null)}function oh(s){if(s.propertyName==="value"&&Ec(di)){var t=[];lh(t,di,s,kd(s)),Gx(_y,t)}}function Sy(s,t,n){s==="focusin"?(ch(),oi=t,di=n,oi.attachEvent("onpropertychange",oh)):s==="focusout"&&ch()}function ky(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ec(di)}function Cy(s,t){if(s==="click")return Ec(t)}function Ty(s,t){if(s==="input"||s==="change")return Ec(t)}function Ey(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var Ca=typeof Object.is=="function"?Object.is:Ey;function ui(s,t){if(Ca(s,t))return!0;if(typeof s!="object"||s===null||typeof t!="object"||t===null)return!1;var n=Object.keys(s),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!ws.call(t,o)||!Ca(s[o],t[o]))return!1}return!0}function dh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function uh(s,t){var n=dh(s);s=0;for(var i;n;){if(n.nodeType===3){if(i=s+n.textContent.length,s<=t&&i>=t)return{node:n,offset:t-s};s=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dh(n)}}function mh(s,t){return s&&t?s===t?!0:s&&s.nodeType===3?!1:t&&t.nodeType===3?mh(s,t.parentNode):"contains"in s?s.contains(t):s.compareDocumentPosition?!!(s.compareDocumentPosition(t)&16):!1:!1}function xh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var t=yc(s.document);t instanceof s.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)s=t.contentWindow;else break;t=yc(s.document)}return t}function Ud(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t&&(t==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||t==="textarea"||s.contentEditable==="true")}var My=jl&&"documentMode"in document&&11>=document.documentMode,xr=null,$d=null,mi=null,Bd=!1;function hh(s,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bd||xr==null||xr!==yc(i)||(i=xr,"selectionStart"in i&&Ud(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),mi&&ui(mi,i)||(mi=i,i=jo($d,"onSelect"),0<i.length&&(t=new Cc("onSelect","select",null,t,n),s.push({event:t,listeners:i}),t.target=xr)))}function Mn(s,t){var n={};return n[s.toLowerCase()]=t.toLowerCase(),n["Webkit"+s]="webkit"+t,n["Moz"+s]="moz"+t,n}var hr={animationend:Mn("Animation","AnimationEnd"),animationiteration:Mn("Animation","AnimationIteration"),animationstart:Mn("Animation","AnimationStart"),transitionrun:Mn("Transition","TransitionRun"),transitionstart:Mn("Transition","TransitionStart"),transitioncancel:Mn("Transition","TransitionCancel"),transitionend:Mn("Transition","TransitionEnd")},Id={},fh={};jl&&(fh=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);function An(s){if(Id[s])return Id[s];if(!hr[s])return s;var t=hr[s],n;for(n in t)if(t.hasOwnProperty(n)&&n in fh)return Id[s]=t[n];return s}var ph=An("animationend"),gh=An("animationiteration"),jh=An("animationstart"),Ay=An("transitionrun"),zy=An("transitionstart"),Ry=An("transitioncancel"),vh=An("transitionend"),Nh=new Map,Pd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pd.push("scrollEnd");function tl(s,t){Nh.set(s,t),Tn(t,[s])}var Mc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},qa=[],fr=0,Fd=0;function Ac(){for(var s=fr,t=Fd=fr=0;t<s;){var n=qa[t];qa[t++]=null;var i=qa[t];qa[t++]=null;var o=qa[t];qa[t++]=null;var x=qa[t];if(qa[t++]=null,i!==null&&o!==null){var v=i.pending;v===null?o.next=o:(o.next=v.next,v.next=o),i.pending=o}x!==0&&bh(n,o,x)}}function zc(s,t,n,i){qa[fr++]=s,qa[fr++]=t,qa[fr++]=n,qa[fr++]=i,Fd|=i,s.lanes|=i,s=s.alternate,s!==null&&(s.lanes|=i)}function Hd(s,t,n,i){return zc(s,t,n,i),Rc(s)}function zn(s,t){return zc(s,null,null,t),Rc(s)}function bh(s,t,n){s.lanes|=n;var i=s.alternate;i!==null&&(i.lanes|=n);for(var o=!1,x=s.return;x!==null;)x.childLanes|=n,i=x.alternate,i!==null&&(i.childLanes|=n),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(o=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,o&&t!==null&&(o=31-_s(n),s=x.hiddenUpdates,i=s[o],i===null?s[o]=[t]:i.push(t),t.lane=n|536870912),x):null}function Rc(s){if(50<Di)throw Di=0,Zu=null,Error(c(185));for(var t=s.return;t!==null;)s=t,t=s.return;return s.tag===3?s.stateNode:null}var pr={};function Dy(s,t,n,i){this.tag=s,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(s,t,n,i){return new Dy(s,t,n,i)}function qd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function vl(s,t){var n=s.alternate;return n===null?(n=Ta(s.tag,t,s.key,s.mode),n.elementType=s.elementType,n.type=s.type,n.stateNode=s.stateNode,n.alternate=s,s.alternate=n):(n.pendingProps=t,n.type=s.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=s.flags&65011712,n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,t=s.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=s.sibling,n.index=s.index,n.ref=s.ref,n.refCleanup=s.refCleanup,n}function yh(s,t){s.flags&=65011714;var n=s.alternate;return n===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=n.childLanes,s.lanes=n.lanes,s.child=n.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=n.memoizedProps,s.memoizedState=n.memoizedState,s.updateQueue=n.updateQueue,s.type=n.type,t=n.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s}function Dc(s,t,n,i,o,x){var v=0;if(i=s,typeof s=="function")qd(s)&&(v=1);else if(typeof s=="string")v=B0(s,n,V.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case L:return s=Ta(31,n,t,o),s.elementType=L,s.lanes=x,s;case A:return Rn(n.children,o,x,t);case M:v=8,o|=24;break;case S:return s=Ta(12,n,t,o|2),s.elementType=S,s.lanes=x,s;case R:return s=Ta(13,n,t,o),s.elementType=R,s.lanes=x,s;case H:return s=Ta(19,n,t,o),s.elementType=H,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:v=10;break e;case P:v=9;break e;case C:v=11;break e;case O:v=14;break e;case X:v=16,i=null;break e}v=29,n=Error(c(130,s===null?"null":typeof s,"")),i=null}return t=Ta(v,n,t,o),t.elementType=s,t.type=i,t.lanes=x,t}function Rn(s,t,n,i){return s=Ta(7,s,i,t),s.lanes=n,s}function Vd(s,t,n){return s=Ta(6,s,null,t),s.lanes=n,s}function wh(s){var t=Ta(18,null,null,0);return t.stateNode=s,t}function Gd(s,t,n){return t=Ta(4,s.children!==null?s.children:[],s.key,t),t.lanes=n,t.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},t}var _h=new WeakMap;function Va(s,t){if(typeof s=="object"&&s!==null){var n=_h.get(s);return n!==void 0?n:(t={value:s,source:t,stack:ze(t)},_h.set(s,t),t)}return{value:s,source:t,stack:ze(t)}}var gr=[],jr=0,Oc=null,xi=0,Ga=[],Ka=0,Gl=null,cl=1,ol="";function Nl(s,t){gr[jr++]=xi,gr[jr++]=Oc,Oc=s,xi=t}function Sh(s,t,n){Ga[Ka++]=cl,Ga[Ka++]=ol,Ga[Ka++]=Gl,Gl=s;var i=cl;s=ol;var o=32-_s(i)-1;i&=~(1<<o),n+=1;var x=32-_s(t)+o;if(30<x){var v=o-o%5;x=(i&(1<<v)-1).toString(32),i>>=v,o-=v,cl=1<<32-_s(t)+o|n<<o|i,ol=x+s}else cl=1<<x|n<<o|i,ol=s}function Kd(s){s.return!==null&&(Nl(s,1),Sh(s,1,0))}function Qd(s){for(;s===Oc;)Oc=gr[--jr],gr[jr]=null,xi=gr[--jr],gr[jr]=null;for(;s===Gl;)Gl=Ga[--Ka],Ga[Ka]=null,ol=Ga[--Ka],Ga[Ka]=null,cl=Ga[--Ka],Ga[Ka]=null}function kh(s,t){Ga[Ka++]=cl,Ga[Ka++]=ol,Ga[Ka++]=Gl,cl=t.id,ol=t.overflow,Gl=s}var Zt=null,vt=null,Bs=!1,Kl=null,Qa=!1,Yd=Error(c(519));function Ql(s){var t=Error(c(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hi(Va(t,s)),Yd}function Ch(s){var t=s.stateNode,n=s.type,i=s.memoizedProps;switch(t[Ss]=s,t[hs]=i,n){case"dialog":Ds("cancel",t),Ds("close",t);break;case"iframe":case"object":case"embed":Ds("load",t);break;case"video":case"audio":for(n=0;n<Li.length;n++)Ds(Li[n],t);break;case"source":Ds("error",t);break;case"img":case"image":case"link":Ds("error",t),Ds("load",t);break;case"details":Ds("toggle",t);break;case"input":Ds("invalid",t),Ix(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Ds("invalid",t);break;case"textarea":Ds("invalid",t),Fx(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||Vp(t.textContent,n)?(i.popover!=null&&(Ds("beforetoggle",t),Ds("toggle",t)),i.onScroll!=null&&Ds("scroll",t),i.onScrollEnd!=null&&Ds("scrollend",t),i.onClick!=null&&(t.onclick=gl),t=!0):t=!1,t||Ql(s,!0)}function Th(s){for(Zt=s.return;Zt;)switch(Zt.tag){case 5:case 31:case 13:Qa=!1;return;case 27:case 3:Qa=!0;return;default:Zt=Zt.return}}function vr(s){if(s!==Zt)return!1;if(!Bs)return Th(s),Bs=!0,!1;var t=s.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=s.type,n=!(n!=="form"&&n!=="button")||xm(s.type,s.memoizedProps)),n=!n),n&&vt&&Ql(s),Th(s),t===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));vt=eg(s)}else if(t===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));vt=eg(s)}else t===27?(t=vt,on(s.type)?(s=jm,jm=null,vt=s):vt=t):vt=Zt?Ja(s.stateNode.nextSibling):null;return!0}function Dn(){vt=Zt=null,Bs=!1}function Jd(){var s=Kl;return s!==null&&(Na===null?Na=s:Na.push.apply(Na,s),Kl=null),s}function hi(s){Kl===null?Kl=[s]:Kl.push(s)}var Xd=_e(null),On=null,bl=null;function Yl(s,t,n){Te(Xd,t._currentValue),t._currentValue=n}function yl(s){s._currentValue=Xd.current,he(Xd)}function Zd(s,t,n){for(;s!==null;){var i=s.alternate;if((s.childLanes&t)!==t?(s.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),s===n)break;s=s.return}}function Wd(s,t,n,i){var o=s.child;for(o!==null&&(o.return=s);o!==null;){var x=o.dependencies;if(x!==null){var v=o.child;x=x.firstContext;e:for(;x!==null;){var k=x;x=o;for(var I=0;I<t.length;I++)if(k.context===t[I]){x.lanes|=n,k=x.alternate,k!==null&&(k.lanes|=n),Zd(x.return,n,s),i||(v=null);break e}x=k.next}}else if(o.tag===18){if(v=o.return,v===null)throw Error(c(341));v.lanes|=n,x=v.alternate,x!==null&&(x.lanes|=n),Zd(v,n,s),v=null}else v=o.child;if(v!==null)v.return=o;else for(v=o;v!==null;){if(v===s){v=null;break}if(o=v.sibling,o!==null){o.return=v.return,v=o;break}v=v.return}o=v}}function Nr(s,t,n,i){s=null;for(var o=t,x=!1;o!==null;){if(!x){if((o.flags&524288)!==0)x=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var v=o.alternate;if(v===null)throw Error(c(387));if(v=v.memoizedProps,v!==null){var k=o.type;Ca(o.pendingProps.value,v.value)||(s!==null?s.push(k):s=[k])}}else if(o===G.current){if(v=o.alternate,v===null)throw Error(c(387));v.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(s!==null?s.push(Pi):s=[Pi])}o=o.return}s!==null&&Wd(t,s,n,i),t.flags|=262144}function Lc(s){for(s=s.firstContext;s!==null;){if(!Ca(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ln(s){On=s,bl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Wt(s){return Eh(On,s)}function Uc(s,t){return On===null&&Ln(s),Eh(s,t)}function Eh(s,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},bl===null){if(s===null)throw Error(c(308));bl=t,s.dependencies={lanes:0,firstContext:t},s.flags|=524288}else bl=bl.next=t;return n}var Oy=typeof AbortController<"u"?AbortController:function(){var s=[],t=this.signal={aborted:!1,addEventListener:function(n,i){s.push(i)}};this.abort=function(){t.aborted=!0,s.forEach(function(n){return n()})}},Ly=a.unstable_scheduleCallback,Uy=a.unstable_NormalPriority,$t={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function eu(){return{controller:new Oy,data:new Map,refCount:0}}function fi(s){s.refCount--,s.refCount===0&&Ly(Uy,function(){s.controller.abort()})}var pi=null,su=0,br=0,yr=null;function $y(s,t){if(pi===null){var n=pi=[];su=0,br=lm(),yr={status:"pending",value:void 0,then:function(i){n.push(i)}}}return su++,t.then(Mh,Mh),t}function Mh(){if(--su===0&&pi!==null){yr!==null&&(yr.status="fulfilled");var s=pi;pi=null,br=0,yr=null;for(var t=0;t<s.length;t++)(0,s[t])()}}function By(s,t){var n=[],i={status:"pending",value:null,reason:null,then:function(o){n.push(o)}};return s.then(function(){i.status="fulfilled",i.value=t;for(var o=0;o<n.length;o++)(0,n[o])(t)},function(o){for(i.status="rejected",i.reason=o,o=0;o<n.length;o++)(0,n[o])(void 0)}),i}var Ah=D.S;D.S=function(s,t){fp=Is(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&$y(s,t),Ah!==null&&Ah(s,t)};var Un=_e(null);function tu(){var s=Un.current;return s!==null?s:mt.pooledCache}function $c(s,t){t===null?Te(Un,Un.current):Te(Un,t.pool)}function zh(){var s=tu();return s===null?null:{parent:$t._currentValue,pool:s}}var wr=Error(c(460)),au=Error(c(474)),Bc=Error(c(542)),Ic={then:function(){}};function Rh(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Dh(s,t,n){switch(n=s[n],n===void 0?s.push(t):n!==t&&(t.then(gl,gl),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Lh(s),s;default:if(typeof t.status=="string")t.then(gl,gl);else{if(s=mt,s!==null&&100<s.shellSuspendCounter)throw Error(c(482));s=t,s.status="pending",s.then(function(i){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=i}},function(i){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,Lh(s),s}throw Bn=t,wr}}function $n(s){try{var t=s._init;return t(s._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Bn=n,wr):n}}var Bn=null;function Oh(){if(Bn===null)throw Error(c(459));var s=Bn;return Bn=null,s}function Lh(s){if(s===wr||s===Bc)throw Error(c(483))}var _r=null,gi=0;function Pc(s){var t=gi;return gi+=1,_r===null&&(_r=[]),Dh(_r,s,t)}function ji(s,t){t=t.props.ref,s.ref=t!==void 0?t:null}function Fc(s,t){throw t.$$typeof===y?Error(c(525)):(s=Object.prototype.toString.call(t),Error(c(31,s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)))}function Uh(s){function t(W,q){if(s){var re=W.deletions;re===null?(W.deletions=[q],W.flags|=16):re.push(q)}}function n(W,q){if(!s)return null;for(;q!==null;)t(W,q),q=q.sibling;return null}function i(W){for(var q=new Map;W!==null;)W.key!==null?q.set(W.key,W):q.set(W.index,W),W=W.sibling;return q}function o(W,q){return W=vl(W,q),W.index=0,W.sibling=null,W}function x(W,q,re){return W.index=re,s?(re=W.alternate,re!==null?(re=re.index,re<q?(W.flags|=67108866,q):re):(W.flags|=67108866,q)):(W.flags|=1048576,q)}function v(W){return s&&W.alternate===null&&(W.flags|=67108866),W}function k(W,q,re,be){return q===null||q.tag!==6?(q=Vd(re,W.mode,be),q.return=W,q):(q=o(q,re),q.return=W,q)}function I(W,q,re,be){var We=re.type;return We===A?ve(W,q,re.props.children,be,re.key):q!==null&&(q.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===X&&$n(We)===q.type)?(q=o(q,re.props),ji(q,re),q.return=W,q):(q=Dc(re.type,re.key,re.props,null,W.mode,be),ji(q,re),q.return=W,q)}function ie(W,q,re,be){return q===null||q.tag!==4||q.stateNode.containerInfo!==re.containerInfo||q.stateNode.implementation!==re.implementation?(q=Gd(re,W.mode,be),q.return=W,q):(q=o(q,re.children||[]),q.return=W,q)}function ve(W,q,re,be,We){return q===null||q.tag!==7?(q=Rn(re,W.mode,be,We),q.return=W,q):(q=o(q,re),q.return=W,q)}function we(W,q,re){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Vd(""+q,W.mode,re),q.return=W,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case b:return re=Dc(q.type,q.key,q.props,null,W.mode,re),ji(re,q),re.return=W,re;case w:return q=Gd(q,W.mode,re),q.return=W,q;case X:return q=$n(q),we(W,q,re)}if(pe(q)||je(q))return q=Rn(q,W.mode,re,null),q.return=W,q;if(typeof q.then=="function")return we(W,Pc(q),re);if(q.$$typeof===E)return we(W,Uc(W,q),re);Fc(W,q)}return null}function oe(W,q,re,be){var We=q!==null?q.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return We!==null?null:k(W,q,""+re,be);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case b:return re.key===We?I(W,q,re,be):null;case w:return re.key===We?ie(W,q,re,be):null;case X:return re=$n(re),oe(W,q,re,be)}if(pe(re)||je(re))return We!==null?null:ve(W,q,re,be,null);if(typeof re.then=="function")return oe(W,q,Pc(re),be);if(re.$$typeof===E)return oe(W,q,Uc(W,re),be);Fc(W,re)}return null}function xe(W,q,re,be,We){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return W=W.get(re)||null,k(q,W,""+be,We);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case b:return W=W.get(be.key===null?re:be.key)||null,I(q,W,be,We);case w:return W=W.get(be.key===null?re:be.key)||null,ie(q,W,be,We);case X:return be=$n(be),xe(W,q,re,be,We)}if(pe(be)||je(be))return W=W.get(re)||null,ve(q,W,be,We,null);if(typeof be.then=="function")return xe(W,q,re,Pc(be),We);if(be.$$typeof===E)return xe(W,q,re,Uc(q,be),We);Fc(q,be)}return null}function Ve(W,q,re,be){for(var We=null,Qs=null,Qe=q,Es=q=0,$s=null;Qe!==null&&Es<re.length;Es++){Qe.index>Es?($s=Qe,Qe=null):$s=Qe.sibling;var Ys=oe(W,Qe,re[Es],be);if(Ys===null){Qe===null&&(Qe=$s);break}s&&Qe&&Ys.alternate===null&&t(W,Qe),q=x(Ys,q,Es),Qs===null?We=Ys:Qs.sibling=Ys,Qs=Ys,Qe=$s}if(Es===re.length)return n(W,Qe),Bs&&Nl(W,Es),We;if(Qe===null){for(;Es<re.length;Es++)Qe=we(W,re[Es],be),Qe!==null&&(q=x(Qe,q,Es),Qs===null?We=Qe:Qs.sibling=Qe,Qs=Qe);return Bs&&Nl(W,Es),We}for(Qe=i(Qe);Es<re.length;Es++)$s=xe(Qe,W,Es,re[Es],be),$s!==null&&(s&&$s.alternate!==null&&Qe.delete($s.key===null?Es:$s.key),q=x($s,q,Es),Qs===null?We=$s:Qs.sibling=$s,Qs=$s);return s&&Qe.forEach(function(hn){return t(W,hn)}),Bs&&Nl(W,Es),We}function as(W,q,re,be){if(re==null)throw Error(c(151));for(var We=null,Qs=null,Qe=q,Es=q=0,$s=null,Ys=re.next();Qe!==null&&!Ys.done;Es++,Ys=re.next()){Qe.index>Es?($s=Qe,Qe=null):$s=Qe.sibling;var hn=oe(W,Qe,Ys.value,be);if(hn===null){Qe===null&&(Qe=$s);break}s&&Qe&&hn.alternate===null&&t(W,Qe),q=x(hn,q,Es),Qs===null?We=hn:Qs.sibling=hn,Qs=hn,Qe=$s}if(Ys.done)return n(W,Qe),Bs&&Nl(W,Es),We;if(Qe===null){for(;!Ys.done;Es++,Ys=re.next())Ys=we(W,Ys.value,be),Ys!==null&&(q=x(Ys,q,Es),Qs===null?We=Ys:Qs.sibling=Ys,Qs=Ys);return Bs&&Nl(W,Es),We}for(Qe=i(Qe);!Ys.done;Es++,Ys=re.next())Ys=xe(Qe,W,Es,Ys.value,be),Ys!==null&&(s&&Ys.alternate!==null&&Qe.delete(Ys.key===null?Es:Ys.key),q=x(Ys,q,Es),Qs===null?We=Ys:Qs.sibling=Ys,Qs=Ys);return s&&Qe.forEach(function(J0){return t(W,J0)}),Bs&&Nl(W,Es),We}function dt(W,q,re,be){if(typeof re=="object"&&re!==null&&re.type===A&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case b:e:{for(var We=re.key;q!==null;){if(q.key===We){if(We=re.type,We===A){if(q.tag===7){n(W,q.sibling),be=o(q,re.props.children),be.return=W,W=be;break e}}else if(q.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===X&&$n(We)===q.type){n(W,q.sibling),be=o(q,re.props),ji(be,re),be.return=W,W=be;break e}n(W,q);break}else t(W,q);q=q.sibling}re.type===A?(be=Rn(re.props.children,W.mode,be,re.key),be.return=W,W=be):(be=Dc(re.type,re.key,re.props,null,W.mode,be),ji(be,re),be.return=W,W=be)}return v(W);case w:e:{for(We=re.key;q!==null;){if(q.key===We)if(q.tag===4&&q.stateNode.containerInfo===re.containerInfo&&q.stateNode.implementation===re.implementation){n(W,q.sibling),be=o(q,re.children||[]),be.return=W,W=be;break e}else{n(W,q);break}else t(W,q);q=q.sibling}be=Gd(re,W.mode,be),be.return=W,W=be}return v(W);case X:return re=$n(re),dt(W,q,re,be)}if(pe(re))return Ve(W,q,re,be);if(je(re)){if(We=je(re),typeof We!="function")throw Error(c(150));return re=We.call(re),as(W,q,re,be)}if(typeof re.then=="function")return dt(W,q,Pc(re),be);if(re.$$typeof===E)return dt(W,q,Uc(W,re),be);Fc(W,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,q!==null&&q.tag===6?(n(W,q.sibling),be=o(q,re),be.return=W,W=be):(n(W,q),be=Vd(re,W.mode,be),be.return=W,W=be),v(W)):n(W,q)}return function(W,q,re,be){try{gi=0;var We=dt(W,q,re,be);return _r=null,We}catch(Qe){if(Qe===wr||Qe===Bc)throw Qe;var Qs=Ta(29,Qe,null,W.mode);return Qs.lanes=be,Qs.return=W,Qs}finally{}}}var In=Uh(!0),$h=Uh(!1),Jl=!1;function lu(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nu(s,t){s=s.updateQueue,t.updateQueue===s&&(t.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Xl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Zl(s,t,n){var i=s.updateQueue;if(i===null)return null;if(i=i.shared,(Xs&2)!==0){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,t=Rc(s),bh(s,null,n),t}return zc(s,i,t,n),Rc(s)}function vi(s,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=s.pendingLanes,n|=i,t.lanes=n,ds(s,n)}}function ru(s,t){var n=s.updateQueue,i=s.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,x=null;if(n=n.firstBaseUpdate,n!==null){do{var v={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};x===null?o=x=v:x=x.next=v,n=n.next}while(n!==null);x===null?o=x=t:x=x.next=t}else o=x=t;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:x,shared:i.shared,callbacks:i.callbacks},s.updateQueue=n;return}s=n.lastBaseUpdate,s===null?n.firstBaseUpdate=t:s.next=t,n.lastBaseUpdate=t}var iu=!1;function Ni(){if(iu){var s=yr;if(s!==null)throw s}}function bi(s,t,n,i){iu=!1;var o=s.updateQueue;Jl=!1;var x=o.firstBaseUpdate,v=o.lastBaseUpdate,k=o.shared.pending;if(k!==null){o.shared.pending=null;var I=k,ie=I.next;I.next=null,v===null?x=ie:v.next=ie,v=I;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,k=ve.lastBaseUpdate,k!==v&&(k===null?ve.firstBaseUpdate=ie:k.next=ie,ve.lastBaseUpdate=I))}if(x!==null){var we=o.baseState;v=0,ve=ie=I=null,k=x;do{var oe=k.lane&-536870913,xe=oe!==k.lane;if(xe?(Us&oe)===oe:(i&oe)===oe){oe!==0&&oe===br&&(iu=!0),ve!==null&&(ve=ve.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Ve=s,as=k;oe=t;var dt=n;switch(as.tag){case 1:if(Ve=as.payload,typeof Ve=="function"){we=Ve.call(dt,we,oe);break e}we=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=as.payload,oe=typeof Ve=="function"?Ve.call(dt,we,oe):Ve,oe==null)break e;we=j({},we,oe);break e;case 2:Jl=!0}}oe=k.callback,oe!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=o.callbacks,xe===null?o.callbacks=[oe]:xe.push(oe))}else xe={lane:oe,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ve===null?(ie=ve=xe,I=we):ve=ve.next=xe,v|=oe;if(k=k.next,k===null){if(k=o.shared.pending,k===null)break;xe=k,k=xe.next,xe.next=null,o.lastBaseUpdate=xe,o.shared.pending=null}}while(!0);ve===null&&(I=we),o.baseState=I,o.firstBaseUpdate=ie,o.lastBaseUpdate=ve,x===null&&(o.shared.lanes=0),an|=v,s.lanes=v,s.memoizedState=we}}function Bh(s,t){if(typeof s!="function")throw Error(c(191,s));s.call(t)}function Ih(s,t){var n=s.callbacks;if(n!==null)for(s.callbacks=null,s=0;s<n.length;s++)Bh(n[s],t)}var Sr=_e(null),Hc=_e(0);function Ph(s,t){s=Al,Te(Hc,s),Te(Sr,t),Al=s|t.baseLanes}function cu(){Te(Hc,Al),Te(Sr,Sr.current)}function ou(){Al=Hc.current,he(Sr),he(Hc)}var Ea=_e(null),Ya=null;function Wl(s){var t=s.alternate;Te(Dt,Dt.current&1),Te(Ea,s),Ya===null&&(t===null||Sr.current!==null||t.memoizedState!==null)&&(Ya=s)}function du(s){Te(Dt,Dt.current),Te(Ea,s),Ya===null&&(Ya=s)}function Fh(s){s.tag===22?(Te(Dt,Dt.current),Te(Ea,s),Ya===null&&(Ya=s)):en()}function en(){Te(Dt,Dt.current),Te(Ea,Ea.current)}function Ma(s){he(Ea),Ya===s&&(Ya=null),he(Dt)}var Dt=_e(0);function qc(s){for(var t=s;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||pm(n)||gm(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wl=0,ks=null,ct=null,Bt=null,Vc=!1,kr=!1,Pn=!1,Gc=0,yi=0,Cr=null,Iy=0;function Et(){throw Error(c(321))}function uu(s,t){if(t===null)return!1;for(var n=0;n<t.length&&n<s.length;n++)if(!Ca(s[n],t[n]))return!1;return!0}function mu(s,t,n,i,o,x){return wl=x,ks=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=s===null||s.memoizedState===null?kf:Cu,Pn=!1,x=n(i,o),Pn=!1,kr&&(x=qh(t,n,i,o)),Hh(s),x}function Hh(s){D.H=Si;var t=ct!==null&&ct.next!==null;if(wl=0,Bt=ct=ks=null,Vc=!1,yi=0,Cr=null,t)throw Error(c(300));s===null||It||(s=s.dependencies,s!==null&&Lc(s)&&(It=!0))}function qh(s,t,n,i){ks=s;var o=0;do{if(kr&&(Cr=null),yi=0,kr=!1,25<=o)throw Error(c(301));if(o+=1,Bt=ct=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}D.H=Cf,x=t(n,i)}while(kr);return x}function Py(){var s=D.H,t=s.useState()[0];return t=typeof t.then=="function"?wi(t):t,s=s.useState()[0],(ct!==null?ct.memoizedState:null)!==s&&(ks.flags|=1024),t}function xu(){var s=Gc!==0;return Gc=0,s}function hu(s,t,n){t.updateQueue=s.updateQueue,t.flags&=-2053,s.lanes&=~n}function fu(s){if(Vc){for(s=s.memoizedState;s!==null;){var t=s.queue;t!==null&&(t.pending=null),s=s.next}Vc=!1}wl=0,Bt=ct=ks=null,kr=!1,yi=Gc=0,Cr=null}function da(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?ks.memoizedState=Bt=s:Bt=Bt.next=s,Bt}function Ot(){if(ct===null){var s=ks.alternate;s=s!==null?s.memoizedState:null}else s=ct.next;var t=Bt===null?ks.memoizedState:Bt.next;if(t!==null)Bt=t,ct=s;else{if(s===null)throw ks.alternate===null?Error(c(467)):Error(c(310));ct=s,s={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},Bt===null?ks.memoizedState=Bt=s:Bt=Bt.next=s}return Bt}function Kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wi(s){var t=yi;return yi+=1,Cr===null&&(Cr=[]),s=Dh(Cr,s,t),t=ks,(Bt===null?t.memoizedState:Bt.next)===null&&(t=t.alternate,D.H=t===null||t.memoizedState===null?kf:Cu),s}function Qc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return wi(s);if(s.$$typeof===E)return Wt(s)}throw Error(c(438,String(s)))}function pu(s){var t=null,n=ks.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=ks.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Kc(),ks.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(s),i=0;i<s;i++)n[i]=me;return t.index++,n}function _l(s,t){return typeof t=="function"?t(s):t}function Yc(s){var t=Ot();return gu(t,ct,s)}function gu(s,t,n){var i=s.queue;if(i===null)throw Error(c(311));i.lastRenderedReducer=n;var o=s.baseQueue,x=i.pending;if(x!==null){if(o!==null){var v=o.next;o.next=x.next,x.next=v}t.baseQueue=o=x,i.pending=null}if(x=s.baseState,o===null)s.memoizedState=x;else{t=o.next;var k=v=null,I=null,ie=t,ve=!1;do{var we=ie.lane&-536870913;if(we!==ie.lane?(Us&we)===we:(wl&we)===we){var oe=ie.revertLane;if(oe===0)I!==null&&(I=I.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),we===br&&(ve=!0);else if((wl&oe)===oe){ie=ie.next,oe===br&&(ve=!0);continue}else we={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},I===null?(k=I=we,v=x):I=I.next=we,ks.lanes|=oe,an|=oe;we=ie.action,Pn&&n(x,we),x=ie.hasEagerState?ie.eagerState:n(x,we)}else oe={lane:we,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},I===null?(k=I=oe,v=x):I=I.next=oe,ks.lanes|=we,an|=we;ie=ie.next}while(ie!==null&&ie!==t);if(I===null?v=x:I.next=k,!Ca(x,s.memoizedState)&&(It=!0,ve&&(n=yr,n!==null)))throw n;s.memoizedState=x,s.baseState=v,s.baseQueue=I,i.lastRenderedState=x}return o===null&&(i.lanes=0),[s.memoizedState,i.dispatch]}function ju(s){var t=Ot(),n=t.queue;if(n===null)throw Error(c(311));n.lastRenderedReducer=s;var i=n.dispatch,o=n.pending,x=t.memoizedState;if(o!==null){n.pending=null;var v=o=o.next;do x=s(x,v.action),v=v.next;while(v!==o);Ca(x,t.memoizedState)||(It=!0),t.memoizedState=x,t.baseQueue===null&&(t.baseState=x),n.lastRenderedState=x}return[x,i]}function Vh(s,t,n){var i=ks,o=Ot(),x=Bs;if(x){if(n===void 0)throw Error(c(407));n=n()}else n=t();var v=!Ca((ct||o).memoizedState,n);if(v&&(o.memoizedState=n,It=!0),o=o.queue,bu(Qh.bind(null,i,o,s),[s]),o.getSnapshot!==t||v||Bt!==null&&Bt.memoizedState.tag&1){if(i.flags|=2048,Tr(9,{destroy:void 0},Kh.bind(null,i,o,n,t),null),mt===null)throw Error(c(349));x||(wl&127)!==0||Gh(i,t,n)}return n}function Gh(s,t,n){s.flags|=16384,s={getSnapshot:t,value:n},t=ks.updateQueue,t===null?(t=Kc(),ks.updateQueue=t,t.stores=[s]):(n=t.stores,n===null?t.stores=[s]:n.push(s))}function Kh(s,t,n,i){t.value=n,t.getSnapshot=i,Yh(t)&&Jh(s)}function Qh(s,t,n){return n(function(){Yh(t)&&Jh(s)})}function Yh(s){var t=s.getSnapshot;s=s.value;try{var n=t();return!Ca(s,n)}catch{return!0}}function Jh(s){var t=zn(s,2);t!==null&&ba(t,s,2)}function vu(s){var t=da();if(typeof s=="function"){var n=s;if(s=n(),Pn){ts(!0);try{n()}finally{ts(!1)}}}return t.memoizedState=t.baseState=s,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:s},t}function Xh(s,t,n,i){return s.baseState=n,gu(s,ct,typeof i=="function"?i:_l)}function Fy(s,t,n,i,o){if(Zc(s))throw Error(c(485));if(s=t.action,s!==null){var x={payload:o,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){x.listeners.push(v)}};D.T!==null?n(!0):x.isTransition=!1,i(x),n=t.pending,n===null?(x.next=t.pending=x,Zh(t,x)):(x.next=n.next,t.pending=n.next=x)}}function Zh(s,t){var n=t.action,i=t.payload,o=s.state;if(t.isTransition){var x=D.T,v={};D.T=v;try{var k=n(o,i),I=D.S;I!==null&&I(v,k),Wh(s,t,k)}catch(ie){Nu(s,t,ie)}finally{x!==null&&v.types!==null&&(x.types=v.types),D.T=x}}else try{x=n(o,i),Wh(s,t,x)}catch(ie){Nu(s,t,ie)}}function Wh(s,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){ef(s,t,i)},function(i){return Nu(s,t,i)}):ef(s,t,n)}function ef(s,t,n){t.status="fulfilled",t.value=n,sf(t),s.state=n,t=s.pending,t!==null&&(n=t.next,n===t?s.pending=null:(n=n.next,t.next=n,Zh(s,n)))}function Nu(s,t,n){var i=s.pending;if(s.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,sf(t),t=t.next;while(t!==i)}s.action=null}function sf(s){s=s.listeners;for(var t=0;t<s.length;t++)(0,s[t])()}function tf(s,t){return t}function af(s,t){if(Bs){var n=mt.formState;if(n!==null){e:{var i=ks;if(Bs){if(vt){s:{for(var o=vt,x=Qa;o.nodeType!==8;){if(!x){o=null;break s}if(o=Ja(o.nextSibling),o===null){o=null;break s}}x=o.data,o=x==="F!"||x==="F"?o:null}if(o){vt=Ja(o.nextSibling),i=o.data==="F!";break e}}Ql(i)}i=!1}i&&(t=n[0])}}return n=da(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tf,lastRenderedState:t},n.queue=i,n=wf.bind(null,ks,i),i.dispatch=n,i=vu(!1),x=ku.bind(null,ks,!1,i.queue),i=da(),o={state:t,dispatch:null,action:s,pending:null},i.queue=o,n=Fy.bind(null,ks,o,x,n),o.dispatch=n,i.memoizedState=s,[t,n,!1]}function lf(s){var t=Ot();return nf(t,ct,s)}function nf(s,t,n){if(t=gu(s,t,tf)[0],s=Yc(_l)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=wi(t)}catch(v){throw v===wr?Bc:v}else i=t;t=Ot();var o=t.queue,x=o.dispatch;return n!==t.memoizedState&&(ks.flags|=2048,Tr(9,{destroy:void 0},Hy.bind(null,o,n),null)),[i,x,s]}function Hy(s,t){s.action=t}function rf(s){var t=Ot(),n=ct;if(n!==null)return nf(t,n,s);Ot(),t=t.memoizedState,n=Ot();var i=n.queue.dispatch;return n.memoizedState=s,[t,i,!1]}function Tr(s,t,n,i){return s={tag:s,create:n,deps:i,inst:t,next:null},t=ks.updateQueue,t===null&&(t=Kc(),ks.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=s.next=s:(i=n.next,n.next=s,s.next=i,t.lastEffect=s),s}function cf(){return Ot().memoizedState}function Jc(s,t,n,i){var o=da();ks.flags|=s,o.memoizedState=Tr(1|t,{destroy:void 0},n,i===void 0?null:i)}function Xc(s,t,n,i){var o=Ot();i=i===void 0?null:i;var x=o.memoizedState.inst;ct!==null&&i!==null&&uu(i,ct.memoizedState.deps)?o.memoizedState=Tr(t,x,n,i):(ks.flags|=s,o.memoizedState=Tr(1|t,x,n,i))}function of(s,t){Jc(8390656,8,s,t)}function bu(s,t){Xc(2048,8,s,t)}function qy(s){ks.flags|=4;var t=ks.updateQueue;if(t===null)t=Kc(),ks.updateQueue=t,t.events=[s];else{var n=t.events;n===null?t.events=[s]:n.push(s)}}function df(s){var t=Ot().memoizedState;return qy({ref:t,nextImpl:s}),function(){if((Xs&2)!==0)throw Error(c(440));return t.impl.apply(void 0,arguments)}}function uf(s,t){return Xc(4,2,s,t)}function mf(s,t){return Xc(4,4,s,t)}function xf(s,t){if(typeof t=="function"){s=s();var n=t(s);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return s=s(),t.current=s,function(){t.current=null}}function hf(s,t,n){n=n!=null?n.concat([s]):null,Xc(4,4,xf.bind(null,t,s),n)}function yu(){}function ff(s,t){var n=Ot();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&uu(t,i[1])?i[0]:(n.memoizedState=[s,t],s)}function pf(s,t){var n=Ot();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&uu(t,i[1]))return i[0];if(i=s(),Pn){ts(!0);try{s()}finally{ts(!1)}}return n.memoizedState=[i,t],i}function wu(s,t,n){return n===void 0||(wl&1073741824)!==0&&(Us&261930)===0?s.memoizedState=t:(s.memoizedState=n,s=gp(),ks.lanes|=s,an|=s,n)}function gf(s,t,n,i){return Ca(n,t)?n:Sr.current!==null?(s=wu(s,n,i),Ca(s,t)||(It=!0),s):(wl&42)===0||(wl&1073741824)!==0&&(Us&261930)===0?(It=!0,s.memoizedState=n):(s=gp(),ks.lanes|=s,an|=s,t)}function jf(s,t,n,i,o){var x=K.p;K.p=x!==0&&8>x?x:8;var v=D.T,k={};D.T=k,ku(s,!1,t,n);try{var I=o(),ie=D.S;if(ie!==null&&ie(k,I),I!==null&&typeof I=="object"&&typeof I.then=="function"){var ve=By(I,i);_i(s,t,ve,Ra(s))}else _i(s,t,i,Ra(s))}catch(we){_i(s,t,{then:function(){},status:"rejected",reason:we},Ra())}finally{K.p=x,v!==null&&k.types!==null&&(v.types=k.types),D.T=v}}function Vy(){}function _u(s,t,n,i){if(s.tag!==5)throw Error(c(476));var o=vf(s).queue;jf(s,o,t,B,n===null?Vy:function(){return Nf(s),n(i)})}function vf(s){var t=s.memoizedState;if(t!==null)return t;t={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:B},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:n},next:null},s.memoizedState=t,s=s.alternate,s!==null&&(s.memoizedState=t),t}function Nf(s){var t=vf(s);t.next===null&&(t=s.alternate.memoizedState),_i(s,t.next.queue,{},Ra())}function Su(){return Wt(Pi)}function bf(){return Ot().memoizedState}function yf(){return Ot().memoizedState}function Gy(s){for(var t=s.return;t!==null;){switch(t.tag){case 24:case 3:var n=Ra();s=Xl(n);var i=Zl(t,s,n);i!==null&&(ba(i,t,n),vi(i,t,n)),t={cache:eu()},s.payload=t;return}t=t.return}}function Ky(s,t,n){var i=Ra();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Zc(s)?_f(t,n):(n=Hd(s,t,n,i),n!==null&&(ba(n,s,i),Sf(n,t,i)))}function wf(s,t,n){var i=Ra();_i(s,t,n,i)}function _i(s,t,n,i){var o={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zc(s))_f(t,o);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=t.lastRenderedReducer,x!==null))try{var v=t.lastRenderedState,k=x(v,n);if(o.hasEagerState=!0,o.eagerState=k,Ca(k,v))return zc(s,t,o,0),mt===null&&Ac(),!1}catch{}finally{}if(n=Hd(s,t,o,i),n!==null)return ba(n,s,i),Sf(n,t,i),!0}return!1}function ku(s,t,n,i){if(i={lane:2,revertLane:lm(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Zc(s)){if(t)throw Error(c(479))}else t=Hd(s,n,i,2),t!==null&&ba(t,s,2)}function Zc(s){var t=s.alternate;return s===ks||t!==null&&t===ks}function _f(s,t){kr=Vc=!0;var n=s.pending;n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t}function Sf(s,t,n){if((n&4194048)!==0){var i=t.lanes;i&=s.pendingLanes,n|=i,t.lanes=n,ds(s,n)}}var Si={readContext:Wt,use:Qc,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useLayoutEffect:Et,useInsertionEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useSyncExternalStore:Et,useId:Et,useHostTransitionStatus:Et,useFormState:Et,useActionState:Et,useOptimistic:Et,useMemoCache:Et,useCacheRefresh:Et};Si.useEffectEvent=Et;var kf={readContext:Wt,use:Qc,useCallback:function(s,t){return da().memoizedState=[s,t===void 0?null:t],s},useContext:Wt,useEffect:of,useImperativeHandle:function(s,t,n){n=n!=null?n.concat([s]):null,Jc(4194308,4,xf.bind(null,t,s),n)},useLayoutEffect:function(s,t){return Jc(4194308,4,s,t)},useInsertionEffect:function(s,t){Jc(4,2,s,t)},useMemo:function(s,t){var n=da();t=t===void 0?null:t;var i=s();if(Pn){ts(!0);try{s()}finally{ts(!1)}}return n.memoizedState=[i,t],i},useReducer:function(s,t,n){var i=da();if(n!==void 0){var o=n(t);if(Pn){ts(!0);try{n(t)}finally{ts(!1)}}}else o=t;return i.memoizedState=i.baseState=o,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},i.queue=s,s=s.dispatch=Ky.bind(null,ks,s),[i.memoizedState,s]},useRef:function(s){var t=da();return s={current:s},t.memoizedState=s},useState:function(s){s=vu(s);var t=s.queue,n=wf.bind(null,ks,t);return t.dispatch=n,[s.memoizedState,n]},useDebugValue:yu,useDeferredValue:function(s,t){var n=da();return wu(n,s,t)},useTransition:function(){var s=vu(!1);return s=jf.bind(null,ks,s.queue,!0,!1),da().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,t,n){var i=ks,o=da();if(Bs){if(n===void 0)throw Error(c(407));n=n()}else{if(n=t(),mt===null)throw Error(c(349));(Us&127)!==0||Gh(i,t,n)}o.memoizedState=n;var x={value:n,getSnapshot:t};return o.queue=x,of(Qh.bind(null,i,x,s),[s]),i.flags|=2048,Tr(9,{destroy:void 0},Kh.bind(null,i,x,n,t),null),n},useId:function(){var s=da(),t=mt.identifierPrefix;if(Bs){var n=ol,i=cl;n=(i&~(1<<32-_s(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Gc++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Iy++,t="_"+t+"r_"+n.toString(32)+"_";return s.memoizedState=t},useHostTransitionStatus:Su,useFormState:af,useActionState:af,useOptimistic:function(s){var t=da();t.memoizedState=t.baseState=s;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ku.bind(null,ks,!0,n),n.dispatch=t,[s,t]},useMemoCache:pu,useCacheRefresh:function(){return da().memoizedState=Gy.bind(null,ks)},useEffectEvent:function(s){var t=da(),n={impl:s};return t.memoizedState=n,function(){if((Xs&2)!==0)throw Error(c(440));return n.impl.apply(void 0,arguments)}}},Cu={readContext:Wt,use:Qc,useCallback:ff,useContext:Wt,useEffect:bu,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:mf,useMemo:pf,useReducer:Yc,useRef:cf,useState:function(){return Yc(_l)},useDebugValue:yu,useDeferredValue:function(s,t){var n=Ot();return gf(n,ct.memoizedState,s,t)},useTransition:function(){var s=Yc(_l)[0],t=Ot().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Vh,useId:bf,useHostTransitionStatus:Su,useFormState:lf,useActionState:lf,useOptimistic:function(s,t){var n=Ot();return Xh(n,ct,s,t)},useMemoCache:pu,useCacheRefresh:yf};Cu.useEffectEvent=df;var Cf={readContext:Wt,use:Qc,useCallback:ff,useContext:Wt,useEffect:bu,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:mf,useMemo:pf,useReducer:ju,useRef:cf,useState:function(){return ju(_l)},useDebugValue:yu,useDeferredValue:function(s,t){var n=Ot();return ct===null?wu(n,s,t):gf(n,ct.memoizedState,s,t)},useTransition:function(){var s=ju(_l)[0],t=Ot().memoizedState;return[typeof s=="boolean"?s:wi(s),t]},useSyncExternalStore:Vh,useId:bf,useHostTransitionStatus:Su,useFormState:rf,useActionState:rf,useOptimistic:function(s,t){var n=Ot();return ct!==null?Xh(n,ct,s,t):(n.baseState=s,[s,n.queue.dispatch])},useMemoCache:pu,useCacheRefresh:yf};Cf.useEffectEvent=df;function Tu(s,t,n,i){t=s.memoizedState,n=n(i,t),n=n==null?t:j({},t,n),s.memoizedState=n,s.lanes===0&&(s.updateQueue.baseState=n)}var Eu={enqueueSetState:function(s,t,n){s=s._reactInternals;var i=Ra(),o=Xl(i);o.payload=t,n!=null&&(o.callback=n),t=Zl(s,o,i),t!==null&&(ba(t,s,i),vi(t,s,i))},enqueueReplaceState:function(s,t,n){s=s._reactInternals;var i=Ra(),o=Xl(i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Zl(s,o,i),t!==null&&(ba(t,s,i),vi(t,s,i))},enqueueForceUpdate:function(s,t){s=s._reactInternals;var n=Ra(),i=Xl(n);i.tag=2,t!=null&&(i.callback=t),t=Zl(s,i,n),t!==null&&(ba(t,s,n),vi(t,s,n))}};function Tf(s,t,n,i,o,x,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(i,x,v):t.prototype&&t.prototype.isPureReactComponent?!ui(n,i)||!ui(o,x):!0}function Ef(s,t,n,i){s=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==s&&Eu.enqueueReplaceState(t,t.state,null)}function Fn(s,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(s=s.defaultProps){n===t&&(n=j({},n));for(var o in s)n[o]===void 0&&(n[o]=s[o])}return n}function Mf(s){Mc(s)}function Af(s){console.error(s)}function zf(s){Mc(s)}function Wc(s,t){try{var n=s.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Rf(s,t,n){try{var i=s.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function Mu(s,t,n){return n=Xl(n),n.tag=3,n.payload={element:null},n.callback=function(){Wc(s,t)},n}function Df(s){return s=Xl(s),s.tag=3,s}function Of(s,t,n,i){var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var x=i.value;s.payload=function(){return o(x)},s.callback=function(){Rf(t,n,i)}}var v=n.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){Rf(t,n,i),typeof o!="function"&&(ln===null?ln=new Set([this]):ln.add(this));var k=i.stack;this.componentDidCatch(i.value,{componentStack:k!==null?k:""})})}function Qy(s,t,n,i,o){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Nr(t,n,o,!0),n=Ea.current,n!==null){switch(n.tag){case 31:case 13:return Ya===null?mo():n.alternate===null&&Mt===0&&(Mt=3),n.flags&=-257,n.flags|=65536,n.lanes=o,i===Ic?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),sm(s,i,o)),!1;case 22:return n.flags|=65536,i===Ic?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),sm(s,i,o)),!1}throw Error(c(435,n.tag))}return sm(s,i,o),mo(),!1}if(Bs)return t=Ea.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,i!==Yd&&(s=Error(c(422),{cause:i}),hi(Va(s,n)))):(i!==Yd&&(t=Error(c(423),{cause:i}),hi(Va(t,n))),s=s.current.alternate,s.flags|=65536,o&=-o,s.lanes|=o,i=Va(i,n),o=Mu(s.stateNode,i,o),ru(s,o),Mt!==4&&(Mt=2)),!1;var x=Error(c(520),{cause:i});if(x=Va(x,n),Ri===null?Ri=[x]:Ri.push(x),Mt!==4&&(Mt=2),t===null)return!0;i=Va(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,s=o&-o,n.lanes|=s,s=Mu(n.stateNode,i,s),ru(n,s),!1;case 1:if(t=n.type,x=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ln===null||!ln.has(x))))return n.flags|=65536,o&=-o,n.lanes|=o,o=Df(o),Of(o,s,n,i),ru(n,o),!1}n=n.return}while(n!==null);return!1}var Au=Error(c(461)),It=!1;function ea(s,t,n,i){t.child=s===null?$h(t,null,n,i):In(t,s.child,n,i)}function Lf(s,t,n,i,o){n=n.render;var x=t.ref;if("ref"in i){var v={};for(var k in i)k!=="ref"&&(v[k]=i[k])}else v=i;return Ln(t),i=mu(s,t,n,v,x,o),k=xu(),s!==null&&!It?(hu(s,t,o),Sl(s,t,o)):(Bs&&k&&Kd(t),t.flags|=1,ea(s,t,i,o),t.child)}function Uf(s,t,n,i,o){if(s===null){var x=n.type;return typeof x=="function"&&!qd(x)&&x.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=x,$f(s,t,x,i,o)):(s=Dc(n.type,null,i,t,t.mode,o),s.ref=t.ref,s.return=t,t.child=s)}if(x=s.child,!Bu(s,o)){var v=x.memoizedProps;if(n=n.compare,n=n!==null?n:ui,n(v,i)&&s.ref===t.ref)return Sl(s,t,o)}return t.flags|=1,s=vl(x,i),s.ref=t.ref,s.return=t,t.child=s}function $f(s,t,n,i,o){if(s!==null){var x=s.memoizedProps;if(ui(x,i)&&s.ref===t.ref)if(It=!1,t.pendingProps=i=x,Bu(s,o))(s.flags&131072)!==0&&(It=!0);else return t.lanes=s.lanes,Sl(s,t,o)}return zu(s,t,n,i,o)}function Bf(s,t,n,i){var o=i.children,x=s!==null?s.memoizedState:null;if(s===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(x=x!==null?x.baseLanes|n:n,s!==null){for(i=t.child=s.child,o=0;i!==null;)o=o|i.lanes|i.childLanes,i=i.sibling;i=o&~x}else i=0,t.child=null;return If(s,t,x,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},s!==null&&$c(t,x!==null?x.cachePool:null),x!==null?Ph(t,x):cu(),Fh(t);else return i=t.lanes=536870912,If(s,t,x!==null?x.baseLanes|n:n,n,i)}else x!==null?($c(t,x.cachePool),Ph(t,x),en(),t.memoizedState=null):(s!==null&&$c(t,null),cu(),en());return ea(s,t,o,n),t.child}function ki(s,t){return s!==null&&s.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function If(s,t,n,i,o){var x=tu();return x=x===null?null:{parent:$t._currentValue,pool:x},t.memoizedState={baseLanes:n,cachePool:x},s!==null&&$c(t,null),cu(),Fh(t),s!==null&&Nr(s,t,i,!0),t.childLanes=o,null}function eo(s,t){return t=to({mode:t.mode,children:t.children},s.mode),t.ref=s.ref,s.child=t,t.return=s,t}function Pf(s,t,n){return In(t,s.child,null,n),s=eo(t,t.pendingProps),s.flags|=2,Ma(t),t.memoizedState=null,s}function Yy(s,t,n){var i=t.pendingProps,o=(t.flags&128)!==0;if(t.flags&=-129,s===null){if(Bs){if(i.mode==="hidden")return s=eo(t,i),t.lanes=536870912,ki(null,s);if(du(t),(s=vt)?(s=Wp(s,Qa),s=s!==null&&s.data==="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Gl!==null?{id:cl,overflow:ol}:null,retryLane:536870912,hydrationErrors:null},n=wh(s),n.return=t,t.child=n,Zt=t,vt=null)):s=null,s===null)throw Ql(t);return t.lanes=536870912,null}return eo(t,i)}var x=s.memoizedState;if(x!==null){var v=x.dehydrated;if(du(t),o)if(t.flags&256)t.flags&=-257,t=Pf(s,t,n);else if(t.memoizedState!==null)t.child=s.child,t.flags|=128,t=null;else throw Error(c(558));else if(It||Nr(s,t,n,!1),o=(n&s.childLanes)!==0,It||o){if(i=mt,i!==null&&(v=is(i,n),v!==0&&v!==x.retryLane))throw x.retryLane=v,zn(s,v),ba(i,s,v),Au;mo(),t=Pf(s,t,n)}else s=x.treeContext,vt=Ja(v.nextSibling),Zt=t,Bs=!0,Kl=null,Qa=!1,s!==null&&kh(t,s),t=eo(t,i),t.flags|=4096;return t}return s=vl(s.child,{mode:i.mode,children:i.children}),s.ref=t.ref,t.child=s,s.return=t,s}function so(s,t){var n=t.ref;if(n===null)s!==null&&s.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(c(284));(s===null||s.ref!==n)&&(t.flags|=4194816)}}function zu(s,t,n,i,o){return Ln(t),n=mu(s,t,n,i,void 0,o),i=xu(),s!==null&&!It?(hu(s,t,o),Sl(s,t,o)):(Bs&&i&&Kd(t),t.flags|=1,ea(s,t,n,o),t.child)}function Ff(s,t,n,i,o,x){return Ln(t),t.updateQueue=null,n=qh(t,i,n,o),Hh(s),i=xu(),s!==null&&!It?(hu(s,t,x),Sl(s,t,x)):(Bs&&i&&Kd(t),t.flags|=1,ea(s,t,n,x),t.child)}function Hf(s,t,n,i,o){if(Ln(t),t.stateNode===null){var x=pr,v=n.contextType;typeof v=="object"&&v!==null&&(x=Wt(v)),x=new n(i,x),t.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Eu,t.stateNode=x,x._reactInternals=t,x=t.stateNode,x.props=i,x.state=t.memoizedState,x.refs={},lu(t),v=n.contextType,x.context=typeof v=="object"&&v!==null?Wt(v):pr,x.state=t.memoizedState,v=n.getDerivedStateFromProps,typeof v=="function"&&(Tu(t,n,v,i),x.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(v=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),v!==x.state&&Eu.enqueueReplaceState(x,x.state,null),bi(t,i,x,o),Ni(),x.state=t.memoizedState),typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(s===null){x=t.stateNode;var k=t.memoizedProps,I=Fn(n,k);x.props=I;var ie=x.context,ve=n.contextType;v=pr,typeof ve=="object"&&ve!==null&&(v=Wt(ve));var we=n.getDerivedStateFromProps;ve=typeof we=="function"||typeof x.getSnapshotBeforeUpdate=="function",k=t.pendingProps!==k,ve||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(k||ie!==v)&&Ef(t,x,i,v),Jl=!1;var oe=t.memoizedState;x.state=oe,bi(t,i,x,o),Ni(),ie=t.memoizedState,k||oe!==ie||Jl?(typeof we=="function"&&(Tu(t,n,we,i),ie=t.memoizedState),(I=Jl||Tf(t,n,I,i,oe,ie,v))?(ve||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=ie),x.props=i,x.state=ie,x.context=v,i=I):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{x=t.stateNode,nu(s,t),v=t.memoizedProps,ve=Fn(n,v),x.props=ve,we=t.pendingProps,oe=x.context,ie=n.contextType,I=pr,typeof ie=="object"&&ie!==null&&(I=Wt(ie)),k=n.getDerivedStateFromProps,(ie=typeof k=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(v!==we||oe!==I)&&Ef(t,x,i,I),Jl=!1,oe=t.memoizedState,x.state=oe,bi(t,i,x,o),Ni();var xe=t.memoizedState;v!==we||oe!==xe||Jl||s!==null&&s.dependencies!==null&&Lc(s.dependencies)?(typeof k=="function"&&(Tu(t,n,k,i),xe=t.memoizedState),(ve=Jl||Tf(t,n,ve,i,oe,xe,I)||s!==null&&s.dependencies!==null&&Lc(s.dependencies))?(ie||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(i,xe,I),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(i,xe,I)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=xe),x.props=i,x.state=xe,x.context=I,i=ve):(typeof x.componentDidUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&oe===s.memoizedState||(t.flags|=1024),i=!1)}return x=i,so(s,t),i=(t.flags&128)!==0,x||i?(x=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:x.render(),t.flags|=1,s!==null&&i?(t.child=In(t,s.child,null,o),t.child=In(t,null,n,o)):ea(s,t,n,o),t.memoizedState=x.state,s=t.child):s=Sl(s,t,o),s}function qf(s,t,n,i){return Dn(),t.flags|=256,ea(s,t,n,i),t.child}var Ru={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Du(s){return{baseLanes:s,cachePool:zh()}}function Ou(s,t,n){return s=s!==null?s.childLanes&~n:0,t&&(s|=za),s}function Vf(s,t,n){var i=t.pendingProps,o=!1,x=(t.flags&128)!==0,v;if((v=x)||(v=s!==null&&s.memoizedState===null?!1:(Dt.current&2)!==0),v&&(o=!0,t.flags&=-129),v=(t.flags&32)!==0,t.flags&=-33,s===null){if(Bs){if(o?Wl(t):en(),(s=vt)?(s=Wp(s,Qa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Gl!==null?{id:cl,overflow:ol}:null,retryLane:536870912,hydrationErrors:null},n=wh(s),n.return=t,t.child=n,Zt=t,vt=null)):s=null,s===null)throw Ql(t);return gm(s)?t.lanes=32:t.lanes=536870912,null}var k=i.children;return i=i.fallback,o?(en(),o=t.mode,k=to({mode:"hidden",children:k},o),i=Rn(i,o,n,null),k.return=t,i.return=t,k.sibling=i,t.child=k,i=t.child,i.memoizedState=Du(n),i.childLanes=Ou(s,v,n),t.memoizedState=Ru,ki(null,i)):(Wl(t),Lu(t,k))}var I=s.memoizedState;if(I!==null&&(k=I.dehydrated,k!==null)){if(x)t.flags&256?(Wl(t),t.flags&=-257,t=Uu(s,t,n)):t.memoizedState!==null?(en(),t.child=s.child,t.flags|=128,t=null):(en(),k=i.fallback,o=t.mode,i=to({mode:"visible",children:i.children},o),k=Rn(k,o,n,null),k.flags|=2,i.return=t,k.return=t,i.sibling=k,t.child=i,In(t,s.child,null,n),i=t.child,i.memoizedState=Du(n),i.childLanes=Ou(s,v,n),t.memoizedState=Ru,t=ki(null,i));else if(Wl(t),gm(k)){if(v=k.nextSibling&&k.nextSibling.dataset,v)var ie=v.dgst;v=ie,i=Error(c(419)),i.stack="",i.digest=v,hi({value:i,source:null,stack:null}),t=Uu(s,t,n)}else if(It||Nr(s,t,n,!1),v=(n&s.childLanes)!==0,It||v){if(v=mt,v!==null&&(i=is(v,n),i!==0&&i!==I.retryLane))throw I.retryLane=i,zn(s,i),ba(v,s,i),Au;pm(k)||mo(),t=Uu(s,t,n)}else pm(k)?(t.flags|=192,t.child=s.child,t=null):(s=I.treeContext,vt=Ja(k.nextSibling),Zt=t,Bs=!0,Kl=null,Qa=!1,s!==null&&kh(t,s),t=Lu(t,i.children),t.flags|=4096);return t}return o?(en(),k=i.fallback,o=t.mode,I=s.child,ie=I.sibling,i=vl(I,{mode:"hidden",children:i.children}),i.subtreeFlags=I.subtreeFlags&65011712,ie!==null?k=vl(ie,k):(k=Rn(k,o,n,null),k.flags|=2),k.return=t,i.return=t,i.sibling=k,t.child=i,ki(null,i),i=t.child,k=s.child.memoizedState,k===null?k=Du(n):(o=k.cachePool,o!==null?(I=$t._currentValue,o=o.parent!==I?{parent:I,pool:I}:o):o=zh(),k={baseLanes:k.baseLanes|n,cachePool:o}),i.memoizedState=k,i.childLanes=Ou(s,v,n),t.memoizedState=Ru,ki(s.child,i)):(Wl(t),n=s.child,s=n.sibling,n=vl(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,s!==null&&(v=t.deletions,v===null?(t.deletions=[s],t.flags|=16):v.push(s)),t.child=n,t.memoizedState=null,n)}function Lu(s,t){return t=to({mode:"visible",children:t},s.mode),t.return=s,s.child=t}function to(s,t){return s=Ta(22,s,null,t),s.lanes=0,s}function Uu(s,t,n){return In(t,s.child,null,n),s=Lu(t,t.pendingProps.children),s.flags|=2,t.memoizedState=null,s}function Gf(s,t,n){s.lanes|=t;var i=s.alternate;i!==null&&(i.lanes|=t),Zd(s.return,t,n)}function $u(s,t,n,i,o,x){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o,treeForkCount:x}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=i,v.tail=n,v.tailMode=o,v.treeForkCount=x)}function Kf(s,t,n){var i=t.pendingProps,o=i.revealOrder,x=i.tail;i=i.children;var v=Dt.current,k=(v&2)!==0;if(k?(v=v&1|2,t.flags|=128):v&=1,Te(Dt,v),ea(s,t,i,n),i=Bs?xi:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=t.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Gf(s,n,t);else if(s.tag===19)Gf(s,n,t);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(o){case"forwards":for(n=t.child,o=null;n!==null;)s=n.alternate,s!==null&&qc(s)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),$u(t,!1,o,n,x,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(s=o.alternate,s!==null&&qc(s)===null){t.child=o;break}s=o.sibling,o.sibling=n,n=o,o=s}$u(t,!0,n,null,x,i);break;case"together":$u(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function Sl(s,t,n){if(s!==null&&(t.dependencies=s.dependencies),an|=t.lanes,(n&t.childLanes)===0)if(s!==null){if(Nr(s,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(s!==null&&t.child!==s.child)throw Error(c(153));if(t.child!==null){for(s=t.child,n=vl(s,s.pendingProps),t.child=n,n.return=t;s.sibling!==null;)s=s.sibling,n=n.sibling=vl(s,s.pendingProps),n.return=t;n.sibling=null}return t.child}function Bu(s,t){return(s.lanes&t)!==0?!0:(s=s.dependencies,!!(s!==null&&Lc(s)))}function Jy(s,t,n){switch(t.tag){case 3:Re(t,t.stateNode.containerInfo),Yl(t,$t,s.memoizedState.cache),Dn();break;case 27:case 5:Oe(t);break;case 4:Re(t,t.stateNode.containerInfo);break;case 10:Yl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,du(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Wl(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Vf(s,t,n):(Wl(t),s=Sl(s,t,n),s!==null?s.sibling:null);Wl(t);break;case 19:var o=(s.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Nr(s,t,n,!1),i=(n&t.childLanes)!==0),o){if(i)return Kf(s,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Te(Dt,Dt.current),i)break;return null;case 22:return t.lanes=0,Bf(s,t,n,t.pendingProps);case 24:Yl(t,$t,s.memoizedState.cache)}return Sl(s,t,n)}function Qf(s,t,n){if(s!==null)if(s.memoizedProps!==t.pendingProps)It=!0;else{if(!Bu(s,n)&&(t.flags&128)===0)return It=!1,Jy(s,t,n);It=(s.flags&131072)!==0}else It=!1,Bs&&(t.flags&1048576)!==0&&Sh(t,xi,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(s=$n(t.elementType),t.type=s,typeof s=="function")qd(s)?(i=Fn(s,i),t.tag=1,t=Hf(null,t,s,i,n)):(t.tag=0,t=zu(null,t,s,i,n));else{if(s!=null){var o=s.$$typeof;if(o===C){t.tag=11,t=Lf(null,t,s,i,n);break e}else if(o===O){t.tag=14,t=Uf(null,t,s,i,n);break e}}throw t=ge(s)||s,Error(c(306,t,""))}}return t;case 0:return zu(s,t,t.type,t.pendingProps,n);case 1:return i=t.type,o=Fn(i,t.pendingProps),Hf(s,t,i,o,n);case 3:e:{if(Re(t,t.stateNode.containerInfo),s===null)throw Error(c(387));i=t.pendingProps;var x=t.memoizedState;o=x.element,nu(s,t),bi(t,i,null,n);var v=t.memoizedState;if(i=v.cache,Yl(t,$t,i),i!==x.cache&&Wd(t,[$t],n,!0),Ni(),i=v.element,x.isDehydrated)if(x={element:i,isDehydrated:!1,cache:v.cache},t.updateQueue.baseState=x,t.memoizedState=x,t.flags&256){t=qf(s,t,i,n);break e}else if(i!==o){o=Va(Error(c(424)),t),hi(o),t=qf(s,t,i,n);break e}else{switch(s=t.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(vt=Ja(s.firstChild),Zt=t,Bs=!0,Kl=null,Qa=!0,n=$h(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Dn(),i===o){t=Sl(s,t,n);break e}ea(s,t,i,n)}t=t.child}return t;case 26:return so(s,t),s===null?(n=ng(t.type,null,t.pendingProps,null))?t.memoizedState=n:Bs||(n=t.type,s=t.pendingProps,i=vo(z.current).createElement(n),i[Ss]=t,i[hs]=s,sa(i,n,s),Gt(i),t.stateNode=i):t.memoizedState=ng(t.type,s.memoizedProps,t.pendingProps,s.memoizedState),null;case 27:return Oe(t),s===null&&Bs&&(i=t.stateNode=tg(t.type,t.pendingProps,z.current),Zt=t,Qa=!0,o=vt,on(t.type)?(jm=o,vt=Ja(i.firstChild)):vt=o),ea(s,t,t.pendingProps.children,n),so(s,t),s===null&&(t.flags|=4194304),t.child;case 5:return s===null&&Bs&&((o=i=vt)&&(i=k0(i,t.type,t.pendingProps,Qa),i!==null?(t.stateNode=i,Zt=t,vt=Ja(i.firstChild),Qa=!1,o=!0):o=!1),o||Ql(t)),Oe(t),o=t.type,x=t.pendingProps,v=s!==null?s.memoizedProps:null,i=x.children,xm(o,x)?i=null:v!==null&&xm(o,v)&&(t.flags|=32),t.memoizedState!==null&&(o=mu(s,t,Py,null,null,n),Pi._currentValue=o),so(s,t),ea(s,t,i,n),t.child;case 6:return s===null&&Bs&&((s=n=vt)&&(n=C0(n,t.pendingProps,Qa),n!==null?(t.stateNode=n,Zt=t,vt=null,s=!0):s=!1),s||Ql(t)),null;case 13:return Vf(s,t,n);case 4:return Re(t,t.stateNode.containerInfo),i=t.pendingProps,s===null?t.child=In(t,null,i,n):ea(s,t,i,n),t.child;case 11:return Lf(s,t,t.type,t.pendingProps,n);case 7:return ea(s,t,t.pendingProps,n),t.child;case 8:return ea(s,t,t.pendingProps.children,n),t.child;case 12:return ea(s,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,Yl(t,t.type,i.value),ea(s,t,i.children,n),t.child;case 9:return o=t.type._context,i=t.pendingProps.children,Ln(t),o=Wt(o),i=i(o),t.flags|=1,ea(s,t,i,n),t.child;case 14:return Uf(s,t,t.type,t.pendingProps,n);case 15:return $f(s,t,t.type,t.pendingProps,n);case 19:return Kf(s,t,n);case 31:return Yy(s,t,n);case 22:return Bf(s,t,n,t.pendingProps);case 24:return Ln(t),i=Wt($t),s===null?(o=tu(),o===null&&(o=mt,x=eu(),o.pooledCache=x,x.refCount++,x!==null&&(o.pooledCacheLanes|=n),o=x),t.memoizedState={parent:i,cache:o},lu(t),Yl(t,$t,o)):((s.lanes&n)!==0&&(nu(s,t),bi(t,null,null,n),Ni()),o=s.memoizedState,x=t.memoizedState,o.parent!==i?(o={parent:i,cache:i},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),Yl(t,$t,i)):(i=x.cache,Yl(t,$t,i),i!==o.cache&&Wd(t,[$t],n,!0))),ea(s,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(c(156,t.tag))}function kl(s){s.flags|=4}function Iu(s,t,n,i,o){if((t=(s.mode&32)!==0)&&(t=!1),t){if(s.flags|=16777216,(o&335544128)===o)if(s.stateNode.complete)s.flags|=8192;else if(bp())s.flags|=8192;else throw Bn=Ic,au}else s.flags&=-16777217}function Yf(s,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!dg(t))if(bp())s.flags|=8192;else throw Bn=Ic,au}function ao(s,t){t!==null&&(s.flags|=4),s.flags&16384&&(t=s.tag!==22?te():536870912,s.lanes|=t,zr|=t)}function Ci(s,t){if(!Bs)switch(s.tailMode){case"hidden":t=s.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?s.tail=null:n.sibling=null;break;case"collapsed":n=s.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||s.tail===null?s.tail=null:s.tail.sibling=null:i.sibling=null}}function Nt(s){var t=s.alternate!==null&&s.alternate.child===s.child,n=0,i=0;if(t)for(var o=s.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&65011712,i|=o.flags&65011712,o.return=s,o=o.sibling;else for(o=s.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=s,o=o.sibling;return s.subtreeFlags|=i,s.childLanes=n,t}function Xy(s,t,n){var i=t.pendingProps;switch(Qd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(t),null;case 1:return Nt(t),null;case 3:return n=t.stateNode,i=null,s!==null&&(i=s.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),yl($t),se(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(s===null||s.child===null)&&(vr(t)?kl(t):s===null||s.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Jd())),Nt(t),null;case 26:var o=t.type,x=t.memoizedState;return s===null?(kl(t),x!==null?(Nt(t),Yf(t,x)):(Nt(t),Iu(t,o,null,i,n))):x?x!==s.memoizedState?(kl(t),Nt(t),Yf(t,x)):(Nt(t),t.flags&=-16777217):(s=s.memoizedProps,s!==i&&kl(t),Nt(t),Iu(t,o,s,i,n)),null;case 27:if(ns(t),n=z.current,o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&kl(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return Nt(t),null}s=V.current,vr(t)?Ch(t):(s=tg(o,i,n),t.stateNode=s,kl(t))}return Nt(t),null;case 5:if(ns(t),o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==i&&kl(t);else{if(!i){if(t.stateNode===null)throw Error(c(166));return Nt(t),null}if(x=V.current,vr(t))Ch(t);else{var v=vo(z.current);switch(x){case 1:x=v.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:x=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":x=v.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":x=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":x=v.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof i.is=="string"?v.createElement("select",{is:i.is}):v.createElement("select"),i.multiple?x.multiple=!0:i.size&&(x.size=i.size);break;default:x=typeof i.is=="string"?v.createElement(o,{is:i.is}):v.createElement(o)}}x[Ss]=t,x[hs]=i;e:for(v=t.child;v!==null;){if(v.tag===5||v.tag===6)x.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}t.stateNode=x;e:switch(sa(x,o,i),o){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&kl(t)}}return Nt(t),Iu(t,t.type,s===null?null:s.memoizedProps,t.pendingProps,n),null;case 6:if(s&&t.stateNode!=null)s.memoizedProps!==i&&kl(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(c(166));if(s=z.current,vr(t)){if(s=t.stateNode,n=t.memoizedProps,i=null,o=Zt,o!==null)switch(o.tag){case 27:case 5:i=o.memoizedProps}s[Ss]=t,s=!!(s.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Vp(s.nodeValue,n)),s||Ql(t,!0)}else s=vo(s).createTextNode(i),s[Ss]=t,t.stateNode=s}return Nt(t),null;case 31:if(n=t.memoizedState,s===null||s.memoizedState!==null){if(i=vr(t),n!==null){if(s===null){if(!i)throw Error(c(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(557));s[Ss]=t}else Dn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Nt(t),s=!1}else n=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=n),s=!0;if(!s)return t.flags&256?(Ma(t),t):(Ma(t),null);if((t.flags&128)!==0)throw Error(c(558))}return Nt(t),null;case 13:if(i=t.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(o=vr(t),i!==null&&i.dehydrated!==null){if(s===null){if(!o)throw Error(c(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(c(317));o[Ss]=t}else Dn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Nt(t),o=!1}else o=Jd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(Ma(t),t):(Ma(t),null)}return Ma(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,s=s!==null&&s.memoizedState!==null,n&&(i=t.child,o=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(o=i.alternate.memoizedState.cachePool.pool),x=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(x=i.memoizedState.cachePool.pool),x!==o&&(i.flags|=2048)),n!==s&&n&&(t.child.flags|=8192),ao(t,t.updateQueue),Nt(t),null);case 4:return se(),s===null&&cm(t.stateNode.containerInfo),Nt(t),null;case 10:return yl(t.type),Nt(t),null;case 19:if(he(Dt),i=t.memoizedState,i===null)return Nt(t),null;if(o=(t.flags&128)!==0,x=i.rendering,x===null)if(o)Ci(i,!1);else{if(Mt!==0||s!==null&&(s.flags&128)!==0)for(s=t.child;s!==null;){if(x=qc(s),x!==null){for(t.flags|=128,Ci(i,!1),s=x.updateQueue,t.updateQueue=s,ao(t,s),t.subtreeFlags=0,s=n,n=t.child;n!==null;)yh(n,s),n=n.sibling;return Te(Dt,Dt.current&1|2),Bs&&Nl(t,i.treeForkCount),t.child}s=s.sibling}i.tail!==null&&Is()>co&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304)}else{if(!o)if(s=qc(x),s!==null){if(t.flags|=128,o=!0,s=s.updateQueue,t.updateQueue=s,ao(t,s),Ci(i,!0),i.tail===null&&i.tailMode==="hidden"&&!x.alternate&&!Bs)return Nt(t),null}else 2*Is()-i.renderingStartTime>co&&n!==536870912&&(t.flags|=128,o=!0,Ci(i,!1),t.lanes=4194304);i.isBackwards?(x.sibling=t.child,t.child=x):(s=i.last,s!==null?s.sibling=x:t.child=x,i.last=x)}return i.tail!==null?(s=i.tail,i.rendering=s,i.tail=s.sibling,i.renderingStartTime=Is(),s.sibling=null,n=Dt.current,Te(Dt,o?n&1|2:n&1),Bs&&Nl(t,i.treeForkCount),s):(Nt(t),null);case 22:case 23:return Ma(t),ou(),i=t.memoizedState!==null,s!==null?s.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(Nt(t),t.subtreeFlags&6&&(t.flags|=8192)):Nt(t),n=t.updateQueue,n!==null&&ao(t,n.retryQueue),n=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),s!==null&&he(Un),null;case 24:return n=null,s!==null&&(n=s.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),yl($t),Nt(t),null;case 25:return null;case 30:return null}throw Error(c(156,t.tag))}function Zy(s,t){switch(Qd(t),t.tag){case 1:return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 3:return yl($t),se(),s=t.flags,(s&65536)!==0&&(s&128)===0?(t.flags=s&-65537|128,t):null;case 26:case 27:case 5:return ns(t),null;case 31:if(t.memoizedState!==null){if(Ma(t),t.alternate===null)throw Error(c(340));Dn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 13:if(Ma(t),s=t.memoizedState,s!==null&&s.dehydrated!==null){if(t.alternate===null)throw Error(c(340));Dn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 19:return he(Dt),null;case 4:return se(),null;case 10:return yl(t.type),null;case 22:case 23:return Ma(t),ou(),s!==null&&he(Un),s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 24:return yl($t),null;case 25:return null;default:return null}}function Jf(s,t){switch(Qd(t),t.tag){case 3:yl($t),se();break;case 26:case 27:case 5:ns(t);break;case 4:se();break;case 31:t.memoizedState!==null&&Ma(t);break;case 13:Ma(t);break;case 19:he(Dt);break;case 10:yl(t.type);break;case 22:case 23:Ma(t),ou(),s!==null&&he(Un);break;case 24:yl($t)}}function Ti(s,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var o=i.next;n=o;do{if((n.tag&s)===s){i=void 0;var x=n.create,v=n.inst;i=x(),v.destroy=i}n=n.next}while(n!==o)}}catch(k){st(t,t.return,k)}}function sn(s,t,n){try{var i=t.updateQueue,o=i!==null?i.lastEffect:null;if(o!==null){var x=o.next;i=x;do{if((i.tag&s)===s){var v=i.inst,k=v.destroy;if(k!==void 0){v.destroy=void 0,o=t;var I=n,ie=k;try{ie()}catch(ve){st(o,I,ve)}}}i=i.next}while(i!==x)}}catch(ve){st(t,t.return,ve)}}function Xf(s){var t=s.updateQueue;if(t!==null){var n=s.stateNode;try{Ih(t,n)}catch(i){st(s,s.return,i)}}}function Zf(s,t,n){n.props=Fn(s.type,s.memoizedProps),n.state=s.memoizedState;try{n.componentWillUnmount()}catch(i){st(s,t,i)}}function Ei(s,t){try{var n=s.ref;if(n!==null){switch(s.tag){case 26:case 27:case 5:var i=s.stateNode;break;case 30:i=s.stateNode;break;default:i=s.stateNode}typeof n=="function"?s.refCleanup=n(i):n.current=i}}catch(o){st(s,t,o)}}function dl(s,t){var n=s.ref,i=s.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(o){st(s,t,o)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(o){st(s,t,o)}else n.current=null}function Wf(s){var t=s.type,n=s.memoizedProps,i=s.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(o){st(s,s.return,o)}}function Pu(s,t,n){try{var i=s.stateNode;N0(i,s.type,n,t),i[hs]=t}catch(o){st(s,s.return,o)}}function ep(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&on(s.type)||s.tag===4}function Fu(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||ep(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&on(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Hu(s,t,n){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(s,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(s),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=gl));else if(i!==4&&(i===27&&on(s.type)&&(n=s.stateNode,t=null),s=s.child,s!==null))for(Hu(s,t,n),s=s.sibling;s!==null;)Hu(s,t,n),s=s.sibling}function lo(s,t,n){var i=s.tag;if(i===5||i===6)s=s.stateNode,t?n.insertBefore(s,t):n.appendChild(s);else if(i!==4&&(i===27&&on(s.type)&&(n=s.stateNode),s=s.child,s!==null))for(lo(s,t,n),s=s.sibling;s!==null;)lo(s,t,n),s=s.sibling}function sp(s){var t=s.stateNode,n=s.memoizedProps;try{for(var i=s.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);sa(t,i,n),t[Ss]=s,t[hs]=n}catch(x){st(s,s.return,x)}}var Cl=!1,Pt=!1,qu=!1,tp=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Wy(s,t){if(s=s.containerInfo,um=ko,s=xh(s),Ud(s)){if("selectionStart"in s)var n={start:s.selectionStart,end:s.selectionEnd};else e:{n=(n=s.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,x=i.focusNode;i=i.focusOffset;try{n.nodeType,x.nodeType}catch{n=null;break e}var v=0,k=-1,I=-1,ie=0,ve=0,we=s,oe=null;s:for(;;){for(var xe;we!==n||o!==0&&we.nodeType!==3||(k=v+o),we!==x||i!==0&&we.nodeType!==3||(I=v+i),we.nodeType===3&&(v+=we.nodeValue.length),(xe=we.firstChild)!==null;)oe=we,we=xe;for(;;){if(we===s)break s;if(oe===n&&++ie===o&&(k=v),oe===x&&++ve===i&&(I=v),(xe=we.nextSibling)!==null)break;we=oe,oe=we.parentNode}we=xe}n=k===-1||I===-1?null:{start:k,end:I}}else n=null}n=n||{start:0,end:0}}else n=null;for(mm={focusedElem:s,selectionRange:n},ko=!1,Kt=t;Kt!==null;)if(t=Kt,s=t.child,(t.subtreeFlags&1028)!==0&&s!==null)s.return=t,Kt=s;else for(;Kt!==null;){switch(t=Kt,x=t.alternate,s=t.flags,t.tag){case 0:if((s&4)!==0&&(s=t.updateQueue,s=s!==null?s.events:null,s!==null))for(n=0;n<s.length;n++)o=s[n],o.ref.impl=o.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,n=t,o=x.memoizedProps,x=x.memoizedState,i=n.stateNode;try{var Ve=Fn(n.type,o);s=i.getSnapshotBeforeUpdate(Ve,x),i.__reactInternalSnapshotBeforeUpdate=s}catch(as){st(n,n.return,as)}}break;case 3:if((s&1024)!==0){if(s=t.stateNode.containerInfo,n=s.nodeType,n===9)fm(s);else if(n===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(c(163))}if(s=t.sibling,s!==null){s.return=t.return,Kt=s;break}Kt=t.return}}function ap(s,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:El(s,n),i&4&&Ti(5,n);break;case 1:if(El(s,n),i&4)if(s=n.stateNode,t===null)try{s.componentDidMount()}catch(v){st(n,n.return,v)}else{var o=Fn(n.type,t.memoizedProps);t=t.memoizedState;try{s.componentDidUpdate(o,t,s.__reactInternalSnapshotBeforeUpdate)}catch(v){st(n,n.return,v)}}i&64&&Xf(n),i&512&&Ei(n,n.return);break;case 3:if(El(s,n),i&64&&(s=n.updateQueue,s!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Ih(s,t)}catch(v){st(n,n.return,v)}}break;case 27:t===null&&i&4&&sp(n);case 26:case 5:El(s,n),t===null&&i&4&&Wf(n),i&512&&Ei(n,n.return);break;case 12:El(s,n);break;case 31:El(s,n),i&4&&rp(s,n);break;case 13:El(s,n),i&4&&ip(s,n),i&64&&(s=n.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(n=c0.bind(null,n),T0(s,n))));break;case 22:if(i=n.memoizedState!==null||Cl,!i){t=t!==null&&t.memoizedState!==null||Pt,o=Cl;var x=Pt;Cl=i,(Pt=t)&&!x?Ml(s,n,(n.subtreeFlags&8772)!==0):El(s,n),Cl=o,Pt=x}break;case 30:break;default:El(s,n)}}function lp(s){var t=s.alternate;t!==null&&(s.alternate=null,lp(t)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(t=s.stateNode,t!==null&&Nd(t)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var wt=null,ga=!1;function Tl(s,t,n){for(n=n.child;n!==null;)np(s,t,n),n=n.sibling}function np(s,t,n){if(cs&&typeof cs.onCommitFiberUnmount=="function")try{cs.onCommitFiberUnmount(Ks,n)}catch{}switch(n.tag){case 26:Pt||dl(n,t),Tl(s,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Pt||dl(n,t);var i=wt,o=ga;on(n.type)&&(wt=n.stateNode,ga=!1),Tl(s,t,n),$i(n.stateNode),wt=i,ga=o;break;case 5:Pt||dl(n,t);case 6:if(i=wt,o=ga,wt=null,Tl(s,t,n),wt=i,ga=o,wt!==null)if(ga)try{(wt.nodeType===9?wt.body:wt.nodeName==="HTML"?wt.ownerDocument.body:wt).removeChild(n.stateNode)}catch(x){st(n,t,x)}else try{wt.removeChild(n.stateNode)}catch(x){st(n,t,x)}break;case 18:wt!==null&&(ga?(s=wt,Xp(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,n.stateNode),Ir(s)):Xp(wt,n.stateNode));break;case 4:i=wt,o=ga,wt=n.stateNode.containerInfo,ga=!0,Tl(s,t,n),wt=i,ga=o;break;case 0:case 11:case 14:case 15:sn(2,n,t),Pt||sn(4,n,t),Tl(s,t,n);break;case 1:Pt||(dl(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Zf(n,t,i)),Tl(s,t,n);break;case 21:Tl(s,t,n);break;case 22:Pt=(i=Pt)||n.memoizedState!==null,Tl(s,t,n),Pt=i;break;default:Tl(s,t,n)}}function rp(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ir(s)}catch(n){st(t,t.return,n)}}}function ip(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ir(s)}catch(n){st(t,t.return,n)}}function e0(s){switch(s.tag){case 31:case 13:case 19:var t=s.stateNode;return t===null&&(t=s.stateNode=new tp),t;case 22:return s=s.stateNode,t=s._retryCache,t===null&&(t=s._retryCache=new tp),t;default:throw Error(c(435,s.tag))}}function no(s,t){var n=e0(s);t.forEach(function(i){if(!n.has(i)){n.add(i);var o=o0.bind(null,s,i);i.then(o,o)}})}function ja(s,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i],x=s,v=t,k=v;e:for(;k!==null;){switch(k.tag){case 27:if(on(k.type)){wt=k.stateNode,ga=!1;break e}break;case 5:wt=k.stateNode,ga=!1;break e;case 3:case 4:wt=k.stateNode.containerInfo,ga=!0;break e}k=k.return}if(wt===null)throw Error(c(160));np(x,v,o),wt=null,ga=!1,x=o.alternate,x!==null&&(x.return=null),o.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)cp(t,s),t=t.sibling}var al=null;function cp(s,t){var n=s.alternate,i=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ja(t,s),va(s),i&4&&(sn(3,s,s.return),Ti(3,s),sn(5,s,s.return));break;case 1:ja(t,s),va(s),i&512&&(Pt||n===null||dl(n,n.return)),i&64&&Cl&&(s=s.updateQueue,s!==null&&(i=s.callbacks,i!==null&&(n=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var o=al;if(ja(t,s),va(s),i&512&&(Pt||n===null||dl(n,n.return)),i&4){var x=n!==null?n.memoizedState:null;if(i=s.memoizedState,n===null)if(i===null)if(s.stateNode===null){e:{i=s.type,n=s.memoizedProps,o=o.ownerDocument||o;s:switch(i){case"title":x=o.getElementsByTagName("title")[0],(!x||x[Cn]||x[Ss]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=o.createElement(i),o.head.insertBefore(x,o.querySelector("head > title"))),sa(x,i,n),x[Ss]=s,Gt(x),i=x;break e;case"link":var v=cg("link","href",o).get(i+(n.href||""));if(v){for(var k=0;k<v.length;k++)if(x=v[k],x.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&x.getAttribute("rel")===(n.rel==null?null:n.rel)&&x.getAttribute("title")===(n.title==null?null:n.title)&&x.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){v.splice(k,1);break s}}x=o.createElement(i),sa(x,i,n),o.head.appendChild(x);break;case"meta":if(v=cg("meta","content",o).get(i+(n.content||""))){for(k=0;k<v.length;k++)if(x=v[k],x.getAttribute("content")===(n.content==null?null:""+n.content)&&x.getAttribute("name")===(n.name==null?null:n.name)&&x.getAttribute("property")===(n.property==null?null:n.property)&&x.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&x.getAttribute("charset")===(n.charSet==null?null:n.charSet)){v.splice(k,1);break s}}x=o.createElement(i),sa(x,i,n),o.head.appendChild(x);break;default:throw Error(c(468,i))}x[Ss]=s,Gt(x),i=x}s.stateNode=i}else og(o,s.type,s.stateNode);else s.stateNode=ig(o,i,s.memoizedProps);else x!==i?(x===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):x.count--,i===null?og(o,s.type,s.stateNode):ig(o,i,s.memoizedProps)):i===null&&s.stateNode!==null&&Pu(s,s.memoizedProps,n.memoizedProps)}break;case 27:ja(t,s),va(s),i&512&&(Pt||n===null||dl(n,n.return)),n!==null&&i&4&&Pu(s,s.memoizedProps,n.memoizedProps);break;case 5:if(ja(t,s),va(s),i&512&&(Pt||n===null||dl(n,n.return)),s.flags&32){o=s.stateNode;try{or(o,"")}catch(Ve){st(s,s.return,Ve)}}i&4&&s.stateNode!=null&&(o=s.memoizedProps,Pu(s,o,n!==null?n.memoizedProps:o)),i&1024&&(qu=!0);break;case 6:if(ja(t,s),va(s),i&4){if(s.stateNode===null)throw Error(c(162));i=s.memoizedProps,n=s.stateNode;try{n.nodeValue=i}catch(Ve){st(s,s.return,Ve)}}break;case 3:if(yo=null,o=al,al=No(t.containerInfo),ja(t,s),al=o,va(s),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Ir(t.containerInfo)}catch(Ve){st(s,s.return,Ve)}qu&&(qu=!1,op(s));break;case 4:i=al,al=No(s.stateNode.containerInfo),ja(t,s),va(s),al=i;break;case 12:ja(t,s),va(s);break;case 31:ja(t,s),va(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 13:ja(t,s),va(s),s.child.flags&8192&&s.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(io=Is()),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 22:o=s.memoizedState!==null;var I=n!==null&&n.memoizedState!==null,ie=Cl,ve=Pt;if(Cl=ie||o,Pt=ve||I,ja(t,s),Pt=ve,Cl=ie,va(s),i&8192)e:for(t=s.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(n===null||I||Cl||Pt||Hn(s)),n=null,t=s;;){if(t.tag===5||t.tag===26){if(n===null){I=n=t;try{if(x=I.stateNode,o)v=x.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{k=I.stateNode;var we=I.memoizedProps.style,oe=we!=null&&we.hasOwnProperty("display")?we.display:null;k.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(Ve){st(I,I.return,Ve)}}}else if(t.tag===6){if(n===null){I=t;try{I.stateNode.nodeValue=o?"":I.memoizedProps}catch(Ve){st(I,I.return,Ve)}}}else if(t.tag===18){if(n===null){I=t;try{var xe=I.stateNode;o?Zp(xe,!0):Zp(I.stateNode,!1)}catch(Ve){st(I,I.return,Ve)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===s)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=s.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,no(s,n))));break;case 19:ja(t,s),va(s),i&4&&(i=s.updateQueue,i!==null&&(s.updateQueue=null,no(s,i)));break;case 30:break;case 21:break;default:ja(t,s),va(s)}}function va(s){var t=s.flags;if(t&2){try{for(var n,i=s.return;i!==null;){if(ep(i)){n=i;break}i=i.return}if(n==null)throw Error(c(160));switch(n.tag){case 27:var o=n.stateNode,x=Fu(s);lo(s,x,o);break;case 5:var v=n.stateNode;n.flags&32&&(or(v,""),n.flags&=-33);var k=Fu(s);lo(s,k,v);break;case 3:case 4:var I=n.stateNode.containerInfo,ie=Fu(s);Hu(s,ie,I);break;default:throw Error(c(161))}}catch(ve){st(s,s.return,ve)}s.flags&=-3}t&4096&&(s.flags&=-4097)}function op(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var t=s;op(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),s=s.sibling}}function El(s,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ap(s,t.alternate,t),t=t.sibling}function Hn(s){for(s=s.child;s!==null;){var t=s;switch(t.tag){case 0:case 11:case 14:case 15:sn(4,t,t.return),Hn(t);break;case 1:dl(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Zf(t,t.return,n),Hn(t);break;case 27:$i(t.stateNode);case 26:case 5:dl(t,t.return),Hn(t);break;case 22:t.memoizedState===null&&Hn(t);break;case 30:Hn(t);break;default:Hn(t)}s=s.sibling}}function Ml(s,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,o=s,x=t,v=x.flags;switch(x.tag){case 0:case 11:case 15:Ml(o,x,n),Ti(4,x);break;case 1:if(Ml(o,x,n),i=x,o=i.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(ie){st(i,i.return,ie)}if(i=x,o=i.updateQueue,o!==null){var k=i.stateNode;try{var I=o.shared.hiddenCallbacks;if(I!==null)for(o.shared.hiddenCallbacks=null,o=0;o<I.length;o++)Bh(I[o],k)}catch(ie){st(i,i.return,ie)}}n&&v&64&&Xf(x),Ei(x,x.return);break;case 27:sp(x);case 26:case 5:Ml(o,x,n),n&&i===null&&v&4&&Wf(x),Ei(x,x.return);break;case 12:Ml(o,x,n);break;case 31:Ml(o,x,n),n&&v&4&&rp(o,x);break;case 13:Ml(o,x,n),n&&v&4&&ip(o,x);break;case 22:x.memoizedState===null&&Ml(o,x,n),Ei(x,x.return);break;case 30:break;default:Ml(o,x,n)}t=t.sibling}}function Vu(s,t){var n=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(s!=null&&s.refCount++,n!=null&&fi(n))}function Gu(s,t){s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s))}function ll(s,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)dp(s,t,n,i),t=t.sibling}function dp(s,t,n,i){var o=t.flags;switch(t.tag){case 0:case 11:case 15:ll(s,t,n,i),o&2048&&Ti(9,t);break;case 1:ll(s,t,n,i);break;case 3:ll(s,t,n,i),o&2048&&(s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&fi(s)));break;case 12:if(o&2048){ll(s,t,n,i),s=t.stateNode;try{var x=t.memoizedProps,v=x.id,k=x.onPostCommit;typeof k=="function"&&k(v,t.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(I){st(t,t.return,I)}}else ll(s,t,n,i);break;case 31:ll(s,t,n,i);break;case 13:ll(s,t,n,i);break;case 23:break;case 22:x=t.stateNode,v=t.alternate,t.memoizedState!==null?x._visibility&2?ll(s,t,n,i):Mi(s,t):x._visibility&2?ll(s,t,n,i):(x._visibility|=2,Er(s,t,n,i,(t.subtreeFlags&10256)!==0||!1)),o&2048&&Vu(v,t);break;case 24:ll(s,t,n,i),o&2048&&Gu(t.alternate,t);break;default:ll(s,t,n,i)}}function Er(s,t,n,i,o){for(o=o&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var x=s,v=t,k=n,I=i,ie=v.flags;switch(v.tag){case 0:case 11:case 15:Er(x,v,k,I,o),Ti(8,v);break;case 23:break;case 22:var ve=v.stateNode;v.memoizedState!==null?ve._visibility&2?Er(x,v,k,I,o):Mi(x,v):(ve._visibility|=2,Er(x,v,k,I,o)),o&&ie&2048&&Vu(v.alternate,v);break;case 24:Er(x,v,k,I,o),o&&ie&2048&&Gu(v.alternate,v);break;default:Er(x,v,k,I,o)}t=t.sibling}}function Mi(s,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=s,i=t,o=i.flags;switch(i.tag){case 22:Mi(n,i),o&2048&&Vu(i.alternate,i);break;case 24:Mi(n,i),o&2048&&Gu(i.alternate,i);break;default:Mi(n,i)}t=t.sibling}}var Ai=8192;function Mr(s,t,n){if(s.subtreeFlags&Ai)for(s=s.child;s!==null;)up(s,t,n),s=s.sibling}function up(s,t,n){switch(s.tag){case 26:Mr(s,t,n),s.flags&Ai&&s.memoizedState!==null&&I0(n,al,s.memoizedState,s.memoizedProps);break;case 5:Mr(s,t,n);break;case 3:case 4:var i=al;al=No(s.stateNode.containerInfo),Mr(s,t,n),al=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Ai,Ai=16777216,Mr(s,t,n),Ai=i):Mr(s,t,n));break;default:Mr(s,t,n)}}function mp(s){var t=s.alternate;if(t!==null&&(s=t.child,s!==null)){t.child=null;do t=s.sibling,s.sibling=null,s=t;while(s!==null)}}function zi(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Kt=i,hp(i,s)}mp(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)xp(s),s=s.sibling}function xp(s){switch(s.tag){case 0:case 11:case 15:zi(s),s.flags&2048&&sn(9,s,s.return);break;case 3:zi(s);break;case 12:zi(s);break;case 22:var t=s.stateNode;s.memoizedState!==null&&t._visibility&2&&(s.return===null||s.return.tag!==13)?(t._visibility&=-3,ro(s)):zi(s);break;default:zi(s)}}function ro(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Kt=i,hp(i,s)}mp(s)}for(s=s.child;s!==null;){switch(t=s,t.tag){case 0:case 11:case 15:sn(8,t,t.return),ro(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,ro(t));break;default:ro(t)}s=s.sibling}}function hp(s,t){for(;Kt!==null;){var n=Kt;switch(n.tag){case 0:case 11:case 15:sn(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:fi(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,Kt=i;else e:for(n=s;Kt!==null;){i=Kt;var o=i.sibling,x=i.return;if(lp(i),i===n){Kt=null;break e}if(o!==null){o.return=x,Kt=o;break e}Kt=x}}}var s0={getCacheForType:function(s){var t=Wt($t),n=t.data.get(s);return n===void 0&&(n=s(),t.data.set(s,n)),n},cacheSignal:function(){return Wt($t).controller.signal}},t0=typeof WeakMap=="function"?WeakMap:Map,Xs=0,mt=null,Rs=null,Us=0,et=0,Aa=null,tn=!1,Ar=!1,Ku=!1,Al=0,Mt=0,an=0,qn=0,Qu=0,za=0,zr=0,Ri=null,Na=null,Yu=!1,io=0,fp=0,co=1/0,oo=null,ln=null,Ft=0,nn=null,Rr=null,zl=0,Ju=0,Xu=null,pp=null,Di=0,Zu=null;function Ra(){return(Xs&2)!==0&&Us!==0?Us&-Us:D.T!==null?lm():le()}function gp(){if(za===0)if((Us&536870912)===0||Bs){var s=ht;ht<<=1,(ht&3932160)===0&&(ht=262144),za=s}else za=536870912;return s=Ea.current,s!==null&&(s.flags|=32),za}function ba(s,t,n){(s===mt&&(et===2||et===9)||s.cancelPendingCommit!==null)&&(Dr(s,0),rn(s,Us,za,!1)),U(s,n),((Xs&2)===0||s!==mt)&&(s===mt&&((Xs&2)===0&&(qn|=n),Mt===4&&rn(s,Us,za,!1)),ul(s))}function jp(s,t,n){if((Xs&6)!==0)throw Error(c(327));var i=!n&&(t&127)===0&&(t&s.expiredLanes)===0||Pa(s,t),o=i?n0(s,t):em(s,t,!0),x=i;do{if(o===0){Ar&&!i&&rn(s,t,0,!1);break}else{if(n=s.current.alternate,x&&!a0(n)){o=em(s,t,!1),x=!1;continue}if(o===2){if(x=t,s.errorRecoveryDisabledLanes&x)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){t=v;e:{var k=s;o=Ri;var I=k.current.memoizedState.isDehydrated;if(I&&(Dr(k,v).flags|=256),v=em(k,v,!1),v!==2){if(Ku&&!I){k.errorRecoveryDisabledLanes|=x,qn|=x,o=4;break e}x=Na,Na=o,x!==null&&(Na===null?Na=x:Na.push.apply(Na,x))}o=v}if(x=!1,o!==2)continue}}if(o===1){Dr(s,0),rn(s,t,0,!0);break}e:{switch(i=s,x=o,x){case 0:case 1:throw Error(c(345));case 4:if((t&4194048)!==t)break;case 6:rn(i,t,za,!tn);break e;case 2:Na=null;break;case 3:case 5:break;default:throw Error(c(329))}if((t&62914560)===t&&(o=io+300-Is(),10<o)){if(rn(i,t,za,!tn),ka(i,0,!0)!==0)break e;zl=t,i.timeoutHandle=Yp(vp.bind(null,i,n,Na,oo,Yu,t,za,qn,zr,tn,x,"Throttled",-0,0),o);break e}vp(i,n,Na,oo,Yu,t,za,qn,zr,tn,x,null,-0,0)}}break}while(!0);ul(s)}function vp(s,t,n,i,o,x,v,k,I,ie,ve,we,oe,xe){if(s.timeoutHandle=-1,we=t.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:gl},up(t,x,we);var Ve=(x&62914560)===x?io-Is():(x&4194048)===x?fp-Is():0;if(Ve=P0(we,Ve),Ve!==null){zl=x,s.cancelPendingCommit=Ve(Cp.bind(null,s,t,x,n,i,o,v,k,I,ve,we,null,oe,xe)),rn(s,x,v,!ie);return}}Cp(s,t,x,n,i,o,v,k,I)}function a0(s){for(var t=s;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var o=n[i],x=o.getSnapshot;o=o.value;try{if(!Ca(x(),o))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rn(s,t,n,i){t&=~Qu,t&=~qn,s.suspendedLanes|=t,s.pingedLanes&=~t,i&&(s.warmLanes|=t),i=s.expirationTimes;for(var o=t;0<o;){var x=31-_s(o),v=1<<x;i[x]=-1,o&=~v}n!==0&&Xe(s,n,t)}function uo(){return(Xs&6)===0?(Oi(0),!1):!0}function Wu(){if(Rs!==null){if(et===0)var s=Rs.return;else s=Rs,bl=On=null,fu(s),_r=null,gi=0,s=Rs;for(;s!==null;)Jf(s.alternate,s),s=s.return;Rs=null}}function Dr(s,t){var n=s.timeoutHandle;n!==-1&&(s.timeoutHandle=-1,w0(n)),n=s.cancelPendingCommit,n!==null&&(s.cancelPendingCommit=null,n()),zl=0,Wu(),mt=s,Rs=n=vl(s.current,null),Us=t,et=0,Aa=null,tn=!1,Ar=Pa(s,t),Ku=!1,zr=za=Qu=qn=an=Mt=0,Na=Ri=null,Yu=!1,(t&8)!==0&&(t|=t&32);var i=s.entangledLanes;if(i!==0)for(s=s.entanglements,i&=t;0<i;){var o=31-_s(i),x=1<<o;t|=s[o],i&=~x}return Al=t,Ac(),n}function Np(s,t){ks=null,D.H=Si,t===wr||t===Bc?(t=Oh(),et=3):t===au?(t=Oh(),et=4):et=t===Au?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Aa=t,Rs===null&&(Mt=1,Wc(s,Va(t,s.current)))}function bp(){var s=Ea.current;return s===null?!0:(Us&4194048)===Us?Ya===null:(Us&62914560)===Us||(Us&536870912)!==0?s===Ya:!1}function yp(){var s=D.H;return D.H=Si,s===null?Si:s}function wp(){var s=D.A;return D.A=s0,s}function mo(){Mt=4,tn||(Us&4194048)!==Us&&Ea.current!==null||(Ar=!0),(an&134217727)===0&&(qn&134217727)===0||mt===null||rn(mt,Us,za,!1)}function em(s,t,n){var i=Xs;Xs|=2;var o=yp(),x=wp();(mt!==s||Us!==t)&&(oo=null,Dr(s,t)),t=!1;var v=Mt;e:do try{if(et!==0&&Rs!==null){var k=Rs,I=Aa;switch(et){case 8:Wu(),v=6;break e;case 3:case 2:case 9:case 6:Ea.current===null&&(t=!0);var ie=et;if(et=0,Aa=null,Or(s,k,I,ie),n&&Ar){v=0;break e}break;default:ie=et,et=0,Aa=null,Or(s,k,I,ie)}}l0(),v=Mt;break}catch(ve){Np(s,ve)}while(!0);return t&&s.shellSuspendCounter++,bl=On=null,Xs=i,D.H=o,D.A=x,Rs===null&&(mt=null,Us=0,Ac()),v}function l0(){for(;Rs!==null;)_p(Rs)}function n0(s,t){var n=Xs;Xs|=2;var i=yp(),o=wp();mt!==s||Us!==t?(oo=null,co=Is()+500,Dr(s,t)):Ar=Pa(s,t);e:do try{if(et!==0&&Rs!==null){t=Rs;var x=Aa;s:switch(et){case 1:et=0,Aa=null,Or(s,t,x,1);break;case 2:case 9:if(Rh(x)){et=0,Aa=null,Sp(t);break}t=function(){et!==2&&et!==9||mt!==s||(et=7),ul(s)},x.then(t,t);break e;case 3:et=7;break e;case 4:et=5;break e;case 7:Rh(x)?(et=0,Aa=null,Sp(t)):(et=0,Aa=null,Or(s,t,x,7));break;case 5:var v=null;switch(Rs.tag){case 26:v=Rs.memoizedState;case 5:case 27:var k=Rs;if(v?dg(v):k.stateNode.complete){et=0,Aa=null;var I=k.sibling;if(I!==null)Rs=I;else{var ie=k.return;ie!==null?(Rs=ie,xo(ie)):Rs=null}break s}}et=0,Aa=null,Or(s,t,x,5);break;case 6:et=0,Aa=null,Or(s,t,x,6);break;case 8:Wu(),Mt=6;break e;default:throw Error(c(462))}}r0();break}catch(ve){Np(s,ve)}while(!0);return bl=On=null,D.H=i,D.A=o,Xs=n,Rs!==null?0:(mt=null,Us=0,Ac(),Mt)}function r0(){for(;Rs!==null&&!fa();)_p(Rs)}function _p(s){var t=Qf(s.alternate,s,Al);s.memoizedProps=s.pendingProps,t===null?xo(s):Rs=t}function Sp(s){var t=s,n=t.alternate;switch(t.tag){case 15:case 0:t=Ff(n,t,t.pendingProps,t.type,void 0,Us);break;case 11:t=Ff(n,t,t.pendingProps,t.type.render,t.ref,Us);break;case 5:fu(t);default:Jf(n,t),t=Rs=yh(t,Al),t=Qf(n,t,Al)}s.memoizedProps=s.pendingProps,t===null?xo(s):Rs=t}function Or(s,t,n,i){bl=On=null,fu(t),_r=null,gi=0;var o=t.return;try{if(Qy(s,o,t,n,Us)){Mt=1,Wc(s,Va(n,s.current)),Rs=null;return}}catch(x){if(o!==null)throw Rs=o,x;Mt=1,Wc(s,Va(n,s.current)),Rs=null;return}t.flags&32768?(Bs||i===1?s=!0:Ar||(Us&536870912)!==0?s=!1:(tn=s=!0,(i===2||i===9||i===3||i===6)&&(i=Ea.current,i!==null&&i.tag===13&&(i.flags|=16384))),kp(t,s)):xo(t)}function xo(s){var t=s;do{if((t.flags&32768)!==0){kp(t,tn);return}s=t.return;var n=Xy(t.alternate,t,Al);if(n!==null){Rs=n;return}if(t=t.sibling,t!==null){Rs=t;return}Rs=t=s}while(t!==null);Mt===0&&(Mt=5)}function kp(s,t){do{var n=Zy(s.alternate,s);if(n!==null){n.flags&=32767,Rs=n;return}if(n=s.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(s=s.sibling,s!==null)){Rs=s;return}Rs=s=n}while(s!==null);Mt=6,Rs=null}function Cp(s,t,n,i,o,x,v,k,I){s.cancelPendingCommit=null;do ho();while(Ft!==0);if((Xs&6)!==0)throw Error(c(327));if(t!==null){if(t===s.current)throw Error(c(177));if(x=t.lanes|t.childLanes,x|=Fd,Me(s,n,x,v,k,I),s===mt&&(Rs=mt=null,Us=0),Rr=t,nn=s,zl=n,Ju=x,Xu=o,pp=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,d0(Ze,function(){return zp(),null})):(s.callbackNode=null,s.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=D.T,D.T=null,o=K.p,K.p=2,v=Xs,Xs|=4;try{Wy(s,t,n)}finally{Xs=v,K.p=o,D.T=i}}Ft=1,Tp(),Ep(),Mp()}}function Tp(){if(Ft===1){Ft=0;var s=nn,t=Rr,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=D.T,D.T=null;var i=K.p;K.p=2;var o=Xs;Xs|=4;try{cp(t,s);var x=mm,v=xh(s.containerInfo),k=x.focusedElem,I=x.selectionRange;if(v!==k&&k&&k.ownerDocument&&mh(k.ownerDocument.documentElement,k)){if(I!==null&&Ud(k)){var ie=I.start,ve=I.end;if(ve===void 0&&(ve=ie),"selectionStart"in k)k.selectionStart=ie,k.selectionEnd=Math.min(ve,k.value.length);else{var we=k.ownerDocument||document,oe=we&&we.defaultView||window;if(oe.getSelection){var xe=oe.getSelection(),Ve=k.textContent.length,as=Math.min(I.start,Ve),dt=I.end===void 0?as:Math.min(I.end,Ve);!xe.extend&&as>dt&&(v=dt,dt=as,as=v);var W=uh(k,as),q=uh(k,dt);if(W&&q&&(xe.rangeCount!==1||xe.anchorNode!==W.node||xe.anchorOffset!==W.offset||xe.focusNode!==q.node||xe.focusOffset!==q.offset)){var re=we.createRange();re.setStart(W.node,W.offset),xe.removeAllRanges(),as>dt?(xe.addRange(re),xe.extend(q.node,q.offset)):(re.setEnd(q.node,q.offset),xe.addRange(re))}}}}for(we=[],xe=k;xe=xe.parentNode;)xe.nodeType===1&&we.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<we.length;k++){var be=we[k];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}ko=!!um,mm=um=null}finally{Xs=o,K.p=i,D.T=n}}s.current=t,Ft=2}}function Ep(){if(Ft===2){Ft=0;var s=nn,t=Rr,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=D.T,D.T=null;var i=K.p;K.p=2;var o=Xs;Xs|=4;try{ap(s,t.alternate,t)}finally{Xs=o,K.p=i,D.T=n}}Ft=3}}function Mp(){if(Ft===4||Ft===3){Ft=0,xs();var s=nn,t=Rr,n=zl,i=pp;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ft=5:(Ft=0,Rr=nn=null,Ap(s,s.pendingLanes));var o=s.pendingLanes;if(o===0&&(ln=null),Ps(n),t=t.stateNode,cs&&typeof cs.onCommitFiberRoot=="function")try{cs.onCommitFiberRoot(Ks,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=D.T,o=K.p,K.p=2,D.T=null;try{for(var x=s.onRecoverableError,v=0;v<i.length;v++){var k=i[v];x(k.value,{componentStack:k.stack})}}finally{D.T=t,K.p=o}}(zl&3)!==0&&ho(),ul(s),o=s.pendingLanes,(n&261930)!==0&&(o&42)!==0?s===Zu?Di++:(Di=0,Zu=s):Di=0,Oi(0)}}function Ap(s,t){(s.pooledCacheLanes&=t)===0&&(t=s.pooledCache,t!=null&&(s.pooledCache=null,fi(t)))}function ho(){return Tp(),Ep(),Mp(),zp()}function zp(){if(Ft!==5)return!1;var s=nn,t=Ju;Ju=0;var n=Ps(zl),i=D.T,o=K.p;try{K.p=32>n?32:n,D.T=null,n=Xu,Xu=null;var x=nn,v=zl;if(Ft=0,Rr=nn=null,zl=0,(Xs&6)!==0)throw Error(c(331));var k=Xs;if(Xs|=4,xp(x.current),dp(x,x.current,v,n),Xs=k,Oi(0,!1),cs&&typeof cs.onPostCommitFiberRoot=="function")try{cs.onPostCommitFiberRoot(Ks,x)}catch{}return!0}finally{K.p=o,D.T=i,Ap(s,t)}}function Rp(s,t,n){t=Va(n,t),t=Mu(s.stateNode,t,2),s=Zl(s,t,2),s!==null&&(U(s,2),ul(s))}function st(s,t,n){if(s.tag===3)Rp(s,s,n);else for(;t!==null;){if(t.tag===3){Rp(t,s,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ln===null||!ln.has(i))){s=Va(n,s),n=Df(2),i=Zl(t,n,2),i!==null&&(Of(n,i,t,s),U(i,2),ul(i));break}}t=t.return}}function sm(s,t,n){var i=s.pingCache;if(i===null){i=s.pingCache=new t0;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(n)||(Ku=!0,o.add(n),s=i0.bind(null,s,t,n),t.then(s,s))}function i0(s,t,n){var i=s.pingCache;i!==null&&i.delete(t),s.pingedLanes|=s.suspendedLanes&n,s.warmLanes&=~n,mt===s&&(Us&n)===n&&(Mt===4||Mt===3&&(Us&62914560)===Us&&300>Is()-io?(Xs&2)===0&&Dr(s,0):Qu|=n,zr===Us&&(zr=0)),ul(s)}function Dp(s,t){t===0&&(t=te()),s=zn(s,t),s!==null&&(U(s,t),ul(s))}function c0(s){var t=s.memoizedState,n=0;t!==null&&(n=t.retryLane),Dp(s,n)}function o0(s,t){var n=0;switch(s.tag){case 31:case 13:var i=s.stateNode,o=s.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=s.stateNode;break;case 22:i=s.stateNode._retryCache;break;default:throw Error(c(314))}i!==null&&i.delete(t),Dp(s,n)}function d0(s,t){return Zs(s,t)}var fo=null,Lr=null,tm=!1,po=!1,am=!1,cn=0;function ul(s){s!==Lr&&s.next===null&&(Lr===null?fo=Lr=s:Lr=Lr.next=s),po=!0,tm||(tm=!0,m0())}function Oi(s,t){if(!am&&po){am=!0;do for(var n=!1,i=fo;i!==null;){if(s!==0){var o=i.pendingLanes;if(o===0)var x=0;else{var v=i.suspendedLanes,k=i.pingedLanes;x=(1<<31-_s(42|s)+1)-1,x&=o&~(v&~k),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(n=!0,$p(i,x))}else x=Us,x=ka(i,i===mt?x:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(x&3)===0||Pa(i,x)||(n=!0,$p(i,x));i=i.next}while(n);am=!1}}function u0(){Op()}function Op(){po=tm=!1;var s=0;cn!==0&&y0()&&(s=cn);for(var t=Is(),n=null,i=fo;i!==null;){var o=i.next,x=Lp(i,t);x===0?(i.next=null,n===null?fo=o:n.next=o,o===null&&(Lr=n)):(n=i,(s!==0||(x&3)!==0)&&(po=!0)),i=o}Ft!==0&&Ft!==5||Oi(s),cn!==0&&(cn=0)}function Lp(s,t){for(var n=s.suspendedLanes,i=s.pingedLanes,o=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var v=31-_s(x),k=1<<v,I=o[v];I===-1?((k&n)===0||(k&i)!==0)&&(o[v]=Jt(k,t)):I<=t&&(s.expiredLanes|=k),x&=~k}if(t=mt,n=Us,n=ka(s,s===t?n:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i=s.callbackNode,n===0||s===t&&(et===2||et===9)||s.cancelPendingCommit!==null)return i!==null&&i!==null&&St(i),s.callbackNode=null,s.callbackPriority=0;if((n&3)===0||Pa(s,n)){if(t=n&-n,t===s.callbackPriority)return t;switch(i!==null&&St(i),Ps(n)){case 2:case 8:n=Ke;break;case 32:n=Ze;break;case 268435456:n=He;break;default:n=Ze}return i=Up.bind(null,s),n=Zs(n,i),s.callbackPriority=t,s.callbackNode=n,t}return i!==null&&i!==null&&St(i),s.callbackPriority=2,s.callbackNode=null,2}function Up(s,t){if(Ft!==0&&Ft!==5)return s.callbackNode=null,s.callbackPriority=0,null;var n=s.callbackNode;if(ho()&&s.callbackNode!==n)return null;var i=Us;return i=ka(s,s===mt?i:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),i===0?null:(jp(s,i,t),Lp(s,Is()),s.callbackNode!=null&&s.callbackNode===n?Up.bind(null,s):null)}function $p(s,t){if(ho())return null;jp(s,t,!0)}function m0(){_0(function(){(Xs&6)!==0?Zs(qe,u0):Op()})}function lm(){if(cn===0){var s=br;s===0&&(s=rs,rs<<=1,(rs&261888)===0&&(rs=256)),cn=s}return cn}function Bp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:wc(""+s)}function Ip(s,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,s.id&&n.setAttribute("form",s.id),t.parentNode.insertBefore(n,t),s=new FormData(s),n.parentNode.removeChild(n),s}function x0(s,t,n,i,o){if(t==="submit"&&n&&n.stateNode===o){var x=Bp((o[hs]||null).action),v=i.submitter;v&&(t=(t=v[hs]||null)?Bp(t.formAction):v.getAttribute("formAction"),t!==null&&(x=t,v=null));var k=new Cc("action","action",null,i,o);s.push({event:k,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(cn!==0){var I=v?Ip(o,v):new FormData(o);_u(n,{pending:!0,data:I,method:o.method,action:x},null,I)}}else typeof x=="function"&&(k.preventDefault(),I=v?Ip(o,v):new FormData(o),_u(n,{pending:!0,data:I,method:o.method,action:x},x,I))},currentTarget:o}]})}}for(var nm=0;nm<Pd.length;nm++){var rm=Pd[nm],h0=rm.toLowerCase(),f0=rm[0].toUpperCase()+rm.slice(1);tl(h0,"on"+f0)}tl(ph,"onAnimationEnd"),tl(gh,"onAnimationIteration"),tl(jh,"onAnimationStart"),tl("dblclick","onDoubleClick"),tl("focusin","onFocus"),tl("focusout","onBlur"),tl(Ay,"onTransitionRun"),tl(zy,"onTransitionStart"),tl(Ry,"onTransitionCancel"),tl(vh,"onTransitionEnd"),ir("onMouseEnter",["mouseout","mouseover"]),ir("onMouseLeave",["mouseout","mouseover"]),ir("onPointerEnter",["pointerout","pointerover"]),ir("onPointerLeave",["pointerout","pointerover"]),Tn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Tn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Tn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Tn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Tn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Tn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Li));function Pp(s,t){t=(t&4)!==0;for(var n=0;n<s.length;n++){var i=s[n],o=i.event;i=i.listeners;e:{var x=void 0;if(t)for(var v=i.length-1;0<=v;v--){var k=i[v],I=k.instance,ie=k.currentTarget;if(k=k.listener,I!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=ie;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=I}else for(v=0;v<i.length;v++){if(k=i[v],I=k.instance,ie=k.currentTarget,k=k.listener,I!==x&&o.isPropagationStopped())break e;x=k,o.currentTarget=ie;try{x(o)}catch(ve){Mc(ve)}o.currentTarget=null,x=I}}}}function Ds(s,t){var n=t[oa];n===void 0&&(n=t[oa]=new Set);var i=s+"__bubble";n.has(i)||(Fp(t,s,2,!1),n.add(i))}function im(s,t,n){var i=0;t&&(i|=4),Fp(n,s,i,t)}var go="_reactListening"+Math.random().toString(36).slice(2);function cm(s){if(!s[go]){s[go]=!0,Dx.forEach(function(n){n!=="selectionchange"&&(p0.has(n)||im(n,!1,s),im(n,!0,s))});var t=s.nodeType===9?s:s.ownerDocument;t===null||t[go]||(t[go]=!0,im("selectionchange",!1,t))}}function Fp(s,t,n,i){switch(gg(t)){case 2:var o=q0;break;case 8:o=V0;break;default:o=wm}n=o.bind(null,t,n,s),o=void 0,!Td||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?s.addEventListener(t,n,{capture:!0,passive:o}):s.addEventListener(t,n,!0):o!==void 0?s.addEventListener(t,n,{passive:o}):s.addEventListener(t,n,!1)}function om(s,t,n,i,o){var x=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var v=i.tag;if(v===3||v===4){var k=i.stateNode.containerInfo;if(k===o)break;if(v===4)for(v=i.return;v!==null;){var I=v.tag;if((I===3||I===4)&&v.stateNode.containerInfo===o)return;v=v.return}for(;k!==null;){if(v=lr(k),v===null)return;if(I=v.tag,I===5||I===6||I===26||I===27){i=x=v;continue e}k=k.parentNode}}i=i.return}Gx(function(){var ie=x,ve=kd(n),we=[];e:{var oe=Nh.get(s);if(oe!==void 0){var xe=Cc,Ve=s;switch(s){case"keypress":if(Sc(n)===0)break e;case"keydown":case"keyup":xe=oy;break;case"focusin":Ve="focus",xe=zd;break;case"focusout":Ve="blur",xe=zd;break;case"beforeblur":case"afterblur":xe=zd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Yx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=Xb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=my;break;case ph:case gh:case jh:xe=ey;break;case vh:xe=hy;break;case"scroll":case"scrollend":xe=Yb;break;case"wheel":xe=py;break;case"copy":case"cut":case"paste":xe=ty;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Xx;break;case"toggle":case"beforetoggle":xe=jy}var as=(t&4)!==0,dt=!as&&(s==="scroll"||s==="scrollend"),W=as?oe!==null?oe+"Capture":null:oe;as=[];for(var q=ie,re;q!==null;){var be=q;if(re=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||re===null||W===null||(be=li(q,W),be!=null&&as.push(Ui(q,be,re))),dt)break;q=q.return}0<as.length&&(oe=new xe(oe,Ve,null,n,ve),we.push({event:oe,listeners:as}))}}if((t&7)===0){e:{if(oe=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",oe&&n!==Sd&&(Ve=n.relatedTarget||n.fromElement)&&(lr(Ve)||Ve[yt]))break e;if((xe||oe)&&(oe=ve.window===ve?ve:(oe=ve.ownerDocument)?oe.defaultView||oe.parentWindow:window,xe?(Ve=n.relatedTarget||n.toElement,xe=ie,Ve=Ve?lr(Ve):null,Ve!==null&&(dt=m(Ve),as=Ve.tag,Ve!==dt||as!==5&&as!==27&&as!==6)&&(Ve=null)):(xe=null,Ve=ie),xe!==Ve)){if(as=Yx,be="onMouseLeave",W="onMouseEnter",q="mouse",(s==="pointerout"||s==="pointerover")&&(as=Xx,be="onPointerLeave",W="onPointerEnter",q="pointer"),dt=xe==null?oe:ai(xe),re=Ve==null?oe:ai(Ve),oe=new as(be,q+"leave",xe,n,ve),oe.target=dt,oe.relatedTarget=re,be=null,lr(ve)===ie&&(as=new as(W,q+"enter",Ve,n,ve),as.target=re,as.relatedTarget=dt,be=as),dt=be,xe&&Ve)s:{for(as=g0,W=xe,q=Ve,re=0,be=W;be;be=as(be))re++;be=0;for(var We=q;We;We=as(We))be++;for(;0<re-be;)W=as(W),re--;for(;0<be-re;)q=as(q),be--;for(;re--;){if(W===q||q!==null&&W===q.alternate){as=W;break s}W=as(W),q=as(q)}as=null}else as=null;xe!==null&&Hp(we,oe,xe,as,!1),Ve!==null&&dt!==null&&Hp(we,dt,Ve,as,!0)}}e:{if(oe=ie?ai(ie):window,xe=oe.nodeName&&oe.nodeName.toLowerCase(),xe==="select"||xe==="input"&&oe.type==="file")var Qs=nh;else if(ah(oe))if(rh)Qs=Ty;else{Qs=ky;var Qe=Sy}else xe=oe.nodeName,!xe||xe.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ie&&_d(ie.elementType)&&(Qs=nh):Qs=Cy;if(Qs&&(Qs=Qs(s,ie))){lh(we,Qs,n,ve);break e}Qe&&Qe(s,oe,ie),s==="focusout"&&ie&&oe.type==="number"&&ie.memoizedProps.value!=null&&wd(oe,"number",oe.value)}switch(Qe=ie?ai(ie):window,s){case"focusin":(ah(Qe)||Qe.contentEditable==="true")&&(xr=Qe,$d=ie,mi=null);break;case"focusout":mi=$d=xr=null;break;case"mousedown":Bd=!0;break;case"contextmenu":case"mouseup":case"dragend":Bd=!1,hh(we,n,ve);break;case"selectionchange":if(My)break;case"keydown":case"keyup":hh(we,n,ve)}var Es;if(Dd)e:{switch(s){case"compositionstart":var $s="onCompositionStart";break e;case"compositionend":$s="onCompositionEnd";break e;case"compositionupdate":$s="onCompositionUpdate";break e}$s=void 0}else mr?sh(s,n)&&($s="onCompositionEnd"):s==="keydown"&&n.keyCode===229&&($s="onCompositionStart");$s&&(Zx&&n.locale!=="ko"&&(mr||$s!=="onCompositionStart"?$s==="onCompositionEnd"&&mr&&(Es=Kx()):(Vl=ve,Ed="value"in Vl?Vl.value:Vl.textContent,mr=!0)),Qe=jo(ie,$s),0<Qe.length&&($s=new Jx($s,s,null,n,ve),we.push({event:$s,listeners:Qe}),Es?$s.data=Es:(Es=th(n),Es!==null&&($s.data=Es)))),(Es=Ny?by(s,n):yy(s,n))&&($s=jo(ie,"onBeforeInput"),0<$s.length&&(Qe=new Jx("onBeforeInput","beforeinput",null,n,ve),we.push({event:Qe,listeners:$s}),Qe.data=Es)),x0(we,s,ie,n,ve)}Pp(we,t)})}function Ui(s,t,n){return{instance:s,listener:t,currentTarget:n}}function jo(s,t){for(var n=t+"Capture",i=[];s!==null;){var o=s,x=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||x===null||(o=li(s,n),o!=null&&i.unshift(Ui(s,o,x)),o=li(s,t),o!=null&&i.push(Ui(s,o,x))),s.tag===3)return i;s=s.return}return[]}function g0(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Hp(s,t,n,i,o){for(var x=t._reactName,v=[];n!==null&&n!==i;){var k=n,I=k.alternate,ie=k.stateNode;if(k=k.tag,I!==null&&I===i)break;k!==5&&k!==26&&k!==27||ie===null||(I=ie,o?(ie=li(n,x),ie!=null&&v.unshift(Ui(n,ie,I))):o||(ie=li(n,x),ie!=null&&v.push(Ui(n,ie,I)))),n=n.return}v.length!==0&&s.push({event:t,listeners:v})}var j0=/\r\n?/g,v0=/\u0000|\uFFFD/g;function qp(s){return(typeof s=="string"?s:""+s).replace(j0,`
`).replace(v0,"")}function Vp(s,t){return t=qp(t),qp(s)===t}function ot(s,t,n,i,o,x){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||or(s,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&or(s,""+i);break;case"className":bc(s,"class",i);break;case"tabIndex":bc(s,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":bc(s,n,i);break;case"style":qx(s,i,x);break;case"data":if(t!=="object"){bc(s,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){s.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(n);break}i=wc(""+i),s.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){s.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(n==="formAction"?(t!=="input"&&ot(s,t,"name",o.name,o,null),ot(s,t,"formEncType",o.formEncType,o,null),ot(s,t,"formMethod",o.formMethod,o,null),ot(s,t,"formTarget",o.formTarget,o,null)):(ot(s,t,"encType",o.encType,o,null),ot(s,t,"method",o.method,o,null),ot(s,t,"target",o.target,o,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){s.removeAttribute(n);break}i=wc(""+i),s.setAttribute(n,i);break;case"onClick":i!=null&&(s.onclick=gl);break;case"onScroll":i!=null&&Ds("scroll",s);break;case"onScrollEnd":i!=null&&Ds("scrollend",s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(n=i.__html,n!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=n}}break;case"multiple":s.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":s.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){s.removeAttribute("xlink:href");break}n=wc(""+i),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,""+i):s.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,""):s.removeAttribute(n);break;case"capture":case"download":i===!0?s.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?s.setAttribute(n,i):s.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?s.setAttribute(n,i):s.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?s.removeAttribute(n):s.setAttribute(n,i);break;case"popover":Ds("beforetoggle",s),Ds("toggle",s),Nc(s,"popover",i);break;case"xlinkActuate":pl(s,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":pl(s,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":pl(s,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":pl(s,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":pl(s,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":pl(s,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":pl(s,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":pl(s,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":pl(s,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Nc(s,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Kb.get(n)||n,Nc(s,n,i))}}function dm(s,t,n,i,o,x){switch(n){case"style":qx(s,i,x);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(c(61));if(n=i.__html,n!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=n}}break;case"children":typeof i=="string"?or(s,i):(typeof i=="number"||typeof i=="bigint")&&or(s,""+i);break;case"onScroll":i!=null&&Ds("scroll",s);break;case"onScrollEnd":i!=null&&Ds("scrollend",s);break;case"onClick":i!=null&&(s.onclick=gl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ox.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),x=s[hs]||null,x=x!=null?x[n]:null,typeof x=="function"&&s.removeEventListener(t,x,o),typeof i=="function")){typeof x!="function"&&x!==null&&(n in s?s[n]=null:s.hasAttribute(n)&&s.removeAttribute(n)),s.addEventListener(t,i,o);break e}n in s?s[n]=i:i===!0?s.setAttribute(n,""):Nc(s,n,i)}}}function sa(s,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ds("error",s),Ds("load",s);var i=!1,o=!1,x;for(x in n)if(n.hasOwnProperty(x)){var v=n[x];if(v!=null)switch(x){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:ot(s,t,x,v,n,null)}}o&&ot(s,t,"srcSet",n.srcSet,n,null),i&&ot(s,t,"src",n.src,n,null);return;case"input":Ds("invalid",s);var k=x=v=o=null,I=null,ie=null;for(i in n)if(n.hasOwnProperty(i)){var ve=n[i];if(ve!=null)switch(i){case"name":o=ve;break;case"type":v=ve;break;case"checked":I=ve;break;case"defaultChecked":ie=ve;break;case"value":x=ve;break;case"defaultValue":k=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(c(137,t));break;default:ot(s,t,i,ve,n,null)}}Ix(s,x,k,I,ie,v,o,!1);return;case"select":Ds("invalid",s),i=v=x=null;for(o in n)if(n.hasOwnProperty(o)&&(k=n[o],k!=null))switch(o){case"value":x=k;break;case"defaultValue":v=k;break;case"multiple":i=k;default:ot(s,t,o,k,n,null)}t=x,n=v,s.multiple=!!i,t!=null?cr(s,!!i,t,!1):n!=null&&cr(s,!!i,n,!0);return;case"textarea":Ds("invalid",s),x=o=i=null;for(v in n)if(n.hasOwnProperty(v)&&(k=n[v],k!=null))switch(v){case"value":i=k;break;case"defaultValue":o=k;break;case"children":x=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(c(91));break;default:ot(s,t,v,k,n,null)}Fx(s,i,o,x);return;case"option":for(I in n)if(n.hasOwnProperty(I)&&(i=n[I],i!=null))switch(I){case"selected":s.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:ot(s,t,I,i,n,null)}return;case"dialog":Ds("beforetoggle",s),Ds("toggle",s),Ds("cancel",s),Ds("close",s);break;case"iframe":case"object":Ds("load",s);break;case"video":case"audio":for(i=0;i<Li.length;i++)Ds(Li[i],s);break;case"image":Ds("error",s),Ds("load",s);break;case"details":Ds("toggle",s);break;case"embed":case"source":case"link":Ds("error",s),Ds("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in n)if(n.hasOwnProperty(ie)&&(i=n[ie],i!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:ot(s,t,ie,i,n,null)}return;default:if(_d(t)){for(ve in n)n.hasOwnProperty(ve)&&(i=n[ve],i!==void 0&&dm(s,t,ve,i,n,void 0));return}}for(k in n)n.hasOwnProperty(k)&&(i=n[k],i!=null&&ot(s,t,k,i,n,null))}function N0(s,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,x=null,v=null,k=null,I=null,ie=null,ve=null;for(xe in n){var we=n[xe];if(n.hasOwnProperty(xe)&&we!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":I=we;default:i.hasOwnProperty(xe)||ot(s,t,xe,null,i,we)}}for(var oe in i){var xe=i[oe];if(we=n[oe],i.hasOwnProperty(oe)&&(xe!=null||we!=null))switch(oe){case"type":x=xe;break;case"name":o=xe;break;case"checked":ie=xe;break;case"defaultChecked":ve=xe;break;case"value":v=xe;break;case"defaultValue":k=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(c(137,t));break;default:xe!==we&&ot(s,t,oe,xe,i,we)}}yd(s,v,k,I,ie,ve,x,o);return;case"select":xe=v=k=oe=null;for(x in n)if(I=n[x],n.hasOwnProperty(x)&&I!=null)switch(x){case"value":break;case"multiple":xe=I;default:i.hasOwnProperty(x)||ot(s,t,x,null,i,I)}for(o in i)if(x=i[o],I=n[o],i.hasOwnProperty(o)&&(x!=null||I!=null))switch(o){case"value":oe=x;break;case"defaultValue":k=x;break;case"multiple":v=x;default:x!==I&&ot(s,t,o,x,i,I)}t=k,n=v,i=xe,oe!=null?cr(s,!!n,oe,!1):!!i!=!!n&&(t!=null?cr(s,!!n,t,!0):cr(s,!!n,n?[]:"",!1));return;case"textarea":xe=oe=null;for(k in n)if(o=n[k],n.hasOwnProperty(k)&&o!=null&&!i.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:ot(s,t,k,null,i,o)}for(v in i)if(o=i[v],x=n[v],i.hasOwnProperty(v)&&(o!=null||x!=null))switch(v){case"value":oe=o;break;case"defaultValue":xe=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(c(91));break;default:o!==x&&ot(s,t,v,o,i,x)}Px(s,oe,xe);return;case"option":for(var Ve in n)if(oe=n[Ve],n.hasOwnProperty(Ve)&&oe!=null&&!i.hasOwnProperty(Ve))switch(Ve){case"selected":s.selected=!1;break;default:ot(s,t,Ve,null,i,oe)}for(I in i)if(oe=i[I],xe=n[I],i.hasOwnProperty(I)&&oe!==xe&&(oe!=null||xe!=null))switch(I){case"selected":s.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:ot(s,t,I,oe,i,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var as in n)oe=n[as],n.hasOwnProperty(as)&&oe!=null&&!i.hasOwnProperty(as)&&ot(s,t,as,null,i,oe);for(ie in i)if(oe=i[ie],xe=n[ie],i.hasOwnProperty(ie)&&oe!==xe&&(oe!=null||xe!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(c(137,t));break;default:ot(s,t,ie,oe,i,xe)}return;default:if(_d(t)){for(var dt in n)oe=n[dt],n.hasOwnProperty(dt)&&oe!==void 0&&!i.hasOwnProperty(dt)&&dm(s,t,dt,void 0,i,oe);for(ve in i)oe=i[ve],xe=n[ve],!i.hasOwnProperty(ve)||oe===xe||oe===void 0&&xe===void 0||dm(s,t,ve,oe,i,xe);return}}for(var W in n)oe=n[W],n.hasOwnProperty(W)&&oe!=null&&!i.hasOwnProperty(W)&&ot(s,t,W,null,i,oe);for(we in i)oe=i[we],xe=n[we],!i.hasOwnProperty(we)||oe===xe||oe==null&&xe==null||ot(s,t,we,oe,i,xe)}function Gp(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function b0(){if(typeof performance.getEntriesByType=="function"){for(var s=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var o=n[i],x=o.transferSize,v=o.initiatorType,k=o.duration;if(x&&k&&Gp(v)){for(v=0,k=o.responseEnd,i+=1;i<n.length;i++){var I=n[i],ie=I.startTime;if(ie>k)break;var ve=I.transferSize,we=I.initiatorType;ve&&Gp(we)&&(I=I.responseEnd,v+=ve*(I<k?1:(k-ie)/(I-ie)))}if(--i,t+=8*(x+v)/(o.duration/1e3),s++,10<s)break}}if(0<s)return t/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var um=null,mm=null;function vo(s){return s.nodeType===9?s:s.ownerDocument}function Kp(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qp(s,t){if(s===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&t==="foreignObject"?0:s}function xm(s,t){return s==="textarea"||s==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hm=null;function y0(){var s=window.event;return s&&s.type==="popstate"?s===hm?!1:(hm=s,!0):(hm=null,!1)}var Yp=typeof setTimeout=="function"?setTimeout:void 0,w0=typeof clearTimeout=="function"?clearTimeout:void 0,Jp=typeof Promise=="function"?Promise:void 0,_0=typeof queueMicrotask=="function"?queueMicrotask:typeof Jp<"u"?function(s){return Jp.resolve(null).then(s).catch(S0)}:Yp;function S0(s){setTimeout(function(){throw s})}function on(s){return s==="head"}function Xp(s,t){var n=t,i=0;do{var o=n.nextSibling;if(s.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"||n==="/&"){if(i===0){s.removeChild(o),Ir(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")$i(s.ownerDocument.documentElement);else if(n==="head"){n=s.ownerDocument.head,$i(n);for(var x=n.firstChild;x;){var v=x.nextSibling,k=x.nodeName;x[Cn]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&x.rel.toLowerCase()==="stylesheet"||n.removeChild(x),x=v}}else n==="body"&&$i(s.ownerDocument.body);n=o}while(n);Ir(t)}function Zp(s,t){var n=s;s=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(s===0)break;s--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||s++;n=i}while(n)}function fm(s){var t=s.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":fm(n),Nd(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}s.removeChild(n)}}function k0(s,t,n,i){for(;s.nodeType===1;){var o=n;if(s.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(i){if(!s[Cn])switch(t){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==o.rel||s.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||s.getAttribute("title")!==(o.title==null?null:o.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(o.src==null?null:o.src)||s.getAttribute("type")!==(o.type==null?null:o.type)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(t==="input"&&s.type==="hidden"){var x=o.name==null?null:""+o.name;if(o.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=Ja(s.nextSibling),s===null)break}return null}function C0(s,t,n){if(t==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!n||(s=Ja(s.nextSibling),s===null))return null;return s}function Wp(s,t){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!t||(s=Ja(s.nextSibling),s===null))return null;return s}function pm(s){return s.data==="$?"||s.data==="$~"}function gm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function T0(s,t){var n=s.ownerDocument;if(s.data==="$~")s._reactRetry=t;else if(s.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),s._reactRetry=i}}function Ja(s){for(;s!=null;s=s.nextSibling){var t=s.nodeType;if(t===1||t===3)break;if(t===8){if(t=s.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return s}var jm=null;function eg(s){s=s.nextSibling;for(var t=0;s;){if(s.nodeType===8){var n=s.data;if(n==="/$"||n==="/&"){if(t===0)return Ja(s.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}s=s.nextSibling}return null}function sg(s){s=s.previousSibling;for(var t=0;s;){if(s.nodeType===8){var n=s.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return s;t--}else n!=="/$"&&n!=="/&"||t++}s=s.previousSibling}return null}function tg(s,t,n){switch(t=vo(n),s){case"html":if(s=t.documentElement,!s)throw Error(c(452));return s;case"head":if(s=t.head,!s)throw Error(c(453));return s;case"body":if(s=t.body,!s)throw Error(c(454));return s;default:throw Error(c(451))}}function $i(s){for(var t=s.attributes;t.length;)s.removeAttributeNode(t[0]);Nd(s)}var Xa=new Map,ag=new Set;function No(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Rl=K.d;K.d={f:E0,r:M0,D:A0,C:z0,L:R0,m:D0,X:L0,S:O0,M:U0};function E0(){var s=Rl.f(),t=uo();return s||t}function M0(s){var t=nr(s);t!==null&&t.tag===5&&t.type==="form"?Nf(t):Rl.r(s)}var Ur=typeof document>"u"?null:document;function lg(s,t,n){var i=Ur;if(i&&typeof t=="string"&&t){var o=Ha(t);o='link[rel="'+s+'"][href="'+o+'"]',typeof n=="string"&&(o+='[crossorigin="'+n+'"]'),ag.has(o)||(ag.add(o),s={rel:s,crossOrigin:n,href:t},i.querySelector(o)===null&&(t=i.createElement("link"),sa(t,"link",s),Gt(t),i.head.appendChild(t)))}}function A0(s){Rl.D(s),lg("dns-prefetch",s,null)}function z0(s,t){Rl.C(s,t),lg("preconnect",s,t)}function R0(s,t,n){Rl.L(s,t,n);var i=Ur;if(i&&s&&t){var o='link[rel="preload"][as="'+Ha(t)+'"]';t==="image"&&n&&n.imageSrcSet?(o+='[imagesrcset="'+Ha(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(o+='[imagesizes="'+Ha(n.imageSizes)+'"]')):o+='[href="'+Ha(s)+'"]';var x=o;switch(t){case"style":x=$r(s);break;case"script":x=Br(s)}Xa.has(x)||(s=j({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:s,as:t},n),Xa.set(x,s),i.querySelector(o)!==null||t==="style"&&i.querySelector(Bi(x))||t==="script"&&i.querySelector(Ii(x))||(t=i.createElement("link"),sa(t,"link",s),Gt(t),i.head.appendChild(t)))}}function D0(s,t){Rl.m(s,t);var n=Ur;if(n&&s){var i=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ha(i)+'"][href="'+Ha(s)+'"]',x=o;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Br(s)}if(!Xa.has(x)&&(s=j({rel:"modulepreload",href:s},t),Xa.set(x,s),n.querySelector(o)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ii(x)))return}i=n.createElement("link"),sa(i,"link",s),Gt(i),n.head.appendChild(i)}}}function O0(s,t,n){Rl.S(s,t,n);var i=Ur;if(i&&s){var o=rr(i).hoistableStyles,x=$r(s);t=t||"default";var v=o.get(x);if(!v){var k={loading:0,preload:null};if(v=i.querySelector(Bi(x)))k.loading=5;else{s=j({rel:"stylesheet",href:s,"data-precedence":t},n),(n=Xa.get(x))&&vm(s,n);var I=v=i.createElement("link");Gt(I),sa(I,"link",s),I._p=new Promise(function(ie,ve){I.onload=ie,I.onerror=ve}),I.addEventListener("load",function(){k.loading|=1}),I.addEventListener("error",function(){k.loading|=2}),k.loading|=4,bo(v,t,i)}v={type:"stylesheet",instance:v,count:1,state:k},o.set(x,v)}}}function L0(s,t){Rl.X(s,t);var n=Ur;if(n&&s){var i=rr(n).hoistableScripts,o=Br(s),x=i.get(o);x||(x=n.querySelector(Ii(o)),x||(s=j({src:s,async:!0},t),(t=Xa.get(o))&&Nm(s,t),x=n.createElement("script"),Gt(x),sa(x,"link",s),n.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function U0(s,t){Rl.M(s,t);var n=Ur;if(n&&s){var i=rr(n).hoistableScripts,o=Br(s),x=i.get(o);x||(x=n.querySelector(Ii(o)),x||(s=j({src:s,async:!0,type:"module"},t),(t=Xa.get(o))&&Nm(s,t),x=n.createElement("script"),Gt(x),sa(x,"link",s),n.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(o,x))}}function ng(s,t,n,i){var o=(o=z.current)?No(o):null;if(!o)throw Error(c(446));switch(s){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=$r(n.href),n=rr(o).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){s=$r(n.href);var x=rr(o).hoistableStyles,v=x.get(s);if(v||(o=o.ownerDocument||o,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,v),(x=o.querySelector(Bi(s)))&&!x._p&&(v.instance=x,v.state.loading=5),Xa.has(s)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Xa.set(s,n),x||$0(o,s,n,v.state))),t&&i===null)throw Error(c(528,""));return v}if(t&&i!==null)throw Error(c(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Br(n),n=rr(o).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,s))}}function $r(s){return'href="'+Ha(s)+'"'}function Bi(s){return'link[rel="stylesheet"]['+s+"]"}function rg(s){return j({},s,{"data-precedence":s.precedence,precedence:null})}function $0(s,t,n,i){s.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=s.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),sa(t,"link",n),Gt(t),s.head.appendChild(t))}function Br(s){return'[src="'+Ha(s)+'"]'}function Ii(s){return"script[async]"+s}function ig(s,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=s.querySelector('style[data-href~="'+Ha(n.href)+'"]');if(i)return t.instance=i,Gt(i),i;var o=j({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(s.ownerDocument||s).createElement("style"),Gt(i),sa(i,"style",o),bo(i,n.precedence,s),t.instance=i;case"stylesheet":o=$r(n.href);var x=s.querySelector(Bi(o));if(x)return t.state.loading|=4,t.instance=x,Gt(x),x;i=rg(n),(o=Xa.get(o))&&vm(i,o),x=(s.ownerDocument||s).createElement("link"),Gt(x);var v=x;return v._p=new Promise(function(k,I){v.onload=k,v.onerror=I}),sa(x,"link",i),t.state.loading|=4,bo(x,n.precedence,s),t.instance=x;case"script":return x=Br(n.src),(o=s.querySelector(Ii(x)))?(t.instance=o,Gt(o),o):(i=n,(o=Xa.get(x))&&(i=j({},n),Nm(i,o)),s=s.ownerDocument||s,o=s.createElement("script"),Gt(o),sa(o,"link",i),s.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(c(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,bo(i,n.precedence,s));return t.instance}function bo(s,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=i.length?i[i.length-1]:null,x=o,v=0;v<i.length;v++){var k=i[v];if(k.dataset.precedence===t)x=k;else if(x!==o)break}x?x.parentNode.insertBefore(s,x.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(s,t.firstChild))}function vm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.title==null&&(s.title=t.title)}function Nm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.integrity==null&&(s.integrity=t.integrity)}var yo=null;function cg(s,t,n){if(yo===null){var i=new Map,o=yo=new Map;o.set(n,i)}else o=yo,i=o.get(n),i||(i=new Map,o.set(n,i));if(i.has(s))return i;for(i.set(s,null),n=n.getElementsByTagName(s),o=0;o<n.length;o++){var x=n[o];if(!(x[Cn]||x[Ss]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var v=x.getAttribute(t)||"";v=s+v;var k=i.get(v);k?k.push(x):i.set(v,[x])}}return i}function og(s,t,n){s=s.ownerDocument||s,s.head.insertBefore(n,t==="title"?s.querySelector("head > title"):null)}function B0(s,t,n){if(n===1||t.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return s=t.disabled,typeof t.precedence=="string"&&s==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function dg(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function I0(s,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var o=$r(i.href),x=t.querySelector(Bi(o));if(x){t=x._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(s.count++,s=wo.bind(s),t.then(s,s)),n.state.loading|=4,n.instance=x,Gt(x);return}x=t.ownerDocument||t,i=rg(i),(o=Xa.get(o))&&vm(i,o),x=x.createElement("link"),Gt(x);var v=x;v._p=new Promise(function(k,I){v.onload=k,v.onerror=I}),sa(x,"link",i),n.instance=x}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(s.count++,n=wo.bind(s),t.addEventListener("load",n),t.addEventListener("error",n))}}var bm=0;function P0(s,t){return s.stylesheets&&s.count===0&&So(s,s.stylesheets),0<s.count||0<s.imgCount?function(n){var i=setTimeout(function(){if(s.stylesheets&&So(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4+t);0<s.imgBytes&&bm===0&&(bm=62500*b0());var o=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&So(s,s.stylesheets),s.unsuspend)){var x=s.unsuspend;s.unsuspend=null,x()}},(s.imgBytes>bm?50:800)+t);return s.unsuspend=n,function(){s.unsuspend=null,clearTimeout(i),clearTimeout(o)}}:null}function wo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)So(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var _o=null;function So(s,t){s.stylesheets=null,s.unsuspend!==null&&(s.count++,_o=new Map,t.forEach(F0,s),_o=null,wo.call(s))}function F0(s,t){if(!(t.state.loading&4)){var n=_o.get(s);if(n)var i=n.get(null);else{n=new Map,_o.set(s,n);for(var o=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<o.length;x++){var v=o[x];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(n.set(v.dataset.precedence,v),i=v)}i&&n.set(null,i)}o=t.instance,v=o.getAttribute("data-precedence"),x=n.get(v)||i,x===i&&n.set(null,o),n.set(v,o),this.count++,i=wo.bind(this),o.addEventListener("load",i),o.addEventListener("error",i),x?x.parentNode.insertBefore(o,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(o,s.firstChild)),t.state.loading|=4}}var Pi={$$typeof:E,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function H0(s,t,n,i,o,x,v,k,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ye(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ye(0),this.hiddenUpdates=ye(null),this.identifierPrefix=i,this.onUncaughtError=o,this.onCaughtError=x,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function ug(s,t,n,i,o,x,v,k,I,ie,ve,we){return s=new H0(s,t,n,v,I,ie,ve,we,k),t=1,x===!0&&(t|=24),x=Ta(3,null,null,t),s.current=x,x.stateNode=s,t=eu(),t.refCount++,s.pooledCache=t,t.refCount++,x.memoizedState={element:i,isDehydrated:n,cache:t},lu(x),s}function mg(s){return s?(s=pr,s):pr}function xg(s,t,n,i,o,x){o=mg(o),i.context===null?i.context=o:i.pendingContext=o,i=Xl(t),i.payload={element:n},x=x===void 0?null:x,x!==null&&(i.callback=x),n=Zl(s,i,t),n!==null&&(ba(n,s,t),vi(n,s,t))}function hg(s,t){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var n=s.retryLane;s.retryLane=n!==0&&n<t?n:t}}function ym(s,t){hg(s,t),(s=s.alternate)&&hg(s,t)}function fg(s){if(s.tag===13||s.tag===31){var t=zn(s,67108864);t!==null&&ba(t,s,67108864),ym(s,67108864)}}function pg(s){if(s.tag===13||s.tag===31){var t=Ra();t=kt(t);var n=zn(s,t);n!==null&&ba(n,s,t),ym(s,t)}}var ko=!0;function q0(s,t,n,i){var o=D.T;D.T=null;var x=K.p;try{K.p=2,wm(s,t,n,i)}finally{K.p=x,D.T=o}}function V0(s,t,n,i){var o=D.T;D.T=null;var x=K.p;try{K.p=8,wm(s,t,n,i)}finally{K.p=x,D.T=o}}function wm(s,t,n,i){if(ko){var o=_m(i);if(o===null)om(s,t,i,Co,n),jg(s,i);else if(K0(o,s,t,n,i))i.stopPropagation();else if(jg(s,i),t&4&&-1<G0.indexOf(s)){for(;o!==null;){var x=nr(o);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var v=ca(x.pendingLanes);if(v!==0){var k=x;for(k.pendingLanes|=2,k.entangledLanes|=2;v;){var I=1<<31-_s(v);k.entanglements[1]|=I,v&=~I}ul(x),(Xs&6)===0&&(co=Is()+500,Oi(0))}}break;case 31:case 13:k=zn(x,2),k!==null&&ba(k,x,2),uo(),ym(x,2)}if(x=_m(i),x===null&&om(s,t,i,Co,n),x===o)break;o=x}o!==null&&i.stopPropagation()}else om(s,t,i,null,n)}}function _m(s){return s=kd(s),Sm(s)}var Co=null;function Sm(s){if(Co=null,s=lr(s),s!==null){var t=m(s);if(t===null)s=null;else{var n=t.tag;if(n===13){if(s=h(t),s!==null)return s;s=null}else if(n===31){if(s=f(t),s!==null)return s;s=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;s=null}else t!==s&&(s=null)}}return Co=s,null}function gg(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Y()){case qe:return 2;case Ke:return 8;case Ze:case Ts:return 32;case He:return 268435456;default:return 32}default:return 32}}var km=!1,dn=null,un=null,mn=null,Fi=new Map,Hi=new Map,xn=[],G0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jg(s,t){switch(s){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":un=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":Fi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hi.delete(t.pointerId)}}function qi(s,t,n,i,o,x){return s===null||s.nativeEvent!==x?(s={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:x,targetContainers:[o]},t!==null&&(t=nr(t),t!==null&&fg(t)),s):(s.eventSystemFlags|=i,t=s.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),s)}function K0(s,t,n,i,o){switch(t){case"focusin":return dn=qi(dn,s,t,n,i,o),!0;case"dragenter":return un=qi(un,s,t,n,i,o),!0;case"mouseover":return mn=qi(mn,s,t,n,i,o),!0;case"pointerover":var x=o.pointerId;return Fi.set(x,qi(Fi.get(x)||null,s,t,n,i,o)),!0;case"gotpointercapture":return x=o.pointerId,Hi.set(x,qi(Hi.get(x)||null,s,t,n,i,o)),!0}return!1}function vg(s){var t=lr(s.target);if(t!==null){var n=m(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){s.blockedOn=t,fe(s.priority,function(){pg(n)});return}}else if(t===31){if(t=f(n),t!==null){s.blockedOn=t,fe(s.priority,function(){pg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){s.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}s.blockedOn=null}function To(s){if(s.blockedOn!==null)return!1;for(var t=s.targetContainers;0<t.length;){var n=_m(s.nativeEvent);if(n===null){n=s.nativeEvent;var i=new n.constructor(n.type,n);Sd=i,n.target.dispatchEvent(i),Sd=null}else return t=nr(n),t!==null&&fg(t),s.blockedOn=n,!1;t.shift()}return!0}function Ng(s,t,n){To(s)&&n.delete(t)}function Q0(){km=!1,dn!==null&&To(dn)&&(dn=null),un!==null&&To(un)&&(un=null),mn!==null&&To(mn)&&(mn=null),Fi.forEach(Ng),Hi.forEach(Ng)}function Eo(s,t){s.blockedOn===t&&(s.blockedOn=null,km||(km=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Q0)))}var Mo=null;function bg(s){Mo!==s&&(Mo=s,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Mo===s&&(Mo=null);for(var t=0;t<s.length;t+=3){var n=s[t],i=s[t+1],o=s[t+2];if(typeof i!="function"){if(Sm(i||n)===null)continue;break}var x=nr(n);x!==null&&(s.splice(t,3),t-=3,_u(x,{pending:!0,data:o,method:n.method,action:i},i,o))}}))}function Ir(s){function t(I){return Eo(I,s)}dn!==null&&Eo(dn,s),un!==null&&Eo(un,s),mn!==null&&Eo(mn,s),Fi.forEach(t),Hi.forEach(t);for(var n=0;n<xn.length;n++){var i=xn[n];i.blockedOn===s&&(i.blockedOn=null)}for(;0<xn.length&&(n=xn[0],n.blockedOn===null);)vg(n),n.blockedOn===null&&xn.shift();if(n=(s.ownerDocument||s).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var o=n[i],x=n[i+1],v=o[hs]||null;if(typeof x=="function")v||bg(n);else if(v){var k=null;if(x&&x.hasAttribute("formAction")){if(o=x,v=x[hs]||null)k=v.formAction;else if(Sm(o)!==null)continue}else k=v.action;typeof k=="function"?n[i+1]=k:(n.splice(i,3),i-=3),bg(n)}}}function yg(){function s(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(v){return o=v})},focusReset:"manual",scroll:"manual"})}function t(){o!==null&&(o(),o=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,o=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),o!==null&&(o(),o=null)}}}function Cm(s){this._internalRoot=s}Ao.prototype.render=Cm.prototype.render=function(s){var t=this._internalRoot;if(t===null)throw Error(c(409));var n=t.current,i=Ra();xg(n,i,s,t,null,null)},Ao.prototype.unmount=Cm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var t=s.containerInfo;xg(s.current,2,null,s,null,null),uo(),t[yt]=null}};function Ao(s){this._internalRoot=s}Ao.prototype.unstable_scheduleHydration=function(s){if(s){var t=le();s={blockedOn:null,target:s,priority:t};for(var n=0;n<xn.length&&t!==0&&t<xn[n].priority;n++);xn.splice(n,0,s),n===0&&vg(s)}};var wg=l.version;if(wg!=="19.2.1")throw Error(c(527,wg,"19.2.1"));K.findDOMNode=function(s){var t=s._reactInternals;if(t===void 0)throw typeof s.render=="function"?Error(c(188)):(s=Object.keys(s).join(","),Error(c(268,s)));return s=g(t),s=s!==null?N(s):null,s=s===null?null:s.stateNode,s};var Y0={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zo.isDisabled&&zo.supportsFiber)try{Ks=zo.inject(Y0),cs=zo}catch{}}return Vi.createRoot=function(s,t){if(!d(s))throw Error(c(299));var n=!1,i="",o=Mf,x=Af,v=zf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(x=t.onCaughtError),t.onRecoverableError!==void 0&&(v=t.onRecoverableError)),t=ug(s,1,!1,null,null,n,i,null,o,x,v,yg),s[yt]=t.current,cm(s),new Cm(t)},Vi.hydrateRoot=function(s,t,n){if(!d(s))throw Error(c(299));var i=!1,o="",x=Mf,v=Af,k=zf,I=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(x=n.onUncaughtError),n.onCaughtError!==void 0&&(v=n.onCaughtError),n.onRecoverableError!==void 0&&(k=n.onRecoverableError),n.formState!==void 0&&(I=n.formState)),t=ug(s,1,!0,t,n??null,i,o,I,x,v,k,yg),t.context=mg(null),n=t.current,i=Ra(),i=kt(i),o=Xl(i),o.callback=null,Zl(n,o,i),n=i,t.current.lanes=n,U(t,n),ul(t),s[yt]=t.current,cm(s),new Ao(t)},Vi.version="19.2.1",Vi}var Ag;function A_(){if(Ag)return zm.exports;Ag=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(l){console.error(l)}}return a(),zm.exports=M_(),zm.exports}var z_=A_();function F(...a){return cw(ow(a))}const Ce=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("rounded-xl border bg-card text-card-foreground shadow",a),...l}));Ce.displayName="Card";const De=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("flex flex-col space-y-1.5 p-6",a),...l}));De.displayName="CardHeader";const Ue=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("font-semibold leading-none tracking-tight",a),...l}));Ue.displayName="CardTitle";const fs=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("text-sm text-muted-foreground",a),...l}));fs.displayName="CardDescription";const Ae=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("p-6 pt-0",a),...l}));Ae.displayName="CardContent";const id=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("flex items-center p-6 pt-0",a),...l}));id.displayName="CardFooter";const Yt=uw,Vt=u.forwardRef(({className:a,...l},r)=>e.jsx(oj,{ref:r,className:F("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...l}));Vt.displayName=oj.displayName;const Ye=u.forwardRef(({className:a,...l},r)=>e.jsx(dj,{ref:r,className:F("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...l}));Ye.displayName=dj.displayName;const Ms=u.forwardRef(({className:a,...l},r)=>e.jsx(uj,{ref:r,className:F("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 data-[state=active]:animate-in data-[state=active]:fade-in data-[state=active]:duration-300",a),...l}));Ms.displayName=uj.displayName;const ss=u.forwardRef(({className:a,children:l,viewportRef:r,...c},d)=>e.jsxs(mj,{ref:d,className:F("relative overflow-hidden",a),...c,children:[e.jsx(mw,{ref:r,className:"h-full w-full rounded-[inherit]",children:l}),e.jsx(Ym,{}),e.jsx(Ym,{orientation:"horizontal"}),e.jsx(xw,{})]}));ss.displayName=mj.displayName;const Ym=u.forwardRef(({className:a,orientation:l="vertical",...r},c)=>e.jsx(xj,{ref:c,orientation:l,className:F("flex touch-none select-none transition-colors",l==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",l==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...r,children:e.jsx(hw,{className:"relative flex-1 rounded-full bg-border"})}));Ym.displayName=xj.displayName;function As({className:a,...l}){return e.jsx("div",{className:F("animate-pulse rounded-md bg-primary/10",a),...l})}const er=u.forwardRef(({className:a,value:l,...r},c)=>e.jsx(hj,{ref:c,className:F("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...r,children:e.jsx(fw,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(l||0)}%)`}})}));er.displayName=hj.displayName;async function Se(a,l){const c=l?.body instanceof FormData?{...l?.headers}:{"Content-Type":"application/json",...l?.headers},d={...l,credentials:"include",headers:c},m=await fetch(a,d);if(m.status===401)throw window.location.href="/auth",new Error("");return m}function Ws(){return{"Content-Type":"application/json"}}async function R_(){try{await fetch("/api/webui/auth/logout",{method:"POST",credentials:"include"})}catch(a){console.error(":",a)}window.location.href="/auth"}async function cc(){try{return(await(await fetch("/api/webui/auth/check",{method:"GET",credentials:"include"})).json()).authenticated===!0}catch{return!1}}const D_={light:"",dark:".dark"},Cv=u.createContext(null);function Tv(){const a=u.useContext(Cv);if(!a)throw new Error("useChart must be used within a <ChartContainer />");return a}const Vr=u.forwardRef(({id:a,className:l,children:r,config:c,...d},m)=>{const h=u.useId(),f=`chart-${a||h.replace(/:/g,"")}`;return e.jsx(Cv.Provider,{value:{config:c},children:e.jsxs("div",{"data-chart":f,ref:m,className:F("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...d,children:[e.jsx(O_,{id:f,config:c}),e.jsx(zj,{children:r})]})})});Vr.displayName="Chart";const O_=({id:a,config:l})=>{const r=Object.entries(l).filter(([,c])=>c.theme||c.color);return r.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(D_).map(([c,d])=>`
${d} [data-chart=${a}] {
${r.map(([m,h])=>{const f=h.theme?.[c]||h.color;return f?`  --color-${m}: ${f};`:null}).join(`
`)}
}
`).join(`
`)}}):null},Gi=Rj,Gr=u.forwardRef(({active:a,payload:l,className:r,indicator:c="dot",hideLabel:d=!1,hideIndicator:m=!1,label:h,labelFormatter:f,labelClassName:p,formatter:g,color:N,nameKey:j,labelKey:y},b)=>{const{config:w}=Tv(),A=u.useMemo(()=>{if(d||!l?.length)return null;const[S]=l,P=`${y||S?.dataKey||S?.name||"value"}`,E=Jm(w,S,P),C=!y&&typeof h=="string"?w[h]?.label||h:E?.label;return f?e.jsx("div",{className:F("font-medium",p),children:f(C,l)}):C?e.jsx("div",{className:F("font-medium",p),children:C}):null},[h,f,l,d,p,w,y]);if(!a||!l?.length)return null;const M=l.length===1&&c!=="dot";return e.jsxs("div",{ref:b,className:F("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[M?null:A,e.jsx("div",{className:"grid gap-1.5",children:l.filter(S=>S.type!=="none").map((S,P)=>{const E=`${j||S.name||S.dataKey||"value"}`,C=Jm(w,S,E),R=N||S.payload.fill||S.color;return e.jsx("div",{className:F("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",c==="dot"&&"items-center"),children:g&&S?.value!==void 0&&S.name?g(S.value,S.name,S,P,S.payload):e.jsxs(e.Fragment,{children:[C?.icon?e.jsx(C.icon,{}):!m&&e.jsx("div",{className:F("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":c==="dot","w-1":c==="line","w-0 border-[1.5px] border-dashed bg-transparent":c==="dashed","my-0.5":M&&c==="dashed"}),style:{"--color-bg":R,"--color-border":R}}),e.jsxs("div",{className:F("flex flex-1 justify-between leading-none",M?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[M?A:null,e.jsx("span",{className:"text-muted-foreground",children:C?.label||S.name})]}),S.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:S.value.toLocaleString()})]})]})},S.dataKey)})})]})});Gr.displayName="ChartTooltip";const L_=Kw,Ev=u.forwardRef(({className:a,hideIcon:l=!1,payload:r,verticalAlign:c="bottom",nameKey:d},m)=>{const{config:h}=Tv();return r?.length?e.jsx("div",{ref:m,className:F("flex items-center justify-center gap-4",c==="top"?"pb-3":"pt-3",a),children:r.filter(f=>f.type!=="none").map(f=>{const p=`${d||f.dataKey||"value"}`,g=Jm(h,f,p);return e.jsxs("div",{className:F("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[g?.icon&&!l?e.jsx(g.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:f.color}}),g?.label]},f.value)})}):null});Ev.displayName="ChartLegend";function Jm(a,l,r){if(typeof l!="object"||l===null)return;const c="payload"in l&&typeof l.payload=="object"&&l.payload!==null?l.payload:void 0;let d=r;return r in l&&typeof l[r]=="string"?d=l[r]:c&&r in c&&typeof c[r]=="string"&&(d=c[r]),d in a?a[d]:a[r]}const Wr=ei("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_=u.forwardRef(({className:a,variant:l,size:r,asChild:c=!1,...d},m)=>{const h=c?Ww:"button";return e.jsx(h,{className:F(Wr({variant:l,size:r,className:a})),ref:m,...d})});_.displayName="Button";const U_=ei("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ke({className:a,variant:l,...r}){return e.jsx("div",{className:F(U_({variant:l}),a),...r})}async function $_(){const a=await Se("/api/webui/system/restart",{method:"POST",headers:Ws()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return await a.json()}async function B_(){const a=await Se("/api/webui/system/status",{method:"GET",headers:Ws()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return await a.json()}const Pr={INITIAL_DELAY:3e3,CHECK_INTERVAL:2e3,CHECK_TIMEOUT:3e3,MAX_ATTEMPTS:60,PROGRESS_INTERVAL:200,SUCCESS_REDIRECT_DELAY:1500},Mv=u.createContext(null);function tr({children:a,onRestartComplete:l,onRestartFailed:r,healthCheckUrl:c="/api/webui/system/status",maxAttempts:d=Pr.MAX_ATTEMPTS}){const[m,h]=u.useState({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),f=u.useRef({}),p=u.useCallback(()=>{const A=f.current;A.progress&&(clearInterval(A.progress),A.progress=void 0),A.elapsed&&(clearInterval(A.elapsed),A.elapsed=void 0),A.check&&(clearTimeout(A.check),A.check=void 0)},[]),g=u.useCallback(()=>{p(),h({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d})},[p,d]),N=u.useCallback(async()=>{try{const A=new AbortController,M=setTimeout(()=>A.abort(),Pr.CHECK_TIMEOUT),S=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include",signal:A.signal});return clearTimeout(M),S.ok}catch{return!1}},[c]),j=u.useCallback(()=>{let A=0;const M=async()=>{if(A++,h(P=>({...P,status:"checking",checkAttempts:A})),await N())p(),h(P=>({...P,status:"success",progress:100})),setTimeout(()=>{l?.(),window.location.href="/auth"},Pr.SUCCESS_REDIRECT_DELAY);else if(A>=d){p();const P=` (${A}/${d})`;h(E=>({...E,status:"failed",error:P})),r?.(P)}else{const P=setTimeout(M,Pr.CHECK_INTERVAL);f.current.check=P}};M()},[N,p,d,l,r]),y=u.useCallback(()=>{h(A=>({...A,status:"checking",checkAttempts:0,error:void 0})),j()},[j]),b=u.useCallback(async A=>{const{delay:M=0,skipApiCall:S=!1}=A??{};if(m.status!=="idle"&&m.status!=="failed")return;if(p(),h({status:"requesting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:d}),M>0&&await new Promise(C=>setTimeout(C,M)),S)h(C=>({...C,status:"restarting"}));else try{h(C=>({...C,status:"restarting"})),await Promise.race([$_(),new Promise(C=>setTimeout(C,5e3))])}catch{}const P=setInterval(()=>{h(C=>({...C,progress:C.progress>=90?C.progress:C.progress+1}))},Pr.PROGRESS_INTERVAL),E=setInterval(()=>{h(C=>({...C,elapsedTime:C.elapsedTime+1}))},1e3);f.current.progress=P,f.current.elapsed=E,setTimeout(()=>{j()},Pr.INITIAL_DELAY)},[m.status,p,d,j]),w={state:m,isRestarting:m.status!=="idle",triggerRestart:b,resetState:g,retryHealthCheck:y};return e.jsx(Mv.Provider,{value:w,children:a})}function _n(){const a=u.useContext(Mv);if(!a)throw new Error("useRestart must be used within a RestartProvider");return a}function I_(){try{return _n()}catch{return null}}const P_=(a,l,r,c,d)=>({idle:{icon:null,title:"",description:"",tip:""},requesting:{icon:e.jsx(Fs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},restarting:{icon:e.jsx(Fs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:d??"...",tip:" ..."},checking:{icon:e.jsx(Fs,{className:"h-16 w-16 text-primary animate-spin"}),title:"",description:`... (${l}/${r})`,tip:" ..."},success:{icon:e.jsx(tt,{className:"h-16 w-16 text-green-500"}),title:"",description:"...",tip:" "},failed:{icon:e.jsx(Rt,{className:"h-16 w-16 text-destructive"}),title:"",description:"",tip:" "}})[a];function ar({visible:a,onComplete:l,onFailed:r,title:c,description:d,showAnimation:m=!0,className:h}){const f=I_();return(f?f.isRestarting:a)?f?e.jsx(Av,{state:f.state,onRetry:f.retryHealthCheck,onComplete:l,onFailed:r,title:c,description:d,showAnimation:m,className:h}):e.jsx(F_,{onComplete:l,onFailed:r,title:c,description:d,showAnimation:m,className:h}):null}function Av({state:a,onRetry:l,onComplete:r,onFailed:c,title:d,description:m,showAnimation:h,className:f}){const{status:p,progress:g,elapsedTime:N,checkAttempts:j,maxAttempts:y}=a;u.useEffect(()=>{p==="success"&&r?r():p==="failed"&&c&&c()},[p,r,c]);const b=P_(p,j,y,d,m),w=A=>{const M=Math.floor(A/60),S=A%60;return`${M}:${S.toString().padStart(2,"0")}`};return e.jsxs("div",{className:F("fixed inset-0 bg-background/95 backdrop-blur-sm z-50 flex items-center justify-center",f),children:[h&&e.jsx(H_,{}),e.jsxs("div",{className:"max-w-md w-full mx-4 space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[b.icon,(p==="restarting"||p==="checking")&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/20 animate-ping"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:b.title}),e.jsx("p",{className:"text-muted-foreground text-center",children:b.description})]}),p!=="failed"&&p!=="idle"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(er,{value:g,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[g,"%"]}),e.jsxs("span",{children:[": ",w(N)]})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:b.tip})}),p==="failed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{onClick:()=>window.location.reload(),variant:"default",className:"flex-1",children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:l,variant:"secondary",className:"flex-1",children:[e.jsx(lc,{className:"mr-2 h-4 w-4"}),""]})]})]})]})}function F_({onComplete:a,onFailed:l,title:r,description:c,showAnimation:d,className:m}){const[h,f]=u.useState({status:"restarting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:60}),p=u.useCallback(()=>{let g=0;const N=60,j=async()=>{g++,f(y=>({...y,status:"checking",checkAttempts:g}));try{if((await fetch("/api/webui/system/status",{method:"GET",signal:AbortSignal.timeout(3e3)})).ok){f(b=>({...b,status:"success",progress:100})),setTimeout(()=>{a?.(),window.location.href="/auth"},1500);return}}catch{}g>=N?(f(y=>({...y,status:"failed"})),l?.()):setTimeout(j,2e3)};j()},[a,l]);return u.useEffect(()=>{const g=setInterval(()=>{f(y=>({...y,progress:y.progress>=90?y.progress:y.progress+1}))},200),N=setInterval(()=>{f(y=>({...y,elapsedTime:y.elapsedTime+1}))},1e3),j=setTimeout(()=>{p()},3e3);return()=>{clearInterval(g),clearInterval(N),clearTimeout(j)}},[p]),e.jsx(Av,{state:h,onRetry:p,onComplete:a,onFailed:l,title:r,description:c,showAnimation:d,className:m})}function H_(){return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite]"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_0.5s]"}),e.jsx("div",{className:"absolute inset-16 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_1s]"})]}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-bounce"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-primary/15 rounded-full animate-bounce delay-150"}),e.jsx("div",{className:"absolute top-1/2 right-1/3 w-2 h-2 bg-primary/20 rounded-full animate-bounce delay-300"})]})}const Js=t1,cd=a1,q_=e1,zv=u.forwardRef(({className:a,...l},r)=>e.jsx(Dj,{ref:r,className:F("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l}));zv.displayName=Dj.displayName;const qs=u.forwardRef(({className:a,children:l,preventOutsideClose:r=!1,hideCloseButton:c=!1,...d},m)=>e.jsxs(q_,{children:[e.jsx(zv,{}),e.jsxs(Oj,{ref:m,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),onPointerDownOutside:r?h=>h.preventDefault():void 0,onInteractOutside:r?h=>h.preventDefault():void 0,...d,children:[l,!c&&e.jsxs(s1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(_a,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qs.displayName=Oj.displayName;const Vs=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col space-y-1.5 text-center sm:text-left",a),...l});Vs.displayName="DialogHeader";const xt=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...l});xt.displayName="DialogFooter";const Gs=u.forwardRef(({className:a,...l},r)=>e.jsx(Lj,{ref:r,className:F("text-lg font-semibold leading-none tracking-tight",a),...l}));Gs.displayName=Lj.displayName;const nt=u.forwardRef(({className:a,...l},r)=>e.jsx(Uj,{ref:r,className:F("text-sm text-muted-foreground",a),...l}));nt.displayName=Uj.displayName;const ne=u.forwardRef(({className:a,type:l,...r},c)=>e.jsx("input",{type:l,className:F("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:c,...r}));ne.displayName="Input";const lt=u.forwardRef(({className:a,...l},r)=>e.jsx($j,{ref:r,className:F("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:e.jsx(l1,{className:F("grid place-content-center text-current"),children:e.jsx(Lt,{className:"h-4 w-4"})})}));lt.displayName=$j.displayName;const Pe=d1,Fe=u1,Be=u.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(Bj,{ref:c,className:F("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[l,e.jsx(n1,{asChild:!0,children:e.jsx($a,{className:"h-4 w-4 opacity-50"})})]}));Be.displayName=Bj.displayName;const Rv=u.forwardRef(({className:a,...l},r)=>e.jsx(Ij,{ref:r,className:F("flex cursor-default items-center justify-center py-1",a),...l,children:e.jsx(Yr,{className:"h-4 w-4"})}));Rv.displayName=Ij.displayName;const Dv=u.forwardRef(({className:a,...l},r)=>e.jsx(Pj,{ref:r,className:F("flex cursor-default items-center justify-center py-1",a),...l,children:e.jsx($a,{className:"h-4 w-4"})}));Dv.displayName=Pj.displayName;const Ie=u.forwardRef(({className:a,children:l,position:r="popper",...c},d)=>e.jsx(r1,{children:e.jsxs(Fj,{ref:d,className:F("relative z-[100] max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-hidden rounded-md border border-border bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...c,children:[e.jsx(Rv,{}),e.jsx(i1,{className:F("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),e.jsx(Dv,{})]})}));Ie.displayName=Fj.displayName;const V_=u.forwardRef(({className:a,...l},r)=>e.jsx(Hj,{ref:r,className:F("px-2 py-1.5 text-sm font-semibold",a),...l}));V_.displayName=Hj.displayName;const ee=u.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(qj,{ref:c,className:F("relative flex w-full cursor-default select-none items-center rounded-sm py-2 pl-2 pr-8 text-sm outline-none bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-gray-100 dark:focus:bg-gray-800 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(c1,{children:e.jsx(Lt,{className:"h-4 w-4"})})}),e.jsx(o1,{children:l})]}));ee.displayName=qj.displayName;const G_=u.forwardRef(({className:a,...l},r)=>e.jsx(Vj,{ref:r,className:F("-mx-1 my-1 h-px bg-muted",a),...l}));G_.displayName=Vj.displayName;const ux=({className:a,...l})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:F("mx-auto flex w-full justify-center",a),...l});ux.displayName="Pagination";const mx=u.forwardRef(({className:a,...l},r)=>e.jsx("ul",{ref:r,className:F("flex flex-row items-center gap-1",a),...l}));mx.displayName="PaginationContent";const Yn=u.forwardRef(({className:a,...l},r)=>e.jsx("li",{ref:r,className:F("",a),...l}));Yn.displayName="PaginationItem";const pc=({className:a,isActive:l,size:r="icon",...c})=>e.jsx("a",{"aria-current":l?"page":void 0,className:F(Wr({variant:l?"outline":"ghost",size:r}),a),...c});pc.displayName="PaginationLink";const Ov=({className:a,...l})=>e.jsxs(pc,{"aria-label":"Go to previous page",size:"default",className:F("gap-1 pl-2.5",a),...l,children:[e.jsx(Ia,{className:"h-4 w-4"}),e.jsx("span",{children:""})]});Ov.displayName="PaginationPrevious";const Lv=({className:a,...l})=>e.jsxs(pc,{"aria-label":"Go to next page",size:"default",className:F("gap-1 pr-2.5",a),...l,children:[e.jsx("span",{children:""}),e.jsx(ra,{className:"h-4 w-4"})]});Lv.displayName="PaginationNext";const Uv=({className:a,...l})=>e.jsxs("span",{"aria-hidden":!0,className:F("flex h-9 w-9 items-center justify-center",a),...l,children:[e.jsx(y1,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});Uv.displayName="PaginationEllipsis";const K_=5,Q_=5e3;let Om=0;function Y_(){return Om=(Om+1)%Number.MAX_SAFE_INTEGER,Om.toString()}const Lm=new Map,zg=a=>{if(Lm.has(a))return;const l=setTimeout(()=>{Lm.delete(a),sc({type:"REMOVE_TOAST",toastId:a})},Q_);Lm.set(a,l)},J_=(a,l)=>{switch(l.type){case"ADD_TOAST":return{...a,toasts:[l.toast,...a.toasts].slice(0,K_)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(r=>r.id===l.toast.id?{...r,...l.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=l;return r?zg(r):a.toasts.forEach(c=>{zg(c.id)}),{...a,toasts:a.toasts.map(c=>c.id===r||r===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return l.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(r=>r.id!==l.toastId)}}},Io=[];let Po={toasts:[]};function sc(a){Po=J_(Po,a),Io.forEach(l=>{l(Po)})}function aa({...a}){const l=Y_(),r=d=>sc({type:"UPDATE_TOAST",toast:{...d,id:l}}),c=()=>sc({type:"DISMISS_TOAST",toastId:l});return sc({type:"ADD_TOAST",toast:{...a,id:l,open:!0,onOpenChange:d=>{d||c()}}}),{id:l,dismiss:c,update:r}}function it(){const[a,l]=u.useState(Po);return u.useEffect(()=>(Io.push(l),()=>{const r=Io.indexOf(l);r>-1&&Io.splice(r,1)}),[a]),{...a,toast:aa,dismiss:r=>sc({type:"DISMISS_TOAST",toastId:r})}}const rl="/api/webui/expression";async function xx(){const a=await Se(`${rl}/chats`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function X_(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id);const r=await Se(`${rl}/list?${l}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function Z_(a){const l=await Se(`${rl}/${a}`,{});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function W_(a){const l=await Se(`${rl}/`,{method:"POST",body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function e2(a,l){const r=await Se(`${rl}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function s2(a){const l=await Se(`${rl}/${a}`,{method:"DELETE"});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function t2(a){const l=await Se(`${rl}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function a2(){const a=await Se(`${rl}/stats/summary`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function hx(){const a=await Se(`${rl}/review/stats`);if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function Rg(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.filter_type&&l.append("filter_type",a.filter_type),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id);const r=await Se(`${rl}/review/list?${l}`);if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function Um(a){const l=await Se(`${rl}/review/batch`,{method:"POST",body:JSON.stringify({items:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function $v({open:a,onOpenChange:l}){const[r,c]=u.useState("list"),[d,m]=u.useState(null),[h,f]=u.useState([]),[p,g]=u.useState("unchecked"),[N,j]=u.useState([]),[y,b]=u.useState(0),[w,A]=u.useState(!1),[M,S]=u.useState(0),[P,E]=u.useState(1),[C,R]=u.useState(null),[H,O]=u.useState(0),[X,L]=u.useState(!1),[me,Ne]=u.useState(null),je=u.useRef(null),ce=u.useRef(null),ge=u.useRef(!1),[pe,D]=u.useState(!1),[K,B]=u.useState(!1),[ue,Q]=u.useState(0),[_e,he]=u.useState(1),[Te,V]=u.useState(20),[$,z]=u.useState(""),[G,Re]=u.useState("unchecked"),[se,Oe]=u.useState(""),[ns,J]=u.useState(""),[Z,Le]=u.useState(new Set),[ae,Ee]=u.useState(new Set),[de,ze]=u.useState(new Map),{toast:ws}=it(),Zs=u.useCallback(async()=>{try{B(!0);const U=await hx();m(U)}catch(U){console.error(":",U)}finally{B(!1)}},[]),St=u.useCallback(async()=>{try{D(!0);const U=await Rg({page:_e,page_size:Te,filter_type:G,search:se||void 0});f(U.data),Q(U.total)}catch(U){ws({title:"",description:U instanceof Error?U.message:"",variant:"destructive"})}finally{D(!1)}},[_e,Te,G,se,ws]),fa=u.useCallback(async()=>{try{const U=await xx();if(U?.data){const Me=new Map;U.data.forEach(Xe=>{Me.set(Xe.chat_id,Xe.chat_name)}),ze(Me)}}catch(U){console.error(":",U)}},[]),xs=u.useCallback(async(U=!0,Me=!1)=>{try{A(!0);const Xe=Me?P+1:P,ds=await Rg({page:Xe,page_size:20,filter_type:p});Me?(j(is=>[...is,...ds.data]),E(Xe)):j(ds.data),S(ds.total),U&&b(0)}catch(Xe){ws({title:"",description:Xe instanceof Error?Xe.message:"",variant:"destructive"})}finally{A(!1)}},[P,p,ws]);u.useEffect(()=>{r==="quick"&&(E(1),b(0))},[p,r]),u.useEffect(()=>{a&&r==="quick"&&(xs(),Zs())},[a,r,P,p,xs,Zs]);const Is=u.useCallback(U=>U?p==="unchecked"?{left:!0,right:!0}:p==="passed"?{left:!0,right:!1}:p==="rejected"?{left:!1,right:!0}:U.checked?U.rejected?{left:!1,right:!0}:{left:!0,right:!1}:{left:!0,right:!0}:{left:!1,right:!1},[p]),Y=u.useCallback(async U=>{const Me=N[y];if(!Me||X)return;const Xe=Is(Me);if(!(U&&!Xe.left||!U&&!Xe.right)){L(!0),R(U?"left":"right"),O(U?-400:400);try{(await Um([{id:Me.id,rejected:U,require_unchecked:p==="unchecked"}])).results[0]?.success?(ws({title:U?"":"",description:` #${Me.id} ${U?"":""}`}),setTimeout(()=>{j(is=>is.filter((kt,Ps)=>Ps!==y)),S(is=>is-1),y>=N.length-1&&b(Math.max(0,y-1)),R(null),O(0),L(!1),Zs(),N.length<=1&&M>1&&xs(!1)},300)):(Ne(Me.id),ws({title:"",description:"...",variant:"destructive"}),setTimeout(()=>{Ne(null),R(null),O(0),L(!1),xs(!1),Zs()},1500))}catch(ds){ws({title:"",description:ds instanceof Error?ds.message:"",variant:"destructive"}),R(null),O(0),L(!1)}}},[N,y,X,Is,p,ws,Zs,M,xs]),qe=u.useCallback((U,Me)=>{X||(ce.current={x:U,y:Me},ge.current=!1)},[X]),Ke=u.useCallback(U=>{X||(L(!0),O(U==="left"?-30:30),setTimeout(()=>{O(0),setTimeout(()=>L(!1),300)},150))},[X]),Ze=u.useCallback(U=>{if(!ce.current||X)return;const Me=U-ce.current.x,Xe=N[y],ds=Is(Xe);if(Me<0&&!ds.left){O(Me*.2),R(null);return}if(Me>0&&!ds.right){O(Me*.2),R(null);return}ge.current=!0,O(Me),Math.abs(Me)>50?R(Me>0?"right":"left"):R(null)},[N,y,Is,X]),Ts=u.useCallback(()=>{if(!ce.current)return;Math.abs(H)>100&&C?Y(C==="left"):(O(0),R(null)),ce.current=null,ge.current=!1},[H,C,Y]),He=u.useCallback(U=>{qe(U.clientX,U.clientY)},[qe]),zs=u.useCallback(U=>{ce.current&&(U.preventDefault(),Ze(U.clientX))},[Ze]),Ls=u.useCallback(()=>{Ts()},[Ts]),Ks=u.useCallback(()=>{ce.current&&Ts()},[Ts]),cs=u.useCallback(U=>{const Me=U.touches[0];qe(Me.clientX,Me.clientY)},[qe]),ts=u.useCallback(U=>{const Me=U.touches[0];Ze(Me.clientX)},[Ze]),_s=u.useCallback(()=>{Ts()},[Ts]);u.useEffect(()=>{if(!a||r!=="quick")return;const U=Me=>{if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(Me.key)||(Me.preventDefault(),Me.stopPropagation(),Me.stopImmediatePropagation(),X||w))return;const Xe=N[y],ds=Is(Xe);Me.key==="ArrowLeft"?ds.left?Y(!0):Ke("left"):Me.key==="ArrowRight"?ds.right?Y(!1):Ke("right"):Me.key==="ArrowDown"?y<N.length-1&&b(is=>is+1):Me.key==="ArrowUp"&&y>0&&b(is=>is-1)};return window.addEventListener("keydown",U,!0),()=>window.removeEventListener("keydown",U,!0)},[a,r,N,y,X,w,Is,Y,Ke]),u.useEffect(()=>{if(!a||r!=="quick"||w)return;const U=N.length-y-1,Me=N.length<M;U<=5&&Me&&xs(!1,!0)},[a,r,y,N.length,M,w,xs]),u.useEffect(()=>{a&&(Zs(),St(),fa())},[a,Zs,St,fa]),u.useEffect(()=>{he(1),Le(new Set)},[G,se]),u.useEffect(()=>{Le(new Set)},[h]);const $e=()=>{Oe(ns),he(1)},ms=U=>de.get(U)||U,os=async(U,Me)=>{try{Ee(ds=>new Set(ds).add(U));const Xe=await Um([{id:U,rejected:Me,require_unchecked:G==="unchecked"}]);Xe.results[0]?.success?(ws({title:Me?"":"",description:` #${U} ${Me?"":""}`}),St(),Zs()):ws({title:"",description:Xe.results[0]?.message||"",variant:"destructive"})}catch(Xe){ws({title:"",description:Xe instanceof Error?Xe.message:"",variant:"destructive"})}finally{Ee(Xe=>{const ds=new Set(Xe);return ds.delete(U),ds})}},rs=async U=>{if(Z.size===0){ws({title:"",description:"",variant:"destructive"});return}try{D(!0);const Me=Array.from(Z).map(ds=>({id:ds,rejected:U,require_unchecked:G==="unchecked"})),Xe=await Um(Me);ws({title:"",description:` ${Xe.succeeded}  ${Xe.failed} `,variant:Xe.failed>0?"destructive":"default"}),Le(new Set),St(),Zs()}catch(Me){ws({title:"",description:Me instanceof Error?Me.message:"",variant:"destructive"})}finally{D(!1)}},ht=()=>{Z.size===h.length?Le(new Set):Le(new Set(h.map(U=>U.id)))},Tt=U=>{Le(Me=>{const Xe=new Set(Me);return Xe.has(U)?Xe.delete(U):Xe.add(U),Xe})},ca=U=>U?new Date(U*1e3).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",ka=U=>U.checked?U.rejected?e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(ta,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"default",className:"gap-1 bg-green-600",children:[e.jsx(tt,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(ia,{className:"h-3 w-3"}),""]}),Pa=U=>U?U==="ai"?e.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(Kn,{className:"h-3 w-3"}),"AI"]}):e.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx($l,{className:"h-3 w-3"}),""]}):null,Jt=Math.ceil(ue/Te),te=()=>{const U=[];if(Jt<=7)for(let Me=1;Me<=Jt;Me++)U.push(Me);else{U.push(1),_e>3&&U.push("ellipsis");const Me=Math.max(2,_e-1),Xe=Math.min(Jt-1,_e+1);for(let ds=Me;ds<=Xe;ds++)U.push(ds);_e<Jt-2&&U.push("ellipsis"),Jt>1&&U.push(Jt)}return U},ye=()=>{const U=parseInt($,10);!isNaN(U)&&U>=1&&U<=Jt&&(he(U),z(""))};return e.jsx(Js,{open:a,onOpenChange:l,children:e.jsxs(qs,{className:"max-w-5xl w-[95vw] sm:w-full h-[90vh] sm:h-[85vh] flex flex-col p-0",hideCloseButton:!0,children:[e.jsxs("div",{className:"flex items-end bg-muted/30 px-2 pt-2 shrink-0",children:[e.jsxs("button",{onClick:()=>c("list"),className:F("group relative flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-t-lg transition-all","hover:bg-background/50",r==="list"?"bg-background text-foreground shadow-sm border border-b-0 border-border":"text-muted-foreground hover:text-foreground"),children:[e.jsx(sv,{className:"h-4 w-4"}),e.jsx("span",{children:""}),r==="list"&&e.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-background"})]}),e.jsxs("button",{onClick:()=>c("quick"),className:F("group relative flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-t-lg transition-all","hover:bg-background/50",r==="quick"?"bg-background text-foreground shadow-sm border border-b-0 border-border":"text-muted-foreground hover:text-foreground"),children:[e.jsx(el,{className:"h-4 w-4"}),e.jsx("span",{children:""}),e.jsx(ke,{variant:"secondary",className:"ml-1 h-5 px-1.5 text-xs",children:""}),r==="quick"&&e.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-background"})]}),e.jsx("div",{className:"flex-1 border-b border-border"}),e.jsx("button",{onClick:()=>l(!1),className:"mb-[1px] p-2 text-muted-foreground hover:text-foreground hover:bg-muted rounded-lg transition-colors",children:e.jsx(_a,{className:"h-4 w-4"})})]}),r==="list"&&e.jsxs(e.Fragment,{children:[e.jsxs(Vs,{className:"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b shrink-0",children:[e.jsx(Gs,{className:"text-lg sm:text-xl",children:""}),e.jsx(nt,{className:"text-xs sm:text-sm",children:""}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mt-4",children:[e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-orange-500",children:K?"-":d?.unchecked??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-500",children:K?"-":d?.passed??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-500",children:K?"-":d?.rejected??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-2 sm:p-3 text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-500",children:K?"-":d?.total??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b shrink-0 space-y-3",children:[e.jsx(Yt,{value:G,onValueChange:U=>Re(U),className:"w-full",children:e.jsxs(Vt,{className:"grid w-full grid-cols-4",children:[e.jsxs(Ye,{value:"unchecked",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(ia,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.unchecked??0,")"]})]}),e.jsxs(Ye,{value:"passed",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(tt,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.passed??0,")"]})]}),e.jsxs(Ye,{value:"rejected",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx(ta,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.rejected??0,")"]})]}),e.jsxs(Ye,{value:"all",className:"gap-1 text-xs sm:text-sm px-1 sm:px-3",children:[e.jsx("span",{children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",d?.total??0,")"]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:ns,onChange:U=>J(U.target.value),onKeyDown:U=>U.key==="Enter"&&$e(),className:"pl-9"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:$e,children:e.jsx(Ut,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"icon",onClick:()=>{St(),Zs()},disabled:pe,children:e.jsx(ut,{className:F("h-4 w-4",pe&&"animate-spin")})})]}),Z.size>0&&e.jsx("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:G==="unchecked"?e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>rs(!1),disabled:pe,children:[e.jsx(tt,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",Z.size,")"]}),e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>rs(!0),disabled:pe,children:[e.jsx(ta,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",Z.size,")"]})]}):G==="passed"?e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>rs(!0),disabled:pe,children:[e.jsx(ta,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",Z.size,")"]}):G==="rejected"?e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>rs(!1),disabled:pe,children:[e.jsx(tt,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",Z.size,")"]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1 sm:flex-none",onClick:()=>rs(!1),disabled:pe,children:[e.jsx(tt,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",Z.size,")"]}),e.jsxs(_,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-none",onClick:()=>rs(!0),disabled:pe,children:[e.jsx(ta,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),"(",Z.size,")"]})]})})]})]}),e.jsx(ss,{className:"flex-1 px-4 sm:px-6",children:pe&&h.length===0?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(ut,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):h.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-muted-foreground",children:[e.jsx(Rt,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:""})]}):e.jsxs("div",{className:"space-y-2 py-2",children:[h.length>0&&e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lt,{checked:Z.size===h.length&&h.length>0,onCheckedChange:ht}),e.jsx("span",{className:"text-sm text-muted-foreground",children:Z.size===h.length&&h.length>0?` (${h.length} )`:` (${h.length} )`})]}),Z.size>0&&e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>Le(new Set),className:"h-7 text-xs",children:""})]}),h.map(U=>e.jsx("div",{className:F("rounded-lg border p-3 sm:p-4 space-y-2 sm:space-y-3 transition-colors",Z.has(U.id)&&"bg-accent border-primary",ae.has(U.id)&&"opacity-50"),children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx(lt,{checked:Z.has(U.id),onCheckedChange:()=>Tt(U.id),disabled:ae.has(U.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm font-medium break-words",children:U.situation})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground break-words",children:U.style})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["#",U.id]}),e.jsx("span",{children:""}),e.jsx("span",{title:ms(U.chat_id),className:"truncate max-w-24 sm:max-w-32",children:ms(U.chat_id)}),e.jsx("span",{children:""}),e.jsx("span",{children:ca(U.create_date)}),e.jsxs("div",{className:"flex items-center gap-1",children:[ka(U),Pa(U.modified_by)]})]})]}),e.jsx("div",{className:"flex flex-col gap-1 sm:gap-2 shrink-0",children:G==="unchecked"?e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(tt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(ta,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]}):G==="passed"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(ta,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):G==="rejected"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(tt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsx(e.Fragment,{children:U.rejected?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(tt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):U.checked?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(ta,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!1),disabled:ae.has(U.id),children:[e.jsx(tt,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",onClick:()=>os(U.id,!0),disabled:ae.has(U.id),children:[e.jsx(ta,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})})})]})},U.id))]})}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-t shrink-0 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs(Pe,{value:Te.toString(),onValueChange:U=>{V(parseInt(U,10)),he(1)},children:[e.jsx(Be,{className:"w-[70px] h-8",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"10",children:"10"}),e.jsx(ee,{value:"20",children:"20"}),e.jsx(ee,{value:"50",children:"50"}),e.jsx(ee,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs("span",{className:"text-muted-foreground",children:[" ",ue," "]})]}),e.jsx(ux,{className:"mx-0 w-auto",children:e.jsxs(mx,{children:[e.jsx(Yn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>he(U=>Math.max(1,U-1)),disabled:_e<=1||pe,children:e.jsx(Ia,{className:"h-4 w-4"})})}),te().map((U,Me)=>e.jsx(Yn,{children:U==="ellipsis"?e.jsx(Uv,{}):e.jsx(pc,{href:"#",isActive:U===_e,onClick:Xe=>{Xe.preventDefault(),he(U)},className:"h-8 w-8 cursor-pointer",children:U})},Me)),e.jsx(Yn,{children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>he(U=>Math.min(Jt,U+1)),disabled:_e>=Jt||pe,children:e.jsx(ra,{className:"h-4 w-4"})})})]})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(ne,{type:"number",min:1,max:Jt,value:$,onChange:U=>z(U.target.value),onKeyDown:U=>U.key==="Enter"&&ye(),className:"w-16 h-8 text-center",placeholder:_e.toString()}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(_,{variant:"outline",size:"sm",className:"h-8",onClick:ye,disabled:pe,children:""})]})]})]}),r==="quick"&&e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b shrink-0 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium text-orange-500",children:d?.unchecked??0})]}),e.jsxs("span",{className:"text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium text-green-500",children:d?.passed??0})]}),e.jsxs("span",{className:"text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium text-red-500",children:d?.rejected??0})]})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>{xs(),Zs()},disabled:w,children:[e.jsx(ut,{className:F("h-4 w-4 mr-1",w&&"animate-spin")}),""]})]}),e.jsx(Yt,{value:p,onValueChange:U=>g(U),className:"w-full",children:e.jsxs(Vt,{className:"grid w-full grid-cols-4",children:[e.jsxs(Ye,{value:"unchecked",className:"gap-1 text-xs sm:text-sm",children:[e.jsx(ia,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"passed",className:"gap-1 text-xs sm:text-sm",children:[e.jsx(tt,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"rejected",className:"gap-1 text-xs sm:text-sm",children:[e.jsx(ta,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(Ye,{value:"all",className:"gap-1 text-xs sm:text-sm",children:""})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-4 sm:p-8 relative overflow-hidden",children:w&&N.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(ut,{className:"h-8 w-8 animate-spin text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]}):N.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-muted/50 flex items-center justify-center mb-6",children:e.jsx(tt,{className:"h-10 w-10 text-green-500"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 text-sm text-muted-foreground z-50",children:[y+1," / ",N.length,M>N.length&&e.jsxs("span",{className:"ml-1",children:[" ",M," "]})]}),e.jsx("div",{className:"absolute inset-x-4 top-1/2 -translate-y-1/2 flex justify-between pointer-events-none z-40",children:(()=>{const U=N[y],Me=Is(U);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:F("flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-300",C==="left"?"bg-red-500/20 text-red-500 scale-110":"bg-muted/50 text-muted-foreground opacity-0",!Me.left&&"invisible"),children:[e.jsx(ta,{className:"h-8 w-8"}),e.jsx("span",{className:"font-bold text-lg hidden sm:inline",children:""})]}),e.jsxs("div",{className:F("flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-300",C==="right"?"bg-green-500/20 text-green-500 scale-110":"bg-muted/50 text-muted-foreground opacity-0",!Me.right&&"invisible"),children:[e.jsx("span",{className:"font-bold text-lg hidden sm:inline",children:""}),e.jsx(tt,{className:"h-8 w-8"})]})]})})()}),e.jsx("div",{className:"relative w-full max-w-md h-[400px] flex items-center justify-center",children:N.slice(y,y+5).reverse().map((U,Me,Xe)=>{const ds=Xe.length-1-Me,is=ds===0;let kt={zIndex:5-ds,position:"absolute",width:"100%",transition:is&&!ge.current?"all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)":"none"};if(is)kt={...kt,transform:`translateX(${H}px) rotate(${H*.05}deg)`,opacity:Math.max(0,1-Math.abs(H)/500),cursor:"grab"};else{const Ps=Math.min(Math.abs(H)/200,1),le=Xt=>{const ql=Xt*7%5,kn=Xt*13%7;return{scale:1-Xt*.05,translateY:Xt*12,rotate:(Xt%2===0?1:-1)*(Xt*2)+ql,translateX:(Xt%2===0?-1:1)*(Xt*4)+kn}},fe=le(ds),es=le(ds-1),Ss=fe.scale+(es.scale-fe.scale)*Ps,hs=fe.translateY+(es.translateY-fe.translateY)*Ps,yt=fe.rotate+(es.rotate-fe.rotate)*Ps,oa=fe.translateX+(es.translateX-fe.translateX)*Ps;kt={...kt,transform:`translate3d(${oa}px, ${hs}px, 0) scale(${Ss}) rotate(${yt}deg)`,opacity:1-ds*.15,filter:`blur(${Math.max(0,ds*1-Ps)}px)`,pointerEvents:"none"}}return e.jsxs("div",{ref:is?je:void 0,className:F("bg-card border rounded-xl shadow-xl p-6 select-none h-full flex flex-col",is&&"active:cursor-grabbing shadow-2xl ring-1 ring-border/50",is&&me===U.id&&"ring-4 ring-orange-500/50 bg-orange-50/10"),style:kt,onMouseDown:is?He:void 0,onMouseMove:is?zs:void 0,onMouseUp:is?Ls:void 0,onMouseLeave:is?Ks:void 0,onTouchStart:is?cs:void 0,onTouchMove:is?ts:void 0,onTouchEnd:is?_s:void 0,children:[is&&me===U.id&&e.jsxs("div",{className:"absolute inset-0 z-50 flex flex-col items-center justify-center bg-background/80 backdrop-blur-sm animate-in fade-in duration-300 rounded-xl",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-orange-500/20 rounded-full animate-ping"}),e.jsx(ut,{className:"relative h-16 w-16 text-orange-500 mb-4 animate-spin duration-1000"})]}),e.jsx("h3",{className:"text-xl font-bold text-foreground animate-in slide-in-from-bottom-2 fade-in duration-500",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2 animate-in slide-in-from-bottom-3 fade-in duration-700",children:""})]}),is&&e.jsx("div",{className:F("absolute inset-0 flex items-center justify-center z-20 pointer-events-none transition-opacity duration-200",H<-10&&!Is(U).left||H>10&&!Is(U).right?"opacity-100":"opacity-0"),children:e.jsx("div",{className:"bg-background/80 backdrop-blur-sm p-4 rounded-full shadow-lg border border-border",children:e.jsx(tv,{className:"h-12 w-12 text-muted-foreground"})})}),e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground font-mono",children:["#",U.id]}),e.jsxs("div",{className:"flex items-center gap-2",children:[ka(U),Pa(U.modified_by)]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:""}),e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg border border-border/50",children:e.jsx("p",{className:"text-lg font-medium leading-relaxed",children:U.situation})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:U.style.split(/[,]/).map((Ps,le)=>e.jsx(ke,{variant:"secondary",className:"font-normal",children:Ps.trim()},le))})]})]}),e.jsxs("div",{className:"mt-auto pt-4 border-t flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-primary",children:e.jsx($l,{className:"h-3 w-3"})}),e.jsx("span",{title:ms(U.chat_id),className:"truncate max-w-[120px] font-medium",children:ms(U.chat_id)})]}),e.jsx("span",{className:"font-mono",children:ca(U.create_date)})]})]},U.id)})}),e.jsx("div",{className:"flex items-center gap-8 mt-8 sm:hidden z-50",children:(()=>{const U=N[y],Me=Is(U);return e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"lg",className:F("w-16 h-16 rounded-full border-2 shadow-lg transition-all active:scale-95",Me.left?"hover:bg-red-50 hover:text-red-600 hover:border-red-200":"opacity-30 cursor-not-allowed"),onClick:()=>Me.left&&Y(!0),disabled:!Me.left||X,children:e.jsx(ta,{className:"h-8 w-8"})}),e.jsx(_,{variant:"outline",size:"lg",className:F("w-16 h-16 rounded-full border-2 shadow-lg transition-all active:scale-95",Me.right?"hover:bg-green-50 hover:text-green-600 hover:border-green-200":"opacity-30 cursor-not-allowed"),onClick:()=>Me.right&&Y(!1),disabled:!Me.right||X,children:e.jsx(tt,{className:"h-8 w-8"})})]})})()})]})}),e.jsxs("div",{className:"hidden sm:flex items-center justify-center gap-6 px-6 py-3 border-t text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:""}),e.jsx("span",{children:""})]}),e.jsx("span",{className:"text-muted-foreground/50",children:"|"}),e.jsx("span",{children:""})]})]})]})})}function l2(){return e.jsx(tr,{children:e.jsx(r2,{})})}const n2=a=>{const l=[];for(let r=0;r<a;r++){const c=r*137.508%360;l.push(`hsl(${c}, 70%, 55%)`)}return l};function r2(){const[a,l]=u.useState(null),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(24),[p,g]=u.useState(!0),[N,j]=u.useState(null),[y,b]=u.useState(!0),[w,A]=u.useState(null),[M,S]=u.useState(!1),[P,E]=u.useState(0),{triggerRestart:C,isRestarting:R}=_n(),H=u.useRef(!0),O=u.useRef(null);u.useEffect(()=>(H.current=!0,()=>{H.current=!1,O.current&&(clearInterval(O.current),O.current=null)}),[]);const X=u.useCallback(async()=>{try{const z=await hx();H.current&&E(z.unchecked)}catch(z){console.error(":",z)}},[]),L=u.useCallback(async()=>{try{b(!0);const z=await dw.get("https://v1.hitokoto.cn/?c=a&c=b&c=c&c=d&c=h&c=i&c=k");H.current&&j({hitokoto:z.data.hitokoto,from:z.data.from||z.data.from_who||""})}catch(z){console.error(":",z),H.current&&j({hitokoto:"",from:""})}finally{H.current&&b(!1)}},[]),me=u.useCallback(async()=>{try{const z=await Se("/api/webui/system/status");if(!H.current)return;if(z.ok){const G=await z.json();A(G)}else A(null)}catch(z){console.error(":",z),H.current&&A(null)}},[]),Ne=async()=>{await C()},je=u.useCallback(async()=>{try{const z=await Se(`/api/webui/statistics/dashboard?hours=${h}`);if(!H.current)return;if(z.ok){const G=await z.json();l(G)}c(!1),m(100)}catch(z){console.error("Failed to fetch dashboard data:",z),H.current&&(c(!1),m(100))}},[h]);if(u.useEffect(()=>{if(!r)return;m(0);const z=setTimeout(()=>m(15),200),G=setTimeout(()=>m(30),800),Re=setTimeout(()=>m(45),2e3),se=setTimeout(()=>m(60),4e3),Oe=setTimeout(()=>m(75),6500),ns=setTimeout(()=>m(85),9e3),J=setTimeout(()=>m(92),11e3);return()=>{clearTimeout(z),clearTimeout(G),clearTimeout(Re),clearTimeout(se),clearTimeout(Oe),clearTimeout(ns),clearTimeout(J)}},[r]),u.useEffect(()=>{je(),L(),me(),X()},[je,L,me,X]),u.useEffect(()=>{if(O.current&&(clearInterval(O.current),O.current=null),!!p)return O.current=setInterval(()=>{H.current&&(je(),me())},3e4),()=>{O.current&&(clearInterval(O.current),O.current=null)}},[p,je,me]),r||!a)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"text-center space-y-6 w-full max-w-md px-4",children:[e.jsx(ut,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(er,{value:d,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d,"%"]})]})]})});const{summary:ce,model_stats:ge=[],hourly_data:pe=[],daily_data:D=[],recent_activity:K=[]}=a,B=ce??{total_requests:0,total_cost:0,total_tokens:0,online_time:0,total_messages:0,total_replies:0,avg_response_time:0,cost_per_hour:0,tokens_per_hour:0},ue=z=>{const G=Math.floor(z/3600),Re=Math.floor(z%3600/60);return`${G}${Re}`},Q=z=>{const G=z.toLocaleString("zh-CN");return z>=1e9?{display:`${(z/1e9).toFixed(2)}B`,exact:G,needsExact:!0}:z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:G,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:G,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:G,needsExact:!0}:{display:G,exact:G,needsExact:!1}},_e=z=>{const G=`${z.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return z>=1e6?{display:`${(z/1e6).toFixed(2)}M`,exact:G,needsExact:!0}:z>=1e4?{display:`${(z/1e3).toFixed(1)}K`,exact:G,needsExact:!0}:z>=1e3?{display:`${(z/1e3).toFixed(2)}K`,exact:G,needsExact:!0}:{display:G,exact:G,needsExact:!1}},he=z=>new Date(z).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Te=n2(ge.length),V=ge.map((z,G)=>({name:z.model_name,value:z.request_count,fill:Te[G]})),$={requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"},tokens:{label:"Tokens",color:"hsl(var(--chart-3))"}};return e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Yt,{value:h.toString(),onValueChange:z=>f(Number(z)),children:e.jsxs(Vt,{className:"grid grid-cols-3 w-full sm:w-auto",children:[e.jsx(Ye,{value:"24",children:"24"}),e.jsx(Ye,{value:"168",children:"7"}),e.jsx(Ye,{value:"720",children:"30"})]})}),e.jsxs(_,{variant:p?"default":"outline",size:"sm",onClick:()=>g(!p),className:"gap-2",children:[e.jsx(ut,{className:`h-4 w-4 ${p?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:je,children:e.jsx(ut,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg border border-dashed border-muted-foreground/30 bg-muted/20",children:[y?e.jsx(As,{className:"h-5 flex-1"}):N?e.jsxs("p",{className:"flex-1 text-sm text-muted-foreground italic truncate",children:['"',N.hitokoto,'"  ',N.from]}):null,e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:L,disabled:y,children:e.jsx(ut,{className:`h-3.5 w-3.5 ${y?"animate-spin":""}`})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-3",children:[e.jsxs(Ce,{className:"lg:col-span-1",children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Ue,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hc,{className:"h-4 w-4"}),""]})}),e.jsx(Ae,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:w?.running?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500 animate-pulse"}),e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[e.jsx(tt,{className:"h-3 w-3 mr-1"}),""]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500"}),e.jsxs(ke,{variant:"outline",className:"text-red-600 border-red-300 bg-red-50",children:[e.jsx(Rt,{className:"h-3 w-3 mr-1"}),""]})]})}),w&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{children:["v",w.version]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{children:[" ",ue(w.uptime)]})]})]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Ue,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]})}),e.jsx(Ae,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:Ne,disabled:R,className:"gap-2",children:[e.jsx(lc,{className:`h-4 w-4 ${R?"animate-spin":""}`}),R?"...":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>S(!0),className:"gap-2",children:[e.jsx(av,{className:"h-4 w-4"}),"",P>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:P>99?"99+":P})]}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/logs",children:[e.jsx(La,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/plugins",children:[e.jsx(w1,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/settings",children:[e.jsx(bn,{className:"h-4 w-4"}),""]})})]})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"pb-3",children:[e.jsxs(Ue,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(_1,{className:"h-4 w-4"}),""]}),e.jsx(fs,{className:"text-xs",children:""})]}),e.jsx(Ae,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/survey/webui-feedback",children:[e.jsx(La,{className:"h-4 w-4"}),"WebUI "]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Vn,{to:"/survey/maibot-feedback",children:[e.jsx(Ba,{className:"h-4 w-4"}),""]})})]})})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(ax,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Q(B.total_requests).display,Q(B.total_requests).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",Q(B.total_requests).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["",h<48?h+"":Math.floor(h/24)+""]})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(S1,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[_e(B.total_cost).display,_e(B.total_cost).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",_e(B.total_cost).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:B.cost_per_hour>0?`${B.cost_per_hour.toFixed(2)}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:"Token"}),e.jsx(Jr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Q(B.total_tokens).display,Q(B.total_tokens).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",Q(B.total_tokens).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:B.tokens_per_hour>0?`${Q(B.tokens_per_hour).display}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(el,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[B.avg_response_time.toFixed(2),"s"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"API"})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:e.jsxs("div",{className:"text-xl font-bold",children:[ue(B.online_time),e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",B.online_time.toLocaleString(),")"]})]})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-xl font-bold",children:[Q(B.total_messages).display,Q(B.total_messages).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",Q(B.total_messages).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",Q(B.total_replies).display,Q(B.total_replies).needsExact&&e.jsxs("span",{children:["(",Q(B.total_replies).exact,")"]})," "]})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(lx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-xl font-bold",children:B.total_messages>0?`${(B.total_cost/B.total_messages*100).toFixed(2)}`:"0.00"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"100"})]})]})]}),e.jsxs(Yt,{defaultValue:"trends",className:"space-y-4",children:[e.jsxs(Vt,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[e.jsx(Ye,{value:"trends",children:""}),e.jsx(Ye,{value:"models",children:""}),e.jsx(Ye,{value:"activity",children:""}),e.jsx(Ye,{value:"daily",children:""})]}),e.jsxs(Ms,{value:"trends",className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsxs(fs,{children:["",h,""]})]}),e.jsx(Ae,{children:e.jsx(Vr,{config:$,className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Qw,{data:pe,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>he(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>he(z)})}),e.jsx(Yw,{type:"monotone",dataKey:"requests",stroke:"var(--color-requests)",strokeWidth:2})]})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:"API"})]}),e.jsx(Ae,{children:e.jsx(Vr,{config:$,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:pe,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>he(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>he(z)})}),e.jsx(Ji,{dataKey:"cost",fill:"var(--color-cost)"})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:"Token"}),e.jsx(fs,{children:"Token"})]}),e.jsx(Ae,{children:e.jsx(Vr,{config:$,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Uo,{data:pe,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>he(z),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>he(z)})}),e.jsx(Ji,{dataKey:"tokens",fill:"var(--color-tokens)"})]})})})]})]})]}),e.jsx(Ms,{value:"models",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsxs(fs,{children:[" ( ",ge.length," )"]})]}),e.jsx(Ae,{children:e.jsx(Vr,{config:Object.fromEntries(ge.map((z,G)=>[z.model_name,{label:z.model_name,color:Te[G]}])),className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(Jw,{children:[e.jsx(Gi,{content:e.jsx(Gr,{})}),e.jsx(Xw,{data:V,cx:"50%",cy:"50%",labelLine:!1,label:({name:z,percent:G})=>G&&G<.05?"":`${z} ${G?(G*100).toFixed(0):0}%`,outerRadius:100,dataKey:"value",children:V.map((z,G)=>e.jsx(Zw,{fill:z.fill},`cell-${G}`))})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:e.jsx(ss,{className:"h-[300px] sm:h-[400px]",children:e.jsx("div",{className:"space-y-3",children:ge.map((z,G)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm truncate flex-1 min-w-0",children:z.model_name}),e.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:`hsl(var(--chart-${G%5+1}))`}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-1 font-medium",children:z.request_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:["",z.total_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[(z.total_tokens/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:[z.avg_response_time.toFixed(2),"s"]})]})]})]},G))})})})]})]})}),e.jsx(Ms,{value:"activity",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:"API"})]}),e.jsx(Ae,{children:e.jsx(ss,{className:"h-[400px] sm:h-[500px]",children:e.jsx("div",{className:"space-y-2",children:K.map((z,G)=>e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:z.model}),e.jsx("div",{className:"text-xs text-muted-foreground",children:z.request_type})]}),e.jsx("div",{className:"text-xs text-muted-foreground flex-shrink-0",children:he(z.timestamp)})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsx("span",{className:"ml-1",children:z.tokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:["",z.cost.toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:[z.time_cost.toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:`ml-1 ${z.status==="success"?"text-green-600":"text-red-600"}`,children:z.status})]})]})]},G))})})})]})}),e.jsx(Ms,{value:"daily",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:"7"})]}),e.jsx(Ae,{children:e.jsx(Vr,{config:{requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"}},className:"h-[400px] sm:h-[500px] w-full aspect-auto",children:e.jsxs(Uo,{data:D,children:[e.jsx(Qi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Yi,{dataKey:"timestamp",tickFormatter:z=>{const G=new Date(z);return`${G.getMonth()+1}/${G.getDate()}`},stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{yAxisId:"left",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(qr,{yAxisId:"right",orientation:"right",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Gi,{content:e.jsx(Gr,{labelFormatter:z=>new Date(z).toLocaleDateString("zh-CN")})}),e.jsx(L_,{content:e.jsx(Ev,{})}),e.jsx(Ji,{yAxisId:"left",dataKey:"requests",fill:"var(--color-requests)"}),e.jsx(Ji,{yAxisId:"right",dataKey:"cost",fill:"var(--color-cost)"})]})})})]})})]}),e.jsx(ar,{}),e.jsx($v,{open:M,onOpenChange:z=>{S(z),z||X()}})]})})}const i2={theme:"system",setTheme:()=>null},Bv=u.createContext(i2),fx=()=>{const a=u.useContext(Bv);if(a===void 0)throw new Error("useTheme must be used within a ThemeProvider");return a},c2=(a,l,r)=>{const c=document.documentElement.classList.contains("no-animations");if(!document.startViewTransition||c){l(a);return}const d=r.clientX,m=r.clientY,h=Math.hypot(Math.max(d,innerWidth-d),Math.max(m,innerHeight-m));document.startViewTransition(()=>{l(a)}).ready.then(()=>{document.documentElement.animate({clipPath:[`circle(0px at ${d}px ${m}px)`,`circle(${h}px at ${d}px ${m}px)`]},{duration:500,easing:"ease-in-out",pseudoElement:"::view-transition-new(root)"})})},Iv=u.createContext(void 0),Pv=()=>{const a=u.useContext(Iv);if(a===void 0)throw new Error("useAnimation must be used within an AnimationProvider");return a},Ge=u.forwardRef(({className:a,...l},r)=>e.jsx(fj,{className:F("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...l,ref:r,children:e.jsx(pw,{className:F("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ge.displayName=fj.displayName;const o2=ei("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),T=u.forwardRef(({className:a,...l},r)=>e.jsx(Gj,{ref:r,className:F(o2(),a),...l}));T.displayName=Gj.displayName;const d2=[{id:"minLength",label:" 10 ",description:"Token  10 ",validate:a=>a.length>=10},{id:"hasUppercase",label:"",description:" (A-Z)",validate:a=>/[A-Z]/.test(a)},{id:"hasLowercase",label:"",description:" (a-z)",validate:a=>/[a-z]/.test(a)},{id:"hasSpecialChar",label:"",description:" (!@#$%^&*()_+-=[]{}|;:,.<>?/)",validate:a=>/[!@#$%^&*()_+\-=[\]{}|;:,.<>?/]/.test(a)}];function u2(a){const l=d2.map(c=>({id:c.id,label:c.label,description:c.description,passed:c.validate(a)}));return{isValid:l.every(c=>c.passed),rules:l}}const od="0.12.2",px="MaiBot Dashboard",m2=`${px} v${od}`,x2=(a="v")=>`${a}${od}`,ya={THEME:"maibot-ui-theme",ACCENT_COLOR:"accent-color",ENABLE_ANIMATIONS:"maibot-animations",ENABLE_WAVES_BACKGROUND:"maibot-waves-background",LOG_CACHE_SIZE:"maibot-log-cache-size",LOG_AUTO_SCROLL:"maibot-log-auto-scroll",LOG_FONT_SIZE:"maibot-log-font-size",LOG_LINE_SPACING:"maibot-log-line-spacing",DATA_SYNC_INTERVAL:"maibot-data-sync-interval",WS_RECONNECT_INTERVAL:"maibot-ws-reconnect-interval",WS_MAX_RECONNECT_ATTEMPTS:"maibot-ws-max-reconnect-attempts",COMPLETED_TOURS:"maibot-completed-tours"},xl={theme:"system",accentColor:"blue",enableAnimations:!0,enableWavesBackground:!0,logCacheSize:1e3,logAutoScroll:!0,logFontSize:"xs",logLineSpacing:4,dataSyncInterval:30,wsReconnectInterval:3e3,wsMaxReconnectAttempts:10};function zt(a){const l=Fv(a),r=localStorage.getItem(l);if(r===null)return xl[a];const c=xl[a];if(typeof c=="boolean")return r==="true";if(typeof c=="number"){const d=parseFloat(r);return isNaN(d)?c:d}return r}function Kr(a,l){const r=Fv(a);localStorage.setItem(r,String(l)),window.dispatchEvent(new CustomEvent("maibot-settings-change",{detail:{key:a,value:l}}))}function h2(){return{theme:zt("theme"),accentColor:zt("accentColor"),enableAnimations:zt("enableAnimations"),enableWavesBackground:zt("enableWavesBackground"),logCacheSize:zt("logCacheSize"),logAutoScroll:zt("logAutoScroll"),logFontSize:zt("logFontSize"),logLineSpacing:zt("logLineSpacing"),dataSyncInterval:zt("dataSyncInterval"),wsReconnectInterval:zt("wsReconnectInterval"),wsMaxReconnectAttempts:zt("wsMaxReconnectAttempts")}}function f2(){const a=h2(),l=localStorage.getItem(ya.COMPLETED_TOURS),r=l?JSON.parse(l):[];return{...a,completedTours:r}}function p2(a){const l=[],r=[];for(const[c,d]of Object.entries(a)){if(c==="completedTours"){Array.isArray(d)?(localStorage.setItem(ya.COMPLETED_TOURS,JSON.stringify(d)),l.push("completedTours")):r.push("completedTours");continue}if(c in xl){const m=c,h=xl[m];if(typeof d==typeof h){if(m==="theme"&&!["light","dark","system"].includes(d)){r.push(c);continue}if(m==="logFontSize"&&!["xs","sm","base"].includes(d)){r.push(c);continue}Kr(m,d),l.push(c)}else r.push(c)}else r.push(c)}return{success:l.length>0,imported:l,skipped:r}}function g2(){for(const a of Object.keys(xl))Kr(a,xl[a]);localStorage.removeItem(ya.COMPLETED_TOURS),window.dispatchEvent(new CustomEvent("maibot-settings-reset"))}function j2(){const a=[],l=[],r=[];for(let c=0;c<localStorage.length;c++){const d=localStorage.key(c);d&&(d.startsWith("maibot")||d.startsWith("accent-color")||d==="access-token")&&r.push(d)}for(const c of r)localStorage.removeItem(c),a.push(c);return{clearedKeys:a,preservedKeys:l}}function Dg(){let a=0;const l=[];for(let r=0;r<localStorage.length;r++){const c=localStorage.key(r);if(c){const d=localStorage.getItem(c)||"",m=(c.length+d.length)*2;a+=m,l.push({key:c,size:m})}}return l.sort((r,c)=>c.size-r.size),{used:a,items:localStorage.length,details:l}}function v2(a){if(a===0)return"0 B";const l=1024,r=["B","KB","MB"],c=Math.floor(Math.log(a)/Math.log(l));return parseFloat((a/Math.pow(l,c)).toFixed(2))+" "+r[c]}function Fv(a){return{theme:ya.THEME,accentColor:ya.ACCENT_COLOR,enableAnimations:ya.ENABLE_ANIMATIONS,enableWavesBackground:ya.ENABLE_WAVES_BACKGROUND,logCacheSize:ya.LOG_CACHE_SIZE,logAutoScroll:ya.LOG_AUTO_SCROLL,logFontSize:ya.LOG_FONT_SIZE,logLineSpacing:ya.LOG_LINE_SPACING,dataSyncInterval:ya.DATA_SYNC_INTERVAL,wsReconnectInterval:ya.WS_RECONNECT_INTERVAL,wsMaxReconnectAttempts:ya.WS_MAX_RECONNECT_ATTEMPTS}[a]}const Wa=u.forwardRef(({className:a,...l},r)=>e.jsxs(pj,{ref:r,className:F("relative flex w-full touch-none select-none items-center",a),...l,children:[e.jsx(gw,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(jw,{className:"absolute h-full bg-primary"})}),e.jsx(vw,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Wa.displayName=pj.displayName;class N2{ws=null;reconnectTimeout=null;reconnectAttempts=0;heartbeatInterval=null;logCallbacks=new Set;connectionCallbacks=new Set;isConnected=!1;logCache=[];getMaxCacheSize(){return zt("logCacheSize")}getMaxReconnectAttempts(){return zt("wsMaxReconnectAttempts")}getReconnectInterval(){return zt("wsReconnectInterval")}getWebSocketUrl(l){let r;{const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host;r=`${c}//${d}/ws/logs`}return l?`${r}?token=${encodeURIComponent(l)}`:r}async getWsToken(){try{const l=await Se("/api/webui/ws-token",{method:"GET",credentials:"include"});if(!l.ok)return console.error(" WebSocket token :",l.status),null;const r=await l.json();return r.success&&r.token?r.token:null}catch(l){return console.error(" WebSocket token :",l),null}}async connect(){if(this.ws?.readyState===WebSocket.OPEN||this.ws?.readyState===WebSocket.CONNECTING)return;if(window.location.pathname==="/auth"){console.log("  WebSocket ");return}if(!await cc()){console.log("  WebSocket ");return}const r=await this.getWsToken();if(!r){console.log("  WebSocket token");return}const c=this.getWebSocketUrl(r);try{this.ws=new WebSocket(c),this.ws.onopen=()=>{this.isConnected=!0,this.reconnectAttempts=0,this.notifyConnection(!0),this.startHeartbeat()},this.ws.onmessage=d=>{try{if(d.data==="pong")return;const m=JSON.parse(d.data);this.notifyLog(m)}catch(m){console.error(":",m)}},this.ws.onerror=d=>{console.error(" WebSocket :",d),this.isConnected=!1,this.notifyConnection(!1)},this.ws.onclose=()=>{this.isConnected=!1,this.notifyConnection(!1),this.stopHeartbeat(),this.attemptReconnect()}}catch(d){console.error(" WebSocket :",d),this.attemptReconnect()}}attemptReconnect(){const l=this.getMaxReconnectAttempts();if(this.reconnectAttempts>=l)return;this.reconnectAttempts+=1;const r=this.getReconnectInterval(),c=Math.min(r*this.reconnectAttempts,3e4);this.reconnectTimeout=window.setTimeout(()=>{this.connect()},c)}startHeartbeat(){this.heartbeatInterval=window.setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.ws.send("ping")},3e4)}stopHeartbeat(){this.heartbeatInterval!==null&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}disconnect(){this.reconnectTimeout!==null&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.stopHeartbeat(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.reconnectAttempts=0}onLog(l){return this.logCallbacks.add(l),()=>this.logCallbacks.delete(l)}onConnectionChange(l){return this.connectionCallbacks.add(l),l(this.isConnected),()=>this.connectionCallbacks.delete(l)}notifyLog(l){if(!this.logCache.some(c=>c.id===l.id)){this.logCache.push(l);const c=this.getMaxCacheSize();this.logCache.length>c&&(this.logCache=this.logCache.slice(-c)),this.logCallbacks.forEach(d=>{try{d(l)}catch(m){console.error(":",m)}})}}notifyConnection(l){this.connectionCallbacks.forEach(r=>{try{r(l)}catch(c){console.error(":",c)}})}getAllLogs(){return[...this.logCache]}clearLogs(){this.logCache=[]}getConnectionStatus(){return this.isConnected}}const Gn=new N2;typeof window<"u"&&setTimeout(()=>{Gn.connect()},100);const Cs=bw,_t=yw,b2=Nw,Hv=u.forwardRef(({className:a,...l},r)=>e.jsx(gj,{className:F("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:r}));Hv.displayName=gj.displayName;const ps=u.forwardRef(({className:a,...l},r)=>e.jsxs(b2,{children:[e.jsx(Hv,{}),e.jsx(jj,{ref:r,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]}));ps.displayName=jj.displayName;const gs=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col space-y-2 text-center sm:text-left",a),...l});gs.displayName="AlertDialogHeader";const js=({className:a,...l})=>e.jsx("div",{className:F("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...l});js.displayName="AlertDialogFooter";const vs=u.forwardRef(({className:a,...l},r)=>e.jsx(vj,{ref:r,className:F("text-lg font-semibold",a),...l}));vs.displayName=vj.displayName;const Ns=u.forwardRef(({className:a,...l},r)=>e.jsx(Nj,{ref:r,className:F("text-sm text-muted-foreground",a),...l}));Ns.displayName=Nj.displayName;const bs=u.forwardRef(({className:a,variant:l,...r},c)=>e.jsx(bj,{ref:c,className:F(Wr({variant:l}),a),...r}));bs.displayName=bj.displayName;const ys=u.forwardRef(({className:a,...l},r)=>e.jsx(yj,{ref:r,className:F(Wr({variant:"outline"}),"mt-2 sm:mt-0",a),...l}));ys.displayName=yj.displayName;function y2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]})}),e.jsxs(Yt,{defaultValue:"appearance",className:"w-full",children:[e.jsxs(Vt,{className:"grid w-full grid-cols-2 sm:grid-cols-4 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Ye,{value:"appearance",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(k1,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"security",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(lv,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"other",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(bn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"about",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Qt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(ss,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(Ms,{value:"appearance",className:"mt-0",children:e.jsx(w2,{})}),e.jsx(Ms,{value:"security",className:"mt-0",children:e.jsx(_2,{})}),e.jsx(Ms,{value:"other",className:"mt-0",children:e.jsx(S2,{})}),e.jsx(Ms,{value:"about",className:"mt-0",children:e.jsx(k2,{})})]})]})]})}function Og(a){const l=document.documentElement,c={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[a];if(c)l.style.setProperty("--primary",c.hsl),c.gradient?(l.style.setProperty("--primary-gradient",c.gradient),l.classList.add("has-gradient")):(l.style.removeProperty("--primary-gradient"),l.classList.remove("has-gradient"));else if(a.startsWith("#")){const d=m=>{m=m.replace("#","");const h=parseInt(m.substring(0,2),16)/255,f=parseInt(m.substring(2,4),16)/255,p=parseInt(m.substring(4,6),16)/255,g=Math.max(h,f,p),N=Math.min(h,f,p);let j=0,y=0;const b=(g+N)/2;if(g!==N){const w=g-N;switch(y=b>.5?w/(2-g-N):w/(g+N),g){case h:j=((f-p)/w+(f<p?6:0))/6;break;case f:j=((p-h)/w+2)/6;break;case p:j=((h-f)/w+4)/6;break}}return`${Math.round(j*360)} ${Math.round(y*100)}% ${Math.round(b*100)}%`};l.style.setProperty("--primary",d(a)),l.style.removeProperty("--primary-gradient"),l.classList.remove("has-gradient")}}function w2(){const{theme:a,setTheme:l}=fx(),{enableAnimations:r,setEnableAnimations:c,enableWavesBackground:d,setEnableWavesBackground:m}=Pv(),[h,f]=u.useState(()=>localStorage.getItem("accent-color")||"blue");u.useEffect(()=>{const g=localStorage.getItem("accent-color")||"blue";Og(g)},[]);const p=g=>{f(g),localStorage.setItem("accent-color",g),Og(g)};return e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx($m,{value:"light",current:a,onChange:l,label:"",description:""}),e.jsx($m,{value:"dark",current:a,onChange:l,label:"",description:""}),e.jsx($m,{value:"system",current:a,onChange:l,label:"",description:""})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Za,{value:"blue",current:h,onChange:p,label:"",colorClass:"bg-blue-500"}),e.jsx(Za,{value:"purple",current:h,onChange:p,label:"",colorClass:"bg-purple-500"}),e.jsx(Za,{value:"green",current:h,onChange:p,label:"",colorClass:"bg-green-500"}),e.jsx(Za,{value:"orange",current:h,onChange:p,label:"",colorClass:"bg-orange-500"}),e.jsx(Za,{value:"pink",current:h,onChange:p,label:"",colorClass:"bg-pink-500"}),e.jsx(Za,{value:"red",current:h,onChange:p,label:"",colorClass:"bg-red-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Za,{value:"gradient-sunset",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-orange-500 to-pink-500"}),e.jsx(Za,{value:"gradient-ocean",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-500"}),e.jsx(Za,{value:"gradient-forest",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-green-500 to-emerald-500"}),e.jsx(Za,{value:"gradient-aurora",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-purple-500 to-pink-500"}),e.jsx(Za,{value:"gradient-fire",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-red-500 to-orange-500"}),e.jsx(Za,{value:"gradient-twilight",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"color",value:h.startsWith("#")?h:"#3b82f6",onChange:g=>p(g.target.value),className:"h-10 sm:h-12 w-full rounded-lg border-2 border-border cursor-pointer",title:""})}),e.jsx("div",{className:"flex-1",children:e.jsx(ne,{type:"text",value:h,onChange:g=>p(g.target.value),placeholder:"#3b82f6",className:"font-mono text-sm"})})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-2",children:" HEX "})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"animations",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"animations",checked:r,onCheckedChange:c})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(T,{htmlFor:"waves-background",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"waves-background",checked:d,onCheckedChange:m})]})})]})]})]})}function _2(){const a=xa(),[l,r]=u.useState(""),[c,d]=u.useState(""),[m,h]=u.useState(!1),[f,p]=u.useState(!1),[g,N]=u.useState(!1),[j,y]=u.useState(!1),[b,w]=u.useState(!1),[A,M]=u.useState(!1),[S,P]=u.useState(""),[E,C]=u.useState(!1),{toast:R}=it(),H=u.useMemo(()=>u2(c),[c]),O=async ce=>{if(!l){R({title:"",description:"Token  Cookie  Token",variant:"destructive"});return}try{await navigator.clipboard.writeText(ce),w(!0),R({title:"",description:"Token "}),setTimeout(()=>w(!1),2e3)}catch{R({title:"",description:" Token",variant:"destructive"})}},X=async()=>{if(!c.trim()){R({title:"",description:" Token",variant:"destructive"});return}if(!H.isValid){const ce=H.rules.filter(ge=>!ge.passed).map(ge=>ge.label).join(", ");R({title:"",description:`Token : ${ce}`,variant:"destructive"});return}N(!0);try{const ce=await fetch("/api/webui/auth/update",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({new_token:c.trim()})}),ge=await ce.json();ce.ok&&ge.success?(d(""),r(c.trim()),R({title:"",description:"Access Token "}),setTimeout(()=>{a({to:"/auth"})},1500)):R({title:"",description:ge.message||" Token",variant:"destructive"})}catch(ce){console.error(" Token :",ce),R({title:"",description:"",variant:"destructive"})}finally{N(!1)}},L=async()=>{y(!0);try{const ce=await fetch("/api/webui/auth/regenerate",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),ge=await ce.json();ce.ok&&ge.success?(r(ge.token),P(ge.token),M(!0),C(!1),R({title:"",description:" Access Token "})):R({title:"",description:ge.message||" Token",variant:"destructive"})}catch(ce){console.error(" Token :",ce),R({title:"",description:"",variant:"destructive"})}finally{y(!1)}},me=async()=>{try{await navigator.clipboard.writeText(S),C(!0),R({title:"",description:"Token "})}catch{R({title:"",description:" Token",variant:"destructive"})}},Ne=()=>{M(!1),setTimeout(()=>{P(""),C(!1)},300),setTimeout(()=>{a({to:"/auth"})},500)},je=ce=>{ce||Ne()};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(Js,{open:A,onOpenChange:je,children:e.jsxs(qs,{className:"sm:max-w-md",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"h-5 w-5 text-yellow-500"})," Access Token"]}),e.jsx(nt,{children:" Token"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-2 border-primary/20 bg-primary/5 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-2 block",children:" Token (64)"}),e.jsx("div",{className:"font-mono text-sm break-all select-all bg-background p-3 rounded border",children:S})]}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(qt,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token "}),e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:" Token "})]})]})]})})]}),e.jsxs(xt,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:me,className:"gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"h-4 w-4"})," Token"]})}),e.jsx(_,{onClick:Ne,children:""})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"current-token",className:"text-sm",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ne,{id:"current-token",type:m?"text":"password",value:l||"",readOnly:!0,className:"pr-10 font-mono text-sm",placeholder:"Token  Cookie "}),e.jsx("button",{onClick:()=>{l?h(!m):R({title:"",description:'Token  Cookie  Token ""'})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:m?"":"",children:m?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ma,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:()=>O(l),title:"",className:"flex-shrink-0",disabled:!l,children:b?e.jsx(Lt,{className:"h-4 w-4 text-green-500"}):e.jsx(Fo,{className:"h-4 w-4"})}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:j,className:"gap-2 flex-1 sm:flex-none",children:[e.jsx(ut,{className:F("h-4 w-4",j&&"animate-spin")}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:" Token"}),e.jsx(Ns,{children:" 64  Token   Token "})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:L,children:""})]})]})]})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:" Access Token"})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"new-token",className:"text-sm",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{id:"new-token",type:f?"text":"password",value:c,onChange:ce=>d(ce.target.value),className:"pr-10 font-mono text-sm",placeholder:" Token"}),e.jsx("button",{onClick:()=>p(!f),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:f?"":"",children:f?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ma,{className:"h-4 w-4 text-muted-foreground"})})]}),c&&e.jsxs("div",{className:"mt-3 space-y-2 p-3 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Token :"}),e.jsx("div",{className:"space-y-1.5",children:H.rules.map(ce=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[ce.passed?e.jsx(tt,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(ta,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:F(ce.passed?"text-green-600 dark:text-green-400":"text-muted-foreground"),children:ce.label})]},ce.id))}),H.isValid&&e.jsx("div",{className:"mt-2 pt-2 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Token "})]})})]})]}),e.jsx(_,{onClick:X,disabled:g||!H.isValid||!c,className:"w-full sm:w-auto",children:g?"...":" Token"})]})]}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3 sm:p-4",children:[e.jsx("h4",{className:"text-sm sm:text-base font-semibold text-yellow-900 dark:text-yellow-200 mb-2",children:""}),e.jsxs("ul",{className:"text-xs sm:text-sm text-yellow-800 dark:text-yellow-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:" Token  64 "}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token  Token "}),e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token "})]})]})]})}function S2(){const a=xa(),{toast:l}=it(),[r,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(()=>zt("logCacheSize")),[p,g]=u.useState(()=>zt("wsReconnectInterval")),[N,j]=u.useState(()=>zt("wsMaxReconnectAttempts")),[y,b]=u.useState(()=>zt("dataSyncInterval")),[w,A]=u.useState(()=>Dg()),[M,S]=u.useState(!1),[P,E]=u.useState(!1),C=u.useRef(null);if(d)throw new Error("");const R=()=>{A(Dg())},H=D=>{const K=D[0];f(K),Kr("logCacheSize",K)},O=D=>{const K=D[0];g(K),Kr("wsReconnectInterval",K)},X=D=>{const K=D[0];j(K),Kr("wsMaxReconnectAttempts",K)},L=D=>{const K=D[0];b(K),Kr("dataSyncInterval",K)},me=()=>{Gn.clearLogs(),l({title:"",description:""})},Ne=()=>{const D=j2();R(),l({title:"",description:` ${D.clearedKeys.length} `})},je=()=>{S(!0);try{const D=f2(),K=JSON.stringify(D,null,2),B=new Blob([K],{type:"application/json"}),ue=URL.createObjectURL(B),Q=document.createElement("a");Q.href=ue,Q.download=`maibot-webui-settings-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(ue),l({title:"",description:" JSON "})}catch(D){console.error(":",D),l({title:"",description:"",variant:"destructive"})}finally{S(!1)}},ce=D=>{const K=D.target.files?.[0];if(!K)return;E(!0);const B=new FileReader;B.onload=ue=>{try{const Q=ue.target?.result,_e=JSON.parse(Q),he=p2(_e);he.success?(f(zt("logCacheSize")),g(zt("wsReconnectInterval")),j(zt("wsMaxReconnectAttempts")),b(zt("dataSyncInterval")),R(),l({title:"",description:` ${he.imported.length} ${he.skipped.length>0?` ${he.skipped.length} `:""}`}),(he.imported.includes("theme")||he.imported.includes("accentColor"))&&l({title:"",description:""})):l({title:"",description:"",variant:"destructive"})}catch(Q){console.error(":",Q),l({title:"",description:"",variant:"destructive"})}finally{E(!1),C.current&&(C.current.value="")}},B.readAsText(K)},ge=()=>{g2(),f(xl.logCacheSize),g(xl.wsReconnectInterval),j(xl.wsMaxReconnectAttempts),b(xl.dataSyncInterval),R(),l({title:"",description:""})},pe=async()=>{c(!0);try{const D=await Se("/api/webui/setup/reset",{method:"POST"}),K=await D.json();D.ok&&K.success?(l({title:"",description:""}),setTimeout(()=>{a({to:"/setup"})},1e3)):l({title:"",description:K.message||"",variant:"destructive"})}catch(D){console.error(":",D),l({title:"",description:"",variant:"destructive"})}finally{c(!1)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Jr,{className:"h-5 w-5"}),""]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(C1,{className:"h-4 w-4"}),""]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:R,className:"h-7 px-2",children:e.jsx(ut,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:v2(w.used)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[w.items," "]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h," "]})]}),e.jsx(Wa,{value:[h],onValueChange:H,min:100,max:5e3,step:100,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y," "]})]}),e.jsx(Wa,{value:[y],onValueChange:L,min:10,max:120,step:5,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p/1e3," "]})]}),e.jsx(Wa,{value:[p],onValueChange:O,min:1e3,max:1e4,step:500,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" WebSocket "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[N," "]})]}),e.jsx(Wa,{value:[N],onValueChange:X,min:3,max:30,step:1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:me,className:"gap-2",children:[e.jsx(us,{className:"h-4 w-4"}),""]}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(us,{className:"h-4 w-4"}),""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{children:" "})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:Ne,children:""})]})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(na,{className:"h-5 w-5"}),"/"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",onClick:je,disabled:M,className:"gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),M?"...":""]}),e.jsx("input",{ref:C,type:"file",accept:".json",onChange:ce,className:"hidden"}),e.jsxs(_,{variant:"outline",onClick:()=>C.current?.click(),disabled:P,className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),P?"...":""]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2 text-destructive hover:text-destructive",children:[e.jsx(lc,{className:"h-4 w-4"}),""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{children:" "})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:ge,children:""})]})]})]})})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:r,className:"gap-2",children:[e.jsx(lc,{className:F("h-4 w-4",r&&"animate-spin")}),""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{children:""})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:pe,children:""})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-dashed border-yellow-500/50 bg-yellow-500/5 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(qt,{className:"h-5 w-5 text-yellow-500"}),""]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{variant:"destructive",className:"gap-2",children:[e.jsx(qt,{className:"h-4 w-4"}),""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{children:" React  "})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>m(!0),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})]})]})]})]})}function k2(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"rounded-lg border-2 border-primary/30 bg-gradient-to-r from-primary/5 to-primary/10 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-shrink-0 rounded-lg bg-primary/10 p-2 sm:p-3",children:e.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3",children:" GitHub  Star  "}),e.jsxs("a",{href:"https://github.com/Mai-with-u/MaiBot-Dashboard",target:"_blank",rel:"noopener noreferrer",className:F("inline-flex items-center gap-2 px-4 py-2 rounded-lg","bg-primary text-primary-foreground font-medium text-sm","hover:bg-primary/90 transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})," GitHub",e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:[" ",px]}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("p",{children:[": ",od]}),e.jsx("p",{children:"MaiBot Web "})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"MaiBot "}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Mai-with-u"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"WebUI"}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Mai-with-u ",e.jsx("a",{href:"https://github.com/DrSmoothl",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"@MotricSeven"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"React 19.2.0"}),e.jsx("li",{children:"TypeScript 5.7.2"}),e.jsx("li",{children:"Vite 6.0.7"}),e.jsx("li",{children:"TanStack Router 1.94.2"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:"UI "}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"shadcn/ui"}),e.jsx("li",{children:"Radix UI"}),e.jsx("li",{children:"Tailwind CSS 3.4.17"}),e.jsx("li",{children:"Lucide Icons"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Python 3.12+"}),e.jsx("li",{children:"FastAPI"}),e.jsx("li",{children:"Uvicorn"}),e.jsx("li",{children:"WebSocket"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Bun / npm"}),e.jsx("li",{children:"ESLint 9.17.0"}),e.jsx("li",{children:"PostCSS"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-3",children:""}),e.jsx(ss,{className:"h-[300px] sm:h-[400px]",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"UI "}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Ct,{name:"React",description:"",license:"MIT"}),e.jsx(Ct,{name:"shadcn/ui",description:" React ",license:"MIT"}),e.jsx(Ct,{name:"Radix UI",description:"",license:"MIT"}),e.jsx(Ct,{name:"Tailwind CSS",description:" CSS ",license:"MIT"}),e.jsx(Ct,{name:"Lucide React",description:"",license:"ISC"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Ct,{name:"TanStack Router",description:"",license:"MIT"}),e.jsx(Ct,{name:"Zustand",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Ct,{name:"React Hook Form",description:"",license:"MIT"}),e.jsx(Ct,{name:"Zod",description:"TypeScript  schema ",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Ct,{name:"clsx",description:" className ",license:"MIT"}),e.jsx(Ct,{name:"tailwind-merge",description:"Tailwind ",license:"MIT"}),e.jsx(Ct,{name:"class-variance-authority",description:"",license:"Apache-2.0"}),e.jsx(Ct,{name:"date-fns",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Ct,{name:"Framer Motion",description:"React ",license:"MIT"}),e.jsx(Ct,{name:"vaul",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Ct,{name:"FastAPI",description:" Python Web ",license:"MIT"}),e.jsx(Ct,{name:"Uvicorn",description:"ASGI ",license:"BSD-3-Clause"}),e.jsx(Ct,{name:"Pydantic",description:"",license:"MIT"}),e.jsx(Ct,{name:"python-multipart",description:"",license:"Apache-2.0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(Ct,{name:"TypeScript",description:"JavaScript ",license:"Apache-2.0"}),e.jsx(Ct,{name:"Vite",description:"",license:"MIT"}),e.jsx(Ct,{name:"ESLint",description:"JavaScript ",license:"MIT"}),e.jsx(Ct,{name:"PostCSS",description:"CSS ",license:"MIT"})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/5 border border-primary/20 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:"rounded-md bg-primary/10 px-2 py-1",children:e.jsx("span",{className:"text-xs sm:text-sm font-bold text-primary",children:"GPLv3"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm sm:text-base font-semibold text-foreground mb-1",children:"MaiBot WebUI"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" GNU General Public License v3.0  "})]})]})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"MITApache-2.0BSD  "})]})]})]})}function Ct({name:a,description:l,license:r}){return e.jsxs("div",{className:"flex items-start justify-between gap-2 rounded-lg border bg-muted/30 p-2.5 sm:p-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:a}),e.jsx("p",{className:"text-muted-foreground text-xs mt-0.5",children:l})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary flex-shrink-0",children:r})]})}function $m({value:a,current:l,onChange:r,label:c,description:d}){const m=l===a;return e.jsxs("button",{onClick:()=>r(a),className:F("relative rounded-lg border-2 p-3 sm:p-4 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",m?"border-primary bg-accent":"border-border"),children:[m&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3 h-2 w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm sm:text-base font-medium",children:c}),e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:d})]}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex gap-1",children:[a==="light"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-200"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-400"})]}),a==="dark"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"})]}),a==="system"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-200 to-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-300 to-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-400 to-slate-900"})]})]})]})}function Za({value:a,current:l,onChange:r,label:c,colorClass:d}){const m=l===a;return e.jsxs("button",{onClick:()=>r(a),className:F("relative rounded-lg border-2 p-2 sm:p-3 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",m?"border-primary bg-accent":"border-border"),children:[m&&e.jsx("div",{className:"absolute top-1.5 right-1.5 sm:top-2 sm:right-2 h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"flex flex-col items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:F("h-8 w-8 sm:h-10 sm:w-10 rounded-full",d)}),e.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-center",children:c})]})]})}const C2=Date.now()%1e6;class T2{grad3;p;perm;constructor(l=0){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];for(let r=0;r<256;r++)this.p[r]=Math.floor(Math.random()*256);this.perm=[];for(let r=0;r<512;r++)this.perm[r]=this.p[r&255]}dot(l,r,c){return l[0]*r+l[1]*c}mix(l,r,c){return(1-c)*l+c*r}fade(l){return l*l*l*(l*(l*6-15)+10)}perlin2(l,r){const c=Math.floor(l)&255,d=Math.floor(r)&255;l-=Math.floor(l),r-=Math.floor(r);const m=this.fade(l),h=this.fade(r),f=this.perm[c]+d,p=this.perm[f],g=this.perm[f+1],N=this.perm[c+1]+d,j=this.perm[N],y=this.perm[N+1];return this.mix(this.mix(this.dot(this.grad3[p%12],l,r),this.dot(this.grad3[j%12],l-1,r),m),this.mix(this.dot(this.grad3[g%12],l,r-1),this.dot(this.grad3[y%12],l-1,r-1),m),h)}}function Lg(){const a=u.useRef(null),l=u.useRef(null),r=u.useRef(void 0),[c]=u.useState(()=>new T2(C2)),d=u.useRef({mouse:{x:-10,y:0,lx:0,ly:0,sx:0,sy:0,v:0,vs:0,a:0,set:!1},lines:[],paths:[],noise:c,bounding:null});return u.useEffect(()=>{const m=l.current,h=a.current;if(!m||!h)return;const f=d.current;f.noise=c;const p=()=>{const M=m.getBoundingClientRect();f.bounding=M,h.style.width=`${M.width}px`,h.style.height=`${M.height}px`},g=()=>{if(!f.bounding)return;const{width:M,height:S}=f.bounding;f.lines=[],f.paths.forEach(me=>me.remove()),f.paths=[];const P=10,E=32,C=M+200,R=S+30,H=Math.ceil(C/P),O=Math.ceil(R/E),X=(M-P*H)/2,L=(S-E*O)/2;for(let me=0;me<=H;me++){const Ne=[];for(let ce=0;ce<=O;ce++){const ge={x:X+P*me,y:L+E*ce,wave:{x:0,y:0},cursor:{x:0,y:0,vx:0,vy:0}};Ne.push(ge)}const je=document.createElementNS("http://www.w3.org/2000/svg","path");h.appendChild(je),f.paths.push(je),f.lines.push(Ne)}},N=M=>{const{lines:S,mouse:P,noise:E}=f;S.forEach(C=>{C.forEach(R=>{const H=E.perlin2((R.x+M*.0125)*.002,(R.y+M*.005)*.0015)*12;R.wave.x=Math.cos(H)*32,R.wave.y=Math.sin(H)*16;const O=R.x-P.sx,X=R.y-P.sy,L=Math.hypot(O,X),me=Math.max(175,P.vs);if(L<me){const Ne=1-L/me,je=Math.cos(L*.001)*Ne;R.cursor.vx+=Math.cos(P.a)*je*me*P.vs*65e-5,R.cursor.vy+=Math.sin(P.a)*je*me*P.vs*65e-5}R.cursor.vx+=(0-R.cursor.x)*.005,R.cursor.vy+=(0-R.cursor.y)*.005,R.cursor.vx*=.925,R.cursor.vy*=.925,R.cursor.x+=R.cursor.vx*2,R.cursor.y+=R.cursor.vy*2,R.cursor.x=Math.min(100,Math.max(-100,R.cursor.x)),R.cursor.y=Math.min(100,Math.max(-100,R.cursor.y))})})},j=(M,S=!0)=>{const P={x:M.x+M.wave.x+(S?M.cursor.x:0),y:M.y+M.wave.y+(S?M.cursor.y:0)};return P.x=Math.round(P.x*10)/10,P.y=Math.round(P.y*10)/10,P},y=()=>{const{lines:M,paths:S}=f;M.forEach((P,E)=>{let C=j(P[0],!1),R=`M ${C.x} ${C.y}`;P.forEach((H,O)=>{const X=O===P.length-1;C=j(H,!X),R+=`L ${C.x} ${C.y}`}),S[E].setAttribute("d",R)})},b=M=>{const{mouse:S}=f;S.sx+=(S.x-S.sx)*.1,S.sy+=(S.y-S.sy)*.1;const P=S.x-S.lx,E=S.y-S.ly,C=Math.hypot(P,E);S.v=C,S.vs+=(C-S.vs)*.1,S.vs=Math.min(100,S.vs),S.lx=S.x,S.ly=S.y,S.a=Math.atan2(E,P),m&&(m.style.setProperty("--x",`${S.sx}px`),m.style.setProperty("--y",`${S.sy}px`)),N(M),y(),r.current=requestAnimationFrame(b)},w=M=>{if(!f.bounding)return;const{mouse:S}=f;S.x=M.pageX-f.bounding.left,S.y=M.pageY-f.bounding.top+window.scrollY,S.set||(S.sx=S.x,S.sy=S.y,S.lx=S.x,S.ly=S.y,S.set=!0)},A=()=>{p(),g()};return p(),g(),window.addEventListener("resize",A),window.addEventListener("mousemove",w),r.current=requestAnimationFrame(b),()=>{window.removeEventListener("resize",A),window.removeEventListener("mousemove",w),r.current&&cancelAnimationFrame(r.current)}},[c]),e.jsxs("div",{ref:l,className:"waves-background",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},children:[e.jsx("div",{className:"waves-cursor",style:{position:"absolute",top:0,left:0,width:"0.5rem",height:"0.5rem",background:"hsl(var(--primary) / 0.3)",borderRadius:"50%",transform:"translate3d(calc(var(--x, -0.5rem) - 50%), calc(var(--y, 50%) - 50%), 0)",willChange:"transform",pointerEvents:"none"}}),e.jsx("svg",{ref:a,style:{display:"block",width:"100%",height:"100%"},children:e.jsx("style",{children:`
          path {
            fill: none;
            stroke: hsl(var(--primary) / 0.20);
            stroke-width: 1px;
          }
        `})})]})}function E2(){const[a,l]=u.useState(""),[r,c]=u.useState(!1),[d,m]=u.useState(""),[h,f]=u.useState(!0),p=xa(),{enableWavesBackground:g,setEnableWavesBackground:N}=Pv(),{theme:j,setTheme:y}=fx();u.useEffect(()=>{(async()=>{try{await cc()&&p({to:"/"})}catch{}finally{f(!1)}})()},[p]);const w=j==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":j,A=()=>{y(w==="dark"?"light":"dark")},M=async S=>{if(S.preventDefault(),m(""),!a.trim()){m(" Access Token");return}c(!0),console.log(" token...");try{const P=await fetch("/api/webui/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:a.trim()})});console.log("Token :",P.status);const E=await P.json();if(console.log("Token :",E),P.ok&&E.valid){console.log("Token ..."),console.log("is_first_setup:",E.is_first_setup),await new Promise(R=>setTimeout(R,100));const C=await cc();console.log(":",C),E.is_first_setup?(console.log(""),p({to:"/setup"})):(console.log(""),p({to:"/"}))}else console.error("Token :",E.message),m(E.message||"Token ")}catch(P){console.error("Token :",P),m("")}finally{c(!1)}};return h?e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Lg,{}),e.jsx("div",{className:"text-muted-foreground",children:"..."})]}):e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(Lg,{}),e.jsxs(Ce,{className:"relative z-10 w-full max-w-md shadow-2xl backdrop-blur-xl bg-card/80 border-border/50",children:[e.jsx("button",{onClick:A,className:"absolute right-4 top-4 rounded-lg p-2 hover:bg-accent transition-colors z-10 text-foreground",title:w==="dark"?"":"",children:w==="dark"?e.jsx(nx,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"}):e.jsx(ec,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"})}),e.jsxs(De,{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(_g,{className:"h-8 w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ue,{className:"text-2xl font-bold",children:" MaiBot"}),e.jsx(fs,{className:"text-base",children:" Access Token "})]})]}),e.jsx(Ae,{children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"token",className:"text-sm font-medium",children:"Access Token"}),e.jsxs("div",{className:"relative",children:[e.jsx(rx,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground",strokeWidth:2,fill:"none"}),e.jsx(ne,{id:"token",type:"password",placeholder:" Access Token",value:a,onChange:S=>l(S.target.value),className:F("pl-10",d&&"border-red-500 focus-visible:ring-red-500"),disabled:r,autoFocus:!0,autoComplete:"off"})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-red-50 p-3 text-sm text-red-600 dark:bg-red-950/50 dark:text-red-400",children:[e.jsx(Rt,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{children:d})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):""}),e.jsxs(Js,{children:[e.jsx(cd,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-primary hover:text-primary/80 transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(nv,{className:"h-4 w-4",strokeWidth:2,fill:"none"})," Token Token"]})}),e.jsxs(qs,{className:"sm:max-w-md",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(_g,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"})," Access Token"]}),e.jsx(nt,{children:"Access Token  MaiBot WebUI "})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T1,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" MaiBot  WebUI Access Token"}),e.jsxs("div",{className:"rounded bg-background p-2 font-mono text-xs",children:[e.jsx("p",{className:"text-muted-foreground",children:" WebUI Access Token: abc123..."}),e.jsx("p",{className:"text-muted-foreground",children:"  Token  WebUI"})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(La,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Token "}),e.jsx("div",{className:"rounded bg-background p-2 font-mono text-xs break-all",children:e.jsx("code",{className:"text-primary",children:"data/webui.json"})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",e.jsx("code",{className:"px-1 py-0.5 bg-background rounded",children:"access_token"})," "]})]})]})}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Rt,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token"})]})]})]})})]})]})]}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(el,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsxs(vs,{className:"flex items-center gap-2",children:[e.jsx(el,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"}),""]}),e.jsx(Ns,{children:""})]}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>N(!1),children:""})]})]})]})]})})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:m2})})]})}const ft=u.forwardRef(({className:a,autoResize:l=!0,minHeight:r=60,maxHeight:c,value:d,onChange:m,...h},f)=>{const p=u.useRef(null),[g,N]=u.useState(!1);u.useImperativeHandle(f,()=>p.current),u.useEffect(()=>{if(a){const b=/\b(h-\d+|h-\[[\d.]+(?:px|rem|em)\]|min-h-\[[\d.]+(?:px|rem|em)\])\b/.test(a);N(b)}},[a]);const j=u.useCallback(()=>{const b=p.current;if(!b||!l||g)return;b.style.height="auto";const w=b.scrollHeight;let A=Math.max(w,r);c&&c>0&&(A=Math.min(A,c)),b.style.height=`${A}px`,c&&c>0&&w>c?b.style.overflowY="auto":b.style.overflowY="hidden"},[l,g,r,c]);u.useEffect(()=>{j()},[d,j]),u.useEffect(()=>{j()},[j]);const y=u.useCallback(b=>{m?.(b),requestAnimationFrame(()=>{j()})},[m,j]);return e.jsx("textarea",{className:F("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","custom-scrollbar",l&&!g&&"resize-none overflow-hidden",a),ref:p,value:d,onChange:y,style:{minHeight:l&&!g?`${r}px`:void 0},...h})});ft.displayName="Textarea";const la=u.forwardRef(({className:a,orientation:l="horizontal",decorative:r=!0,...c},d)=>e.jsx(wj,{ref:d,decorative:r,orientation:l,className:F("shrink-0 bg-border",l==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",a),...c}));la.displayName=wj.displayName;function M2({config:a,onChange:l}){const r=d=>{d.trim()&&!a.alias_names.includes(d.trim())&&l({...a,alias_names:[...a.alias_names,d.trim()]})},c=d=>{l({...a,alias_names:a.alias_names.filter((m,h)=>h!==d)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ *"}),e.jsx(ne,{id:"qq_account",type:"number",placeholder:"QQ",value:a.qq_account||"",onChange:d=>l({...a,qq_account:Number(d.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"QQ"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"nickname",children:" *"}),e.jsx(ne,{id:"nickname",placeholder:"",value:a.nickname,onChange:d=>l({...a,nickname:d.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{children:""}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:a.alias_names.map((d,m)=>e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[d,e.jsx("button",{type:"button",onClick:()=>c(m),className:"ml-1 hover:text-destructive",children:e.jsx(_a,{className:"h-3 w-3"})})]},m))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{id:"alias_input",placeholder:"",onKeyPress:d=>{d.key==="Enter"&&(r(d.target.value),d.target.value="")}}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>{const d=document.getElementById("alias_input");d&&(r(d.value),d.value="")},children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function A2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"personality",children:" *"}),e.jsx(ft,{id:"personality",placeholder:"120",value:a.personality,onChange:r=>l({...a,personality:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"reply_style",children:" *"}),e.jsx(ft,{id:"reply_style",placeholder:"",value:a.reply_style,onChange:r=>l({...a,reply_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"interest",children:" *"}),e.jsx(ft,{id:"interest",placeholder:"",value:a.interest,onChange:r=>l({...a,interest:r.target.value}),rows:2}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"plan_style",children:" *"}),e.jsx(ft,{id:"plan_style",placeholder:"",value:a.plan_style,onChange:r=>l({...a,plan_style:r.target.value}),rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"private_plan_style",children:" *"}),e.jsx(ft,{id:"private_plan_style",placeholder:"",value:a.private_plan_style,onChange:r=>l({...a,private_plan_style:r.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function z2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[(a.emoji_chance*100).toFixed(0),"%"]})]}),e.jsx(ne,{id:"emoji_chance",type:"range",min:"0",max:"1",step:"0.1",value:a.emoji_chance,onChange:r=>l({...a,emoji_chance:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ne,{id:"max_reg_num",type:"number",min:"1",max:"200",value:a.max_reg_num,onChange:r=>l({...a,max_reg_num:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"do_replace",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"do_replace",checked:a.do_replace,onCheckedChange:r=>l({...a,do_replace:r})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ne,{id:"check_interval",type:"number",min:"1",max:"120",value:a.check_interval,onChange:r=>l({...a,check_interval:Number(r.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(la,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"steal_emoji",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"steal_emoji",checked:a.steal_emoji,onCheckedChange:r=>l({...a,steal_emoji:r})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"content_filtration",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"content_filtration",checked:a.content_filtration,onCheckedChange:r=>l({...a,content_filtration:r})})]}),a.content_filtration&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ne,{id:"filtration_prompt",placeholder:"",value:a.filtration_prompt,onChange:r=>l({...a,filtration_prompt:r.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function R2({config:a,onChange:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"enable_tool",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"enable_tool",checked:a.enable_tool,onCheckedChange:r=>l({...a,enable_tool:r})})]}),e.jsx(la,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"all_global",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"all_global",checked:a.all_global,onCheckedChange:r=>l({...a,all_global:r})})]})]})}function D2({config:a,onChange:l}){const[r,c]=u.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:" (SiliconFlow)"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 mb-2",children:" DeepSeek V3Qwen  API Key "}),e.jsxs("a",{href:"https://cloud.siliconflow.cn",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:underline font-medium",children:[" API Key",e.jsx($o,{className:"h-3 w-3"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{htmlFor:"siliconflow_api_key",children:"SiliconFlow API Key *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{id:"siliconflow_api_key",type:r?"text":"password",placeholder:"sk-...",value:a.api_key,onChange:d=>l({api_key:d.target.value}),className:"font-mono pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!r),children:r?e.jsx(nc,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ma,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" API "})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground ml-2",children:[e.jsx("li",{children:"DeepSeek V3 - "}),e.jsx("li",{children:"Qwen3 30B - "}),e.jsx("li",{children:"Qwen3 VL 30B - "}),e.jsx("li",{children:"SenseVoice - "}),e.jsx("li",{children:"BGE-M3 - "}),e.jsx("li",{children:" (LPMM)"})]})]}),e.jsx("div",{className:"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 p-4",children:e.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-medium",children:" "}),'"  " API ']})})]})}async function O2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Ws()});if(!a.ok)throw new Error("Bot");const r=(await a.json()).config.bot||{};return{qq_account:r.qq_account||0,nickname:r.nickname||"",alias_names:r.alias_names||[]}}async function L2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Ws()});if(!a.ok)throw new Error("");const r=(await a.json()).config.personality||{};return{personality:r.personality||"",reply_style:r.reply_style||"",interest:r.interest||"",plan_style:r.plan_style||"",private_plan_style:r.private_plan_style||""}}async function U2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Ws()});if(!a.ok)throw new Error("");const r=(await a.json()).config.emoji||{};return{emoji_chance:r.emoji_chance??.4,max_reg_num:r.max_reg_num??40,do_replace:r.do_replace??!0,check_interval:r.check_interval??10,steal_emoji:r.steal_emoji??!0,content_filtration:r.content_filtration??!1,filtration_prompt:r.filtration_prompt||""}}async function $2(){const a=await Se("/api/webui/config/bot",{method:"GET",headers:Ws()});if(!a.ok)throw new Error("");const r=(await a.json()).config,c=r.tool||{},d=r.expression||{};return{enable_tool:c.enable_tool??!0,all_global:d.all_global_jargon??!0}}async function B2(){const a=await Se("/api/webui/config/model",{method:"GET",headers:Ws()});if(!a.ok)throw new Error("");return{api_key:((await a.json()).config.api_providers||[]).find(m=>m.name==="SiliconFlow")?.api_key||""}}async function I2(a){const l=await Se("/api/webui/config/bot/section/bot",{method:"POST",headers:Ws(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"Bot")}return await l.json()}async function P2(a){const l=await Se("/api/webui/config/bot/section/personality",{method:"POST",headers:Ws(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function F2(a){const l=await Se("/api/webui/config/bot/section/emoji",{method:"POST",headers:Ws(),body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function H2(a){const l=[];l.push(Se("/api/webui/config/bot/section/tool",{method:"POST",headers:Ws(),body:JSON.stringify({enable_tool:a.enable_tool})})),l.push(Se("/api/webui/config/bot/section/expression",{method:"POST",headers:Ws(),body:JSON.stringify({all_global_jargon:a.all_global})}));const r=await Promise.all(l);for(const c of r)if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return{success:!0}}async function q2(a){const l=await Se("/api/webui/config/model",{method:"GET",headers:Ws()});if(!l.ok)throw new Error("");const c=(await l.json()).config,d=c.api_providers||[],m=d.findIndex(p=>p.name==="SiliconFlow");m>=0?d[m]={...d[m],api_key:a.api_key}:d.push({name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",api_key:a.api_key,client_type:"openai",max_retry:3,timeout:120,retry_interval:5});const h={...c,api_providers:d},f=await Se("/api/webui/config/model",{method:"POST",headers:Ws(),body:JSON.stringify(h)});if(!f.ok){const p=await f.json();throw new Error(p.detail||"")}return await f.json()}async function Ug(){const a=await Se("/api/webui/setup/complete",{method:"POST"});if(!a.ok){const l=await a.json();throw new Error(l.message||"")}return await a.json()}function V2(){return e.jsx(tr,{children:e.jsx(G2,{})})}function G2(){const a=xa(),{toast:l}=it(),{triggerRestart:r}=_n(),[c,d]=u.useState(0),[m,h]=u.useState(!1),[f,p]=u.useState(!1),[g,N]=u.useState(!0),[j,y]=u.useState({qq_account:0,nickname:"",alias_names:[]}),[b,w]=u.useState({personality:"",reply_style:"",interest:"",plan_style:`1.****action****
2.
3.
4.
5.`,private_plan_style:`1.****action****
2.
3.`}),[A,M]=u.useState({emoji_chance:.4,max_reg_num:40,do_replace:!0,check_interval:10,steal_emoji:!0,content_filtration:!1,filtration_prompt:""}),[S,P]=u.useState({enable_tool:!0,all_global:!0}),[E,C]=u.useState({api_key:""}),R=[{id:"bot-basic",title:"Bot",description:"",icon:Kn},{id:"personality",title:"",description:"",icon:$l},{id:"emoji",title:"",description:"",icon:ld},{id:"other",title:"",description:"",icon:bn},{id:"siliconflow",title:"API",description:"API",icon:rx}],H=(c+1)/R.length*100;u.useEffect(()=>{(async()=>{try{N(!0);const[ge,pe,D,K,B]=await Promise.all([O2(),L2(),U2(),$2(),B2()]);y(ge),w(pe),M(D),P(K),C(B)}catch(ge){l({title:"",description:ge instanceof Error?ge.message:"",variant:"destructive"})}finally{N(!1)}})()},[l]);const O=async()=>{p(!0);try{switch(c){case 0:await I2(j);break;case 1:await P2(b);break;case 2:await F2(A);break;case 3:await H2(S);break;case 4:await q2(E);break}return l({title:"",description:`${R[c].title}`}),!0}catch(ce){return l({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"}),!1}finally{p(!1)}},X=async()=>{await O()&&c<R.length-1&&d(c+1)},L=()=>{c>0&&d(c-1)},me=async()=>{h(!0);try{if(!await O()){h(!1);return}await Ug(),l({title:"",description:"..."}),await r()}catch(ce){l({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{h(!1)}},Ne=async()=>{try{await Ug(),a({to:"/"})}catch(ce){l({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}},je=()=>{switch(c){case 0:return e.jsx(M2,{config:j,onChange:y});case 1:return e.jsx(A2,{config:b,onChange:w});case 2:return e.jsx(z2,{config:A,onChange:M});case 3:return e.jsx(R2,{config:S,onChange:P});case 4:return e.jsx(D2,{config:E,onChange:C});default:return null}};return e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center justify-center overflow-hidden bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4 md:p-6",children:[e.jsx(ar,{}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute left-1/4 top-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-primary/5 blur-3xl"}),e.jsx("div",{className:"absolute right-1/4 bottom-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-secondary/5 blur-3xl"})]}),g?e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center",children:e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative z-10 w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6 md:mb-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 md:h-16 md:w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(E1,{className:"h-6 w-6 md:h-8 md:w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsx("h1",{className:"mb-2 text-2xl md:text-3xl font-bold",children:""}),e.jsxs("p",{className:"text-sm md:text-base text-muted-foreground",children:[" ",px," "]})]}),e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs md:text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[" ",c+1," / ",R.length]}),e.jsxs("span",{className:"font-medium text-primary",children:[Math.round(H),"%"]})]}),e.jsx(er,{value:H,className:"h-2"})]}),e.jsx("div",{className:"mb-6 md:mb-8 flex justify-between",children:R.map((ce,ge)=>{const pe=ce.icon;return e.jsxs("div",{className:F("flex flex-1 flex-col items-center gap-1 md:gap-2",ge<R.length-1&&"relative"),children:[ge<R.length-1&&e.jsx("div",{className:F("absolute left-1/2 top-3 md:top-4 h-0.5 w-full",ge<c?"bg-primary":"bg-border")}),e.jsx("div",{className:F("relative z-10 flex h-6 w-6 md:h-8 md:w-8 items-center justify-center rounded-full border-2 transition-all",ge===c||ge<c?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-muted-foreground"),children:ge<c?e.jsx(tt,{className:"h-3 w-3 md:h-4 md:w-4",strokeWidth:2.5,fill:"none"}):e.jsx(pe,{className:"h-3 w-3 md:h-4 md:w-4"})}),e.jsx("span",{className:F("text-[10px] md:text-xs text-center max-w-[60px] md:max-w-none truncate md:whitespace-normal",ge===c?"font-medium text-foreground":"text-muted-foreground"),title:ce.title,children:ce.title})]},ce.id)})}),e.jsx(Ce,{className:"mb-6 md:mb-8 shadow-lg",children:e.jsx(Ae,{className:"p-4 md:p-8",children:e.jsxs("div",{className:"min-h-[300px] md:min-h-[400px]",children:[e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsx("h2",{className:"mb-2 text-xl md:text-2xl font-semibold",children:R[c].title}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:R[c].description})]}),e.jsx(ss,{className:"h-[400px] md:h-[500px]",children:e.jsx("div",{className:"pr-2",children:je()})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:L,disabled:c===0||f,className:"w-full sm:w-auto order-2 sm:order-1",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto order-1 sm:order-2",children:[e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"flex-1 sm:flex-none gap-2",disabled:f||m,children:[e.jsx(M1,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{children:""})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:Ne,children:""})]})]})]}),c===R.length-1?e.jsx(_,{onClick:me,disabled:m||f,className:"flex-1 sm:flex-none",children:m||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),f?"...":"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(tt,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})}):e.jsx(_,{onClick:X,disabled:f,className:"flex-1 sm:flex-none",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(A1,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})})]})]})]}),e.jsx("div",{className:"relative z-10 mt-6 md:mt-8 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:""})})]})]})}function qv(){const a=xa();return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("h1",{className:"text-[150px] font-black leading-none text-primary/10 select-none sm:text-[200px]",children:"404"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Ut,{className:"h-20 w-20 text-primary/30 sm:h-24 sm:w-24"})})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground sm:text-3xl",children:""}),e.jsx("p",{className:"text-base text-muted-foreground sm:text-lg max-w-md mx-auto",children:" URL "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs(_,{size:"lg",onClick:()=>a({to:"/"}),className:"gap-2 w-full sm:w-auto",children:[e.jsx(nd,{className:"h-4 w-4"}),""]}),e.jsxs(_,{size:"lg",variant:"outline",onClick:()=>window.history.back(),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Ua,{className:"h-4 w-4"}),""]})]}),e.jsx("div",{className:"mt-12 pt-8 border-t border-border",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})})]})})}const K2=Hs.memo(function({config:l,onChange:r}){const c=l.platforms||[],d=l.alias_names||[],m=()=>{r({...l,platforms:[...c,""]})},h=j=>{r({...l,platforms:c.filter((y,b)=>b!==j)})},f=(j,y)=>{const b=[...c];b[j]=y,r({...l,platforms:b})},p=()=>{r({...l,alias_names:[...d,""]})},g=j=>{r({...l,alias_names:d.filter((y,b)=>b!==j)})},N=(j,y)=>{const b=[...d];b[j]=y,r({...l,alias_names:b})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"platform",children:""}),e.jsx(ne,{id:"platform",value:l.platform,onChange:j=>r({...l,platform:j.target.value}),placeholder:"qq"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"qq_account",children:"QQ"}),e.jsx(ne,{id:"qq_account",value:l.qq_account,onChange:j=>r({...l,qq_account:j.target.value}),placeholder:"123456789"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ne,{id:"nickname",value:l.nickname,onChange:j=>r({...l,nickname:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:p,size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[d.map((j,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:j,onChange:b=>N(y,b.target.value),placeholder:""}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',j||"()",'" ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>g(y),children:""})]})]})]})]},y)),d.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:m,size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((j,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:j,onChange:b=>f(y,b.target.value),placeholder:"wx:114514"}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',j||"()",'" ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>h(y),children:""})]})]})]})]},y)),c.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})]})})}),Q2=Hs.memo(function({config:l,onChange:r}){const c=()=>{r({...l,states:[...l.states,""]})},d=h=>{r({...l,states:l.states.filter((f,p)=>p!==h)})},m=(h,f)=>{const p=[...l.states];p[h]=f,r({...l,states:p})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"personality",children:""}),e.jsx(ft,{id:"personality",value:l.personality,onChange:h=>r({...l,personality:h.target.value}),placeholder:"120",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"120"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"space-y-2",children:l.states.map((h,f)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ft,{value:h,onChange:p=>m(f,p.target.value),placeholder:"",rows:2}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{children:""})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>d(f),children:""})]})]})]})]},f))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"state_probability",children:""}),e.jsx(ne,{id:"state_probability",type:"number",step:"0.1",min:"0",max:"1",value:l.state_probability,onChange:h=>r({...l,state_probability:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.0-1.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"reply_style",children:""}),e.jsx(ft,{id:"reply_style",value:l.reply_style,onChange:h=>r({...l,reply_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_style",children:""}),e.jsx(ft,{id:"plan_style",value:l.plan_style,onChange:h=>r({...l,plan_style:h.target.value}),placeholder:"",rows:5})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"visual_style",children:""}),e.jsx(ft,{id:"visual_style",value:l.visual_style,onChange:h=>r({...l,visual_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"private_plan_style",children:""}),e.jsx(ft,{id:"private_plan_style",value:l.private_plan_style,onChange:h=>r({...l,private_plan_style:h.target.value}),placeholder:"",rows:4})]})]})]})})}),hl=_w,fl=Sw,nl=u.forwardRef(({className:a,align:l="center",sideOffset:r=4,...c},d)=>e.jsx(ww,{children:e.jsx(_j,{ref:d,align:l,sideOffset:r,className:F("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...c})}));nl.displayName=_j.displayName;const Y2=Hs.memo(function({value:l,onChange:r}){const c=u.useMemo(()=>{const b=l.split("-");if(b.length===2){const[w,A]=b,[M,S]=w.split(":"),[P,E]=A.split(":");return{startHour:M?M.padStart(2,"0"):"00",startMinute:S?S.padStart(2,"0"):"00",endHour:P?P.padStart(2,"0"):"23",endMinute:E?E.padStart(2,"0"):"59"}}return{startHour:"00",startMinute:"00",endHour:"23",endMinute:"59"}},[l]),[d,m]=u.useState(c.startHour),[h,f]=u.useState(c.startMinute),[p,g]=u.useState(c.endHour),[N,j]=u.useState(c.endMinute);u.useEffect(()=>{m(c.startHour),f(c.startMinute),g(c.endHour),j(c.endMinute)},[c]);const y=(b,w,A,M)=>{const S=`${b}:${w}-${A}:${M}`;r(S)};return e.jsxs(hl,{children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"w-full justify-start font-mono text-sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-2"}),l||""]})}),e.jsx(nl,{className:"w-72 sm:w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:d,onValueChange:b=>{m(b),y(b,h,p,N)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:24},(b,w)=>w).map(b=>e.jsx(ee,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:h,onValueChange:b=>{f(b),y(d,b,p,N)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:60},(b,w)=>w).map(b=>e.jsx(ee,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:p,onValueChange:b=>{g(b),y(d,h,b,N)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:24},(b,w)=>w).map(b=>e.jsx(ee,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs",children:""}),e.jsxs(Pe,{value:N,onValueChange:b=>{j(b),y(d,h,p,b)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:Array.from({length:60},(b,w)=>w).map(b=>e.jsx(ee,{value:b.toString().padStart(2,"0"),children:b.toString().padStart(2,"0")},b))})]})]})]})]})]})})]})}),J2=Hs.memo(function({rule:l}){const r=`{ target = "${l.target}", time = "${l.time}", value = ${l.value.toFixed(1)} }`;return e.jsxs(hl,{children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ma,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(nl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})}),X2=Hs.memo(function({config:l,onChange:r}){const c=()=>{r({...l,talk_value_rules:[...l.talk_value_rules,{target:"",time:"00:00-23:59",value:1}]})},d=h=>{r({...l,talk_value_rules:l.talk_value_rules.filter((f,p)=>p!==h)})},m=(h,f,p)=>{const g=[...l.talk_value_rules];g[h]={...g[h],[f]:p},r({...l,talk_value_rules:g})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"talk_value",children:""}),e.jsx(ne,{id:"talk_value",type:"number",step:"0.1",min:"0",max:"1",value:l.talk_value,onChange:h=>r({...l,talk_value:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"think_mode",children:""}),e.jsxs(Pe,{value:l.think_mode||"classic",onValueChange:h=>r({...l,think_mode:h}),children:[e.jsx(Be,{id:"think_mode",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"classic",children:" - "}),e.jsx(ee,{value:"deep",children:" - "}),e.jsx(ee,{value:"dynamic",children:" - "})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"mentioned_bot_reply",checked:l.mentioned_bot_reply,onCheckedChange:h=>r({...l,mentioned_bot_reply:h})}),e.jsx(T,{htmlFor:"mentioned_bot_reply",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_context_size",children:""}),e.jsx(ne,{id:"max_context_size",type:"number",min:"1",value:l.max_context_size,onChange:h=>r({...l,max_context_size:parseInt(h.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"planner_smooth",children:""}),e.jsx(ne,{id:"planner_smooth",type:"number",step:"1",min:"0",value:l.planner_smooth,onChange:h=>r({...l,planner_smooth:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" planner  1-50 "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"plan_reply_log_max_per_chat",children:""}),e.jsx(ne,{id:"plan_reply_log_max_per_chat",type:"number",step:"1",min:"100",value:l.plan_reply_log_max_per_chat??1024,onChange:h=>r({...l,plan_reply_log_max_per_chat:parseInt(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Plan/Reply "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"llm_quote",checked:l.llm_quote??!1,onCheckedChange:h=>r({...l,llm_quote:h})}),e.jsx(T,{htmlFor:"llm_quote",className:"cursor-pointer",children:" LLM "})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2 ml-10",children:"LLM "}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_talk_value_rules",checked:l.enable_talk_value_rules,onCheckedChange:h=>r({...l,enable_talk_value_rules:h})}),e.jsx(T,{htmlFor:"enable_talk_value_rules",className:"cursor-pointer",children:""})]})]})]}),l.enable_talk_value_rules&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ID"})]}),e.jsxs(_,{onClick:c,size:"sm",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),l.talk_value_rules&&l.talk_value_rules.length>0?e.jsx("div",{className:"space-y-4",children:l.talk_value_rules.map((h,f)=>e.jsxs("div",{className:"rounded-lg border p-4 bg-muted/50 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[" #",f+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J2,{rule:h}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(us,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" #",f+1," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>d(f),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:h.target===""?"global":"specific",onValueChange:p=>{p==="global"?m(f,"target",""):m(f,"target","qq::group")},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"global",children:""}),e.jsx(ee,{value:"specific",children:""})]})]})]}),h.target!==""&&(()=>{const p=h.target.split(":"),g=p[0]||"qq",N=p[1]||"",j=p[2]||"group";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:g,onValueChange:y=>{m(f,"target",`${y}:${N}:${j}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"qq",children:"QQ"}),e.jsx(ee,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ne,{value:N,onChange:y=>{m(f,"target",`${g}:${y.target.value}:${j}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:j,onValueChange:y=>{m(f,"target",`${g}:${N}:${y}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"group",children:"group"}),e.jsx(ee,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",h.target||""]})]})})(),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" (Time)"}),e.jsx(Y2,{value:h.time,onChange:p=>m(f,"time",p)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00-02:00"})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:`rule-value-${f}`,className:"text-xs font-medium",children:" (Value)"}),e.jsx(ne,{id:`rule-value-${f}`,type:"number",step:"0.01",min:"0.01",max:"1",value:h.value,onChange:p=>{const g=parseFloat(p.target.value);isNaN(g)||m(f,"value",Math.max(.01,Math.min(1,g)))},className:"w-20 h-8 text-xs"})]}),e.jsx(Wa,{value:[h.value],onValueChange:p=>m(f,"value",p[0]),min:.01,max:1,step:.01,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0.01 ()"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0 ()"})]})]})]})]},f))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:'""'})}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),"platform:id:type"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 23:00-02:00 112"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 0-10 1 "]})]})]})]})]})}),Z2=Hs.memo(function({config:l,onChange:r}){const c=S=>{if(!S||!S.includes(":"))return{platform:"qq",userId:""};const[P,E]=S.split(":");return{platform:P,userId:E}},{platform:d,userId:m}=c(l.dream_send),[h,f]=u.useState(d),[p,g]=u.useState(m),N=S=>{const[P,E]=S.split("-");return{startTime:P||"09:00",endTime:E||"22:00"}},j=(S,P)=>{const E=P?`${S}:${P}`:"";r({...l,dream_send:E})},y=S=>{f(S),j(S,p)},b=S=>{g(S),j(h,S)},w=()=>{r({...l,dream_time_ranges:[...l.dream_time_ranges,"09:00-22:00"]})},A=S=>{r({...l,dream_time_ranges:l.dream_time_ranges.filter((P,E)=>E!==S)})},M=(S,P,E)=>{const C=[...l.dream_time_ranges],R=N(C[S]);P==="startTime"?R.startTime=E:R.endTime=E,C[S]=`${R.startTime}-${R.endTime}`,r({...l,dream_time_ranges:C})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"interval_minutes",children:""}),e.jsx(ne,{id:"interval_minutes",type:"number",min:"1",value:l.interval_minutes,onChange:S=>r({...l,interval_minutes:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"max_iterations",children:""}),e.jsx(ne,{id:"max_iterations",type:"number",min:"1",value:l.max_iterations,onChange:S=>r({...l,max_iterations:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"first_delay_seconds",children:""}),e.jsx(ne,{id:"first_delay_seconds",type:"number",min:"0",value:l.first_delay_seconds,onChange:S=>r({...l,first_delay_seconds:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Pe,{value:h,onValueChange:y,children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"qq",children:"QQ"}),e.jsx(ee,{value:"wx",children:""}),e.jsx(ee,{value:"webui",children:"WebUI"})]})]}),e.jsx(ne,{type:"text",placeholder:"ID (: 123456)",value:p,onChange:S=>b(S.target.value),className:"flex-1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IDID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(_,{type:"button",size:"sm",onClick:w,children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00  02:00"}),e.jsxs("div",{className:"space-y-2",children:[l.dream_time_ranges.map((S,P)=>{const{startTime:E,endTime:C}=N(S);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"time",value:E,onChange:R=>M(P,"startTime",R.target.value),className:"w-[140px]"}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(ne,{type:"time",value:C,onChange:R=>M(P,"endTime",R.target.value),className:"w-[140px]"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:()=>A(P),children:e.jsx(_a,{className:"h-4 w-4"})})]},P)}),l.dream_time_ranges.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})}),W2=Hs.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.enable,onCheckedChange:c=>r({...l,enable:c})}),e.jsx(T,{className:"cursor-pointer",children:" LPMM "})]}),l.enable&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"LPMM "}),e.jsxs(Pe,{value:l.lpmm_mode,onValueChange:c=>r({...l,lpmm_mode:c}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:" LPMM "})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"classic",children:""}),e.jsx(ee,{value:"agent",children:"Agent "})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" TopK"}),e.jsx(ne,{type:"number",min:"1",value:l.rag_synonym_search_top_k,onChange:c=>r({...l,rag_synonym_search_top_k:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",step:"0.1",min:"0",max:"1",value:l.rag_synonym_threshold,onChange:c=>r({...l,rag_synonym_threshold:parseFloat(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:l.info_extraction_workers,onChange:c=>r({...l,info_extraction_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:l.embedding_dimension,onChange:c=>r({...l,embedding_dimension:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:l.max_embedding_workers,onChange:c=>r({...l,max_embedding_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:l.embedding_chunk_size,onChange:c=>r({...l,embedding_chunk_size:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",min:"1",value:l.max_synonym_entities,onChange:c=>r({...l,max_synonym_entities:parseInt(c.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.enable_ppr,onCheckedChange:c=>r({...l,enable_ppr:c})}),e.jsx(T,{className:"cursor-pointer",children:" PPR ()"})]})]})]})]})}),eS=Hs.memo(function({config:l,onChange:r}){const[c,d]=u.useState(""),[m,h]=u.useState("WARNING"),f=()=>{c&&!l.suppress_libraries.includes(c)&&(r({...l,suppress_libraries:[...l.suppress_libraries,c]}),d(""))},p=w=>{r({...l,suppress_libraries:l.suppress_libraries.filter(A=>A!==w)})},g=()=>{c&&!l.library_log_levels[c]&&(r({...l,library_log_levels:{...l.library_log_levels,[c]:m}}),d(""),h("WARNING"))},N=w=>{const A={...l.library_log_levels};delete A[w],r({...l,library_log_levels:A})},j=["DEBUG","INFO","WARNING","ERROR","CRITICAL"],y=["FULL","compact","lite"],b=["none","title","full"];return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{value:l.date_style,onChange:w=>r({...l,date_style:w.target.value}),placeholder:": m-d H:i:s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"m=, d=, H=, i=, s="})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.log_level_style,onValueChange:w=>r({...l,log_level_style:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:y.map(w=>e.jsx(ee,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.color_text,onValueChange:w=>r({...l,color_text:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:b.map(w=>e.jsx(ee,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.log_level,onValueChange:w=>r({...l,log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(ee,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.console_log_level,onValueChange:w=>r({...l,console_log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(ee,{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.file_log_level,onValueChange:w=>r({...l,file_log_level:w}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(ee,{value:w,children:w},w))})]})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:c,onChange:w=>d(w.target.value),placeholder:"",className:"flex-1",onKeyDown:w=>{w.key==="Enter"&&(w.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",className:"flex-shrink-0",children:e.jsx(at,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.suppress_libraries.map(w=>e.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-3 py-1 rounded-md",children:[e.jsx("span",{className:"text-sm",children:w}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>p(w),children:e.jsx(us,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},w))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:c,onChange:w=>d(w.target.value),placeholder:"",className:"flex-1"}),e.jsxs(Pe,{value:m,onValueChange:h,children:[e.jsx(Be,{className:"w-32",children:e.jsx(Fe,{})}),e.jsx(Ie,{children:j.map(w=>e.jsx(ee,{value:w,children:w},w))})]}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(at,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(l.library_log_levels).map(([w,A])=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-medium",children:w}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:A}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(w),children:e.jsx(us,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]})]},w))})]})]})}),sS=Hs.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_prompt,onCheckedChange:c=>r({...l,show_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_replyer_prompt,onCheckedChange:c=>r({...l,show_replyer_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_replyer_reasoning,onCheckedChange:c=>r({...l,show_replyer_reasoning:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Jargon Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_jargon_prompt,onCheckedChange:c=>r({...l,show_jargon_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.show_memory_prompt,onCheckedChange:c=>r({...l,show_memory_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" Planner Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Planner "})]}),e.jsx(Ge,{checked:l.show_planner_prompt,onCheckedChange:c=>r({...l,show_planner_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" LPMM "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LPMM "})]}),e.jsx(Ge,{checked:l.show_lpmm_paragraph,onCheckedChange:c=>r({...l,show_lpmm_paragraph:c})})]})]})]})}),tS=Hs.memo(function({config:l,onChange:r}){const[c,d]=u.useState(""),[m,h]=u.useState(""),f=()=>{c&&!l.auth_token.includes(c)&&(r({...l,auth_token:[...l.auth_token,c]}),d(""))},p=j=>{r({...l,auth_token:l.auth_token.filter((y,b)=>b!==j)})},g=()=>{m&&!l.api_server_allowed_api_keys.includes(m)&&(r({...l,api_server_allowed_api_keys:[...l.api_server_allowed_api_keys,m]}),h(""))},N=j=>{r({...l,api_server_allowed_api_keys:l.api_server_allowed_api_keys.filter((y,b)=>b!==j)})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:" API "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:" API "}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:c,onChange:j=>d(j.target.value),placeholder:"",onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",children:e.jsx(at,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:l.auth_token.map((j,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:j}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>p(y),children:e.jsx(us,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:" API Server "}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:" API Server"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" API Server"})]}),e.jsx(Ge,{checked:l.enable_api_server,onCheckedChange:j=>r({...l,enable_api_server:j})})]}),l.enable_api_server&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{value:l.api_server_host,onChange:j=>r({...l,api_server_host:j.target.value}),placeholder:"0.0.0.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",value:l.api_server_port,onChange:j=>r({...l,api_server_port:parseInt(j.target.value)}),placeholder:"8090"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.api_server_use_wss,onCheckedChange:j=>r({...l,api_server_use_wss:j})}),e.jsx(T,{children:" WSS "})]}),l.api_server_use_wss&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ne,{value:l.api_server_cert_file,onChange:j=>r({...l,api_server_cert_file:j.target.value}),placeholder:"cert.pem"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"SSL "}),e.jsx(ne,{value:l.api_server_key_file,onChange:j=>r({...l,api_server_key_file:j.target.value}),placeholder:"key.pem"})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"mb-2 block",children:" API Key "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ne,{value:m,onChange:j=>h(j.target.value),placeholder:" API Key",onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),g())}}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(at,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:l.api_server_allowed_api_keys.map((j,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:j}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(y),children:e.jsx(us,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]})]})]})]})]})}),aS=Hs.memo(function({config:l,onChange:r}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{checked:l.enable,onCheckedChange:c=>r({...l,enable:c})})]})]})}),lS=Hs.memo(function({emojiConfig:l,memoryConfig:r,toolConfig:c,voiceConfig:d,onEmojiChange:m,onMemoryChange:h,onToolChange:f,onVoiceChange:p}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_tool",checked:c.enable_tool,onCheckedChange:g=>f({...c,enable_tool:g})}),e.jsx(T,{htmlFor:"enable_tool",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(Ge,{id:"enable_asr",checked:d.enable_asr,onCheckedChange:g=>p({...d,enable_asr:g})}),e.jsx(T,{htmlFor:"enable_asr",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_agent_iterations",children:""}),e.jsx(ne,{id:"max_agent_iterations",type:"number",min:"1",value:r.max_agent_iterations,onChange:g=>h({...r,max_agent_iterations:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"agent_timeout_seconds",children:""}),e.jsx(ne,{id:"agent_timeout_seconds",type:"number",min:"1",step:"0.1",value:r.agent_timeout_seconds??120,onChange:g=>h({...r,agent_timeout_seconds:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_jargon_detection",checked:r.enable_jargon_detection??!0,onCheckedChange:g=>h({...r,enable_jargon_detection:g})}),e.jsx(T,{htmlFor:"enable_jargon_detection",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"global_memory",checked:r.global_memory??!1,onCheckedChange:g=>h({...r,global_memory:g})}),e.jsx(T,{htmlFor:"global_memory",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"emoji_chance",children:""}),e.jsx(ne,{id:"emoji_chance",type:"number",step:"0.1",min:"0",max:"1",value:l.emoji_chance,onChange:g=>m({...l,emoji_chance:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_reg_num",children:""}),e.jsx(ne,{id:"max_reg_num",type:"number",min:"1",value:l.max_reg_num,onChange:g=>m({...l,max_reg_num:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"check_interval",children:""}),e.jsx(ne,{id:"check_interval",type:"number",min:"1",value:l.check_interval,onChange:g=>m({...l,check_interval:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"do_replace",checked:l.do_replace,onCheckedChange:g=>m({...l,do_replace:g})}),e.jsx(T,{htmlFor:"do_replace",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"steal_emoji",checked:l.steal_emoji,onCheckedChange:g=>m({...l,steal_emoji:g})}),e.jsx(T,{htmlFor:"steal_emoji",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"content_filtration",checked:l.content_filtration,onCheckedChange:g=>m({...l,content_filtration:g})}),e.jsx(T,{htmlFor:"content_filtration",className:"cursor-pointer",children:""})]}),l.content_filtration&&e.jsxs("div",{className:"grid gap-2 pl-6 border-l-2 border-primary/20",children:[e.jsx(T,{htmlFor:"filtration_prompt",children:""}),e.jsx(ne,{id:"filtration_prompt",value:l.filtration_prompt,onChange:g=>m({...l,filtration_prompt:g.target.value}),placeholder:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})})]})}),nS=Hs.memo(function({member:l,groupIndex:r,memberIndex:c,availableChatIds:d,onUpdate:m,onRemove:h}){const f=d.includes(l)||l==="*",[p,g]=u.useState(!f);return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 flex gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx(ne,{value:l,onChange:N=>m(r,c,N.target.value),placeholder:' "*"  "qq:123456:group"',className:"flex-1"}),d.length>0&&e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!1),title:"",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{value:l,onValueChange:N=>m(r,c,N),children:[e.jsx(Be,{className:"flex-1",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"*",children:"* ()"}),d.map((N,j)=>e.jsx(ee,{value:N,children:N},j))]})]}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!0),title:"",children:""})]})}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',l||"()",'" ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>h(r,c),children:""})]})]})]})]})}),rS=Hs.memo(function({config:l,onChange:r}){const c=()=>{r({...l,learning_list:[...l.learning_list,["","enable","enable","1.0"]]})},d=y=>{r({...l,learning_list:l.learning_list.filter((b,w)=>w!==y)})},m=(y,b,w)=>{const A=[...l.learning_list];A[y][b]=w,r({...l,learning_list:A})},h=({rule:y})=>{const b=`["${y[0]}", "${y[1]}", "${y[2]}", "${y[3]}"]`;return e.jsxs(hl,{children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ma,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(nl,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:b}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},f=()=>{r({...l,expression_groups:[...l.expression_groups,[]]})},p=y=>{r({...l,expression_groups:l.expression_groups.filter((b,w)=>w!==y)})},g=y=>{const b=[...l.expression_groups];b[y]=[...b[y],""],r({...l,expression_groups:b})},N=(y,b)=>{const w=[...l.expression_groups];w[y]=w[y].filter((A,M)=>M!==b),r({...l,expression_groups:w})},j=(y,b,w)=>{const A=[...l.expression_groups];A[y][b]=w,r({...l,expression_groups:A})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"all_global_jargon",checked:l.all_global_jargon??!1,onCheckedChange:y=>r({...l,all_global_jargon:y})}),e.jsx(T,{htmlFor:"all_global_jargon",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_jargon_explanation",checked:l.enable_jargon_explanation??!0,onCheckedChange:y=>r({...l,enable_jargon_explanation:y})}),e.jsx(T,{htmlFor:"enable_jargon_explanation",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"LLM"})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"jargon_mode",children:""}),e.jsxs(Pe,{value:l.jargon_mode??"context",onValueChange:y=>r({...l,jargon_mode:y}),children:[e.jsx(Be,{id:"jargon_mode",className:"mt-2",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"context",children:""}),e.jsx(ee,{value:"planner",children:"Plannerunknown_words"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["",e.jsx("br",{}),"PlannerPlannerreplyunknown_words"]})]})]}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[l.learning_list.map((y,b)=>{const w=l.learning_list.some((C,R)=>R!==b&&C[0]===""),A=y[0]==="",M=y[0].split(":"),S=M[0]||"qq",P=M[1]||"",E=M[2]||"group";return e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",b+1," ",A&&""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{rule:y}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",b+1," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>d(b),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:A?"global":"specific",onValueChange:C=>{C==="global"?m(b,0,""):m(b,0,"qq::group")},disabled:w&&!A,children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"global",children:""}),e.jsx(ee,{value:"specific",disabled:w&&!A,children:""})]})]}),w&&!A&&e.jsx("p",{className:"text-xs text-amber-600",children:""})]}),!A&&e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:S,onValueChange:C=>{m(b,0,`${C}:${P}:${E}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"qq",children:"QQ"}),e.jsx(ee,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:" ID"}),e.jsx(ne,{value:P,onChange:C=>{m(b,0,`${S}:${C.target.value}:${E}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:E,onValueChange:C=>{m(b,0,`${S}:${P}:${C}`)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"group",children:"group"}),e.jsx(ee,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",y[0]||""]})]}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:y[1]==="enable",onCheckedChange:C=>m(b,1,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:y[2]==="enable",onCheckedChange:C=>m(b,2,C?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:y[3]==="true"||y[3]==="enable",onCheckedChange:C=>m(b,3,C?"true":"false")})]})})]})]},b)}),l.learning_list.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_self_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"expression_self_reflect",checked:l.expression_self_reflect??!1,onCheckedChange:y=>r({...l,expression_self_reflect:y})})]}),l.expression_self_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_interval",children:""}),e.jsx(ne,{id:"expression_auto_check_interval",type:"number",min:"60",value:l.expression_auto_check_interval??3600,onChange:y=>r({...l,expression_auto_check_interval:parseInt(y.target.value)||3600})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"36001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"expression_auto_check_count",children:""}),e.jsx(ne,{id:"expression_auto_check_count",type:"number",min:"1",max:"100",value:l.expression_auto_check_count??10,onChange:y=>r({...l,expression_auto_check_count:parseInt(y.target.value)||10})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"10"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsxs(_,{onClick:()=>{r({...l,expression_auto_check_custom_criteria:[...l.expression_auto_check_custom_criteria||[],""]})},size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(l.expression_auto_check_custom_criteria||[]).map((y,b)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:y,onChange:w=>{const A=[...l.expression_auto_check_custom_criteria||[]];A[b]=w.target.value,r({...l,expression_auto_check_custom_criteria:A})},placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>{r({...l,expression_auto_check_custom_criteria:(l.expression_auto_check_custom_criteria||[]).filter((w,A)=>A!==b)})},size:"icon",variant:"ghost",children:e.jsx(us,{className:"h-4 w-4"})})]},b)),(!l.expression_auto_check_custom_criteria||l.expression_auto_check_custom_criteria.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:'""'})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_checked_only",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"expression_checked_only",checked:l.expression_checked_only??!1,onCheckedChange:y=>r({...l,expression_checked_only:y})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{htmlFor:"expression_manual_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"expression_manual_reflect",checked:l.expression_manual_reflect??!1,onCheckedChange:y=>r({...l,expression_manual_reflect:y})})]}),l.expression_manual_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-sm font-medium",children:""})}),e.jsx("div",{className:"space-y-4",children:(()=>{const b=(l.manual_reflect_operator_id||"").split(":"),w=b[0]||"qq",A=b[1]||"",M=b[2]||"private";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:w,onValueChange:S=>{r({...l,manual_reflect_operator_id:`${S}:${A}:${M}`})},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"qq",children:"QQ"}),e.jsx(ee,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"/ ID"}),e.jsx(ne,{value:A,onChange:S=>{r({...l,manual_reflect_operator_id:`${w}:${S.target.value}:${M}`})},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(Pe,{value:M,onValueChange:S=>{r({...l,manual_reflect_operator_id:`${w}:${A}:${S}`})},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"private",children:"private"}),e.jsx(ee,{value:"group",children:"group"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",l.manual_reflect_operator_id||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'IDplatform:id:type ( "qq:123456:private"  "qq:654321:group")'})]})})()})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>{r({...l,allow_reflect:[...l.allow_reflect||[],"qq::group"]})},size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(l.allow_reflect||[]).map((y,b)=>{const w=y.split(":"),A=w[0]||"qq",M=w[1]||"",S=w[2]||"group";return e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-muted/50",children:[e.jsxs(Pe,{value:A,onValueChange:P=>{const E=[...l.allow_reflect];E[b]=`${P}:${M}:${S}`,r({...l,allow_reflect:E})},children:[e.jsx(Be,{className:"w-24",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"qq",children:"QQ"}),e.jsx(ee,{value:"wx",children:""})]})]}),e.jsx(ne,{value:M,onChange:P=>{const E=[...l.allow_reflect];E[b]=`${A}:${P.target.value}:${S}`,r({...l,allow_reflect:E})},placeholder:"ID",className:"flex-1 font-mono text-sm"}),e.jsxs(Pe,{value:S,onValueChange:P=>{const E=[...l.allow_reflect];E[b]=`${A}:${M}:${P}`,r({...l,allow_reflect:E})},children:[e.jsx(Be,{className:"w-32",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"group",children:""}),e.jsx(ee,{value:"private",children:""})]})]}),e.jsx(_,{onClick:()=>{r({...l,allow_reflect:l.allow_reflect.filter((P,E)=>E!==b)})},size:"sm",variant:"ghost",children:e.jsx(us,{className:"h-4 w-4"})})]},b)}),(!l.allow_reflect||l.allow_reflect.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:""})]})]})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:f,size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[l.expression_groups.map((y,b)=>{const w=l.learning_list.map(A=>A[0]).filter(A=>A!=="");return e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",b+1,y.length===1&&y[0]==="*"&&""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:()=>g(b),size:"sm",variant:"outline",children:e.jsx(at,{className:"h-4 w-4"})}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",b+1," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>p(b),children:""})]})]})]})]})]}),e.jsx("div",{className:"space-y-2",children:y.map((A,M)=>e.jsx(nS,{member:A,groupIndex:b,memberIndex:M,availableChatIds:w,onUpdate:j,onRemove:N},`${b}-${M}`))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' "*" '})]},b)}),l.expression_groups.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})})]})});function iS({regex:a,reaction:l,onRegexChange:r,onReactionChange:c}){const[d,m]=u.useState(!1),[h,f]=u.useState(""),[p,g]=u.useState(null),[N,j]=u.useState(""),[y,b]=u.useState({}),[w,A]=u.useState(""),M=u.useRef(null),[S,P]=u.useState("build"),E=O=>O.replace(/\(\?P<([^>]+)>/g,"(?<$1>"),C=(O,X=0)=>{const L=M.current;if(!L)return;const me=L.selectionStart||0,Ne=L.selectionEnd||0,je=a.substring(0,me)+O+a.substring(Ne);r(je),setTimeout(()=>{const ce=me+O.length+X;L.setSelectionRange(ce,ce),L.focus()},0)};u.useEffect(()=>{if(!a||!h){p!==null&&g(null),Object.keys(y).length>0&&b({}),w!==l&&A(l),N!==""&&j("");return}try{const O=E(a),X=new RegExp(O,"g"),L=h.match(X);g(L),j("");const Ne=new RegExp(O).exec(h);if(Ne&&Ne.groups){b(Ne.groups);let je=l;Object.entries(Ne.groups).forEach(([ce,ge])=>{je=je.replace(new RegExp(`\\[${ce}\\]`,"g"),ge||"")}),A(je)}else b({}),A(l)}catch(O){j(O.message),g(null),b({}),A(l)}},[a,h,l,p,y,w,N]);const R=()=>{if(!h||!p||p.length===0)return e.jsx("span",{className:"text-muted-foreground",children:h||""});try{const O=E(a),X=new RegExp(O,"g");let L=0;const me=[];let Ne;for(;(Ne=X.exec(h))!==null;)Ne.index>L&&me.push(e.jsx("span",{children:h.substring(L,Ne.index)},`text-${L}`)),me.push(e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-900 font-semibold",children:Ne[0]},`match-${Ne.index}`)),L=Ne.index+Ne[0].length;return L<h.length&&me.push(e.jsx("span",{children:h.substring(L)},`text-${L}`)),e.jsx(e.Fragment,{children:me})}catch{return e.jsx("span",{children:h})}},H=[{category:"",items:[{label:"",pattern:".",desc:""},{label:"",pattern:"\\d",desc:" 0-9"},{label:"",pattern:"\\D",desc:""},{label:"",pattern:"\\w",desc:""},{label:"",pattern:"\\W",desc:""},{label:"",pattern:"\\s",desc:""},{label:"",pattern:"\\S",desc:""}]},{category:"",items:[{label:"",pattern:"^",desc:""},{label:"",pattern:"$",desc:""},{label:"",pattern:"\\b",desc:""}]},{category:"",items:[{label:"0",pattern:"*",desc:"0"},{label:"1",pattern:"+",desc:"1"},{label:"01",pattern:"?",desc:"01"},{label:"",pattern:"{n}",desc:"nn"},{label:"",pattern:"{m,n}",desc:"mn"}]},{category:"",items:[{label:"",pattern:"()",desc:"",moveCursor:-1},{label:"",pattern:"(?P<name>)",desc:"Python",moveCursor:-1},{label:"",pattern:"(?:)",desc:"",moveCursor:-1}]},{category:"",items:[{label:"",pattern:"[]",desc:"",moveCursor:-1},{label:"",pattern:"[^]",desc:"",moveCursor:-1},{label:"",pattern:"[a-z]",desc:"az"},{label:"",pattern:"[\\u4e00-\\u9fa5]",desc:""}]},{category:"",items:[{label:"",pattern:"(?P<word>\\S+)",desc:""},{label:"",pattern:"(?P<sentence>.+)",desc:""},{label:"",pattern:"(?P<num>\\d+)",desc:""},{label:"",pattern:"(?:1|2)",desc:""}]}];return e.jsxs(Js,{open:d,onOpenChange:m,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ix,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(qs,{className:"max-w-[95vw] sm:max-w-[900px] max-h-[90vh]",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{className:"text-sm",children:""})]}),e.jsx(ss,{className:"max-h-[calc(90vh-120px)]",children:e.jsxs(Yt,{value:S,onValueChange:O=>P(O),className:"w-full",children:[e.jsxs(Vt,{className:"grid w-full grid-cols-2",children:[e.jsx(Ye,{value:"build",children:" "}),e.jsx(Ye,{value:"test",children:" "})]}),e.jsxs(Ms,{value:"build",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ne,{ref:M,value:a,onChange:O=>r(O.target.value),className:"font-mono text-sm",placeholder:"..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(ft,{value:l,onChange:O=>c(O.target.value),placeholder:" [] ...",rows:3,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[H.map(O=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:O.category}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:O.items.map(X=>e.jsx(_,{variant:"outline",size:"sm",className:"justify-start h-auto py-2 px-3",onClick:()=>C(X.pattern,X.moveCursor||0),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("span",{className:"text-xs font-medium",children:X.label}),e.jsx("code",{className:"ml-auto text-xs bg-muted px-1.5 py-0.5 rounded font-mono",children:X.pattern})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:X.desc})]})},X.label))})]},O.category)),e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("^(?P<n>\\S{1,20})$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:["^(?P<n>\\S","{1,20}",")$"]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>r("(?P<subject>.+?)(?:||)"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?P<subject>.+?)(?:||)"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})})]})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsxs("li",{children:["",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"(?P<>)"})]}),e.jsxs("li",{children:[" reaction  ",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"[]"})," "]}),e.jsx("li",{children:""})]})]})]}),e.jsxs(Ms,{value:"test",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:a||"()"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"test-text",className:"text-sm font-medium",children:""}),e.jsx(ft,{id:"test-text",value:h,onChange:O=>f(O.target.value),placeholder:`...
`,className:"min-h-[100px] text-sm"})]}),N&&e.jsxs("div",{className:"rounded-md bg-destructive/10 border border-destructive/20 p-3",children:[e.jsx("p",{className:"text-sm text-destructive font-medium",children:""}),e.jsx("p",{className:"text-xs text-destructive/80 mt-1",children:N})]}),!N&&h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:p&&p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[" (",p.length," )"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:""})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ss,{className:"h-40 rounded-md bg-muted p-3",children:e.jsx("div",{className:"text-sm break-words",children:R()})})]}),Object.keys(y).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx(ss,{className:"h-32 rounded-md border p-3",children:e.jsx("div",{className:"space-y-2",children:Object.entries(y).map(([O,X])=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsxs("span",{className:"font-mono font-semibold text-primary min-w-[80px]",children:["[",O,"]"]}),e.jsx("span",{className:"text-muted-foreground",children:"="}),e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded",children:X})]},O))})})]}),Object.keys(y).length>0&&l&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(ss,{className:"h-48 rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3",children:e.jsx("div",{className:"text-sm break-words",children:w})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"reaction  [name] "})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:"Reaction "}),e.jsx("li",{children:""})]})]})]})]})})]})]})}const cS=Hs.memo(function({keywordReactionConfig:l,responsePostProcessConfig:r,chineseTypoConfig:c,responseSplitterConfig:d,onKeywordReactionChange:m,onResponsePostProcessChange:h,onChineseTypoChange:f,onResponseSplitterChange:p}){const g=()=>{m({...l,regex_rules:[...l.regex_rules,{regex:[""],reaction:""}]})},N=C=>{m({...l,regex_rules:l.regex_rules.filter((R,H)=>H!==C)})},j=(C,R,H)=>{const O=[...l.regex_rules];R==="regex"&&typeof H=="string"?O[C]={...O[C],regex:[H]}:R==="reaction"&&typeof H=="string"&&(O[C]={...O[C],reaction:H}),m({...l,regex_rules:O})},y=()=>{m({...l,keyword_rules:[...l.keyword_rules,{keywords:[],reaction:""}]})},b=C=>{m({...l,keyword_rules:l.keyword_rules.filter((R,H)=>H!==C)})},w=(C,R,H)=>{const O=[...l.keyword_rules];typeof H=="string"&&(O[C]={...O[C],reaction:H}),m({...l,keyword_rules:O})},A=C=>{const R=[...l.keyword_rules];R[C]={...R[C],keywords:[...R[C].keywords||[],""]},m({...l,keyword_rules:R})},M=(C,R)=>{const H=[...l.keyword_rules];H[C]={...H[C],keywords:(H[C].keywords||[]).filter((O,X)=>X!==R)},m({...l,keyword_rules:H})},S=(C,R,H)=>{const O=[...l.keyword_rules],X=[...O[C].keywords||[]];X[R]=H,O[C]={...O[C],keywords:X},m({...l,keyword_rules:O})},P=({rule:C})=>{const R=`{ regex = [${(C.regex||[]).map(H=>`"${H}"`).join(", ")}], reaction = "${C.reaction}" }`;return e.jsxs(hl,{children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ma,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(nl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(ss,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs break-all",children:R})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},E=({rule:C})=>{const R=`[[keyword_reaction.keyword_rules]]
keywords = [${(C.keywords||[]).map(H=>`"${H}"`).join(", ")}]
reaction = "${C.reaction}"`;return e.jsxs(hl,{children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ma,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(nl,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(ss,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-all",children:R})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:g,size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[l.regex_rules.map((C,R)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",R+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(iS,{regex:C.regex&&C.regex[0]||"",reaction:C.reaction,onRegexChange:H=>j(R,"regex",H),onReactionChange:H=>j(R,"reaction",H)}),e.jsx(P,{rule:C}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",R+1," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>N(R),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:"Python "}),e.jsx(ne,{value:C.regex&&C.regex[0]||"",onChange:H=>j(R,"regex",H.target.value),placeholder:"^(?P<n>\\\\S{1,20})$ ",className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' (?P<name>pattern) reaction  [name] ""'})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(ft,{value:C.reaction,onChange:H=>j(R,"reaction",H.target.value),placeholder:`...
 [] `,rows:3,className:"text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" []  [n] "})]})]})]},R)),l.regex_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:y,size:"sm",variant:"outline",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[l.keyword_rules.map((C,R)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",R+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{rule:C}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",R+1," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>b(R),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsxs(_,{onClick:()=>A(R),size:"sm",variant:"ghost",children:[e.jsx(at,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(C.keywords||[]).map((H,O)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{value:H,onChange:X=>S(R,O,X.target.value),placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>M(R,O),size:"sm",variant:"ghost",children:e.jsx(us,{className:"h-4 w-4"})})]},O)),(!C.keywords||C.keywords.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-2",children:'""'})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-xs font-medium",children:""}),e.jsx(ft,{value:C.reaction,onChange:H=>w(R,"reaction",H.target.value),placeholder:"...",rows:3,className:"text-sm"})]})]})]},R)),l.keyword_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_response_post_process",checked:r.enable_response_post_process,onCheckedChange:C=>h({...r,enable_response_post_process:C})}),e.jsx(T,{htmlFor:"enable_response_post_process",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),r.enable_response_post_process&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ge,{id:"enable_chinese_typo",checked:c.enable,onCheckedChange:C=>f({...c,enable:C})}),e.jsx(T,{htmlFor:"enable_chinese_typo",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),c.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"error_rate",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"error_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.error_rate,onChange:C=>f({...c,error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"min_freq",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"min_freq",type:"number",min:"0",value:c.min_freq,onChange:C=>f({...c,min_freq:parseInt(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"tone_error_rate",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"tone_error_rate",type:"number",step:"0.01",min:"0",max:"1",value:c.tone_error_rate,onChange:C=>f({...c,tone_error_rate:parseFloat(C.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"word_replace_rate",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"word_replace_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.word_replace_rate,onChange:C=>f({...c,word_replace_rate:parseFloat(C.target.value)})})]})]})]})}),e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ge,{id:"enable_response_splitter",checked:d.enable,onCheckedChange:C=>p({...d,enable:C})}),e.jsx(T,{htmlFor:"enable_response_splitter",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),d.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_length",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"max_length",type:"number",min:"1",value:d.max_length,onChange:C=>p({...d,max_length:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_sentence_num",className:"text-xs font-medium",children:""}),e.jsx(ne,{id:"max_sentence_num",type:"number",min:"1",value:d.max_sentence_num,onChange:C=>p({...d,max_sentence_num:parseInt(C.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_kaomoji_protection",checked:d.enable_kaomoji_protection,onCheckedChange:C=>p({...d,enable_kaomoji_protection:C})}),e.jsx(T,{htmlFor:"enable_kaomoji_protection",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"enable_overflow_return_all",checked:d.enable_overflow_return_all,onCheckedChange:C=>p({...d,enable_overflow_return_all:C})}),e.jsx(T,{htmlFor:"enable_overflow_return_all",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})})]})]})]})});function oS({config:a,onChange:l}){const[r,c]=u.useState(""),[d,m]=u.useState(""),h=()=>{const y=r.trim();y&&!a.ban_words.includes(y)&&(l({...a,ban_words:[...a.ban_words,y]}),c(""))},f=y=>{l({...a,ban_words:a.ban_words.filter((b,w)=>w!==y)})},p=y=>{y.key==="Enter"&&(y.preventDefault(),h())},g=()=>{const y=d.trim();if(y&&!a.ban_msgs_regex.includes(y))try{new RegExp(y),l({...a,ban_msgs_regex:[...a.ban_msgs_regex,y]}),m("")}catch(b){alert(`${b.message}`)}},N=y=>{l({...a,ban_msgs_regex:a.ban_msgs_regex.filter((b,w)=>w!==y)})},j=y=>{y.key==="Enter"&&(y.preventDefault(),g())};return e.jsx("div",{className:"space-y-6",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:e.jsxs(Yt,{defaultValue:"ban_words",className:"w-full",children:[e.jsxs(Vt,{className:"grid w-full grid-cols-2",children:[e.jsx(Ye,{value:"ban_words",children:""}),e.jsx(Ye,{value:"ban_regex",children:""})]}),e.jsx(Ms,{value:"ban_words",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(qt,{className:"h-4 w-4 text-yellow-500 mt-1 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bot "})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{placeholder:"",value:r,onChange:y=>c(y.target.value),onKeyDown:p}),e.jsx(_,{onClick:h,size:"icon",children:e.jsx(at,{className:"h-4 w-4"})})]}),a.ban_words.length===0?e.jsx("div",{className:"rounded-md border border-dashed p-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}):e.jsx("div",{className:"space-y-2",children:a.ban_words.map((y,b)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsx("code",{className:"text-sm",children:y}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",children:e.jsx(us,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",e.jsxs("code",{children:['"',y,'"']})," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>f(b),children:""})]})]})]})]},b))})]})}),e.jsx(Ms,{value:"ban_regex",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(qt,{className:"h-4 w-4 text-yellow-500 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("p",{children:""}),e.jsx("p",{className:"text-xs",children:" "})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ft,{placeholder:`
https?://[^\\s]+ `,value:d,onChange:y=>m(y.target.value),onKeyDown:j,className:"min-h-[60px] font-mono text-sm"}),e.jsx(_,{onClick:g,size:"icon",children:e.jsx(at,{className:"h-4 w-4"})})]}),a.ban_msgs_regex.length===0?e.jsx("div",{className:"rounded-md border border-dashed p-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}):e.jsx("div",{className:"space-y-2",children:a.ban_msgs_regex.map((y,b)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsx("code",{className:"text-sm font-mono flex-1 break-all",children:y}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",className:"ml-2 flex-shrink-0",children:e.jsx(us,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",e.jsxs("code",{children:['"',y,'"']})," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>N(b),children:""})]})]})]})]},b))})]})})]})})]})})}const dS=Hs.memo(function({config:l,onChange:r}){const[c,d]=u.useState(""),[m,h]=u.useState(""),[f,p]=u.useState(!1),g=l.allowed_ips?l.allowed_ips.split(",").map(S=>S.trim()).filter(S=>S):[],N=l.trusted_proxies?l.trusted_proxies.split(",").map(S=>S.trim()).filter(S=>S):[],j=()=>{if(!c.trim())return;const S=[...g,c.trim()];r({...l,allowed_ips:S.join(",")}),d("")},y=S=>{const P=g.filter((E,C)=>C!==S);r({...l,allowed_ips:P.join(",")})},b=()=>{if(!m.trim())return;const S=[...N,m.trim()];r({...l,trusted_proxies:S.join(",")}),h("")},w=S=>{const P=N.filter((E,C)=>C!==S);r({...l,trusted_proxies:P.join(",")})},A=S=>{!S&&l.enabled?p(!0):r({...l,enabled:S})},M=()=>{r({...l,enabled:!1}),p(!1)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"WebUI "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.enabled,onCheckedChange:A}),e.jsx(T,{className:"cursor-pointer",children:" WebUI"})]}),l.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.mode,onValueChange:S=>r({...l,mode:S}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"development",children:""}),e.jsx(ee,{value:"production",children:""})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": WebUI  .env  WEBUI_HOST  WEBUI_PORT"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:l.anti_crawler_mode,onValueChange:S=>r({...l,anti_crawler_mode:S}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"false",children:""}),e.jsx(ee,{value:"basic",children:""}),e.jsx(ee,{value:"loose",children:""}),e.jsx(ee,{value:"strict",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:"IP "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:c,onChange:S=>d(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),j())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:j,disabled:!c.trim(),children:e.jsx(at,{className:"h-4 w-4"})})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:g.map((S,P)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>y(P),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(_a,{className:"h-3 w-3"})})]},P))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPCIDR127.0.0.1192.168.1.0/24"})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(T,{children:" IP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:m,onChange:S=>h(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),b())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:b,disabled:!m.trim(),children:e.jsx(at,{className:"h-4 w-4"})})]}),N.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:N.map((S,P)=>e.jsxs(ke,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>w(P),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(_a,{className:"h-3 w-3"})})]},P))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPX-Forwarded-For"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.trust_xff,onCheckedChange:S=>r({...l,trust_xff:S})}),e.jsx(T,{className:"cursor-pointer",children:" X-Forwarded-For "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{checked:l.secure_cookie,onCheckedChange:S=>r({...l,secure_cookie:S})}),e.jsx(T,{className:"cursor-pointer",children:" Cookie HTTPS"})]})]})]}),e.jsx(Cs,{open:f,onOpenChange:p,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:" WebUI"}),e.jsxs(Ns,{children:[" WebUI WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{variant:"destructive",onClick:M,children:""})]})]})})]})}),Sn="/api/webui/config";async function $g(){const l=await(await Se(`${Sn}/bot`)).json();if(!l.success)throw new Error("");return l.config}async function pn(){const l=await(await Se(`${Sn}/model`)).json();if(!l.success)throw new Error("");return l.config}async function Bg(a){const r=await(await Se(`${Sn}/bot`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function uS(){const l=await(await Se(`${Sn}/bot/raw`)).json();if(!l.success)throw new Error("");return l.content}async function mS(a){const r=await(await Se(`${Sn}/bot/raw`,{method:"POST",body:JSON.stringify({raw_content:a})})).json();if(!r.success)throw new Error(r.message||"")}async function tc(a){const r=await(await Se(`${Sn}/model`,{method:"POST",body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.message||"")}async function xS(a,l){const c=await(await Se(`${Sn}/bot/section/${a}`,{method:"POST",body:JSON.stringify(l)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function Xm(a,l){const c=await(await Se(`${Sn}/model/section/${a}`,{method:"POST",body:JSON.stringify(l)})).json();if(!c.success)throw new Error(c.message||` ${a} `)}async function hS(a,l="openai",r="/models"){const c=new URLSearchParams({provider_name:a,parser:l,endpoint:r}),d=await Se(`/api/webui/models/list?${c}`);if(!d.ok){const h=await d.json().catch(()=>({}));throw new Error(h.detail||` (${d.status})`)}const m=await d.json();if(!m.success)throw new Error("");return m.models}async function fS(a){const l=new URLSearchParams({provider_name:a}),r=await Se(`/api/webui/models/test-connection-by-name?${l}`,{method:"POST"});if(!r.ok){const c=await r.json().catch(()=>({}));throw new Error(c.detail||` (${r.status})`)}return await r.json()}const pS=ei("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),pt=u.forwardRef(({className:a,variant:l,...r},c)=>e.jsx("div",{ref:c,role:"alert",className:F(pS({variant:l}),a),...r}));pt.displayName="Alert";const Qn=u.forwardRef(({className:a,...l},r)=>e.jsx("h5",{ref:r,className:F("mb-1 font-medium leading-none tracking-tight",a),...l}));Qn.displayName="AlertTitle";const gt=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{ref:r,className:F("text-sm [&_p]:leading-relaxed",a),...l}));gt.displayName="AlertDescription";const gS={name:"toml",startState:function(){return{inString:!1,stringType:"",lhs:!0,inArray:0}},token:function(a,l){let r;if(!l.inString&&(r=a.match(/^('''|"""|'|")/))&&(l.stringType=r[0],l.inString=!0),a.sol()&&!l.inString&&l.inArray===0&&(l.lhs=!0),l.inString){for(;l.inString;)if(a.match(l.stringType))l.inString=!1;else if(a.peek()==="\\")a.next(),a.next();else{if(a.eol())break;a.match(/^.[^\\\"\']*/)}return l.lhs?"property":"string"}else{if(l.inArray&&a.peek()==="]")return a.next(),l.inArray--,"bracket";if(l.lhs&&a.peek()==="["&&a.skipTo("]"))return a.next(),a.peek()==="]"&&a.next(),"atom";if(a.peek()==="#")return a.skipToEnd(),"comment";if(a.eatSpace())return null;if(l.lhs&&a.eatWhile(function(c){return c!="="&&c!=" "}))return"property";if(l.lhs&&a.peek()==="=")return a.next(),l.lhs=!1,null;if(!l.lhs&&a.match(/^\d\d\d\d[\d\-\:\.T]*Z/))return"atom";if(!l.lhs&&(a.match("true")||a.match("false")))return"atom";if(!l.lhs&&a.peek()==="[")return l.inArray++,a.next(),"bracket";if(!l.lhs&&a.match(/^\-?\d+(?:\.\d+)?/))return"number";a.eatSpace()||a.next()}return null},languageData:{commentTokens:{line:"#"}}},jS={python:[l_()],json:[n_(),r_()],toml:[a_.define(gS)],text:[]};function Vv({value:a,onChange:l,language:r="text",readOnly:c=!1,height:d="400px",minHeight:m,maxHeight:h,placeholder:f,theme:p="dark",className:g=""}){const[N,j]=u.useState(!1);if(u.useEffect(()=>{j(!0)},[]),!N)return e.jsx("div",{className:`rounded-md border bg-muted animate-pulse ${g}`,style:{height:d,minHeight:m,maxHeight:h}});const y=[...jS[r]||[],Am.lineWrapping,Am.theme({"&":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-content":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-gutters":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'},".cm-scroller":{fontFamily:'"JetBrains Mono", "Fira Code", "Consolas", "Monaco", monospace'}})];return c&&y.push(Am.editable.of(!1)),e.jsx("div",{className:`rounded-md overflow-hidden border custom-scrollbar ${g}`,children:e.jsx(i_,{value:a,height:d,minHeight:m,maxHeight:h,theme:p==="dark"?c_:void 0,extensions:y,onChange:l,placeholder:f,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightSpecialChars:!0,history:!0,foldGutter:!0,drawSelection:!0,dropCursor:!0,allowMultipleSelections:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:!0,crosshairCursor:!0,highlightActiveLine:!0,highlightSelectionMatches:!0,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:!0,historyKeymap:!0,foldKeymap:!0,completionKeymap:!0,lintKeymap:!0}})})}function vS({id:a,index:l,itemType:r,itemFields:c,value:d,onChange:m,onRemove:h,disabled:f,canRemove:p,placeholder:g}){const{attributes:N,listeners:j,setNodeRef:y,transform:b,transition:w,isDragging:A}=_v({id:a,disabled:f}),M={transform:Sv.Transform.toString(b),transition:w};return e.jsxs("div",{ref:y,style:M,className:F("flex items-start gap-2 group",A&&"opacity-50 z-50"),children:[e.jsx("button",{type:"button",className:F("flex-shrink-0 p-2 cursor-grab active:cursor-grabbing","text-muted-foreground hover:text-foreground transition-colors","opacity-0 group-hover:opacity-100 focus:opacity-100",f&&"cursor-not-allowed opacity-30"),...N,...j,children:e.jsx(rv,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1 min-w-0",children:r==="object"&&c?e.jsx(NS,{value:d,onChange:m,fields:c,disabled:f}):r==="number"?e.jsx(ne,{type:"number",value:d??"",onChange:S=>m(parseFloat(S.target.value)||0),placeholder:g??` ${l+1} `,disabled:f,className:"font-mono"}):e.jsx(ne,{type:"text",value:d??"",onChange:S=>m(S.target.value),placeholder:g??` ${l+1} `,disabled:f})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:h,disabled:f||!p,className:F("flex-shrink-0 text-muted-foreground hover:text-destructive","opacity-0 group-hover:opacity-100 focus:opacity-100 transition-opacity"),children:e.jsx(us,{className:"h-4 w-4"})})]})}function NS({value:a,onChange:l,fields:r,disabled:c}){const d=u.useCallback((h,f)=>{l({...a,[h]:f})},[a,l]),m=(h,f)=>{const p=a?.[h];if(f.type==="boolean"||f.type==="switch")return e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(Ge,{checked:!!(p??f.default),onCheckedChange:g=>d(h,g),disabled:c})]});if(f.type==="slider"||f.type==="number"&&f.min!=null&&f.max!=null){const g=p??f.default??f.min??0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g})]}),e.jsx(Wa,{value:[g],onValueChange:N=>d(h,N[0]),min:f.min??0,max:f.max??100,step:f.step??1,disabled:c,className:"py-1"})]})}return f.type==="select"&&f.choices?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsxs(Pe,{value:String(p??f.default??""),onValueChange:g=>d(h,g),disabled:c,children:[e.jsx(Be,{className:"h-8 text-sm",children:e.jsx(Fe,{placeholder:f.placeholder??""})}),e.jsx(Ie,{children:f.choices.map(g=>e.jsx(ee,{value:String(g),children:String(g)},String(g)))})]})]}):f.type==="number"?e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ne,{type:"number",value:p??f.default??"",onChange:g=>d(h,parseFloat(g.target.value)||0),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(ne,{type:"text",value:p??f.default??"",onChange:g=>d(h,g.target.value),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]})};return e.jsx(Ce,{className:"p-3 space-y-2 bg-muted/30",children:Object.entries(r).map(([h,f])=>e.jsx("div",{children:m(h,f)},h))})}function bS({value:a,onChange:l,itemType:r="string",itemFields:c,minItems:d,maxItems:m,disabled:h,placeholder:f}){const p=u.useMemo(()=>Array.isArray(a)?a:typeof a=="string"&&a.trim()?a.split(",").map(E=>E.trim()):[],[a]),[g]=u.useState(()=>new Map),N=u.useCallback(E=>(g.has(E)||g.set(E,`item-${Date.now()}-${E}-${Math.random().toString(36).slice(2)}`),g.get(E)),[g]),j=u.useMemo(()=>{const E=[];for(let C=0;C<p.length;C++)E.push(N(C));return E},[p.length,N]),y=pv(Go(vv,{activationConstraint:{distance:8}}),Go(jv,{coordinateGetter:gv})),b=u.useCallback(E=>{const{active:C,over:R}=E;if(R&&C.id!==R.id){const H=j.indexOf(C.id),O=j.indexOf(R.id),X=Nv(p,H,O);l(X)}},[p,j,l]),w=u.useCallback(()=>{if(m!=null&&p.length>=m)return;let E;r==="object"&&c?E=Object.fromEntries(Object.entries(c).map(([C,R])=>[C,R.default??""])):r==="number"?E=0:E="",l([...p,E])},[p,m,r,c,l]),A=u.useCallback((E,C)=>{const R=[...p];R[E]=C,l(R)},[p,l]),M=u.useCallback(E=>{if(d!=null&&p.length<=d)return;const C=p.filter((R,H)=>H!==E);g.delete(E),l(C)},[p,d,g,l]),S=m==null||p.length<m,P=d==null||p.length>d;return e.jsxs("div",{className:"space-y-2",children:[p.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-4 justify-center border border-dashed rounded-md",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}):e.jsx(bv,{sensors:y,collisionDetection:yv,onDragEnd:b,children:e.jsx(wv,{items:j,strategy:o_,children:e.jsx("div",{className:"space-y-2",children:p.map((E,C)=>e.jsx(vS,{id:j[C],index:C,itemType:r,itemFields:c,value:E,onChange:R=>A(C,R),onRemove:()=>M(C),disabled:h,canRemove:P,placeholder:f},j[C]))})})}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:w,disabled:h||!S,className:"w-full",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),"",m!==void 0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",p.length,"/",m,")"]})]}),(d!=null||m!=null)&&(d!==null||m!==null)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:d!=null&&m!=null?` ${d} - ${m} `:d!=null?` ${d} `:` ${m} `})]})}function gx({content:a,className:l=""}){return e.jsx("div",{className:`prose prose-sm dark:prose-invert max-w-none ${l}`,children:e.jsx(f_,{remarkPlugins:[g_,j_],rehypePlugins:[p_],components:{code({inline:r,className:c,children:d,...m}){return r?e.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded text-sm font-mono",...m,children:d}):e.jsx("code",{className:`${c} block bg-muted p-4 rounded-lg overflow-x-auto`,...m,children:d})},table({children:r,...c}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"border-collapse border border-border",...c,children:r})})},th({children:r,...c}){return e.jsx("th",{className:"border border-border bg-muted px-4 py-2 text-left font-semibold",...c,children:r})},td({children:r,...c}){return e.jsx("td",{className:"border border-border px-4 py-2",...c,children:r})},a({children:r,...c}){return e.jsx("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...c,children:r})},blockquote({children:r,...c}){return e.jsx("blockquote",{className:"border-l-4 border-primary pl-4 italic text-muted-foreground",...c,children:r})},h1({children:r,...c}){return e.jsx("h1",{className:"text-3xl font-bold mt-6 mb-4",...c,children:r})},h2({children:r,...c}){return e.jsx("h2",{className:"text-2xl font-bold mt-5 mb-3",...c,children:r})},h3({children:r,...c}){return e.jsx("h3",{className:"text-xl font-bold mt-4 mb-2",...c,children:r})},h4({children:r,...c}){return e.jsx("h4",{className:"text-lg font-semibold mt-3 mb-2",...c,children:r})},ul({children:r,...c}){return e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",...c,children:r})},ol({children:r,...c}){return e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",...c,children:r})},p({children:r,...c}){return e.jsx("p",{className:"my-2 leading-relaxed",...c,children:r})},hr({...r}){return e.jsx("hr",{className:"my-4 border-border",...r})}},children:a})})}function yS(a,l){let r=a.slice(0,l).split(/\r\n|\n|\r/g);return[r.length,r.pop().length+1]}function wS(a,l,r){let c=a.split(/\r\n|\n|\r/g),d="",m=(Math.log10(l+1)|0)+1;for(let h=l-1;h<=l+1;h++){let f=c[h-1];f&&(d+=h.toString().padEnd(m," "),d+=":  ",d+=f,d+=`
`,h===l&&(d+=" ".repeat(m+r+2),d+=`^
`))}return d}class Os extends Error{line;column;codeblock;constructor(l,r){const[c,d]=yS(r.toml,r.ptr),m=wS(r.toml,c,d);super(`Invalid TOML document: ${l}

${m}`,r),this.line=c,this.column=d,this.codeblock=m}}function _S(a,l){let r=0;for(;a[l-++r]==="\\";);return--r&&r%2}function Yo(a,l=0,r=a.length){let c=a.indexOf(`
`,l);return a[c-1]==="\r"&&c--,c<=r?c:-1}function jx(a,l){for(let r=l;r<a.length;r++){let c=a[r];if(c===`
`)return r;if(c==="\r"&&a[r+1]===`
`)return r+1;if(c<" "&&c!=="	"||c==="")throw new Os("control characters are not allowed in comments",{toml:a,ptr:l})}return a.length}function Ul(a,l,r,c){let d;for(;(d=a[l])===" "||d==="	"||!r&&(d===`
`||d==="\r"&&a[l+1]===`
`);)l++;return c||d!=="#"?l:Ul(a,jx(a,l),r)}function Ig(a,l,r,c,d=!1){if(!c)return l=Yo(a,l),l<0?a.length:l;for(let m=l;m<a.length;m++){let h=a[m];if(h==="#")m=Yo(a,m);else{if(h===r)return m+1;if(h===c||d&&(h===`
`||h==="\r"&&a[m+1]===`
`))return m}}throw new Os("cannot find end of structure",{toml:a,ptr:l})}function Gv(a,l){let r=a[l],c=r===a[l+1]&&a[l+1]===a[l+2]?a.slice(l,l+3):r;l+=c.length-1;do l=a.indexOf(c,++l);while(l>-1&&r!=="'"&&_S(a,l));return l>-1&&(l+=c.length,c.length>1&&(a[l]===r&&l++,a[l]===r&&l++)),l}let SS=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i;class Qr extends Date{#s=!1;#t=!1;#e=null;constructor(l){let r=!0,c=!0,d="Z";if(typeof l=="string"){let m=l.match(SS);m?(m[1]||(r=!1,l=`0000-01-01T${l}`),c=!!m[2],c&&l[10]===" "&&(l=l.replace(" ","T")),m[2]&&+m[2]>23?l="":(d=m[3]||null,l=l.toUpperCase(),!d&&c&&(l+="Z"))):l=""}super(l),isNaN(this.getTime())||(this.#s=r,this.#t=c,this.#e=d)}isDateTime(){return this.#s&&this.#t}isLocal(){return!this.#s||!this.#t||!this.#e}isDate(){return this.#s&&!this.#t}isTime(){return this.#t&&!this.#s}isValid(){return this.#s||this.#t}toISOString(){let l=super.toISOString();if(this.isDate())return l.slice(0,10);if(this.isTime())return l.slice(11,23);if(this.#e===null)return l.slice(0,-1);if(this.#e==="Z")return l;let r=+this.#e.slice(1,3)*60+ +this.#e.slice(4,6);return r=this.#e[0]==="-"?r:-r,new Date(this.getTime()-r*6e4).toISOString().slice(0,-1)+this.#e}static wrapAsOffsetDateTime(l,r="Z"){let c=new Qr(l);return c.#e=r,c}static wrapAsLocalDateTime(l){let r=new Qr(l);return r.#e=null,r}static wrapAsLocalDate(l){let r=new Qr(l);return r.#t=!1,r.#e=null,r}static wrapAsLocalTime(l){let r=new Qr(l);return r.#s=!1,r.#e=null,r}}let kS=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,CS=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,TS=/^[+-]?0[0-9_]/,ES=/^[0-9a-f]{4,8}$/i,Pg={b:"\b",t:"	",n:`
`,f:"\f",r:"\r",'"':'"',"\\":"\\"};function Kv(a,l=0,r=a.length){let c=a[l]==="'",d=a[l++]===a[l]&&a[l]===a[l+1];d&&(r-=2,a[l+=2]==="\r"&&l++,a[l]===`
`&&l++);let m=0,h,f="",p=l;for(;l<r-1;){let g=a[l++];if(g===`
`||g==="\r"&&a[l]===`
`){if(!d)throw new Os("newlines are not allowed in strings",{toml:a,ptr:l-1})}else if(g<" "&&g!=="	"||g==="")throw new Os("control characters are not allowed in strings",{toml:a,ptr:l-1});if(h){if(h=!1,g==="u"||g==="U"){let N=a.slice(l,l+=g==="u"?4:8);if(!ES.test(N))throw new Os("invalid unicode escape",{toml:a,ptr:m});try{f+=String.fromCodePoint(parseInt(N,16))}catch{throw new Os("invalid unicode escape",{toml:a,ptr:m})}}else if(d&&(g===`
`||g===" "||g==="	"||g==="\r")){if(l=Ul(a,l-1,!0),a[l]!==`
`&&a[l]!=="\r")throw new Os("invalid escape: only line-ending whitespace may be escaped",{toml:a,ptr:m});l=Ul(a,l)}else if(g in Pg)f+=Pg[g];else throw new Os("unrecognized escape sequence",{toml:a,ptr:m});p=l}else!c&&g==="\\"&&(m=l-1,h=!0,f+=a.slice(p,m))}return f+a.slice(p,r-1)}function MS(a,l,r,c){if(a==="true")return!0;if(a==="false")return!1;if(a==="-inf")return-1/0;if(a==="inf"||a==="+inf")return 1/0;if(a==="nan"||a==="+nan"||a==="-nan")return NaN;if(a==="-0")return c?0n:0;let d=kS.test(a);if(d||CS.test(a)){if(TS.test(a))throw new Os("leading zeroes are not allowed",{toml:l,ptr:r});a=a.replace(/_/g,"");let h=+a;if(isNaN(h))throw new Os("invalid number",{toml:l,ptr:r});if(d){if((d=!Number.isSafeInteger(h))&&!c)throw new Os("integer value cannot be represented losslessly",{toml:l,ptr:r});(d||c===!0)&&(h=BigInt(a))}return h}const m=new Qr(a);if(!m.isValid())throw new Os("invalid value",{toml:l,ptr:r});return m}function AS(a,l,r,c){let d=a.slice(l,r),m=d.indexOf("#");m>-1&&(jx(a,m),d=d.slice(0,m));let h=d.trimEnd();if(!c){let f=d.indexOf(`
`,h.length);if(f>-1)throw new Os("newlines are not allowed in inline tables",{toml:a,ptr:l+f})}return[h,m]}function vx(a,l,r,c,d){if(c===0)throw new Os("document contains excessively nested structures. aborting.",{toml:a,ptr:l});let m=a[l];if(m==="["||m==="{"){let[p,g]=m==="["?DS(a,l,c,d):RS(a,l,c,d),N=r?Ig(a,g,",",r):g;if(g-N&&r==="}"){let j=Yo(a,g,N);if(j>-1)throw new Os("newlines are not allowed in inline tables",{toml:a,ptr:j})}return[p,N]}let h;if(m==='"'||m==="'"){h=Gv(a,l);let p=Kv(a,l,h);if(r){if(h=Ul(a,h,r!=="]"),a[h]&&a[h]!==","&&a[h]!==r&&a[h]!==`
`&&a[h]!=="\r")throw new Os("unexpected character encountered",{toml:a,ptr:h});h+=+(a[h]===",")}return[p,h]}h=Ig(a,l,",",r);let f=AS(a,l,h-+(a[h-1]===","),r==="]");if(!f[0])throw new Os("incomplete key-value declaration: no value specified",{toml:a,ptr:l});return r&&f[1]>-1&&(h=Ul(a,l+f[1]),h+=+(a[h]===",")),[MS(f[0],a,l,d),h]}let zS=/^[a-zA-Z0-9-_]+[ \t]*$/;function Zm(a,l,r="="){let c=l-1,d=[],m=a.indexOf(r,l);if(m<0)throw new Os("incomplete key-value: cannot find end of key",{toml:a,ptr:l});do{let h=a[l=++c];if(h!==" "&&h!=="	")if(h==='"'||h==="'"){if(h===a[l+1]&&h===a[l+2])throw new Os("multiline strings are not allowed in keys",{toml:a,ptr:l});let f=Gv(a,l);if(f<0)throw new Os("unfinished string encountered",{toml:a,ptr:l});c=a.indexOf(".",f);let p=a.slice(f,c<0||c>m?m:c),g=Yo(p);if(g>-1)throw new Os("newlines are not allowed in keys",{toml:a,ptr:l+c+g});if(p.trimStart())throw new Os("found extra tokens after the string part",{toml:a,ptr:f});if(m<f&&(m=a.indexOf(r,f),m<0))throw new Os("incomplete key-value: cannot find end of key",{toml:a,ptr:l});d.push(Kv(a,l,f))}else{c=a.indexOf(".",l);let f=a.slice(l,c<0||c>m?m:c);if(!zS.test(f))throw new Os("only letter, numbers, dashes and underscores are allowed in keys",{toml:a,ptr:l});d.push(f.trimEnd())}}while(c+1&&c<m);return[d,Ul(a,m+1,!0,!0)]}function RS(a,l,r,c){let d={},m=new Set,h,f=0;for(l++;(h=a[l++])!=="}"&&h;){let p={toml:a,ptr:l-1};if(h===`
`)throw new Os("newlines are not allowed in inline tables",p);if(h==="#")throw new Os("inline tables cannot contain comments",p);if(h===",")throw new Os("expected key-value, found comma",p);if(h!==" "&&h!=="	"){let g,N=d,j=!1,[y,b]=Zm(a,l-1);for(let M=0;M<y.length;M++){if(M&&(N=j?N[g]:N[g]={}),g=y[M],(j=Object.hasOwn(N,g))&&(typeof N[g]!="object"||m.has(N[g])))throw new Os("trying to redefine an already defined value",{toml:a,ptr:l});!j&&g==="__proto__"&&Object.defineProperty(N,g,{enumerable:!0,configurable:!0,writable:!0})}if(j)throw new Os("trying to redefine an already defined value",{toml:a,ptr:l});let[w,A]=vx(a,b,"}",r-1,c);m.add(w),N[g]=w,l=A,f=a[l-1]===","?l-1:0}}if(f)throw new Os("trailing commas are not allowed in inline tables",{toml:a,ptr:f});if(!h)throw new Os("unfinished table encountered",{toml:a,ptr:l});return[d,l]}function DS(a,l,r,c){let d=[],m;for(l++;(m=a[l++])!=="]"&&m;){if(m===",")throw new Os("expected value, found comma",{toml:a,ptr:l-1});if(m==="#")l=jx(a,l);else if(m!==" "&&m!=="	"&&m!==`
`&&m!=="\r"){let h=vx(a,l-1,"]",r-1,c);d.push(h[0]),l=h[1]}}if(!m)throw new Os("unfinished array encountered",{toml:a,ptr:l});return[d,l]}function Fg(a,l,r,c){let d=l,m=r,h,f=!1,p;for(let g=0;g<a.length;g++){if(g){if(d=f?d[h]:d[h]={},m=(p=m[h]).c,c===0&&(p.t===1||p.t===2))return null;if(p.t===2){let N=d.length-1;d=d[N],m=m[N].c}}if(h=a[g],(f=Object.hasOwn(d,h))&&m[h]?.t===0&&m[h]?.d)return null;f||(h==="__proto__"&&(Object.defineProperty(d,h,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(m,h,{enumerable:!0,configurable:!0,writable:!0})),m[h]={t:g<a.length-1&&c===2?3:c,d:!1,i:0,c:{}})}if(p=m[h],p.t!==c&&!(c===1&&p.t===3)||(c===2&&(p.d||(p.d=!0,d[h]=[]),d[h].push(d={}),p.c[p.i++]=p={t:1,d:!1,i:0,c:{}}),p.d))return null;if(p.d=!0,c===1)d=f?d[h]:d[h]={};else if(c===0&&f)return null;return[h,d,p.c]}function Nx(a,{maxDepth:l=1e3,integersAsBigInt:r}={}){let c={},d={},m=c,h=d;for(let f=Ul(a,0);f<a.length;){if(a[f]==="["){let p=a[++f]==="[",g=Zm(a,f+=+p,"]");if(p){if(a[g[1]-1]!=="]")throw new Os("expected end of table declaration",{toml:a,ptr:g[1]-1});g[1]++}let N=Fg(g[0],c,d,p?2:1);if(!N)throw new Os("trying to redefine an already defined table or value",{toml:a,ptr:f});h=N[2],m=N[1],f=g[1]}else{let p=Zm(a,f),g=Fg(p[0],m,h,0);if(!g)throw new Os("trying to redefine an already defined table or value",{toml:a,ptr:f});let N=vx(a,p[1],void 0,l,r);g[1][g[0]]=N[0],f=N[1]}if(f=Ul(a,f,!0),a[f]&&a[f]!==`
`&&a[f]!=="\r")throw new Os("each key-value declaration must be followed by an end-of-line",{toml:a,ptr:f});f=Ul(a,f)}return c}let Qv=/^[a-z0-9-_]+$/i;function gc(a){let l=typeof a;if(l==="object"){if(Array.isArray(a))return"array";if(a instanceof Date)return"date"}return l}function OS(a){for(let l=0;l<a.length;l++)if(gc(a[l])!=="object")return!1;return a.length!=0}function bx(a){return JSON.stringify(a).replace(/\x7f/g,"\\u007f")}function yx(a,l,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");if(l==="number")return isNaN(a)?"nan":a===1/0?"inf":a===-1/0?"-inf":c&&Number.isInteger(a)?a.toFixed(1):a.toString();if(l==="bigint"||l==="boolean")return a.toString();if(l==="string")return bx(a);if(l==="date"){if(isNaN(a.getTime()))throw new TypeError("cannot serialize invalid date");return a.toISOString()}if(l==="object")return LS(a,r,c);if(l==="array")return US(a,r,c)}function LS(a,l,r){let c=Object.keys(a);if(c.length===0)return"{}";let d="{ ";for(let m=0;m<c.length;m++){let h=c[m];m&&(d+=", "),d+=Qv.test(h)?h:bx(h),d+=" = ",d+=yx(a[h],gc(a[h]),l-1,r)}return d+" }"}function US(a,l,r){if(a.length===0)return"[]";let c="[ ";for(let d=0;d<a.length;d++){if(d&&(c+=", "),a[d]===null||a[d]===void 0)throw new TypeError("arrays cannot contain null or undefined values");c+=yx(a[d],gc(a[d]),l-1,r)}return c+" ]"}function $S(a,l,r,c){if(r===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let d="";for(let m=0;m<a.length;m++)d+=`${d&&`
`}[[${l}]]
`,d+=wx(0,a[m],l,r,c);return d}function wx(a,l,r,c,d){if(c===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let m="",h="",f=Object.keys(l);for(let p=0;p<f.length;p++){let g=f[p];if(l[g]!==null&&l[g]!==void 0){let N=gc(l[g]);if(N==="symbol"||N==="function")throw new TypeError(`cannot serialize values of type '${N}'`);let j=Qv.test(g)?g:bx(g);if(N==="array"&&OS(l[g]))h+=(h&&`
`)+$S(l[g],r?`${r}.${j}`:j,c-1,d);else if(N==="object"){let y=r?`${r}.${j}`:j;h+=(h&&`
`)+wx(y,l[g],y,c-1,d)}else m+=j,m+=" = ",m+=yx(l[g],N,c,d),m+=`
`}}return a&&(m||!h)&&(m=m?`[${a}]
${m}`:`[${a}]`),m&&h?`${m}
${h}`:m||h}function BS(a,{maxDepth:l=1e3,numbersAsFloat:r=!1}={}){if(gc(a)!=="object")throw new TypeError("stringify can only be called with an object");let c=wx(0,a,"",l,r);return c[c.length-1]!==`
`?c+`
`:c}function IS(a,l,r,c={}){const{debounceMs:d=2e3,onSaveSuccess:m,onSaveError:h}=c,f=u.useRef(null),p=u.useCallback(async(y,b)=>{try{l(!0),await xS(y,b),r(!1),m?.()}catch(w){console.error(` ${y} :`,w),r(!0),h?.(w instanceof Error?w:new Error(String(w)))}finally{l(!1)}},[l,r,m,h]),g=u.useCallback((y,b)=>{a||(r(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(y,b)},d))},[a,r,p,d]),N=u.useCallback(async(y,b)=>{f.current&&(clearTimeout(f.current),f.current=null),await p(y,b)},[p]),j=u.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);return u.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),{triggerAutoSave:g,saveNow:N,cancelPendingAutoSave:j}}function Ht(a,l,r,c){u.useEffect(()=>{a&&!r&&c(l,a)},[a])}const PS=500;function FS(){return e.jsx(tr,{children:e.jsx(HS,{})})}function HS(){const[a,l]=u.useState(!0),[r,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(!1),[p,g]=u.useState("visual"),[N,j]=u.useState(""),[y,b]=u.useState(!1),[w,A]=u.useState(""),{toast:M}=it(),{triggerRestart:S,isRestarting:P}=_n(),[E,C]=u.useState(null),[R,H]=u.useState(null),[O,X]=u.useState(null),[L,me]=u.useState(null),[Ne,je]=u.useState(null),[ce,ge]=u.useState(null),[pe,D]=u.useState(null),[K,B]=u.useState(null),[ue,Q]=u.useState(null),[_e,he]=u.useState(null),[Te,V]=u.useState(null),[$,z]=u.useState(null),[G,Re]=u.useState(null),[se,Oe]=u.useState(null),[ns,J]=u.useState(null),[Z,Le]=u.useState(null),[ae,Ee]=u.useState(null),[de,ze]=u.useState(null),[ws,Zs]=u.useState(null),[St,fa]=u.useState(null),xs=u.useRef(!0),Is=u.useRef({}),Y=$e=>{const ms=$e.split(`
`);let os=ms[0];os=os.replace(/^Error:\s*/,"");const rs=[[/Invalid TOML document: unrecognized escape sequence/,"TOML  \\\\ "],[/Invalid TOML document: only letter, numbers, dashes and underscores are allowed in keys/,"TOML "],[/Invalid TOML document: (.+)/,"TOML $1"],[/Unexpected character.*at line (\d+), column (\d+)/," $1  $2 "],[/Expected.*at line (\d+), column (\d+)/," $1  $2 "],[/Invalid.*at line (\d+), column (\d+)/," $1  $2 "],[/Unterminated string at line (\d+)/," $1 "],[/Duplicate key.*at line (\d+)/," $1 "],[/Invalid escape sequence at line (\d+)/," $1  \\\\ "],[/Expected.*but got.*at line (\d+)/," $1 "],[/line (\d+), column (\d+)/," $1  $2 "],[/Unexpected end of input/,""],[/Unexpected token/,""],[/Invalid number/,""],[/Invalid date/,""],[/Invalid boolean/," true  false"],[/Unexpected character/,""],[/unrecognized escape sequence/,""]];for(const[ht,Tt]of rs)if(ht.test(os)){os=os.replace(ht,Tt);break}return ms.length>1?(ms[0]=os,ms.join(`
`)):os},qe=u.useCallback($e=>{Is.current=$e,C($e.bot),H($e.personality);const ms=$e.chat;ms.talk_value_rules||(ms.talk_value_rules=[]),X(ms),me($e.expression),je($e.emoji),ge($e.memory),D($e.tool),B($e.voice),Q($e.message_receive),he($e.dream),V($e.lpmm_knowledge),z($e.keyword_reaction),Re($e.response_post_process),Oe($e.chinese_typo),J($e.response_splitter),Le($e.log),Ee($e.debug),ze($e.maim_message),Zs($e.telemetry),fa($e.webui)},[]),Ke=u.useCallback(()=>({...Is.current,bot:E,personality:R,chat:O,expression:L,emoji:Ne,memory:ce,tool:pe,voice:K,message_receive:ue,dream:_e,lpmm_knowledge:Te,keyword_reaction:$,response_post_process:G,chinese_typo:se,response_splitter:ns,log:Z,debug:ae,maim_message:de,telemetry:ws,webui:St}),[E,R,O,L,Ne,ce,pe,K,ue,_e,Te,$,G,se,ns,Z,ae,de,ws,St]),Ze=u.useCallback(async()=>{try{const ms=(await uS()).replace(/"([^"]*)"/g,(os,rs)=>`"${rs.replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\"/g,'"').replace(/\\\\/g,"\\")}"`);j(ms),b(!1)}catch($e){M({variant:"destructive",title:"",description:$e instanceof Error?$e.message:""})}},[M]),Ts=u.useCallback(async()=>{try{l(!0);const $e=await $g();qe($e),f(!1),xs.current=!1,await Ze()}catch($e){console.error(":",$e),M({title:"",description:"",variant:"destructive"})}finally{l(!1)}},[M,Ze,qe]);u.useEffect(()=>{Ts()},[Ts]);const{triggerAutoSave:He,cancelPendingAutoSave:zs}=IS(xs.current,m,f);Ht(E,"bot",xs.current,He),Ht(R,"personality",xs.current,He),Ht(O,"chat",xs.current,He),Ht(L,"expression",xs.current,He),Ht(Ne,"emoji",xs.current,He),Ht(ce,"memory",xs.current,He),Ht(pe,"tool",xs.current,He),Ht(K,"voice",xs.current,He),Ht(_e,"dream",xs.current,He),Ht(Te,"lpmm_knowledge",xs.current,He),Ht($,"keyword_reaction",xs.current,He),Ht(G,"response_post_process",xs.current,He),Ht(se,"chinese_typo",xs.current,He),Ht(ns,"response_splitter",xs.current,He),Ht(Z,"log",xs.current,He),Ht(ae,"debug",xs.current,He),Ht(de,"maim_message",xs.current,He),Ht(ws,"telemetry",xs.current,He),Ht(St,"webui",xs.current,He);const Ls=async()=>{try{c(!0);try{Nx(N)}catch(ms){const os=ms instanceof Error?ms.message:"TOML ",rs=Y(os);b(!0),A(rs),M({variant:"destructive",title:"TOML ",description:rs}),c(!1);return}const $e=N.replace(/"([^"]*)"/g,(ms,os)=>`"${os.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}"`);await mS($e),f(!1),b(!1),A(""),M({title:"",description:""}),await Ts()}catch($e){b(!0);const ms=$e instanceof Error?$e.message:"";A(ms),M({variant:"destructive",title:"",description:ms})}finally{c(!1)}},Ks=async $e=>{if(h){M({variant:"destructive",title:"",description:""});return}if(g($e),$e==="source")await Ze();else try{const ms=await $g();qe(ms),f(!1)}catch(ms){console.error(":",ms),M({title:"",description:"",variant:"destructive"})}},cs=async()=>{try{c(!0),zs(),await Bg(Ke()),f(!1),M({title:"",description:""})}catch($e){console.error(":",$e),M({title:"",description:$e.message,variant:"destructive"})}finally{c(!1)}},ts=async()=>{await S()},_s=async()=>{try{c(!0),zs(),await Bg(Ke()),f(!1),M({title:"",description:"..."}),await new Promise($e=>setTimeout($e,PS)),await ts()}catch($e){console.error(":",$e),M({title:"",description:$e.message,variant:"destructive"})}finally{c(!1)}};return a?e.jsx(ss,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs sm:text-sm",children:""})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(_,{onClick:p==="visual"?cs:Ls,disabled:r||d||!h||P,size:"sm",variant:"outline",className:"w-20 sm:w-24",children:[e.jsx(fc,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:r?"":d?"":h?"":""})]}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{disabled:r||d||P,size:"sm",className:"w-20 sm:w-28",children:[e.jsx(hc,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:P?"":h?"":""})]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:h?",":","})})})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:h?_s:ts,children:h?"":""})]})]})]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(Yt,{value:p,onValueChange:$e=>Ks($e),className:"w-full",children:e.jsxs(Vt,{className:"h-8 sm:h-9 w-full grid grid-cols-2",children:[e.jsxs(Ye,{value:"visual",className:"text-xs sm:text-sm",children:[e.jsx(iv,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]}),e.jsxs(Ye,{value:"source",className:"text-xs sm:text-sm",children:[e.jsx(cv,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]})]})})})]}),e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""}),'""']})]}),p==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsxs(gt,{children:[e.jsx("strong",{children:""})," TOML  TOML ",y&&w&&e.jsxs("div",{className:"text-destructive font-semibold mt-3 p-3 bg-destructive/10 rounded-md",children:[e.jsx("div",{className:"font-bold mb-2",children:" TOML "}),e.jsx("pre",{className:"text-sm font-mono whitespace-pre-wrap break-words",children:w})]})]})]}),e.jsx(Vv,{value:N,onChange:$e=>{j($e),f(!0),y&&(b(!1),A(""))},language:"toml",theme:"dark",height:"calc(100vh - 280px)",minHeight:"500px",placeholder:"TOML "})]}),p==="visual"&&e.jsx(e.Fragment,{children:e.jsxs(Yt,{defaultValue:"bot",className:"w-full",children:[e.jsxs(Vt,{className:"flex flex-wrap h-auto gap-1 p-1 sm:grid sm:grid-cols-5 lg:grid-cols-10",children:[e.jsx(Ye,{value:"bot",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"personality",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"chat",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"expression",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"features",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"processing",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"dream",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"lpmm",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"webui",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:"WebUI"}),e.jsx(Ye,{value:"other",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""})]}),e.jsx(Ms,{value:"bot",className:"space-y-4",children:E&&e.jsx(K2,{config:E,onChange:C})}),e.jsx(Ms,{value:"personality",className:"space-y-4",children:R&&e.jsx(Q2,{config:R,onChange:H})}),e.jsx(Ms,{value:"chat",className:"space-y-4",children:O&&e.jsx(X2,{config:O,onChange:X})}),e.jsx(Ms,{value:"expression",className:"space-y-4",children:L&&e.jsx(rS,{config:L,onChange:me})}),e.jsx(Ms,{value:"features",className:"space-y-4",children:Ne&&ce&&pe&&K&&e.jsx(lS,{emojiConfig:Ne,memoryConfig:ce,toolConfig:pe,voiceConfig:K,onEmojiChange:je,onMemoryChange:ge,onToolChange:D,onVoiceChange:B})}),e.jsxs(Ms,{value:"processing",className:"space-y-4",children:[$&&G&&se&&ns&&e.jsx(cS,{keywordReactionConfig:$,responsePostProcessConfig:G,chineseTypoConfig:se,responseSplitterConfig:ns,onKeywordReactionChange:z,onResponsePostProcessChange:Re,onChineseTypoChange:Oe,onResponseSplitterChange:J}),ue&&e.jsx(oS,{config:ue,onChange:Q})]}),e.jsx(Ms,{value:"dream",className:"space-y-4",children:_e&&e.jsx(Z2,{config:_e,onChange:he})}),e.jsx(Ms,{value:"lpmm",className:"space-y-4",children:Te&&e.jsx(W2,{config:Te,onChange:V})}),e.jsx(Ms,{value:"webui",className:"space-y-4",children:St&&e.jsx(dS,{config:St,onChange:fa})}),e.jsxs(Ms,{value:"other",className:"space-y-4",children:[Z&&e.jsx(eS,{config:Z,onChange:Le}),ae&&e.jsx(sS,{config:ae,onChange:Ee}),de&&e.jsx(tS,{config:de,onChange:ze}),ws&&e.jsx(aS,{config:ws,onChange:Zs})]})]})}),e.jsx(ar,{})]})})}const Il=u.forwardRef(({className:a,...l},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:F("w-full caption-bottom text-sm",a),...l})}));Il.displayName="Table";const Pl=u.forwardRef(({className:a,...l},r)=>e.jsx("thead",{ref:r,className:F("[&_tr]:border-b",a),...l}));Pl.displayName="TableHeader";const Fl=u.forwardRef(({className:a,...l},r)=>e.jsx("tbody",{ref:r,className:F("[&_tr:last-child]:border-0",a),...l}));Fl.displayName="TableBody";const qS=u.forwardRef(({className:a,...l},r)=>e.jsx("tfoot",{ref:r,className:F("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...l}));qS.displayName="TableFooter";const bt=u.forwardRef(({className:a,...l},r)=>e.jsx("tr",{ref:r,className:F("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...l}));bt.displayName="TableRow";const ls=u.forwardRef(({className:a,...l},r)=>e.jsx("th",{ref:r,className:F("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...l}));ls.displayName="TableHead";const Je=u.forwardRef(({className:a,...l},r)=>e.jsx("td",{ref:r,className:F("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...l}));Je.displayName="TableCell";const VS=u.forwardRef(({className:a,...l},r)=>e.jsx("caption",{ref:r,className:F("mt-4 text-sm text-muted-foreground",a),...l}));VS.displayName="TableCaption";const dd=u.forwardRef(({className:a,...l},r)=>e.jsx(Sa,{ref:r,className:F("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...l}));dd.displayName=Sa.displayName;const ud=u.forwardRef(({className:a,...l},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Ut,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(Sa.Input,{ref:r,className:F("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...l})]}));ud.displayName=Sa.Input.displayName;const md=u.forwardRef(({className:a,...l},r)=>e.jsx(Sa.List,{ref:r,className:F("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...l}));md.displayName=Sa.List.displayName;const xd=u.forwardRef((a,l)=>e.jsx(Sa.Empty,{ref:l,className:"py-6 text-center text-sm",...a}));xd.displayName=Sa.Empty.displayName;const oc=u.forwardRef(({className:a,...l},r)=>e.jsx(Sa.Group,{ref:r,className:F("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...l}));oc.displayName=Sa.Group.displayName;const GS=u.forwardRef(({className:a,...l},r)=>e.jsx(Sa.Separator,{ref:r,className:F("-mx-1 h-px bg-border",a),...l}));GS.displayName=Sa.Separator.displayName;const dc=u.forwardRef(({className:a,...l},r)=>e.jsx(Sa.Item,{ref:r,className:F("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...l}));dc.displayName=Sa.Item.displayName;const Yv=u.createContext(null),Jv="maibot-completed-tours";function KS(){try{const a=localStorage.getItem(Jv);return a?new Set(JSON.parse(a)):new Set}catch{return new Set}}function Hg(a){localStorage.setItem(Jv,JSON.stringify([...a]))}function QS({children:a}){const[l,r]=u.useState({activeTourId:null,stepIndex:0,isRunning:!1}),[c]=u.useState(()=>new Map),[d,m]=u.useState(KS),[,h]=u.useState(0),f=u.useCallback((E,C)=>{c.set(E,C),h(R=>R+1)},[c]),p=u.useCallback(E=>{c.delete(E),r(C=>C.activeTourId===E?{...C,activeTourId:null,isRunning:!1,stepIndex:0}:C)},[c]),g=u.useCallback((E,C=0)=>{c.has(E)&&r({activeTourId:E,stepIndex:C,isRunning:!0})},[c]),N=u.useCallback(()=>{r(E=>({...E,isRunning:!1}))},[]),j=u.useCallback(E=>{r(C=>({...C,stepIndex:E}))},[]),y=u.useCallback(()=>{r(E=>({...E,stepIndex:E.stepIndex+1}))},[]),b=u.useCallback(()=>{r(E=>({...E,stepIndex:Math.max(0,E.stepIndex-1)}))},[]),w=u.useCallback(()=>l.activeTourId?c.get(l.activeTourId)||[]:[],[l.activeTourId,c]),A=u.useCallback(E=>{m(C=>{const R=new Set(C);return R.add(E),Hg(R),R})},[]),M=u.useCallback(E=>{const{action:C,index:R,status:H,type:O}=E,X=["finished","skipped"];if(C==="close"){r(L=>({...L,isRunning:!1,stepIndex:0}));return}X.includes(H)?r(L=>(H==="finished"&&L.activeTourId&&setTimeout(()=>A(L.activeTourId),0),{...L,isRunning:!1,stepIndex:0})):O==="step:after"&&(C==="next"?r(L=>({...L,stepIndex:R+1})):C==="prev"&&r(L=>({...L,stepIndex:R-1})))},[A]),S=u.useCallback(E=>d.has(E),[d]),P=u.useCallback(E=>{m(C=>{const R=new Set(C);return R.delete(E),Hg(R),R})},[]);return e.jsx(Yv.Provider,{value:{state:l,tours:c,registerTour:f,unregisterTour:p,startTour:g,stopTour:N,goToStep:j,nextStep:y,prevStep:b,getCurrentSteps:w,handleJoyrideCallback:M,isTourCompleted:S,markTourCompleted:A,resetTourCompleted:P},children:a})}function _x(){const a=u.useContext(Yv);if(!a)throw new Error("useTour must be used within a TourProvider");return a}const YS={options:{zIndex:1e4,primaryColor:"hsl(var(--primary))",textColor:"hsl(var(--foreground))",backgroundColor:"hsl(var(--background))",arrowColor:"hsl(var(--background))",overlayColor:"rgba(0, 0, 0, 0.5)"},tooltip:{borderRadius:"var(--radius)",padding:"1rem"},tooltipContainer:{textAlign:"left"},tooltipTitle:{fontSize:"1rem",fontWeight:600,marginBottom:"0.5rem"},tooltipContent:{fontSize:"0.875rem",padding:"0.5rem 0"},buttonNext:{backgroundColor:"hsl(var(--primary))",color:"hsl(var(--primary-foreground))",borderRadius:"calc(var(--radius) - 2px)",fontSize:"0.875rem",padding:"0.5rem 1rem"},buttonBack:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem",marginRight:"0.5rem"},buttonSkip:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem"},buttonClose:{color:"hsl(var(--muted-foreground))"},spotlight:{borderRadius:"var(--radius)"}},JS={back:"",close:"",last:"",next:"",nextLabelWithProgress:" ({step}/{steps})",open:"",skip:""};function XS(){const{state:a,getCurrentSteps:l,handleJoyrideCallback:r}=_x(),c=l(),[d,m]=u.useState(!1),h=u.useRef(a.stepIndex),f=u.useRef(null);u.useEffect(()=>{h.current!==a.stepIndex&&(m(!1),h.current=a.stepIndex)},[a.stepIndex]),u.useEffect(()=>{if(!a.isRunning||c.length===0){m(!1);return}const j=c[a.stepIndex];if(!j){m(!1);return}const y=j.target;if(y==="body"){m(!0);return}m(!1);const b=setTimeout(()=>{const w=()=>{const P=document.querySelector(y);if(P){const E=P.getBoundingClientRect();if(E.width>0&&E.height>0)return!0}return!1};if(w()){setTimeout(()=>m(!0),100);return}const A=setInterval(()=>{w()&&(clearInterval(A),setTimeout(()=>m(!0),100))},100),M=setTimeout(()=>{clearInterval(A),m(!0)},5e3),S=()=>{clearInterval(A),clearTimeout(M)};f.current=S},150);return()=>{clearTimeout(b),f.current&&(f.current(),f.current=null)}},[a.isRunning,a.stepIndex,c]);const[p,g]=u.useState(null);if(u.useEffect(()=>{let j=document.getElementById("tour-portal-container");return j||(j=document.createElement("div"),j.id="tour-portal-container",j.style.cssText="position: fixed; top: 0; left: 0; z-index: 99999; pointer-events: none;",document.body.appendChild(j)),g(j),()=>{}},[]),!a.isRunning||c.length===0||!d)return null;const N=e.jsx(u_,{steps:c,stepIndex:a.stepIndex,run:a.isRunning,continuous:!0,showSkipButton:!0,showProgress:!0,disableOverlayClose:!0,disableScrolling:!1,disableScrollParentFix:!1,callback:r,styles:YS,locale:JS,scrollOffset:80,scrollToFirstStep:!0,floaterProps:{styles:{floater:{zIndex:99999}},disableAnimation:!0}},`tour-step-${a.stepIndex}`);return p?X0.createPortal(N,p):N}const ml="model-assignment-tour",Xv=[{target:"body",content:"",placement:"center",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="sidebar-model-provider"]',content:' DeepSeek Siliconflow""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-provider-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="provider-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-apikey-input"]',content:" API  API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-url-input"]',content:" API API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-template-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="sidebar-model-management"]',content:'""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-model-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="model-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-provider-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-identifier-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="tasks-tab-trigger"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="task-model-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1}],Zv={0:"/config/model",1:"/config/model",2:"/config/modelProvider",3:"/config/modelProvider",4:"/config/modelProvider",5:"/config/modelProvider",6:"/config/modelProvider",7:"/config/modelProvider",8:"/config/modelProvider",9:"/config/modelProvider",10:"/config/modelProvider",11:"/config/model",12:"/config/model",13:"/config/model",14:"/config/model",15:"/config/model",16:"/config/model",17:"/config/model",18:"/config/model",19:"/config/model"},Xi=[{id:"siliconflow",name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",client_type:"openai",display_name:" (SiliconFlow)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"deepseek",name:"DeepSeek",base_url:"https://api.deepseek.com",client_type:"openai",display_name:"DeepSeek",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"rinkoai",name:"RinkoAI",base_url:"https://rinkoai.com/v1",client_type:"openai",display_name:"RinkoAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"zhipu",name:"ZhipuAI",base_url:"https://open.bigmodel.cn/api/paas/v4",client_type:"openai",display_name:" AI (ZhipuAI / GLM)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"moonshot",name:"Moonshot",base_url:"https://api.moonshot.cn/v1",client_type:"openai",display_name:" (Moonshot / Kimi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"doubao",name:"Doubao",base_url:"https://ark.cn-beijing.volces.com/api/v3",client_type:"openai",display_name:" (Doubao)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"alibaba",name:"Alibaba",base_url:"https://dashscope.aliyuncs.com/compatible-mode/v1",client_type:"openai",display_name:" (Alibaba Qwen)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"baichuan",name:"Baichuan",base_url:"https://api.baichuan-ai.com/v1",client_type:"openai",display_name:" (Baichuan)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"minimax",name:"MiniMax",base_url:"https://api.minimax.chat/v1",client_type:"openai",display_name:"MiniMax ( AI)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"stepfun",name:"StepFun",base_url:"https://api.stepfun.com/v1",client_type:"openai",display_name:" (StepFun)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"lingyi",name:"Lingyi",base_url:"https://api.lingyiwanwu.com/v1",client_type:"openai",display_name:" (Lingyi / Yi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"openai",name:"OpenAI",base_url:"https://api.openai.com/v1",client_type:"openai",display_name:"OpenAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"xai",name:"xAI",base_url:"https://api.x.ai/v1",client_type:"openai",display_name:"xAI (Grok)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"anthropic",name:"Anthropic",base_url:"https://api.anthropic.com/v1",client_type:"openai",display_name:"Anthropic (Claude)"},{id:"gemini",name:"Gemini",base_url:"https://generativelanguage.googleapis.com/v1beta",client_type:"gemini",display_name:"Google Gemini",modelFetcher:{endpoint:"/models",parser:"gemini"}},{id:"cohere",name:"Cohere",base_url:"https://api.cohere.ai/v1",client_type:"openai",display_name:"Cohere"},{id:"groq",name:"Groq",base_url:"https://api.groq.com/openai/v1",client_type:"openai",display_name:"Groq",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"together",name:"Together AI",base_url:"https://api.together.xyz/v1",client_type:"openai",display_name:"Together AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"fireworks",name:"Fireworks",base_url:"https://api.fireworks.ai/inference/v1",client_type:"openai",display_name:"Fireworks AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"mistral",name:"Mistral",base_url:"https://api.mistral.ai/v1",client_type:"openai",display_name:"Mistral AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"perplexity",name:"Perplexity",base_url:"https://api.perplexity.ai",client_type:"openai",display_name:"Perplexity AI"},{id:"custom",name:"",base_url:"",client_type:"openai",display_name:""}];function qg(a){return a?a.replace(/\/+$/,"").toLowerCase():""}function ZS(a){if(!a)return null;const l=qg(a);return Xi.find(r=>r.id!=="custom"&&qg(r.base_url)===l)||null}const Do=a=>({...a,max_retry:a.max_retry??2,timeout:a.timeout??30,retry_interval:a.retry_interval??10}),WS=(a,l=[],r=null)=>{const c={};return a?(a.name?.trim()?l.some((m,h)=>r!==null&&h===r?!1:m.name.trim().toLowerCase()===a.name.trim().toLowerCase())&&(c.name=""):c.name="",a.base_url?.trim()||(c.base_url=" URL"),a.api_key?.trim()||(c.api_key=" API Key"),{isValid:Object.keys(c).length===0,errors:c}):{isValid:!1,errors:{name:""}}};function e4(){return e.jsx(tr,{children:e.jsx(s4,{})})}function s4(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(!1),[h,f]=u.useState(!1),[p,g]=u.useState(!1),[N,j]=u.useState(!1),[y,b]=u.useState(null),[w,A]=u.useState(null),[M,S]=u.useState("custom"),[P,E]=u.useState(!1),[C,R]=u.useState(!1),[H,O]=u.useState(null),[X,L]=u.useState(!1),[me,Ne]=u.useState(""),[je,ce]=u.useState(new Set),[ge,pe]=u.useState(!1),[D,K]=u.useState(1),[B,ue]=u.useState(20),[Q,_e]=u.useState(""),[he,Te]=u.useState({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),[V,$]=u.useState({}),[z,G]=u.useState(new Set),[Re,se]=u.useState(new Map),{toast:Oe}=it(),ns=xa(),{state:J,goToStep:Z,registerTour:Le}=_x(),{triggerRestart:ae,isRestarting:Ee}=_n(),de=u.useRef(null),ze=u.useRef(!0);u.useEffect(()=>{Le(ml,Xv)},[Le]),u.useEffect(()=>{if(J.activeTourId===ml&&J.isRunning){const te=Zv[J.stepIndex];te&&!window.location.pathname.endsWith(te.replace("/config/",""))&&ns({to:te})}},[J.stepIndex,J.activeTourId,J.isRunning,ns]);const ws=u.useRef(J.stepIndex);u.useEffect(()=>{if(J.activeTourId===ml&&J.isRunning){const te=ws.current,ye=J.stepIndex;te>=3&&te<=9&&ye<3&&j(!1),te>=10&&ye>=3&&ye<=9&&($({}),S("custom"),b({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10}),A(null),L(!1),j(!0)),ws.current=ye}},[J.stepIndex,J.activeTourId,J.isRunning]),u.useEffect(()=>{if(J.activeTourId!==ml||!J.isRunning)return;const te=ye=>{const U=ye.target,Me=J.stepIndex;Me===2&&U.closest('[data-tour="add-provider-button"]')?setTimeout(()=>Z(3),300):Me===9&&U.closest('[data-tour="provider-cancel-button"]')&&setTimeout(()=>Z(10),300)};return document.addEventListener("click",te,!0),()=>document.removeEventListener("click",te,!0)},[J,Z]),u.useEffect(()=>{Zs()},[]);const Zs=async()=>{try{c(!0);const te=await pn();l(te.api_providers||[]),g(!1),ze.current=!1}catch(te){console.error(":",te)}finally{c(!1)}},St=async()=>{await ae()},fa=async()=>{try{m(!0),de.current&&clearTimeout(de.current);const te=a.map(is=>({...is,max_retry:is.max_retry??2,timeout:is.timeout??30,retry_interval:is.retry_interval??10})),{shouldProceed:ye}=await xs(te,"restart");if(!ye){m(!1);return}const U=await pn(),Me=new Set(te.map(is=>is.name)),ds=(U.models||[]).filter(is=>Me.has(is.api_provider));U.api_providers=te,U.models=ds,await tc(U),g(!1),Oe({title:"",description:"..."}),await St()}catch(te){console.error(":",te),Oe({title:"",description:te.message,variant:"destructive"}),m(!1)}},xs=u.useCallback(async(te,ye="auto")=>{try{const U=await pn(),Me=new Set(a.map(Ps=>Ps.name)),Xe=new Set(te.map(Ps=>Ps.name)),ds=Array.from(Me).filter(Ps=>!Xe.has(Ps));if(ds.length===0)return{shouldProceed:!0,providers:te};const kt=(U.models||[]).filter(Ps=>ds.includes(Ps.api_provider));return kt.length===0?{shouldProceed:!0,providers:te}:(Te({isOpen:!0,providersToDelete:ds,affectedModels:kt,pendingProviders:te,context:ye,oldProviders:[...a]}),{shouldProceed:!1,providers:te})}catch(U){return console.error(":",U),{shouldProceed:!0,providers:te}}},[a]),Is=async()=>{try{(he.context==="auto"?f:m)(!0),Te(Ps=>({...Ps,isOpen:!1}));const ye=await pn(),U=he.pendingProviders.map(Do),Me=new Set(U.map(Ps=>Ps.name)),ds=(ye.models||[]).filter(Ps=>Me.has(Ps.api_provider)),is=new Set(he.affectedModels.map(Ps=>Ps.name)),kt=ye.model_task_config;kt&&Object.keys(kt).forEach(Ps=>{const le=kt[Ps];le&&Array.isArray(le.model_list)&&(le.model_list=le.model_list.filter(fe=>!is.has(fe)))}),ye.api_providers=U,ye.models=ds,ye.model_task_config=kt,await tc(ye),l(he.pendingProviders),g(!1),Oe({title:"",description:` ${he.providersToDelete.length}  ${he.affectedModels.length} `}),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),ce(new Set),he.context==="restart"&&await St()}catch(te){console.error(":",te),Oe({title:"",description:te.message,variant:"destructive"})}finally{he.context==="auto"?f(!1):m(!1)}},Y=()=>{he.oldProviders.length>0&&l(he.oldProviders),Te({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),g(!1)},qe=u.useCallback(async te=>{if(ze.current)return;const{shouldProceed:ye}=await xs(te,"auto");if(!ye){g(!0);return}try{f(!0);const U=te.map(Do);await Xm("api_providers",U),g(!1)}catch(U){console.error(":",U),Oe({title:"",description:U.message,variant:"destructive"}),g(!0)}finally{f(!1)}},[a,xs]);u.useEffect(()=>{if(!ze.current)return g(!0),de.current&&clearTimeout(de.current),de.current=setTimeout(()=>{qe(a)},2e3),()=>{de.current&&clearTimeout(de.current)}},[a,qe]);const Ke=async()=>{try{m(!0),de.current&&clearTimeout(de.current);const te=a.map(Do),{shouldProceed:ye}=await xs(te,"manual");if(!ye){m(!1);return}const U=await pn(),Me=new Set(te.map(is=>is.name)),Xe=U.models||[],ds=Xe.filter(is=>{const kt=Me.has(is.api_provider);return kt||console.warn(` "${is.name}"  "${is.api_provider}"`),kt});if(Xe.length!==ds.length){const is=Xe.length-ds.length;Oe({title:"",description:` ${is} `,variant:"default"})}console.log(" providers :",te),U.api_providers=te,U.models=ds,console.log(":",U),await tc(U),g(!1),Oe({title:"",description:""})}catch(te){console.error(":",te),Oe({title:"",description:te.message,variant:"destructive"})}finally{m(!1)}},Ze=(te,ye)=>{if($({}),te){const U=Xi.find(Me=>Me.base_url===te.base_url&&Me.client_type===te.client_type);S(U?.id||"custom"),b(te)}else S("custom"),b({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10});A(ye),L(!1),j(!0)},Ts=u.useCallback(te=>{S(te),E(!1);const ye=Xi.find(U=>U.id===te);ye&&ye.id!=="custom"?b(U=>({...U,name:ye.name,base_url:ye.base_url,client_type:ye.client_type})):ye?.id==="custom"&&b(U=>({...U,name:"",base_url:"",client_type:"openai"}))},[]),He=u.useMemo(()=>M!=="custom",[M]),zs=u.useCallback(async()=>{if(y?.api_key)try{await navigator.clipboard.writeText(y.api_key),Oe({title:"",description:"API Key "})}catch{Oe({title:"",description:"",variant:"destructive"})}},[y?.api_key,Oe]),Ls=()=>{if(!y)return;const{isValid:te,errors:ye}=WS(y,a,w);if(!te){$(ye);return}$({});const U=Do(y);if(w!==null){const Me=[...a];Me[w]=U,l(Me)}else l([...a,U]);j(!1),b(null),A(null)},Ks=te=>{if(!te&&y){const ye={...y,max_retry:y.max_retry??2,timeout:y.timeout??30,retry_interval:y.retry_interval??10};b(ye)}j(te)},cs=te=>{O(te),R(!0)},ts=async()=>{if(H!==null){const te=a.filter((U,Me)=>Me!==H),{shouldProceed:ye}=await xs(te,"manual");ye&&(l(te),Oe({title:"",description:""}))}R(!1),O(null)},_s=te=>{const ye=new Set(je);ye.has(te)?ye.delete(te):ye.add(te),ce(ye)},$e=()=>{if(je.size===rs.length)ce(new Set);else{const te=rs.map((ye,U)=>a.findIndex(Me=>Me===rs[U]));ce(new Set(te))}},ms=()=>{if(je.size===0){Oe({title:"",description:"",variant:"default"});return}pe(!0)},os=async()=>{const te=a.filter((U,Me)=>!je.has(Me)),{shouldProceed:ye}=await xs(te,"manual");ye&&(l(te),ce(new Set),Oe({title:"",description:` ${je.size} `})),pe(!1)},rs=u.useMemo(()=>{if(!me)return a;const te=me.toLowerCase();return a.filter(ye=>ye.name.toLowerCase().includes(te)||ye.base_url.toLowerCase().includes(te)||ye.client_type.toLowerCase().includes(te))},[a,me]),{totalPages:ht,paginatedProviders:Tt}=u.useMemo(()=>{const te=Math.ceil(rs.length/B),ye=rs.slice((D-1)*B,D*B);return{totalPages:te,paginatedProviders:ye}},[rs,D,B]),ca=u.useCallback(()=>{const te=parseInt(Q);te>=1&&te<=ht&&(K(te),_e(""))},[Q,ht]),ka=async te=>{G(ye=>new Set(ye).add(te));try{const ye=await fS(te);se(U=>new Map(U).set(te,ye)),ye.network_ok?ye.api_key_valid===!0?Oe({title:"",description:`${te} API Key  (${ye.latency_ms}ms)`}):ye.api_key_valid===!1?Oe({title:" Key ",description:`${te}  API Key `,variant:"destructive"}):Oe({title:"",description:`${te}  (${ye.latency_ms}ms)`}):Oe({title:"",description:ye.error||"",variant:"destructive"})}catch(ye){Oe({title:"",description:ye.message,variant:"destructive"})}finally{G(ye=>{const U=new Set(ye);return U.delete(te),U})}},Pa=async()=>{for(const te of a)await ka(te.name)},Jt=te=>{const ye=z.has(te),U=Re.get(te);return ye?e.jsxs(ke,{variant:"secondary",className:"gap-1",children:[e.jsx(Fs,{className:"h-3 w-3 animate-spin"}),""]}):U?U.network_ok?U.api_key_valid===!0?e.jsxs(ke,{className:"gap-1 bg-green-600 hover:bg-green-700",children:[e.jsx(tt,{className:"h-3 w-3"}),""]}):U.api_key_valid===!1?e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(Rt,{className:"h-3 w-3"}),"Key"]}):e.jsxs(ke,{className:"gap-1 bg-blue-600 hover:bg-blue-700",children:[e.jsx(tt,{className:"h-3 w-3"}),""]}):e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(ta,{className:"h-3 w-3"}),""]}):null};return r?e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"AI"}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" AI  API "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[je.size>0&&e.jsxs(_,{onClick:ms,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(us,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",je.size,")"]}),e.jsxs(_,{onClick:Pa,size:"sm",variant:"outline",className:"w-full sm:w-auto",disabled:a.length===0||z.size>0,children:[e.jsx(el,{className:"mr-2 h-4 w-4"}),z.size>0?` (${z.size})`:""]}),e.jsxs(_,{onClick:()=>Ze(null,null),size:"sm",className:"w-full sm:w-auto","data-tour":"add-provider-button",children:[e.jsx(at,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{onClick:Ke,disabled:d||h||!p||Ee,size:"sm",variant:"outline",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),d?"...":h?"...":p?"":""]}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{disabled:d||h||Ee,size:"sm",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Ee?"...":p?"":""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:p?",":","})})})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:p?fa:St,children:p?"":""})]})]})]})]})]}),e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""}),'""']})]}),e.jsxs(ss,{className:"h-[calc(100vh-260px)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"URL ...",value:me,onChange:te=>Ne(te.target.value),className:"pl-9"})]}),me&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",rs.length," "]})]}),e.jsx("div",{className:"md:hidden space-y-3",children:rs.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8 rounded-lg border bg-card",children:me?"":'""'}):Tt.map((te,ye)=>{const U=a.findIndex(Me=>Me===te);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-base truncate",children:te.name}),Jt(te.name)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 break-all",children:te.base_url})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ka(te.name),disabled:z.has(te.name),title:"",children:z.has(te.name)?e.jsx(Fs,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsx(_,{variant:"default",size:"sm",onClick:()=>Ze(te,U),children:e.jsx(Jn,{className:"h-4 w-4",strokeWidth:2,fill:"none"})}),e.jsx(_,{size:"sm",onClick:()=>cs(U),className:"bg-red-600 hover:bg-red-700 text-white",children:e.jsx(us,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:te.client_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:te.max_retry})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:te.timeout})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:te.retry_interval})]})]})]},ye)})}),e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{className:"w-12",children:e.jsx(lt,{checked:je.size===rs.length&&rs.length>0,onCheckedChange:$e})}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:"URL"}),e.jsx(ls,{children:""}),e.jsx(ls,{className:"text-right",children:""}),e.jsx(ls,{className:"text-right",children:"()"}),e.jsx(ls,{className:"text-right",children:"()"}),e.jsx(ls,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:Tt.length===0?e.jsx(bt,{children:e.jsx(Je,{colSpan:9,className:"text-center text-muted-foreground py-8",children:me?"":'""'})}):Tt.map((te,ye)=>{const U=a.findIndex(Me=>Me===te);return e.jsxs(bt,{children:[e.jsx(Je,{children:e.jsx(lt,{checked:je.has(U),onCheckedChange:()=>_s(U)})}),e.jsx(Je,{children:Jt(te.name)||e.jsx(ke,{variant:"outline",className:"text-muted-foreground",children:""})}),e.jsx(Je,{className:"font-medium",children:te.name}),e.jsx(Je,{className:"max-w-xs truncate",title:te.base_url,children:te.base_url}),e.jsx(Je,{children:te.client_type}),e.jsx(Je,{className:"text-right",children:te.max_retry}),e.jsx(Je,{className:"text-right",children:te.timeout}),e.jsx(Je,{className:"text-right",children:te.retry_interval}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>ka(te.name),disabled:z.has(te.name),title:"",children:z.has(te.name)?e.jsx(Fs,{className:"h-4 w-4 animate-spin"}):e.jsx(el,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>Ze(te,U),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>cs(U),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(us,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},ye)})})]})})}),rs.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-provider",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:B.toString(),onValueChange:te=>{ue(parseInt(te)),K(1),ce(new Set)},children:[e.jsx(Be,{id:"page-size-provider",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"10",children:"10"}),e.jsx(ee,{value:"20",children:"20"}),e.jsx(ee,{value:"50",children:"50"}),e.jsx(ee,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(D-1)*B+1," "," ",Math.min(D*B,rs.length),"  ",rs.length," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>K(1),disabled:D===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>K(te=>Math.max(1,te-1)),disabled:D===1,children:[e.jsx(Ia,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:Q,onChange:te=>_e(te.target.value),onKeyDown:te=>te.key==="Enter"&&ca(),placeholder:D.toString(),className:"w-16 h-8 text-center",min:1,max:ht}),e.jsx(_,{variant:"outline",size:"sm",onClick:ca,disabled:!Q,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>K(te=>te+1),disabled:D>=ht,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ra,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>K(ht),disabled:D>=ht,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]}),e.jsx(Js,{open:N,onOpenChange:Ks,children:e.jsxs(qs,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"provider-dialog",preventOutsideClose:J.isRunning,children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:w!==null?"":""}),e.jsx(nt,{children:" API "})]}),e.jsxs("form",{onSubmit:te=>{te.preventDefault(),Ls()},autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"provider-template-select",children:[e.jsx(T,{htmlFor:"template",children:""}),e.jsxs(hl,{open:P,onOpenChange:E,children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":P,className:"w-full justify-between",children:[M?Xi.find(te=>te.id===M)?.display_name:"...",e.jsx(cx,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(nl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(ss,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:""}),e.jsx(oc,{children:Xi.map(te=>e.jsxs(dc,{value:te.display_name,onSelect:()=>Ts(te.id),children:[e.jsx(Lt,{className:`mr-2 h-4 w-4 ${M===te.id?"opacity-100":"opacity-0"}`}),te.display_name]},te.id))})]})})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" URL ,"})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-name-input",children:[e.jsx(T,{htmlFor:"name",className:V.name?"text-destructive":"",children:" *"}),e.jsx(ne,{id:"name",value:y?.name||"",onChange:te=>{b(ye=>ye?{...ye,name:te.target.value}:null),V.name&&$(ye=>({...ye,name:void 0}))},placeholder:": DeepSeek, SiliconFlow",className:V.name?"border-destructive focus-visible:ring-destructive":""}),V.name&&e.jsx("p",{className:"text-xs text-destructive",children:V.name})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-url-input",children:[e.jsx(T,{htmlFor:"base_url",className:V.base_url?"text-destructive":"",children:" URL *"}),e.jsx(ne,{id:"base_url",value:y?.base_url||"",onChange:te=>{b(ye=>ye?{...ye,base_url:te.target.value}:null),V.base_url&&$(ye=>({...ye,base_url:void 0}))},placeholder:"https://api.example.com/v1",disabled:He,className:`${He?"bg-muted cursor-not-allowed":""} ${V.base_url?"border-destructive focus-visible:ring-destructive":""}`}),V.base_url&&e.jsx("p",{className:"text-xs text-destructive",children:V.base_url}),He&&!V.base_url&&e.jsx("p",{className:"text-xs text-muted-foreground",children:' URL ,""'})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-apikey-input",children:[e.jsx(T,{htmlFor:"api_key",className:V.api_key?"text-destructive":"",children:"API Key *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{id:"api_key",type:X?"text":"password",value:y?.api_key||"",onChange:te=>{b(ye=>ye?{...ye,api_key:te.target.value}:null),V.api_key&&$(ye=>({...ye,api_key:void 0}))},placeholder:"sk-...",className:`flex-1 ${V.api_key?"border-destructive focus-visible:ring-destructive":""}`}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:()=>L(!X),title:X?"":"",children:X?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(ma,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:zs,title:"",children:e.jsx(Fo,{className:"h-4 w-4"})})]}),V.api_key&&e.jsx("p",{className:"text-xs text-destructive",children:V.api_key})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"client_type",children:""}),e.jsxs(Pe,{value:y?.client_type||"openai",onValueChange:te=>b(ye=>ye?{...ye,client_type:te}:null),disabled:He,children:[e.jsx(Be,{id:"client_type",className:He?"bg-muted cursor-not-allowed":"",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"openai",children:"OpenAI"}),e.jsx(ee,{value:"gemini",children:"Gemini"})]})]}),He&&e.jsx("p",{className:"text-xs text-muted-foreground",children:',""'})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"max_retry",children:""}),e.jsx(ne,{id:"max_retry",type:"number",min:"0",value:y?.max_retry??"",onChange:te=>{const ye=te.target.value===""?null:parseInt(te.target.value);b(U=>U?{...U,max_retry:ye}:null)},placeholder:": 2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"timeout",children:"()"}),e.jsx(ne,{id:"timeout",type:"number",min:"1",value:y?.timeout??"",onChange:te=>{const ye=te.target.value===""?null:parseInt(te.target.value);b(U=>U?{...U,timeout:ye}:null)},placeholder:": 30"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"retry_interval",children:"()"}),e.jsx(ne,{id:"retry_interval",type:"number",min:"1",value:y?.retry_interval??"",onChange:te=>{const ye=te.target.value===""?null:parseInt(te.target.value);b(U=>U?{...U,retry_interval:ye}:null)},placeholder:": 10"})]})]})]}),e.jsxs(xt,{children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>j(!1),"data-tour":"provider-cancel-button",children:""}),e.jsx(_,{type:"submit","data-tour":"provider-save-button",children:""})]})]})]})}),e.jsx(Cs,{open:C,onOpenChange:R,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',H!==null?a[H]?.name:"",'"  ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:ts,children:""})]})]})}),e.jsx(Cs,{open:ge,onOpenChange:pe,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",je.size,"  "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:os,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Cs,{open:he.isOpen,onOpenChange:te=>Te(ye=>({...ye,isOpen:te})),children:e.jsxs(ps,{className:"max-w-2xl",children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{asChild:!0,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:["",e.jsx("strong",{className:"text-foreground ml-1",children:he.providersToDelete.join(", ")})]}),e.jsxs("p",{className:"text-yellow-600 dark:text-yellow-500 font-medium",children:["  ",he.affectedModels.length," "]}),e.jsx(ss,{className:"h-32 w-full rounded border p-3",children:e.jsx("div",{className:"space-y-1",children:he.affectedModels.map((te,ye)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-mono text-muted-foreground",children:""}),e.jsx("span",{className:"ml-2 font-medium",children:te.name}),e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",te.model_identifier,")"]})]},ye))})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})})]}),e.jsxs(js,{children:[e.jsx(ys,{onClick:Y,children:""}),e.jsx(bs,{onClick:Is,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(ar,{})]})}function ac(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,11)}`}function Bm(a){return a===null?"null":Array.isArray(a)?"array":typeof a=="object"?"object":typeof a=="boolean"?"boolean":typeof a=="number"?"number":"string"}function Wm(a){return Object.entries(a).map(([l,r])=>{const c=Bm(r),d={id:ac(),key:l,value:r,type:c,expanded:!0};return c==="object"&&r&&typeof r=="object"?d.children=Wm(r):c==="array"&&Array.isArray(r)&&(d.children=r.map((m,h)=>{const f=Bm(m),p={id:ac(),key:String(h),value:m,type:f,expanded:!0};return f==="object"&&m&&typeof m=="object"?p.children=Wm(m):f==="array"&&Array.isArray(m)&&(p.children=m.map((g,N)=>({id:ac(),key:String(N),value:g,type:Bm(g),expanded:!0}))),p})),d})}function ex(a){const l={};for(const r of a)r.key.trim()&&(r.type==="object"&&r.children?l[r.key]=ex(r.children):r.type==="array"&&r.children?l[r.key]=r.children.map(c=>c.type==="object"&&c.children?ex(c.children):c.type==="array"&&c.children?c.children.map(d=>d.value):c.value):r.type==="null"?l[r.key]=null:l[r.key]=r.value);return l}function Vg(a,l){switch(l){case"boolean":return a==="true";case"number":{const r=parseFloat(a);return isNaN(r)?0:r}case"null":return null;default:return a}}function Wv({node:a,level:l,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:m}){const h=a.type==="object"||a.type==="array",f=a.children&&a.children.length>0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 items-center",style:{gridTemplateColumns:h?"32px 1fr 90px 64px":"32px 1fr 1fr 90px 32px",paddingLeft:`${l*20}px`},children:[e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>m(a.id),disabled:!h||!f,children:h&&f?a.expanded?e.jsx($a,{className:"h-4 w-4"}):e.jsx(ra,{className:"h-4 w-4"}):e.jsx("span",{className:"w-4"})}),e.jsx(ne,{value:a.key,onChange:p=>r(a.id,"key",p.target.value),placeholder:"key",className:"h-8 text-sm"}),!h&&e.jsx(e.Fragment,{children:a.type==="boolean"?e.jsxs("div",{className:"flex items-center h-8 px-3 border rounded-md bg-background",children:[e.jsx(Ge,{checked:a.value===!0,onCheckedChange:p=>r(a.id,"value",p)}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:a.value?"true":"false"})]}):a.type==="null"?e.jsx("div",{className:"flex items-center h-8 px-3 border rounded-md bg-muted text-sm text-muted-foreground",children:"null"}):e.jsx(ne,{type:a.type==="number"?"number":"text",value:a.value,onChange:p=>r(a.id,"value",p.target.value),placeholder:"value",className:"h-8 text-sm",step:a.type==="number"?"any":void 0})}),e.jsxs(Pe,{value:a.type,onValueChange:p=>r(a.id,"type",p),children:[e.jsx(Be,{className:"h-8 text-xs",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"string",children:""}),e.jsx(ee,{value:"number",children:""}),e.jsx(ee,{value:"boolean",children:""}),e.jsx(ee,{value:"null",children:"Null"}),e.jsx(ee,{value:"object",children:""}),e.jsx(ee,{value:"array",children:""})]})]}),e.jsxs("div",{className:"flex gap-1 justify-end",children:[h&&e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>d(a.id),title:"",children:e.jsx(at,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>c(a.id),title:"",children:e.jsx(us,{className:"h-4 w-4"})})]})]}),h&&a.expanded&&a.children&&a.children.length>0&&e.jsx("div",{className:"space-y-1",children:a.children.map(p=>e.jsx(Wv,{node:p,level:l+1,onUpdate:r,onRemove:c,onAddChild:d,onToggleExpand:m},p.id))})]})}function t4({value:a,onChange:l,placeholder:r="..."}){const[c,d]=u.useState(()=>Wm(a||{})),m=u.useCallback(j=>{d(j),l(ex(j))},[l]),h=u.useCallback(()=>{const j={id:ac(),key:"",value:"",type:"string",expanded:!1};m([...c,j])},[c,m]),f=u.useCallback((j,y,b)=>{const w=A=>A.map(M=>{if(M.id===j)if(y==="type"){const S=b;if(S==="object")return{...M,type:S,value:{},children:[]};if(S==="array")return{...M,type:S,value:[],children:[]};if(S==="null")return{...M,type:S,value:null};{const P=Vg(String(M.value),S);return{...M,type:S,value:P,children:void 0}}}else if(y==="value"){const S=Vg(String(b),M.type);return{...M,value:S}}else return{...M,[y]:String(b)};return M.children?{...M,children:w(M.children)}:M});m(w(c))},[c,m]),p=u.useCallback(j=>{const y=b=>b.filter(w=>w.id!==j).map(w=>w.children?{...w,children:y(w.children)}:w);m(y(c))},[c,m]),g=u.useCallback(j=>{const y=b=>b.map(w=>{if(w.id===j){const A={id:ac(),key:w.type==="array"?String(w.children?.length||0):"",value:"",type:"string",expanded:!0};return{...w,children:[...w.children||[],A]}}return w.children?{...w,children:y(w.children)}:w});m(y(c))},[c,m]),N=u.useCallback(j=>{const y=b=>b.map(w=>w.id===j?{...w,expanded:!w.expanded}:w.children?{...w,children:y(w.children)}:w);d(y(c))},[c]);return e.jsxs("div",{className:"h-full flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c.length," "]}),e.jsxs(_,{type:"button",size:"sm",variant:"outline",onClick:h,className:"h-7 text-xs",children:[e.jsx(at,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",children:c.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border border-dashed rounded-md",children:r}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 text-xs text-muted-foreground px-1 sticky top-0 bg-background z-10",style:{gridTemplateColumns:"32px 1fr 1fr 90px 32px"},children:[e.jsx("span",{}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{})]}),c.map(j=>e.jsx(Wv,{node:j,level:0,onUpdate:f,onRemove:p,onAddChild:g,onToggleExpand:N},j.id))]})})]})}function Gg(a){if(!a.trim())return{valid:!0,parsed:{}};try{const l=JSON.parse(a);return typeof l!="object"||l===null||Array.isArray(l)?{valid:!1,error:" JSON  {}"}:{valid:!0,parsed:l}}catch{return{valid:!1,error:"JSON "}}}function a4({value:a,onChange:l,className:r,placeholder:c="..."}){const[d,m]=u.useState("list"),h=u.useMemo(()=>Object.keys(a||{}).length>0?JSON.stringify(a,null,2):"",[a]),[f,p]=u.useState(h),[g,N]=u.useState(null);u.useEffect(()=>{p(h)},[h]);const j=u.useMemo(()=>{const w=Gg(f);return w.valid&&w.parsed?{success:!0,data:w.parsed}:{success:!1,data:{}}},[f]),y=u.useCallback(w=>{const A=w;A==="json"&&d==="list"&&(p(Object.keys(a).length>0?JSON.stringify(a,null,2):""),N(null)),m(A)},[d,a]),b=u.useCallback(w=>{p(w);const A=Gg(w);A.valid&&A.parsed?(N(null),l(A.parsed)):N(A.error||"JSON ")},[l]);return e.jsx("div",{className:F("h-full flex flex-col",r),children:e.jsxs(Yt,{value:d,onValueChange:y,className:"w-full flex-1 flex flex-col",children:[e.jsxs(Vt,{className:"h-8 p-0.5 bg-muted/60 w-fit",children:[e.jsx(Ye,{value:"list",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:""}),e.jsx(Ye,{value:"json",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"JSON "})]}),e.jsx(Ms,{value:"list",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsx(t4,{value:a,onChange:l,placeholder:c})}),e.jsx(Ms,{value:"json",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),g?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-destructive",children:[e.jsx(Rt,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:g})]}):f.trim()&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Lt,{className:"h-3 w-3"}),e.jsx("span",{children:""})]})]}),e.jsx(ft,{value:f,onChange:w=>b(w.target.value),placeholder:`{
  "key": "value"
}`,className:F("font-mono text-sm flex-1 resize-none",g&&"border-destructive focus-visible:ring-destructive")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" JSON "})]}),e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"flex-1 rounded-md border bg-muted/30 p-3 overflow-auto",children:j.success&&Object.keys(j.data).length>0?e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-words",children:JSON.stringify(j.data,null,2)}):j.success?e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:""}):e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-destructive",children:"JSON "})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})})]})})}function l4({open:a,onOpenChange:l,value:r,onChange:c}){const[d,m]=u.useState(r),h=g=>{g&&m(r),l(g)},f=()=>{c(d),l(!1)},p=()=>{m(r),l(!1)};return e.jsx(Js,{open:a,onOpenChange:h,children:e.jsxs(qs,{className:"max-w-3xl h-[70vh] flex flex-col",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:e.jsx(a4,{value:d,onChange:m,placeholder:" thinkingtop_p ..."})}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:p,children:""}),e.jsx(_,{onClick:f,children:""})]})]})})}const si="https://maibot-plugin-stats.maibot-webui.workers.dev";async function n4(a){const l=new URLSearchParams;a?.status&&l.set("status",a.status),a?.page&&l.set("page",a.page.toString()),a?.page_size&&l.set("page_size",a.page_size.toString()),a?.search&&l.set("search",a.search),a?.sort_by&&l.set("sort_by",a.sort_by),a?.sort_order&&l.set("sort_order",a.sort_order);const r=await fetch(`${si}/pack?${l.toString()}`);if(!r.ok)throw new Error(` Pack : ${r.status}`);return r.json()}async function r4(a){const l=await fetch(`${si}/pack/${a}`);if(!l.ok)throw new Error(` Pack : ${l.status}`);const r=await l.json();if(!r.success)throw new Error(r.error||" Pack ");return r.pack}async function i4(a){const r=await(await fetch(`${si}/pack`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(!r.success)throw new Error(r.error||" Pack ");return r}async function c4(a,l){await fetch(`${si}/pack/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:l})})}async function eN(a,l){const c=await(await fetch(`${si}/pack/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:a,user_id:l})})).json();if(!c.success)throw new Error(c.error||"");return{likes:c.likes,liked:c.liked}}async function sN(a,l){return(await(await fetch(`${si}/pack/like/check?pack_id=${a}&user_id=${l}`)).json()).liked||!1}async function o4(a){const l=await Se("/api/webui/config/model");if(!l.ok)throw new Error("");const r=await l.json(),c=r.config||r;console.log("=== Pack Conflict Detection ==="),console.log("Pack providers:",a.providers),console.log("Local providers:",c.api_providers);const d={existing_providers:[],new_providers:[],conflicting_models:[]},m=c.api_providers||[];for(const f of a.providers){console.log(`
Checking pack provider: ${f.name}`),console.log(`  Pack URL: ${f.base_url}`),console.log(`  Normalized: ${Im(f.base_url)}`);const p=m.filter(g=>{const N=Im(g.base_url),j=Im(f.base_url);return console.log(`  Comparing with local "${g.name}": ${g.base_url}`),console.log(`    Local normalized: ${N}`),console.log(`    Match: ${N===j}`),N===j});p.length>0?(console.log(`   Matched with ${p.length} local provider(s):`,p.map(g=>g.name).join(", ")),d.existing_providers.push({pack_provider:f,local_providers:p.map(g=>({name:g.name,base_url:g.base_url}))})):(console.log("   No match found - will need API key"),d.new_providers.push(f))}const h=c.models||[];console.log(`
=== Model Conflict Detection ===`);for(const f of a.models){const p=h.find(g=>g.name===f.name);p&&(console.log(`Model conflict: ${f.name}`),d.conflicting_models.push({pack_model:f.name,local_model:p.name}))}return console.log(`
=== Detection Summary ===`),console.log(`Existing providers: ${d.existing_providers.length}`),console.log(`New providers: ${d.new_providers.length}`),console.log(`Conflicting models: ${d.conflicting_models.length}`),console.log(`===========================
`),d}async function d4(a,l,r,c){const d=await Se("/api/webui/config/model");if(!d.ok)throw new Error("");const m=await d.json(),h=m.config||m;if(l.apply_providers){const p=l.selected_providers?a.providers.filter(g=>l.selected_providers.includes(g.name)):a.providers;for(const g of p){if(r[g.name])continue;const N=c[g.name];if(!N)throw new Error(` "${g.name}"  API Key`);const j={...g,api_key:N},y=h.api_providers.findIndex(b=>b.name===g.name);y>=0?h.api_providers[y]=j:h.api_providers.push(j)}}if(l.apply_models){const p=l.selected_models?a.models.filter(g=>l.selected_models.includes(g.name)):a.models;for(const g of p){const N=r[g.api_provider]||g.api_provider,j={...g,api_provider:N},y=h.models.findIndex(b=>b.name===g.name);y>=0?h.models[y]=j:h.models.push(j)}}if(l.apply_task_config){const p=l.selected_tasks||Object.keys(a.task_config);for(const g of p){const N=a.task_config[g];if(!N)continue;const j=new Set(l.selected_models||a.models.map(w=>w.name)),y=N.model_list.filter(w=>j.has(w));if(y.length===0)continue;const b={...N,model_list:y};if(l.task_mode==="replace")h.model_task_config[g]=b;else{const w=h.model_task_config[g];if(w){const A=[...new Set([...w.model_list,...y])];h.model_task_config[g]={...w,model_list:A}}else h.model_task_config[g]=b}}}if(!(await Se("/api/webui/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("")}async function u4(a){const l=await Se("/api/webui/config/model");if(!l.ok)throw new Error("");const r=await l.json();if(!r.success||!r.config)throw new Error("");const c=r.config;let d=(c.api_providers||[]).map(g=>({name:g.name,base_url:g.base_url,client_type:g.client_type,max_retry:g.max_retry,timeout:g.timeout,retry_interval:g.retry_interval}));a.selectedProviders&&(d=d.filter(g=>a.selectedProviders.includes(g.name)));let m=c.models||[];a.selectedModels&&(m=m.filter(g=>a.selectedModels.includes(g.name)));const h={},f=c.model_task_config||{},p=a.selectedTasks||Object.keys(f);for(const g of p)f[g]&&(h[g]=f[g]);return{providers:d,models:m,task_config:h}}function Im(a){try{const l=new URL(a);return`${l.protocol}//${l.host}${l.pathname}`.replace(/\/$/,"").toLowerCase()}catch{return a.toLowerCase().replace(/\/$/,"")}}function tN(){const a="maibot_pack_user_id";let l=localStorage.getItem(a);return l||(l="pack_user_"+Math.random().toString(36).substring(2,15),localStorage.setItem(a,l)),l}const m4={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""},x4=["","","","","","","OpenAI","Claude","Gemini","","",""];function h4({trigger:a}){const[l,r]=u.useState(!1),[c,d]=u.useState(1),[m,h]=u.useState(!1),[f,p]=u.useState(!1),[g,N]=u.useState([]),[j,y]=u.useState([]),[b,w]=u.useState({}),[A,M]=u.useState(new Set),[S,P]=u.useState(new Set),[E,C]=u.useState(new Set),[R,H]=u.useState(""),[O,X]=u.useState(""),[L,me]=u.useState(""),[Ne,je]=u.useState([]);u.useEffect(()=>{l&&c===1&&ce()},[l,c]);const ce=async()=>{h(!0);try{const V=await u4({name:"",description:"",author:""});N(V.providers),y(V.models),w(V.task_config),M(new Set(V.providers.map($=>$.name))),P(new Set(V.models.map($=>$.name))),C(new Set(Object.keys(V.task_config)))}catch(V){console.error(":",V),aa({title:"",variant:"destructive"})}finally{h(!1)}},ge=V=>{const $=new Set(A),z=new Set(S),G=new Set(E);$.has(V)?($.delete(V),j.filter(se=>se.api_provider===V).forEach(se=>z.delete(se.name)),Object.entries(b).forEach(([se,Oe])=>{Oe.model_list&&(Oe.model_list.some(J=>z.has(J))||G.delete(se))})):($.add(V),j.filter(se=>se.api_provider===V).forEach(se=>z.add(se.name)),Object.entries(b).forEach(([se,Oe])=>{Oe.model_list&&Oe.model_list.some(J=>{const Z=j.find(Le=>Le.name===J);return Z&&Z.api_provider===V})&&G.add(se)})),M($),P(z),C(G)},pe=V=>{const $=new Set(S),z=new Set(E);$.has(V)?($.delete(V),Object.entries(b).forEach(([G,Re])=>{Re.model_list&&(Re.model_list.some(Oe=>$.has(Oe))||z.delete(G))})):($.add(V),Object.entries(b).forEach(([G,Re])=>{Re.model_list&&Re.model_list.includes(V)&&z.add(G)})),P($),C(z)},D=V=>{const $=new Set(E);$.has(V)?$.delete(V):$.add(V),C($)},K=V=>{Ne.includes(V)?je(Ne.filter($=>$!==V)):Ne.length<5?je([...Ne,V]):aa({title:" 5 ",variant:"destructive"})},B=()=>{A.size===g.length?M(new Set):M(new Set(g.map(V=>V.name)))},ue=()=>{S.size===j.length?P(new Set):P(new Set(j.map(V=>V.name)))},Q=()=>{const V=Object.keys(b);E.size===V.length?C(new Set):C(new Set(V))},_e=async()=>{if(!R.trim()){aa({title:"",variant:"destructive"});return}if(!O.trim()){aa({title:"",variant:"destructive"});return}if(!L.trim()){aa({title:"",variant:"destructive"});return}if(A.size===0&&S.size===0&&E.size===0){aa({title:"",variant:"destructive"});return}p(!0);try{const V=g.filter(G=>A.has(G.name)),$=j.filter(G=>S.has(G.name)),z={};for(const[G,Re]of Object.entries(b))E.has(G)&&(z[G]=Re);await i4({name:R.trim(),description:O.trim(),author:L.trim(),tags:Ne,providers:V,models:$,task_config:z}),aa({title:""}),r(!1),he()}catch(V){console.error(":",V),aa({title:V instanceof Error?V.message:"",variant:"destructive"})}finally{p(!1)}},he=()=>{d(1),H(""),X(""),me(""),je([]),M(new Set),P(new Set),C(new Set)},Te=2;return e.jsxs(Js,{open:l,onOpenChange:r,children:[e.jsx(cd,{asChild:!0,children:a||e.jsxs(_,{variant:"outline",children:[e.jsx(ov,{className:"w-4 h-4 mr-2"}),""]})}),e.jsxs(qs,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(ua,{className:"w-5 h-5"}),""]}),e.jsxs(nt,{children:[" ",c," / ",Te,"",c===1&&"",c===2&&""]})]}),e.jsx(ss,{className:"h-[calc(85vh-220px)] pr-4",children:m?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Fs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""})," API Key"]})]}),e.jsxs(Yt,{defaultValue:"providers",className:"w-full",children:[e.jsxs(Vt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ye,{value:"providers",children:[e.jsx(Bl,{className:"w-4 h-4 mr-2"}),"API ",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[A.size,"/",g.length]})]}),e.jsxs(Ye,{value:"models",children:[e.jsx(Xn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[S.size,"/",j.length]})]}),e.jsxs(Ye,{value:"tasks",children:[e.jsx(Zn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[E.size,"/",Object.keys(b).length]})]})]}),e.jsx(Ms,{value:"providers",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:B,children:A.size===g.length?"":""})}),g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):g.map(V=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(lt,{id:`provider-${V.name}`,checked:A.has(V.name),onCheckedChange:()=>ge(V.name)}),e.jsxs(T,{htmlFor:`provider-${V.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:V.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:V.base_url})]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:V.client_type})]},V.name))]})}),e.jsx(Ms,{value:"models",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:ue,children:S.size===j.length?"":""})}),j.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):j.map(V=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(lt,{id:`model-${V.name}`,checked:S.has(V.name),onCheckedChange:()=>pe(V.name)}),e.jsxs(T,{htmlFor:`model-${V.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:V.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:V.model_identifier})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:V.api_provider})]},V.name))]})}),e.jsx(Ms,{value:"tasks",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:Q,children:E.size===Object.keys(b).length?"":""})}),Object.keys(b).length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):Object.entries(b).map(([V,$])=>e.jsxs("div",{className:"space-y-2 p-2 rounded hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:`task-${V}`,checked:E.has(V),onCheckedChange:()=>D(V)}),e.jsx(T,{htmlFor:`task-${V}`,className:"flex-1 cursor-pointer",children:e.jsx("span",{className:"font-medium",children:m4[V]||V})}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[$.model_list.length," "]})]}),$.model_list&&$.model_list.length>0&&e.jsx("div",{className:"ml-6 flex flex-wrap gap-1",children:$.model_list.map(z=>{const G=j.find(se=>se.name===z),Re=S.has(z);return e.jsxs(ke,{variant:Re?"default":"outline",className:"text-xs cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>pe(z),children:[z,G&&e.jsxs("span",{className:"ml-1 opacity-70",children:["(",G.api_provider,")"]})]},z)})})]},V))]})})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm p-3 bg-muted rounded-lg",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Bl,{className:"w-4 h-4"}),A.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xn,{className:"w-4 h-4"}),S.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Zn,{className:"w-4 h-4"}),E.size," "]})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-name",children:" *"}),e.jsx(ne,{id:"pack-name",placeholder:"",value:R,onChange:V=>H(V.target.value),maxLength:50}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[R.length,"/50"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-description",children:" *"}),e.jsx(ft,{id:"pack-description",placeholder:"...",value:O,onChange:V=>X(V.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[O.length,"/500"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"pack-author",children:" *"}),e.jsx(ne,{id:"pack-author",placeholder:" ID",value:L,onChange:V=>me(V.target.value),maxLength:30})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" 5 "}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x4.map(V=>e.jsxs(ke,{variant:Ne.includes(V)?"default":"outline",className:"cursor-pointer transition-colors",onClick:()=>K(V),children:[Ne.includes(V)&&e.jsx(Lt,{className:"w-3 h-3 mr-1"}),e.jsx(rd,{className:"w-3 h-3 mr-1"}),V]},V))})]})]}),e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:" 1-3 "})]})]})]})}),e.jsxs(xt,{className:"flex justify-between pt-4 border-t",children:[e.jsx("div",{children:c>1&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>{r(!1),he()},disabled:f,children:""}),c<Te?e.jsx(_,{onClick:()=>d(c+1),disabled:m||A.size===0&&S.size===0&&E.size===0,children:""}):e.jsxs(_,{onClick:_e,disabled:f,children:[f&&e.jsx(Fs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})]})}function f4({value:a,label:l,onRemove:r}){const{attributes:c,listeners:d,setNodeRef:m,transform:h,transition:f,isDragging:p}=_v({id:a}),g={transform:Sv.Transform.toString(h),transition:f,opacity:p?.5:1},N=y=>{y.preventDefault(),y.stopPropagation(),r(a)},j=y=>{y.stopPropagation()};return e.jsx("div",{ref:m,style:g,className:F("inline-flex items-center gap-1",p&&"shadow-lg"),children:e.jsxs(ke,{variant:"secondary",className:"cursor-move hover:bg-secondary/80 flex items-center gap-1",children:[e.jsx("div",{...c,...d,className:"cursor-grab active:cursor-grabbing flex items-center",children:e.jsx(rv,{className:"h-3 w-3 text-muted-foreground"})}),e.jsx("span",{children:l}),e.jsx("span",{role:"button",tabIndex:0,className:"ml-1 rounded-sm hover:bg-destructive/20 focus:outline-none focus:ring-1 focus:ring-destructive cursor-pointer",onClick:N,onPointerDown:j,onMouseDown:y=>y.stopPropagation(),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),N(y))},children:e.jsx(_a,{className:"h-3 w-3 hover:text-destructive",strokeWidth:2,fill:"none"})})]})})}function p4({options:a,selected:l,onChange:r,placeholder:c="...",emptyText:d="",className:m}){const[h,f]=u.useState(!1),p=pv(Go(vv,{activationConstraint:{distance:8}}),Go(jv,{coordinateGetter:gv})),g=y=>{l.includes(y)?r(l.filter(b=>b!==y)):r([...l,y])},N=y=>{r(l.filter(b=>b!==y))},j=y=>{const{active:b,over:w}=y;if(w&&b.id!==w.id){const A=l.indexOf(b.id),M=l.indexOf(w.id);r(Nv(l,A,M))}};return e.jsxs(hl,{open:h,onOpenChange:f,children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":h,className:F("w-full justify-between min-h-10 h-auto",m),children:[e.jsx(bv,{sensors:p,collisionDetection:yv,onDragEnd:j,children:e.jsx(wv,{items:l,strategy:d_,children:e.jsx("div",{className:"flex gap-1 flex-wrap flex-1",children:l.length===0?e.jsx("span",{className:"text-muted-foreground",children:c}):l.map(y=>{const b=a.find(w=>w.value===y);return e.jsx(f4,{value:y,label:b?.label||y,onRemove:N},y)})})})}),e.jsx(cx,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:2,fill:"none"})]})}),e.jsx(nl,{className:"w-full p-0",align:"start",children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"...",className:"h-9"}),e.jsxs(md,{children:[e.jsx(xd,{children:d}),e.jsx(oc,{children:a.map(y=>{const b=l.includes(y.value);return e.jsxs(dc,{value:y.value,onSelect:()=>g(y.value),children:[e.jsx("div",{className:F("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",b?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Lt,{className:"h-3 w-3",strokeWidth:2,fill:"none"})}),e.jsx("span",{children:y.label})]},y.value)})})]})]})})]})}const Dl=Hs.memo(function({title:l,description:r,taskConfig:c,modelNames:d,onChange:m,hideTemperature:h=!1,hideMaxTokens:f=!1,dataTour:p}){const g=N=>{m("model_list",N)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-base sm:text-lg",children:l}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:r})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":p,children:[e.jsx(T,{children:""}),e.jsx(p4,{options:d.map(N=>({label:N,value:N})),selected:c.model_list||[],onChange:g,placeholder:"...",emptyText:""})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!h&&e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:""}),e.jsx(ne,{type:"number",step:"0.1",min:"0",max:"1",value:c.temperature??.3,onChange:N=>{const j=parseFloat(N.target.value);!isNaN(j)&&j>=0&&j<=1&&m("temperature",j)},className:"w-20 h-8 text-sm"})]}),e.jsx(Wa,{value:[c.temperature??.3],onValueChange:N=>m("temperature",N[0]),min:0,max:1,step:.1,className:"w-full"})]}),!f&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:" Token"}),e.jsx(ne,{type:"number",step:"1",min:"1",value:c.max_tokens??1024,onChange:N=>m("max_tokens",parseInt(N.target.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:" ()"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(ne,{type:"number",step:"1",min:"1",value:c.slow_threshold??15,onChange:N=>{const j=parseInt(N.target.value);!isNaN(j)&&j>=1&&m("slow_threshold",j)},placeholder:"15"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:c.selection_strategy??"balance",onValueChange:N=>m("selection_strategy",N),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"balance",children:"balance"}),e.jsx(ee,{value:"random",children:"random"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})}),g4=Hs.memo(function({paginatedModels:l,allModels:r,onEdit:c,onDelete:d,isModelUsed:m,searchQuery:h}){return l.length===0?e.jsx("div",{className:"md:hidden text-center text-muted-foreground py-8 rounded-lg border bg-card",children:h?"":""}):e.jsx("div",{className:"md:hidden space-y-3",children:l.map((f,p)=>{const g=r.findIndex(j=>j===f),N=m(f.name);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:f.name}),e.jsx(ke,{variant:N?"default":"secondary",className:N?"bg-green-600 hover:bg-green-700":"",children:N?"":""})]}),e.jsx("p",{className:"text-xs text-muted-foreground break-all",title:f.model_identifier,children:f.model_identifier})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>c(f,g),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>d(g),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(us,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.api_provider})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.temperature!=null?f.temperature:e.jsx("span",{className:"text-muted-foreground",children:""})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_in,"/M"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_out,"/M"]})]})]})]},p)})})}),j4=Hs.memo(function({paginatedModels:l,allModels:r,filteredModels:c,selectedModels:d,onEdit:m,onDelete:h,onToggleSelection:f,onToggleSelectAll:p,isModelUsed:g,searchQuery:N}){return e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{className:"w-12",children:e.jsx(lt,{checked:d.size===c.length&&c.length>0,onCheckedChange:p})}),e.jsx(ls,{className:"w-24",children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{className:"text-center",children:""}),e.jsx(ls,{className:"text-right",children:""}),e.jsx(ls,{className:"text-right",children:""}),e.jsx(ls,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:l.length===0?e.jsx(bt,{children:e.jsx(Je,{colSpan:9,className:"text-center text-muted-foreground py-8",children:N?"":""})}):l.map((j,y)=>{const b=r.findIndex(A=>A===j),w=g(j.name);return e.jsxs(bt,{children:[e.jsx(Je,{children:e.jsx(lt,{checked:d.has(b),onCheckedChange:()=>f(b)})}),e.jsx(Je,{children:e.jsx(ke,{variant:w?"default":"secondary",className:w?"bg-green-600 hover:bg-green-700":"",children:w?"":""})}),e.jsx(Je,{className:"font-medium",children:j.name}),e.jsx(Je,{className:"max-w-xs truncate",title:j.model_identifier,children:j.model_identifier}),e.jsx(Je,{children:j.api_provider}),e.jsx(Je,{className:"text-center",children:j.temperature!=null?j.temperature:e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(Je,{className:"text-right",children:["",j.price_in,"/M"]}),e.jsxs(Je,{className:"text-right",children:["",j.price_out,"/M"]}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>m(j,b),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>h(b),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(us,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},y)})})]})})})}),v4=300*1e3,Kg=new Map,N4=[10,20,50,100],b4=Hs.memo(function({page:l,pageSize:r,totalItems:c,jumpToPage:d,onPageChange:m,onPageSizeChange:h,onJumpToPageChange:f,onJumpToPage:p,onSelectionClear:g}){const N=Math.ceil(c/r),j=b=>{h(parseInt(b)),m(1),g?.()},y=b=>{b.key==="Enter"&&p()};return c===0?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size-model",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:r.toString(),onValueChange:j,children:[e.jsx(Be,{id:"page-size-model",className:"w-20",children:e.jsx(Fe,{})}),e.jsx(Ie,{children:N4.map(b=>e.jsx(ee,{value:b.toString(),children:b},b))})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(l-1)*r+1," "," ",Math.min(l*r,c),"  ",c," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>m(1),disabled:l===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>m(Math.max(1,l-1)),disabled:l===1,children:[e.jsx(Ia,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:d,onChange:b=>f(b.target.value),onKeyDown:y,placeholder:l.toString(),className:"w-16 h-8 text-center",min:1,max:N}),e.jsx(_,{variant:"outline",size:"sm",onClick:p,disabled:!d,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>m(l+1),disabled:l>=N,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ra,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>m(N),disabled:l>=N,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})});function y4(a){const{models:l,taskConfig:r,debounceMs:c=2e3,onSavingChange:d,onUnsavedChange:m}=a,h=u.useRef(null),f=u.useRef(null),p=u.useRef(!0),g=u.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current&&(clearTimeout(f.current),f.current=null)},[]),N=u.useCallback(b=>{const w={model_identifier:b.model_identifier,name:b.name,api_provider:b.api_provider,price_in:b.price_in??0,price_out:b.price_out??0,force_stream_mode:b.force_stream_mode??!1,extra_params:b.extra_params??{}};return b.temperature!=null&&(w.temperature=b.temperature),b.max_tokens!=null&&(w.max_tokens=b.max_tokens),w},[]),j=u.useCallback(async b=>{try{d?.(!0);const w=b.map(N);await Xm("models",w),m?.(!1)}catch(w){console.error(":",w),m?.(!0)}finally{d?.(!1)}},[d,m,N]),y=u.useCallback(async b=>{try{d?.(!0),await Xm("model_task_config",b),m?.(!1)}catch(w){console.error(":",w),m?.(!0)}finally{d?.(!1)}},[d,m]);return u.useEffect(()=>{if(!p.current)return m?.(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{j(l)},c),()=>{h.current&&clearTimeout(h.current)}},[l,j,c,m]),u.useEffect(()=>{if(!(p.current||!r))return m?.(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{y(r)},c),()=>{f.current&&clearTimeout(f.current)}},[r,y,c,m]),u.useEffect(()=>()=>{g()},[g]),{clearTimers:g,initialLoadRef:p}}function w4(a={}){const{onCloseEditDialog:l}=a,r=xa(),{registerTour:c,startTour:d,state:m,goToStep:h}=_x(),f=u.useRef(m.stepIndex);return u.useEffect(()=>{c(ml,Xv)},[c]),u.useEffect(()=>{if(m.activeTourId===ml&&m.isRunning){const g=Zv[m.stepIndex];g&&!window.location.pathname.endsWith(g.replace("/config/",""))&&r({to:g})}},[m.stepIndex,m.activeTourId,m.isRunning,r]),u.useEffect(()=>{if(m.activeTourId===ml&&m.isRunning){const g=f.current,N=m.stepIndex;g>=12&&g<=17&&N<12&&l?.(),f.current=N}},[m.stepIndex,m.activeTourId,m.isRunning,l]),u.useEffect(()=>{if(m.activeTourId!==ml||!m.isRunning)return;const g=N=>{const j=N.target,y=m.stepIndex;y===2&&j.closest('[data-tour="add-provider-button"]')?setTimeout(()=>h(3),300):y===9&&j.closest('[data-tour="provider-cancel-button"]')?setTimeout(()=>h(10),300):y===11&&j.closest('[data-tour="add-model-button"]')?setTimeout(()=>h(12),300):y===17&&j.closest('[data-tour="model-cancel-button"]')?setTimeout(()=>h(18),300):y===18&&j.closest('[data-tour="tasks-tab-trigger"]')&&setTimeout(()=>h(19),300)};return document.addEventListener("click",g,!0),()=>document.removeEventListener("click",g,!0)},[m,h]),{startTour:u.useCallback(()=>{d(ml)},[d]),isRunning:m.isRunning&&m.activeTourId===ml,stepIndex:m.stepIndex}}function _4(a){const{getProviderConfig:l}=a,[r,c]=u.useState([]),[d,m]=u.useState(!1),[h,f]=u.useState(null),[p,g]=u.useState(null),N=u.useCallback(()=>{c([]),f(null),g(null)},[]),j=u.useCallback(async(y,b=!1)=>{const w=l(y);if(!w?.base_url){c([]),g(null),f('""');return}if(!w.api_key){c([]),g(null),f(' API Key""');return}const A=ZS(w.base_url);if(g(A),!A?.modelFetcher){c([]),f(null);return}const M=`${y}:${w.base_url}`,S=Kg.get(M);if(!b&&S&&Date.now()-S.timestamp<v4){c(S.models),f(null);return}m(!0),f(null);try{const P=await hS(y,A.modelFetcher.parser,A.modelFetcher.endpoint);c(P),Kg.set(M,{models:P,timestamp:Date.now()})}catch(P){console.error(":",P);const E=P.message||"";E.includes("")||E.includes("")||E.includes("API Key")?f('API Key ""'):E.includes("")?f(" API Key "):E.includes("timeout")||E.includes("")?f(""):E.includes("")?f(""):f(E),c([])}finally{m(!1)}},[l]);return{availableModels:r,fetchingModels:d,modelFetchError:h,matchedTemplate:p,fetchModelsForProvider:j,clearModels:N}}function S4(){return e.jsx(tr,{children:e.jsx(k4,{})})}function k4(){const[a,l]=u.useState([]),[r,c]=u.useState([]),[d,m]=u.useState([]),[h,f]=u.useState([]),[p,g]=u.useState(null),[N,j]=u.useState(!0),[y,b]=u.useState(!1),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[P,E]=u.useState(!1),[C,R]=u.useState(null),[H,O]=u.useState(null),[X,L]=u.useState(!1),[me,Ne]=u.useState(!1),[je,ce]=u.useState(null),[ge,pe]=u.useState(""),[D,K]=u.useState(new Set),[B,ue]=u.useState(!1),[Q,_e]=u.useState(1),[he,Te]=u.useState(20),[V,$]=u.useState(""),[z,G]=u.useState(!1),[Re,se]=u.useState(!1),Oe=u.useRef([]),ns=u.useRef(null),[J,Z]=u.useState([]),[Le,ae]=u.useState([]),[Ee,de]=u.useState({}),{toast:ze}=it(),{triggerRestart:ws,isRestarting:Zs}=_n(),{startTour:St,isRunning:fa}=w4({onCloseEditDialog:()=>E(!1)}),{clearTimers:xs,initialLoadRef:Is}=y4({models:a,taskConfig:p,onSavingChange:A,onUnsavedChange:S}),Y=u.useCallback((le,fe)=>{if(!le)return;const es=new Set(fe.map(oa=>oa.name)),Ss=[],hs=[],yt=[{key:"utils",label:""},{key:"tool_use",label:""},{key:"replyer",label:""},{key:"planner",label:""},{key:"vlm",label:""},{key:"voice",label:""},{key:"embedding",label:""},{key:"lpmm_entity_extract",label:"LPMM"},{key:"lpmm_rdf_build",label:"LPMM"}];for(const{key:oa,label:Xt}of yt){const ql=le[oa];if(!ql)continue;if(!ql.model_list||ql.model_list.length===0){hs.push(Xt);continue}const kn=ql.model_list.filter(Cn=>!es.has(Cn));kn.length>0&&Ss.push({taskName:Xt,invalidModels:kn})}Z(Ss),ae(hs)},[]),qe=u.useCallback(async()=>{try{j(!0);const le=await pn(),fe=le.models||[];l(fe),f(fe.map(yt=>yt.name));const es=le.api_providers||[];c(es.map(yt=>yt.name)),m(es);const Ss=le.model_task_config||null;g(Ss),Y(Ss,fe);const hs=Ss?.embedding?.model_list||[];Oe.current=[...hs],S(!1),Is.current=!1}catch(le){console.error(":",le)}finally{j(!1)}},[Is,Y]);u.useEffect(()=>{qe()},[qe]);const Ke=u.useCallback(le=>d.find(fe=>fe.name===le),[d]),{availableModels:Ze,fetchingModels:Ts,modelFetchError:He,matchedTemplate:zs,fetchModelsForProvider:Ls,clearModels:Ks}=_4({getProviderConfig:Ke});u.useEffect(()=>{P&&C?.api_provider&&Ls(C.api_provider)},[P,C?.api_provider,Ls]);const cs=async()=>{await ws()},ts=u.useCallback(()=>{if(!p)return;const le=new Set(a.map(Ss=>Ss.name)),fe={...p},es=Object.keys(fe);for(const Ss of es){const hs=fe[Ss];hs&&hs.model_list&&(hs.model_list=hs.model_list.filter(yt=>le.has(yt)))}g(fe),Z([]),ze({title:"",description:""})},[p,a,ze]),_s=le=>{const fe={model_identifier:le.model_identifier,name:le.name,api_provider:le.api_provider,price_in:le.price_in??0,price_out:le.price_out??0,force_stream_mode:le.force_stream_mode??!1,extra_params:le.extra_params??{}};return le.temperature!=null&&(fe.temperature=le.temperature),le.max_tokens!=null&&(fe.max_tokens=le.max_tokens),fe},$e=async()=>{try{b(!0),xs();const le=await pn();le.models=a.map(_s),le.model_task_config=p,await tc(le),S(!1),ze({title:"",description:"..."}),await cs()}catch(le){console.error(":",le),ze({title:"",description:le.message,variant:"destructive"}),b(!1)}},ms=async()=>{try{b(!0),xs();const le=await pn();le.models=a.map(_s),le.model_task_config=p,await tc(le),S(!1),ze({title:"",description:""}),await qe()}catch(le){console.error(":",le),ze({title:"",description:le.message,variant:"destructive"})}finally{b(!1)}},os=(le,fe)=>{de({}),R(le||{model_identifier:"",name:"",api_provider:r[0]||"",price_in:0,price_out:0,temperature:null,max_tokens:null,force_stream_mode:!1,extra_params:{}}),O(fe),E(!0)},rs=()=>{if(!C)return;const le={};if(C.name?.trim()?a.some((yt,oa)=>H!==null&&oa===H?!1:yt.name.trim().toLowerCase()===C.name.trim().toLowerCase())&&(le.name=""):le.name="",C.api_provider?.trim()||(le.api_provider=" API "),C.model_identifier?.trim()||(le.model_identifier=""),Object.keys(le).length>0){de(le);return}de({});const fe={model_identifier:C.model_identifier,name:C.name,api_provider:C.api_provider,price_in:C.price_in??0,price_out:C.price_out??0,force_stream_mode:C.force_stream_mode??!1,extra_params:C.extra_params??{}};C.temperature!=null&&(fe.temperature=C.temperature),C.max_tokens!=null&&(fe.max_tokens=C.max_tokens);let es,Ss=null;if(H!==null?(Ss=a[H].name,es=[...a],es[H]=fe):es=[...a,fe],l(es),f(es.map(hs=>hs.name)),Ss&&Ss!==fe.name&&p){const hs=yt=>yt.map(oa=>oa===Ss?fe.name:oa);g({...p,utils:{...p.utils,model_list:hs(p.utils?.model_list||[])},tool_use:{...p.tool_use,model_list:hs(p.tool_use?.model_list||[])},replyer:{...p.replyer,model_list:hs(p.replyer?.model_list||[])},planner:{...p.planner,model_list:hs(p.planner?.model_list||[])},vlm:{...p.vlm,model_list:hs(p.vlm?.model_list||[])},voice:{...p.voice,model_list:hs(p.voice?.model_list||[])},embedding:{...p.embedding,model_list:hs(p.embedding?.model_list||[])},lpmm_entity_extract:{...p.lpmm_entity_extract,model_list:hs(p.lpmm_entity_extract?.model_list||[])},lpmm_rdf_build:{...p.lpmm_rdf_build,model_list:hs(p.lpmm_rdf_build?.model_list||[])}})}E(!1),R(null),O(null),ze({title:H!==null?"":"",description:' 2 ""'})},ht=le=>{if(!le&&C){const fe={...C,price_in:C.price_in??0,price_out:C.price_out??0};R(fe)}E(le)},Tt=le=>{ce(le),Ne(!0)},ca=()=>{if(je!==null){const le=a.filter((fe,es)=>es!==je);l(le),f(le.map(fe=>fe.name)),Y(p,le),ze({title:"",description:' 2 ""'})}Ne(!1),ce(null)},ka=le=>{const fe=new Set(D);fe.has(le)?fe.delete(le):fe.add(le),K(fe)},Pa=()=>{if(D.size===Xe.length)K(new Set);else{const le=Xe.map((fe,es)=>a.findIndex(Ss=>Ss===Xe[es]));K(new Set(le))}},Jt=()=>{if(D.size===0){ze({title:"",description:"",variant:"default"});return}ue(!0)},te=()=>{const le=D.size,fe=a.filter((es,Ss)=>!D.has(Ss));l(fe),f(fe.map(es=>es.name)),Y(p,fe),K(new Set),ue(!1),ze({title:"",description:` ${le}  2 `})},ye=(le,fe,es)=>{if(!p)return;if(le==="embedding"&&fe==="model_list"&&Array.isArray(es)){const hs=Oe.current,yt=es;if((hs.length!==yt.length||hs.some(Xt=>!yt.includes(Xt))||yt.some(Xt=>!hs.includes(Xt)))&&hs.length>0){ns.current={field:fe,value:es},se(!0);return}}const Ss={...p,[le]:{...p[le],[fe]:es}};g(Ss),Y(Ss,a),le==="embedding"&&fe==="model_list"&&Array.isArray(es)&&(Oe.current=[...es])},U=()=>{if(!p||!ns.current)return;const{field:le,value:fe}=ns.current,es={...p,embedding:{...p.embedding,[le]:fe}};g(es),Y(es,a),le==="model_list"&&Array.isArray(fe)&&(Oe.current=[...fe]),ns.current=null,se(!1),ze({title:"",description:""})},Me=()=>{ns.current=null,se(!1)},Xe=a.filter(le=>{if(!ge)return!0;const fe=ge.toLowerCase();return le.name.toLowerCase().includes(fe)||le.model_identifier.toLowerCase().includes(fe)||le.api_provider.toLowerCase().includes(fe)}),ds=Math.ceil(Xe.length/he),is=Xe.slice((Q-1)*he,Q*he),kt=()=>{const le=parseInt(V);le>=1&&le<=ds&&(_e(le),$(""))},Ps=le=>p?[p.utils?.model_list||[],p.tool_use?.model_list||[],p.replyer?.model_list||[],p.planner?.model_list||[],p.vlm?.model_list||[],p.voice?.model_list||[],p.embedding?.model_list||[],p.lpmm_entity_extract?.model_list||[],p.lpmm_rdf_build?.model_list||[]].some(es=>es.includes(le)):!1;return N?e.jsx(ss,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(h4,{trigger:e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(ov,{className:"mr-2 h-4 w-4"}),""]})}),e.jsxs(_,{onClick:ms,disabled:y||w||!M||Zs,size:"sm",variant:"outline",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(fc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),y?"...":w?"...":M?"":""]}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(_,{disabled:y||w||Zs,size:"sm",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(hc,{className:"mr-2 h-4 w-4"}),Zs?"...":M?"":""]})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsx(Ns,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:M?",":","})})})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:M?$e:cs,children:M?"":""})]})]})]})]})]}),e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsxs(gt,{children:["",e.jsx("strong",{children:""}),'""']})]}),J.length>0&&e.jsxs(pt,{variant:"destructive",children:[e.jsx(qt,{className:"h-4 w-4"}),e.jsxs(gt,{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:J.map(({taskName:le,invalidModels:fe})=>e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:le})," : ",fe.join(", ")]},le))})]}),e.jsx(_,{variant:"outline",size:"sm",className:"shrink-0 bg-background hover:bg-accent",onClick:ts,children:""})]})]}),Le.length>0&&e.jsxs(pt,{variant:"default",className:"border-yellow-500/50 bg-yellow-500/10",children:[e.jsx(qt,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(gt,{children:[e.jsx("strong",{className:"text-yellow-600",children:""}),e.jsxs("div",{className:"mt-2 text-sm",children:[Le.join("")," "]})]})]}),e.jsxs(pt,{className:"hidden lg:flex border-primary/30 bg-primary/5 cursor-pointer hover:bg-primary/10 transition-colors",onClick:St,children:[e.jsx(z1,{className:"h-4 w-4 text-primary"}),e.jsxs(gt,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[e.jsx("strong",{className:"text-primary",children:""}),""]}),e.jsx(_,{variant:"outline",size:"sm",className:"ml-4 shrink-0",children:""})]})]}),e.jsxs(Yt,{defaultValue:"models",className:"w-full",children:[e.jsxs(Vt,{className:"grid w-full max-w-full sm:max-w-md grid-cols-2",children:[e.jsx(Ye,{value:"models",children:""}),e.jsx(Ye,{value:"tasks","data-tour":"tasks-tab-trigger",children:""})]}),e.jsxs(Ms,{value:"models",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[D.size>0&&e.jsxs(_,{onClick:Jt,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(us,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",D.size,")"]}),e.jsxs(_,{onClick:()=>os(null,null),size:"sm",variant:"outline",className:"w-full sm:w-auto","data-tour":"add-model-button",children:[e.jsx(at,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:ge,onChange:le=>pe(le.target.value),className:"pl-9"})]}),ge&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Xe.length," "]})]}),e.jsx(g4,{paginatedModels:is,allModels:a,onEdit:os,onDelete:Tt,isModelUsed:Ps,searchQuery:ge}),e.jsx(j4,{paginatedModels:is,allModels:a,filteredModels:Xe,selectedModels:D,onEdit:os,onDelete:Tt,onToggleSelection:ka,onToggleSelectAll:Pa,isModelUsed:Ps,searchQuery:ge}),e.jsx(b4,{page:Q,pageSize:he,totalItems:Xe.length,jumpToPage:V,onPageChange:_e,onPageSizeChange:Te,onJumpToPageChange:$,onJumpToPage:kt,onSelectionClear:()=>K(new Set)})]}),e.jsxs(Ms,{value:"tasks",className:"space-y-6 mt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),p&&e.jsxs("div",{className:"grid gap-4 sm:gap-6",children:[e.jsx(Dl,{title:" (utils)",description:"",taskConfig:p.utils,modelNames:h,onChange:(le,fe)=>ye("utils",le,fe),dataTour:"task-model-select"}),e.jsx(Dl,{title:" (tool_use)",description:"",taskConfig:p.tool_use,modelNames:h,onChange:(le,fe)=>ye("tool_use",le,fe)}),e.jsx(Dl,{title:" (replyer)",description:"",taskConfig:p.replyer,modelNames:h,onChange:(le,fe)=>ye("replyer",le,fe)}),e.jsx(Dl,{title:" (planner)",description:"",taskConfig:p.planner,modelNames:h,onChange:(le,fe)=>ye("planner",le,fe)}),e.jsx(Dl,{title:" (vlm)",description:"",taskConfig:p.vlm,modelNames:h,onChange:(le,fe)=>ye("vlm",le,fe),hideTemperature:!0}),e.jsx(Dl,{title:" (voice)",description:"",taskConfig:p.voice,modelNames:h,onChange:(le,fe)=>ye("voice",le,fe),hideTemperature:!0,hideMaxTokens:!0}),e.jsx(Dl,{title:" (embedding)",description:"",taskConfig:p.embedding,modelNames:h,onChange:(le,fe)=>ye("embedding",le,fe),hideTemperature:!0,hideMaxTokens:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsx(Dl,{title:" (lpmm_entity_extract)",description:"",taskConfig:p.lpmm_entity_extract,modelNames:h,onChange:(le,fe)=>ye("lpmm_entity_extract",le,fe)}),e.jsx(Dl,{title:"RDF  (lpmm_rdf_build)",description:"",taskConfig:p.lpmm_rdf_build,modelNames:h,onChange:(le,fe)=>ye("lpmm_rdf_build",le,fe)})]})]})]})]}),e.jsx(Js,{open:P,onOpenChange:ht,children:e.jsxs(qs,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"model-dialog",preventOutsideClose:fa,children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:H!==null?"":""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"model-name-input",children:[e.jsx(T,{htmlFor:"model_name",className:Ee.name?"text-destructive":"",children:" *"}),e.jsx(ne,{id:"model_name",value:C?.name||"",onChange:le=>{R(fe=>fe?{...fe,name:le.target.value}:null),Ee.name&&de(fe=>({...fe,name:void 0}))},placeholder:": qwen3-30b",className:Ee.name?"border-destructive focus-visible:ring-destructive":""}),Ee.name?e.jsx("p",{className:"text-xs text-destructive",children:Ee.name}):e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-provider-select",children:[e.jsx(T,{htmlFor:"api_provider",className:Ee.api_provider?"text-destructive":"",children:"API  *"}),e.jsxs(Pe,{value:C?.api_provider||"",onValueChange:le=>{R(fe=>fe?{...fe,api_provider:le}:null),Ks(),Ee.api_provider&&de(fe=>({...fe,api_provider:void 0}))},children:[e.jsx(Be,{id:"api_provider",className:Ee.api_provider?"border-destructive focus-visible:ring-destructive":"",children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:r.map(le=>e.jsx(ee,{value:le,children:le},le))})]}),Ee.api_provider&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.api_provider})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-identifier-input",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"model_identifier",className:Ee.model_identifier?"text-destructive":"",children:" *"}),zs?.modelFetcher&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{variant:"secondary",className:"text-xs",children:zs.display_name}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>C?.api_provider&&Ls(C.api_provider,!0),disabled:Ts,children:Ts?e.jsx(Fs,{className:"h-3 w-3 animate-spin"}):e.jsx(ut,{className:"h-3 w-3"})})]})]}),zs?.modelFetcher?e.jsxs(hl,{open:z,onOpenChange:G,children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":z,className:"w-full justify-between font-normal",disabled:Ts||!!He,children:[Ts?e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Fs,{className:"h-4 w-4 animate-spin"}),"..."]}):He?e.jsx("span",{className:"text-muted-foreground text-sm",children:""}):C?.model_identifier?e.jsx("span",{className:"truncate",children:C.model_identifier}):e.jsx("span",{className:"text-muted-foreground",children:"..."}),e.jsx(cx,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(nl,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(dd,{children:[e.jsx(ud,{placeholder:"..."}),e.jsx(ss,{className:"h-[300px]",children:e.jsxs(md,{className:"max-h-none overflow-visible",children:[e.jsx(xd,{children:He?e.jsxs("div",{className:"py-4 px-2 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:He}),!He.includes("API Key")&&e.jsx(_,{variant:"link",size:"sm",onClick:()=>C?.api_provider&&Ls(C.api_provider,!0),children:""})]}):""}),e.jsx(oc,{heading:"",children:Ze.map(le=>e.jsxs(dc,{value:le.id,onSelect:()=>{R(fe=>fe?{...fe,model_identifier:le.id}:null),G(!1)},children:[e.jsx(Lt,{className:`mr-2 h-4 w-4 ${C?.model_identifier===le.id?"opacity-100":"opacity-0"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:le.id}),le.name!==le.id&&e.jsx("span",{className:"text-xs text-muted-foreground",children:le.name})]})]},le.id))}),e.jsx(oc,{heading:"",children:e.jsxs(dc,{value:"__manual_input__",onSelect:()=>{G(!1)},children:[e.jsx(Jn,{className:"mr-2 h-4 w-4"}),"..."]})})]})})]})})]}):e.jsx(ne,{id:"model_identifier",value:C?.model_identifier||"",onChange:le=>{R(fe=>fe?{...fe,model_identifier:le.target.value}:null),Ee.model_identifier&&de(fe=>({...fe,model_identifier:void 0}))},placeholder:"Qwen/Qwen3-30B-A3B-Instruct-2507",className:Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}),Ee.model_identifier&&e.jsx("p",{className:"text-xs text-destructive",children:Ee.model_identifier}),He&&zs?.modelFetcher&&!Ee.model_identifier&&e.jsxs(pt,{variant:"destructive",className:"mt-2 py-2",children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx(gt,{className:"text-xs",children:He})]}),zs?.modelFetcher&&e.jsx(ne,{value:C?.model_identifier||"",onChange:le=>{R(fe=>fe?{...fe,model_identifier:le.target.value}:null),Ee.model_identifier&&de(fe=>({...fe,model_identifier:void 0}))},placeholder:"",className:`mt-2 ${Ee.model_identifier?"border-destructive focus-visible:ring-destructive":""}`}),!Ee.model_identifier&&e.jsx("p",{className:"text-xs text-muted-foreground",children:He?'"" API Key':zs?.modelFetcher?` ${zs.display_name}`:"API  ID"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_in",children:" (/M token)"}),e.jsx(ne,{id:"price_in",type:"number",step:"0.1",min:"0",value:C?.price_in??"",onChange:le=>{const fe=le.target.value===""?null:parseFloat(le.target.value);R(es=>es?{...es,price_in:fe}:null)},placeholder:": 0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"price_out",children:" (/M token)"}),e.jsx(ne,{id:"price_out",type:"number",step:"0.1",min:"0",value:C?.price_out??"",onChange:le=>{const fe=le.target.value===""?null:parseFloat(le.target.value);R(es=>es?{...es,price_out:fe}:null)},placeholder:": 0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_temperature",className:"cursor-pointer",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"enable_model_temperature",checked:C?.temperature!=null,onCheckedChange:le=>{R(le?fe=>fe?{...fe,temperature:.5}:null:fe=>fe?{...fe,temperature:null}:null)}})]}),C?.temperature!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:""}),e.jsx("span",{className:"text-sm font-medium tabular-nums",children:C.temperature.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"0"}),e.jsx(Wa,{value:[C.temperature],onValueChange:le=>R(fe=>fe?{...fe,temperature:le[0]}:null),min:0,max:1,step:.1,className:"flex-1"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.1-0.30.7-1.0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"enable_model_max_tokens",className:"cursor-pointer",children:" Token"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Token "})]}),e.jsx(Ge,{id:"enable_model_max_tokens",checked:C?.max_tokens!=null,onCheckedChange:le=>{R(le?fe=>fe?{...fe,max_tokens:2048}:null:fe=>fe?{...fe,max_tokens:null}:null)}})]}),C?.max_tokens!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{className:"text-sm",children:" Token "}),e.jsx(ne,{type:"number",min:"1",max:"128000",value:C.max_tokens,onChange:le=>{const fe=parseInt(le.target.value);!isNaN(fe)&&fe>=1&&R(es=>es?{...es,max_tokens:fe}:null)},className:"w-28 h-8 text-sm"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" token "})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"force_stream_mode",checked:C?.force_stream_mode||!1,onCheckedChange:le=>R(fe=>fe?{...fe,force_stream_mode:le}:null)}),e.jsx(T,{htmlFor:"force_stream_mode",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(_,{type:"button",variant:"outline",size:"sm",className:"flex-1 justify-start h-9",onClick:()=>L(!0),children:[e.jsx(bn,{className:"h-4 w-4 mr-2"}),Object.keys(C?.extra_params||{}).length>0?e.jsxs("span",{children:[" ",Object.keys(C?.extra_params||{}).length," "]}):e.jsx("span",{className:"text-muted-foreground",children:""})]})}),Object.keys(C?.extra_params||{}).length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:[Object.keys(C?.extra_params||{}).slice(0,3).map(le=>e.jsx("span",{className:"inline-block mr-2",children:e.jsx("code",{className:"px-1.5 py-0.5 bg-muted rounded",children:le})},le)),Object.keys(C?.extra_params||{}).length>3&&e.jsx("span",{children:"..."})]})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>E(!1),"data-tour":"model-cancel-button",children:""}),e.jsx(_,{onClick:rs,"data-tour":"model-save-button",children:""})]})]})}),e.jsx(Cs,{open:me,onOpenChange:Ne,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',je!==null?a[je]?.name:"",'"  ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:ca,children:""})]})]})}),e.jsx(Cs,{open:B,onOpenChange:ue,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",D.size,"  "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:te,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Cs,{open:Re,onOpenChange:se,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsxs(vs,{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"h-5 w-5 text-amber-500"}),""]}),e.jsx(Ns,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-foreground",children:""}),""]}),e.jsxs("ul",{className:"space-y-2 ml-4 list-disc text-muted-foreground",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"text-foreground font-medium",children:""})]})})]}),e.jsxs(js,{children:[e.jsx(ys,{onClick:Me,children:""}),e.jsx(bs,{onClick:U,className:"bg-amber-600 hover:bg-amber-700",children:""})]})]})}),e.jsx(l4,{open:X,onOpenChange:L,value:C?.extra_params||{},onChange:le=>R(fe=>fe?{...fe,extra_params:le}:null)}),e.jsx(ar,{})]})})}const uc=Sj,mc=kw,xc=Cw,hd="/api/webui/config";async function C4(){const l=await(await Se(`${hd}/adapter-config/path`)).json();return!l.success||!l.path?null:{path:l.path,lastModified:l.lastModified}}async function Qg(a){const r=await(await Se(`${hd}/adapter-config/path`,{method:"POST",headers:Ws(),body:JSON.stringify({path:a})})).json();if(!r.success)throw new Error(r.message||"")}async function Yg(a){const r=await(await Se(`${hd}/adapter-config?path=${encodeURIComponent(a)}`)).json();if(!r.success)throw new Error("");return r.content}async function Jg(a,l){const c=await(await Se(`${hd}/adapter-config`,{method:"POST",headers:Ws(),body:JSON.stringify({path:a,content:l})})).json();if(!c.success)throw new Error(c.message||"")}const At={inner:{version:"0.1.2"},nickname:{nickname:""},napcat_server:{host:"localhost",port:8095,token:"",heartbeat_interval:30},maibot_server:{host:"localhost",port:8e3},chat:{group_list_type:"whitelist",group_list:[],private_list_type:"whitelist",private_list:[],ban_user_id:[],ban_qq_bot:!1,enable_poke:!0},voice:{use_tts:!1},debug:{level:"INFO"}},Pm={oneclick:{name:"",description:"",path:"../MaiBot-Napcat-Adapter/config.toml",icon:ua},docker:{name:"Docker",description:"Docker Compose ",path:"/MaiMBot/adapters-config/config.toml",icon:R1}};function Fm(a){try{const l=Nx(a);return{inner:{...At.inner,...l.inner},nickname:{...At.nickname,...l.nickname},napcat_server:{...At.napcat_server,...l.napcat_server},maibot_server:{...At.maibot_server,...l.maibot_server},chat:{...At.chat,...l.chat},voice:{...At.voice,...l.voice},debug:{...At.debug,...l.debug}}}catch(l){throw console.error("TOML :",l),new Error(` TOML : ${l instanceof Error?l.message:""}`)}}function Hm(a){try{const l=(d,m)=>d===""||d===null||d===void 0?m:d,r={inner:{version:l(a.inner.version,At.inner.version)},nickname:{nickname:l(a.nickname.nickname,At.nickname.nickname)},napcat_server:{host:l(a.napcat_server.host,At.napcat_server.host),port:l(a.napcat_server.port||0,At.napcat_server.port),token:l(a.napcat_server.token,At.napcat_server.token),heartbeat_interval:l(a.napcat_server.heartbeat_interval||0,At.napcat_server.heartbeat_interval)},maibot_server:{host:l(a.maibot_server.host,At.maibot_server.host),port:l(a.maibot_server.port||0,At.maibot_server.port)},chat:{group_list_type:l(a.chat.group_list_type,At.chat.group_list_type),group_list:a.chat.group_list||[],private_list_type:l(a.chat.private_list_type,At.chat.private_list_type),private_list:a.chat.private_list||[],ban_user_id:a.chat.ban_user_id||[],ban_qq_bot:a.chat.ban_qq_bot??At.chat.ban_qq_bot,enable_poke:a.chat.enable_poke??At.chat.enable_poke},voice:{use_tts:a.voice.use_tts??At.voice.use_tts},debug:{level:l(a.debug.level,At.debug.level)}};let c=BS(r);return c=T4(c),c}catch(l){throw console.error("TOML :",l),new Error(` TOML : ${l instanceof Error?l.message:""}`)}}function T4(a){const l=a.split(`
`),r=[];for(let c=0;c<l.length;c++){const d=l[c];if(d==="[inner]"){r.push(d);continue}if(d.startsWith("version = ")){r.push(`${d} # `),r.push("# ");continue}if(d==="[nickname]"){r.push("[nickname] # ");continue}if(d==="[napcat_server]"){r.push("[napcat_server] # Napcatws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[napcat_server]")){r.push(`${d}      # Napcat`);continue}if(d.startsWith("port = ")&&l[c-1]?.includes("host")){r.push(`${d}             # Napcat`);continue}if(d.startsWith("token = ")){r.push(`${d}              # Napcat`);continue}if(d.startsWith("heartbeat_interval = ")){r.push(`${d} # Napcat`);continue}if(d==="[maibot_server]"){r.push("[maibot_server] # ws");continue}if(d.startsWith("host = ")&&r[r.length-1]?.includes("[maibot_server]")){r.push(`${d} # .envHOST`);continue}if(d.startsWith("port = ")&&r[r.length-1]?.includes(".env")){r.push(`${d}        # .envPORT`);continue}if(d==="[chat]"){r.push("[chat] # ");continue}if(d.startsWith("group_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("group_list = ")){r.push(`${d}               # `),r.push("# group_list_typewhitelist"),r.push("# group_list_typeblacklist");continue}if(d.startsWith("private_list_type = ")){r.push(`${d} # whitelist, blacklist`);continue}if(d.startsWith("private_list = ")){r.push(`${d}               # `),r.push("# private_list_typewhitelist"),r.push("# private_list_typeblacklist");continue}if(d.startsWith("ban_user_id = ")){r.push(`${d}   # `);continue}if(d.startsWith("ban_qq_bot = ")){r.push(`${d} # QQ`);continue}if(d.startsWith("enable_poke = ")){r.push(`${d} # `);continue}if(d==="[voice]"){r.push("[voice] # ");continue}if(d.startsWith("use_tts = ")){r.push(`${d} # ttsttsadapter`);continue}if(d.startsWith("level = ")&&r[r.length-1]==="[debug]"){r.push(`${d} # DEBUG, INFO, WARNING, ERROR, CRITICAL`);continue}r.push(d)}return r.join(`
`)}function qm(a){if(!a.trim())return{valid:!1,error:""};if(!a.toLowerCase().endsWith(".toml"))return{valid:!1,error:" .toml "};const l=/^([a-zA-Z]:\\|\\\\[^\\]+\\[^\\]+\\).+\.toml$/i,r=/^(\/|~\/).+\.toml$/i,c=/^(\.{1,2}[\\/]|[^:\\/]).+\.toml$/i,d=l.test(a),m=r.test(a),h=c.test(a);return!d&&!m&&!h?{valid:!1,error:""}:/[<>"|?*\x00-\x1F]/.test(a)?{valid:!1,error:""}:{valid:!0,error:""}}function E4(){const[a,l]=u.useState("upload"),[r,c]=u.useState(null),[d,m]=u.useState(""),[h,f]=u.useState(""),[p,g]=u.useState("oneclick"),[N,j]=u.useState(""),[y,b]=u.useState(!1),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[P,E]=u.useState(!1),[C,R]=u.useState(null),[H,O]=u.useState(!1),X=u.useRef(null),{toast:L}=it(),me=u.useRef(null),Ne=z=>{if(f(z),z.trim()){const G=qm(z);j(G.error)}else j("")},je=u.useCallback(async z=>{const G=Pm[z];A(!0);try{const Re=await Yg(G.path),se=Fm(Re);c(se),g(z),f(G.path),await Qg(G.path),L({title:"",description:`${G.name}`})}catch(Re){console.error(":",Re),L({title:"",description:Re instanceof Error?Re.message:"",variant:"destructive"})}finally{A(!1)}},[L]),ce=u.useCallback(async z=>{const G=qm(z);if(!G.valid){j(G.error),L({title:"",description:G.error,variant:"destructive"});return}j(""),A(!0);try{const Re=await Yg(z),se=Fm(Re);c(se),f(z),await Qg(z),L({title:"",description:""})}catch(Re){console.error(":",Re),L({title:"",description:Re instanceof Error?Re.message:"",variant:"destructive"})}finally{A(!1)}},[L]);u.useEffect(()=>{(async()=>{try{const G=await C4();if(G&&G.path){f(G.path);const Re=Object.entries(Pm).find(([,se])=>se.path===G.path);Re?(l("preset"),g(Re[0]),await je(Re[0])):(l("path"),await ce(G.path))}}catch(G){console.error(":",G)}})()},[ce,je]);const ge=u.useCallback(z=>{a!=="path"&&a!=="preset"||!h||(me.current&&clearTimeout(me.current),me.current=setTimeout(async()=>{b(!0);try{const G=Hm(z);await Jg(h,G),L({title:"",description:""})}catch(G){console.error(":",G),L({title:"",description:G instanceof Error?G.message:"",variant:"destructive"})}finally{b(!1)}},1e3))},[a,h,L]),pe=async()=>{if(!r||!h)return;const z=qm(h);if(!z.valid){L({title:"",description:z.error,variant:"destructive"});return}b(!0);try{const G=Hm(r);await Jg(h,G),L({title:"",description:""})}catch(G){console.error(":",G),L({title:"",description:G instanceof Error?G.message:"",variant:"destructive"})}finally{b(!1)}},D=async()=>{h&&await ce(h)},K=z=>{if(z!==a){if(r){R(z),S(!0);return}B(z)}},B=z=>{c(null),m(""),j(""),l(z),z==="preset"&&je("oneclick"),L({title:"",description:{upload:"",path:"",preset:""}[z]})},ue=()=>{C&&(B(C),R(null)),S(!1)},Q=()=>{if(r){E(!0);return}_e()},_e=()=>{f(""),c(null),j(""),L({title:"",description:""})},he=()=>{_e(),E(!1)},Te=z=>{const G=z.target.files?.[0];if(!G)return;const Re=new FileReader;Re.onload=se=>{try{const Oe=se.target?.result,ns=Fm(Oe);c(ns),m(G.name),L({title:"",description:`${G.name}`})}catch(Oe){console.error(":",Oe),L({title:"",description:"",variant:"destructive"})}},Re.readAsText(G)},V=()=>{if(!r)return;const z=Hm(r),G=new Blob([z],{type:"text/plain;charset=utf-8"}),Re=URL.createObjectURL(G),se=document.createElement("a");se.href=Re,se.download=d||"config.toml",document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(Re),L({title:"",description:""})},$=()=>{c(JSON.parse(JSON.stringify(At))),m("config.toml"),L({title:"",description:""})};return e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" QQ "})]})}),e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg border border-amber-500/50 bg-amber-500/10 text-amber-700 dark:text-amber-400",children:[e.jsx(Rt,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:" WebUI "})]}),e.jsx(uc,{open:H,onOpenChange:O,children:e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx($a,{className:`h-4 w-4 transition-transform duration-200 ${H?"transform rotate-180":""}`}),e.jsx("span",{className:"sr-only",children:""})]})})]})}),e.jsx(xc,{children:e.jsxs(Ae,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="preset"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>K("preset"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(ua,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="upload"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>K("upload"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(rc,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${a==="path"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>K("path"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(D1,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})})]}),a==="preset"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(Pm).map(([z,G])=>{const Re=G.icon,se=p===z;return e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-all ${se?"border-primary bg-primary/5":"border-muted hover:border-primary/50"}`,onClick:()=>{g(z),je(z)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Re,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:G.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:G.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 font-mono break-all",children:G.path})]})]})},z)})})]}),a==="path"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"config-path",className:"text-sm md:text-base",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(ne,{id:"config-path",value:h,onChange:z=>Ne(z.target.value),placeholder:": C:\\Adapter\\config.toml",className:`text-sm ${N?"border-destructive":""}`}),N&&e.jsx("p",{className:"text-xs text-destructive",children:N})]}),e.jsx(_,{onClick:()=>ce(h),disabled:w||!h||!!N,className:"w-full sm:w-auto",children:w?e.jsxs(e.Fragment,{children:[e.jsx(ut,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sm:hidden",children:""}),e.jsx("span",{className:"hidden sm:inline",children:""})]})})]})]}),e.jsxs("details",{className:"rounded-lg bg-muted/50 p-3 group",children:[e.jsxs("summary",{className:"text-xs font-medium cursor-pointer select-none list-none flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx("svg",{className:"h-4 w-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Windows"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"C:\\Adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"D:\\MaiBot\\adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"\\\\server\\share\\config.toml"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Linux"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"/opt/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"/home/user/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"~/adapter/config.toml"})]})]}),e.jsx("p",{className:"pt-1 border-t text-[10px] md:text-xs",children:"  1 "})]})]})]})]})})]})}),e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx(gt,{children:a==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]}):a==="upload"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""}),"      "]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]})})]}),a==="upload"&&!r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx("input",{ref:X,type:"file",accept:".toml",className:"hidden",onChange:Te}),e.jsxs(_,{onClick:()=>X.current?.click(),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(rc,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:$,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),""]})]}),a==="upload"&&r&&e.jsx("div",{className:"flex gap-2",children:e.jsxs(_,{onClick:V,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(na,{className:"mr-2 h-4 w-4"}),""]})}),(a==="preset"||a==="path")&&r&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(_,{onClick:pe,size:"sm",disabled:y||!!N,className:"w-full sm:w-auto",children:[e.jsx(fc,{className:"mr-2 h-4 w-4"}),y?"...":""]}),e.jsxs(_,{onClick:D,size:"sm",variant:"outline",disabled:w,className:"w-full sm:w-auto",children:[e.jsx(ut,{className:`mr-2 h-4 w-4 ${w?"animate-spin":""}`}),""]}),a==="path"&&e.jsxs(_,{onClick:Q,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(us,{className:"mr-2 h-4 w-4"}),""]})]}),r?e.jsxs(Yt,{defaultValue:"napcat",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Vt,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:grid-cols-5",children:[e.jsxs(Ye,{value:"napcat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Napcat "}),e.jsx("span",{className:"sm:hidden",children:"Napcat"})]}),e.jsxs(Ye,{value:"maibot",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"chat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Ye,{value:"voice",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(Ye,{value:"debug",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:""})]})}),e.jsx(Ms,{value:"napcat",className:"space-y-4",children:e.jsx(M4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Ms,{value:"maibot",className:"space-y-4",children:e.jsx(A4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Ms,{value:"chat",className:"space-y-4",children:e.jsx(z4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Ms,{value:"voice",className:"space-y-4",children:e.jsx(R4,{config:r,onChange:z=>{c(z),ge(z)}})}),e.jsx(Ms,{value:"debug",className:"space-y-4",children:e.jsx(D4,{config:r,onChange:z=>{c(z),ge(z)}})})]}):e.jsx("div",{className:"rounded-lg border bg-card p-6 md:p-12",children:e.jsxs("div",{className:"text-center space-y-3 md:space-y-4",children:[e.jsx(La,{className:"h-12 w-12 md:h-16 md:w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-2 px-4",children:a==="preset"?"":a==="upload"?"":""})]})]})}),e.jsx(Cs,{open:M,onOpenChange:S,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-destructive font-medium",children:""})]})]}),e.jsxs(js,{children:[e.jsx(ys,{onClick:()=>{S(!1),R(null)},children:""}),e.jsx(bs,{onClick:ue,children:""})]})]})}),e.jsx(Cs,{open:P,onOpenChange:E,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground text-sm",children:""})]})]}),e.jsxs(js,{children:[e.jsx(ys,{onClick:()=>E(!1),children:""}),e.jsx(bs,{onClick:he,className:"bg-destructive hover:bg-destructive/90",children:""})]})]})})]})})}function M4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:"Napcat WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-host",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"napcat-host",value:a.napcat_server.host,onChange:r=>l({...a,napcat_server:{...a.napcat_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-port",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"napcat-port",type:"number",value:a.napcat_server.port||"",onChange:r=>l({...a,napcat_server:{...a.napcat_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8095",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat  8095"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-token",className:"text-sm md:text-base",children:"Token"}),e.jsx(ne,{id:"napcat-token",type:"password",value:a.napcat_server.token,onChange:r=>l({...a,napcat_server:{...a.napcat_server,token:r.target.value}}),placeholder:"",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"napcat-heartbeat",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"napcat-heartbeat",type:"number",value:a.napcat_server.heartbeat_interval||"",onChange:r=>l({...a,napcat_server:{...a.napcat_server,heartbeat_interval:r.target.value?parseInt(r.target.value):0}}),placeholder:"30",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Napcat  30"})]})]})]})})}function A4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:" WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-host",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"maibot-host",value:a.maibot_server.host,onChange:r=>l({...a,maibot_server:{...a.maibot_server,host:r.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  HOST "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"maibot-port",className:"text-sm md:text-base",children:""}),e.jsx(ne,{id:"maibot-port",type:"number",value:a.maibot_server.port||"",onChange:r=>l({...a,maibot_server:{...a.maibot_server,port:r.target.value?parseInt(r.target.value):0}}),placeholder:"8000",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  PORT  8000"})]})]})]})})}function z4({config:a,onChange:l}){const r=m=>{const h={...a};m==="group"?h.chat.group_list=[...h.chat.group_list,0]:m==="private"?h.chat.private_list=[...h.chat.private_list,0]:h.chat.ban_user_id=[...h.chat.ban_user_id,0],l(h)},c=(m,h)=>{const f={...a};m==="group"?f.chat.group_list=f.chat.group_list.filter((p,g)=>g!==h):m==="private"?f.chat.private_list=f.chat.private_list.filter((p,g)=>g!==h):f.chat.ban_user_id=f.chat.ban_user_id.filter((p,g)=>g!==h),l(f)},d=(m,h,f)=>{const p={...a};m==="group"?p.chat.group_list[h]=f:m==="private"?p.chat.private_list[h]=f:p.chat.ban_user_id[h]=f,l(p)};return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"grid gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.chat.group_list_type,onValueChange:m=>l({...a,chat:{...a.chat,group_list_type:m}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"whitelist",children:""}),e.jsx(ee,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("group"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.group_list.map((m,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{type:"number",value:m,onChange:f=>d("group",h,parseInt(f.target.value)||0),placeholder:"",className:"text-sm md:text-base"}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",m," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>c("group",h),children:""})]})]})]})]},h)),a.chat.group_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.chat.private_list_type,onValueChange:m=>l({...a,chat:{...a.chat,private_list_type:m}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"whitelist",children:""}),e.jsx(ee,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>r("private"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.private_list.map((m,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{type:"number",value:m,onChange:f=>d("private",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",m," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>c("private",h),children:""})]})]})]})]},h)),a.chat.private_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>r("ban"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(La,{className:"mr-1 h-4 w-4"}),""]})]}),a.chat.ban_user_id.map((m,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{type:"number",value:m,onChange:f=>d("ban",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(Cs,{children:[e.jsx(_t,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",m," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>c("ban",h),children:""})]})]})]})]},h)),a.chat.ban_user_id.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:"QQ"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"QQ"})]}),e.jsx(Ge,{checked:a.chat.ban_qq_bot,onCheckedChange:m=>l({...a,chat:{...a.chat,ban_qq_bot:m}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Ge,{checked:a.chat.enable_poke,onCheckedChange:m=>l({...a,chat:{...a.chat,enable_poke:m}})})]})]})]})})}function R4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-sm md:text-base",children:" TTS "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" TTS "})]}),e.jsx(Ge,{checked:a.voice.use_tts,onCheckedChange:r=>l({...a,voice:{use_tts:r}})})]})]})})}function D4({config:a,onChange:l}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{className:"text-sm md:text-base",children:""}),e.jsxs(Pe,{value:a.debug.level,onValueChange:r=>l({...a,debug:{level:r}}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"DEBUG",children:"DEBUG"}),e.jsx(ee,{value:"INFO",children:"INFO"}),e.jsx(ee,{value:"WARNING",children:"WARNING"}),e.jsx(ee,{value:"ERROR",children:"ERROR"}),e.jsx(ee,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})})]})})}const O4=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],L4=/^(aria-|data-)/,aN=a=>Object.fromEntries(Object.entries(a).filter(([l])=>L4.test(l)||O4.includes(l)));function U4(a,l){const r=aN(a);return Object.keys(a).some(c=>!Object.hasOwn(r,c)&&a[c]!==l[c])}class $4 extends u.Component{container;plugin;componentDidMount(){this.installPlugin()}componentDidUpdate(l){if(l.uppy!==this.props.uppy)this.uninstallPlugin(l),this.installPlugin();else if(U4(this.props,l)){const{uppy:r,...c}={...this.props,target:this.container};this.plugin.setOptions(c)}}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{uppy:l,...r}={id:"Dashboard",...this.props,inline:!0,target:this.container};l.use(x_,r),this.plugin=l.getPlugin(r.id)}uninstallPlugin(l=this.props){const{uppy:r}=l;r.removePlugin(this.plugin)}render(){return u.createElement("div",{className:"uppy-Container",ref:l=>{this.container=l},...aN(this.props)})}}function B4({src:a,alt:l="",className:r,maxRetries:c=5,retryInterval:d=1500}){const[m,h]=u.useState("loading"),[f,p]=u.useState(0),[g,N]=u.useState(null),[j,y]=u.useState(a);a!==j&&(h("loading"),p(0),N(null),y(a));const b=u.useCallback(async()=>{try{const w=await fetch(a,{credentials:"include"});if(w.status===202){h("generating"),f<c?setTimeout(()=>{p(S=>S+1)},d):h("error");return}if(!w.ok){h("error");return}const A=await w.blob(),M=URL.createObjectURL(A);N(M),h("loaded")}catch(w){console.error(":",w),h("error")}},[a,f,c,d]);return u.useEffect(()=>{b()},[b]),u.useEffect(()=>()=>{g&&URL.revokeObjectURL(g)},[g]),m==="loading"||m==="generating"?e.jsx(As,{className:F("w-full h-full",r)}):m==="error"||!g?e.jsx("div",{className:F("w-full h-full flex items-center justify-center bg-muted",r),children:e.jsx(ox,{className:"h-8 w-8 text-muted-foreground"})}):e.jsx("img",{src:g,alt:l,className:F("w-full h-full object-contain",r)})}function I4({children:a,className:l}){return e.jsx(gx,{content:a,className:l})}const sl="/api/webui/emoji";async function P4(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.is_registered!==void 0&&l.append("is_registered",a.is_registered.toString()),a.is_banned!==void 0&&l.append("is_banned",a.is_banned.toString()),a.format&&l.append("format",a.format),a.sort_by&&l.append("sort_by",a.sort_by),a.sort_order&&l.append("sort_order",a.sort_order);const r=await Se(`${sl}/list?${l}`,{});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function F4(a){const l=await Se(`${sl}/${a}`,{});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function H4(a,l){const r=await Se(`${sl}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok)throw new Error(`: ${r.statusText}`);return r.json()}async function q4(a){const l=await Se(`${sl}/${a}`,{method:"DELETE"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function V4(){const a=await Se(`${sl}/stats/summary`,{});if(!a.ok)throw new Error(`: ${a.statusText}`);return a.json()}async function G4(a){const l=await Se(`${sl}/${a}/register`,{method:"POST"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function K4(a){const l=await Se(`${sl}/${a}/ban`,{method:"POST"});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}function Q4(a,l=!1){return l?`${sl}/${a}/thumbnail?original=true`:`${sl}/${a}/thumbnail`}function Y4(a){return`${sl}/${a}/thumbnail?original=true`}async function J4(a){const l=await Se(`${sl}/batch/delete`,{method:"POST",body:JSON.stringify({emoji_ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function X4(){return`${sl}/upload`}function Z4(){const[a,l]=u.useState([]),[r,c]=u.useState(null),[d,m]=u.useState(!1),[h,f]=u.useState(1),[p,g]=u.useState(0),[N,j]=u.useState(20),[y,b]=u.useState("all"),[w,A]=u.useState("all"),[M,S]=u.useState("all"),[P,E]=u.useState("usage_count"),[C,R]=u.useState("desc"),[H,O]=u.useState(null),[X,L]=u.useState(!1),[me,Ne]=u.useState(!1),[je,ce]=u.useState(!1),[ge,pe]=u.useState(new Set),[D,K]=u.useState(!1),[B,ue]=u.useState(""),[Q,_e]=u.useState("medium"),[he,Te]=u.useState(!1),{toast:V}=it(),$=u.useCallback(async()=>{try{m(!0);const de=await P4({page:h,page_size:N,is_registered:y==="all"?void 0:y==="registered",is_banned:w==="all"?void 0:w==="banned",format:M==="all"?void 0:M,sort_by:P,sort_order:C});l(de.data),g(de.total)}catch(de){const ze=de instanceof Error?de.message:"";V({title:"",description:ze,variant:"destructive"})}finally{m(!1)}},[h,N,y,w,M,P,C,V]),z=async()=>{try{const de=await V4();c(de.data)}catch(de){console.error(":",de)}};u.useEffect(()=>{$()},[$]),u.useEffect(()=>{z()},[]);const G=async de=>{try{const ze=await F4(de.id);O(ze.data),L(!0)}catch(ze){const ws=ze instanceof Error?ze.message:"";V({title:"",description:ws,variant:"destructive"})}},Re=de=>{O(de),Ne(!0)},se=de=>{O(de),ce(!0)},Oe=async()=>{if(H)try{await q4(H.id),V({title:"",description:""}),ce(!1),O(null),$(),z()}catch(de){const ze=de instanceof Error?de.message:"";V({title:"",description:ze,variant:"destructive"})}},ns=async de=>{try{await G4(de.id),V({title:"",description:""}),$(),z()}catch(ze){const ws=ze instanceof Error?ze.message:"";V({title:"",description:ws,variant:"destructive"})}},J=async de=>{try{await K4(de.id),V({title:"",description:""}),$(),z()}catch(ze){const ws=ze instanceof Error?ze.message:"";V({title:"",description:ws,variant:"destructive"})}},Z=de=>{const ze=new Set(ge);ze.has(de)?ze.delete(de):ze.add(de),pe(ze)},Le=async()=>{try{const de=await J4(Array.from(ge));V({title:"",description:de.message}),pe(new Set),K(!1),$(),z()}catch(de){V({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}},ae=()=>{const de=parseInt(B),ze=Math.ceil(p/N);de>=1&&de<=ze?(f(de),ue("")):V({title:"",description:`1-${ze}`,variant:"destructive"})},Ee=r?.formats?Object.keys(r.formats):[];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>Te(!0),className:"gap-2",children:[e.jsx(rc,{className:"h-4 w-4"}),""]})]}),e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[r&&e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(fs,{children:""}),e.jsx(Ue,{className:"text-2xl",children:r.total})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(fs,{children:""}),e.jsx(Ue,{className:"text-2xl text-green-600",children:r.registered})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(fs,{children:""}),e.jsx(Ue,{className:"text-2xl text-red-600",children:r.banned})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(fs,{children:""}),e.jsx(Ue,{className:"text-2xl text-gray-600",children:r.unregistered})]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx(Bo,{className:"h-5 w-5"}),""]})}),e.jsxs(Ae,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:`${P}-${C}`,onValueChange:de=>{const[ze,ws]=de.split("-");E(ze),R(ws),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"usage_count-desc",children:" ()"}),e.jsx(ee,{value:"usage_count-asc",children:" ()"}),e.jsx(ee,{value:"register_time-desc",children:" ()"}),e.jsx(ee,{value:"register_time-asc",children:" ()"}),e.jsx(ee,{value:"record_time-desc",children:" ()"}),e.jsx(ee,{value:"record_time-asc",children:" ()"}),e.jsx(ee,{value:"last_used_time-desc",children:" ()"}),e.jsx(ee,{value:"last_used_time-asc",children:" ()"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:y,onValueChange:de=>{b(de),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),e.jsx(ee,{value:"registered",children:""}),e.jsx(ee,{value:"unregistered",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:w,onValueChange:de=>{A(de),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),e.jsx(ee,{value:"banned",children:""}),e.jsx(ee,{value:"unbanned",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:M,onValueChange:de=>{S(de),f(1)},children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),Ee.map(de=>e.jsxs(ee,{value:de,children:[de.toUpperCase()," (",r?.formats[de],")"]},de))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[ge.size>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",ge.size," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:Q,onValueChange:de=>_e(de),children:[e.jsx(Be,{className:"w-24",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"small",children:""}),e.jsx(ee,{value:"medium",children:""}),e.jsx(ee,{value:"large",children:""})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"emoji-page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:N.toString(),onValueChange:de=>{j(parseInt(de)),f(1),pe(new Set)},children:[e.jsx(Be,{id:"emoji-page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"20",children:"20"}),e.jsx(ee,{value:"40",children:"40"}),e.jsx(ee,{value:"60",children:"60"}),e.jsx(ee,{value:"100",children:"100"})]})]}),ge.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>pe(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>K(!0),children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs(_,{variant:"outline",size:"sm",onClick:$,disabled:d,children:[e.jsx(ut,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsxs(fs,{children:[" ",p,"  ",h," "]})]}),e.jsxs(Ae,{children:[a.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""}):e.jsx("div",{className:`grid gap-3 ${Q==="small"?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10":Q==="medium"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8":"grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"}`,children:a.map(de=>e.jsxs("div",{className:`group relative rounded-lg border bg-card overflow-hidden hover:ring-2 hover:ring-primary transition-all cursor-pointer ${ge.has(de.id)?"ring-2 ring-primary bg-primary/5":""}`,onClick:()=>Z(de.id),children:[e.jsx("div",{className:`absolute top-1 left-1 z-10 transition-opacity ${ge.has(de.id)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${ge.has(de.id)?"bg-primary border-primary text-primary-foreground":"bg-background/80 border-muted-foreground/50"}`,children:ge.has(de.id)&&e.jsx(tt,{className:"h-3 w-3"})})}),e.jsxs("div",{className:"absolute top-1 right-1 z-10 flex flex-col gap-0.5",children:[de.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600 text-[10px] px-1 py-0",children:""}),de.is_banned&&e.jsx(ke,{variant:"destructive",className:"text-[10px] px-1 py-0",children:""})]}),e.jsx("div",{className:`aspect-square bg-muted flex items-center justify-center overflow-hidden ${Q==="small"?"p-1":Q==="medium"?"p-2":"p-3"}`,children:e.jsx(B4,{src:Q4(de.id),alt:""})}),e.jsxs("div",{className:`border-t bg-card ${Q==="small"?"p-1":"p-2"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-1 text-xs text-muted-foreground mb-1",children:[e.jsx(ke,{variant:"outline",className:"text-[10px] px-1 py-0",children:de.format.toUpperCase()}),e.jsxs("span",{className:"font-mono",children:[de.usage_count,""]})]}),e.jsxs("div",{className:`flex gap-1 justify-center opacity-0 group-hover:opacity-100 transition-opacity ${Q==="small"?"flex-wrap":""}`,children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:ze=>{ze.stopPropagation(),Re(de)},title:"",children:e.jsx(Wn,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:ze=>{ze.stopPropagation(),G(de)},title:"",children:e.jsx(Qt,{className:"h-3 w-3"})}),!de.is_registered&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-green-700",onClick:ze=>{ze.stopPropagation(),ns(de)},title:"",children:e.jsx(tt,{className:"h-3 w-3"})}),!de.is_banned&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-orange-600 hover:text-orange-700",onClick:ze=>{ze.stopPropagation(),J(de)},title:"",children:e.jsx(tv,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600 hover:text-red-700",onClick:ze=>{ze.stopPropagation(),se(de)},title:"",children:e.jsx(us,{className:"h-3 w-3"})})]})]})]},de.id))}),p>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(h-1)*N+1," "," ",Math.min(h*N,p),"  ",p," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(de=>Math.max(1,de-1)),disabled:h===1,children:[e.jsx(Ia,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:B,onChange:de=>ue(de.target.value),onKeyDown:de=>de.key==="Enter"&&ae(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(p/N)}),e.jsx(_,{variant:"outline",size:"sm",onClick:ae,disabled:!B,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(de=>de+1),disabled:h>=Math.ceil(p/N),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ra,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(p/N)),disabled:h>=Math.ceil(p/N),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(W4,{emoji:H,open:X,onOpenChange:L}),e.jsx(ek,{emoji:H,open:me,onOpenChange:Ne,onSuccess:()=>{$(),z()}}),e.jsx(sk,{open:he,onOpenChange:Te,onSuccess:()=>{$(),z()}})]})}),e.jsx(Cs,{open:D,onOpenChange:K,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",ge.size," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:Le,children:""})]})]})}),e.jsx(Js,{open:je,onOpenChange:ce,children:e.jsxs(qs,{children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>ce(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:Oe,children:""})]})]})})]})}function W4({emoji:a,open:l,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl max-h-[90vh]",children:[e.jsx(Vs,{children:e.jsx(Gs,{children:""})}),e.jsx(ss,{className:"max-h-[calc(90vh-8rem)] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:Y4(a.id),alt:a.description||"",className:"w-full h-full object-cover",onError:d=>{const m=d.target;m.style.display="none";const h=m.parentElement;h&&(h.innerHTML='<svg class="h-16 w-16 text-muted-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>')}})})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:"ID"}),e.jsx("div",{className:"mt-1 font-mono",children:a.id})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",children:a.format.toUpperCase()})})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.full_path})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:a.emoji_hash})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),a.description?e.jsx("div",{className:"mt-1 rounded-lg border bg-muted/50 p-3",children:e.jsx(I4,{className:"prose-sm",children:a.description})}):e.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:"-"})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:a.emotion?e.jsx("span",{className:"text-sm",children:a.emotion}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.is_registered&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),a.is_banned&&e.jsx(ke,{variant:"destructive",children:""}),!a.is_registered&&!a.is_banned&&e.jsx(ke,{variant:"outline",children:""})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-lg",children:a.usage_count})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.record_time)})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.register_time)})]})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(a.last_used_time)})]})]})})]})})}function ek({emoji:a,open:l,onOpenChange:r,onSuccess:c}){const[d,m]=u.useState(""),[h,f]=u.useState(!1),[p,g]=u.useState(!1),[N,j]=u.useState(!1),{toast:y}=it();u.useEffect(()=>{a&&(m(a.emotion||""),f(a.is_registered),g(a.is_banned))},[a]);const b=async()=>{if(a)try{j(!0);const w=d.split(/[,,]/).map(A=>A.trim()).filter(Boolean).join(",");await H4(a.id,{emotion:w||void 0,is_registered:h,is_banned:p}),y({title:"",description:""}),r(!1),c()}catch(w){const A=w instanceof Error?w.message:"";y({title:"",description:A,variant:"destructive"})}finally{j(!1)}};return a?e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(T,{children:""}),e.jsx(ft,{value:d,onChange:w=>m(w.target.value),placeholder:"...",rows:2,className:"mt-1"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"is_registered",checked:h,onCheckedChange:w=>{w===!0?(f(!0),g(!1)):f(!1)}}),e.jsx(T,{htmlFor:"is_registered",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"is_banned",checked:p,onCheckedChange:w=>{w===!0?(g(!0),f(!1)):g(!1)}}),e.jsx(T,{htmlFor:"is_banned",className:"cursor-pointer",children:""})]})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:b,disabled:N,children:N?"...":""})]})]})}):null}function sk({open:a,onOpenChange:l,onSuccess:r}){const[c,d]=u.useState("select"),[m,h]=u.useState([]),[f,p]=u.useState(null),[g,N]=u.useState(!1),{toast:j}=it(),y=u.useMemo(()=>new h_({id:"emoji-uploader",autoProceed:!1,restrictions:{maxFileSize:10485760,allowedFileTypes:["image/jpeg","image/png","image/gif","image/webp"],maxNumberOfFiles:20},locale:{pluralize:()=>0,strings:{addMoreFiles:"",addingMoreFiles:"",allowedFileTypes:"%{types}",cancel:"",closeModal:"",complete:"",connectedToInternet:"",copyLink:"",copyLinkToClipboardFallback:"",copyLinkToClipboardSuccess:"",dashboardTitle:"",dashboardWindowTitle:" ESC ",done:"",dropHereOr:" %{browse}",dropHint:"",dropPasteFiles:" %{browseFiles}",dropPasteFolders:" %{browseFolders}",dropPasteBoth:"%{browseFiles}  %{browseFolders}",dropPasteImportFiles:"%{browseFiles} ",dropPasteImportFolders:"%{browseFolders} ",dropPasteImportBoth:"%{browseFiles}%{browseFolders} ",editFile:"",editing:" %{file}",emptyFolderAdded:"",exceedsSize:"%{file}  %{size}",failedToUpload:" %{file} ",fileSource:"%{name}",filesUploadedOfTotal:{0:" %{complete} / %{smart_count} ",1:" %{complete} / %{smart_count} "},filter:"",finishEditingFile:"",folderAdded:{0:" %{folder}  %{smart_count} ",1:" %{folder}  %{smart_count} "},generatingThumbnails:"...",import:"",importFiles:"",importFrom:" %{name} ",loading:"...",logOut:"",myDevice:"",noFilesFound:"",noInternetConnection:"",openFolderNamed:" %{name}",pause:"",pauseUpload:"",paused:"",poweredBy:"%{uppy}",processingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},recording:"",removeFile:"",resetFilter:"",resume:"",resumeUpload:"",retry:"",retryUpload:"",save:"",saveChanges:"",selectFileNamed:" %{name}",selectX:{0:" %{smart_count}",1:" %{smart_count}"},smile:"",startRecording:"",stopRecording:"",takePicture:"",timedOut:" %{seconds} ",upload:"",uploadComplete:"",uploadFailed:"",uploadPaused:"",uploadXFiles:{0:"%{smart_count} ",1:"%{smart_count} "},uploadXNewFiles:{0:"+%{smart_count} ",1:"+%{smart_count} "},uploading:"",uploadingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},xFilesSelected:{0:" %{smart_count} ",1:" %{smart_count} "},xMoreFilesAdded:{0:" %{smart_count} ",1:" %{smart_count} "},xTimeLeft:" %{time}",youCanOnlyUploadFileTypes:"%{types}",youCanOnlyUploadX:{0:" %{smart_count} ",1:" %{smart_count} "},youHaveToAtLeastSelectX:{0:" %{smart_count} ",1:" %{smart_count} "},browseFiles:"",browseFolders:"",cancelUpload:"",addMore:"",back:"",editFileWithFilename:" %{file}"}}}),[]);u.useEffect(()=>{const H=()=>{const O=y.getFiles();if(O.length===0)return;const X=O.map(L=>({id:L.id,name:L.name,previewUrl:L.preview||URL.createObjectURL(L.data),emotion:"",description:"",isRegistered:!0,file:L.data}));h(X),O.length===1?(p(X[0].id),d("edit-single")):d("edit-multiple")};return y.on("upload",H),()=>{y.off("upload",H)}},[y]),u.useEffect(()=>{a||(y.cancelAll(),d("select"),h([]),p(null),N(!1))},[a,y]);const b=u.useCallback((H,O)=>{h(X=>X.map(L=>L.id===H?{...L,...O}:L))},[]),w=u.useCallback(H=>H.emotion.trim().length>0,[]),A=u.useMemo(()=>m.length>0&&m.every(w),[m,w]),M=u.useMemo(()=>m.find(H=>H.id===f)||null,[m,f]),S=u.useCallback(()=>{(c==="edit-single"||c==="edit-multiple")&&(d("select"),h([]),p(null))},[c]),P=u.useCallback(async()=>{if(!A){j({title:"",description:"",variant:"destructive"});return}N(!0);let H=0,O=0;try{for(const X of m){const L=new FormData;L.append("file",X.file),L.append("emotion",X.emotion),L.append("description",X.description),L.append("is_registered",X.isRegistered.toString());try{(await Se(X4(),{method:"POST",body:L})).ok?H++:O++}catch{O++}}O===0?(j({title:"",description:` ${H} `}),l(!1),r()):(j({title:"",description:` ${H}  ${O} `,variant:"destructive"}),r())}finally{N(!1)}},[A,m,j,l,r]),E=()=>e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"border rounded-lg overflow-hidden w-full",children:e.jsx($4,{uppy:y,proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!0,height:350,width:"100%",theme:"auto",note:" JPGPNGGIFWebP  20 "})})}),C=()=>{const H=m[0];return H?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ua,{className:"h-4 w-4 mr-1"}),""]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"w-32 h-32 rounded-lg border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:H.previewUrl,alt:H.name,className:"max-w-full max-h-full object-contain"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center truncate max-w-32",children:H.name})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"single-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"single-emotion",value:H.emotion,onChange:O=>b(H.id,{emotion:O.target.value}),placeholder:",",className:H.emotion.trim()?"":"border-destructive"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"single-description",children:""}),e.jsx(ne,{id:"single-description",value:H.description,onChange:O=>b(H.id,{description:O.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"single-is-registered",checked:H.isRegistered,onCheckedChange:O=>b(H.id,{isRegistered:O===!0})}),e.jsx(T,{htmlFor:"single-is-registered",className:"cursor-pointer",children:""})]})]})]}),e.jsx(xt,{children:e.jsx(_,{onClick:P,disabled:!A||g,children:g?"...":""})})]}):null},R=()=>{const H=m.filter(w).length,O=m.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ua,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["",H,"/",O," "]})]}),e.jsx(ke,{variant:A?"default":"secondary",children:A?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(_a,{className:"h-3 w-3 mr-1"}),""]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ss,{className:"h-[350px] pr-2",children:e.jsx("div",{className:"space-y-2",children:m.map(X=>{const L=w(X),me=f===X.id;return e.jsxs("div",{onClick:()=>p(X.id),className:`
                      flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all
                      ${me?"ring-2 ring-primary":""}
                      ${L?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-border hover:border-muted-foreground/50"}
                    `,children:[e.jsx("div",{className:"w-12 h-12 rounded border overflow-hidden bg-muted flex-shrink-0 flex items-center justify-center",children:e.jsx("img",{src:X.previewUrl,alt:X.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:X.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:X.emotion||""})]}),L?e.jsx(tt,{className:"h-5 w-5 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-muted-foreground/30 flex-shrink-0"})]},X.id)})})}),e.jsx("div",{className:"border rounded-lg p-4",children:M?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:M.previewUrl,alt:M.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:M.name}),w(M)&&e.jsxs(ke,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(Lt,{className:"h-3 w-3 mr-1"}),""]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"multi-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"multi-emotion",value:M.emotion,onChange:X=>b(M.id,{emotion:X.target.value}),placeholder:",",className:M.emotion.trim()?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"multi-description",children:""}),e.jsx(ne,{id:"multi-description",value:M.description,onChange:X=>b(M.id,{description:X.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"multi-is-registered",checked:M.isRegistered,onCheckedChange:X=>b(M.id,{isRegistered:X===!0})}),e.jsx(T,{htmlFor:"multi-is-registered",className:"cursor-pointer text-sm",children:""})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ox,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:""})]})})})]}),e.jsx(xt,{children:e.jsx(_,{onClick:P,disabled:!A||g,children:g?"...":` (${O})`})})]})};return e.jsx(Js,{open:a,onOpenChange:l,children:e.jsxs(qs,{className:"max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(rc,{className:"h-5 w-5"}),c==="select"&&" - ",c==="edit-single"&&" - ",c==="edit-multiple"&&" - "]}),e.jsxs(nt,{children:[c==="select"&&" JPGPNGGIFWebP  10MB",c==="edit-single"&&"",c==="edit-multiple"&&""]})]}),e.jsxs("div",{className:"overflow-y-auto pr-1",children:[c==="select"&&E(),c==="edit-single"&&C(),c==="edit-multiple"&&R()]})]})})}function tk(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(1),[p,g]=u.useState(20),[N,j]=u.useState(""),[y,b]=u.useState(null),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[P,E]=u.useState(!1),[C,R]=u.useState(null),[H,O]=u.useState(new Set),[X,L]=u.useState(!1),[me,Ne]=u.useState(""),[je,ce]=u.useState({total:0,recent_7days:0,chat_count:0,top_chats:{}}),[ge,pe]=u.useState([]),[D,K]=u.useState(new Map),[B,ue]=u.useState(!1),[Q,_e]=u.useState(0),{toast:he}=it(),Te=async()=>{try{c(!0);const ae=await X_({page:h,page_size:p,search:N||void 0});l(ae.data),m(ae.total)}catch(ae){he({title:"",description:ae instanceof Error?ae.message:"",variant:"destructive"})}finally{c(!1)}},V=async()=>{try{const ae=await a2();ae?.data&&ce(ae.data)}catch(ae){console.error(":",ae)}},$=async()=>{try{const ae=await hx();_e(ae.unchecked)}catch(ae){console.error(":",ae)}},z=async()=>{try{const ae=await xx();if(ae?.data){pe(ae.data);const Ee=new Map;ae.data.forEach(de=>{Ee.set(de.chat_id,de.chat_name)}),K(Ee)}}catch(ae){console.error(":",ae)}},G=ae=>D.get(ae)||ae;u.useEffect(()=>{Te(),$(),V(),z()},[h,p,N]);const Re=async ae=>{try{const Ee=await Z_(ae.id);b(Ee.data),A(!0)}catch(Ee){he({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},se=ae=>{b(ae),S(!0)},Oe=async ae=>{try{await s2(ae.id),he({title:"",description:`: ${ae.situation}`}),R(null),Te(),V()}catch(Ee){he({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}},ns=ae=>{const Ee=new Set(H);Ee.has(ae)?Ee.delete(ae):Ee.add(ae),O(Ee)},J=()=>{H.size===a.length&&a.length>0?O(new Set):O(new Set(a.map(ae=>ae.id)))},Z=async()=>{try{await t2(Array.from(H)),he({title:"",description:` ${H.size} `}),O(new Set),L(!1),Te(),V()}catch(ae){he({title:"",description:ae instanceof Error?ae.message:"",variant:"destructive"})}},Le=()=>{const ae=parseInt(me),Ee=Math.ceil(d/p);ae>=1&&ae<=Ee?(f(ae),Ne("")):he({title:"",description:`1-${Ee}`,variant:"destructive"})};return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ba,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>ue(!0),className:"gap-2",children:[e.jsx(av,{className:"h-4 w-4"}),"",Q>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:Q>99?"99+":Q})]}),e.jsxs(_,{onClick:()=>E(!0),className:"gap-2",children:[e.jsx(at,{className:"h-4 w-4"}),""]})]})]})}),e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:je.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"7"}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:je.recent_7days})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-blue-600",children:je.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 mt-1.5",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ut,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{id:"search",placeholder:"...",value:N,onChange:ae=>j(ae.target.value),className:"pl-9"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:H.size>0&&e.jsxs("span",{children:[" ",H.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:ae=>{g(parseInt(ae)),f(1),O(new Set)},children:[e.jsx(Be,{id:"page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"10",children:"10"}),e.jsx(ee,{value:"20",children:"20"}),e.jsx(ee,{value:"50",children:"50"}),e.jsx(ee,{value:"100",children:"100"})]})]}),H.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>O(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>L(!0),children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{className:"w-12",children:e.jsx(lt,{checked:H.size===a.length&&a.length>0,onCheckedChange:J})}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r?e.jsx(bt,{children:e.jsx(Je,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(bt,{children:e.jsx(Je,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(ae=>e.jsxs(bt,{children:[e.jsx(Je,{children:e.jsx(lt,{checked:H.has(ae.id),onCheckedChange:()=>ns(ae.id)})}),e.jsx(Je,{className:"font-medium max-w-xs truncate",children:ae.situation}),e.jsx(Je,{className:"max-w-xs truncate",children:ae.style}),e.jsx(Je,{className:"max-w-[200px] truncate",title:G(ae.chat_id),style:{wordBreak:"keep-all"},children:e.jsx("span",{className:"whitespace-nowrap overflow-hidden text-ellipsis block",children:G(ae.chat_id)})}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>se(ae),children:[e.jsx(Wn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Re(ae),title:"",children:e.jsx(ma,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>R(ae),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]})]})})]},ae.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(ae=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(lt,{checked:H.has(ae.id),onCheckedChange:()=>ns(ae.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 overflow-hidden space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 w-full break-all",title:ae.situation,children:ae.situation})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm line-clamp-2 w-full break-all",title:ae.style,children:ae.style})]})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm truncate",title:G(ae.chat_id),style:{wordBreak:"keep-all"},children:G(ae.chat_id)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>se(ae),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Wn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Re(ae),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:e.jsx(ma,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>R(ae),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(us,{className:"h-3 w-3 mr-1"}),""]})]})]},ae.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Ia,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:me,onChange:ae=>Ne(ae.target.value),onKeyDown:ae=>ae.key==="Enter"&&Le(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:Le,disabled:!me,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ra,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(ak,{expression:y,open:w,onOpenChange:A,chatNameMap:D}),e.jsx(lk,{open:P,onOpenChange:E,chatList:ge,onSuccess:()=>{Te(),V(),E(!1)}}),e.jsx(nk,{expression:y,open:M,onOpenChange:S,chatList:ge,onSuccess:()=>{Te(),V(),S(!1)}}),e.jsx(Cs,{open:!!C,onOpenChange:()=>R(null),children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',C?.situation,'"  ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>C&&Oe(C),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(rk,{open:X,onOpenChange:L,onConfirm:Z,count:H.size}),e.jsx($v,{open:B,onOpenChange:ae=>{ue(ae),ae||(Te(),V(),$())}})]})}function ak({expression:a,open:l,onOpenChange:r,chatNameMap:c}){if(!a)return null;const d=h=>h?new Date(h*1e3).toLocaleString("zh-CN"):"-",m=h=>c.get(h)||h;return e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ki,{label:"",value:a.situation}),e.jsx(Ki,{label:"",value:a.style}),e.jsx(Ki,{label:"",value:m(a.chat_id)}),e.jsx(Ki,{icon:Xr,label:"ID",value:a.id.toString(),mono:!0})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(Ki,{icon:ia,label:"",value:d(a.create_date)})}),e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-4",children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-3 block",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("flex h-8 w-8 items-center justify-center rounded-full",a.checked?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.checked?e.jsx(tt,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.checked?"":""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("flex h-8 w-8 items-center justify-center rounded-full",a.rejected?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:a.rejected?e.jsx(ta,{className:"h-5 w-5"}):e.jsx(Ho,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.rejected?"":""})]})]})]})]})]}),e.jsx(xt,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Ki({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function lk({open:a,onOpenChange:l,chatList:r,onSuccess:c}){const[d,m]=u.useState({situation:"",style:"",chat_id:""}),[h,f]=u.useState(!1),{toast:p}=it(),g=async()=>{if(!d.situation||!d.style||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await W_(d),p({title:"",description:""}),m({situation:"",style:"",chat_id:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Js,{open:a,onOpenChange:l,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"situation",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"situation",value:d.situation,onChange:N=>m({...d,situation:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"style",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"style",value:d.style,onChange:N=>m({...d,style:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Pe,{value:d.chat_id,onValueChange:N=>m({...d,chat_id:N}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:r.map(N=>e.jsx(ee,{value:N.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[N.chat_name,N.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},N.chat_id))})]})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function nk({expression:a,open:l,onOpenChange:r,chatList:c,onSuccess:d}){const[m,h]=u.useState({}),[f,p]=u.useState(!1),{toast:g}=it();u.useEffect(()=>{a&&h({situation:a.situation,style:a.style,chat_id:a.chat_id,checked:a.checked,rejected:a.rejected})},[a]);const N=async()=>{if(a)try{p(!0),await e2(a.id,m),g({title:"",description:""}),d()}catch(j){g({title:"",description:j instanceof Error?j.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_situation",children:""}),e.jsx(ne,{id:"edit_situation",value:m.situation||"",onChange:j=>h({...m,situation:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_style",children:""}),e.jsx(ne,{id:"edit_style",value:m.style||"",onChange:j=>h({...m,style:j.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Pe,{value:m.chat_id||"",onValueChange:j=>h({...m,chat_id:j}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:c.map(j=>e.jsx(ee,{value:j.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[j.chat_name,j.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},j.chat_id))})]})]}),e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx(gt,{className:"text-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:""})}),e.jsx("p",{children:" AI"}),e.jsx("p",{children:" "}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:['""',e.jsx("br",{})," ",e.jsx("br",{})," "]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_checked",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"edit_checked",checked:m.checked??!1,onCheckedChange:j=>h({...m,checked:j})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{htmlFor:"edit_rejected",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"edit_rejected",checked:m.rejected??!1,onCheckedChange:j=>h({...m,rejected:j})})]})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}function rk({open:a,onOpenChange:l,onConfirm:r,count:c}){return e.jsx(Cs,{open:a,onOpenChange:l,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",c," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:r,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})}const Hl="/api/webui/jargon";async function ik(){const a=await Se(`${Hl}/chats`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function ck(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.chat_id&&l.append("chat_id",a.chat_id),a.is_jargon!==void 0&&a.is_jargon!==null&&l.append("is_jargon",a.is_jargon.toString()),a.is_global!==void 0&&l.append("is_global",a.is_global.toString());const r=await Se(`${Hl}/list?${l}`,{});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function ok(a){const l=await Se(`${Hl}/${a}`,{});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function dk(a){const l=await Se(`${Hl}/`,{method:"POST",body:JSON.stringify(a)});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function uk(a,l){const r=await Se(`${Hl}/${a}`,{method:"PATCH",body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function mk(a){const l=await Se(`${Hl}/${a}`,{method:"DELETE"});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function xk(a){const l=await Se(`${Hl}/batch/delete`,{method:"POST",body:JSON.stringify({ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function hk(){const a=await Se(`${Hl}/stats/summary`,{});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function fk(a,l){const r=new URLSearchParams;a.forEach(d=>r.append("ids",d.toString())),r.append("is_jargon",l.toString());const c=await Se(`${Hl}/batch/set-jargon?${r}`,{method:"POST"});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return c.json()}function pk(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(1),[p,g]=u.useState(20),[N,j]=u.useState(""),[y,b]=u.useState("all"),[w,A]=u.useState("all"),[M,S]=u.useState(null),[P,E]=u.useState(!1),[C,R]=u.useState(!1),[H,O]=u.useState(!1),[X,L]=u.useState(null),[me,Ne]=u.useState(new Set),[je,ce]=u.useState(!1),[ge,pe]=u.useState(""),[D,K]=u.useState({total:0,confirmed_jargon:0,confirmed_not_jargon:0,pending:0,global_count:0,complete_count:0,chat_count:0,top_chats:{}}),[B,ue]=u.useState([]),{toast:Q}=it(),_e=async()=>{try{c(!0);const Z=await ck({page:h,page_size:p,search:N||void 0,chat_id:y==="all"?void 0:y,is_jargon:w==="all"?void 0:w==="true"?!0:w==="false"?!1:void 0});l(Z.data),m(Z.total)}catch(Z){Q({title:"",description:Z instanceof Error?Z.message:"",variant:"destructive"})}finally{c(!1)}},he=async()=>{try{const Z=await hk();Z?.data&&K(Z.data)}catch(Z){console.error(":",Z)}},Te=async()=>{try{const Z=await ik();Z?.data&&ue(Z.data)}catch(Z){console.error(":",Z)}};u.useEffect(()=>{_e(),he(),Te()},[h,p,N,y,w]);const V=async Z=>{try{const Le=await ok(Z.id);S(Le.data),E(!0)}catch(Le){Q({title:"",description:Le instanceof Error?Le.message:"",variant:"destructive"})}},$=Z=>{S(Z),R(!0)},z=async Z=>{try{await mk(Z.id),Q({title:"",description:`: ${Z.content}`}),L(null),_e(),he()}catch(Le){Q({title:"",description:Le instanceof Error?Le.message:"",variant:"destructive"})}},G=Z=>{const Le=new Set(me);Le.has(Z)?Le.delete(Z):Le.add(Z),Ne(Le)},Re=()=>{me.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(Z=>Z.id)))},se=async()=>{try{await xk(Array.from(me)),Q({title:"",description:` ${me.size} `}),Ne(new Set),ce(!1),_e(),he()}catch(Z){Q({title:"",description:Z instanceof Error?Z.message:"",variant:"destructive"})}},Oe=async Z=>{try{await fk(Array.from(me),Z),Q({title:"",description:` ${me.size} ${Z?"":""}`}),Ne(new Set),_e(),he()}catch(Le){Q({title:"",description:Le instanceof Error?Le.message:"",variant:"destructive"})}},ns=()=>{const Z=parseInt(ge),Le=Math.ceil(d/p);Z>=1&&Z<=Le?(f(Z),pe("")):Q({title:"",description:`1-${Le}`,variant:"destructive"})},J=Z=>Z===!0?e.jsxs(ke,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Lt,{className:"h-3 w-3 mr-1"}),""]}):Z===!1?e.jsxs(ke,{variant:"secondary",children:[e.jsx(_a,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"outline",children:[e.jsx(nv,{className:"h-3 w-3 mr-1"}),""]});return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(O1,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs(_,{onClick:()=>O(!0),className:"gap-2",children:[e.jsx(at,{className:"h-4 w-4"}),""]})]})}),e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:D.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-green-600",children:D.confirmed_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-gray-500",children:D.confirmed_not_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-yellow-600",children:D.pending})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-blue-600",children:D.global_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-purple-600",children:D.complete_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:D.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{id:"search",placeholder:"...",value:N,onChange:Z=>j(Z.target.value),className:"pl-9"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:y,onValueChange:b,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),B.map(Z=>e.jsx(ee,{value:Z.chat_id,children:Z.chat_name},Z.chat_id))]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:w,onValueChange:A,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),e.jsx(ee,{value:"true",children:""}),e.jsx(ee,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{htmlFor:"page-size",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:Z=>{g(parseInt(Z)),f(1),Ne(new Set)},children:[e.jsx(Be,{id:"page-size",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"10",children:"10"}),e.jsx(ee,{value:"20",children:"20"}),e.jsx(ee,{value:"50",children:"50"}),e.jsx(ee,{value:"100",children:"100"})]})]})]})]}),me.size>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",me.size," "]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Oe(!0),children:[e.jsx(Lt,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Oe(!1),children:[e.jsx(_a,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>ce(!0),children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{className:"w-12",children:e.jsx(lt,{checked:me.size===a.length&&a.length>0,onCheckedChange:Re})}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{className:"text-center",children:""}),e.jsx(ls,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r?e.jsx(bt,{children:e.jsx(Je,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(bt,{children:e.jsx(Je,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(Z=>e.jsxs(bt,{children:[e.jsx(Je,{children:e.jsx(lt,{checked:me.has(Z.id),onCheckedChange:()=>G(Z.id)})}),e.jsx(Je,{className:"font-medium max-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[Z.is_global&&e.jsx("span",{title:"",children:e.jsx(qo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"})}),e.jsx("span",{className:"truncate",title:Z.content,children:Z.content})]})}),e.jsx(Je,{className:"max-w-[200px] truncate",title:Z.meaning||"",children:Z.meaning||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Je,{className:"max-w-[150px] truncate",title:Z.chat_name||Z.chat_id,children:Z.chat_name||Z.chat_id}),e.jsx(Je,{children:J(Z.is_jargon)}),e.jsx(Je,{className:"text-center",children:Z.count}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>$(Z),children:[e.jsx(Wn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>V(Z),title:"",children:e.jsx(ma,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>L(Z),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]})]})})]},Z.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(Z=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(lt,{checked:me.has(Z.id),onCheckedChange:()=>G(Z.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Z.is_global&&e.jsx(qo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),e.jsx("h3",{className:"font-semibold text-sm break-all",children:Z.content})]}),Z.meaning&&e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:Z.meaning}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[J(Z.is_jargon),e.jsxs("span",{className:"text-muted-foreground",children:[": ",Z.count]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[": ",Z.chat_name||Z.chat_id]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>$(Z),className:"text-xs px-2 py-1 h-auto",children:[e.jsx(Wn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>V(Z),className:"text-xs px-2 py-1 h-auto",children:e.jsx(ma,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>L(Z),className:"text-xs px-2 py-1 h-auto text-destructive hover:text-destructive",children:[e.jsx(us,{className:"h-3 w-3 mr-1"}),""]})]})]},Z.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Ia,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:ge,onChange:Z=>pe(Z.target.value),onKeyDown:Z=>Z.key==="Enter"&&ns(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:ns,disabled:!ge,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ra,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(gk,{jargon:M,open:P,onOpenChange:E}),e.jsx(jk,{open:H,onOpenChange:O,chatList:B,onSuccess:()=>{_e(),he(),O(!1)}}),e.jsx(vk,{jargon:M,open:C,onOpenChange:R,chatList:B,onSuccess:()=>{_e(),he(),R(!1)}}),e.jsx(Cs,{open:!!X,onOpenChange:()=>L(null),children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',X?.content,'" ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>X&&z(X),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Cs,{open:je,onOpenChange:ce,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",me.size," "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:se,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function gk({jargon:a,open:l,onOpenChange:r}){return a?e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsx(ss,{className:"h-full pr-4",children:e.jsxs("div",{className:"space-y-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Vm,{icon:Xr,label:"ID",value:a.id.toString(),mono:!0}),e.jsx(Vm,{label:"",value:a.count.toString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all whitespace-pre-wrap",children:a.content})]}),a.raw_content&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:(()=>{try{const c=JSON.parse(a.raw_content);return Array.isArray(c)?c.map((d,m)=>e.jsxs("div",{children:[m>0&&e.jsx("hr",{className:"my-3 border-border"}),e.jsx("div",{className:"whitespace-pre-wrap",children:d})]},m)):e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}catch{return e.jsx("div",{className:"whitespace-pre-wrap",children:a.raw_content})}})()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:a.meaning?e.jsx(gx,{content:a.meaning}):"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Vm,{label:"",value:a.chat_name||a.chat_id}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.is_jargon===!0&&e.jsx(ke,{variant:"default",className:"bg-green-600",children:""}),a.is_jargon===!1&&e.jsx(ke,{variant:"secondary",children:""}),a.is_jargon===null&&e.jsx(ke,{variant:"outline",children:""}),a.is_global&&e.jsx(ke,{variant:"outline",className:"border-blue-500 text-blue-500",children:""}),a.is_complete&&e.jsx(ke,{variant:"outline",className:"border-purple-500 text-purple-500",children:""})]})]})]}),a.inference_with_context&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_with_context})]}),a.inference_content_only&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:a.inference_content_only})]})]})}),e.jsx(xt,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})}):null}function Vm({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function jk({open:a,onOpenChange:l,chatList:r,onSuccess:c}){const[d,m]=u.useState({content:"",meaning:"",chat_id:"",is_global:!1}),[h,f]=u.useState(!1),{toast:p}=it(),g=async()=>{if(!d.content||!d.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await dk(d),p({title:"",description:""}),m({content:"",meaning:"",chat_id:"",is_global:!1}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Js,{open:a,onOpenChange:l,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"content",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{id:"content",value:d.content,onChange:N=>m({...d,content:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"meaning",children:""}),e.jsx(ft,{id:"meaning",value:d.meaning||"",onChange:N=>m({...d,meaning:N.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Pe,{value:d.chat_id,onValueChange:N=>m({...d,chat_id:N}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:r.map(N=>e.jsx(ee,{value:N.chat_id,children:N.chat_name},N.chat_id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"is_global",checked:d.is_global,onCheckedChange:N=>m({...d,is_global:N})}),e.jsx(T,{htmlFor:"is_global",children:""})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function vk({jargon:a,open:l,onOpenChange:r,chatList:c,onSuccess:d}){const[m,h]=u.useState({}),[f,p]=u.useState(!1),{toast:g}=it();u.useEffect(()=>{a&&h({content:a.content,meaning:a.meaning||"",chat_id:a.stream_id||a.chat_id,is_global:a.is_global,is_jargon:a.is_jargon})},[a]);const N=async()=>{if(a)try{p(!0),await uk(a.id,m),g({title:"",description:""}),d()}catch(j){g({title:"",description:j instanceof Error?j.message:"",variant:"destructive"})}finally{p(!1)}};return a?e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_content",children:""}),e.jsx(ne,{id:"edit_content",value:m.content||"",onChange:j=>h({...m,content:j.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_meaning",children:""}),e.jsx(ft,{id:"edit_meaning",value:m.meaning||"",onChange:j=>h({...m,meaning:j.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Pe,{value:m.chat_id||"",onValueChange:j=>h({...m,chat_id:j}),children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsx(Ie,{children:c.map(j=>e.jsx(ee,{value:j.chat_id,children:j.chat_name},j.chat_id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsxs(Pe,{value:m.is_jargon===null?"null":m.is_jargon?.toString()||"null",onValueChange:j=>h({...m,is_jargon:j==="null"?null:j==="true"}),children:[e.jsx(Be,{children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"null",children:""}),e.jsx(ee,{value:"true",children:""}),e.jsx(ee,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"edit_is_global",checked:m.is_global,onCheckedChange:j=>h({...m,is_global:j})}),e.jsx(T,{htmlFor:"edit_is_global",children:""})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}const ti="/api/webui/person";async function Nk(a){const l=new URLSearchParams;a.page&&l.append("page",a.page.toString()),a.page_size&&l.append("page_size",a.page_size.toString()),a.search&&l.append("search",a.search),a.is_known!==void 0&&l.append("is_known",a.is_known.toString()),a.platform&&l.append("platform",a.platform);const r=await Se(`${ti}/list?${l}`,{headers:Ws()});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function bk(a){const l=await Se(`${ti}/${a}`,{headers:Ws()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function yk(a,l){const r=await Se(`${ti}/${a}`,{method:"PATCH",headers:Ws(),body:JSON.stringify(l)});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return r.json()}async function wk(a){const l=await Se(`${ti}/${a}`,{method:"DELETE",headers:Ws()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}async function _k(){const a=await Se(`${ti}/stats/summary`,{headers:Ws()});if(!a.ok){const l=await a.json();throw new Error(l.detail||"")}return a.json()}async function Sk(a){const l=await Se(`${ti}/batch/delete`,{method:"POST",headers:Ws(),body:JSON.stringify({person_ids:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function kk(){const[a,l]=u.useState([]),[r,c]=u.useState(!0),[d,m]=u.useState(0),[h,f]=u.useState(1),[p,g]=u.useState(20),[N,j]=u.useState(""),[y,b]=u.useState(void 0),[w,A]=u.useState(void 0),[M,S]=u.useState(null),[P,E]=u.useState(!1),[C,R]=u.useState(!1),[H,O]=u.useState(null),[X,L]=u.useState({total:0,known:0,unknown:0,platforms:{}}),[me,Ne]=u.useState(new Set),[je,ce]=u.useState(!1),[ge,pe]=u.useState(""),{toast:D}=it(),K=async()=>{try{c(!0);const se=await Nk({page:h,page_size:p,search:N||void 0,is_known:y,platform:w});l(se.data),m(se.total)}catch(se){D({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{c(!1)}},B=async()=>{try{const se=await _k();se?.data&&L(se.data)}catch(se){console.error(":",se)}};u.useEffect(()=>{K(),B()},[h,p,N,y,w]);const ue=async se=>{try{const Oe=await bk(se.person_id);S(Oe.data),E(!0)}catch(Oe){D({title:"",description:Oe instanceof Error?Oe.message:"",variant:"destructive"})}},Q=se=>{S(se),R(!0)},_e=async se=>{try{await wk(se.person_id),D({title:"",description:`: ${se.person_name||se.nickname||se.user_id}`}),O(null),K(),B()}catch(Oe){D({title:"",description:Oe instanceof Error?Oe.message:"",variant:"destructive"})}},he=u.useMemo(()=>Object.keys(X.platforms),[X.platforms]),Te=se=>{const Oe=new Set(me);Oe.has(se)?Oe.delete(se):Oe.add(se),Ne(Oe)},V=()=>{me.size===a.length&&a.length>0?Ne(new Set):Ne(new Set(a.map(se=>se.person_id)))},$=()=>{if(me.size===0){D({title:"",description:"",variant:"destructive"});return}ce(!0)},z=async()=>{try{const se=await Sk(Array.from(me));D({title:"",description:se.message}),Ne(new Set),ce(!1),K(),B()}catch(se){D({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}},G=()=>{const se=parseInt(ge),Oe=Math.ceil(d/p);se>=1&&se<=Oe?(f(se),pe("")):D({title:"",description:`1-${Oe}`,variant:"destructive"})},Re=se=>se?new Date(se*1e3).toLocaleString("zh-CN"):"-";return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ic,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:X.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:X.known})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-muted-foreground",children:X.unknown})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(T,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative mt-1.5",children:[e.jsx(Ut,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{id:"search",placeholder:"ID...",value:N,onChange:se=>j(se.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-known",children:""}),e.jsxs(Pe,{value:y===void 0?"all":y.toString(),onValueChange:se=>{b(se==="all"?void 0:se==="true"),f(1)},children:[e.jsx(Be,{id:"filter-known",className:"mt-1.5",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),e.jsx(ee,{value:"true",children:""}),e.jsx(ee,{value:"false",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(T,{htmlFor:"filter-platform",children:""}),e.jsxs(Pe,{value:w||"all",onValueChange:se=>{A(se==="all"?void 0:se),f(1)},children:[e.jsx(Be,{id:"filter-platform",className:"mt-1.5",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),he.map(se=>e.jsxs(ee,{value:se,children:[se," (",X.platforms[se],")"]},se))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:me.size>0&&e.jsxs("span",{children:[" ",me.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Pe,{value:p.toString(),onValueChange:se=>{g(parseInt(se)),f(1),Ne(new Set)},children:[e.jsx(Be,{id:"page-size",className:"w-20",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"10",children:"10"}),e.jsx(ee,{value:"20",children:"20"}),e.jsx(ee,{value:"50",children:"50"}),e.jsx(ee,{value:"100",children:"100"})]})]}),me.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ne(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:$,children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{className:"w-12",children:e.jsx(lt,{checked:a.length>0&&me.size===a.length,onCheckedChange:V,"aria-label":""})}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:"ID"}),e.jsx(ls,{children:""}),e.jsx(ls,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r?e.jsx(bt,{children:e.jsx(Je,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"..."})}):a.length===0?e.jsx(bt,{children:e.jsx(Je,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:""})}):a.map(se=>e.jsxs(bt,{children:[e.jsx(Je,{children:e.jsx(lt,{checked:me.has(se.person_id),onCheckedChange:()=>Te(se.person_id),"aria-label":` ${se.person_name||se.nickname||se.user_id}`})}),e.jsx(Je,{children:e.jsx("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",se.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:se.is_known?"":""})}),e.jsx(Je,{className:"font-medium",children:se.person_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Je,{children:se.nickname||"-"}),e.jsx(Je,{children:se.platform}),e.jsx(Je,{className:"font-mono text-sm",children:se.user_id}),e.jsx(Je,{className:"text-sm text-muted-foreground",children:Re(se.last_know)}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>ue(se),children:[e.jsx(ma,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>Q(se),children:[e.jsx(Wn,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>O(se),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]})]})})]},se.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):a.map(se=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(lt,{checked:me.has(se.person_id),onCheckedChange:()=>Te(se.person_id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium mb-2",se.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:se.is_known?"":""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-1 w-full break-all",children:se.person_name||e.jsx("span",{className:"text-muted-foreground",children:""})}),se.nickname&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1 w-full break-all",children:[": ",se.nickname]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"font-medium text-xs",children:se.platform})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ID"}),e.jsx("p",{className:"font-mono text-xs truncate",title:se.user_id,children:se.user_id})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-xs",children:Re(se.last_know)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>ue(se),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(ma,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Q(se),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(Wn,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>O(se),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(us,{className:"h-3 w-3 mr-1"}),""]})]})]},se.id))}),d>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",d,"  ",h," / ",Math.ceil(d/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Ia,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"number",value:ge,onChange:se=>pe(se.target.value),onKeyDown:se=>se.key==="Enter"&&G(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(d/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:G,disabled:!ge,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(d/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(ra,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(d/p)),disabled:h>=Math.ceil(d/p),className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(Ck,{person:M,open:P,onOpenChange:E}),e.jsx(Tk,{person:M,open:C,onOpenChange:R,onSuccess:()=>{K(),B(),R(!1)}}),e.jsx(Cs,{open:!!H,onOpenChange:()=>O(null),children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[' "',H?.person_name||H?.nickname||H?.user_id,'"  ']})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:()=>H&&_e(H),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Cs,{open:je,onOpenChange:ce,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:[" ",me.size,"  "]})]}),e.jsxs(js,{children:[e.jsx(ys,{children:""}),e.jsx(bs,{onClick:z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function Ck({person:a,open:l,onOpenChange:r}){if(!a)return null;const c=d=>d?new Date(d*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsxs(nt,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ol,{icon:$l,label:"",value:a.person_name}),e.jsx(Ol,{icon:Ba,label:"",value:a.nickname}),e.jsx(Ol,{icon:Xr,label:"ID",value:a.user_id,mono:!0}),e.jsx(Ol,{icon:Xr,label:"ID",value:a.person_id,mono:!0}),e.jsx(Ol,{label:"",value:a.platform}),e.jsx(Ol,{label:"",value:a.is_known?"":""})]}),a.name_reason&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm",children:a.name_reason})]}),a.memory_points&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:a.memory_points})]}),a.group_nick_name&&a.group_nick_name.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(T,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:a.group_nick_name.map((d,m)=>e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:d.group_id}),e.jsx("span",{children:""}),e.jsx("span",{children:d.group_nick_name})]},m))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Ol,{icon:ia,label:"",value:c(a.know_times)}),e.jsx(Ol,{icon:ia,label:"",value:c(a.know_since)}),e.jsx(Ol,{icon:ia,label:"",value:c(a.last_know)})]})]}),e.jsx(xt,{children:e.jsx(_,{onClick:()=>r(!1),children:""})})]})})}function Ol({icon:a,label:l,value:r,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[a&&e.jsx(a,{className:"h-3 w-3"}),l]}),e.jsx("div",{className:F("text-sm",c&&"font-mono",!r&&"text-muted-foreground"),children:r||"-"})]})}function Tk({person:a,open:l,onOpenChange:r,onSuccess:c}){const[d,m]=u.useState({}),[h,f]=u.useState(!1),{toast:p}=it();u.useEffect(()=>{a&&m({person_name:a.person_name||"",name_reason:a.name_reason||"",nickname:a.nickname||"",is_known:a.is_known})},[a]);const g=async()=>{if(a)try{f(!0),await yk(a.person_id,d),p({title:"",description:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return a?e.jsx(Js,{open:l,onOpenChange:r,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsxs(nt,{children:[" ",a.person_name||a.nickname||a.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"person_name",children:""}),e.jsx(ne,{id:"person_name",value:d.person_name||"",onChange:N=>m({...d,person_name:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"nickname",children:""}),e.jsx(ne,{id:"nickname",value:d.nickname||"",onChange:N=>m({...d,nickname:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"name_reason",children:""}),e.jsx(ft,{id:"name_reason",value:d.name_reason||"",onChange:N=>m({...d,name_reason:N.target.value}),placeholder:"",rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx(T,{htmlFor:"is_known",className:"text-base font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Ge,{id:"is_known",checked:d.is_known,onCheckedChange:N=>m({...d,is_known:N})})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>r(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})}):null}var Ek=v_();const Xg=iw(Ek),Sx="/api/webui";async function Mk(a=100,l="all"){const r=`${Sx}/knowledge/graph?limit=${a}&node_type=${l}`,c=await fetch(r);if(!c.ok)throw new Error(`: ${c.status}`);return c.json()}async function Ak(){const a=await fetch(`${Sx}/knowledge/stats`);if(!a.ok)throw new Error("");return a.json()}async function zk(a){const l=await fetch(`${Sx}/knowledge/search?query=${encodeURIComponent(a)}`);if(!l.ok)throw new Error("");return l.json()}const lN=u.memo(({data:a})=>e.jsxs("div",{className:"px-4 py-2 shadow-md rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700 min-w-[120px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-semibold text-white text-sm truncate max-w-[200px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));lN.displayName="EntityNode";const nN=u.memo(({data:a})=>e.jsxs("div",{className:"px-3 py-2 shadow-md rounded-md bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700 min-w-[100px]",children:[e.jsx(Ko,{type:"target",position:Qo.Top}),e.jsx("div",{className:"font-medium text-white text-xs truncate max-w-[150px]",title:a.content,children:a.label}),e.jsx(Ko,{type:"source",position:Qo.Bottom})]}));nN.displayName="ParagraphNode";const Rk={entity:lN,paragraph:nN};function Dk(a,l){const r=new Xg.graphlib.Graph;r.setDefaultEdgeLabel(()=>({})),r.setGraph({rankdir:"TB",ranksep:100,nodesep:80});const c=[],d=[];return a.forEach(m=>{r.setNode(m.id,{width:150,height:50})}),l.forEach(m=>{r.setEdge(m.source,m.target)}),Xg.layout(r),a.forEach(m=>{const h=r.node(m.id);c.push({id:m.id,type:m.type,position:{x:h.x-75,y:h.y-25},data:{label:m.content.slice(0,20)+(m.content.length>20?"...":""),content:m.content}})}),l.forEach((m,h)=>{const f={id:`edge-${h}`,source:m.source,target:m.target,animated:a.length<=200&&m.weight>5,style:{strokeWidth:Math.min(m.weight/2,5),opacity:.6}};m.weight>10&&a.length<100&&(f.label=`${m.weight.toFixed(0)}`),d.push(f)}),{nodes:c,edges:d}}function Ok(){const a=xa(),[l,r]=u.useState(!1),[c,d]=u.useState(null),[m,h]=u.useState(""),[f,p]=u.useState("all"),[g,N]=u.useState(50),[j,y]=u.useState("50"),[b,w]=u.useState(!1),[A,M]=u.useState(!0),[S,P]=u.useState(!1),[E,C]=u.useState(!1),[R,H,O]=N_([]),[X,L,me]=b_([]),[Ne,je]=u.useState(0),[ce,ge]=u.useState(null),[pe,D]=u.useState(null),{toast:K}=it(),B=u.useCallback(z=>z.type==="entity"?"#6366f1":z.type==="paragraph"?"#10b981":"#6b7280",[]),ue=u.useCallback(async(z=!1)=>{try{if(!z&&g>200){C(!0);return}r(!0);const[G,Re]=await Promise.all([Mk(g,f),Ak()]);if(d(Re),G.nodes.length===0){K({title:"",description:""}),H([]),L([]);return}const{nodes:se,edges:Oe}=Dk(G.nodes,G.edges);H(se),L(Oe),je(se.length),Re&&Re.total_nodes>g&&K({title:"",description:` ${Re.total_nodes}  ${se.length} `}),K({title:"",description:` ${se.length} ${Oe.length} `})}catch(G){console.error(":",G),K({title:"",description:G instanceof Error?G.message:"",variant:"destructive"})}finally{r(!1)}},[g,f,K]),Q=u.useCallback(async()=>{if(!m.trim()){K({title:"",description:""});return}try{const z=await zk(m);if(z.length===0){K({title:"",description:""});return}const G=new Set(z.map(Re=>Re.id));H(Re=>Re.map(se=>({...se,style:{...se.style,opacity:G.has(se.id)?1:.3,filter:G.has(se.id)?"brightness(1.2)":"brightness(0.8)"}}))),K({title:"",description:` ${z.length} `})}catch(z){console.error(":",z),K({title:"",description:z instanceof Error?z.message:"",variant:"destructive"})}},[m,K]),_e=u.useCallback(()=>{H(z=>z.map(G=>({...G,style:{...G.style,opacity:1,filter:"brightness(1)"}})))},[]),he=u.useCallback(()=>{M(!1),P(!0),ue()},[ue]),Te=u.useCallback(()=>{C(!1),setTimeout(()=>{ue(!0)},0)},[ue]),V=u.useCallback((z,G)=>{R.find(se=>se.id===G.id)&&ge({id:G.id,type:G.type,content:G.data.content})},[R]);u.useEffect(()=>{A||S&&ue()},[g,f,A,S]);const $=u.useCallback((z,G)=>{const Re=R.find(ns=>ns.id===G.source),se=R.find(ns=>ns.id===G.target),Oe=X.find(ns=>ns.id===G.id);Re&&se&&Oe&&D({source:{id:Re.id,type:Re.type,content:Re.data.content},target:{id:se.id,type:se.type,content:se.data.content},edge:{source:G.source,target:G.target,weight:parseFloat(G.label||"0")}})},[R,X]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b bg-background",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1",children:""})]}),c&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Jr,{className:"h-3 w-3"}),": ",c.total_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(dv,{className:"h-3 w-3"}),": ",c.total_edges]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(Qt,{className:"h-3 w-3"}),": ",c.entity_nodes]}),e.jsxs(ke,{variant:"outline",className:"gap-1",children:[e.jsx(La,{className:"h-3 w-3"}),": ",c.paragraph_nodes]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(ne,{placeholder:"...",value:m,onChange:z=>h(z.target.value),onKeyDown:z=>z.key==="Enter"&&Q(),className:"flex-1"}),e.jsx(_,{onClick:Q,size:"sm",children:e.jsx(Ut,{className:"h-4 w-4"})}),e.jsx(_,{onClick:_e,variant:"outline",size:"sm",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Pe,{value:f,onValueChange:z=>p(z),children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),e.jsx(ee,{value:"entity",children:""}),e.jsx(ee,{value:"paragraph",children:""})]})]}),e.jsxs(Pe,{value:g===1e4?"all":b?"custom":g.toString(),onValueChange:z=>{z==="custom"?(w(!0),y(g.toString())):z==="all"?(w(!1),N(1e4)):(w(!1),N(Number(z)))},children:[e.jsx(Be,{className:"w-[120px]",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"50",children:"50 "}),e.jsx(ee,{value:"100",children:"100 "}),e.jsx(ee,{value:"200",children:"200 "}),e.jsx(ee,{value:"500",children:"500 "}),e.jsx(ee,{value:"1000",children:"1000 "}),e.jsx(ee,{value:"all",children:" (10000)"}),e.jsx(ee,{value:"custom",children:"..."})]})]}),b&&e.jsx(ne,{type:"number",min:"50",value:j,onChange:z=>y(z.target.value),onBlur:()=>{const z=parseInt(j);!isNaN(z)&&z>=50?N(z):(y("50"),N(50))},onKeyDown:z=>{if(z.key==="Enter"){const G=parseInt(j);!isNaN(G)&&G>=50?N(G):(y("50"),N(50))}},placeholder:"50",className:"w-[120px]"}),e.jsx(_,{onClick:()=>ue(),variant:"outline",size:"sm",disabled:l,children:e.jsx(ut,{className:F("h-4 w-4",l&&"animate-spin")})})]})]})]}),e.jsx("div",{className:"flex-1 relative",children:l?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ut,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):R.length===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]})}):e.jsxs(y_,{nodes:R,edges:X,onNodesChange:O,onEdgesChange:me,onNodeClick:V,onEdgeClick:$,nodeTypes:Rk,fitView:!0,minZoom:.05,maxZoom:1.5,defaultViewport:{x:0,y:0,zoom:.5},elevateNodesOnSelect:Ne<=500,nodesDraggable:Ne<=1e3,attributionPosition:"bottom-left",children:[e.jsx(w_,{variant:__.Dots,gap:12,size:1}),e.jsx(S_,{}),Ne<=500&&e.jsx(k_,{nodeColor:B,nodeBorderRadius:8,pannable:!0,zoomable:!0}),e.jsxs(C_,{position:"top-right",className:"bg-background/95 backdrop-blur-sm rounded-lg border p-3 shadow-lg",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:""}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700"}),e.jsx("span",{children:""})]}),Ne>200&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-yellow-600 dark:text-yellow-500",children:[e.jsx("div",{className:"font-semibold",children:""}),e.jsx("div",{children:""}),Ne>500&&e.jsx("div",{children:""})]})]})]})]})}),e.jsx(Js,{open:!!ce,onOpenChange:z=>!z&&ge(null),children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Vs,{children:e.jsx(Gs,{children:""})}),ce&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:ce.type==="entity"?"default":"secondary",children:ce.type==="entity"?" ":" "})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ID"}),e.jsx("code",{className:"mt-1 block p-2 bg-muted rounded text-xs break-all",children:ce.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx(ss,{className:"mt-1 h-40 p-3 bg-muted rounded",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:ce.content})})]})]})]})}),e.jsx(Js,{open:!!pe,onOpenChange:z=>!z&&D(null),children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx(Vs,{children:e.jsx(Gs,{children:""})}),pe&&e.jsx(ss,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-blue-50 dark:bg-blue-950 rounded border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:pe.source.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[pe.source.id.slice(0,40),"..."]})]}),e.jsx("div",{className:"text-2xl text-muted-foreground flex-shrink-0",children:""}),e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-green-50 dark:bg-green-950 rounded border-2 border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:pe.target.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[pe.target.id.slice(0,40),"..."]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(ke,{variant:"outline",className:"text-base font-mono",children:pe.edge.weight.toFixed(4)})})]})]})})]})}),e.jsx(Cs,{open:A,onOpenChange:M,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:""}),e.jsxs(Ns,{children:["",e.jsx("br",{}),"?"]})]}),e.jsxs(js,{children:[e.jsx(ys,{onClick:()=>a({to:"/"}),children:" ()"}),e.jsx(bs,{onClick:he,children:""})]})]})}),e.jsx(Cs,{open:E,onOpenChange:C,children:e.jsxs(ps,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:" "}),e.jsx(Ns,{asChild:!0,children:e.jsxs("div",{children:[e.jsxs("p",{children:[" ",e.jsx("strong",{className:"text-orange-600",children:g>=1e4?" (10000)":g})," "]}),e.jsx("p",{className:"mt-4",children:":"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"mt-4",children:" (50-200 )"})]})})]}),e.jsxs(js,{children:[e.jsx(ys,{onClick:()=>{C(!1),g>200&&(N(50),w(!1))},children:""}),e.jsx(bs,{onClick:Te,className:"bg-orange-600 hover:bg-orange-700",children:""})]})]})})]})}function Lk(){return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-none border-b bg-card/50 px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:""})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"mx-auto max-w-4xl",children:e.jsxs(Ce,{children:[e.jsxs(De,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Jr,{className:"h-10 w-10 text-primary"})}),e.jsx(Ue,{className:"text-2xl",children:""}),e.jsx(fs,{className:"text-base",children:""})]}),e.jsx(Ae,{className:"text-center text-sm text-muted-foreground",children:e.jsx("p",{children:""})})]})})})]})}function Zg({className:a,classNames:l,showOutsideDays:r=!0,captionLayout:c="label",buttonVariant:d="ghost",formatters:m,components:h,...f}){const p=kv();return e.jsx(m_,{showOutsideDays:r,className:F("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,a),captionLayout:c,formatters:{formatMonthDropdown:g=>g.toLocaleString("default",{month:"short"}),...m},classNames:{root:F("w-fit",p.root),months:F("relative flex flex-col gap-4 md:flex-row",p.months),month:F("flex w-full flex-col gap-4",p.month),nav:F("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",p.nav),button_previous:F(Wr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_previous),button_next:F(Wr({variant:d}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_next),month_caption:F("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",p.month_caption),dropdowns:F("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",p.dropdowns),dropdown_root:F("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",p.dropdown_root),dropdown:F("bg-popover absolute inset-0 opacity-0",p.dropdown),caption_label:F("select-none font-medium",c==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",p.caption_label),table:"w-full border-collapse",weekdays:F("flex",p.weekdays),weekday:F("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",p.weekday),week:F("mt-2 flex w-full",p.week),week_number_header:F("w-[--cell-size] select-none",p.week_number_header),week_number:F("text-muted-foreground select-none text-[0.8rem]",p.week_number),day:F("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",p.day),range_start:F("bg-accent rounded-l-md",p.range_start),range_middle:F("rounded-none",p.range_middle),range_end:F("bg-accent rounded-r-md",p.range_end),today:F("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",p.today),outside:F("text-muted-foreground aria-selected:text-muted-foreground",p.outside),disabled:F("text-muted-foreground opacity-50",p.disabled),hidden:F("invisible",p.hidden),...l},components:{Root:({className:g,rootRef:N,...j})=>e.jsx("div",{"data-slot":"calendar",ref:N,className:F(g),...j}),Chevron:({className:g,orientation:N,...j})=>N==="left"?e.jsx(Ia,{className:F("size-4",g),...j}):N==="right"?e.jsx(ra,{className:F("size-4",g),...j}):e.jsx($a,{className:F("size-4",g),...j}),DayButton:Uk,WeekNumber:({children:g,...N})=>e.jsx("td",{...N,children:e.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:g})}),...h},...f})}function Uk({className:a,day:l,modifiers:r,...c}){const d=kv(),m=u.useRef(null);return u.useEffect(()=>{r.focused&&m.current?.focus()},[r.focused]),e.jsx(_,{ref:m,variant:"ghost",size:"icon","data-day":l.date.toLocaleDateString(),"data-selected-single":r.selected&&!r.range_start&&!r.range_end&&!r.range_middle,"data-range-start":r.range_start,"data-range-end":r.range_end,"data-range-middle":r.range_middle,className:F("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",d.day,a),...c})}const Oo={xs:{label:"",rowHeight:28,class:"text-[10px] sm:text-xs"},sm:{label:"",rowHeight:36,class:"text-xs sm:text-sm"},base:{label:"",rowHeight:44,class:"text-sm sm:text-base"}};function $k(){const[a,l]=u.useState([]),[r,c]=u.useState(""),[d,m]=u.useState("all"),[h,f]=u.useState("all"),[p,g]=u.useState(void 0),[N,j]=u.useState(void 0),[y,b]=u.useState(!0),[w,A]=u.useState(!1),[M,S]=u.useState("xs"),[P,E]=u.useState(4),[C,R]=u.useState(!1),H=u.useRef(null);u.useEffect(()=>{const Q=Gn.getAllLogs();l(Q);const _e=Gn.onLog(()=>{l(Gn.getAllLogs())}),he=Gn.onConnectionChange(Te=>{A(Te)});return()=>{_e(),he()}},[]);const O=u.useMemo(()=>{const Q=new Set(a.map(_e=>_e.module).filter(_e=>_e&&_e.trim()!==""));return Array.from(Q).sort()},[a]),X=Q=>{switch(Q){case"DEBUG":return"text-muted-foreground";case"INFO":return"text-blue-500 dark:text-blue-400";case"WARNING":return"text-yellow-600 dark:text-yellow-500";case"ERROR":return"text-red-600 dark:text-red-500";case"CRITICAL":return"text-red-700 dark:text-red-400 font-bold";default:return"text-foreground"}},L=Q=>{switch(Q){case"DEBUG":return"bg-gray-800/30 dark:bg-gray-800/50";case"INFO":return"bg-blue-900/20 dark:bg-blue-500/20";case"WARNING":return"bg-yellow-900/20 dark:bg-yellow-500/20";case"ERROR":return"bg-red-900/20 dark:bg-red-500/20";case"CRITICAL":return"bg-red-900/30 dark:bg-red-600/30";default:return"bg-gray-800/20 dark:bg-gray-800/30"}},me=()=>{window.location.reload()},Ne=()=>{Gn.clearLogs(),l([])},je=()=>{const Q=pe.map(V=>`${V.timestamp} [${V.level.padEnd(8)}] [${V.module}] ${V.message}`).join(`
`),_e=new Blob([Q],{type:"text/plain;charset=utf-8"}),he=URL.createObjectURL(_e),Te=document.createElement("a");Te.href=he,Te.download=`logs-${Tm(new Date,"yyyy-MM-dd-HHmmss")}.txt`,Te.click(),URL.revokeObjectURL(he)},ce=()=>{b(!y)},ge=()=>{g(void 0),j(void 0)},pe=u.useMemo(()=>a.filter(Q=>{const _e=r===""||Q.message.toLowerCase().includes(r.toLowerCase())||Q.module.toLowerCase().includes(r.toLowerCase()),he=d==="all"||Q.level===d,Te=h==="all"||Q.module===h;let V=!0;if(p||N){const $=new Date(Q.timestamp);if(p){const z=new Date(p);z.setHours(0,0,0,0),V=V&&$>=z}if(N){const z=new Date(N);z.setHours(23,59,59,999),V=V&&$<=z}}return _e&&he&&Te&&V}),[a,r,d,h,p,N]),D=Oo[M].rowHeight+P,K=Z0({count:pe.length,getScrollElement:()=>H.current,estimateSize:()=>D,overscan:50}),B=u.useRef(!1),ue=u.useRef(pe.length);return u.useEffect(()=>{const Q=H.current;if(!Q)return;const _e=()=>{if(B.current)return;const{scrollTop:he,scrollHeight:Te,clientHeight:V}=Q,$=Te-he-V;$>100&&y?b(!1):$<50&&!y&&b(!0)};return Q.addEventListener("scroll",_e,{passive:!0}),()=>Q.removeEventListener("scroll",_e)},[y]),u.useEffect(()=>{const Q=pe.length>ue.current;ue.current=pe.length,y&&pe.length>0&&Q&&(B.current=!0,K.scrollToIndex(pe.length-1,{align:"end",behavior:"auto"}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{B.current=!1})}))},[pe.length,y,K]),e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 space-y-2 sm:space-y-3 p-2 sm:p-3 lg:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 hidden sm:block",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:F("h-2 w-2 sm:h-2.5 sm:w-2.5 rounded-full",w?"bg-green-500 animate-pulse":"bg-red-500")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:w?"":""})]})]}),e.jsx(Ce,{className:"p-2 sm:p-3",children:e.jsx(uc,{open:C,onOpenChange:R,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(Ut,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:r,onChange:Q=>c(Q.target.value),className:"pl-8 h-8 text-xs sm:text-sm"})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:y?"default":"outline",size:"sm",onClick:ce,className:"h-8 px-2",title:y?"":"",children:[y?e.jsx(L1,{className:"h-3.5 w-3.5"}):e.jsx(U1,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden sm:inline",children:y?"":""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:Ne,className:"h-8 px-2",title:"",children:[e.jsx(us,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden md:inline",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"h-8 px-2 hidden sm:flex",title:"",children:[e.jsx(na,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden lg:inline",children:""})]}),e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"h-8 px-2",title:C?"":"",children:[e.jsx(Bo,{className:"h-3.5 w-3.5"}),C?e.jsx(Yr,{className:"h-3.5 w-3.5 ml-1"}):e.jsx($a,{className:"h-3.5 w-3.5 ml-1"})]})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center sm:text-right -mt-1",children:[e.jsxs("span",{className:"font-mono",children:[pe.length," / ",a.length]}),e.jsx("span",{className:"ml-1",children:""})]}),e.jsxs(xc,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(Pe,{value:d,onValueChange:m,children:[e.jsxs(Be,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Fe,{placeholder:""})]}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),e.jsx(ee,{value:"DEBUG",children:"DEBUG"}),e.jsx(ee,{value:"INFO",children:"INFO"}),e.jsx(ee,{value:"WARNING",children:"WARNING"}),e.jsx(ee,{value:"ERROR",children:"ERROR"}),e.jsx(ee,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsxs(Pe,{value:h,onValueChange:f,children:[e.jsxs(Be,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(Bo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Fe,{placeholder:""})]}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),O.map(Q=>e.jsx(ee,{value:Q,children:Q},Q))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(hl,{children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:F("w-full sm:flex-1 justify-start text-left font-normal h-8",!p&&"text-muted-foreground"),children:[e.jsx(Vo,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:p?Tm(p,"PP",{locale:Ro}):""})]})}),e.jsx(nl,{className:"w-auto p-0",align:"start",children:e.jsx(Zg,{mode:"single",selected:p,onSelect:g,initialFocus:!0,locale:Ro})})]}),e.jsxs(hl,{children:[e.jsx(fl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:F("w-full sm:flex-1 justify-start text-left font-normal h-8",!N&&"text-muted-foreground"),children:[e.jsx(Vo,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:N?Tm(N,"PP",{locale:Ro}):""})]})}),e.jsx(nl,{className:"w-auto p-0",align:"start",children:e.jsx(Zg,{mode:"single",selected:N,onSelect:j,initialFocus:!0,locale:Ro})})]}),(p||N)&&e.jsxs(_,{variant:"outline",size:"sm",onClick:ge,className:"w-full sm:w-auto h-8",children:[e.jsx(_a,{className:"h-3.5 w-3.5 sm:mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3 pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx($1,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:""})]}),e.jsx("div",{className:"flex gap-1",children:Object.keys(Oo).map(Q=>e.jsx(_,{variant:M===Q?"default":"outline",size:"sm",onClick:()=>S(Q),className:"h-6 px-2 text-xs",children:Oo[Q].label},Q))})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:""}),e.jsx(Wa,{value:[P],onValueChange:([Q])=>E(Q),min:0,max:12,step:2,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-7",children:[P,"px"]})]}),e.jsxs("div",{className:"flex gap-2 sm:hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:me,className:"flex-1 h-8",children:[e.jsx(ut,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,className:"flex-1 h-8",children:[e.jsx(na,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]})]})]})]})})})]}),e.jsx("div",{className:"flex-1 min-h-0 px-2 sm:px-3 lg:px-4 pb-2 sm:pb-3 lg:pb-4",children:e.jsx(Ce,{className:"bg-black dark:bg-gray-950 border-gray-800 dark:border-gray-900 h-full overflow-hidden",children:e.jsx("div",{ref:H,className:F("h-full overflow-auto","[&::-webkit-scrollbar]:w-2.5","[&::-webkit-scrollbar-track]:bg-transparent","[&::-webkit-scrollbar-thumb]:bg-border [&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-thumb:hover]:bg-border/80"),children:e.jsx("div",{className:F("p-2 sm:p-3 font-mono relative",Oo[M].class),style:{height:`${K.getTotalSize()}px`},children:pe.length===0?e.jsx("div",{className:"text-gray-500 dark:text-gray-600 text-center py-8 text-xs sm:text-sm",children:""}):K.getVirtualItems().map(Q=>{const _e=pe[Q.index];return e.jsxs("div",{"data-index":Q.index,ref:K.measureElement,className:F("absolute top-0 left-0 w-full px-2 sm:px-3 rounded hover:bg-white/5 transition-colors",L(_e.level)),style:{transform:`translateY(${Q.start}px)`,paddingTop:`${P/2}px`,paddingBottom:`${P/2}px`},children:[e.jsxs("div",{className:"flex flex-col gap-0.5 sm:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 text-[10px]",children:_e.timestamp}),e.jsxs("span",{className:F("font-semibold text-[10px]",X(_e.level)),children:["[",_e.level,"]"]})]}),e.jsx("div",{className:"text-cyan-400 dark:text-cyan-500 truncate text-[10px]",children:_e.module}),e.jsx("div",{className:"text-gray-300 dark:text-gray-400 whitespace-pre-wrap break-words text-[10px]",children:_e.message})]}),e.jsxs("div",{className:"hidden sm:flex gap-2 items-start",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 flex-shrink-0 w-[130px] lg:w-[160px]",children:_e.timestamp}),e.jsxs("span",{className:F("flex-shrink-0 w-[65px] lg:w-[75px] font-semibold",X(_e.level)),children:["[",_e.level,"]"]}),e.jsx("span",{className:"text-cyan-400 dark:text-cyan-500 flex-shrink-0 w-[100px] lg:w-[130px] truncate",children:_e.module}),e.jsx("span",{className:"text-gray-300 dark:text-gray-400 flex-1 whitespace-pre-wrap break-words",children:_e.message})]})]},Q.key)})})})})})]})}async function Bk(){return(await Se("/api/planner/overview")).json()}async function Ik(a,l=1,r=20,c){const d=new URLSearchParams({page:l.toString(),page_size:r.toString()});return c&&d.append("search",c),(await Se(`/api/planner/chat/${a}/logs?${d}`)).json()}async function Pk(a,l){return(await Se(`/api/planner/log/${a}/${l}`)).json()}async function Fk(){return(await Se("/api/replier/overview")).json()}async function Hk(a,l=1,r=20,c){const d=new URLSearchParams({page:l.toString(),page_size:r.toString()});return c&&d.append("search",c),(await Se(`/api/replier/chat/${a}/logs?${d}`)).json()}async function qk(a,l){return(await Se(`/api/replier/log/${a}/${l}`)).json()}function rN(){const[a,l]=u.useState(new Map),[r,c]=u.useState(!0),d=u.useCallback(async()=>{try{c(!0);const h=await xx();if(h?.data){const f=new Map;h.data.forEach(p=>{f.set(p.chat_id,p.chat_name)}),l(f)}}catch(h){console.error(":",h)}finally{c(!1)}},[]);u.useEffect(()=>{d()},[d]);const m=u.useCallback(h=>a.get(h)||h,[a]);return{chatNameMap:a,getChatName:m,loading:r,reload:d}}function Jo(a){return new Date(a*1e3).toLocaleString("zh-CN")}function iN(a){const r=Date.now()/1e3-a;return r<60?"":r<3600?`${Math.floor(r/60)} `:r<86400?`${Math.floor(r/3600)} `:`${Math.floor(r/86400)} `}function cN(a,l,r=1e4){u.useEffect(()=>{if(!a)return;const c=setInterval(l,r);return()=>clearInterval(c)},[a,l,r])}function Vk({autoRefresh:a,refreshKey:l}){const[r,c]=u.useState("overview"),[d,m]=u.useState(null),{getChatName:h}=rN(),[f,p]=u.useState(null),[g,N]=u.useState(!0),[j,y]=u.useState(null),[b,w]=u.useState(!1),[A,M]=u.useState(1),[S,P]=u.useState(20),[E,C]=u.useState(""),[R,H]=u.useState(""),[O,X]=u.useState(""),[L,me]=u.useState(null),[Ne,je]=u.useState(!1),[ce,ge]=u.useState(!1),pe=u.useCallback(async()=>{try{N(!0);const $=await Bk();p($)}catch($){console.error(":",$)}finally{N(!1)}},[]),D=u.useCallback(async()=>{if(d)try{w(!0);const $=await Ik(d.chat_id,A,S,R||void 0);y($)}catch($){console.error(":",$)}finally{w(!1)}},[d,A,S,R]);u.useEffect(()=>{pe()},[pe]),u.useEffect(()=>{l>0&&(r==="overview"?pe():D())},[l,r,pe,D]),u.useEffect(()=>{r==="chat-logs"&&d&&D()},[r,d,D]),cN(a,u.useCallback(()=>{r==="overview"?pe():D()},[r,pe,D]));const K=$=>{m($),M(1),H(""),X(""),c("chat-logs")},B=()=>{c("overview"),m(null),y(null),H(""),X("")},ue=()=>{H(O),M(1)},Q=()=>{X(""),H(""),M(1)},_e=async($,z)=>{try{ge(!0),je(!0);const G=await Pk($,z);me(G)}catch(G){console.error(":",G)}finally{ge(!1)}},he=$=>{P(Number($)),M(1)},Te=()=>{const $=parseInt(E),z=j?Math.ceil(j.total/j.page_size):0;!isNaN($)&&$>=1&&$<=z&&(M($),C(""))},V=j?Math.ceil(j.total/j.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(As,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(lx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(As,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_plans||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map(($,z)=>e.jsx(As,{className:"h-24 w-full"},z))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map($=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>K($),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h($.chat_id),children:h($.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:$.plan_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",iN($.latest_timestamp)]})]},$.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(Ua,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",j?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{placeholder:"...",value:O,onChange:$=>X($.target.value),onKeyDown:$=>$.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(Ut,{className:"h-4 w-4"})}),R&&e.jsx(_,{variant:"ghost",size:"sm",onClick:Q,children:""})]}),e.jsxs(Pe,{value:S.toString(),onValueChange:he,children:[e.jsx(Be,{className:"w-full sm:w-32",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"10",children:"10/"}),e.jsx(ee,{value:"20",children:"20/"}),e.jsx(ee,{value:"50",children:"50/"}),e.jsx(ee,{value:"100",children:"100/"})]})]})]})]}),R&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',R,'"']})]})]}),e.jsx(Ae,{children:b?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map(($,z)=>e.jsx(As,{className:"h-20 w-full"},z))}):j?.data&&j.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:j.data.map($=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e($.chat_id,$.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo($.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[$.action_count," "]}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:[$.total_plan_ms.toFixed(0),"ms"]})]})]}),$.action_types&&$.action_types.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:$.action_types.map((z,G)=>e.jsx(ke,{variant:"outline",className:"text-xs bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800",children:z},G))}),e.jsx("p",{className:"text-sm line-clamp-2",children:$.reasoning_preview||""})]},$.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",j.total,"  ",A," / ",V," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(1),disabled:A===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.max(1,$-1)),disabled:A===1,children:e.jsx(Ia,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(ne,{type:"number",min:1,max:V,value:E,onChange:$=>C($.target.value),onKeyDown:$=>$.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[A,"/",V]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.min(V,$+1)),disabled:A===V,children:e.jsx(ra,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(V),disabled:A===V,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Js,{open:Ne,onOpenChange:je,children:e.jsxs(qs,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(La,{className:"h-5 w-5"}),""]}),e.jsx(nt,{children:""})]}),e.jsx(ss,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:ce?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map(($,z)=>e.jsx(As,{className:"h-24 w-full"},z))}):L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ia,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:L.chat_id,children:h(L.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(L.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx(ke,{variant:"outline",children:L.type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{children:[L.actions.length," "]})]})]})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Ue,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.prompt_build_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Ue,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.llm_duration_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Ue,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.total_plan_ms?.toFixed(2)||0,"ms"]})})]})]})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(dx,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.reasoning||""})})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(sv,{className:"h-4 w-4"})," (",L.actions.length,")"]}),e.jsx("div",{className:"space-y-3",children:L.actions.map(($,z)=>e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ke,{variant:"default",children:[" ",z+1]}),e.jsx(ke,{variant:"outline",children:$.action_type})]})})}),e.jsxs(Ae,{className:"p-4 pt-0 space-y-3",children:[$.reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof $.reasoning=="string"?$.reasoning:JSON.stringify($.reasoning)})]}),$.action_message&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),typeof $.action_message=="string"?e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded break-all whitespace-pre-wrap",children:$.action_message}):e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify($.action_message,null,2)})]}),$.action_data&&Object.keys($.action_data).length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto",children:JSON.stringify($.action_data,null,2)})]}),$.action_reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof $.action_reasoning=="string"?$.action_reasoning:JSON.stringify($.action_reasoning)})]})]})]},z))})]}),e.jsx(la,{}),L.raw_output&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.raw_output})})]})]}),L.prompt&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.prompt})})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(xt,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function Gk({autoRefresh:a,refreshKey:l}){const[r,c]=u.useState("overview"),[d,m]=u.useState(null),{getChatName:h}=rN(),[f,p]=u.useState(null),[g,N]=u.useState(!0),[j,y]=u.useState(null),[b,w]=u.useState(!1),[A,M]=u.useState(1),[S,P]=u.useState(20),[E,C]=u.useState(""),[R,H]=u.useState(""),[O,X]=u.useState(""),[L,me]=u.useState(null),[Ne,je]=u.useState(!1),[ce,ge]=u.useState(!1),pe=u.useCallback(async()=>{try{N(!0);const $=await Fk();p($)}catch($){console.error(":",$)}finally{N(!1)}},[]),D=u.useCallback(async()=>{if(d)try{w(!0);const $=await Hk(d.chat_id,A,S,R||void 0);y($)}catch($){console.error(":",$)}finally{w(!1)}},[d,A,S,R]);u.useEffect(()=>{pe()},[pe]),u.useEffect(()=>{l>0&&(r==="overview"?pe():D())},[l,r,pe,D]),u.useEffect(()=>{r==="chat-logs"&&d&&D()},[r,d,D]),cN(a,u.useCallback(()=>{r==="overview"?pe():D()},[r,pe,D]));const K=$=>{m($),M(1),H(""),X(""),c("chat-logs")},B=()=>{c("overview"),m(null),y(null),H(""),X("")},ue=()=>{H(O),M(1)},Q=()=>{X(""),H(""),M(1)},_e=async($,z)=>{try{ge(!0),je(!0);const G=await qk($,z);me(G)}catch(G){console.error(":",G)}finally{ge(!1)}},he=$=>{P(Number($)),M(1)},Te=()=>{const $=parseInt(E),z=j?Math.ceil(j.total/j.page_size):0;!isNaN($)&&$>=1&&$<=z&&(M($),C(""))},V=j?Math.ceil(j.total/j.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:r==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(As,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(lx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(As,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_replies||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map(($,z)=>e.jsx(As,{className:"h-24 w-full"},z))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map($=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>K($),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h($.chat_id),children:h($.chat_id)})]}),e.jsx(ke,{variant:"secondary",children:$.reply_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",iN($.latest_timestamp)]})]},$.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(Ua,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:d?h(d.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",j?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:d?h(d.chat_id):""})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{placeholder:"...",value:O,onChange:$=>X($.target.value),onKeyDown:$=>$.key==="Enter"&&ue(),className:"w-full sm:w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:ue,children:e.jsx(Ut,{className:"h-4 w-4"})}),R&&e.jsx(_,{variant:"ghost",size:"sm",onClick:Q,children:""})]}),e.jsxs(Pe,{value:S.toString(),onValueChange:he,children:[e.jsx(Be,{className:"w-full sm:w-32",children:e.jsx(Fe,{})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"10",children:"10/"}),e.jsx(ee,{value:"20",children:"20/"}),e.jsx(ee,{value:"50",children:"50/"}),e.jsx(ee,{value:"100",children:"100/"})]})]})]})]}),R&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',R,'"']})]})]}),e.jsx(Ae,{children:b?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map(($,z)=>e.jsx(As,{className:"h-20 w-full"},z))}):j?.data&&j.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:j.data.map($=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e($.chat_id,$.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Jo($.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[$.success?e.jsxs(ke,{variant:"default",className:"text-xs bg-green-600",children:[e.jsx(Sg,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",className:"text-xs",children:[e.jsx(ta,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(ke,{variant:"outline",className:"text-xs",children:$.model}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[$.overall_ms.toFixed(0),"ms"]})]})]}),e.jsx("p",{className:"text-sm line-clamp-2",children:$.output_preview||""})]},$.filename))}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",j.total,"  ",A," / ",V," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(1),disabled:A===1,className:"hidden sm:flex",children:e.jsx(yn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.max(1,$-1)),disabled:A===1,children:e.jsx(Ia,{className:"h-4 w-4"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[e.jsx(ne,{type:"number",min:1,max:V,value:E,onChange:$=>C($.target.value),onKeyDown:$=>$.key==="Enter"&&Te(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:Te,children:""})]}),e.jsxs("span",{className:"sm:hidden text-sm text-muted-foreground",children:[A,"/",V]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M($=>Math.min(V,$+1)),disabled:A===V,children:e.jsx(ra,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>M(V),disabled:A===V,className:"hidden sm:flex",children:e.jsx(wn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Js,{open:Ne,onOpenChange:je,children:e.jsxs(qs,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(La,{className:"h-5 w-5"}),""]}),e.jsx(nt,{children:""})]}),e.jsx(ss,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:ce?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map(($,z)=>e.jsx(As,{className:"h-24 w-full"},z))}):L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ia,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:L.chat_id,children:h(L.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Jo(L.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),L.success?e.jsxs(ke,{variant:"default",className:"bg-green-600",children:[e.jsx(Sg,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(ke,{variant:"destructive",children:[e.jsx(ta,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(ke,{variant:"outline",children:["Level ",L.think_level]})]})]})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(B1,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx(ke,{variant:"secondary",className:"text-sm",children:L.model})})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(el,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Ue,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.prompt_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Ue,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.llm_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Ue,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[L.timing.overall_ms?.toFixed(2)||0,"ms"]})})]})]}),L.timing.timing_logs&&L.timing.timing_logs.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"space-y-1",children:L.timing.timing_logs.map(($,z)=>e.jsx("div",{className:"text-xs text-muted-foreground",children:$},z))})]}),L.timing.almost_zero&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),L.timing.almost_zero]})]}),e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(dx,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.output||""})})]}),L.processed_output&&L.processed_output.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-2",children:L.processed_output.map(($,z)=>e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:$})},z))})]})]}),L.reasoning&&e.jsxs(e.Fragment,{children:[e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:L.reasoning})})]})]}),L.error&&e.jsxs(e.Fragment,{children:[e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-destructive",children:""}),e.jsx("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:e.jsx("p",{className:"text-sm text-destructive whitespace-pre-wrap",children:L.error})})]})]}),L.prompt&&e.jsxs(e.Fragment,{children:[e.jsx(la,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:L.prompt})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(xt,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>je(!1),children:""})})]})})]})}function Kk(){const[a,l]=u.useState("planner"),[r,c]=u.useState(!1),[d,m]=u.useState(0),h=u.useCallback(()=>{m(f=>f+1)},[]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:" & "}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:r?"default":"outline",size:"sm",onClick:()=>c(!r),children:[e.jsx(ut,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),r?"":""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:h,children:e.jsx(ut,{className:"h-4 w-4"})})]})]}),e.jsxs(Yt,{value:a,onValueChange:f=>l(f),className:"w-full",children:[e.jsxs(Vt,{className:"grid w-full grid-cols-2 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Ye,{value:"planner",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(ax,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Ye,{value:"replier",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(I1,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(ss,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(Ms,{value:"planner",className:"mt-0",children:e.jsx(Vk,{autoRefresh:r,refreshKey:d})}),e.jsx(Ms,{value:"replier",className:"mt-0",children:e.jsx(Gk,{autoRefresh:r,refreshKey:d})})]})]})]})}const Qk="Mai-with-u",Yk="plugin-repo",Jk="main",Xk="plugin_details.json";async function Zk(){try{const a=await Se("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:Qk,repo:Yk,branch:Jk,file_path:Xk})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(!l.success||!l.data)throw new Error(l.error||"");return JSON.parse(l.data).filter(d=>!d?.id||!d?.manifest?(console.warn(":",d),!1):!d.manifest.name||!d.manifest.version?(console.warn(":",d.id),!1):!0).map(d=>({id:d.id,manifest:{manifest_version:d.manifest.manifest_version||1,name:d.manifest.name,version:d.manifest.version,description:d.manifest.description||"",author:d.manifest.author||{name:"Unknown"},license:d.manifest.license||"Unknown",host_application:d.manifest.host_application||{min_version:"0.0.0"},homepage_url:d.manifest.homepage_url,repository_url:d.manifest.repository_url,keywords:d.manifest.keywords||[],categories:d.manifest.categories||[],default_locale:d.manifest.default_locale||"zh-CN",locales_path:d.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()}))}catch(a){throw console.error("Failed to fetch plugin list:",a),a}}async function oN(){try{const a=await Se("/api/webui/plugins/git-status");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to check Git status:",a),{installed:!1,error:" Git "}}}async function dN(){try{const a=await Se("/api/webui/plugins/version");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to get Maimai version:",a),{version:"0.0.0",version_major:0,version_minor:0,version_patch:0}}}function uN(a,l,r){const c=a.split(".").map(f=>parseInt(f)||0),d=c[0]||0,m=c[1]||0,h=c[2]||0;if(r.version_major<d||r.version_major===d&&r.version_minor<m||r.version_major===d&&r.version_minor===m&&r.version_patch<h)return!1;if(l){const f=l.split(".").map(j=>parseInt(j)||0),p=f[0]||0,g=f[1]||0,N=f[2]||0;if(r.version_major>p||r.version_major===p&&r.version_minor>g||r.version_major===p&&r.version_minor===g&&r.version_patch>N)return!1}return!0}async function Wk(){try{const a=await Se("/api/webui/ws-token");if(!a.ok)return console.error(" WebSocket token :",a.status),null;const l=await a.json();return l.success&&l.token?l.token:null}catch(a){return console.error(" WebSocket token :",a),null}}async function eC(a,l){const r=await Wk();if(!r)return console.warn(" WebSocket token"),null;const c=window.location.protocol==="https:"?"wss:":"ws:",d=window.location.host,m=`${c}//${d}/api/webui/ws/plugin-progress?token=${encodeURIComponent(r)}`;try{const h=new WebSocket(m);return h.onopen=()=>{console.log("Plugin progress WebSocket connected");const f=setInterval(()=>{h.readyState===WebSocket.OPEN?h.send("ping"):clearInterval(f)},3e4)},h.onmessage=f=>{try{if(f.data==="pong")return;const p=JSON.parse(f.data);a(p)}catch(p){console.error("Failed to parse progress data:",p)}},h.onerror=f=>{console.error("Plugin progress WebSocket error:",f),l?.(f)},h.onclose=()=>{console.log("Plugin progress WebSocket disconnected")},h}catch(h){return console.error(" WebSocket :",h),null}}async function Ll(){try{const a=await Se("/api/webui/plugins/installed",{headers:Ws()});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(!l.success)throw new Error(l.message||"");return l.plugins||[]}catch(a){return console.error("Failed to get installed plugins:",a),[]}}function gn(a,l){return l.some(r=>r.id===a)}function jn(a,l){const r=l.find(c=>c.id===a);if(r)return r.manifest?.version||r.version}async function mN(a,l,r="main"){const c=await Se("/api/webui/plugins/install",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:l,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function xN(a){const l=await Se("/api/webui/plugins/uninstall",{method:"POST",body:JSON.stringify({plugin_id:a})});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function hN(a,l,r="main"){const c=await Se("/api/webui/plugins/update",{method:"POST",body:JSON.stringify({plugin_id:a,repository_url:l,branch:r})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"")}return await c.json()}async function sC(a){const l=await Se(`/api/webui/plugins/config/${a}/schema`,{headers:Ws()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||" Schema ")}catch{throw new Error(` Schema  (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||" Schema ");return r.schema}async function tC(a){const l=await Se(`/api/webui/plugins/config/${a}`,{headers:Ws()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||"");return r.config}async function aC(a){const l=await Se(`/api/webui/plugins/config/${a}/raw`,{headers:Ws()});if(!l.ok){const c=await l.text();try{const d=JSON.parse(c);throw new Error(d.detail||"")}catch{throw new Error(` (${l.status})`)}}const r=await l.json();if(!r.success)throw new Error(r.message||"");return r.config}async function lC(a,l){const r=await Se(`/api/webui/plugins/config/${a}`,{method:"PUT",headers:Ws(),body:JSON.stringify({config:l})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function nC(a,l){const r=await Se(`/api/webui/plugins/config/${a}/raw`,{method:"PUT",headers:Ws(),body:JSON.stringify({config:l})});if(!r.ok){const c=await r.json();throw new Error(c.detail||"")}return await r.json()}async function rC(a){const l=await Se(`/api/webui/plugins/config/${a}/reset`,{method:"POST",headers:Ws()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}async function iC(a){const l=await Se(`/api/webui/plugins/config/${a}/toggle`,{method:"POST",headers:Ws()});if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return await l.json()}const jc="https://maibot-plugin-stats.maibot-webui.workers.dev";async function fN(a){try{const l=await fetch(`${jc}/stats/${a}`);return l.ok?await l.json():(console.error("Failed to fetch plugin stats:",l.statusText),null)}catch(l){return console.error("Error fetching plugin stats:",l),null}}async function cC(a,l){try{const r=l||kx(),c=await fetch(`${jc}/stats/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error liking plugin:",r),{success:!1,error:""}}}async function oC(a,l){try{const r=l||kx(),c=await fetch(`${jc}/stats/dislike`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,user_id:r})}),d=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...d}:{success:!1,error:d.error||""}}catch(r){return console.error("Error disliking plugin:",r),{success:!1,error:""}}}async function dC(a,l,r,c){if(l<1||l>5)return{success:!1,error:" 1-5 "};try{const d=c||kx(),m=await fetch(`${jc}/stats/rate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a,rating:l,comment:r,user_id:d})}),h=await m.json();return m.status===429?{success:!1,error:" 3 "}:m.ok?{success:!0,...h}:{success:!1,error:h.error||""}}catch(d){return console.error("Error rating plugin:",d),{success:!1,error:""}}}async function pN(a){try{const l=await fetch(`${jc}/stats/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:a})}),r=await l.json();return l.status===429?(console.warn("Download recording rate limited"),{success:!0}):l.ok?{success:!0,...r}:(console.error("Failed to record download:",r.error),{success:!1,error:r.error})}catch(l){return console.error("Error recording download:",l),{success:!1,error:""}}}function uC(){const a=navigator,l=[navigator.userAgent,navigator.language,navigator.languages?.join(",")||"",navigator.platform,navigator.hardwareConcurrency||0,screen.width,screen.height,screen.colorDepth,screen.pixelDepth,new Date().getTimezoneOffset(),Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.maxTouchPoints||0,a.deviceMemory||0].join("|");let r=0;for(let c=0;c<l.length;c++){const d=l.charCodeAt(c);r=(r<<5)-r+d,r=r&r}return`fp_${Math.abs(r).toString(36)}`}function kx(){const a="maibot_user_id";let l=localStorage.getItem(a);if(!l){const r=uC(),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,15);l=`${r}_${c}_${d}`,localStorage.setItem(a,l)}return l}const mC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function xC(){return e.jsx(tr,{children:e.jsx(hC,{})})}function hC(){const a=xa(),{triggerRestart:l,isRestarting:r}=_n(),[c,d]=u.useState(""),[m,h]=u.useState("all"),[f,p]=u.useState("all"),[g,N]=u.useState(!0),[j,y]=u.useState([]),[b,w]=u.useState(!0),[A,M]=u.useState(null),[S,P]=u.useState(null),[E,C]=u.useState(null),[R,H]=u.useState(null),[,O]=u.useState([]),[X,L]=u.useState({}),[me,Ne]=u.useState(!1),[je,ce]=u.useState(null),[ge,pe]=u.useState("main"),[D,K]=u.useState(""),[B,ue]=u.useState("preset"),[Q,_e]=u.useState(!1),{toast:he}=it(),Te=async J=>{const Z=J.map(async Ee=>{try{const de=await fN(Ee.id);return{id:Ee.id,stats:de}}catch(de){return console.warn(`Failed to load stats for ${Ee.id}:`,de),{id:Ee.id,stats:null}}}),Le=await Promise.all(Z),ae={};Le.forEach(({id:Ee,stats:de})=>{de&&(ae[Ee]=de)}),L(ae)};u.useEffect(()=>{let J=null,Z=!1;return(async()=>{if(J=await eC(ae=>{Z||(C(ae),ae.stage==="success"?setTimeout(()=>{Z||C(null)},2e3):ae.stage==="error"&&(w(!1),M(ae.error||"")))},ae=>{console.error("WebSocket error:",ae),Z||he({title:"WebSocket ",description:"",variant:"destructive"})}),await new Promise(ae=>{if(!J){ae();return}const Ee=()=>{J&&J.readyState===WebSocket.OPEN?(console.log("WebSocket connected, starting to load plugins"),ae()):J&&J.readyState===WebSocket.CLOSED?(console.warn("WebSocket closed before loading plugins"),ae()):setTimeout(Ee,100)};Ee()}),!Z){const ae=await oN();P(ae),ae.installed||he({title:"Git ",description:ae.error||" Git ",variant:"destructive"})}if(!Z){const ae=await dN();H(ae)}if(!Z)try{w(!0),M(null);const ae=await Zk();if(!Z){const Ee=await Ll();O(Ee);const de=ae.map(ze=>{const ws=gn(ze.id,Ee),Zs=jn(ze.id,Ee);return{...ze,installed:ws,installed_version:Zs}});for(const ze of Ee)!de.some(Zs=>Zs.id===ze.id)&&ze.manifest&&de.push({id:ze.id,manifest:{manifest_version:ze.manifest.manifest_version||1,name:ze.manifest.name,version:ze.manifest.version,description:ze.manifest.description||"",author:ze.manifest.author,license:ze.manifest.license||"Unknown",host_application:ze.manifest.host_application,homepage_url:ze.manifest.homepage_url,repository_url:ze.manifest.repository_url,keywords:ze.manifest.keywords||[],categories:ze.manifest.categories||[],default_locale:ze.manifest.default_locale||"zh-CN",locales_path:ze.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!0,installed_version:ze.manifest.version,published_at:new Date().toISOString(),updated_at:new Date().toISOString()});y(de),Te(de)}}catch(ae){if(!Z){const Ee=ae instanceof Error?ae.message:"";M(Ee),he({title:"",description:Ee,variant:"destructive"})}}finally{Z||w(!1)}})(),()=>{Z=!0,J&&J.close()}},[he]);const V=J=>{if(!J.installed&&R&&!$(J))return e.jsxs(ke,{variant:"destructive",className:"gap-1",children:[e.jsx(Rt,{className:"h-3 w-3"}),""]});if(J.installed){const Z=J.installed_version?.trim(),Le=J.manifest.version?.trim();if(Z!==Le){const ae=Z?.split(".").map(Number)||[0,0,0],Ee=Le?.split(".").map(Number)||[0,0,0];for(let de=0;de<3;de++){if((Ee[de]||0)>(ae[de]||0))return e.jsxs(ke,{variant:"outline",className:"gap-1 text-orange-600 border-orange-600",children:[e.jsx(Rt,{className:"h-3 w-3"}),""]});if((Ee[de]||0)<(ae[de]||0))break}}return e.jsxs(ke,{variant:"default",className:"gap-1",children:[e.jsx(tt,{className:"h-3 w-3"}),""]})}return null},$=J=>!R||!J.manifest?.host_application?!0:uN(J.manifest.host_application.min_version,J.manifest.host_application.max_version,R),z=J=>{if(!J.installed||!J.installed_version||!J.manifest?.version)return!1;const Z=J.installed_version.trim(),Le=J.manifest.version.trim();if(Z===Le)return!1;const ae=Z.split(".").map(Number),Ee=Le.split(".").map(Number);for(let de=0;de<3;de++){if((Ee[de]||0)>(ae[de]||0))return!0;if((Ee[de]||0)<(ae[de]||0))return!1}return!1},G=j.filter(J=>{if(!J.manifest)return console.warn("[]  manifest :",J.id),!1;const Z=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(de=>de.toLowerCase().includes(c.toLowerCase())),Le=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m);let ae=!0;f==="installed"?ae=J.installed===!0:f==="updates"&&(ae=J.installed===!0&&z(J));const Ee=!g||!R||$(J);return Z&&Le&&ae&&Ee}),Re=J=>{if(!S?.installed){he({title:"",description:"Git ",variant:"destructive"});return}if(R&&!$(J)){he({title:"",description:"",variant:"destructive"});return}ce(J),pe("main"),K(""),ue("preset"),_e(!1),Ne(!0)},se=async()=>{if(!je)return;const J=B==="custom"?D:ge;if(!J||J.trim()===""){he({title:"",variant:"destructive"});return}try{Ne(!1),await mN(je.id,je.manifest.repository_url||"",J),pN(je.id).catch(Le=>{console.warn("Failed to record download:",Le)}),he({title:"",description:`${je.manifest.name} `});const Z=await Ll();O(Z),y(Le=>Le.map(ae=>{if(ae.id===je.id){const Ee=gn(ae.id,Z),de=jn(ae.id,Z);return{...ae,installed:Ee,installed_version:de}}return ae}))}catch(Z){he({title:"",description:Z instanceof Error?Z.message:"",variant:"destructive"})}finally{ce(null)}},Oe=async J=>{try{await xN(J.id),he({title:"",description:`${J.manifest.name} `});const Z=await Ll();O(Z),y(Le=>Le.map(ae=>{if(ae.id===J.id){const Ee=gn(ae.id,Z),de=jn(ae.id,Z);return{...ae,installed:Ee,installed_version:de}}return ae}))}catch(Z){he({title:"",description:Z instanceof Error?Z.message:"",variant:"destructive"})}},ns=async J=>{if(!S?.installed){he({title:"",description:"Git ",variant:"destructive"});return}try{const Z=await hN(J.id,J.manifest.repository_url||"","main");he({title:"",description:`${J.manifest.name}  ${Z.old_version}  ${Z.new_version}`});const Le=await Ll();O(Le),y(ae=>ae.map(Ee=>{if(Ee.id===J.id){const de=gn(Ee.id,Le),ze=jn(Ee.id,Le);return{...Ee,installed:de,installed_version:ze}}return Ee}))}catch(Z){he({title:"",description:Z instanceof Error?Z.message:"",variant:"destructive"})}};return e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>l(),disabled:r,children:[e.jsx(uv,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),""]}),e.jsxs(_,{onClick:()=>a({to:"/plugin-mirrors"}),children:[e.jsx(P1,{className:"h-4 w-4 mr-2"}),""]})]})]}),e.jsx(Ce,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900",children:e.jsx(Ae,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["",e.jsx("span",{className:"font-semibold",children:""}),""]})]})})}),S&&!S.installed&&e.jsxs(Ce,{className:"border-orange-600 bg-orange-50 dark:bg-orange-950/20",children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qt,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx(Ue,{className:"text-lg text-orange-900 dark:text-orange-100",children:"Git "}),e.jsx(fs,{className:"text-orange-800 dark:text-orange-200",children:S.error||" Git "})]})]})}),e.jsx(Ae,{children:e.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[" ",e.jsx("a",{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer",className:"underline font-medium",children:"git-scm.com"}),"  Git "]})})]}),e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:c,onChange:J=>d(J.target.value),className:"pl-9"})]}),e.jsxs(Pe,{value:m,onValueChange:h,children:[e.jsx(Be,{className:"w-full sm:w-[200px]",children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"all",children:""}),e.jsx(ee,{value:"Group Management",children:""}),e.jsx(ee,{value:"Entertainment & Interaction",children:""}),e.jsx(ee,{value:"Utility Tools",children:""}),e.jsx(ee,{value:"Content Generation",children:""}),e.jsx(ee,{value:"Multimedia",children:""}),e.jsx(ee,{value:"External Integration",children:""}),e.jsx(ee,{value:"Data Analysis & Insights",children:""}),e.jsx(ee,{value:"Other",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"compatible-only",checked:g,onCheckedChange:J=>N(J===!0)}),e.jsx("label",{htmlFor:"compatible-only",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:""})]})]})}),e.jsx(Yt,{value:f,onValueChange:p,className:"w-full",children:e.jsxs(Vt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ye,{value:"all",children:[" (",j.filter(J=>{if(!J.manifest)return!1;const Z=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Le=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m),ae=!g||!R||$(J);return Z&&Le&&ae}).length,")"]}),e.jsxs(Ye,{value:"installed",children:[" (",j.filter(J=>{if(!J.manifest)return!1;const Z=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Le=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m),ae=!g||!R||$(J);return J.installed&&Z&&Le&&ae}).length,")"]}),e.jsxs(Ye,{value:"updates",children:[" (",j.filter(J=>{if(!J.manifest)return!1;const Z=c===""||J.manifest.name?.toLowerCase().includes(c.toLowerCase())||J.manifest.description?.toLowerCase().includes(c.toLowerCase())||J.manifest.keywords&&J.manifest.keywords.some(Ee=>Ee.toLowerCase().includes(c.toLowerCase())),Le=m==="all"||J.manifest.categories&&J.manifest.categories.includes(m),ae=!g||!R||$(J);return J.installed&&z(J)&&Z&&Le&&ae}).length,")"]})]})}),E&&E.stage==="loading"&&E.operation==="fetch"&&e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:""})]}),e.jsxs("span",{className:"text-sm font-medium",children:[E.progress,"%"]})]}),e.jsx(er,{value:E.progress,className:"h-2"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:E.message}),E.total_plugins>0&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[" ",E.loaded_plugins," / ",E.total_plugins," "]})]})}),E&&E.stage==="error"&&E.error&&e.jsx(Ce,{className:"border-destructive bg-destructive/10",children:e.jsx(De,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qt,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx(Ue,{className:"text-lg text-destructive",children:""}),e.jsx(fs,{className:"text-destructive/80",children:E.error})]})]})})}),b?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]}):A?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(qt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:A}),e.jsx(_,{onClick:()=>window.location.reload(),children:""})]})}):G.length===0?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Ut,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||m!=="all"?"":""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:G.map(J=>e.jsxs(Ce,{className:"flex flex-col hover:shadow-lg transition-shadow h-full",children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(Ue,{className:"text-xl",children:J.manifest?.name||J.id}),e.jsxs("div",{className:"flex flex-col gap-1",children:[J.manifest?.categories&&J.manifest.categories[0]&&e.jsx(ke,{variant:"secondary",className:"text-xs whitespace-nowrap",children:mC[J.manifest.categories[0]]||J.manifest.categories[0]}),V(J)]})]}),e.jsx(fs,{className:"line-clamp-2",children:J.manifest?.description||""})]}),e.jsx(Ae,{className:"flex-1",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"h-4 w-4"}),e.jsx("span",{children:(X[J.id]?.downloads??J.downloads??0).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:(X[J.id]?.rating??J.rating??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[J.manifest?.keywords&&J.manifest.keywords.slice(0,3).map(Z=>e.jsx(ke,{variant:"outline",className:"text-xs",children:Z},Z)),J.manifest?.keywords&&J.manifest.keywords.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",J.manifest.keywords.length-3]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t space-y-1",children:[e.jsxs("div",{children:["v",J.manifest?.version||"unknown","  ",J.manifest?.author?.name||"Unknown"]}),J.manifest?.host_application&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:":"}),e.jsxs("span",{className:"font-medium",children:[J.manifest.host_application.min_version,J.manifest.host_application.max_version?` - ${J.manifest.host_application.max_version}`:" - "]})]})]})]})}),e.jsx(id,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>a({to:"/plugin-detail",search:{pluginId:J.id}}),children:""}),J.installed?z(J)?e.jsxs(_,{size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>ns(J),children:[e.jsx(ut,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{variant:"destructive",size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>Oe(J),children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{size:"sm",disabled:!S?.installed||E?.operation==="install"||R!==null&&!$(J),title:S?.installed?R!==null&&!$(J)?` ( ${J.manifest?.host_application?.min_version||""}${J.manifest?.host_application?.max_version?` - ${J.manifest.host_application.max_version}`:"+"} ${R?.version})`:void 0:"Git ",onClick:()=>Re(J),children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),E?.operation==="install"&&E?.plugin_id===J.id?"...":""]})]})}),E&&(E.stage==="loading"||E.stage==="success"||E.stage==="error")&&E.operation!=="fetch"&&E.plugin_id===J.id&&e.jsx("div",{className:"px-6 pb-4 -mt-2",children:e.jsxs("div",{className:`space-y-2 p-3 rounded-lg border ${E.stage==="success"?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-900":E.stage==="error"?"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-900":"bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[E.stage==="loading"?e.jsx(Fs,{className:"h-3 w-3 animate-spin"}):E.stage==="success"?e.jsx(tt,{className:"h-3 w-3 text-green-600"}):e.jsx(Rt,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":E.stage==="error"?"text-red-700 dark:text-red-300":""}`,children:E.stage==="loading"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):E.stage==="success"?e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]}):e.jsxs(e.Fragment,{children:[E.operation==="install"&&"",E.operation==="uninstall"&&"",E.operation==="update"&&""]})})]}),E.stage!=="error"&&e.jsxs("span",{className:`text-xs font-medium ${E.stage==="success"?"text-green-700 dark:text-green-300":""}`,children:[E.progress,"%"]})]}),E.stage!=="error"&&e.jsx(er,{value:E.progress,className:`h-1.5 ${E.stage==="success"?"[&>div]:bg-green-500":""}`}),e.jsx("div",{className:`text-xs ${E.stage==="success"?"text-green-600 dark:text-green-400 truncate":E.stage==="error"?"text-red-600 dark:text-red-400":"text-muted-foreground truncate"}`,children:E.stage==="error"?E.error||E.message||"":E.message})]})})]},J.id))}),e.jsx(Js,{open:me,onOpenChange:Ne,children:e.jsxs(qs,{children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsxs(nt,{children:[" ",je?.manifest.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",je?.manifest.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",typeof je?.manifest.author=="string"?je.manifest.author:je?.manifest.author?.name]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"advanced-options",checked:Q,onCheckedChange:J=>_e(J)}),e.jsx("label",{htmlFor:"advanced-options",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:""})]}),Q&&e.jsx("div",{className:"space-y-4 p-4 border rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:""}),e.jsxs(Yt,{value:B,onValueChange:J=>ue(J),children:[e.jsxs(Vt,{className:"grid w-full grid-cols-2",children:[e.jsx(Ye,{value:"preset",className:"text-xs",children:""}),e.jsx(Ye,{value:"custom",className:"text-xs",children:""})]}),B==="preset"&&e.jsx("div",{className:"mt-3",children:e.jsxs(Pe,{value:ge,onValueChange:pe,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:""})}),e.jsxs(Ie,{children:[e.jsx(ee,{value:"main",children:"main ()"}),e.jsx(ee,{value:"master",children:"master"}),e.jsx(ee,{value:"dev",children:"dev ()"}),e.jsx(ee,{value:"develop",children:"develop"}),e.jsx(ee,{value:"beta",children:"beta ()"}),e.jsx(ee,{value:"stable",children:"stable ()"})]})]})}),B==="custom"&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:": feature/new-feature",value:D,onChange:J=>K(J.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Git "})]})]})]})}),!Q&&e.jsx("p",{className:"text-sm text-muted-foreground",children:" (main) "})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>Ne(!1),children:""}),e.jsxs(_,{onClick:se,children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),""]})]})]})}),e.jsx(ar,{})]})})}function fC(){return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(mv,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(ss,{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)]",children:e.jsxs(Ce,{className:"max-w-2xl w-full border-dashed",children:[e.jsxs(De,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(ua,{className:"h-16 w-16 text-muted-foreground"})}),e.jsx(Ue,{className:"text-2xl",children:""}),e.jsx(fs,{className:"text-base",children:""})]}),e.jsx(Ae,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:" "}),e.jsxs("ul",{className:"space-y-2 ml-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]})]})]})})]})})})]})}function pC({field:a,value:l,onChange:r}){const[c,d]=u.useState(!1);switch(a.ui_type){case"switch":return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:a.label}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]}),e.jsx(Ge,{checked:!!l,onCheckedChange:r,disabled:a.disabled})]});case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ne,{type:"number",value:l??a.default,onChange:m=>r(parseFloat(m.target.value)||0),min:a.min,max:a.max,step:a.step??1,placeholder:a.placeholder,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"slider":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:a.label}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l??a.default})]}),e.jsx(Wa,{value:[l??a.default],onValueChange:m=>r(m[0]),min:a.min??0,max:a.max??100,step:a.step??1,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs(Pe,{value:String(l??a.default),onValueChange:r,disabled:a.disabled,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:a.placeholder??""})}),e.jsx(Ie,{children:a.choices?.map(m=>e.jsx(ee,{value:String(m),children:String(m)},String(m)))})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ft,{value:l??a.default,onChange:m=>r(m.target.value),placeholder:a.placeholder,rows:a.rows??3,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"password":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{type:c?"text":"password",value:l??"",onChange:m=>r(m.target.value),placeholder:a.placeholder,disabled:a.disabled,className:"pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>d(!c),children:c?e.jsx(nc,{className:"h-4 w-4"}):e.jsx(ma,{className:"h-4 w-4"})})]}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"list":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(bS,{value:Array.isArray(l)?l:[],onChange:m=>r(m),itemType:a.item_type??"string",itemFields:a.item_fields,minItems:a.min_items,maxItems:a.max_items,disabled:a.disabled,placeholder:a.placeholder}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]});case"text":default:return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:a.label}),e.jsx(ne,{type:"text",value:l??a.default??"",onChange:m=>r(m.target.value),placeholder:a.placeholder,maxLength:a.max_length,disabled:a.disabled}),a.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.hint})]})}}function Wg({section:a,config:l,onChange:r}){const[c,d]=u.useState(!a.collapsed),m=Object.entries(a.fields).filter(([,h])=>!h.hidden).sort(([,h],[,f])=>h.order-f.order);return e.jsx(uc,{open:c,onOpenChange:d,children:e.jsxs(Ce,{children:[e.jsx(mc,{asChild:!0,children:e.jsxs(De,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx($a,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(Ue,{className:"text-lg",children:a.title})]}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:[m.length," "]})]}),a.description&&e.jsx(fs,{className:"ml-6",children:a.description})]})}),e.jsx(xc,{children:e.jsx(Ae,{className:"space-y-4 pt-0",children:m.map(([h,f])=>e.jsx(pC,{field:f,value:l[a.name]?.[h],onChange:p=>r(a.name,h,p),sectionName:a.name},h))})})]})})}function gC({plugin:a,onBack:l}){const{toast:r}=it(),{triggerRestart:c,isRestarting:d}=_n(),[m,h]=u.useState("visual"),[f,p]=u.useState(null),[g,N]=u.useState({}),[j,y]=u.useState({}),[b,w]=u.useState(""),[A,M]=u.useState(""),[S,P]=u.useState(!0),[E,C]=u.useState(!1),[R,H]=u.useState(!1),[O,X]=u.useState(!1),[L,me]=u.useState(!1),Ne=u.useCallback(async()=>{P(!0);try{const[B,ue,Q]=await Promise.all([sC(a.id),tC(a.id),aC(a.id)]);p(B),N(ue),y(JSON.parse(JSON.stringify(ue))),w(Q),M(Q)}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}finally{P(!1)}},[a.id,r]);u.useEffect(()=>{Ne()},[Ne]),u.useEffect(()=>{H(m==="visual"?JSON.stringify(g)!==JSON.stringify(j):b!==A)},[g,j,b,A,m]);const je=(B,ue,Q)=>{N(_e=>({..._e,[B]:{..._e[B]||{},[ue]:Q}}))},ce=async()=>{C(!0);try{if(m==="source"){try{Nx(b)}catch(B){X(!0),r({title:"TOML ",description:B instanceof Error?B.message:" TOML ",variant:"destructive"}),C(!1);return}await nC(a.id,b),M(b),X(!1)}else await lC(a.id,g),y(JSON.parse(JSON.stringify(g)));r({title:"",description:""})}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}finally{C(!1)}},ge=async()=>{try{await rC(a.id),r({title:"",description:""}),me(!1),Ne()}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}},pe=async()=>{try{const B=await iC(a.id);r({title:B.message,description:B.note}),Ne()}catch(B){r({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}};if(S)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!f)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx(Rt,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsxs(_,{onClick:l,variant:"outline",children:[e.jsx(Ua,{className:"h-4 w-4 mr-2"}),""]})]});const D=Object.values(f.sections).sort((B,ue)=>B.order-ue.order),K=g.plugin?.enabled!==!1;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:l,children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:f.plugin_info.name||a.manifest.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ke,{variant:K?"default":"secondary",children:K?"":""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["v",f.plugin_info.version||a.manifest.version]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-10 sm:ml-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>h(m==="visual"?"source":"visual"),children:m==="visual"?e.jsxs(e.Fragment,{children:[e.jsx(cv,{className:"h-4 w-4 mr-2"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(iv,{className:"h-4 w-4 mr-2"}),""]})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>c(),disabled:d,children:[e.jsx(uv,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:pe,children:[e.jsx(hc,{className:"h-4 w-4 mr-2"}),K?"":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>me(!0),children:[e.jsx(lc,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs(_,{size:"sm",onClick:ce,disabled:!R||E,children:[E?e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(fc,{className:"h-4 w-4 mr-2"}),""]})]})]}),R&&e.jsx(Ce,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20 dark:border-orange-900",children:e.jsx(Ae,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{className:"h-4 w-4 text-orange-600"}),e.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:""})]})})}),m==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsxs(gt,{children:[e.jsx("strong",{children:""})," TOML ",O&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(Vv,{value:b,onChange:B=>{w(B),O&&X(!1)},language:"toml",theme:"dark",height:"calc(100vh - 350px)",minHeight:"500px",placeholder:"TOML "})]}),m==="visual"&&e.jsxs(e.Fragment,{children:[e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsxs(gt,{children:[e.jsx("strong",{children:""}),"WebUI  "]})]}),f.layout.type==="tabs"&&f.layout.tabs.length>0?e.jsxs(Yt,{defaultValue:f.layout.tabs[0]?.id,children:[e.jsx(Vt,{children:f.layout.tabs.map(B=>e.jsxs(Ye,{value:B.id,children:[B.title,B.badge&&e.jsx(ke,{variant:"secondary",className:"ml-2 text-xs",children:B.badge})]},B.id))}),f.layout.tabs.map(B=>e.jsx(Ms,{value:B.id,className:"space-y-4 mt-4",children:B.sections.map(ue=>{const Q=f.sections[ue];return Q?e.jsx(Wg,{section:Q,config:g,onChange:je},ue):null})},B.id))]}):e.jsx("div",{className:"space-y-4",children:D.map(B=>e.jsx(Wg,{section:B,config:g,onChange:je},B.name))})]}),e.jsx(Js,{open:L,onOpenChange:me,children:e.jsxs(qs,{children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>me(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:ge,children:""})]})]})})]})}function jC(){return e.jsx(tr,{children:e.jsx(vC,{})})}function vC(){const{toast:a}=it(),[l,r]=u.useState([]),[c,d]=u.useState(!0),[m,h]=u.useState(""),[f,p]=u.useState(null),g=async()=>{d(!0);try{const w=await Ll();r(w)}catch(w){a({title:"",description:w instanceof Error?w.message:"",variant:"destructive"})}finally{d(!1)}};u.useEffect(()=>{g()},[]);const j=l.filter(w=>{const A=m.toLowerCase();return w.id.toLowerCase().includes(A)||w.manifest.name.toLowerCase().includes(A)||w.manifest.description?.toLowerCase().includes(A)}).filter((w,A,M)=>A===M.findIndex(S=>S.id===w.id)),y=l.length,b=0;return f?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-full",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(gC,{plugin:f,onBack:()=>p(null)})})}),e.jsx(ar,{})]}):e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:g,children:[e.jsx(ut,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),""]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(ua,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c?"...":""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(tt,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:""}),e.jsx(Rt,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:m,onChange:w=>h(w.target.value),className:"pl-9"})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):j.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(ua,{className:"h-16 w-16 text-muted-foreground/50"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:m?"":""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m?"":""})]})]}):e.jsx("div",{className:"space-y-2",children:j.map(w=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>p(w),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(ua,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:w.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs flex-shrink-0",children:["v",w.manifest.version]})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:w.manifest.description||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(bn,{className:"h-4 w-4"})}),e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"})]})]},w.id))})})]})]})})}function NC(){const a=xa(),{toast:l}=it(),[r,c]=u.useState([]),[d,m]=u.useState(!0),[h,f]=u.useState(null),[p,g]=u.useState(null),[N,j]=u.useState(!1),[y,b]=u.useState(!1),[w,A]=u.useState({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),M=u.useCallback(async()=>{try{m(!0),f(null);const O=await Se("/api/webui/plugins/mirrors");if(!O.ok)throw new Error("");const X=await O.json();c(X.mirrors||[])}catch(O){const X=O instanceof Error?O.message:"";f(X),l({title:"",description:X,variant:"destructive"})}finally{m(!1)}},[l]);u.useEffect(()=>{M()},[M]);const S=async()=>{try{const O=await Se("/api/webui/plugins/mirrors",{method:"POST",body:JSON.stringify(w)});if(!O.ok){const X=await O.json();throw new Error(X.detail||"")}l({title:"",description:""}),j(!1),A({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),M()}catch(O){l({title:"",description:O instanceof Error?O.message:"",variant:"destructive"})}},P=async()=>{if(p)try{if(!(await Se(`/api/webui/plugins/mirrors/${p.id}`,{method:"PUT",body:JSON.stringify({name:w.name,raw_prefix:w.raw_prefix,clone_prefix:w.clone_prefix,enabled:w.enabled,priority:w.priority})})).ok)throw new Error("");l({title:"",description:""}),b(!1),g(null),M()}catch(O){l({title:"",description:O instanceof Error?O.message:"",variant:"destructive"})}},E=async O=>{if(confirm(""))try{if(!(await Se(`/api/webui/plugins/mirrors/${O}`,{method:"DELETE"})).ok)throw new Error("");l({title:"",description:""}),M()}catch(X){l({title:"",description:X instanceof Error?X.message:"",variant:"destructive"})}},C=async O=>{try{if(!(await Se(`/api/webui/plugins/mirrors/${O.id}`,{method:"PUT",body:JSON.stringify({enabled:!O.enabled})})).ok)throw new Error("");M()}catch(X){l({title:"",description:X instanceof Error?X.message:"",variant:"destructive"})}},R=O=>{g(O),A({id:O.id,name:O.name,raw_prefix:O.raw_prefix,clone_prefix:O.clone_prefix,enabled:O.enabled,priority:O.priority}),b(!0)},H=async(O,X)=>{const L=X==="up"?O.priority-1:O.priority+1;if(!(L<1))try{if(!(await Se(`/api/webui/plugins/mirrors/${O.id}`,{method:"PUT",body:JSON.stringify({priority:L})})).ok)throw new Error("");M()}catch(me){l({title:"",description:me instanceof Error?me.message:"",variant:"destructive"})}};return e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:" Git "})]})]}),e.jsxs(_,{onClick:()=>j(!0),children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),""]})]}),d?e.jsx(Ce,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-primary"})})}):h?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(qt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h}),e.jsx(_,{onClick:M,children:""})]})}):e.jsxs(Ce,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:"ID"}),e.jsx(ls,{children:""}),e.jsx(ls,{className:"text-right",children:""})]})}),e.jsx(Fl,{children:r.map(O=>e.jsxs(bt,{children:[e.jsx(Je,{children:e.jsx(Ge,{checked:O.enabled,onCheckedChange:()=>C(O)})}),e.jsx(Je,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:O.name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Raw: ",O.raw_prefix]})]})}),e.jsx(Je,{children:e.jsx(ke,{variant:"outline",children:O.id})}),e.jsx(Je,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono",children:O.priority}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>H(O,"up"),disabled:O.priority===1,children:e.jsx(Yr,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>H(O,"down"),children:e.jsx($a,{className:"h-3 w-3"})})]})]})}),e.jsx(Je,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>R(O),children:e.jsx(Jn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>E(O.id),children:e.jsx(us,{className:"h-4 w-4 text-destructive"})})]})})]},O.id))})]})}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:r.map(O=>e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:O.name}),O.enabled&&e.jsx(ke,{variant:"default",className:"text-xs",children:""})]}),e.jsx(ke,{variant:"outline",className:"mt-1 text-xs",children:O.id})]}),e.jsx(Ge,{checked:O.enabled,onCheckedChange:()=>C(O)})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Raw: "}),e.jsx("span",{className:"break-all",children:O.raw_prefix})]}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),e.jsx("span",{className:"font-mono",children:O.priority})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>R(O),children:[e.jsx(Jn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>H(O,"up"),disabled:O.priority===1,children:e.jsx(Yr,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>H(O,"down"),children:e.jsx($a,{className:"h-4 w-4"})}),e.jsx(_,{variant:"destructive",size:"sm",onClick:()=>E(O.id),children:e.jsx(us,{className:"h-4 w-4"})})]})]})},O.id))})]}),e.jsx(Js,{open:N,onOpenChange:j,children:e.jsxs(qs,{className:"max-w-lg",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:" Git "})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-id",children:" ID *"}),e.jsx(ne,{id:"add-id",placeholder:": my-mirror",value:w.id,onChange:O=>A({...w,id:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-name",children:" *"}),e.jsx(ne,{id:"add-name",placeholder:": ",value:w.name,onChange:O=>A({...w,name:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-raw",children:"Raw  *"}),e.jsx(ne,{id:"add-raw",placeholder:"https://example.com/raw",value:w.raw_prefix,onChange:O=>A({...w,raw_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-clone",children:" *"}),e.jsx(ne,{id:"add-clone",placeholder:"https://example.com/clone",value:w.clone_prefix,onChange:O=>A({...w,clone_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"add-priority",children:""}),e.jsx(ne,{id:"add-priority",type:"number",min:"1",value:w.priority,onChange:O=>A({...w,priority:parseInt(O.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"add-enabled",checked:w.enabled,onCheckedChange:O=>A({...w,enabled:O})}),e.jsx(T,{htmlFor:"add-enabled",children:""})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:""}),e.jsx(_,{onClick:S,children:""})]})]})}),e.jsx(Js,{open:y,onOpenChange:b,children:e.jsxs(qs,{className:"max-w-lg",children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:" ID"}),e.jsx(ne,{value:w.id,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-name",children:" *"}),e.jsx(ne,{id:"edit-name",value:w.name,onChange:O=>A({...w,name:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-raw",children:"Raw  *"}),e.jsx(ne,{id:"edit-raw",value:w.raw_prefix,onChange:O=>A({...w,raw_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-clone",children:" *"}),e.jsx(ne,{id:"edit-clone",value:w.clone_prefix,onChange:O=>A({...w,clone_prefix:O.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"edit-priority",children:""}),e.jsx(ne,{id:"edit-priority",type:"number",min:"1",value:w.priority,onChange:O=>A({...w,priority:parseInt(O.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"edit-enabled",checked:w.enabled,onCheckedChange:O=>A({...w,enabled:O})}),e.jsx(T,{htmlFor:"edit-enabled",children:""})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>b(!1),children:""}),e.jsx(_,{onClick:P,children:""})]})]})})]})})}function bC({pluginId:a,compact:l=!1}){const[r,c]=u.useState(null),[d,m]=u.useState(!0),[h,f]=u.useState(0),[p,g]=u.useState(""),[N,j]=u.useState(!1),{toast:y}=it(),b=async()=>{m(!0);const S=await fN(a);S&&c(S),m(!1)};u.useEffect(()=>{b()},[a]);const w=async()=>{const S=await cC(a);S.success?(y({title:"",description:""}),b()):y({title:"",description:S.error||"",variant:"destructive"})},A=async()=>{const S=await oC(a);S.success?(y({title:"",description:""}),b()):y({title:"",description:S.error||"",variant:"destructive"})},M=async()=>{if(h===0){y({title:"",description:" 1 ",variant:"destructive"});return}const S=await dC(a,h,p||void 0);S.success?(y({title:"",description:""}),j(!1),f(0),g(""),b()):y({title:"",description:S.error||"",variant:"destructive"})};return d?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]})]}):r?l?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.downloads.toLocaleString()}`,children:[e.jsx(na,{className:"h-4 w-4"}),e.jsx("span",{children:r.downloads.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.rating.toFixed(1)} (${r.rating_count} )`,children:[e.jsx(fn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:r.rating.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${r.likes}`,children:[e.jsx(Em,{className:"h-4 w-4"}),e.jsx("span",{children:r.likes})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(na,{className:"h-5 w-5 text-muted-foreground mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.downloads.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(fn,{className:"h-5 w-5 text-yellow-400 mb-1 fill-yellow-400"}),e.jsx("span",{className:"text-2xl font-bold",children:r.rating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.rating_count," "]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Em,{className:"h-5 w-5 text-green-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.likes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(kg,{className:"h-5 w-5 text-red-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:r.dislikes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(Em,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:A,children:[e.jsx(kg,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(Js,{open:N,onOpenChange:j,children:[e.jsx(cd,{asChild:!0,children:e.jsxs(_,{variant:"default",size:"sm",children:[e.jsx(fn,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(qs,{children:[e.jsxs(Vs,{children:[e.jsx(Gs,{children:""}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(S=>e.jsx("button",{onClick:()=>f(S),className:"focus:outline-none",children:e.jsx(fn,{className:`h-8 w-8 transition-colors ${S<=h?"fill-yellow-400 text-yellow-400":"text-muted-foreground hover:text-yellow-300"}`})},S))}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h===0&&"",h===1&&"",h===2&&"",h===3&&"",h===4&&"",h===5&&""]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),e.jsx(ft,{value:p,onChange:S=>g(S.target.value),placeholder:"...",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[p.length," / 500"]})]})]}),e.jsxs(xt,{children:[e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:""}),e.jsx(_,{onClick:M,disabled:h===0,children:""})]})]})]})]}),r.recent_ratings&&r.recent_ratings.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-3",children:r.recent_ratings.map((S,P)=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>e.jsx(fn,{className:`h-3 w-3 ${E<=S.rating?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`},E))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(S.created_at).toLocaleDateString()})]}),S.comment&&e.jsx("p",{className:"text-sm text-muted-foreground",children:S.comment})]},P))})]})]}):null}const yC={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function wC(){const a=xa(),l=W0({strict:!1}),{toast:r}=it(),[c,d]=u.useState(null),[m,h]=u.useState(""),[f,p]=u.useState(!0),[g,N]=u.useState(!0),[j,y]=u.useState(null),[b,w]=u.useState(null),[A,M]=u.useState(null),[S,P]=u.useState(!1),[E,C]=u.useState(),[R,H]=u.useState(!1);u.useEffect(()=>{(async()=>{if(!l.pluginId){y(" ID"),p(!1);return}try{p(!0),y(null);const ge=await Se("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:"Mai-with-u",repo:"plugin-repo",branch:"main",file_path:"plugin_details.json"})});if(!ge.ok)throw new Error("");const pe=await ge.json();if(!pe.success||!pe.data)throw new Error(pe.error||"");const K=JSON.parse(pe.data).find(he=>he.id===l.pluginId);if(!K)throw new Error("");const B={id:K.id,manifest:K.manifest,downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()};d(B);const[ue,Q,_e]=await Promise.all([oN(),dN(),Ll()]);w(ue),M(Q),P(gn(l.pluginId,_e)),C(jn(l.pluginId,_e))}catch(ge){y(ge instanceof Error?ge.message:"")}finally{p(!1)}})()},[l.pluginId]),u.useEffect(()=>{(async()=>{if(!c?.manifest?.repository_url){N(!1);return}try{if(N(!0),S&&l.pluginId)try{const Q=await Se(`/api/webui/plugins/local-readme/${l.pluginId}`);if(Q.ok){const _e=await Q.json();if(_e.success&&_e.data){h(_e.data),N(!1);return}}}catch(Q){console.log(" README :",Q)}const ge=c.manifest.repository_url.match(/github\.com\/([^/]+)\/([^/\s]+)/);if(!ge){h("");return}const[,pe,D]=ge,K=D.replace(/\.git$/,""),B=await Se("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:pe,repo:K,branch:"main",file_path:"README.md"})});if(!B.ok)throw new Error(" README ");const ue=await B.json();ue.success&&ue.data?h(ue.data):h(" README ")}catch(ge){console.error(" README :",ge),h(" README ")}finally{N(!1)}})()},[c,S,l.pluginId]);const O=()=>!c||!S||!E?!1:E!==c.manifest.version,X=()=>!c||!A?!0:uN(c.manifest.host_application.min_version,c.manifest.host_application.max_version,A),L=async()=>{if(!(!c||!b?.installed))try{H(!0),await mN(c.id,c.manifest.repository_url||"","main"),pN(c.id).catch(ge=>{console.warn("Failed to record download:",ge)}),r({title:"",description:`${c.manifest.name} `});const ce=await Ll();P(gn(c.id,ce)),C(jn(c.id,ce))}catch(ce){r({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{H(!1)}},me=async()=>{if(c)try{H(!0),await xN(c.id),r({title:"",description:`${c.manifest.name} `});const ce=await Ll();P(gn(c.id,ce)),C(jn(c.id,ce))}catch(ce){r({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{H(!1)}},Ne=async()=>{if(!(!c||!b?.installed))try{H(!0);const ce=await hN(c.id,c.manifest.repository_url||"","main");r({title:"",description:`${c.manifest.name}  ${ce.old_version}  ${ce.new_version}`});const ge=await Ll();P(gn(c.id,ge)),C(jn(c.id,ge))}catch(ce){r({title:"",description:ce instanceof Error?ce.message:"",variant:"destructive"})}finally{H(!1)}};if(f)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]})]});if(j||!c)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Rt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:j}),e.jsx(_,{onClick:()=>a({to:"/plugins"}),children:""})]})})]});const je=X();return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>a({to:"/plugins"}),className:"shrink-0",children:e.jsx(Ua,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:c.manifest.name})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S?e.jsxs(e.Fragment,{children:[O()?e.jsx(_,{disabled:!b?.installed||R,onClick:Ne,title:b?.installed?void 0:"Git ",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),""]})}):null,e.jsx(_,{variant:"destructive",disabled:!b?.installed||R,onClick:me,title:b?.installed?void 0:"Git ",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),""]})})]}):e.jsx(_,{disabled:!b?.installed||!je||R,onClick:L,title:b?.installed?je?void 0:` ( ${c.manifest.host_application.min_version}${c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:"+"} ${A?.version})`:"Git ",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),""]})})})]}),e.jsx(ss,{className:"h-[calc(100vh-200px)] sm:h-[calc(100vh-220px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsx(Ce,{children:e.jsx(De,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(Ue,{className:"text-2xl",children:c.manifest.name}),e.jsxs(ke,{variant:"secondary",className:"text-sm",children:["v",c.manifest.version]}),S&&e.jsxs(ke,{variant:"default",className:"text-sm",children:[e.jsx(tt,{className:"h-3 w-3 mr-1"})," ",E&&`(v${E})`]}),O()&&e.jsxs(ke,{variant:"outline",className:"text-sm border-orange-500 text-orange-500",children:[e.jsx(ut,{className:"h-3 w-3 mr-1"}),""]}),!je&&e.jsxs(ke,{variant:"destructive",className:"text-sm",children:[e.jsx(Rt,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx(fs,{className:"text-base",children:c.manifest.description})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Ue,{className:"text-lg",children:""})}),e.jsx(Ae,{children:e.jsx(bC,{pluginId:c.id})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Ue,{className:"text-lg",children:""})}),e.jsx(Ae,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx($l,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.author?.name||"Unknown"}),c.manifest.author?.url&&e.jsx("a",{href:c.manifest.author.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:e.jsx($o,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ua,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-medium",children:["v",c.manifest.version]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(lv,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.license})]}),c.manifest.homepage_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(qo,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.homepage_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["",e.jsx($o,{className:"h-3 w-3"})]})]}),c.manifest.repository_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(F1,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.repository_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["GitHub",e.jsx($o,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx(Qt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"})]}),e.jsxs("div",{className:"text-sm pl-6 font-medium",children:[c.manifest.host_application.min_version,c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:" - "]})]})]})})]}),(c.manifest.categories||c.manifest.keywords)&&e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Ue,{className:"text-lg",children:""})}),e.jsxs(Ae,{className:"space-y-4",children:[c.manifest.categories&&c.manifest.categories.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.categories.map(ce=>e.jsx(ke,{variant:"secondary",children:yC[ce]||ce},ce))})]}),c.manifest.keywords&&c.manifest.keywords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.keywords.map(ce=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"h-3 w-3 mr-1"}),ce]},ce))})]})]})]})]}),e.jsxs(Ce,{className:"lg:col-span-2",children:[e.jsx(De,{children:e.jsx(Ue,{className:"text-lg",children:""})}),e.jsx(Ae,{children:e.jsx(ss,{className:"h-[600px] pr-4",children:g?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Fs,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-sm text-muted-foreground",children:"..."})]}):m?e.jsx(gx,{content:m}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:""})})})]})]})]})})]})}const Zi=u.forwardRef(({className:a,...l},r)=>e.jsx(kj,{ref:r,className:F("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...l}));Zi.displayName=kj.displayName;const _C=u.forwardRef(({className:a,...l},r)=>e.jsx(Cj,{ref:r,className:F("aspect-square h-full w-full",a),...l}));_C.displayName=Cj.displayName;const Wi=u.forwardRef(({className:a,...l},r)=>e.jsx(Tj,{ref:r,className:F("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...l}));Wi.displayName=Tj.displayName;function SC(){return"webui_"+Math.random().toString(36).substr(2,9)+"_"+Date.now().toString(36)}function kC(){const a="maibot_webui_user_id";let l=localStorage.getItem(a);return l||(l=SC(),localStorage.setItem(a,l)),l}function CC(){return localStorage.getItem("maibot_webui_user_name")||"WebUI"}function TC(a){localStorage.setItem("maibot_webui_user_name",a)}const gN="maibot_webui_virtual_tabs";function EC(){try{const a=localStorage.getItem(gN);if(a)return JSON.parse(a)}catch(a){console.error("[Chat] :",a)}return[]}function ej(a){try{localStorage.setItem(gN,JSON.stringify(a))}catch(l){console.error("[Chat] :",l)}}function MC({segment:a}){switch(a.type){case"text":return e.jsx("span",{className:"whitespace-pre-wrap",children:String(a.data)});case"image":case"emoji":return e.jsx("img",{src:String(a.data),alt:a.type==="emoji"?"":"",className:F("rounded-lg max-w-full",a.type==="emoji"?"max-h-32":"max-h-64"),loading:"lazy",onError:l=>{const r=l.target;r.style.display="none",r.parentElement?.insertAdjacentHTML("beforeend",`<span class="text-muted-foreground text-xs">[${a.type==="emoji"?"":""}]</span>`)}});case"voice":return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("audio",{controls:!0,src:String(a.data),className:"max-w-[200px] h-8",children:""})});case"video":return e.jsx("video",{controls:!0,src:String(a.data),className:"rounded-lg max-w-full max-h-64",children:""});case"face":return e.jsxs("span",{className:"text-muted-foreground",children:["[:",String(a.data),"]"]});case"music":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"file":return e.jsxs("span",{className:"text-muted-foreground",children:["[: ",String(a.data),"]"]});case"reply":return e.jsx("span",{className:"text-muted-foreground text-xs",children:"[]"});case"forward":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"unknown":default:return e.jsxs("span",{className:"text-muted-foreground",children:["[",a.original_type||"","]"]})}}function AC({message:a,isBot:l}){return a.message_type==="rich"&&a.segments&&a.segments.length>0?e.jsx("div",{className:"flex flex-col gap-2",children:a.segments.map((r,c)=>e.jsx(MC,{segment:r},c))}):e.jsx("span",{className:"whitespace-pre-wrap",children:a.content})}function zC(){const a={id:"webui-default",type:"webui",label:"WebUI",messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}},l=()=>{const qe=EC().map(Ke=>{const Ze=Ke.virtualConfig;return!Ze.groupId&&Ze.platform&&Ze.userId&&(Ze.groupId=`webui_virtual_group_${Ze.platform}_${Ze.userId}`),{id:Ke.id,type:"virtual",label:Ke.label,virtualConfig:Ze,messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}}});return[a,...qe]},[r,c]=u.useState(l),[d,m]=u.useState("webui-default"),h=r.find(Y=>Y.id===d)||r[0],[f,p]=u.useState(""),[g,N]=u.useState(!1),[j,y]=u.useState(!0),[b,w]=u.useState(CC()),[A,M]=u.useState(!1),[S,P]=u.useState(""),[E,C]=u.useState(!1),[R,H]=u.useState([]),[O,X]=u.useState([]),[L,me]=u.useState(!1),[Ne,je]=u.useState(!1),[ce,ge]=u.useState(""),[pe,D]=u.useState({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),K=u.useRef(kC()),B=u.useRef(new Map),ue=u.useRef(null),Q=u.useRef(new Map),_e=u.useRef(0),he=u.useRef(new Map),{toast:Te}=it(),V=Y=>(_e.current+=1,`${Y}-${Date.now()}-${_e.current}-${Math.random().toString(36).substr(2,9)}`),$=u.useCallback((Y,qe)=>{c(Ke=>Ke.map(Ze=>Ze.id===Y?{...Ze,...qe}:Ze))},[]),z=u.useCallback((Y,qe)=>{c(Ke=>Ke.map(Ze=>Ze.id===Y?{...Ze,messages:[...Ze.messages,qe]}:Ze))},[]),G=u.useCallback(()=>{ue.current?.scrollIntoView({behavior:"smooth"})},[]);u.useEffect(()=>{G()},[h?.messages,G]);const Re=u.useCallback(async()=>{me(!0);try{const Y=await Se("/api/chat/platforms");if(console.log("[Chat] :",Y.status,Y.headers.get("content-type")),Y.ok){const qe=Y.headers.get("content-type");if(qe&&qe.includes("application/json")){const Ke=await Y.json();console.log("[Chat] :",Ke),H(Ke.platforms||[])}else{const Ke=await Y.text();console.error("[Chat] :  JSON :",Ke.substring(0,200)),Te({title:"",description:" MaiBot ",variant:"destructive"})}}else console.error("[Chat] : HTTP",Y.status),Te({title:"",description:`: ${Y.status}`,variant:"destructive"})}catch(Y){console.error("[Chat] :",Y),Te({title:"",description:"",variant:"destructive"})}finally{me(!1)}},[Te]),se=u.useCallback(async(Y,qe)=>{je(!0);try{const Ke=new URLSearchParams;Y&&Ke.append("platform",Y),qe&&Ke.append("search",qe),Ke.append("limit","50");const Ze=await Se(`/api/chat/persons?${Ke.toString()}`);if(Ze.ok){const Ts=Ze.headers.get("content-type");if(Ts&&Ts.includes("application/json")){const He=await Ze.json();X(He.persons||[])}else console.error("[Chat] :  JSON ")}}catch(Ke){console.error("[Chat] :",Ke)}finally{je(!1)}},[]);u.useEffect(()=>{pe.platform&&se(pe.platform,ce)},[pe.platform,ce,se]);const Oe=u.useCallback(async(Y,qe)=>{y(!0);try{const Ke=new URLSearchParams;Ke.append("user_id",K.current),Ke.append("limit","50"),qe&&Ke.append("group_id",qe);const Ze=`/api/chat/history?${Ke.toString()}`;console.log("[Chat] :",Ze);const Ts=await Se(Ze);if(Ts.ok){const He=await Ts.text();try{const zs=JSON.parse(He);if(zs.messages&&zs.messages.length>0){const Ls=zs.messages.map(cs=>({id:cs.id,type:cs.type,content:cs.content,timestamp:cs.timestamp,sender:{name:cs.sender_name||(cs.is_bot?"":"WebUI"),user_id:cs.user_id,is_bot:cs.is_bot}}));$(Y,{messages:Ls});const Ks=he.current.get(Y)||new Set;Ls.forEach(cs=>{if(cs.type==="bot"){const ts=`bot-${cs.content}-${Math.floor(cs.timestamp*1e3)}`;Ks.add(ts)}}),he.current.set(Y,Ks)}}catch(zs){console.error("[Chat] JSON :",zs)}}}catch(Ke){console.error("[Chat] :",Ke)}finally{y(!1)}},[$]),ns=u.useCallback(async(Y,qe,Ke)=>{const Ze=B.current.get(Y);if(Ze?.readyState===WebSocket.OPEN||Ze?.readyState===WebSocket.CONNECTING){console.log(`[Tab ${Y}] WebSocket `);return}N(!0);let Ts=null;try{const Ks=await Se("/api/webui/ws-token");if(Ks.ok){const cs=await Ks.json();if(cs.success&&cs.token)Ts=cs.token;else{console.warn(`[Tab ${Y}]  WebSocket token : ${cs.message||""}`),N(!1);return}}}catch(Ks){console.error(`[Tab ${Y}]  WebSocket token :`,Ks),N(!1);return}if(!Ts){N(!1);return}const He=window.location.protocol==="https:"?"wss:":"ws:",zs=new URLSearchParams;zs.append("token",Ts),qe==="virtual"&&Ke?(zs.append("user_id",Ke.userId),zs.append("user_name",Ke.userName),zs.append("platform",Ke.platform),zs.append("person_id",Ke.personId),zs.append("group_name",Ke.groupName||"WebUI"),Ke.groupId&&zs.append("group_id",Ke.groupId)):(zs.append("user_id",K.current),zs.append("user_name",b));const Ls=`${He}//${window.location.host}/api/chat/ws?${zs.toString()}`;console.log(`[Tab ${Y}]  WebSocket:`,Ls);try{const Ks=new WebSocket(Ls);B.current.set(Y,Ks),Ks.onopen=()=>{$(Y,{isConnected:!0}),N(!1),console.log(`[Tab ${Y}] WebSocket `)},Ks.onmessage=cs=>{try{const ts=JSON.parse(cs.data);switch(ts.type){case"session_info":$(Y,{sessionInfo:{session_id:ts.session_id,user_id:ts.user_id,user_name:ts.user_name,bot_name:ts.bot_name}});break;case"system":z(Y,{id:V("sys"),type:"system",content:ts.content||"",timestamp:ts.timestamp||Date.now()/1e3});break;case"user_message":{const _s=ts.sender?.user_id,$e=qe==="virtual"&&Ke?Ke.userId:K.current;console.log(`[Tab ${Y}]  user_message, sender: ${_s}, current: ${$e}`);const ms=_s?_s.replace(/^webui_user_/,""):"",os=$e?$e.replace(/^webui_user_/,""):"";if(ms&&os&&ms===os){console.log(`[Tab ${Y}] user_id `);break}const rs=he.current.get(Y)||new Set,ht=`user-${ts.content}-${Math.floor((ts.timestamp||0)*1e3)}`;if(rs.has(ht)){console.log(`[Tab ${Y}] `);break}if(rs.add(ht),he.current.set(Y,rs),rs.size>100){const Tt=rs.values().next().value;Tt&&rs.delete(Tt)}z(Y,{id:ts.message_id||V("user"),type:"user",content:ts.content||"",timestamp:ts.timestamp||Date.now()/1e3,sender:ts.sender});break}case"bot_message":{$(Y,{isTyping:!1});const _s=he.current.get(Y)||new Set,$e=`bot-${ts.content}-${Math.floor((ts.timestamp||0)*1e3)}`;if(_s.has($e))break;if(_s.add($e),he.current.set(Y,_s),_s.size>100){const ms=_s.values().next().value;ms&&_s.delete(ms)}c(ms=>ms.map(os=>{if(os.id!==Y)return os;const rs=os.messages.filter(Tt=>Tt.type!=="thinking"),ht={id:V("bot"),type:"bot",content:ts.content||"",message_type:ts.message_type==="rich"?"rich":"text",segments:ts.segments,timestamp:ts.timestamp||Date.now()/1e3,sender:ts.sender};return{...os,messages:[...rs,ht]}}));break}case"typing":$(Y,{isTyping:ts.is_typing||!1});break;case"error":c(_s=>_s.map($e=>{if($e.id!==Y)return $e;const ms=$e.messages.filter(os=>os.type!=="thinking");return{...$e,messages:[...ms,{id:V("error"),type:"error",content:ts.content||"",timestamp:ts.timestamp||Date.now()/1e3}]}})),Te({title:"",description:ts.content,variant:"destructive"});break;case"pong":break;case"history":{const _s=ts.messages||[];if(_s.length>0){const $e=he.current.get(Y)||new Set,ms=_s.map(os=>{const rs=os.is_bot||!1,ht=os.id||V(rs?"bot":"user"),Tt=`${rs?"bot":"user"}-${os.content}-${Math.floor(os.timestamp*1e3)}`;return $e.add(Tt),{id:ht,type:rs?"bot":"user",content:os.content,timestamp:os.timestamp,sender:{name:os.sender_name||(rs?"":""),user_id:os.sender_id,is_bot:rs}}});he.current.set(Y,$e),$(Y,{messages:ms}),console.log(`[Tab ${Y}]  ${ms.length} `)}break}default:console.log(":",ts.type)}}catch(ts){console.error(":",ts)}},Ks.onclose=()=>{$(Y,{isConnected:!1}),N(!1),B.current.delete(Y),console.log(`[Tab ${Y}] WebSocket `);const cs=Q.current.get(Y);cs&&clearTimeout(cs);const ts=window.setTimeout(()=>{if(!J.current){const _s=r.find($e=>$e.id===Y);_s&&ns(Y,_s.type,_s.virtualConfig)}},5e3);Q.current.set(Y,ts)},Ks.onerror=cs=>{console.error(`[Tab ${Y}] WebSocket :`,cs),N(!1)}}catch(Ks){console.error(`[Tab ${Y}]  WebSocket :`,Ks),N(!1)}},[b,$,z,Te,r]),J=u.useRef(!1);u.useEffect(()=>{J.current=!1;const Y=B.current,qe=Q.current,Ke=he.current;Oe("webui-default");const Ze=setTimeout(()=>{J.current||(ns("webui-default","webui"),r.forEach(He=>{He.type==="virtual"&&He.virtualConfig&&(Ke.set(He.id,new Set),setTimeout(()=>{J.current||ns(He.id,"virtual",He.virtualConfig)},200))}))},100),Ts=setInterval(()=>{Y.forEach(He=>{He.readyState===WebSocket.OPEN&&He.send(JSON.stringify({type:"ping"}))})},3e4);return()=>{J.current=!0,clearTimeout(Ze),clearInterval(Ts),qe.forEach(He=>{clearTimeout(He)}),qe.clear(),Y.forEach(He=>{He.close()}),Y.clear()}},[]);const Z=u.useCallback(()=>{const Y=B.current.get(d);if(!f.trim()||!Y||Y.readyState!==WebSocket.OPEN)return;const qe=h?.type==="virtual"&&h.virtualConfig?.userName||b,Ke=f.trim(),Ze=Date.now()/1e3;Y.send(JSON.stringify({type:"message",content:Ke,user_name:qe}));const Ts=he.current.get(d)||new Set,He=`user-${Ke}-${Math.floor(Ze*1e3)}`;if(Ts.add(He),he.current.set(d,Ts),Ts.size>100){const Ks=Ts.values().next().value;Ks&&Ts.delete(Ks)}const zs={id:V("user"),type:"user",content:Ke,timestamp:Ze,sender:{name:qe,is_bot:!1}};z(d,zs);const Ls={id:V("thinking"),type:"thinking",content:"",timestamp:Ze+.001,sender:{name:h?.sessionInfo.bot_name||"",is_bot:!0}};z(d,Ls),p("")},[f,b,d,h,z]),Le=Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),Z())},ae=()=>{P(b),M(!0)},Ee=()=>{const Y=S.trim()||"WebUI";w(Y),TC(Y),M(!1);const qe=B.current.get(d);qe?.readyState===WebSocket.OPEN&&qe.send(JSON.stringify({type:"update_nickname",user_name:Y}))},de=()=>{P(""),M(!1)},ze=Y=>new Date(Y*1e3).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),ws=()=>{const Y=B.current.get(d);Y&&(Y.close(),B.current.delete(d)),ns(d,h?.type||"webui",h?.virtualConfig)},Zs=()=>{D({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),ge(""),Re(),C(!0)},St=()=>{if(!pe.platform||!pe.personId){Te({title:"",description:"",variant:"destructive"});return}const Y=`webui_virtual_group_${pe.platform}_${pe.userId}`,qe=`virtual-${pe.platform}-${pe.userId}-${Date.now()}`,Ke=pe.userName||pe.userId,Ze={id:qe,type:"virtual",label:Ke,virtualConfig:{...pe,groupId:Y},messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}};c(Ts=>{const He=[...Ts,Ze],zs=He.filter(Ls=>Ls.type==="virtual"&&Ls.virtualConfig).map(Ls=>({id:Ls.id,label:Ls.label,virtualConfig:Ls.virtualConfig,createdAt:Date.now()}));return ej(zs),He}),m(qe),C(!1),he.current.set(qe,new Set),setTimeout(()=>{ns(qe,"virtual",pe)},100),Te({title:"",description:` ${Ke} `})},fa=(Y,qe)=>{if(qe?.stopPropagation(),Y==="webui-default")return;const Ke=B.current.get(Y);Ke&&(Ke.close(),B.current.delete(Y));const Ze=Q.current.get(Y);Ze&&(clearTimeout(Ze),Q.current.delete(Y)),he.current.delete(Y),c(Ts=>{const He=Ts.filter(Ls=>Ls.id!==Y),zs=He.filter(Ls=>Ls.type==="virtual"&&Ls.virtualConfig).map(Ls=>({id:Ls.id,label:Ls.label,virtualConfig:Ls.virtualConfig,createdAt:Date.now()}));return ej(zs),He}),d===Y&&m("webui-default")},xs=Y=>{m(Y)},Is=Y=>{D(qe=>({...qe,personId:Y.person_id,userId:Y.user_id,userName:Y.nickname||Y.person_name}))};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(Js,{open:E,onOpenChange:C,children:e.jsxs(qs,{className:"sm:max-w-[500px] max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(Mm,{className:"h-5 w-5"}),""]}),e.jsx(nt,{children:""})]}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(qo,{className:"h-4 w-4"}),""]}),e.jsxs(Pe,{value:pe.platform,onValueChange:Y=>{D(qe=>({...qe,platform:Y,personId:"",userId:"",userName:""})),X([])},children:[e.jsx(Be,{disabled:L,children:e.jsx(Fe,{placeholder:L?"...":""})}),e.jsx(Ie,{children:R.map(Y=>e.jsxs(ee,{value:Y.platform,children:[Y.platform," (",Y.count," )"]},Y.platform))})]})]}),pe.platform&&e.jsxs("div",{className:"space-y-2 flex-1 overflow-hidden flex flex-col",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:ce,onChange:Y=>ge(Y.target.value),className:"pl-9"})]}),e.jsx(ss,{className:"h-[250px] border rounded-md",children:e.jsx("div",{className:"p-2",children:Ne?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Fs,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):O.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(ic,{className:"h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:""})]}):e.jsx("div",{className:"space-y-1",children:O.map(Y=>e.jsxs("button",{onClick:()=>Is(Y),className:F("w-full flex items-center gap-3 p-2 rounded-md text-left transition-colors",pe.personId===Y.person_id?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(Zi,{className:"h-8 w-8 shrink-0",children:e.jsx(Wi,{className:F("text-xs",pe.personId===Y.person_id?"bg-primary-foreground/20":"bg-muted"),children:(Y.nickname||Y.person_name||"?").charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate",children:Y.nickname||Y.person_name}),e.jsxs("div",{className:F("text-xs truncate",pe.personId===Y.person_id?"text-primary-foreground/70":"text-muted-foreground"),children:["ID: ",Y.user_id,Y.is_known&&"  "]})]})]},Y.person_id))})})})]}),pe.personId&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:""}),e.jsx(ne,{placeholder:"WebUI",value:pe.groupName,onChange:Y=>D(qe=>({...qe,groupName:Y.target.value}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs(xt,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:()=>C(!1),children:""}),e.jsx(_,{onClick:St,disabled:!pe.platform||!pe.personId,children:""})]})]})}),e.jsx("div",{className:"shrink-0 border-b bg-muted/30",children:e.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto py-1.5 scrollbar-thin",children:[r.map(Y=>e.jsxs("div",{className:F("flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm whitespace-nowrap transition-colors cursor-pointer","hover:bg-muted",d===Y.id?"bg-background shadow-sm border":"text-muted-foreground"),onClick:()=>xs(Y.id),children:[Y.type==="webui"?e.jsx(Ba,{className:"h-3.5 w-3.5"}):e.jsx(Mm,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"max-w-[100px] truncate",children:Y.label}),e.jsx("span",{className:F("w-1.5 h-1.5 rounded-full",Y.isConnected?"bg-green-500":"bg-muted-foreground/50")}),Y.id!=="webui-default"&&e.jsx("span",{onClick:qe=>fa(Y.id,qe),className:"ml-0.5 p-0.5 rounded hover:bg-muted-foreground/20 cursor-pointer",role:"button",tabIndex:0,onKeyDown:qe=>{(qe.key==="Enter"||qe.key===" ")&&(qe.preventDefault(),fa(Y.id,qe))},children:e.jsx(_a,{className:"h-3 w-3"})})]},Y.id)),e.jsx("button",{onClick:Zs,className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-sm text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",title:"",children:e.jsx(at,{className:"h-3.5 w-3.5"})})]})})}),e.jsx("div",{className:"shrink-0 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(Zi,{className:"h-8 w-8 sm:h-10 sm:w-10 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Kn,{className:"h-4 w-4 sm:h-5 sm:w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:h?.sessionInfo.bot_name||""}),e.jsx("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:h?.isConnected?e.jsxs(e.Fragment,{children:[e.jsx(H1,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:""})]}):g?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(q1,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:""})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[j&&e.jsx(Fs,{className:"h-4 w-4 animate-spin text-muted-foreground"}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:ws,disabled:g,title:"",children:e.jsx(ut,{className:F("h-4 w-4",g&&"animate-spin")})})]})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:h?.type==="virtual"&&h.virtualConfig?e.jsxs(e.Fragment,{children:[e.jsx(Mm,{className:"h-3 w-3 text-primary"}),e.jsx("span",{children:""}),e.jsx("span",{className:"font-medium text-primary",children:h.virtualConfig.userName}),e.jsxs("span",{className:"text-xs",children:["(",h.virtualConfig.platform,")"]}),h.virtualConfig.groupName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:""}),e.jsxs("span",{className:"text-xs",children:["",h.virtualConfig.groupName]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx($l,{className:"h-3 w-3"}),e.jsx("span",{children:""}),A?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{value:S,onChange:Y=>P(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&Ee(),Y.key==="Escape"&&de()},className:"h-7 w-32",placeholder:"",autoFocus:!0}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:Ee,children:""}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:de,children:""})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:b}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:ae,title:"",children:e.jsx(V1,{className:"h-3 w-3"})})]})]})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ss,{className:"h-full",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto space-y-3 sm:space-y-4",children:[h?.messages.length===0&&!j&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(Kn,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsxs("p",{className:"text-sm",children:[" ",h?.sessionInfo.bot_name||""," "]})]}),h?.messages.map(Y=>e.jsxs("div",{className:F("flex gap-2 sm:gap-3",Y.type==="user"&&"flex-row-reverse",Y.type==="system"&&"justify-center",Y.type==="error"&&"justify-center"),children:[Y.type==="system"&&e.jsx("div",{className:"text-xs text-muted-foreground bg-muted/50 px-3 py-1 rounded-full max-w-[90%]",children:Y.content}),Y.type==="error"&&e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30 px-3 py-1 rounded-full max-w-[90%]",children:Y.content}),Y.type==="thinking"&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:"bg-primary/10 text-primary",children:e.jsx(Kn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:"flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",children:[e.jsx("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:e.jsx("span",{className:"hidden sm:inline",children:Y.sender?.name||h?.sessionInfo.bot_name})}),e.jsx("div",{className:"bg-muted rounded-2xl rounded-tl-sm px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"..."})]})})]})]}),(Y.type==="user"||Y.type==="bot")&&e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Wi,{className:F("text-xs",Y.type==="bot"?"bg-primary/10 text-primary":"bg-secondary text-secondary-foreground"),children:Y.type==="bot"?e.jsx(Kn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):e.jsx($l,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:F("flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",Y.type==="user"&&"items-end"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:Y.sender?.name||(Y.type==="bot"?h?.sessionInfo.bot_name:b)}),e.jsx("span",{children:ze(Y.timestamp)})]}),e.jsx("div",{className:F("rounded-2xl px-3 py-2 text-sm break-words",Y.type==="bot"?"bg-muted rounded-tl-sm":"bg-primary text-primary-foreground rounded-tr-sm"),children:e.jsx(AC,{message:Y,isBot:Y.type==="bot"})})]})]})]},Y.id)),e.jsx("div",{ref:ue})]})})}),e.jsx("div",{className:"shrink-0 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ne,{value:f,onChange:Y=>p(Y.target.value),onKeyDown:Le,placeholder:h?.isConnected?"...":"...",disabled:!h?.isConnected,className:"flex-1 h-10 sm:h-10"}),e.jsx(_,{onClick:Z,disabled:!h?.isConnected||!f.trim(),size:"icon",className:"h-10 w-10 shrink-0",children:e.jsx(G1,{className:"h-4 w-4"})})]})})})]})}var Cx="Radio",[RC,jN]=td(Cx),[DC,OC]=RC(Cx),vN=u.forwardRef((a,l)=>{const{__scopeRadio:r,name:c,checked:d=!1,required:m,disabled:h,value:f="on",onCheck:p,form:g,...N}=a,[j,y]=u.useState(null),b=ad(l,M=>y(M)),w=u.useRef(!1),A=j?g||!!j.closest("form"):!0;return e.jsxs(DC,{scope:r,checked:d,disabled:h,children:[e.jsx(sr.button,{type:"button",role:"radio","aria-checked":d,"data-state":wN(d),"data-disabled":h?"":void 0,disabled:h,value:f,...N,ref:b,onClick:Nn(a.onClick,M=>{d||p?.(),A&&(w.current=M.isPropagationStopped(),w.current||M.stopPropagation())})}),A&&e.jsx(yN,{control:j,bubbles:!w.current,name:c,value:f,checked:d,required:m,disabled:h,form:g,style:{transform:"translateX(-100%)"}})]})});vN.displayName=Cx;var NN="RadioIndicator",bN=u.forwardRef((a,l)=>{const{__scopeRadio:r,forceMount:c,...d}=a,m=OC(NN,r);return e.jsx(m1,{present:c||m.checked,children:e.jsx(sr.span,{"data-state":wN(m.checked),"data-disabled":m.disabled?"":void 0,...d,ref:l})})});bN.displayName=NN;var LC="RadioBubbleInput",yN=u.forwardRef(({__scopeRadio:a,control:l,checked:r,bubbles:c=!0,...d},m)=>{const h=u.useRef(null),f=ad(h,m),p=x1(r),g=h1(l);return u.useEffect(()=>{const N=h.current;if(!N)return;const j=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(j,"checked").set;if(p!==r&&b){const w=new Event("click",{bubbles:c});b.call(N,r),N.dispatchEvent(w)}},[p,r,c]),e.jsx(sr.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...d,tabIndex:-1,ref:f,style:{...d.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});yN.displayName=LC;function wN(a){return a?"checked":"unchecked"}var UC=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],fd="RadioGroup",[$C]=td(fd,[Ej,jN]),_N=Ej(),SN=jN(),[BC,IC]=$C(fd),kN=u.forwardRef((a,l)=>{const{__scopeRadioGroup:r,name:c,defaultValue:d,value:m,required:h=!1,disabled:f=!1,orientation:p,dir:g,loop:N=!0,onValueChange:j,...y}=a,b=_N(r),w=Kj(g),[A,M]=sd({prop:m,defaultProp:d??null,onChange:j,caller:fd});return e.jsx(BC,{scope:r,name:c,required:h,disabled:f,value:A,onValueChange:M,children:e.jsx(Tw,{asChild:!0,...b,orientation:p,dir:w,loop:N,children:e.jsx(sr.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":f?"":void 0,dir:w,...y,ref:l})})})});kN.displayName=fd;var CN="RadioGroupItem",TN=u.forwardRef((a,l)=>{const{__scopeRadioGroup:r,disabled:c,...d}=a,m=IC(CN,r),h=m.disabled||c,f=_N(r),p=SN(r),g=u.useRef(null),N=ad(l,g),j=m.value===d.value,y=u.useRef(!1);return u.useEffect(()=>{const b=A=>{UC.includes(A.key)&&(y.current=!0)},w=()=>y.current=!1;return document.addEventListener("keydown",b),document.addEventListener("keyup",w),()=>{document.removeEventListener("keydown",b),document.removeEventListener("keyup",w)}},[]),e.jsx(Ew,{asChild:!0,...f,focusable:!h,active:j,children:e.jsx(vN,{disabled:h,required:m.required,checked:j,...p,...d,name:m.name,ref:N,onCheck:()=>m.onValueChange(d.value),onKeyDown:Nn(b=>{b.key==="Enter"&&b.preventDefault()}),onFocus:Nn(d.onFocus,()=>{y.current&&g.current?.click()})})})});TN.displayName=CN;var PC="RadioGroupIndicator",EN=u.forwardRef((a,l)=>{const{__scopeRadioGroup:r,...c}=a,d=SN(r);return e.jsx(bN,{...d,...c,ref:l})});EN.displayName=PC;var MN=kN,AN=TN,FC=EN;const Tx=u.forwardRef(({className:a,...l},r)=>e.jsx(MN,{className:F("grid gap-2",a),...l,ref:r}));Tx.displayName=MN.displayName;const Xo=u.forwardRef(({className:a,...l},r)=>e.jsx(AN,{ref:r,className:F("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),...l,children:e.jsx(FC,{className:"flex items-center justify-center",children:e.jsx(Ho,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Xo.displayName=AN.displayName;function HC({question:a,value:l,onChange:r,error:c,disabled:d=!1}){const[m,h]=u.useState(null),f=d||a.readOnly,p=()=>{switch(a.type){case"single":return e.jsx(Tx,{value:l||"",onValueChange:r,disabled:f,className:"space-y-2",children:a.options?.map(g=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:g.value,id:`${a.id}-${g.id}`}),e.jsx(T,{htmlFor:`${a.id}-${g.id}`,className:"cursor-pointer font-normal",children:g.label})]},g.id))});case"multiple":{const g=l||[];return e.jsxs("div",{className:"space-y-2",children:[a.options?.map(N=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:`${a.id}-${N.id}`,checked:g.includes(N.value),disabled:f||a.maxSelections!==void 0&&g.length>=a.maxSelections&&!g.includes(N.value),onCheckedChange:j=>{r(j?[...g,N.value]:g.filter(y=>y!==N.value))}}),e.jsx(T,{htmlFor:`${a.id}-${N.id}`,className:"cursor-pointer font-normal",children:N.label})]},N.id)),a.maxSelections&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",a.maxSelections," "]})]})}case"text":return e.jsx(ne,{value:l||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,className:F(a.readOnly&&"bg-muted cursor-not-allowed")});case"textarea":return e.jsxs("div",{className:"space-y-1",children:[e.jsx(ft,{value:l||"",onChange:g=>r(g.target.value),placeholder:a.placeholder||"...",disabled:f,readOnly:a.readOnly,maxLength:a.maxLength,rows:4,className:F(a.readOnly&&"bg-muted cursor-not-allowed")}),a.maxLength&&e.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[(l||"").length," / ",a.maxLength]})]});case"rating":{const g=l||0,N=m!==null?m:g;return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(j=>e.jsx("button",{type:"button",disabled:f,className:F("p-1 transition-colors focus:outline-none focus:ring-2 focus:ring-ring rounded",f&&"cursor-not-allowed opacity-50"),onMouseEnter:()=>!f&&h(j),onMouseLeave:()=>h(null),onClick:()=>!f&&r(j),children:e.jsx(fn,{className:F("h-6 w-6 transition-colors",j<=N?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},j)),g>0&&e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:[g," / 5"]})]})}case"scale":{const g=a.min??1,N=a.max??10,j=a.step??1,y=l??g;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Wa,{value:[y],onValueChange:([b])=>r(b),min:g,max:N,step:j,disabled:f}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:a.minLabel||g}),e.jsx("span",{className:"font-medium text-foreground",children:y}),e.jsx("span",{children:a.maxLabel||N})]})]})}case"dropdown":return e.jsxs(Pe,{value:l||"",onValueChange:r,disabled:f,children:[e.jsx(Be,{children:e.jsx(Fe,{placeholder:a.placeholder||"..."})}),e.jsx(Ie,{children:a.options?.map(g=>e.jsx(ee,{value:g.value,children:g.label},g.id))})]});default:return e.jsx("div",{className:"text-muted-foreground",children:""})}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(T,{className:"text-base font-medium",children:[a.title,a.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),p(),c&&e.jsx("p",{className:"text-sm text-destructive",children:c})]})}const zN="https://maibot-plugin-stats.maibot-webui.workers.dev";function RN(){const a="maibot_user_id";let l=localStorage.getItem(a);if(!l){const r=Math.random().toString(36).substring(2,10),c=Date.now().toString(36),d=Math.random().toString(36).substring(2,10);l=`fp_${r}_${c}_${d}`,localStorage.setItem(a,l)}return l}async function qC(a,l,r,c){try{const d=c?.userId||RN(),m={surveyId:a,surveyVersion:l,userId:d,answers:r,submittedAt:new Date().toISOString(),allowMultiple:c?.allowMultiple,metadata:{userAgent:navigator.userAgent,language:navigator.language}},h=await fetch(`${zN}/survey/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),f=await h.json();return h.status===429?{success:!1,error:""}:h.status===409?{success:!1,error:f.error||""}:h.ok?{success:!0,submissionId:f.submissionId,message:f.message}:{success:!1,error:f.error||""}}catch(d){return console.error("Error submitting survey:",d),{success:!1,error:""}}}async function VC(a,l){try{const r=l||RN(),c=new URLSearchParams({user_id:r,survey_id:a}),d=await fetch(`${zN}/survey/check?${c}`);return d.ok?{success:!0,hasSubmitted:(await d.json()).hasSubmitted}:{success:!1,error:(await d.json()).error||""}}catch(r){return console.error("Error checking submission:",r),{success:!1,error:""}}}function DN({config:a,initialAnswers:l,onSubmitSuccess:r,onSubmitError:c,showProgress:d=!0,paginateQuestions:m=!1,className:h}){const f=u.useCallback(()=>!l||l.length===0?{}:l.reduce((B,ue)=>(B[ue.questionId]=ue.value,B),{}),[l]),[p,g]=u.useState(()=>f()),[N,j]=u.useState({}),[y,b]=u.useState(0),[w,A]=u.useState(!1),[M,S]=u.useState(!1),[P,E]=u.useState(null),[C,R]=u.useState(null),[H,O]=u.useState(!1),[X,L]=u.useState(!0);u.useEffect(()=>{l&&l.length>0&&g(B=>({...B,...f()}))},[l,f]),u.useEffect(()=>{(async()=>{if(!a.settings?.allowMultiple){const ue=await VC(a.id);ue.success&&ue.hasSubmitted&&O(!0)}L(!1)})()},[a.id,a.settings?.allowMultiple]);const me=u.useCallback(()=>{const B=new Date;return!(a.settings?.startTime&&new Date(a.settings.startTime)>B||a.settings?.endTime&&new Date(a.settings.endTime)<B)},[a.settings?.startTime,a.settings?.endTime]),Ne=a.questions.filter(B=>{const ue=p[B.id];return ue==null?!1:Array.isArray(ue)?ue.length>0:typeof ue=="string"?ue.trim()!=="":!0}).length,je=Ne/a.questions.length*100,ce=u.useCallback((B,ue)=>{g(Q=>({...Q,[B]:ue})),j(Q=>{const _e={...Q};return delete _e[B],_e})},[]),ge=u.useCallback(()=>{const B={};for(const ue of a.questions){if(ue.required){const Q=p[ue.id];if(Q==null){B[ue.id]="";continue}if(Array.isArray(Q)&&Q.length===0){B[ue.id]="";continue}if(typeof Q=="string"&&Q.trim()===""){B[ue.id]="";continue}}ue.minLength&&typeof p[ue.id]=="string"&&p[ue.id].length<ue.minLength&&(B[ue.id]=` ${ue.minLength} `)}return j(B),Object.keys(B).length===0},[a.questions,p]),pe=u.useCallback(async()=>{if(!ge()){if(m){const B=a.questions.findIndex(ue=>N[ue.id]);B>=0&&b(B)}return}A(!0),E(null);try{const B=a.questions.filter(Q=>p[Q.id]!==void 0).map(Q=>({questionId:Q.id,value:p[Q.id]})),ue=await qC(a.id,a.version,B,{allowMultiple:a.settings?.allowMultiple});if(ue.success&&ue.submissionId)S(!0),R(ue.submissionId),r?.(ue.submissionId);else{const Q=ue.error||"";E(Q),c?.(Q)}}catch(B){const ue=B instanceof Error?B.message:"";E(ue),c?.(ue)}finally{A(!1)}},[ge,m,a,p,N,r,c]),D=u.useCallback(B=>{B>=0&&B<a.questions.length&&b(B)},[a.questions.length]);if(X)return e.jsx(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:e.jsx(Ae,{className:"py-12 flex items-center justify-center",children:e.jsx(Fs,{className:"h-6 w-6 animate-spin text-muted-foreground"})})});if(H&&!a.settings?.allowMultiple)return e.jsxs(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsx(Ue,{children:a.title})}),e.jsx(Ae,{className:"py-8",children:e.jsxs(pt,{children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]})})]});if(!me())return e.jsxs(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsx(Ue,{children:a.title})}),e.jsx(Ae,{className:"py-8",children:e.jsxs(pt,{variant:"destructive",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]})})]});if(M)return e.jsxs(Ce,{className:F("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsxs(Ue,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(tt,{className:"h-6 w-6"}),""]})}),e.jsxs(Ae,{className:"py-8",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:a.settings?.thankYouMessage||""}),C&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["",C]})]})]});const K=m?[a.questions[y]]:a.questions;return e.jsxs("div",{className:F("h-full flex flex-col",h),children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 mb-4 shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:a.title}),a.description&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a.description}),d&&e.jsxs("div",{className:"space-y-1 pt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[Ne," / ",a.questions.length]})]}),e.jsx(er,{value:je,className:"h-2"})]})]}),e.jsx(ss,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[K.map((B,ue)=>e.jsxs("div",{className:F("p-4 rounded-lg border bg-card",N[B.id]?"border-destructive bg-destructive/5":"border-border"),children:[m&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[" ",y+1," / ",a.questions.length]}),!m&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[ue+1,"."]}),e.jsx(HC,{question:B,value:p[B.id],onChange:Q=>ce(B.id,Q),error:N[B.id],disabled:w})]},B.id)),P&&e.jsxs(pt,{variant:"destructive",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:P})]}),e.jsx("div",{className:"flex justify-between items-center py-4",children:m?e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"outline",onClick:()=>D(y-1),disabled:y===0||w,children:[e.jsx(Ia,{className:"h-4 w-4 mr-1"}),""]}),y===a.questions.length-1?e.jsxs(_,{onClick:pe,disabled:w,children:[w&&e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),""]}):e.jsxs(_,{onClick:()=>D(y+1),disabled:w,children:["",e.jsx(ra,{className:"h-4 w-4 ml-1"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Object.keys(N).length>0&&e.jsxs("span",{className:"text-destructive",children:[" ",Object.keys(N).length," "]})}),e.jsxs(_,{onClick:pe,disabled:w,size:"lg",children:[w&&e.jsx(Fs,{className:"h-4 w-4 mr-2 animate-spin"}),""]})]})})]})})]})}const GC={id:"webui-feedback-v1",version:"1.0.0",title:" WebUI ",description:" WebUI",questions:[{id:"webui_version",type:"text",title:" WebUI ",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"ui_design_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"problems_encountered",type:"multiple",title:" WebUI ",description:"",required:!0,options:[{id:"lag",label:"",value:"lag"},{id:"incomplete",label:"",value:"incomplete"},{id:"complex",label:"",value:"complex"},{id:"bugs",label:" Bug",value:"bugs"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"useful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:" WebUI ",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}},KC={id:"maibot-feedback-v1",version:"1.0.0",title:"",description:" AI ",questions:[{id:"maibot_version",type:"text",title:"",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"improvement_areas",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"problems_encountered",type:"multiple",title:"",description:"",required:!0,options:[{id:"incomplete",label:"",value:"incomplete"},{id:"slow_response",label:"",value:"slow_response"},{id:"complex",label:"",value:"complex"},{id:"unstable",label:"",value:"unstable"},{id:"config_difficult",label:"",value:"config_difficult"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"helpful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:"",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:"",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}};function QC(){const[a,l]=u.useState(!0),r=u.useMemo(()=>JSON.parse(JSON.stringify(GC)),[]);u.useEffect(()=>{l(!1)},[]);const c=u.useMemo(()=>[{questionId:"webui_version",value:`v${od}`}],[]),d=u.useCallback(h=>{console.log("WebUI Survey submitted:",h)},[]),m=u.useCallback(h=>{console.error("WebUI Survey submission error:",h)},[]);return a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):r?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(xv,{className:"h-8 w-8",strokeWidth:2}),"WebUI "]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(DN,{config:r,initialAnswers:c,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:d,onSubmitError:m})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(pt,{variant:"destructive",className:"max-w-md",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}function YC(){const[a,l]=u.useState(null),[r,c]=u.useState(!0),[d,m]=u.useState("");u.useEffect(()=>{(async()=>{try{const j=await B_();m(j.version||"")}catch(j){console.error("Failed to get MaiBot version:",j),m("")}const N=JSON.parse(JSON.stringify(KC));l(N),c(!1)})()},[]);const h=u.useMemo(()=>[{questionId:"maibot_version",value:d}],[d]),f=u.useCallback(g=>{console.log("MaiBot Survey submitted:",g)},[]),p=u.useCallback(g=>{console.error("MaiBot Survey submission error:",g)},[]);return r?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Fs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(xv,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" AI "})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(DN,{config:a,initialAnswers:h,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:f,onSubmitError:p})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(pt,{variant:"destructive",className:"max-w-md",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(gt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}async function JC(a=2025){const l=await Se(`/api/webui/annual-report/full?year=${a}`);if(!l.ok){const r=await l.json();throw new Error(r.detail||"")}return l.json()}function XC(a,l){if(a.match(/^[a-z]+:\/\//i))return a;if(a.match(/^\/\//))return window.location.protocol+a;if(a.match(/^[a-z]+:/i))return a;const r=document.implementation.createHTMLDocument(),c=r.createElement("base"),d=r.createElement("a");return r.head.appendChild(c),r.body.appendChild(d),l&&(c.href=l),d.href=a,d.href}const ZC=(()=>{let a=0;const l=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(a+=1,`u${l()}${a}`)})();function vn(a){const l=[];for(let r=0,c=a.length;r<c;r++)l.push(a[r]);return l}let Fr=null;function ON(a={}){return Fr||(a.includeStyleProperties?(Fr=a.includeStyleProperties,Fr):(Fr=vn(window.getComputedStyle(document.documentElement)),Fr))}function Zo(a,l){const c=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(l);return c?parseFloat(c.replace("px","")):0}function WC(a){const l=Zo(a,"border-left-width"),r=Zo(a,"border-right-width");return a.clientWidth+l+r}function e3(a){const l=Zo(a,"border-top-width"),r=Zo(a,"border-bottom-width");return a.clientHeight+l+r}function LN(a,l={}){const r=l.width||WC(a),c=l.height||e3(a);return{width:r,height:c}}function s3(){let a,l;try{l=process}catch{}const r=l&&l.env?l.env.devicePixelRatio:null;return r&&(a=parseInt(r,10),Number.isNaN(a)&&(a=1)),a||window.devicePixelRatio||1}const Da=16384;function t3(a){(a.width>Da||a.height>Da)&&(a.width>Da&&a.height>Da?a.width>a.height?(a.height*=Da/a.width,a.width=Da):(a.width*=Da/a.height,a.height=Da):a.width>Da?(a.height*=Da/a.width,a.width=Da):(a.width*=Da/a.height,a.height=Da))}function Wo(a){return new Promise((l,r)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>l(c))})},c.onerror=r,c.crossOrigin="anonymous",c.decoding="async",c.src=a})}async function a3(a){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(a)).then(encodeURIComponent).then(l=>`data:image/svg+xml;charset=utf-8,${l}`)}async function l3(a,l,r){const c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg"),m=document.createElementNS(c,"foreignObject");return d.setAttribute("width",`${l}`),d.setAttribute("height",`${r}`),d.setAttribute("viewBox",`0 0 ${l} ${r}`),m.setAttribute("width","100%"),m.setAttribute("height","100%"),m.setAttribute("x","0"),m.setAttribute("y","0"),m.setAttribute("externalResourcesRequired","true"),d.appendChild(m),m.appendChild(a),a3(d)}const wa=(a,l)=>{if(a instanceof l)return!0;const r=Object.getPrototypeOf(a);return r===null?!1:r.constructor.name===l.name||wa(r,l)};function n3(a){const l=a.getPropertyValue("content");return`${a.cssText} content: '${l.replace(/'|"/g,"")}';`}function r3(a,l){return ON(l).map(r=>{const c=a.getPropertyValue(r),d=a.getPropertyPriority(r);return`${r}: ${c}${d?" !important":""};`}).join(" ")}function i3(a,l,r,c){const d=`.${a}:${l}`,m=r.cssText?n3(r):r3(r,c);return document.createTextNode(`${d}{${m}}`)}function sj(a,l,r,c){const d=window.getComputedStyle(a,r),m=d.getPropertyValue("content");if(m===""||m==="none")return;const h=ZC();try{l.className=`${l.className} ${h}`}catch{return}const f=document.createElement("style");f.appendChild(i3(h,r,d,c)),l.appendChild(f)}function c3(a,l,r){sj(a,l,":before",r),sj(a,l,":after",r)}const tj="application/font-woff",aj="image/jpeg",o3={woff:tj,woff2:tj,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:aj,jpeg:aj,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function d3(a){const l=/\.([^./]*?)$/g.exec(a);return l?l[1]:""}function Ex(a){const l=d3(a).toLowerCase();return o3[l]||""}function u3(a){return a.split(/,/)[1]}function sx(a){return a.search(/^(data:)/)!==-1}function m3(a,l){return`data:${l};base64,${a}`}async function UN(a,l,r){const c=await fetch(a,l);if(c.status===404)throw new Error(`Resource "${c.url}" not found`);const d=await c.blob();return new Promise((m,h)=>{const f=new FileReader;f.onerror=h,f.onloadend=()=>{try{m(r({res:c,result:f.result}))}catch(p){h(p)}},f.readAsDataURL(d)})}const Gm={};function x3(a,l,r){let c=a.replace(/\?.*/,"");return r&&(c=a),/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,"")),l?`[${l}]${c}`:c}async function Mx(a,l,r){const c=x3(a,l,r.includeQueryParams);if(Gm[c]!=null)return Gm[c];r.cacheBust&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());let d;try{const m=await UN(a,r.fetchRequestInit,({res:h,result:f})=>(l||(l=h.headers.get("Content-Type")||""),u3(f)));d=m3(m,l)}catch(m){d=r.imagePlaceholder||"";let h=`Failed to fetch resource: ${a}`;m&&(h=typeof m=="string"?m:m.message),h&&console.warn(h)}return Gm[c]=d,d}async function h3(a){const l=a.toDataURL();return l==="data:,"?a.cloneNode(!1):Wo(l)}async function f3(a,l){if(a.currentSrc){const m=document.createElement("canvas"),h=m.getContext("2d");m.width=a.clientWidth,m.height=a.clientHeight,h?.drawImage(a,0,0,m.width,m.height);const f=m.toDataURL();return Wo(f)}const r=a.poster,c=Ex(r),d=await Mx(r,c,l);return Wo(d)}async function p3(a,l){var r;try{if(!((r=a?.contentDocument)===null||r===void 0)&&r.body)return await pd(a.contentDocument.body,l,!0)}catch{}return a.cloneNode(!1)}async function g3(a,l){return wa(a,HTMLCanvasElement)?h3(a):wa(a,HTMLVideoElement)?f3(a,l):wa(a,HTMLIFrameElement)?p3(a,l):a.cloneNode($N(a))}const j3=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SLOT",$N=a=>a.tagName!=null&&a.tagName.toUpperCase()==="SVG";async function v3(a,l,r){var c,d;if($N(l))return l;let m=[];return j3(a)&&a.assignedNodes?m=vn(a.assignedNodes()):wa(a,HTMLIFrameElement)&&(!((c=a.contentDocument)===null||c===void 0)&&c.body)?m=vn(a.contentDocument.body.childNodes):m=vn(((d=a.shadowRoot)!==null&&d!==void 0?d:a).childNodes),m.length===0||wa(a,HTMLVideoElement)||await m.reduce((h,f)=>h.then(()=>pd(f,r)).then(p=>{p&&l.appendChild(p)}),Promise.resolve()),l}function N3(a,l,r){const c=l.style;if(!c)return;const d=window.getComputedStyle(a);d.cssText?(c.cssText=d.cssText,c.transformOrigin=d.transformOrigin):ON(r).forEach(m=>{let h=d.getPropertyValue(m);m==="font-size"&&h.endsWith("px")&&(h=`${Math.floor(parseFloat(h.substring(0,h.length-2)))-.1}px`),wa(a,HTMLIFrameElement)&&m==="display"&&h==="inline"&&(h="block"),m==="d"&&l.getAttribute("d")&&(h=`path(${l.getAttribute("d")})`),c.setProperty(m,h,d.getPropertyPriority(m))})}function b3(a,l){wa(a,HTMLTextAreaElement)&&(l.innerHTML=a.value),wa(a,HTMLInputElement)&&l.setAttribute("value",a.value)}function y3(a,l){if(wa(a,HTMLSelectElement)){const c=Array.from(l.children).find(d=>a.value===d.getAttribute("value"));c&&c.setAttribute("selected","")}}function w3(a,l,r){return wa(l,Element)&&(N3(a,l,r),c3(a,l,r),b3(a,l),y3(a,l)),l}async function _3(a,l){const r=a.querySelectorAll?a.querySelectorAll("use"):[];if(r.length===0)return a;const c={};for(let m=0;m<r.length;m++){const f=r[m].getAttribute("xlink:href");if(f){const p=a.querySelector(f),g=document.querySelector(f);!p&&g&&!c[f]&&(c[f]=await pd(g,l,!0))}}const d=Object.values(c);if(d.length){const m="http://www.w3.org/1999/xhtml",h=document.createElementNS(m,"svg");h.setAttribute("xmlns",m),h.style.position="absolute",h.style.width="0",h.style.height="0",h.style.overflow="hidden",h.style.display="none";const f=document.createElementNS(m,"defs");h.appendChild(f);for(let p=0;p<d.length;p++)f.appendChild(d[p]);a.appendChild(h)}return a}async function pd(a,l,r){return!r&&l.filter&&!l.filter(a)?null:Promise.resolve(a).then(c=>g3(c,l)).then(c=>v3(a,c,l)).then(c=>w3(a,c,l)).then(c=>_3(c,l))}const BN=/url\((['"]?)([^'"]+?)\1\)/g,S3=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,k3=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function C3(a){const l=a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${l})(['"]?\\))`,"g")}function T3(a){const l=[];return a.replace(BN,(r,c,d)=>(l.push(d),r)),l.filter(r=>!sx(r))}async function E3(a,l,r,c,d){try{const m=r?XC(l,r):l,h=Ex(l);let f;return d||(f=await Mx(m,h,c)),a.replace(C3(l),`$1${f}$3`)}catch{}return a}function M3(a,{preferredFontFormat:l}){return l?a.replace(k3,r=>{for(;;){const[c,,d]=S3.exec(r)||[];if(!d)return"";if(d===l)return`src: ${c};`}}):a}function IN(a){return a.search(BN)!==-1}async function PN(a,l,r){if(!IN(a))return a;const c=M3(a,r);return T3(c).reduce((m,h)=>m.then(f=>E3(f,h,l,r)),Promise.resolve(c))}async function Hr(a,l,r){var c;const d=(c=l.style)===null||c===void 0?void 0:c.getPropertyValue(a);if(d){const m=await PN(d,null,r);return l.style.setProperty(a,m,l.style.getPropertyPriority(a)),!0}return!1}async function A3(a,l){await Hr("background",a,l)||await Hr("background-image",a,l),await Hr("mask",a,l)||await Hr("-webkit-mask",a,l)||await Hr("mask-image",a,l)||await Hr("-webkit-mask-image",a,l)}async function z3(a,l){const r=wa(a,HTMLImageElement);if(!(r&&!sx(a.src))&&!(wa(a,SVGImageElement)&&!sx(a.href.baseVal)))return;const c=r?a.src:a.href.baseVal,d=await Mx(c,Ex(c),l);await new Promise((m,h)=>{a.onload=m,a.onerror=l.onImageErrorHandler?(...p)=>{try{m(l.onImageErrorHandler(...p))}catch(g){h(g)}}:h;const f=a;f.decode&&(f.decode=m),f.loading==="lazy"&&(f.loading="eager"),r?(a.srcset="",a.src=d):a.href.baseVal=d})}async function R3(a,l){const c=vn(a.childNodes).map(d=>FN(d,l));await Promise.all(c).then(()=>a)}async function FN(a,l){wa(a,Element)&&(await A3(a,l),await z3(a,l),await R3(a,l))}function D3(a,l){const{style:r}=a;l.backgroundColor&&(r.backgroundColor=l.backgroundColor),l.width&&(r.width=`${l.width}px`),l.height&&(r.height=`${l.height}px`);const c=l.style;return c!=null&&Object.keys(c).forEach(d=>{r[d]=c[d]}),a}const lj={};async function nj(a){let l=lj[a];if(l!=null)return l;const c=await(await fetch(a)).text();return l={url:a,cssText:c},lj[a]=l,l}async function rj(a,l){let r=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,m=(r.match(/url\([^)]+\)/g)||[]).map(async h=>{let f=h.replace(c,"$1");return f.startsWith("https://")||(f=new URL(f,a.url).href),UN(f,l.fetchRequestInit,({result:p})=>(r=r.replace(h,`url(${p})`),[h,p]))});return Promise.all(m).then(()=>r)}function ij(a){if(a==null)return[];const l=[],r=/(\/\*[\s\S]*?\*\/)/gi;let c=a.replace(r,"");const d=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=d.exec(c);if(p===null)break;l.push(p[0])}c=c.replace(d,"");const m=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,h="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",f=new RegExp(h,"gi");for(;;){let p=m.exec(c);if(p===null){if(p=f.exec(c),p===null)break;m.lastIndex=f.lastIndex}else f.lastIndex=m.lastIndex;l.push(p[0])}return l}async function O3(a,l){const r=[],c=[];return a.forEach(d=>{if("cssRules"in d)try{vn(d.cssRules||[]).forEach((m,h)=>{if(m.type===CSSRule.IMPORT_RULE){let f=h+1;const p=m.href,g=nj(p).then(N=>rj(N,l)).then(N=>ij(N).forEach(j=>{try{d.insertRule(j,j.startsWith("@import")?f+=1:d.cssRules.length)}catch(y){console.error("Error inserting rule from remote css",{rule:j,error:y})}})).catch(N=>{console.error("Error loading remote css",N.toString())});c.push(g)}})}catch(m){const h=a.find(f=>f.href==null)||document.styleSheets[0];d.href!=null&&c.push(nj(d.href).then(f=>rj(f,l)).then(f=>ij(f).forEach(p=>{h.insertRule(p,h.cssRules.length)})).catch(f=>{console.error("Error loading remote stylesheet",f)})),console.error("Error inlining remote css file",m)}}),Promise.all(c).then(()=>(a.forEach(d=>{if("cssRules"in d)try{vn(d.cssRules||[]).forEach(m=>{r.push(m)})}catch(m){console.error(`Error while reading CSS rules from ${d.href}`,m)}}),r))}function L3(a){return a.filter(l=>l.type===CSSRule.FONT_FACE_RULE).filter(l=>IN(l.style.getPropertyValue("src")))}async function U3(a,l){if(a.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=vn(a.ownerDocument.styleSheets),c=await O3(r,l);return L3(c)}function HN(a){return a.trim().replace(/["']/g,"")}function $3(a){const l=new Set;function r(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(m=>{l.add(HN(m))}),Array.from(c.children).forEach(m=>{m instanceof HTMLElement&&r(m)})}return r(a),l}async function B3(a,l){const r=await U3(a,l),c=$3(a);return(await Promise.all(r.filter(m=>c.has(HN(m.style.fontFamily))).map(m=>{const h=m.parentStyleSheet?m.parentStyleSheet.href:null;return PN(m.cssText,h,l)}))).join(`
`)}async function I3(a,l){const r=l.fontEmbedCSS!=null?l.fontEmbedCSS:l.skipFonts?null:await B3(a,l);if(r){const c=document.createElement("style"),d=document.createTextNode(r);c.appendChild(d),a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}}async function P3(a,l={}){const{width:r,height:c}=LN(a,l),d=await pd(a,l,!0);return await I3(d,l),await FN(d,l),D3(d,l),await l3(d,r,c)}async function F3(a,l={}){const{width:r,height:c}=LN(a,l),d=await P3(a,l),m=await Wo(d),h=document.createElement("canvas"),f=h.getContext("2d"),p=l.pixelRatio||s3(),g=l.canvasWidth||r,N=l.canvasHeight||c;return h.width=g*p,h.height=N*p,l.skipAutoScale||t3(h),h.style.width=`${g}`,h.style.height=`${N}`,l.backgroundColor&&(f.fillStyle=l.backgroundColor,f.fillRect(0,0,h.width,h.height)),f.drawImage(m,0,0,h.width,h.height),h}async function H3(a,l={}){return(await F3(a,l)).toDataURL()}const Lo=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"];function q3(a){return a>=8760?"7x24":a>=5e3?"":a>=2e3?" 1000 ":a>=1e3?" 80 ":a>=500?" 100 ":a>=100?" 25 ":""}function V3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":""}function G3(a){const l=a/1e6;return l>=100?"":l>=50?"":l>=10?"":l>=1?"":""}function K3(a){return a>=1e3?"":a>=500?"":a>=100?"":a>=50?"":a>=10?"":""}function Q3(a){return a>=80?"":a>=60?"":a>=40?"":a>=20?"":""}function Y3(a){return a>=1e4?"":a>=5e3?"":a>=1e3?"":a>=500?"":a>=100?"":""}function J3(a){return a>=500?"":a>=200?"":a>=100?"":a>=50?"":a>=10?"":""}function X3(a){return a>=1?"":a>=.5?"":a>=.1?"":a>=.01?"":""}function Z3(a,l){return a>=100?"":a>=50?"":a>=20?`${l}`:a>=10?"":""}function W3(a,l){return a?l>=1e3?"":l>=500?"":l>=100?"":"":l<=10?"":l<=50?"":""}function e5(a){return a>=1e3?"":a>=500?"":a>=200?"":a>=100?"":a>=50?"":""}function s5(){const[a]=u.useState(2025),[l,r]=u.useState(null),[c,d]=u.useState(!0),[m,h]=u.useState(!1),[f,p]=u.useState(null),g=u.useRef(null),{toast:N}=it(),j=u.useCallback(async()=>{try{d(!0),p(null);const b=await JC(a);r(b)}catch(b){p(b instanceof Error?b:new Error(""))}finally{d(!1)}},[a]),y=u.useCallback(async()=>{if(!(!g.current||!l)){h(!0),N({title:"",description:"..."});try{const b=g.current,w=getComputedStyle(document.documentElement),A=w.getPropertyValue("--background").trim()?`hsl(${w.getPropertyValue("--background").trim()})`:document.documentElement.classList.contains("dark")?"#0a0a0a":"#ffffff",M=b.style.width,S=b.style.maxWidth;b.style.width="1024px",b.style.maxWidth="1024px";const P=await H3(b,{quality:1,pixelRatio:2,backgroundColor:A,cacheBust:!0,filter:C=>!(C instanceof HTMLElement&&C.hasAttribute("data-export-btn"))});b.style.width=M,b.style.maxWidth=S;const E=document.createElement("a");E.download=`${l.bot_name}_${l.year}_.png`,E.href=P,E.click(),N({title:"",description:""})}catch(b){console.error(":",b),N({title:"",description:"",variant:"destructive"})}finally{h(!1)}}},[l,N]);return u.useEffect(()=>{j()},[j]),c?e.jsx(t5,{}):f?e.jsxs("div",{className:"flex h-screen items-center justify-center text-red-500",children:[": ",f.message]}):l?e.jsx(ss,{className:"h-[calc(100vh-4rem)]",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/50 p-4 md:p-8 print:p-0",ref:g,children:e.jsxs("div",{className:"mx-auto max-w-5xl space-y-8 print:space-y-4",children:[e.jsxs("header",{className:"relative overflow-hidden rounded-3xl bg-primary p-8 text-primary-foreground shadow-2xl print:rounded-none print:shadow-none",children:[e.jsx("div",{className:"absolute right-4 top-4 z-20 print:hidden","data-export-btn":!0,children:e.jsx(_,{variant:"secondary",size:"sm",onClick:y,disabled:m,className:"gap-2 bg-white/20 hover:bg-white/30 text-white border-white/30",children:m?e.jsxs(e.Fragment,{children:[e.jsx(Fs,{className:"h-4 w-4 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(na,{className:"h-4 w-4"}),""]})})}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx(Kn,{className:"mb-4 h-16 w-16 animate-bounce"}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tighter sm:text-6xl",children:[l.bot_name," ",l.year," "]}),e.jsx("p",{className:"mt-4 max-w-2xl text-lg opacity-90",children:"  Connection & Growth"}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-sm opacity-75",children:[e.jsx(Vo,{className:"h-4 w-4"}),e.jsxs("span",{children:[": ",l.generated_at]})]})]}),e.jsx("div",{className:"absolute -right-20 -top-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ia,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Oa,{title:"",value:`${l.time_footprint.total_online_hours} `,description:q3(l.time_footprint.total_online_hours),icon:e.jsx(ia,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.time_footprint.busiest_day||"N/A",description:e5(l.time_footprint.busiest_day_count),icon:e.jsx(Vo,{className:"h-4 w-4"})}),e.jsx(Oa,{title:" (0-4)",value:`${l.time_footprint.midnight_chat_count} `,description:V3(l.time_footprint.midnight_chat_count),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.time_footprint.is_night_owl?"":"",description:W3(l.time_footprint.is_night_owl,l.time_footprint.midnight_chat_count),icon:l.time_footprint.is_night_owl?e.jsx(ec,{className:"h-4 w-4"}):e.jsx(nx,{className:"h-4 w-4"})})]}),e.jsxs(Ce,{className:"overflow-hidden",children:[e.jsxs(De,{children:[e.jsx(Ue,{children:"24"}),e.jsxs(fs,{children:[l.bot_name,""]})]}),e.jsx(Ae,{className:"h-[300px]",children:e.jsx(zj,{width:"100%",height:"100%",children:e.jsxs(Uo,{data:l.time_footprint.hourly_distribution.map((b,w)=>({hour:`${w}`,count:b})),children:[e.jsx(Qi,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Yi,{dataKey:"hour"}),e.jsx(qr,{}),e.jsx(Rj,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},cursor:{fill:"transparent"}}),e.jsx(Ji,{dataKey:"count",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),l.time_footprint.first_message_time&&e.jsx(Ce,{className:"bg-muted/30 border-dashed",children:e.jsxs(Ae,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"2025"}),e.jsx("div",{className:"text-xl font-bold text-primary mb-1",children:l.time_footprint.first_message_time}),e.jsxs("p",{className:"text-lg",children:[e.jsx("span",{className:"font-semibold text-foreground",children:l.time_footprint.first_message_user})," ",e.jsxs("span",{className:"italic text-muted-foreground",children:['"',l.time_footprint.first_message_content,'"']})]})]})})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ic,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(Oa,{title:"",value:`${l.social_network.total_groups} `,description:`${l.bot_name}`,icon:e.jsx(ic,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:`${l.social_network.at_count+l.social_network.mentioned_count} `,description:"",icon:e.jsx(K1,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.social_network.longest_companion_user||"N/A",description:` ${l.social_network.longest_companion_days} `,icon:e.jsx(Zr,{className:"h-4 w-4 text-red-500"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Ue,{children:" TOP5"})}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-3",children:l.social_network.top_groups.length>0?l.social_network.top_groups.map((b,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:w===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:w+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:b.group_name}),b.is_webui&&e.jsx(ke,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[b.message_count," "]})]},b.group_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Ue,{children:" TOP5"})}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-3",children:l.social_network.top_users.length>0?l.social_network.top_users.map((b,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{variant:w===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center shrink-0",children:w+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:b.user_nickname}),b.is_webui&&e.jsx(ke,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-blue-50 text-blue-600 border-blue-200",children:"WebUI"})]}),e.jsxs("span",{className:"text-muted-foreground text-sm shrink-0",children:[b.message_count," "]})]},b.user_id)):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:""})})})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(dx,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Oa,{title:" Token ",value:(l.brain_power.total_tokens/1e6).toFixed(2)+" M",description:G3(l.brain_power.total_tokens),icon:e.jsx(el,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:`$${l.brain_power.total_cost.toFixed(2)}`,description:K3(l.brain_power.total_cost),icon:e.jsx("span",{className:"font-bold",children:"$"})}),e.jsx(Oa,{title:"",value:`${l.brain_power.silence_rate}%`,description:Q3(l.brain_power.silence_rate),icon:e.jsx(ec,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:l.brain_power.max_interest_value??"N/A",description:l.brain_power.max_interest_time?` ${l.brain_power.max_interest_time}`:"",icon:e.jsx(Zr,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Ue,{children:""})}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-3",children:l.brain_power.model_distribution.slice(0,5).map((b,w)=>{const A=l.brain_power.model_distribution[0]?.count||1,M=Math.round(b.count/A*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:b.model}),e.jsxs("span",{className:"text-muted-foreground",children:[b.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${M}%`,backgroundColor:Lo[w%Lo.length]}})})]},b.model)})})})]}),l.brain_power.top_reply_models&&l.brain_power.top_reply_models.length>0&&e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:" TOP5"}),e.jsxs(fs,{children:[l.bot_name,""]})]}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-3",children:l.brain_power.top_reply_models.map((b,w)=>{const A=l.brain_power.top_reply_models[0]?.count||1,M=Math.round(b.count/A*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:b.model}),e.jsxs("span",{className:"text-muted-foreground",children:[b.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${M}%`,backgroundColor:Lo[w%Lo.length]}})})]},b.model)})})})]}),l.brain_power.top_token_consumers&&l.brain_power.top_token_consumers.length>0&&e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:" TOP3"}),e.jsx(fs,{children:" API "})]}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-6",children:l.brain_power.top_token_consumers.map(b=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsxs("span",{children:[" ",b.user_id]}),e.jsxs("span",{children:["$",b.cost.toFixed(2)]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-500",style:{width:`${b.cost/(l.brain_power.top_token_consumers[0]?.cost||1)*100}%`}})})]},b.user_id))})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20",children:[e.jsx(De,{children:e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Ae,{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-amber-600 dark:text-amber-400",children:["$",l.brain_power.most_expensive_cost.toFixed(4)]}),l.brain_power.most_expensive_time&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[" ",l.brain_power.most_expensive_time]}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:X3(l.brain_power.most_expensive_cost)})]})]}),e.jsxs(Ce,{className:"bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-950/20 dark:to-blue-950/20",children:[e.jsx(De,{children:e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:l.brain_power.avg_reasoning_length?.toFixed(0)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:l.brain_power.max_reasoning_length?.toLocaleString()||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]}),l.brain_power.max_reasoning_time&&e.jsxs("p",{className:"mt-4 text-center text-xs text-muted-foreground",children:[" ",l.brain_power.max_reasoning_time]})]})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ld,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),(l.expression_vibe.late_night_reply||l.expression_vibe.favorite_reply)&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[l.expression_vibe.late_night_reply&&e.jsxs(Ce,{className:"bg-gradient-to-br from-indigo-50 to-violet-50 dark:from-indigo-950/20 dark:to-violet-950/20",children:[e.jsxs(De,{children:[e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(fs,{children:[" ",l.expression_vibe.late_night_reply.time,"",l.bot_name,"..."]})]}),e.jsxs(Ae,{className:"text-center",children:[e.jsxs("p",{className:"text-lg italic text-muted-foreground",children:['"',l.expression_vibe.late_night_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:""})]})]}),l.expression_vibe.favorite_reply&&e.jsxs(Ce,{className:"bg-gradient-to-br from-rose-50 to-pink-50 dark:from-rose-950/20 dark:to-pink-950/20",children:[e.jsxs(De,{children:[e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsxs(fs,{children:[" ",l.expression_vibe.favorite_reply.count," "]})]}),e.jsxs(Ae,{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-medium text-primary",children:['"',l.expression_vibe.favorite_reply.content,'"']}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:Z3(l.expression_vibe.favorite_reply.count,l.bot_name)})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/20 dark:to-purple-950/20",children:[e.jsxs(De,{children:[e.jsx(Ue,{children:" TOP3"}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:l.expression_vibe.top_emojis&&l.expression_vibe.top_emojis.length>0?e.jsx("div",{className:"flex justify-center gap-4",children:l.expression_vibe.top_emojis.slice(0,3).map((b,w)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/api/webui/emoji/${b.id}/thumbnail?original=true`,alt:`TOP ${w+1}`,className:"h-24 w-24 rounded-lg object-cover shadow-md transition-transform hover:scale-105"}),e.jsx(ke,{className:F("absolute -top-2 -right-2",w===0?"bg-yellow-500":w===1?"bg-gray-400":"bg-amber-700"),children:w+1})]}),e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[b.usage_count," "]})]},b.id))}):e.jsx("div",{className:"flex h-32 items-center justify-center text-muted-foreground",children:""})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsxs(fs,{children:[l.bot_name,""]})]}),e.jsx(Ae,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:l.expression_vibe.top_expressions.map((b,w)=>e.jsxs(ke,{variant:"outline",className:F("px-3 py-1 text-sm",w===0&&"border-primary bg-primary/10 text-primary text-base px-4 py-2"),children:[b.style," (",b.count,")"]},b.style))})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Oa,{title:"",value:`${l.expression_vibe.image_processed_count} `,description:Y3(l.expression_vibe.image_processed_count),icon:e.jsx(ox,{className:"h-4 w-4"})}),e.jsx(Oa,{title:"",value:`${l.expression_vibe.rejected_expression_count} `,description:J3(l.expression_vibe.rejected_expression_count),icon:e.jsx(el,{className:"h-4 w-4"})})]})]})]}),l.expression_vibe.action_types.length>0&&e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:l.expression_vibe.action_types.map(b=>e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2",children:[e.jsx("span",{className:"font-medium text-primary",children:b.action}),e.jsxs(ke,{variant:"secondary",children:[b.count," "]})]},b.action))})})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(Q1,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(Ce,{className:"col-span-1 md:col-span-2",children:[e.jsxs(De,{children:[e.jsx(Ue,{children:'""'}),e.jsxs(fs,{children:[" ",l.achievements.new_jargon_count," "]})]}),e.jsx(Ae,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:l.achievements.sample_jargons.map(b=>e.jsxs("div",{className:"group relative rounded-lg border bg-card p-3 shadow-sm transition-all hover:shadow-md",children:[e.jsx("div",{className:"font-bold text-primary",children:b.content}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2 max-w-[200px]",children:b.meaning||""})]},b.content))})})]}),e.jsx(Ce,{className:"flex flex-col justify-center items-center bg-primary text-primary-foreground",children:e.jsxs(Ae,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Ba,{className:"h-12 w-12 mb-4 opacity-80"}),e.jsx("div",{className:"text-4xl font-bold mb-2",children:l.achievements.total_messages.toLocaleString()}),e.jsx("div",{className:"text-sm opacity-80",children:""}),e.jsxs("div",{className:"mt-4 text-xs opacity-60",children:[" ",l.achievements.total_replies.toLocaleString()," "]})]})})]})]}),e.jsxs("footer",{className:"mt-12 text-center text-muted-foreground",children:[e.jsx("p",{children:"MaiBot 2025 Annual Report"}),e.jsx("p",{className:"text-sm",children:"Generated with  by MaiBot Team"})]})]})})}):null}function Oa({title:a,value:l,description:r,icon:c}){return e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Ue,{className:"text-sm font-medium",children:a}),e.jsx("div",{className:"text-muted-foreground",children:c})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function t5(){return e.jsxs("div",{className:"container mx-auto space-y-8 p-8",children:[e.jsx(As,{className:"h-64 w-full rounded-3xl"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((a,l)=>e.jsx(As,{className:"h-32 w-full"},l))}),e.jsx(As,{className:"h-96 w-full"})]})}var gd="DropdownMenu",[a5]=td(gd,[Mj]),ha=Mj(),[l5,qN]=a5(gd),VN=a=>{const{__scopeDropdownMenu:l,children:r,dir:c,open:d,defaultOpen:m,onOpenChange:h,modal:f=!0}=a,p=ha(l),g=u.useRef(null),[N,j]=sd({prop:d,defaultProp:m??!1,onChange:h,caller:gd});return e.jsx(l5,{scope:l,triggerId:Qm(),triggerRef:g,contentId:Qm(),open:N,onOpenChange:j,onOpenToggle:u.useCallback(()=>j(y=>!y),[j]),modal:f,children:e.jsx(Iw,{...p,open:N,onOpenChange:j,dir:c,modal:f,children:r})})};VN.displayName=gd;var GN="DropdownMenuTrigger",KN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,disabled:c=!1,...d}=a,m=qN(GN,r),h=ha(r);return e.jsx(Pw,{asChild:!0,...h,children:e.jsx(sr.button,{type:"button",id:m.triggerId,"aria-haspopup":"menu","aria-expanded":m.open,"aria-controls":m.open?m.contentId:void 0,"data-state":m.open?"open":"closed","data-disabled":c?"":void 0,disabled:c,...d,ref:f1(l,m.triggerRef),onPointerDown:Nn(a.onPointerDown,f=>{!c&&f.button===0&&f.ctrlKey===!1&&(m.onOpenToggle(),m.open||f.preventDefault())}),onKeyDown:Nn(a.onKeyDown,f=>{c||(["Enter"," "].includes(f.key)&&m.onOpenToggle(),f.key==="ArrowDown"&&m.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});KN.displayName=GN;var n5="DropdownMenuPortal",QN=a=>{const{__scopeDropdownMenu:l,...r}=a,c=ha(l);return e.jsx(zw,{...c,...r})};QN.displayName=n5;var YN="DropdownMenuContent",JN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=qN(YN,r),m=ha(r),h=u.useRef(!1);return e.jsx(Rw,{id:d.contentId,"aria-labelledby":d.triggerId,...m,...c,ref:l,onCloseAutoFocus:Nn(a.onCloseAutoFocus,f=>{h.current||d.triggerRef.current?.focus(),h.current=!1,f.preventDefault()}),onInteractOutside:Nn(a.onInteractOutside,f=>{const p=f.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,N=p.button===2||g;(!d.modal||N)&&(h.current=!0)}),style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});JN.displayName=YN;var r5="DropdownMenuGroup",i5=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Fw,{...d,...c,ref:l})});i5.displayName=r5;var c5="DropdownMenuLabel",XN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx($w,{...d,...c,ref:l})});XN.displayName=c5;var o5="DropdownMenuItem",ZN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Dw,{...d,...c,ref:l})});ZN.displayName=o5;var d5="DropdownMenuCheckboxItem",WN=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Ow,{...d,...c,ref:l})});WN.displayName=d5;var u5="DropdownMenuRadioGroup",m5=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Hw,{...d,...c,ref:l})});m5.displayName=u5;var x5="DropdownMenuRadioItem",eb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Uw,{...d,...c,ref:l})});eb.displayName=x5;var h5="DropdownMenuItemIndicator",sb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Lw,{...d,...c,ref:l})});sb.displayName=h5;var f5="DropdownMenuSeparator",tb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Bw,{...d,...c,ref:l})});tb.displayName=f5;var p5="DropdownMenuArrow",g5=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(qw,{...d,...c,ref:l})});g5.displayName=p5;var j5="DropdownMenuSubTrigger",ab=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Mw,{...d,...c,ref:l})});ab.displayName=j5;var v5="DropdownMenuSubContent",lb=u.forwardRef((a,l)=>{const{__scopeDropdownMenu:r,...c}=a,d=ha(r);return e.jsx(Aw,{...d,...c,ref:l,style:{...a.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});lb.displayName=v5;var N5=VN,b5=KN,y5=QN,nb=JN,rb=XN,ib=ZN,cb=WN,ob=eb,db=sb,ub=tb,mb=ab,xb=lb;const w5=N5,_5=b5,S5=u.forwardRef(({className:a,inset:l,children:r,...c},d)=>e.jsxs(mb,{ref:d,className:F("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",a),...c,children:[r,e.jsx(ra,{className:"ml-auto h-4 w-4"})]}));S5.displayName=mb.displayName;const k5=u.forwardRef(({className:a,...l},r)=>e.jsx(xb,{ref:r,className:F("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l}));k5.displayName=xb.displayName;const hb=u.forwardRef(({className:a,sideOffset:l=4,...r},c)=>e.jsx(y5,{children:e.jsx(nb,{ref:c,sideOffset:l,className:F("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}));hb.displayName=nb.displayName;const fb=u.forwardRef(({className:a,inset:l,...r},c)=>e.jsx(ib,{ref:c,className:F("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",a),...r}));fb.displayName=ib.displayName;const C5=u.forwardRef(({className:a,children:l,checked:r,...c},d)=>e.jsxs(cb,{ref:d,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(db,{children:e.jsx(Lt,{className:"h-4 w-4"})})}),l]}));C5.displayName=cb.displayName;const T5=u.forwardRef(({className:a,children:l,...r},c)=>e.jsxs(ob,{ref:c,className:F("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(db,{children:e.jsx(Ho,{className:"h-2 w-2 fill-current"})})}),l]}));T5.displayName=ob.displayName;const E5=u.forwardRef(({className:a,inset:l,...r},c)=>e.jsx(rb,{ref:c,className:F("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",a),...r}));E5.displayName=rb.displayName;const M5=u.forwardRef(({className:a,...l},r)=>e.jsx(ub,{ref:r,className:F("-mx-1 my-1 h-px bg-muted",a),...l}));M5.displayName=ub.displayName;const Km=[{value:"created_at",label:"",icon:ia},{value:"downloads",label:"",icon:na},{value:"likes",label:"",icon:Zr}];function A5(){const a=xa(),[l,r]=u.useState([]),[c,d]=u.useState(!0),[m,h]=u.useState(""),[f,p]=u.useState("downloads"),[g,N]=u.useState(1),[j,y]=u.useState(1),[b,w]=u.useState(0),[A,M]=u.useState(new Set),[S,P]=u.useState(new Set),E=tN(),C=u.useCallback(async()=>{d(!0);try{const L=await n4({status:"approved",page:g,page_size:12,search:m||void 0,sort_by:f,sort_order:"desc"});r(L.packs),y(L.total_pages),w(L.total);const me=new Set;for(const Ne of L.packs)await sN(Ne.id,E)&&me.add(Ne.id);M(me)}catch(L){console.error(" Pack :",L),aa({title:" Pack ",variant:"destructive"})}finally{d(!1)}},[g,m,f,E]);u.useEffect(()=>{C()},[C]);const R=L=>{L.preventDefault(),N(1),C()},H=async L=>{if(!S.has(L)){P(me=>new Set(me).add(L));try{const me=await eN(L,E);M(Ne=>{const je=new Set(Ne);return me.liked?je.add(L):je.delete(L),je}),r(Ne=>Ne.map(je=>je.id===L?{...je,likes:me.likes}:je))}catch(me){console.error(":",me),aa({title:"",variant:"destructive"})}finally{P(me=>{const Ne=new Set(me);return Ne.delete(L),Ne})}}},O=L=>{a({to:"/config/pack-market/$packId",params:{packId:L}})},X=Km.find(L=>L.value===f)||Km[0];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ua,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" MaiBot"})]}),e.jsxs(_,{variant:"outline",onClick:C,disabled:c,className:"gap-2",children:[e.jsx(ut,{className:`h-4 w-4 ${c?"animate-spin":""}`}),""]})]})}),e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("form",{onSubmit:R,className:"flex-1 min-w-[200px] max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"...",value:m,onChange:L=>h(L.target.value),className:"pl-10"})]})}),e.jsxs(w5,{children:[e.jsx(_5,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"min-w-[140px] gap-2",children:[e.jsx(Y1,{className:"w-4 h-4"}),X.label,e.jsx($a,{className:"w-4 h-4 ml-auto"})]})}),e.jsx(hb,{align:"end",children:Km.map(L=>e.jsxs(fb,{onClick:()=>{p(L.value),N(1)},children:[e.jsx(L.icon,{className:"w-4 h-4 mr-2"}),L.label]},L.value))})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",e.jsx("span",{className:"font-medium text-foreground",children:b})," "]}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((L,me)=>e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(As,{className:"h-6 w-3/4"}),e.jsx(As,{className:"h-4 w-full mt-2"})]}),e.jsx(Ae,{children:e.jsx(As,{className:"h-20 w-full"})}),e.jsx(id,{children:e.jsx(As,{className:"h-9 w-full"})})]},me))}):l.length===0?e.jsx(Ce,{className:"py-12",children:e.jsxs(Ae,{className:"text-center text-muted-foreground",children:[e.jsx(ua,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:""}),e.jsx("p",{className:"mt-1",children:""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(L=>e.jsx(z5,{pack:L,liked:A.has(L.id),liking:S.has(L.id),onLike:()=>H(L.id),onView:()=>O(L.id)},L.id))}),j>1&&e.jsx(ux,{children:e.jsxs(mx,{children:[e.jsx(Yn,{children:e.jsx(Ov,{onClick:()=>N(L=>Math.max(1,L-1)),className:g===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:j},(L,me)=>me+1).filter(L=>L===1||L===j||Math.abs(L-g)<=1).map((L,me,Ne)=>{const je=me>0&&L-Ne[me-1]>1;return e.jsxs(Yn,{children:[je&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(pc,{onClick:()=>N(L),isActive:L===g,className:"cursor-pointer",children:L})]},L)}),e.jsx(Yn,{children:e.jsx(Lv,{onClick:()=>N(L=>Math.min(j,L+1)),className:g===j?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})]})}function z5({pack:a,liked:l,liking:r,onLike:c,onView:d}){const m=h=>new Date(h).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(Ce,{className:"flex flex-col hover:shadow-md transition-shadow",children:[e.jsxs(De,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(Ue,{className:"text-lg line-clamp-1",children:a.name}),e.jsxs(ke,{variant:"secondary",className:"text-xs",children:["v",a.version]})]}),e.jsx(fs,{className:"line-clamp-2 min-h-[40px]",children:a.description})]}),e.jsxs(Ae,{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($l,{className:"w-3.5 h-3.5"}),a.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ia,{className:"w-3.5 h-3.5"}),m(a.created_at)]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Bl,{className:"w-3.5 h-3.5"}),a.provider_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Xn,{className:"w-3.5 h-3.5"}),a.model_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Zn,{className:"w-3.5 h-3.5"}),a.task_count]})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,3).map(h=>e.jsxs(ke,{variant:"outline",className:"text-xs",children:[e.jsx(rd,{className:"w-2.5 h-2.5 mr-1"}),h]},h)),a.tags.length>3&&e.jsxs(ke,{variant:"outline",className:"text-xs",children:["+",a.tags.length-3]})]})]}),e.jsx(id,{className:"pt-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-4 h-4"}),a.downloads]}),e.jsxs("button",{onClick:h=>{h.stopPropagation(),c()},disabled:r,className:`flex items-center gap-1 transition-colors ${l?"text-red-500":"hover:text-red-500"} ${r?"opacity-50":""}`,children:[e.jsx(Zr,{className:`w-4 h-4 ${l?"fill-current":""}`}),a.likes]})]}),e.jsx(_,{size:"sm",onClick:d,children:""})]})})]})}var il="Accordion",R5=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ax,D5,O5]=p1(il),[jd]=td(il,[O5,Aj]),zx=Aj(),pb=Hs.forwardRef((a,l)=>{const{type:r,...c}=a,d=c,m=c;return e.jsx(Ax.Provider,{scope:a.__scopeAccordion,children:r==="multiple"?e.jsx(B5,{...m,ref:l}):e.jsx($5,{...d,ref:l})})});pb.displayName=il;var[gb,L5]=jd(il),[jb,U5]=jd(il,{collapsible:!1}),$5=Hs.forwardRef((a,l)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},collapsible:m=!1,...h}=a,[f,p]=sd({prop:r,defaultProp:c??"",onChange:d,caller:il});return e.jsx(gb,{scope:a.__scopeAccordion,value:Hs.useMemo(()=>f?[f]:[],[f]),onItemOpen:p,onItemClose:Hs.useCallback(()=>m&&p(""),[m,p]),children:e.jsx(jb,{scope:a.__scopeAccordion,collapsible:m,children:e.jsx(vb,{...h,ref:l})})})}),B5=Hs.forwardRef((a,l)=>{const{value:r,defaultValue:c,onValueChange:d=()=>{},...m}=a,[h,f]=sd({prop:r,defaultProp:c??[],onChange:d,caller:il}),p=Hs.useCallback(N=>f((j=[])=>[...j,N]),[f]),g=Hs.useCallback(N=>f((j=[])=>j.filter(y=>y!==N)),[f]);return e.jsx(gb,{scope:a.__scopeAccordion,value:h,onItemOpen:p,onItemClose:g,children:e.jsx(jb,{scope:a.__scopeAccordion,collapsible:!0,children:e.jsx(vb,{...m,ref:l})})})}),[I5,vd]=jd(il),vb=Hs.forwardRef((a,l)=>{const{__scopeAccordion:r,disabled:c,dir:d,orientation:m="vertical",...h}=a,f=Hs.useRef(null),p=ad(f,l),g=D5(r),j=Kj(d)==="ltr",y=Nn(a.onKeyDown,b=>{if(!R5.includes(b.key))return;const w=b.target,A=g().filter(X=>!X.ref.current?.disabled),M=A.findIndex(X=>X.ref.current===w),S=A.length;if(M===-1)return;b.preventDefault();let P=M;const E=0,C=S-1,R=()=>{P=M+1,P>C&&(P=E)},H=()=>{P=M-1,P<E&&(P=C)};switch(b.key){case"Home":P=E;break;case"End":P=C;break;case"ArrowRight":m==="horizontal"&&(j?R():H());break;case"ArrowDown":m==="vertical"&&R();break;case"ArrowLeft":m==="horizontal"&&(j?H():R());break;case"ArrowUp":m==="vertical"&&H();break}const O=P%S;A[O].ref.current?.focus()});return e.jsx(I5,{scope:r,disabled:c,direction:d,orientation:m,children:e.jsx(Ax.Slot,{scope:r,children:e.jsx(sr.div,{...h,"data-orientation":m,ref:p,onKeyDown:c?void 0:y})})})}),ed="AccordionItem",[P5,Rx]=jd(ed),Nb=Hs.forwardRef((a,l)=>{const{__scopeAccordion:r,value:c,...d}=a,m=vd(ed,r),h=L5(ed,r),f=zx(r),p=Qm(),g=c&&h.value.includes(c)||!1,N=m.disabled||a.disabled;return e.jsx(P5,{scope:r,open:g,disabled:N,triggerId:p,children:e.jsx(Sj,{"data-orientation":m.orientation,"data-state":kb(g),...f,...d,ref:l,disabled:N,open:g,onOpenChange:j=>{j?h.onItemOpen(c):h.onItemClose(c)}})})});Nb.displayName=ed;var bb="AccordionHeader",yb=Hs.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(il,r),m=Rx(bb,r);return e.jsx(sr.h3,{"data-orientation":d.orientation,"data-state":kb(m.open),"data-disabled":m.disabled?"":void 0,...c,ref:l})});yb.displayName=bb;var tx="AccordionTrigger",wb=Hs.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(il,r),m=Rx(tx,r),h=U5(tx,r),f=zx(r);return e.jsx(Ax.ItemSlot,{scope:r,children:e.jsx(Vw,{"aria-disabled":m.open&&!h.collapsible||void 0,"data-orientation":d.orientation,id:m.triggerId,...f,...c,ref:l})})});wb.displayName=tx;var _b="AccordionContent",Sb=Hs.forwardRef((a,l)=>{const{__scopeAccordion:r,...c}=a,d=vd(il,r),m=Rx(_b,r),h=zx(r);return e.jsx(Gw,{role:"region","aria-labelledby":m.triggerId,"data-orientation":d.orientation,...h,...c,ref:l,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...a.style}})});Sb.displayName=_b;function kb(a){return a?"open":"closed"}var F5=pb,H5=Nb,q5=yb,Cb=wb,Tb=Sb;const V5=F5,Eb=u.forwardRef(({className:a,...l},r)=>e.jsx(H5,{ref:r,className:F("border-b",a),...l}));Eb.displayName="AccordionItem";const Mb=u.forwardRef(({className:a,children:l,...r},c)=>e.jsx(q5,{className:"flex",children:e.jsxs(Cb,{ref:c,className:F("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...r,children:[l,e.jsx($a,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Mb.displayName=Cb.displayName;const Ab=u.forwardRef(({className:a,children:l,...r},c)=>e.jsx(Tb,{ref:c,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:F("pb-4 pt-0",a),children:l})}));Ab.displayName=Tb.displayName;const G5={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""};function K5(){const{packId:a}=Lb.useParams(),l=xa(),[r,c]=u.useState(null),[d,m]=u.useState(!0),[h,f]=u.useState(!1),[p,g]=u.useState(!1),[N,j]=u.useState(!1),[y,b]=u.useState(1),[w,A]=u.useState(null),[M,S]=u.useState(!1),[P,E]=u.useState(!1),[C,R]=u.useState({apply_providers:!0,apply_models:!0,apply_task_config:!0,task_mode:"append",selected_providers:void 0,selected_models:void 0,selected_tasks:void 0}),[H,O]=u.useState({}),[X,L]=u.useState({}),me=tN(),Ne=u.useCallback(async()=>{if(a){m(!0);try{const D=await r4(a);c(D);const K=await sN(a,me);f(K)}catch(D){console.error(" Pack :",D),aa({title:"",variant:"destructive"})}finally{m(!1)}}},[a,me]);u.useEffect(()=>{Ne()},[Ne]);const je=async()=>{if(!(!a||p)){g(!0);try{const D=await eN(a,me);f(D.liked),r&&c({...r,likes:D.likes})}catch(D){console.error(":",D),aa({title:"",variant:"destructive"})}finally{g(!1)}}},ce=async()=>{if(r){j(!0),b(1),S(!0);try{const D=await o4(r);A(D);const K={};for(const ue of D.existing_providers)K[ue.pack_provider.name]=ue.local_providers[0].name;O(K);const B={};for(const ue of D.new_providers)B[ue.name]="";L(B)}catch(D){console.error(":",D),aa({title:"",variant:"destructive"}),j(!1)}finally{S(!1)}}},ge=async()=>{if(r){if(C.apply_providers&&w){for(const D of w.new_providers)if(!X[D.name]){aa({title:` "${D.name}"  API Key`,variant:"destructive"});return}}E(!0);try{await d4(r,C,H,X),await c4(r.id,me),c({...r,downloads:r.downloads+1}),aa({title:""}),j(!1)}catch(D){console.error(" Pack :",D),aa({title:D instanceof Error?D.message:"",variant:"destructive"})}finally{E(!1)}}},pe=D=>new Date(D).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"});return d?e.jsx(Y5,{}):r?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>l({to:"/config/pack-market"}),className:"gap-2",children:[e.jsx(Ua,{className:"w-4 h-4"}),""]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ua,{className:"w-10 h-10 text-primary mt-1"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[r.name,e.jsxs(ke,{variant:"secondary",children:["v",r.version]})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:r.description})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($l,{className:"w-4 h-4"}),r.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ia,{className:"w-4 h-4"}),pe(r.created_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-4 h-4"}),r.downloads," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Zr,{className:`w-4 h-4 ${h?"fill-red-500 text-red-500":""}`}),r.likes," "]})]}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map(D=>e.jsxs(ke,{variant:"outline",children:[e.jsx(rd,{className:"w-3 h-3 mr-1"}),D]},D))})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsxs(_,{size:"lg",onClick:ce,children:[e.jsx(na,{className:"w-4 h-4 mr-2"}),""]}),e.jsxs(_,{variant:"outline",onClick:je,disabled:p,className:h?"text-red-500 border-red-200":"",children:[e.jsx(Zr,{className:`w-4 h-4 mr-2 ${h?"fill-current":""}`}),h?"":""]})]})]}),e.jsx(la,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(Ce,{children:e.jsxs(Ae,{className:"flex items-center gap-3 py-4",children:[e.jsx(Bl,{className:"w-8 h-8 text-blue-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.providers.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"API "})]})]})}),e.jsx(Ce,{children:e.jsxs(Ae,{className:"flex items-center gap-3 py-4",children:[e.jsx(Xn,{className:"w-8 h-8 text-green-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.models.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})}),e.jsx(Ce,{children:e.jsxs(Ae,{className:"flex items-center gap-3 py-4",children:[e.jsx(Zn,{className:"w-8 h-8 text-purple-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(r.task_config).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})})]}),e.jsxs(Yt,{defaultValue:"providers",className:"space-y-4",children:[e.jsxs(Vt,{className:"w-full sm:w-auto grid grid-cols-3 sm:flex",children:[e.jsxs(Ye,{value:"providers",className:"gap-1 sm:gap-2",children:[e.jsx(Bl,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.providers.length,")"]})]}),e.jsxs(Ye,{value:"models",className:"gap-1 sm:gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",r.models.length,")"]})]}),e.jsxs(Ye,{value:"tasks",className:"gap-1 sm:gap-2",children:[e.jsx(Zn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""}),e.jsxs("span",{className:"hidden sm:inline",children:["(",Object.keys(r.task_config).length,")"]})]})]}),e.jsx(Ms,{value:"providers",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:"API "}),e.jsx(fs,{children:" API  API Key"})]}),e.jsx(Ae,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{children:""}),e.jsx(ls,{children:"Base URL"}),e.jsx(ls,{children:""})]})}),e.jsx(Fl,{children:r.providers.map(D=>e.jsxs(bt,{children:[e.jsx(Je,{className:"font-medium whitespace-nowrap",children:D.name}),e.jsx(Je,{className:"text-muted-foreground font-mono text-sm max-w-[200px] truncate",children:D.base_url}),e.jsx(Je,{children:e.jsx(ke,{variant:"outline",children:D.client_type})})]},D.name))})]})})})]})}),e.jsx(Ms,{value:"models",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Il,{children:[e.jsx(Pl,{children:e.jsxs(bt,{children:[e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{children:""}),e.jsx(ls,{className:"text-right",children:" (/)"})]})}),e.jsx(Fl,{children:r.models.map(D=>e.jsxs(bt,{children:[e.jsx(Je,{className:"font-medium whitespace-nowrap",children:D.name}),e.jsx(Je,{className:"text-muted-foreground font-mono text-sm max-w-[150px] truncate",children:D.model_identifier}),e.jsx(Je,{className:"whitespace-nowrap",children:D.api_provider}),e.jsxs(Je,{className:"text-right text-muted-foreground whitespace-nowrap",children:["",D.price_in," / ",D.price_out]})]},D.name))})]})})})]})}),e.jsx(Ms,{value:"tasks",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Ue,{children:""}),e.jsx(fs,{children:""})]}),e.jsx(Ae,{children:e.jsx(V5,{type:"multiple",className:"w-full",children:Object.entries(r.task_config).map(([D,K])=>e.jsxs(Eb,{value:D,children:[e.jsx(Mb,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bn,{className:"w-4 h-4"}),G5[D]||D,e.jsxs(ke,{variant:"secondary",className:"ml-2",children:[K.model_list.length," "]})]})}),e.jsx(Ab,{children:e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:K.model_list.map(B=>e.jsx(ke,{variant:"outline",children:B},B))}),K.temperature!==void 0&&e.jsxs("div",{className:"text-sm",children:["Temperature: ",e.jsx("span",{className:"font-mono",children:K.temperature})]}),K.max_tokens!==void 0&&e.jsxs("div",{className:"text-sm",children:["Max Tokens: ",e.jsx("span",{className:"font-mono",children:K.max_tokens})]})]})})]},D))})})]})})]}),e.jsx(Q5,{open:N,onOpenChange:j,pack:r,step:y,setStep:b,conflicts:w,detectingConflicts:M,applying:P,options:C,setOptions:R,_providerMapping:H,_setProviderMapping:O,newProviderApiKeys:X,setNewProviderApiKeys:L,onApply:ge})]})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ua,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-xl font-semibold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""}),e.jsxs(_,{className:"mt-4",onClick:()=>l({to:"/config/pack-market"}),children:[e.jsx(Ua,{className:"w-4 h-4 mr-2"}),""]})]})}function Q5({open:a,onOpenChange:l,pack:r,step:c,setStep:d,conflicts:m,detectingConflicts:h,applying:f,options:p,setOptions:g,_providerMapping:N,_setProviderMapping:j,newProviderApiKeys:y,setNewProviderApiKeys:b,onApply:w}){return e.jsx(Js,{open:a,onOpenChange:l,children:e.jsxs(qs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Vs,{children:[e.jsxs(Gs,{className:"flex items-center gap-2",children:[e.jsx(ua,{className:"w-5 h-5"}),""]}),e.jsxs(nt,{children:[" ",c," / ",3,"",c===1&&"",c===2&&"",c===3&&""]})]}),h?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Fs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"apply_providers",checked:p.apply_providers,onCheckedChange:M=>g({...p,apply_providers:M})}),e.jsxs(T,{htmlFor:"apply_providers",className:"flex items-center gap-2",children:[e.jsx(Bl,{className:"w-4 h-4"})," (",r.providers.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"apply_models",checked:p.apply_models,onCheckedChange:M=>g({...p,apply_models:M})}),e.jsxs(T,{htmlFor:"apply_models",className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"})," (",r.models.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(lt,{id:"apply_task_config",checked:p.apply_task_config,onCheckedChange:M=>g({...p,apply_task_config:M})}),e.jsxs(T,{htmlFor:"apply_task_config",className:"flex items-center gap-2",children:[e.jsx(Zn,{className:"w-4 h-4"})," (",Object.keys(r.task_config).length," )"]})]})]}),p.apply_task_config&&e.jsxs("div",{className:"pl-6 space-y-2 border-l-2 border-muted",children:[e.jsx(T,{className:"text-sm font-medium",children:""}),e.jsxs(Tx,{value:p.task_mode,onValueChange:M=>g({...p,task_mode:M}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"append",id:"mode_append"}),e.jsx(T,{htmlFor:"mode_append",className:"font-normal",children:" - "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xo,{value:"replace",id:"mode_replace"}),e.jsx(T,{htmlFor:"mode_replace",className:"font-normal",children:" - "})]})]})]})]}),c===2&&m&&e.jsxs("div",{className:"space-y-4",children:[p.apply_providers&&m.existing_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:" URL "})]}),e.jsx("div",{className:"space-y-2",children:m.existing_providers.map(({pack_provider:M,local_providers:S})=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"font-medium flex-shrink-0",children:M.name}),e.jsx(ra,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),S.length===1?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:S[0].name}),e.jsx(ke,{variant:"outline",className:"ml-auto",children:"URL "})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{value:N[M.name]||S[0].name,onValueChange:P=>j({...N,[M.name]:P}),children:[e.jsx(Be,{className:"w-[200px]",children:e.jsx(Fe,{})}),e.jsx(Ie,{children:S.map(P=>e.jsx(ee,{value:P.name,children:P.name},P.name))})]}),e.jsxs(ke,{variant:"outline",className:"ml-auto",children:[S.length," "]})]})]},M.name))})]}),p.apply_providers&&m.new_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(pt,{variant:"destructive",children:[e.jsx(qt,{className:"h-4 w-4"}),e.jsx(Qn,{children:" API Key"}),e.jsx(gt,{children:" API Key"})]}),e.jsx("div",{className:"space-y-4",children:m.new_providers.map(M=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rx,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"font-medium",children:M.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",M.base_url,")"]})]}),e.jsx(ne,{type:"password",placeholder:` ${M.name}  API Key`,value:y[M.name]||"",onChange:S=>b({...y,[M.name]:S.target.value})})]},M.name))})]}),(!p.apply_providers||m.existing_providers.length===0&&m.new_providers.length===0)&&e.jsxs(pt,{children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:""})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx(Qn,{children:""}),e.jsx(gt,{children:""})]}),e.jsxs("div",{className:"space-y-2",children:[p.apply_providers&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500"}),e.jsx(Bl,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.providers.length," "]})]}),p.apply_models&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500"}),e.jsx(Xn,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",r.models.length," "]})]}),p.apply_task_config&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Lt,{className:"w-4 h-4 text-green-500"}),e.jsx(Zn,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.task_mode==="append"?"":""," ",Object.keys(r.task_config).length," "]})]})]}),m&&m.new_providers.length>0&&e.jsxs(pt,{variant:"destructive",children:[e.jsx(qt,{className:"h-4 w-4"}),e.jsxs(gt,{children:[" ",m.new_providers.length,"  API Key"]})]})]})]}),e.jsxs(xt,{className:"flex justify-between",children:[e.jsx("div",{children:c>1&&!h&&e.jsx(_,{variant:"outline",onClick:()=>d(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>l(!1),disabled:f,children:""}),c<3?e.jsx(_,{onClick:()=>d(c+1),disabled:h,children:""}):e.jsxs(_,{onClick:w,disabled:f,children:[f&&e.jsx(Fs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})})}function Y5(){return e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(As,{className:"h-9 w-24"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(As,{className:"w-10 h-10"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(As,{className:"h-8 w-2/3"}),e.jsx(As,{className:"h-4 w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(As,{className:"h-4 w-24"}),e.jsx(As,{className:"h-4 w-32"}),e.jsx(As,{className:"h-4 w-28"}),e.jsx(As,{className:"h-4 w-20"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(As,{className:"h-6 w-20"}),e.jsx(As,{className:"h-6 w-24"}),e.jsx(As,{className:"h-6 w-16"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsx(As,{className:"h-10 w-full"}),e.jsx(As,{className:"h-10 w-full"})]})]}),e.jsx(As,{className:"h-px w-full"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(As,{className:"h-24"}),e.jsx(As,{className:"h-24"}),e.jsx(As,{className:"h-24"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(As,{className:"h-10 w-32"}),e.jsx(As,{className:"h-10 w-32"}),e.jsx(As,{className:"h-10 w-32"})]}),e.jsx(As,{className:"h-96 w-full"})]})]})})})}function J5(){const a=xa(),[l,r]=u.useState(!0);return u.useEffect(()=>{let c=!1;return(async()=>{try{const m=await cc();!c&&!m&&a({to:"/auth"})}catch{c||a({to:"/auth"})}finally{c||r(!1)}})(),()=>{c=!0}},[a]),{checking:l}}async function X5(){return await cc()}const Z5=ei("pointer-events-none inline-flex select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono font-medium opacity-100",{variants:{size:{sm:"h-5 text-[10px]",default:"h-6 text-xs",lg:"h-7 text-sm"}},defaultVariants:{size:"default"}}),zb=u.forwardRef(({className:a,size:l,abbrTitle:r,children:c,...d},m)=>e.jsx("kbd",{className:F(Z5({size:l,className:a})),ref:m,...d,children:r?e.jsx("abbr",{title:r,children:c}):c}));zb.displayName="Kbd";const W5=[{icon:nd,title:"",description:"",path:"/",category:""},{icon:La,title:"",description:"",path:"/config/bot",category:""},{icon:Bl,title:"",description:"",path:"/config/modelProvider",category:""},{icon:hv,title:"",description:"",path:"/config/model",category:""},{icon:ld,title:"",description:"",path:"/resource/emoji",category:""},{icon:Ba,title:"",description:"",path:"/resource/expression",category:""},{icon:fv,title:"",description:"",path:"/resource/person",category:""},{icon:Xr,title:"",description:"",path:"/resource/jargon",category:""},{icon:J1,title:"",description:"",path:"/statistics",category:""},{icon:ua,title:"",description:"",path:"/plugins",category:""},{icon:ix,title:"",description:"",path:"/logs",category:""},{icon:bn,title:"",description:"",path:"/settings",category:""}];function eT({open:a,onOpenChange:l}){const[r,c]=u.useState(""),[d,m]=u.useState(0),h=xa(),f=W5.filter(N=>N.title.toLowerCase().includes(r.toLowerCase())||N.description.toLowerCase().includes(r.toLowerCase())||N.category.toLowerCase().includes(r.toLowerCase())),p=u.useCallback(N=>{h({to:N}),l(!1),c(""),m(0)},[h,l]),g=u.useCallback(N=>{N.key==="ArrowDown"?(N.preventDefault(),m(j=>(j+1)%f.length)):N.key==="ArrowUp"?(N.preventDefault(),m(j=>(j-1+f.length)%f.length)):N.key==="Enter"&&f[d]&&(N.preventDefault(),p(f[d].path))},[f,d,p]);return e.jsx(Js,{open:a,onOpenChange:l,children:e.jsxs(qs,{className:"max-w-2xl p-0 gap-0",children:[e.jsxs(Vs,{className:"px-4 pt-4 pb-0",children:[e.jsx(Gs,{className:"sr-only",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),e.jsx(ne,{value:r,onChange:N=>{c(N.target.value),m(0)},onKeyDown:g,placeholder:"...",className:"h-12 pl-11 text-base border-0 focus-visible:ring-0 shadow-none",autoFocus:!0})]})]}),e.jsx("div",{className:"border-t",children:e.jsx(ss,{className:"h-[400px]",children:f.length>0?e.jsx("div",{className:"p-2",children:f.map((N,j)=>{const y=N.icon;return e.jsxs("button",{onClick:()=>p(N.path),onMouseEnter:()=>m(j),className:F("w-full flex items-center gap-3 px-3 py-2.5 rounded-md text-left transition-colors",j===d?"bg-accent text-accent-foreground":"hover:bg-accent/50"),children:[e.jsx(y,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:N.title}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:N.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1 bg-muted rounded",children:N.category})]},N.path)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Ut,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?"":""})]})})}),e.jsx("div",{className:"border-t px-4 py-3 flex items-center justify-between text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Enter"}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Esc"}),""]})]})})]})})}function sT(){const a=window.location.protocol==="http:",l=window.location.hostname.toLowerCase(),r=l==="localhost"||l==="127.0.0.1"||l==="::1",c=sessionStorage.getItem("http-warning-dismissed")==="true",[d,m]=u.useState(a&&!r&&!c),[h,f]=u.useState(!1),p=()=>{f(!0),m(!1),sessionStorage.setItem("http-warning-dismissed","true")};return!d||h?null:e.jsx("div",{className:"relative bg-amber-500/10 border-b border-amber-500/20 backdrop-blur-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(qt,{className:"h-5 w-5 text-amber-600 dark:text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-semibold",children:""})," ",e.jsx("strong",{children:"HTTP"}),"  MaiBot WebUI"]}),e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200 mt-1",children:" Token HTTPS "})]})]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:p,className:"h-8 w-8 text-amber-700 hover:text-amber-900 dark:text-amber-400 dark:hover:text-amber-200 flex-shrink-0","aria-label":"",children:e.jsx(_a,{className:"h-4 w-4"})})]})})})}function tT(){const[a,l]=u.useState(0),[r,c]=u.useState(!1),d=u.useRef(null);u.useEffect(()=>{const g=N=>{const j=N.target;if(j.scrollHeight>j.clientHeight+100){d.current=j;const y=j.scrollTop,b=j.scrollHeight-j.clientHeight,w=b>0?y/b*100:0;l(w),c(y>300)}};return window.addEventListener("scroll",g,{capture:!0,passive:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})},[]);const m=()=>{d.current?.scrollTo({top:0,behavior:"smooth"})},h=18,f=2*Math.PI*h,p=f-a/100*f;return e.jsx("div",{className:F("fixed bottom-24 right-8 z-50 transition-all duration-500 ease-in-out transform",r?"translate-x-0 opacity-100":"translate-x-32 opacity-0 pointer-events-none"),children:e.jsxs(_,{variant:"outline",size:"icon",className:F("relative h-12 w-12 rounded-full shadow-xl","bg-background/80 backdrop-blur-md border-border/50","hover:bg-accent hover:scale-110 hover:shadow-2xl hover:border-primary/50","transition-all duration-300","group"),onClick:m,"aria-label":"",children:[e.jsxs("svg",{className:"absolute inset-0 h-full w-full -rotate-90 transform p-1",viewBox:"0 0 44 44",children:[e.jsx("circle",{className:"text-muted-foreground/10",strokeWidth:"3",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"}),e.jsx("circle",{className:"text-primary transition-all duration-100 ease-out",strokeWidth:"3",strokeDasharray:f,strokeDashoffset:p,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"})]}),e.jsx(X1,{className:"h-5 w-5 text-primary transition-transform duration-300 group-hover:-translate-y-1 group-hover:scale-110",strokeWidth:2.5}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})})}const aT=j1,lT=v1,nT=N1,Rb=u.forwardRef(({className:a,sideOffset:l=4,...r},c)=>e.jsx(g1,{children:e.jsx(Qj,{ref:c,sideOffset:l,className:F("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...r})}));Rb.displayName=Qj.displayName;function rT({children:a}){const{checking:l}=J5(),[r,c]=u.useState(!0),[d,m]=u.useState(!1),[h,f]=u.useState(!1),[p,g]=u.useState(!1),{theme:N,setTheme:j}=fx(),y=ew();if(u.useEffect(()=>{if(r)g(!1);else{const S=setTimeout(()=>{g(!0)},350);return()=>clearTimeout(S)}},[r]),u.useEffect(()=>{const S=P=>{(P.metaKey||P.ctrlKey)&&P.key==="k"&&(P.preventDefault(),f(!0))};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[]),l)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-background",children:e.jsx("div",{className:"text-muted-foreground",children:"..."})});const b=[{title:"",items:[{icon:nd,label:"",path:"/"}]},{title:"",items:[{icon:La,label:"",path:"/config/bot"},{icon:Bl,label:"AI",path:"/config/modelProvider",tourId:"sidebar-model-provider"},{icon:hv,label:"",path:"/config/model",tourId:"sidebar-model-management"},{icon:Cg,label:"",path:"/config/adapter"}]},{title:"",items:[{icon:ld,label:"",path:"/resource/emoji"},{icon:Ba,label:"",path:"/resource/expression"},{icon:Xr,label:"",path:"/resource/jargon"},{icon:fv,label:"",path:"/resource/person"},{icon:dv,label:"",path:"/resource/knowledge-graph"},{icon:Jr,label:"",path:"/resource/knowledge-base"}]},{title:"",items:[{icon:ua,label:"",path:"/plugins"},{icon:mv,label:"",path:"/config/pack-market"},{icon:Cg,label:"",path:"/plugin-config"},{icon:ix,label:"",path:"/logs"},{icon:ax,label:"&",path:"/planner-monitor"},{icon:Ba,label:"",path:"/chat"}]},{title:"",items:[{icon:bn,label:"",path:"/settings"}]}],A=N==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":N,M=async()=>{await R_()};return e.jsx(aT,{delayDuration:300,children:e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsxs("aside",{className:F("fixed inset-y-0 left-0 z-50 flex flex-col border-r bg-card transition-all duration-300 lg:relative lg:z-0","w-64 lg:w-auto",r?"lg:w-64":"lg:w-16",d?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsx("div",{className:"flex h-16 items-center border-b px-4",children:e.jsxs("div",{className:F("relative flex items-center justify-center flex-1 transition-all overflow-hidden","lg:flex-1",!r&&"lg:flex-none lg:w-8"),children:[e.jsxs("div",{className:F("flex items-baseline gap-2",!r&&"lg:hidden"),children:[e.jsx("span",{className:"font-bold text-xl text-primary-gradient whitespace-nowrap",children:"MaiBot WebUI"}),e.jsx("span",{className:"text-xs text-primary/60 whitespace-nowrap",children:x2()})]}),!r&&e.jsx("span",{className:"hidden lg:block font-bold text-primary-gradient text-2xl",children:"M"})]})}),e.jsx(ss,{className:F("flex-1 overflow-x-hidden",!r&&"lg:w-16"),children:e.jsx("nav",{className:F("p-4",!r&&"lg:p-2 lg:w-16"),children:e.jsx("ul",{className:F("space-y-6",!r&&"lg:space-y-3 lg:w-full"),children:b.map((S,P)=>e.jsxs("li",{children:[e.jsx("div",{className:F("px-3 h-[1.25rem]","mb-2",!r&&"lg:mb-1 lg:invisible"),children:e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground/60 whitespace-nowrap",children:S.title})}),!r&&P>0&&e.jsx("div",{className:"hidden lg:block mb-2 border-t border-border"}),e.jsx("ul",{className:"space-y-1",children:S.items.map(E=>{const C=y({to:E.path}),R=E.icon,H=e.jsxs(e.Fragment,{children:[C&&e.jsx("div",{className:"absolute left-0 top-1/2 h-8 w-1 -translate-y-1/2 rounded-r-full bg-primary transition-opacity duration-300"}),e.jsxs("div",{className:F("flex items-center transition-all duration-300",r?"gap-3":"gap-3 lg:gap-0"),children:[e.jsx(R,{className:F("h-5 w-5 flex-shrink-0",C&&"text-primary"),strokeWidth:2,fill:"none"}),e.jsx("span",{className:F("text-sm font-medium whitespace-nowrap transition-all duration-300",C&&"font-semibold",r?"opacity-100 max-w-[200px]":"opacity-100 max-w-[200px] lg:opacity-0 lg:max-w-0 lg:overflow-hidden"),children:E.label})]})]});return e.jsx("li",{className:"relative",children:e.jsxs(lT,{children:[e.jsx(nT,{asChild:!0,children:e.jsx(Vn,{to:E.path,"data-tour":E.tourId,className:F("relative flex items-center rounded-lg py-2 transition-all duration-300","hover:bg-accent hover:text-accent-foreground",C?"bg-accent text-foreground":"text-muted-foreground hover:text-foreground",r?"px-3":"px-3 lg:px-0 lg:justify-center lg:w-12 lg:mx-auto"),onClick:()=>m(!1),children:H})}),p&&e.jsx(Rb,{side:"right",className:"hidden lg:block",children:e.jsx("p",{children:E.label})})]})},E.path)})})]},S.title))})})})]}),d&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>m(!1)}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(sT,{}),e.jsxs("header",{className:"flex h-16 items-center justify-between border-b bg-card/80 backdrop-blur-md px-4 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m(!d),className:"rounded-lg p-2 hover:bg-accent lg:hidden",children:e.jsx(Z1,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>c(!r),className:"hidden rounded-lg p-2 hover:bg-accent lg:block",title:r?"":"",children:e.jsx(Ia,{className:F("h-5 w-5 transition-transform",!r&&"rotate-180")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vn,{to:"/annual-report",children:e.jsxs(_,{variant:"ghost",size:"sm",className:"gap-2 bg-gradient-to-r from-pink-500/10 to-purple-500/10 hover:from-pink-500/20 hover:to-purple-500/20 border border-pink-500/20",title:"",children:[e.jsx(W1,{className:"h-4 w-4 text-pink-500"}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent font-medium",children:"2025 "})]})}),e.jsxs("button",{onClick:()=>f(!0),className:"relative hidden md:flex items-center w-64 h-9 pl-9 pr-16 bg-background/50 border rounded-md hover:bg-accent/50 transition-colors text-left",children:[e.jsx(Ut,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"..."}),e.jsxs(zb,{size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2",children:[e.jsx("span",{className:"text-xs",children:""}),"K"]})]}),e.jsx(eT,{open:h,onOpenChange:f}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>window.open("https://docs.mai-mai.org","_blank"),className:"gap-2",title:"",children:[e.jsx(e_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx("button",{onClick:S=>{c2(A==="dark"?"light":"dark",j,S)},className:"rounded-lg p-2 hover:bg-accent",title:A==="dark"?"":"",children:A==="dark"?e.jsx(nx,{className:"h-5 w-5"}):e.jsx(ec,{className:"h-5 w-5"})}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:M,className:"gap-2",title:"",children:[e.jsx(s_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden bg-background",children:a}),e.jsx(tT,{})]})]})})}function iT(a){const l=a.split(`
`).slice(1),r=[];for(const c of l){const d=c.trim();if(!d.startsWith("at "))continue;const m=d.match(/at\s+(?:(.+?)\s+\()?(.+?):(\d+):(\d+)\)?$/);m?r.push({functionName:m[1]||"<anonymous>",fileName:m[2],lineNumber:m[3],columnNumber:m[4],raw:d}):r.push({functionName:"<unknown>",fileName:"",lineNumber:"",columnNumber:"",raw:d})}return r}function cT({error:a,errorInfo:l}){const[r,c]=u.useState(!0),[d,m]=u.useState(!1),[h,f]=u.useState(!1),p=a.stack?iT(a.stack):[],g=async()=>{const N=`
Error: ${a.name}
Message: ${a.message}

Stack Trace:
${a.stack||"No stack trace available"}

Component Stack:
${l?.componentStack||"No component stack available"}

URL: ${window.location.href}
User Agent: ${navigator.userAgent}
Time: ${new Date().toISOString()}
    `.trim();try{await navigator.clipboard.writeText(N),f(!0),setTimeout(()=>f(!1),2e3)}catch(j){console.error("Failed to copy:",j)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(pt,{variant:"destructive",className:"border-red-500/50 bg-red-500/10",children:[e.jsx(qt,{className:"h-4 w-4"}),e.jsxs(gt,{className:"font-mono text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[a.name,":"]})," ",a.message]})]}),p.length>0&&e.jsxs(uc,{open:r,onOpenChange:c,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(t_,{className:"h-4 w-4"}),"Stack Trace (",p.length," frames)"]}),r?e.jsx(Yr,{className:"h-4 w-4"}):e.jsx($a,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(ss,{className:"h-[280px] rounded-md border bg-muted/30",children:e.jsx("div",{className:"p-3 space-y-1",children:p.map((N,j)=>e.jsx("div",{className:"font-mono text-xs p-2 rounded hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"text-muted-foreground w-6 text-right flex-shrink-0",children:[j+1,"."]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-primary font-medium",children:N.functionName}),N.fileName&&e.jsxs("div",{className:"text-muted-foreground mt-0.5 break-all",children:[N.fileName,N.lineNumber&&e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:[":",N.lineNumber,":",N.columnNumber]})]})]})]})},j))})})})]}),l?.componentStack&&e.jsxs(uc,{open:d,onOpenChange:m,children:[e.jsx(mc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(qt,{className:"h-4 w-4"}),"Component Stack"]}),d?e.jsx(Yr,{className:"h-4 w-4"}):e.jsx($a,{className:"h-4 w-4"})]})}),e.jsx(xc,{children:e.jsx(ss,{className:"h-[200px] rounded-md border bg-muted/30",children:e.jsx("pre",{className:"p-3 font-mono text-xs whitespace-pre-wrap text-muted-foreground",children:l.componentStack})})})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:g,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"mr-2 h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"mr-2 h-4 w-4"}),""]})})]})}function Db({error:a,errorInfo:l}){const r=()=>{window.location.href="/"},c=()=>{window.location.reload()};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(Ce,{className:"w-full max-w-2xl shadow-lg",children:[e.jsxs(De,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:e.jsx(qt,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsx(Ue,{className:"text-2xl font-bold",children:""}),e.jsx(fs,{className:"text-base mt-2",children:""})]}),e.jsxs(Ae,{className:"space-y-4",children:[e.jsx(cT,{error:a,errorInfo:l}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[e.jsxs(_,{onClick:c,className:"flex-1",children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:r,variant:"outline",className:"flex-1",children:[e.jsx(nd,{className:"mr-2 h-4 w-4"}),""]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground pt-2",children:""})]})]})})}class oT extends u.Component{constructor(l){super(l),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(l){return{hasError:!0,error:l}}componentDidCatch(l,r){console.error("ErrorBoundary caught an error:",l,r),this.setState({errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError&&this.state.error?this.props.fallback?this.props.fallback:e.jsx(Db,{error:this.state.error,errorInfo:this.state.errorInfo}):this.props.children}}function Ob({error:a}){return e.jsx(Db,{error:a,errorInfo:null})}const vc=sw({component:()=>e.jsxs(e.Fragment,{children:[e.jsx(cj,{}),!1]}),beforeLoad:()=>{if(window.location.pathname==="/"&&!X5())throw aw({to:"/auth"})}}),dT=rt({getParentRoute:()=>vc,path:"/auth",component:E2}),uT=rt({getParentRoute:()=>vc,path:"/setup",component:V2}),jt=rt({getParentRoute:()=>vc,id:"protected",component:()=>e.jsx(rT,{children:e.jsx(cj,{})}),errorComponent:({error:a})=>e.jsx(Ob,{error:a})}),mT=rt({getParentRoute:()=>jt,path:"/",component:l2}),xT=rt({getParentRoute:()=>jt,path:"/config/bot",component:FS}),hT=rt({getParentRoute:()=>jt,path:"/config/modelProvider",component:e4}),fT=rt({getParentRoute:()=>jt,path:"/config/model",component:S4}),pT=rt({getParentRoute:()=>jt,path:"/config/adapter",component:E4}),gT=rt({getParentRoute:()=>jt,path:"/resource/emoji",component:Z4}),jT=rt({getParentRoute:()=>jt,path:"/resource/expression",component:tk}),vT=rt({getParentRoute:()=>jt,path:"/resource/person",component:kk}),NT=rt({getParentRoute:()=>jt,path:"/resource/jargon",component:pk}),bT=rt({getParentRoute:()=>jt,path:"/resource/knowledge-graph",component:Ok}),yT=rt({getParentRoute:()=>jt,path:"/resource/knowledge-base",component:Lk}),wT=rt({getParentRoute:()=>jt,path:"/logs",component:$k}),_T=rt({getParentRoute:()=>jt,path:"/planner-monitor",component:Kk}),ST=rt({getParentRoute:()=>jt,path:"/chat",component:zC}),kT=rt({getParentRoute:()=>jt,path:"/plugins",component:xC}),CT=rt({getParentRoute:()=>jt,path:"/plugin-detail",component:wC}),TT=rt({getParentRoute:()=>jt,path:"/model-presets",component:fC}),ET=rt({getParentRoute:()=>jt,path:"/plugin-config",component:jC}),MT=rt({getParentRoute:()=>jt,path:"/plugin-mirrors",component:NC}),AT=rt({getParentRoute:()=>jt,path:"/settings",component:y2}),zT=rt({getParentRoute:()=>jt,path:"/config/pack-market",component:A5}),Lb=rt({getParentRoute:()=>jt,path:"/config/pack-market/$packId",component:K5}),RT=rt({getParentRoute:()=>jt,path:"/survey/webui-feedback",component:QC}),DT=rt({getParentRoute:()=>jt,path:"/survey/maibot-feedback",component:YC}),OT=rt({getParentRoute:()=>jt,path:"/annual-report",component:s5}),LT=rt({getParentRoute:()=>vc,path:"*",component:qv}),UT=vc.addChildren([dT,uT,jt.addChildren([mT,xT,hT,fT,pT,gT,jT,NT,vT,bT,yT,kT,CT,TT,ET,MT,wT,_T,ST,AT,zT,Lb,RT,DT,OT]),LT]),$T=tw({routeTree:UT,defaultNotFoundComponent:qv,defaultErrorComponent:({error:a})=>e.jsx(Ob,{error:a})});function BT({children:a,defaultTheme:l="system",storageKey:r="ui-theme",...c}){const[d,m]=u.useState(()=>localStorage.getItem(r)||l);u.useEffect(()=>{const f=window.document.documentElement;if(f.classList.remove("light","dark"),d==="system"){const p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";f.classList.add(p);return}f.classList.add(d)},[d]),u.useEffect(()=>{const f=localStorage.getItem("accent-color");if(f){const p=document.documentElement,N={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[f];N&&(p.style.setProperty("--primary",N.hsl),N.gradient?(p.style.setProperty("--primary-gradient",N.gradient),p.classList.add("has-gradient")):(p.style.removeProperty("--primary-gradient"),p.classList.remove("has-gradient")))}},[]);const h={theme:d,setTheme:f=>{localStorage.setItem(r,f),m(f)}};return e.jsx(Bv.Provider,{...c,value:h,children:a})}function IT({children:a,defaultEnabled:l=!0,defaultWavesEnabled:r=!0,storageKey:c="enable-animations",wavesStorageKey:d="enable-waves-background"}){const[m,h]=u.useState(()=>{const N=localStorage.getItem(c);return N!==null?N==="true":l}),[f,p]=u.useState(()=>{const N=localStorage.getItem(d);return N!==null?N==="true":r});u.useEffect(()=>{const N=document.documentElement;m?N.classList.remove("no-animations"):N.classList.add("no-animations"),localStorage.setItem(c,String(m))},[m,c]),u.useEffect(()=>{localStorage.setItem(d,String(f))},[f,d]);const g={enableAnimations:m,setEnableAnimations:h,enableWavesBackground:f,setEnableWavesBackground:p};return e.jsx(Iv.Provider,{value:g,children:a})}const PT=b1,Ub=u.forwardRef(({className:a,...l},r)=>e.jsx(Yj,{ref:r,className:F("fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:max-w-[420px] gap-2",a),...l}));Ub.displayName=Yj.displayName;const FT=ei("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-slide-in-from-right data-[state=open]:animate-fade-in data-[state=closed]:animate-slide-out-to-right data-[state=closed]:animate-fade-out data-[swipe=end]:animate-slide-out-to-right",{variants:{variant:{default:"border bg-primary/5 text-foreground backdrop-blur-sm",destructive:"destructive group border-destructive bg-destructive/10 text-destructive-foreground backdrop-blur-sm"}},defaultVariants:{variant:"default"}}),$b=u.forwardRef(({className:a,variant:l,...r},c)=>e.jsx(Jj,{ref:c,className:F(FT({variant:l}),a),...r}));$b.displayName=Jj.displayName;const HT=u.forwardRef(({className:a,...l},r)=>e.jsx(Xj,{ref:r,className:F("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...l}));HT.displayName=Xj.displayName;const Bb=u.forwardRef(({className:a,...l},r)=>e.jsx(Zj,{ref:r,className:F("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...l,children:e.jsx(_a,{className:"h-4 w-4"})}));Bb.displayName=Zj.displayName;const Ib=u.forwardRef(({className:a,...l},r)=>e.jsx(Wj,{ref:r,className:F("text-sm font-semibold [&+div]:text-xs",a),...l}));Ib.displayName=Wj.displayName;const Pb=u.forwardRef(({className:a,...l},r)=>e.jsx(ev,{ref:r,className:F("text-sm opacity-90",a),...l}));Pb.displayName=ev.displayName;function qT(){const{toasts:a}=it();return e.jsxs(PT,{children:[a.map(function({id:l,title:r,description:c,action:d,...m}){return e.jsxs($b,{...m,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Ib,{children:r}),c&&e.jsx(Pb,{children:c})]}),d,e.jsx(Bb,{})]},l)}),e.jsx(Ub,{})]})}z_.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(oT,{children:e.jsx(BT,{defaultTheme:"system",children:e.jsx(IT,{children:e.jsxs(QS,{children:[e.jsx(lw,{router:$T}),e.jsx(XS,{}),e.jsx(qT,{})]})})})})}));
