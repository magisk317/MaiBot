import{r as d,j as e,L as Bn,e as ca,R as As,b as v0,f as N0,g as b0,h as y0,k as w0,l as Qs,m as _0,n as S0,O as Bg,o as k0}from"./router-9vIXuQkh.js";import{a as C0,b as T0,g as E0}from"./react-vendor-BmxF9s7Q.js";import{N as M0,c as z0,O as Kr,P as A0,g as vm}from"./utils-BqoaXoQ1.js";import{L as Ig,T as Pg,C as Hg,R as O0,a as Fg,V as D0,b as R0,S as Gg,c as L0,d as Vg,I as U0,e as qg,f as $0,g as Kg,h as B0,i as I0,j as P0,O as Qg,P as H0,k as Yg,l as Jg,D as Xg,A as Zg,m as Wg,n as F0,o as G0,p as ej,q as V0,r as sj,s as q0,t as K0,u as tj,v as Q0,w as Y0,x as aj,y as lj,F as nj,z as rj,B as J0,E as X0,G as ij,H as Z0,J as W0,K as ew,M as sw,N as tw,Q as aw,U as lw,W as nw,X as rw,Y as iw,Z as cw,_ as ow,$ as dw,a0 as uw,a1 as mw,a2 as cj,a3 as xw,a4 as hw}from"./radix-extra-tU0cN6gS.js";import{R as oj,T as dj,L as fw,g as pw,C as Hi,X as Fi,Y as Ur,h as gw,B as Eo,j as Gi,P as jw,k as vw,l as Nw}from"./charts-simvewUa.js";import{S as bw,O as uj,o as yw,C as mj,p as ww,T as xj,D as hj,R as _w,q as Sw,H as fj,I as kw,J as pj,K as gj,L as Cw,M as jj,N as vj,Q as Tw,U as Nj,V as Ew,X as bj,Y as yj,Z as Mw,_ as zw,$ as wj,a0 as Aw,a1 as Ow,e as _j,f as qo,c as Ko,P as Qn,d as Qo,b as hn,h as Dw,l as Rw,m as Lw,u as Lm,r as Uw,a as $w,a2 as Bw,a3 as Sj,a4 as Iw,a5 as Pw,a6 as Hw,a7 as kj,a8 as Cj,a9 as Tj,aa as Ej,ab as Mj,ac as zj,ad as Fw}from"./radix-core-CEUnGg09.js";import{R as dt,a as Zi,C as _t,b as pt,L as Bs,X as Ea,c as Ct,d as na,e as Va,S as Tt,f as Aa,g as Zt,B as Pn,U as fn,P as cc,Z as Za,h as Aj,F as Ca,i as Gw,j as pn,k as Vw,M as Ma,A as Gm,D as qw,l as Hr,T as Vm,m as Kw,n as Oj,I as Ht,o as Jt,p as Ro,E as Wi,q as ia,H as Qw,r as ls,s as sa,t as ec,u as qm,v as Qi,w as rg,K as Km,x as Dj,y as Yw,z as Mo,G as Jw,J as Yo,N as Xw,O as Zw,Q as Jo,V as Ta,W as et,Y as za,_ as Fr,$ as Qm,a0 as Rj,a1 as oc,a2 as Lj,a3 as Uj,a4 as Fn,a5 as gn,a6 as jn,a7 as Ym,a8 as $j,a9 as ra,aa as Dl,ab as Gn,ac as Vn,ad as Xo,ae as Ww,af as e_,ag as s_,ah as Jm,ai as zo,aj as qn,ak as t_,al as Gr,am as Lo,an as a_,ao as Uo,ap as sc,aq as Bj,ar as l_,as as n_,at as $o,au as r_,av as Xm,aw as i_,ax as ig,ay as c_,az as o_,aA as Ij,aB as d_,aC as dn,aD as Pj,aE as Nm,aF as cg,aG as u_,aH as bm,aI as m_,aJ as x_,aK as h_,aL as f_,aM as Hj,aN as p_,aO as Vr,aP as g_,aQ as j_,aR as Fj,aS as Gj,aT as v_,aU as N_,aV as og,aW as b_,aX as y_,aY as w_,aZ as __,a_ as S_}from"./icons-Dluc6IJB.js";import{S as k_,p as C_,j as T_,a as E_,E as dg,R as M_,o as z_}from"./codemirror-TZqPU532.js";import{u as Vj,a as Bo,s as qj,K as Kj,P as Qj,b as Yj,D as Jj,c as Xj,S as Zj,v as A_,d as Wj,C as ev,h as O_}from"./dnd-BiPfFtVp.js";import{_ as ga,c as D_,g as sv,D as R_,z as ko}from"./misc-Dw5FBFSX.js";import{D as L_,U as U_}from"./uppy-wQRVMWCa.js";import{M as $_,r as B_,a as I_,b as P_}from"./markdown-CKA5gBQ9.js";import{c as H_,H as Io,P as Po,u as F_,d as G_,R as V_,B as q_,e as K_,C as Q_,M as Y_,f as J_}from"./reactflow-DtsZHOR4.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const x of u)if(x.type==="childList")for(const h of x.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function i(u){const x={};return u.integrity&&(x.integrity=u.integrity),u.referrerPolicy&&(x.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?x.credentials="include":u.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function c(u){if(u.ep)return;u.ep=!0;const x=i(u);fetch(u.href,x)}})();var ym={exports:{}},Bi={},wm={exports:{}},_m={};var ug;function X_(){return ug||(ug=1,(function(l){function n(z,V){var B=z.length;z.push(V);e:for(;0<B;){var oe=B-1>>>1,K=z[oe];if(0<u(K,V))z[oe]=V,z[B]=K,B=oe;else break e}}function i(z){return z.length===0?null:z[0]}function c(z){if(z.length===0)return null;var V=z[0],B=z.pop();if(B!==V){z[0]=B;e:for(var oe=0,K=z.length,_e=K>>>1;oe<_e;){var pe=2*(oe+1)-1,ke=z[pe],O=pe+1,k=z[O];if(0>u(ke,B))O<K&&0>u(k,ke)?(z[oe]=k,z[O]=B,oe=O):(z[oe]=ke,z[pe]=B,oe=pe);else if(O<K&&0>u(k,B))z[oe]=k,z[O]=B,oe=O;else break e}}return V}function u(z,V){var B=z.sortIndex-V.sortIndex;return B!==0?B:z.id-V.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var x=performance;l.unstable_now=function(){return x.now()}}else{var h=Date,f=h.now();l.unstable_now=function(){return h.now()-f}}var p=[],g=[],N=1,v=null,y=3,w=!1,b=!1,R=!1,D=!1,S=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function T(z){for(var V=i(g);V!==null;){if(V.callback===null)c(g);else if(V.startTime<=z)c(g),V.sortIndex=V.expirationTime,n(p,V);else break;V=i(g)}}function A(z){if(R=!1,T(z),!b)if(i(p)!==null)b=!0,F||(F=!0,he());else{var V=i(g);V!==null&&je(A,V.startTime-z)}}var F=!1,L=-1,J=5,U=-1;function ue(){return D?!0:!(l.unstable_now()-U<J)}function xe(){if(D=!1,F){var z=l.unstable_now();U=z;var V=!0;try{e:{b=!1,R&&(R=!1,P(L),L=-1),w=!0;var B=y;try{s:{for(T(z),v=i(p);v!==null&&!(v.expirationTime>z&&ue());){var oe=v.callback;if(typeof oe=="function"){v.callback=null,y=v.priorityLevel;var K=oe(v.expirationTime<=z);if(z=l.unstable_now(),typeof K=="function"){v.callback=K,T(z),V=!0;break s}v===i(p)&&c(p),T(z)}else c(p);v=i(p)}if(v!==null)V=!0;else{var _e=i(g);_e!==null&&je(A,_e.startTime-z),V=!1}}break e}finally{v=null,y=B,w=!1}V=void 0}}finally{V?he():F=!1}}}var he;if(typeof M=="function")he=function(){M(xe)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,ve=ne.port2;ne.port1.onmessage=xe,he=function(){ve.postMessage(null)}}else he=function(){S(xe,0)};function je(z,V){L=S(function(){z(l.unstable_now())},V)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(z){z.callback=null},l.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<z?Math.floor(1e3/z):5},l.unstable_getCurrentPriorityLevel=function(){return y},l.unstable_next=function(z){switch(y){case 1:case 2:case 3:var V=3;break;default:V=y}var B=y;y=V;try{return z()}finally{y=B}},l.unstable_requestPaint=function(){D=!0},l.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var B=y;y=z;try{return V()}finally{y=B}},l.unstable_scheduleCallback=function(z,V,B){var oe=l.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?oe+B:oe):B=oe,z){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=B+K,z={id:N++,callback:V,priorityLevel:z,startTime:B,expirationTime:K,sortIndex:-1},B>oe?(z.sortIndex=B,n(g,z),i(p)===null&&z===i(g)&&(R?(P(L),L=-1):R=!0,je(A,B-oe))):(z.sortIndex=K,n(p,z),b||w||(b=!0,F||(F=!0,he()))),z},l.unstable_shouldYield=ue,l.unstable_wrapCallback=function(z){var V=y;return function(){var B=y;y=V;try{return z.apply(this,arguments)}finally{y=B}}}})(_m)),_m}var mg;function Z_(){return mg||(mg=1,wm.exports=X_()),wm.exports}var xg;function W_(){if(xg)return Bi;xg=1;var l=Z_(),n=C0(),i=T0();function c(s){var t="https://react.dev/errors/"+s;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+s+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function x(s){var t=s,a=s;if(s.alternate)for(;t.return;)t=t.return;else{s=t;do t=s,(t.flags&4098)!==0&&(a=t.return),s=t.return;while(s)}return t.tag===3?a:null}function h(s){if(s.tag===13){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function f(s){if(s.tag===31){var t=s.memoizedState;if(t===null&&(s=s.alternate,s!==null&&(t=s.memoizedState)),t!==null)return t.dehydrated}return null}function p(s){if(x(s)!==s)throw Error(c(188))}function g(s){var t=s.alternate;if(!t){if(t=x(s),t===null)throw Error(c(188));return t!==s?null:s}for(var a=s,r=t;;){var o=a.return;if(o===null)break;var m=o.alternate;if(m===null){if(r=o.return,r!==null){a=r;continue}break}if(o.child===m.child){for(m=o.child;m;){if(m===a)return p(o),s;if(m===r)return p(o),t;m=m.sibling}throw Error(c(188))}if(a.return!==r.return)a=o,r=m;else{for(var j=!1,C=o.child;C;){if(C===a){j=!0,a=o,r=m;break}if(C===r){j=!0,r=o,a=m;break}C=C.sibling}if(!j){for(C=m.child;C;){if(C===a){j=!0,a=m,r=o;break}if(C===r){j=!0,r=m,a=o;break}C=C.sibling}if(!j)throw Error(c(189))}}if(a.alternate!==r)throw Error(c(190))}if(a.tag!==3)throw Error(c(188));return a.stateNode.current===a?s:t}function N(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s;for(s=s.child;s!==null;){if(t=N(s),t!==null)return t;s=s.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),P=Symbol.for("react.consumer"),M=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),ue=Symbol.for("react.memo_cache_sentinel"),xe=Symbol.iterator;function he(s){return s===null||typeof s!="object"?null:(s=xe&&s[xe]||s["@@iterator"],typeof s=="function"?s:null)}var ne=Symbol.for("react.client.reference");function ve(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ne?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case R:return"Fragment";case S:return"Profiler";case D:return"StrictMode";case A:return"Suspense";case F:return"SuspenseList";case U:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case M:return s.displayName||"Context";case P:return(s._context.displayName||"Context")+".Consumer";case T:var t=s.render;return s=s.displayName,s||(s=t.displayName||t.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case L:return t=s.displayName||null,t!==null?t:ve(s.type)||"Memo";case J:t=s._payload,s=s._init;try{return ve(s(t))}catch{}}return null}var je=Array.isArray,z=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},oe=[],K=-1;function _e(s){return{current:s}}function pe(s){0>K||(s.current=oe[K],oe[K]=null,K--)}function ke(s,t){K++,oe[K]=s.current,s.current=t}var O=_e(null),k=_e(null),H=_e(null),se=_e(null);function Ee(s,t){switch(ke(H,t),ke(k,s),ke(O,null),t.nodeType){case 9:case 11:s=(s=t.documentElement)&&(s=s.namespaceURI)?Ep(s):0;break;default:if(s=t.tagName,t=t.namespaceURI)t=Ep(t),s=Mp(t,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}pe(O),ke(O,s)}function Z(){pe(O),pe(k),pe(H)}function Oe(s){s.memoizedState!==null&&ke(se,s);var t=O.current,a=Mp(t,s.type);t!==a&&(ke(k,s),ke(O,a))}function ns(s){k.current===s&&(pe(O),pe(k)),se.current===s&&(pe(se),Ri._currentValue=B)}var Q,ee;function Ue(s){if(Q===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);Q=t&&t[1]||"",ee=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Q+s+ee}var ie=!1;function Te(s,t){if(!s||ie)return"";ie=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(me){var ce=me}Reflect.construct(s,[],be)}else{try{be.call()}catch(me){ce=me}s.call(be.prototype)}}else{try{throw Error()}catch(me){ce=me}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(me){if(me&&ce&&typeof me.stack=="string")return[me.stack,ce.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=r.DetermineComponentFrameRoot(),j=m[0],C=m[1];if(j&&C){var $=j.split(`
`),ae=C.split(`
`);for(o=r=0;r<$.length&&!$[r].includes("DetermineComponentFrameRoot");)r++;for(;o<ae.length&&!ae[o].includes("DetermineComponentFrameRoot");)o++;if(r===$.length||o===ae.length)for(r=$.length-1,o=ae.length-1;1<=r&&0<=o&&$[r]!==ae[o];)o--;for(;1<=r&&0<=o;r--,o--)if($[r]!==ae[o]){if(r!==1||o!==1)do if(r--,o--,0>o||$[r]!==ae[o]){var ge=`
`+$[r].replace(" at new "," at ");return s.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",s.displayName)),ge}while(1<=r&&0<=o);break}}}finally{ie=!1,Error.prepareStackTrace=a}return(a=s?s.displayName||s.name:"")?Ue(a):""}function de(s,t){switch(s.tag){case 26:case 27:case 5:return Ue(s.type);case 16:return Ue("Lazy");case 13:return s.child!==t&&t!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return Te(s.type,!1);case 11:return Te(s.type.render,!1);case 1:return Te(s.type,!0);case 31:return Ue("Activity");default:return""}}function Me(s){try{var t="",a=null;do t+=de(s,a),a=s,s=s.return;while(s);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var rs=Object.prototype.hasOwnProperty,Ut=l.unstable_scheduleCallback,aa=l.unstable_cancelCallback,Qa=l.unstable_shouldYield,Ft=l.unstable_requestPaint,mt=l.unstable_now,q=l.unstable_getCurrentPriorityLevel,Ve=l.unstable_ImmediatePriority,Ke=l.unstable_UserBlockingPriority,We=l.unstable_NormalPriority,Ls=l.unstable_LowPriority,ts=l.unstable_IdlePriority,Cs=l.log,ze=l.unstable_setDisableYieldValue,Ns=null,as=null;function es(s){if(typeof Cs=="function"&&ze(s),as&&typeof as.setStrictMode=="function")try{as.setStrictMode(Ns,s)}catch{}}var bs=Math.clz32?Math.clz32:tt,gt=Math.log,$t=Math.LN2;function tt(s){return s>>>=0,s===0?32:31-(gt(s)/$t|0)|0}var Ms=256,Et=262144,Bt=4194304;function Oa(s){var t=s&42;if(t!==0)return t;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function tl(s,t,a){var r=s.pendingLanes;if(r===0)return 0;var o=0,m=s.suspendedLanes,j=s.pingedLanes;s=s.warmLanes;var C=r&134217727;return C!==0?(r=C&~m,r!==0?o=Oa(r):(j&=C,j!==0?o=Oa(j):a||(a=C&~s,a!==0&&(o=Oa(a))))):(C=r&~m,C!==0?o=Oa(C):j!==0?o=Oa(j):a||(a=r&~s,a!==0&&(o=Oa(a)))),o===0?0:t!==0&&t!==o&&(t&m)===0&&(m=o&-o,a=t&-t,m>=a||m===32&&(a&4194048)!==0)?t:o}function ul(s,t){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&t)===0}function Xn(s,t){switch(s){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function W(){var s=Bt;return Bt<<=1,(Bt&62914560)===0&&(Bt=4194304),s}function ye(s){for(var t=[],a=0;31>a;a++)t.push(s);return t}function Re(s,t){s.pendingLanes|=t,t!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Hs(s,t,a,r,o,m){var j=s.pendingLanes;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=a,s.entangledLanes&=a,s.errorRecoveryDisabledLanes&=a,s.shellSuspendCounter=0;var C=s.entanglements,$=s.expirationTimes,ae=s.hiddenUpdates;for(a=j&~a;0<a;){var ge=31-bs(a),be=1<<ge;C[ge]=0,$[ge]=-1;var ce=ae[ge];if(ce!==null)for(ae[ge]=null,ge=0;ge<ce.length;ge++){var me=ce[ge];me!==null&&(me.lane&=-536870913)}a&=~be}r!==0&&Dt(s,r,0),m!==0&&o===0&&s.tag!==0&&(s.suspendedLanes|=m&~(j&~t))}function Dt(s,t,a){s.pendingLanes|=t,s.suspendedLanes&=~t;var r=31-bs(t);s.entangledLanes|=t,s.entanglements[r]=s.entanglements[r]|1073741824|a&261930}function Wt(s,t){var a=s.entangledLanes|=t;for(s=s.entanglements;a;){var r=31-bs(a),o=1<<r;o&t|s[r]&t&&(s[r]|=t),a&=~o}}function rt(s,t){var a=t&-t;return a=(a&42)!==0?1:ea(a),(a&(s.suspendedLanes|t))!==0?0:a}function ea(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function re(){var s=V.p;return s!==0?s:(s=window.event,s===void 0?32:Wp(s.type))}function fe(s,t){var a=V.p;try{return V.p=s,t()}finally{V.p=a}}var ss=Math.random().toString(36).slice(2),gs="__reactFiber$"+ss,is="__reactProps$"+ss,jt="__reactContainer$"+ss,ja="__reactEvents$"+ss,Bl="__reactListeners$"+ss,Zn="__reactHandles$"+ss,Jr="__reactResources$"+ss,bn="__reactMarker$"+ss;function ud(s){delete s[gs],delete s[is],delete s[ja],delete s[Bl],delete s[Zn]}function Wn(s){var t=s[gs];if(t)return t;for(var a=s.parentNode;a;){if(t=a[jt]||a[gs]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(s=Up(s);s!==null;){if(a=s[gs])return a;s=Up(s)}return t}s=a,a=s.parentNode}return null}function er(s){if(s=s[gs]||s[jt]){var t=s.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return s}return null}function Xr(s){var t=s.tag;if(t===5||t===26||t===27||t===6)return s.stateNode;throw Error(c(33))}function sr(s){var t=s[Jr];return t||(t=s[Jr]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function It(s){s[bn]=!0}var px=new Set,gx={};function yn(s,t){tr(s,t),tr(s+"Capture",t)}function tr(s,t){for(gx[s]=t,s=0;s<t.length;s++)px.add(t[s])}var db=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jx={},vx={};function ub(s){return rs.call(vx,s)?!0:rs.call(jx,s)?!1:db.test(s)?vx[s]=!0:(jx[s]=!0,!1)}function xc(s,t,a){if(ub(t))if(a===null)s.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":s.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){s.removeAttribute(t);return}}s.setAttribute(t,""+a)}}function hc(s,t,a){if(a===null)s.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(t);return}s.setAttribute(t,""+a)}}function ml(s,t,a,r){if(r===null)s.removeAttribute(a);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttributeNS(t,a,""+r)}}function Da(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Nx(s){var t=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function mb(s,t,a){var r=Object.getOwnPropertyDescriptor(s.constructor.prototype,t);if(!s.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,m=r.set;return Object.defineProperty(s,t,{configurable:!0,get:function(){return o.call(this)},set:function(j){a=""+j,m.call(this,j)}}),Object.defineProperty(s,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(j){a=""+j},stopTracking:function(){s._valueTracker=null,delete s[t]}}}}function md(s){if(!s._valueTracker){var t=Nx(s)?"checked":"value";s._valueTracker=mb(s,t,""+s[t])}}function bx(s){if(!s)return!1;var t=s._valueTracker;if(!t)return!0;var a=t.getValue(),r="";return s&&(r=Nx(s)?s.checked?"true":"false":s.value),s=r,s!==a?(t.setValue(s),!0):!1}function fc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var xb=/[\n"\\]/g;function Ra(s){return s.replace(xb,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function xd(s,t,a,r,o,m,j,C){s.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?s.type=j:s.removeAttribute("type"),t!=null?j==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+Da(t)):s.value!==""+Da(t)&&(s.value=""+Da(t)):j!=="submit"&&j!=="reset"||s.removeAttribute("value"),t!=null?hd(s,j,Da(t)):a!=null?hd(s,j,Da(a)):r!=null&&s.removeAttribute("value"),o==null&&m!=null&&(s.defaultChecked=!!m),o!=null&&(s.checked=o&&typeof o!="function"&&typeof o!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?s.name=""+Da(C):s.removeAttribute("name")}function yx(s,t,a,r,o,m,j,C){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(s.type=m),t!=null||a!=null){if(!(m!=="submit"&&m!=="reset"||t!=null)){md(s);return}a=a!=null?""+Da(a):"",t=t!=null?""+Da(t):a,C||t===s.value||(s.value=t),s.defaultValue=t}r=r??o,r=typeof r!="function"&&typeof r!="symbol"&&!!r,s.checked=C?s.checked:!!r,s.defaultChecked=!!r,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(s.name=j),md(s)}function hd(s,t,a){t==="number"&&fc(s.ownerDocument)===s||s.defaultValue===""+a||(s.defaultValue=""+a)}function ar(s,t,a,r){if(s=s.options,t){t={};for(var o=0;o<a.length;o++)t["$"+a[o]]=!0;for(a=0;a<s.length;a++)o=t.hasOwnProperty("$"+s[a].value),s[a].selected!==o&&(s[a].selected=o),o&&r&&(s[a].defaultSelected=!0)}else{for(a=""+Da(a),t=null,o=0;o<s.length;o++){if(s[o].value===a){s[o].selected=!0,r&&(s[o].defaultSelected=!0);return}t!==null||s[o].disabled||(t=s[o])}t!==null&&(t.selected=!0)}}function wx(s,t,a){if(t!=null&&(t=""+Da(t),t!==s.value&&(s.value=t),a==null)){s.defaultValue!==t&&(s.defaultValue=t);return}s.defaultValue=a!=null?""+Da(a):""}function _x(s,t,a,r){if(t==null){if(r!=null){if(a!=null)throw Error(c(92));if(je(r)){if(1<r.length)throw Error(c(93));r=r[0]}a=r}a==null&&(a=""),t=a}a=Da(t),s.defaultValue=a,r=s.textContent,r===a&&r!==""&&r!==null&&(s.value=r),md(s)}function lr(s,t){if(t){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=t;return}}s.textContent=t}var hb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sx(s,t,a){var r=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?r?s.setProperty(t,""):t==="float"?s.cssFloat="":s[t]="":r?s.setProperty(t,a):typeof a!="number"||a===0||hb.has(t)?t==="float"?s.cssFloat=a:s[t]=(""+a).trim():s[t]=a+"px"}function kx(s,t,a){if(t!=null&&typeof t!="object")throw Error(c(62));if(s=s.style,a!=null){for(var r in a)!a.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="");for(var o in t)r=t[o],t.hasOwnProperty(o)&&a[o]!==r&&Sx(s,o,r)}else for(var m in t)t.hasOwnProperty(m)&&Sx(s,m,t[m])}function fd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pc(s){return pb.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function xl(){}var pd=null;function gd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var nr=null,rr=null;function Cx(s){var t=er(s);if(t&&(s=t.stateNode)){var a=s[is]||null;e:switch(s=t.stateNode,t.type){case"input":if(xd(s,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Ra(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var r=a[t];if(r!==s&&r.form===s.form){var o=r[is]||null;if(!o)throw Error(c(90));xd(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<a.length;t++)r=a[t],r.form===s.form&&bx(r)}break e;case"textarea":wx(s,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&ar(s,!!a.multiple,t,!1)}}}var jd=!1;function Tx(s,t,a){if(jd)return s(t,a);jd=!0;try{var r=s(t);return r}finally{if(jd=!1,(nr!==null||rr!==null)&&(ao(),nr&&(t=nr,s=rr,rr=nr=null,Cx(t),s)))for(t=0;t<s.length;t++)Cx(s[t])}}function Zr(s,t){var a=s.stateNode;if(a===null)return null;var r=a[is]||null;if(r===null)return null;a=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(s=s.type,r=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!r;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(c(231,t,typeof a));return a}var hl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vd=!1;if(hl)try{var Wr={};Object.defineProperty(Wr,"passive",{get:function(){vd=!0}}),window.addEventListener("test",Wr,Wr),window.removeEventListener("test",Wr,Wr)}catch{vd=!1}var Il=null,Nd=null,gc=null;function Ex(){if(gc)return gc;var s,t=Nd,a=t.length,r,o="value"in Il?Il.value:Il.textContent,m=o.length;for(s=0;s<a&&t[s]===o[s];s++);var j=a-s;for(r=1;r<=j&&t[a-r]===o[m-r];r++);return gc=o.slice(s,1<r?1-r:void 0)}function jc(s){var t=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&t===13&&(s=13)):s=t,s===10&&(s=13),32<=s||s===13?s:0}function vc(){return!0}function Mx(){return!1}function da(s){function t(a,r,o,m,j){this._reactName=a,this._targetInst=o,this.type=r,this.nativeEvent=m,this.target=j,this.currentTarget=null;for(var C in s)s.hasOwnProperty(C)&&(a=s[C],this[C]=a?a(m):m[C]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?vc:Mx,this.isPropagationStopped=Mx,this}return v(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=vc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=vc)},persist:function(){},isPersistent:vc}),t}var wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=da(wn),ei=v({},wn,{view:0,detail:0}),gb=da(ei),bd,yd,si,bc=v({},ei,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_d,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==si&&(si&&s.type==="mousemove"?(bd=s.screenX-si.screenX,yd=s.screenY-si.screenY):yd=bd=0,si=s),bd)},movementY:function(s){return"movementY"in s?s.movementY:yd}}),zx=da(bc),jb=v({},bc,{dataTransfer:0}),vb=da(jb),Nb=v({},ei,{relatedTarget:0}),wd=da(Nb),bb=v({},wn,{animationName:0,elapsedTime:0,pseudoElement:0}),yb=da(bb),wb=v({},wn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),_b=da(wb),Sb=v({},wn,{data:0}),Ax=da(Sb),kb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Eb(s){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(s):(s=Tb[s])?!!t[s]:!1}function _d(){return Eb}var Mb=v({},ei,{key:function(s){if(s.key){var t=kb[s.key]||s.key;if(t!=="Unidentified")return t}return s.type==="keypress"?(s=jc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Cb[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_d,charCode:function(s){return s.type==="keypress"?jc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?jc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),zb=da(Mb),Ab=v({},bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ox=da(Ab),Ob=v({},ei,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_d}),Db=da(Ob),Rb=v({},wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lb=da(Rb),Ub=v({},bc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),$b=da(Ub),Bb=v({},wn,{newState:0,oldState:0}),Ib=da(Bb),Pb=[9,13,27,32],Sd=hl&&"CompositionEvent"in window,ti=null;hl&&"documentMode"in document&&(ti=document.documentMode);var Hb=hl&&"TextEvent"in window&&!ti,Dx=hl&&(!Sd||ti&&8<ti&&11>=ti),Rx=" ",Lx=!1;function Ux(s,t){switch(s){case"keyup":return Pb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $x(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ir=!1;function Fb(s,t){switch(s){case"compositionend":return $x(t);case"keypress":return t.which!==32?null:(Lx=!0,Rx);case"textInput":return s=t.data,s===Rx&&Lx?null:s;default:return null}}function Gb(s,t){if(ir)return s==="compositionend"||!Sd&&Ux(s,t)?(s=Ex(),gc=Nd=Il=null,ir=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dx&&t.locale!=="ko"?null:t.data;default:return null}}var Vb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bx(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t==="input"?!!Vb[s.type]:t==="textarea"}function Ix(s,t,a,r){nr?rr?rr.push(r):rr=[r]:nr=r,t=uo(t,"onChange"),0<t.length&&(a=new Nc("onChange","change",null,a,r),s.push({event:a,listeners:t}))}var ai=null,li=null;function qb(s){wp(s,0)}function yc(s){var t=Xr(s);if(bx(t))return s}function Px(s,t){if(s==="change")return t}var Hx=!1;if(hl){var kd;if(hl){var Cd="oninput"in document;if(!Cd){var Fx=document.createElement("div");Fx.setAttribute("oninput","return;"),Cd=typeof Fx.oninput=="function"}kd=Cd}else kd=!1;Hx=kd&&(!document.documentMode||9<document.documentMode)}function Gx(){ai&&(ai.detachEvent("onpropertychange",Vx),li=ai=null)}function Vx(s){if(s.propertyName==="value"&&yc(li)){var t=[];Ix(t,li,s,gd(s)),Tx(qb,t)}}function Kb(s,t,a){s==="focusin"?(Gx(),ai=t,li=a,ai.attachEvent("onpropertychange",Vx)):s==="focusout"&&Gx()}function Qb(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return yc(li)}function Yb(s,t){if(s==="click")return yc(t)}function Jb(s,t){if(s==="input"||s==="change")return yc(t)}function Xb(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var va=typeof Object.is=="function"?Object.is:Xb;function ni(s,t){if(va(s,t))return!0;if(typeof s!="object"||s===null||typeof t!="object"||t===null)return!1;var a=Object.keys(s),r=Object.keys(t);if(a.length!==r.length)return!1;for(r=0;r<a.length;r++){var o=a[r];if(!rs.call(t,o)||!va(s[o],t[o]))return!1}return!0}function qx(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Kx(s,t){var a=qx(s);s=0;for(var r;a;){if(a.nodeType===3){if(r=s+a.textContent.length,s<=t&&r>=t)return{node:a,offset:t-s};s=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=qx(a)}}function Qx(s,t){return s&&t?s===t?!0:s&&s.nodeType===3?!1:t&&t.nodeType===3?Qx(s,t.parentNode):"contains"in s?s.contains(t):s.compareDocumentPosition?!!(s.compareDocumentPosition(t)&16):!1:!1}function Yx(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var t=fc(s.document);t instanceof s.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)s=t.contentWindow;else break;t=fc(s.document)}return t}function Td(s){var t=s&&s.nodeName&&s.nodeName.toLowerCase();return t&&(t==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||t==="textarea"||s.contentEditable==="true")}var Zb=hl&&"documentMode"in document&&11>=document.documentMode,cr=null,Ed=null,ri=null,Md=!1;function Jx(s,t,a){var r=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Md||cr==null||cr!==fc(r)||(r=cr,"selectionStart"in r&&Td(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ri&&ni(ri,r)||(ri=r,r=uo(Ed,"onSelect"),0<r.length&&(t=new Nc("onSelect","select",null,t,a),s.push({event:t,listeners:r}),t.target=cr)))}function _n(s,t){var a={};return a[s.toLowerCase()]=t.toLowerCase(),a["Webkit"+s]="webkit"+t,a["Moz"+s]="moz"+t,a}var or={animationend:_n("Animation","AnimationEnd"),animationiteration:_n("Animation","AnimationIteration"),animationstart:_n("Animation","AnimationStart"),transitionrun:_n("Transition","TransitionRun"),transitionstart:_n("Transition","TransitionStart"),transitioncancel:_n("Transition","TransitionCancel"),transitionend:_n("Transition","TransitionEnd")},zd={},Xx={};hl&&(Xx=document.createElement("div").style,"AnimationEvent"in window||(delete or.animationend.animation,delete or.animationiteration.animation,delete or.animationstart.animation),"TransitionEvent"in window||delete or.transitionend.transition);function Sn(s){if(zd[s])return zd[s];if(!or[s])return s;var t=or[s],a;for(a in t)if(t.hasOwnProperty(a)&&a in Xx)return zd[s]=t[a];return s}var Zx=Sn("animationend"),Wx=Sn("animationiteration"),eh=Sn("animationstart"),Wb=Sn("transitionrun"),ey=Sn("transitionstart"),sy=Sn("transitioncancel"),sh=Sn("transitionend"),th=new Map,Ad="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ad.push("scrollEnd");function Ya(s,t){th.set(s,t),yn(t,[s])}var wc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},La=[],dr=0,Od=0;function _c(){for(var s=dr,t=Od=dr=0;t<s;){var a=La[t];La[t++]=null;var r=La[t];La[t++]=null;var o=La[t];La[t++]=null;var m=La[t];if(La[t++]=null,r!==null&&o!==null){var j=r.pending;j===null?o.next=o:(o.next=j.next,j.next=o),r.pending=o}m!==0&&ah(a,o,m)}}function Sc(s,t,a,r){La[dr++]=s,La[dr++]=t,La[dr++]=a,La[dr++]=r,Od|=r,s.lanes|=r,s=s.alternate,s!==null&&(s.lanes|=r)}function Dd(s,t,a,r){return Sc(s,t,a,r),kc(s)}function kn(s,t){return Sc(s,null,null,t),kc(s)}function ah(s,t,a){s.lanes|=a;var r=s.alternate;r!==null&&(r.lanes|=a);for(var o=!1,m=s.return;m!==null;)m.childLanes|=a,r=m.alternate,r!==null&&(r.childLanes|=a),m.tag===22&&(s=m.stateNode,s===null||s._visibility&1||(o=!0)),s=m,m=m.return;return s.tag===3?(m=s.stateNode,o&&t!==null&&(o=31-bs(a),s=m.hiddenUpdates,r=s[o],r===null?s[o]=[t]:r.push(t),t.lane=a|536870912),m):null}function kc(s){if(50<Ti)throw Ti=0,Fu=null,Error(c(185));for(var t=s.return;t!==null;)s=t,t=s.return;return s.tag===3?s.stateNode:null}var ur={};function ty(s,t,a,r){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Na(s,t,a,r){return new ty(s,t,a,r)}function Rd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fl(s,t){var a=s.alternate;return a===null?(a=Na(s.tag,t,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=t,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&65011712,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a.refCleanup=s.refCleanup,a}function lh(s,t){s.flags&=65011714;var a=s.alternate;return a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s}function Cc(s,t,a,r,o,m){var j=0;if(r=s,typeof s=="function")Rd(s)&&(j=1);else if(typeof s=="string")j=i0(s,a,O.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case U:return s=Na(31,a,t,o),s.elementType=U,s.lanes=m,s;case R:return Cn(a.children,o,m,t);case D:j=8,o|=24;break;case S:return s=Na(12,a,t,o|2),s.elementType=S,s.lanes=m,s;case A:return s=Na(13,a,t,o),s.elementType=A,s.lanes=m,s;case F:return s=Na(19,a,t,o),s.elementType=F,s.lanes=m,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case M:j=10;break e;case P:j=9;break e;case T:j=11;break e;case L:j=14;break e;case J:j=16,r=null;break e}j=29,a=Error(c(130,s===null?"null":typeof s,"")),r=null}return t=Na(j,a,t,o),t.elementType=s,t.type=r,t.lanes=m,t}function Cn(s,t,a,r){return s=Na(7,s,r,t),s.lanes=a,s}function Ld(s,t,a){return s=Na(6,s,null,t),s.lanes=a,s}function nh(s){var t=Na(18,null,null,0);return t.stateNode=s,t}function Ud(s,t,a){return t=Na(4,s.children!==null?s.children:[],s.key,t),t.lanes=a,t.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},t}var rh=new WeakMap;function Ua(s,t){if(typeof s=="object"&&s!==null){var a=rh.get(s);return a!==void 0?a:(t={value:s,source:t,stack:Me(t)},rh.set(s,t),t)}return{value:s,source:t,stack:Me(t)}}var mr=[],xr=0,Tc=null,ii=0,$a=[],Ba=0,Pl=null,al=1,ll="";function pl(s,t){mr[xr++]=ii,mr[xr++]=Tc,Tc=s,ii=t}function ih(s,t,a){$a[Ba++]=al,$a[Ba++]=ll,$a[Ba++]=Pl,Pl=s;var r=al;s=ll;var o=32-bs(r)-1;r&=~(1<<o),a+=1;var m=32-bs(t)+o;if(30<m){var j=o-o%5;m=(r&(1<<j)-1).toString(32),r>>=j,o-=j,al=1<<32-bs(t)+o|a<<o|r,ll=m+s}else al=1<<m|a<<o|r,ll=s}function $d(s){s.return!==null&&(pl(s,1),ih(s,1,0))}function Bd(s){for(;s===Tc;)Tc=mr[--xr],mr[xr]=null,ii=mr[--xr],mr[xr]=null;for(;s===Pl;)Pl=$a[--Ba],$a[Ba]=null,ll=$a[--Ba],$a[Ba]=null,al=$a[--Ba],$a[Ba]=null}function ch(s,t){$a[Ba++]=al,$a[Ba++]=ll,$a[Ba++]=Pl,al=t.id,ll=t.overflow,Pl=s}var Gt=null,it=null,zs=!1,Hl=null,Ia=!1,Id=Error(c(519));function Fl(s){var t=Error(c(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ci(Ua(t,s)),Id}function oh(s){var t=s.stateNode,a=s.type,r=s.memoizedProps;switch(t[gs]=s,t[is]=r,a){case"dialog":Ss("cancel",t),Ss("close",t);break;case"iframe":case"object":case"embed":Ss("load",t);break;case"video":case"audio":for(a=0;a<Mi.length;a++)Ss(Mi[a],t);break;case"source":Ss("error",t);break;case"img":case"image":case"link":Ss("error",t),Ss("load",t);break;case"details":Ss("toggle",t);break;case"input":Ss("invalid",t),yx(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Ss("invalid",t);break;case"textarea":Ss("invalid",t),_x(t,r.value,r.defaultValue,r.children)}a=r.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||r.suppressHydrationWarning===!0||Cp(t.textContent,a)?(r.popover!=null&&(Ss("beforetoggle",t),Ss("toggle",t)),r.onScroll!=null&&Ss("scroll",t),r.onScrollEnd!=null&&Ss("scrollend",t),r.onClick!=null&&(t.onclick=xl),t=!0):t=!1,t||Fl(s,!0)}function dh(s){for(Gt=s.return;Gt;)switch(Gt.tag){case 5:case 31:case 13:Ia=!1;return;case 27:case 3:Ia=!0;return;default:Gt=Gt.return}}function hr(s){if(s!==Gt)return!1;if(!zs)return dh(s),zs=!0,!1;var t=s.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=s.type,a=!(a!=="form"&&a!=="button")||lm(s.type,s.memoizedProps)),a=!a),a&&it&&Fl(s),dh(s),t===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));it=Lp(s)}else if(t===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));it=Lp(s)}else t===27?(t=it,an(s.type)?(s=om,om=null,it=s):it=t):it=Gt?Ha(s.stateNode.nextSibling):null;return!0}function Tn(){it=Gt=null,zs=!1}function Pd(){var s=Hl;return s!==null&&(ha===null?ha=s:ha.push.apply(ha,s),Hl=null),s}function ci(s){Hl===null?Hl=[s]:Hl.push(s)}var Hd=_e(null),En=null,gl=null;function Gl(s,t,a){ke(Hd,t._currentValue),t._currentValue=a}function jl(s){s._currentValue=Hd.current,pe(Hd)}function Fd(s,t,a){for(;s!==null;){var r=s.alternate;if((s.childLanes&t)!==t?(s.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),s===a)break;s=s.return}}function Gd(s,t,a,r){var o=s.child;for(o!==null&&(o.return=s);o!==null;){var m=o.dependencies;if(m!==null){var j=o.child;m=m.firstContext;e:for(;m!==null;){var C=m;m=o;for(var $=0;$<t.length;$++)if(C.context===t[$]){m.lanes|=a,C=m.alternate,C!==null&&(C.lanes|=a),Fd(m.return,a,s),r||(j=null);break e}m=C.next}}else if(o.tag===18){if(j=o.return,j===null)throw Error(c(341));j.lanes|=a,m=j.alternate,m!==null&&(m.lanes|=a),Fd(j,a,s),j=null}else j=o.child;if(j!==null)j.return=o;else for(j=o;j!==null;){if(j===s){j=null;break}if(o=j.sibling,o!==null){o.return=j.return,j=o;break}j=j.return}o=j}}function fr(s,t,a,r){s=null;for(var o=t,m=!1;o!==null;){if(!m){if((o.flags&524288)!==0)m=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var j=o.alternate;if(j===null)throw Error(c(387));if(j=j.memoizedProps,j!==null){var C=o.type;va(o.pendingProps.value,j.value)||(s!==null?s.push(C):s=[C])}}else if(o===se.current){if(j=o.alternate,j===null)throw Error(c(387));j.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(s!==null?s.push(Ri):s=[Ri])}o=o.return}s!==null&&Gd(t,s,a,r),t.flags|=262144}function Ec(s){for(s=s.firstContext;s!==null;){if(!va(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Mn(s){En=s,gl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Vt(s){return uh(En,s)}function Mc(s,t){return En===null&&Mn(s),uh(s,t)}function uh(s,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},gl===null){if(s===null)throw Error(c(308));gl=t,s.dependencies={lanes:0,firstContext:t},s.flags|=524288}else gl=gl.next=t;return a}var ay=typeof AbortController<"u"?AbortController:function(){var s=[],t=this.signal={aborted:!1,addEventListener:function(a,r){s.push(r)}};this.abort=function(){t.aborted=!0,s.forEach(function(a){return a()})}},ly=l.unstable_scheduleCallback,ny=l.unstable_NormalPriority,Mt={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vd(){return{controller:new ay,data:new Map,refCount:0}}function oi(s){s.refCount--,s.refCount===0&&ly(ny,function(){s.controller.abort()})}var di=null,qd=0,pr=0,gr=null;function ry(s,t){if(di===null){var a=di=[];qd=0,pr=Yu(),gr={status:"pending",value:void 0,then:function(r){a.push(r)}}}return qd++,t.then(mh,mh),t}function mh(){if(--qd===0&&di!==null){gr!==null&&(gr.status="fulfilled");var s=di;di=null,pr=0,gr=null;for(var t=0;t<s.length;t++)(0,s[t])()}}function iy(s,t){var a=[],r={status:"pending",value:null,reason:null,then:function(o){a.push(o)}};return s.then(function(){r.status="fulfilled",r.value=t;for(var o=0;o<a.length;o++)(0,a[o])(t)},function(o){for(r.status="rejected",r.reason=o,o=0;o<a.length;o++)(0,a[o])(void 0)}),r}var xh=z.S;z.S=function(s,t){Xf=mt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&ry(s,t),xh!==null&&xh(s,t)};var zn=_e(null);function Kd(){var s=zn.current;return s!==null?s:Ws.pooledCache}function zc(s,t){t===null?ke(zn,zn.current):ke(zn,t.pool)}function hh(){var s=Kd();return s===null?null:{parent:Mt._currentValue,pool:s}}var jr=Error(c(460)),Qd=Error(c(474)),Ac=Error(c(542)),Oc={then:function(){}};function fh(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ph(s,t,a){switch(a=s[a],a===void 0?s.push(t):a!==t&&(t.then(xl,xl),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,jh(s),s;default:if(typeof t.status=="string")t.then(xl,xl);else{if(s=Ws,s!==null&&100<s.shellSuspendCounter)throw Error(c(482));s=t,s.status="pending",s.then(function(r){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=r}},function(r){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw s=t.reason,jh(s),s}throw On=t,jr}}function An(s){try{var t=s._init;return t(s._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(On=a,jr):a}}var On=null;function gh(){if(On===null)throw Error(c(459));var s=On;return On=null,s}function jh(s){if(s===jr||s===Ac)throw Error(c(483))}var vr=null,ui=0;function Dc(s){var t=ui;return ui+=1,vr===null&&(vr=[]),ph(vr,s,t)}function mi(s,t){t=t.props.ref,s.ref=t!==void 0?t:null}function Rc(s,t){throw t.$$typeof===y?Error(c(525)):(s=Object.prototype.toString.call(t),Error(c(31,s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)))}function vh(s){function t(Y,G){if(s){var te=Y.deletions;te===null?(Y.deletions=[G],Y.flags|=16):te.push(G)}}function a(Y,G){if(!s)return null;for(;G!==null;)t(Y,G),G=G.sibling;return null}function r(Y){for(var G=new Map;Y!==null;)Y.key!==null?G.set(Y.key,Y):G.set(Y.index,Y),Y=Y.sibling;return G}function o(Y,G){return Y=fl(Y,G),Y.index=0,Y.sibling=null,Y}function m(Y,G,te){return Y.index=te,s?(te=Y.alternate,te!==null?(te=te.index,te<G?(Y.flags|=67108866,G):te):(Y.flags|=67108866,G)):(Y.flags|=1048576,G)}function j(Y){return s&&Y.alternate===null&&(Y.flags|=67108866),Y}function C(Y,G,te,Ne){return G===null||G.tag!==6?(G=Ld(te,Y.mode,Ne),G.return=Y,G):(G=o(G,te),G.return=Y,G)}function $(Y,G,te,Ne){var Qe=te.type;return Qe===R?ge(Y,G,te.props.children,Ne,te.key):G!==null&&(G.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===J&&An(Qe)===G.type)?(G=o(G,te.props),mi(G,te),G.return=Y,G):(G=Cc(te.type,te.key,te.props,null,Y.mode,Ne),mi(G,te),G.return=Y,G)}function ae(Y,G,te,Ne){return G===null||G.tag!==4||G.stateNode.containerInfo!==te.containerInfo||G.stateNode.implementation!==te.implementation?(G=Ud(te,Y.mode,Ne),G.return=Y,G):(G=o(G,te.children||[]),G.return=Y,G)}function ge(Y,G,te,Ne,Qe){return G===null||G.tag!==7?(G=Cn(te,Y.mode,Ne,Qe),G.return=Y,G):(G=o(G,te),G.return=Y,G)}function be(Y,G,te){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Ld(""+G,Y.mode,te),G.return=Y,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case w:return te=Cc(G.type,G.key,G.props,null,Y.mode,te),mi(te,G),te.return=Y,te;case b:return G=Ud(G,Y.mode,te),G.return=Y,G;case J:return G=An(G),be(Y,G,te)}if(je(G)||he(G))return G=Cn(G,Y.mode,te,null),G.return=Y,G;if(typeof G.then=="function")return be(Y,Dc(G),te);if(G.$$typeof===M)return be(Y,Mc(Y,G),te);Rc(Y,G)}return null}function ce(Y,G,te,Ne){var Qe=G!==null?G.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Qe!==null?null:C(Y,G,""+te,Ne);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case w:return te.key===Qe?$(Y,G,te,Ne):null;case b:return te.key===Qe?ae(Y,G,te,Ne):null;case J:return te=An(te),ce(Y,G,te,Ne)}if(je(te)||he(te))return Qe!==null?null:ge(Y,G,te,Ne,null);if(typeof te.then=="function")return ce(Y,G,Dc(te),Ne);if(te.$$typeof===M)return ce(Y,G,Mc(Y,te),Ne);Rc(Y,te)}return null}function me(Y,G,te,Ne,Qe){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return Y=Y.get(te)||null,C(G,Y,""+Ne,Qe);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case w:return Y=Y.get(Ne.key===null?te:Ne.key)||null,$(G,Y,Ne,Qe);case b:return Y=Y.get(Ne.key===null?te:Ne.key)||null,ae(G,Y,Ne,Qe);case J:return Ne=An(Ne),me(Y,G,te,Ne,Qe)}if(je(Ne)||he(Ne))return Y=Y.get(te)||null,ge(G,Y,Ne,Qe,null);if(typeof Ne.then=="function")return me(Y,G,te,Dc(Ne),Qe);if(Ne.$$typeof===M)return me(Y,G,te,Mc(G,Ne),Qe);Rc(G,Ne)}return null}function He(Y,G,te,Ne){for(var Qe=null,Us=null,Ge=G,os=G=0,Es=null;Ge!==null&&os<te.length;os++){Ge.index>os?(Es=Ge,Ge=null):Es=Ge.sibling;var $s=ce(Y,Ge,te[os],Ne);if($s===null){Ge===null&&(Ge=Es);break}s&&Ge&&$s.alternate===null&&t(Y,Ge),G=m($s,G,os),Us===null?Qe=$s:Us.sibling=$s,Us=$s,Ge=Es}if(os===te.length)return a(Y,Ge),zs&&pl(Y,os),Qe;if(Ge===null){for(;os<te.length;os++)Ge=be(Y,te[os],Ne),Ge!==null&&(G=m(Ge,G,os),Us===null?Qe=Ge:Us.sibling=Ge,Us=Ge);return zs&&pl(Y,os),Qe}for(Ge=r(Ge);os<te.length;os++)Es=me(Ge,Y,os,te[os],Ne),Es!==null&&(s&&Es.alternate!==null&&Ge.delete(Es.key===null?os:Es.key),G=m(Es,G,os),Us===null?Qe=Es:Us.sibling=Es,Us=Es);return s&&Ge.forEach(function(on){return t(Y,on)}),zs&&pl(Y,os),Qe}function Xe(Y,G,te,Ne){if(te==null)throw Error(c(151));for(var Qe=null,Us=null,Ge=G,os=G=0,Es=null,$s=te.next();Ge!==null&&!$s.done;os++,$s=te.next()){Ge.index>os?(Es=Ge,Ge=null):Es=Ge.sibling;var on=ce(Y,Ge,$s.value,Ne);if(on===null){Ge===null&&(Ge=Es);break}s&&Ge&&on.alternate===null&&t(Y,Ge),G=m(on,G,os),Us===null?Qe=on:Us.sibling=on,Us=on,Ge=Es}if($s.done)return a(Y,Ge),zs&&pl(Y,os),Qe;if(Ge===null){for(;!$s.done;os++,$s=te.next())$s=be(Y,$s.value,Ne),$s!==null&&(G=m($s,G,os),Us===null?Qe=$s:Us.sibling=$s,Us=$s);return zs&&pl(Y,os),Qe}for(Ge=r(Ge);!$s.done;os++,$s=te.next())$s=me(Ge,Y,os,$s.value,Ne),$s!==null&&(s&&$s.alternate!==null&&Ge.delete($s.key===null?os:$s.key),G=m($s,G,os),Us===null?Qe=$s:Us.sibling=$s,Us=$s);return s&&Ge.forEach(function(j0){return t(Y,j0)}),zs&&pl(Y,os),Qe}function Xs(Y,G,te,Ne){if(typeof te=="object"&&te!==null&&te.type===R&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case w:e:{for(var Qe=te.key;G!==null;){if(G.key===Qe){if(Qe=te.type,Qe===R){if(G.tag===7){a(Y,G.sibling),Ne=o(G,te.props.children),Ne.return=Y,Y=Ne;break e}}else if(G.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===J&&An(Qe)===G.type){a(Y,G.sibling),Ne=o(G,te.props),mi(Ne,te),Ne.return=Y,Y=Ne;break e}a(Y,G);break}else t(Y,G);G=G.sibling}te.type===R?(Ne=Cn(te.props.children,Y.mode,Ne,te.key),Ne.return=Y,Y=Ne):(Ne=Cc(te.type,te.key,te.props,null,Y.mode,Ne),mi(Ne,te),Ne.return=Y,Y=Ne)}return j(Y);case b:e:{for(Qe=te.key;G!==null;){if(G.key===Qe)if(G.tag===4&&G.stateNode.containerInfo===te.containerInfo&&G.stateNode.implementation===te.implementation){a(Y,G.sibling),Ne=o(G,te.children||[]),Ne.return=Y,Y=Ne;break e}else{a(Y,G);break}else t(Y,G);G=G.sibling}Ne=Ud(te,Y.mode,Ne),Ne.return=Y,Y=Ne}return j(Y);case J:return te=An(te),Xs(Y,G,te,Ne)}if(je(te))return He(Y,G,te,Ne);if(he(te)){if(Qe=he(te),typeof Qe!="function")throw Error(c(150));return te=Qe.call(te),Xe(Y,G,te,Ne)}if(typeof te.then=="function")return Xs(Y,G,Dc(te),Ne);if(te.$$typeof===M)return Xs(Y,G,Mc(Y,te),Ne);Rc(Y,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,G!==null&&G.tag===6?(a(Y,G.sibling),Ne=o(G,te),Ne.return=Y,Y=Ne):(a(Y,G),Ne=Ld(te,Y.mode,Ne),Ne.return=Y,Y=Ne),j(Y)):a(Y,G)}return function(Y,G,te,Ne){try{ui=0;var Qe=Xs(Y,G,te,Ne);return vr=null,Qe}catch(Ge){if(Ge===jr||Ge===Ac)throw Ge;var Us=Na(29,Ge,null,Y.mode);return Us.lanes=Ne,Us.return=Y,Us}finally{}}}var Dn=vh(!0),Nh=vh(!1),Vl=!1;function Yd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jd(s,t){s=s.updateQueue,t.updateQueue===s&&(t.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ql(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Kl(s,t,a){var r=s.updateQueue;if(r===null)return null;if(r=r.shared,(Ps&2)!==0){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,t=kc(s),ah(s,null,a),t}return Sc(s,r,t,a),kc(s)}function xi(s,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var r=t.lanes;r&=s.pendingLanes,a|=r,t.lanes=a,Wt(s,a)}}function Xd(s,t){var a=s.updateQueue,r=s.alternate;if(r!==null&&(r=r.updateQueue,a===r)){var o=null,m=null;if(a=a.firstBaseUpdate,a!==null){do{var j={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};m===null?o=m=j:m=m.next=j,a=a.next}while(a!==null);m===null?o=m=t:m=m.next=t}else o=m=t;a={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:m,shared:r.shared,callbacks:r.callbacks},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=t:s.next=t,a.lastBaseUpdate=t}var Zd=!1;function hi(){if(Zd){var s=gr;if(s!==null)throw s}}function fi(s,t,a,r){Zd=!1;var o=s.updateQueue;Vl=!1;var m=o.firstBaseUpdate,j=o.lastBaseUpdate,C=o.shared.pending;if(C!==null){o.shared.pending=null;var $=C,ae=$.next;$.next=null,j===null?m=ae:j.next=ae,j=$;var ge=s.alternate;ge!==null&&(ge=ge.updateQueue,C=ge.lastBaseUpdate,C!==j&&(C===null?ge.firstBaseUpdate=ae:C.next=ae,ge.lastBaseUpdate=$))}if(m!==null){var be=o.baseState;j=0,ge=ae=$=null,C=m;do{var ce=C.lane&-536870913,me=ce!==C.lane;if(me?(Ts&ce)===ce:(r&ce)===ce){ce!==0&&ce===pr&&(Zd=!0),ge!==null&&(ge=ge.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var He=s,Xe=C;ce=t;var Xs=a;switch(Xe.tag){case 1:if(He=Xe.payload,typeof He=="function"){be=He.call(Xs,be,ce);break e}be=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=Xe.payload,ce=typeof He=="function"?He.call(Xs,be,ce):He,ce==null)break e;be=v({},be,ce);break e;case 2:Vl=!0}}ce=C.callback,ce!==null&&(s.flags|=64,me&&(s.flags|=8192),me=o.callbacks,me===null?o.callbacks=[ce]:me.push(ce))}else me={lane:ce,tag:C.tag,payload:C.payload,callback:C.callback,next:null},ge===null?(ae=ge=me,$=be):ge=ge.next=me,j|=ce;if(C=C.next,C===null){if(C=o.shared.pending,C===null)break;me=C,C=me.next,me.next=null,o.lastBaseUpdate=me,o.shared.pending=null}}while(!0);ge===null&&($=be),o.baseState=$,o.firstBaseUpdate=ae,o.lastBaseUpdate=ge,m===null&&(o.shared.lanes=0),Zl|=j,s.lanes=j,s.memoizedState=be}}function bh(s,t){if(typeof s!="function")throw Error(c(191,s));s.call(t)}function yh(s,t){var a=s.callbacks;if(a!==null)for(s.callbacks=null,s=0;s<a.length;s++)bh(a[s],t)}var Nr=_e(null),Lc=_e(0);function wh(s,t){s=Cl,ke(Lc,s),ke(Nr,t),Cl=s|t.baseLanes}function Wd(){ke(Lc,Cl),ke(Nr,Nr.current)}function eu(){Cl=Lc.current,pe(Nr),pe(Lc)}var ba=_e(null),Pa=null;function Ql(s){var t=s.alternate;ke(St,St.current&1),ke(ba,s),Pa===null&&(t===null||Nr.current!==null||t.memoizedState!==null)&&(Pa=s)}function su(s){ke(St,St.current),ke(ba,s),Pa===null&&(Pa=s)}function _h(s){s.tag===22?(ke(St,St.current),ke(ba,s),Pa===null&&(Pa=s)):Yl()}function Yl(){ke(St,St.current),ke(ba,ba.current)}function ya(s){pe(ba),Pa===s&&(Pa=null),pe(St)}var St=_e(0);function Uc(s){for(var t=s;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||im(a)||cm(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vl=0,cs=null,Ys=null,zt=null,$c=!1,br=!1,Rn=!1,Bc=0,pi=0,yr=null,cy=0;function vt(){throw Error(c(321))}function tu(s,t){if(t===null)return!1;for(var a=0;a<t.length&&a<s.length;a++)if(!va(s[a],t[a]))return!1;return!0}function au(s,t,a,r,o,m){return vl=m,cs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,z.H=s===null||s.memoizedState===null?cf:ju,Rn=!1,m=a(r,o),Rn=!1,br&&(m=kh(t,a,r,o)),Sh(s),m}function Sh(s){z.H=vi;var t=Ys!==null&&Ys.next!==null;if(vl=0,zt=Ys=cs=null,$c=!1,pi=0,yr=null,t)throw Error(c(300));s===null||At||(s=s.dependencies,s!==null&&Ec(s)&&(At=!0))}function kh(s,t,a,r){cs=s;var o=0;do{if(br&&(yr=null),pi=0,br=!1,25<=o)throw Error(c(301));if(o+=1,zt=Ys=null,s.updateQueue!=null){var m=s.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}z.H=of,m=t(a,r)}while(br);return m}function oy(){var s=z.H,t=s.useState()[0];return t=typeof t.then=="function"?gi(t):t,s=s.useState()[0],(Ys!==null?Ys.memoizedState:null)!==s&&(cs.flags|=1024),t}function lu(){var s=Bc!==0;return Bc=0,s}function nu(s,t,a){t.updateQueue=s.updateQueue,t.flags&=-2053,s.lanes&=~a}function ru(s){if($c){for(s=s.memoizedState;s!==null;){var t=s.queue;t!==null&&(t.pending=null),s=s.next}$c=!1}vl=0,zt=Ys=cs=null,br=!1,pi=Bc=0,yr=null}function la(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?cs.memoizedState=zt=s:zt=zt.next=s,zt}function kt(){if(Ys===null){var s=cs.alternate;s=s!==null?s.memoizedState:null}else s=Ys.next;var t=zt===null?cs.memoizedState:zt.next;if(t!==null)zt=t,Ys=s;else{if(s===null)throw cs.alternate===null?Error(c(467)):Error(c(310));Ys=s,s={memoizedState:Ys.memoizedState,baseState:Ys.baseState,baseQueue:Ys.baseQueue,queue:Ys.queue,next:null},zt===null?cs.memoizedState=zt=s:zt=zt.next=s}return zt}function Ic(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gi(s){var t=pi;return pi+=1,yr===null&&(yr=[]),s=ph(yr,s,t),t=cs,(zt===null?t.memoizedState:zt.next)===null&&(t=t.alternate,z.H=t===null||t.memoizedState===null?cf:ju),s}function Pc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return gi(s);if(s.$$typeof===M)return Vt(s)}throw Error(c(438,String(s)))}function iu(s){var t=null,a=cs.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var r=cs.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=Ic(),cs.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(s),r=0;r<s;r++)a[r]=ue;return t.index++,a}function Nl(s,t){return typeof t=="function"?t(s):t}function Hc(s){var t=kt();return cu(t,Ys,s)}function cu(s,t,a){var r=s.queue;if(r===null)throw Error(c(311));r.lastRenderedReducer=a;var o=s.baseQueue,m=r.pending;if(m!==null){if(o!==null){var j=o.next;o.next=m.next,m.next=j}t.baseQueue=o=m,r.pending=null}if(m=s.baseState,o===null)s.memoizedState=m;else{t=o.next;var C=j=null,$=null,ae=t,ge=!1;do{var be=ae.lane&-536870913;if(be!==ae.lane?(Ts&be)===be:(vl&be)===be){var ce=ae.revertLane;if(ce===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),be===pr&&(ge=!0);else if((vl&ce)===ce){ae=ae.next,ce===pr&&(ge=!0);continue}else be={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},$===null?(C=$=be,j=m):$=$.next=be,cs.lanes|=ce,Zl|=ce;be=ae.action,Rn&&a(m,be),m=ae.hasEagerState?ae.eagerState:a(m,be)}else ce={lane:be,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},$===null?(C=$=ce,j=m):$=$.next=ce,cs.lanes|=be,Zl|=be;ae=ae.next}while(ae!==null&&ae!==t);if($===null?j=m:$.next=C,!va(m,s.memoizedState)&&(At=!0,ge&&(a=gr,a!==null)))throw a;s.memoizedState=m,s.baseState=j,s.baseQueue=$,r.lastRenderedState=m}return o===null&&(r.lanes=0),[s.memoizedState,r.dispatch]}function ou(s){var t=kt(),a=t.queue;if(a===null)throw Error(c(311));a.lastRenderedReducer=s;var r=a.dispatch,o=a.pending,m=t.memoizedState;if(o!==null){a.pending=null;var j=o=o.next;do m=s(m,j.action),j=j.next;while(j!==o);va(m,t.memoizedState)||(At=!0),t.memoizedState=m,t.baseQueue===null&&(t.baseState=m),a.lastRenderedState=m}return[m,r]}function Ch(s,t,a){var r=cs,o=kt(),m=zs;if(m){if(a===void 0)throw Error(c(407));a=a()}else a=t();var j=!va((Ys||o).memoizedState,a);if(j&&(o.memoizedState=a,At=!0),o=o.queue,mu(Mh.bind(null,r,o,s),[s]),o.getSnapshot!==t||j||zt!==null&&zt.memoizedState.tag&1){if(r.flags|=2048,wr(9,{destroy:void 0},Eh.bind(null,r,o,a,t),null),Ws===null)throw Error(c(349));m||(vl&127)!==0||Th(r,t,a)}return a}function Th(s,t,a){s.flags|=16384,s={getSnapshot:t,value:a},t=cs.updateQueue,t===null?(t=Ic(),cs.updateQueue=t,t.stores=[s]):(a=t.stores,a===null?t.stores=[s]:a.push(s))}function Eh(s,t,a,r){t.value=a,t.getSnapshot=r,zh(t)&&Ah(s)}function Mh(s,t,a){return a(function(){zh(t)&&Ah(s)})}function zh(s){var t=s.getSnapshot;s=s.value;try{var a=t();return!va(s,a)}catch{return!0}}function Ah(s){var t=kn(s,2);t!==null&&fa(t,s,2)}function du(s){var t=la();if(typeof s=="function"){var a=s;if(s=a(),Rn){es(!0);try{a()}finally{es(!1)}}}return t.memoizedState=t.baseState=s,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nl,lastRenderedState:s},t}function Oh(s,t,a,r){return s.baseState=a,cu(s,Ys,typeof r=="function"?r:Nl)}function dy(s,t,a,r,o){if(Vc(s))throw Error(c(485));if(s=t.action,s!==null){var m={payload:o,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){m.listeners.push(j)}};z.T!==null?a(!0):m.isTransition=!1,r(m),a=t.pending,a===null?(m.next=t.pending=m,Dh(t,m)):(m.next=a.next,t.pending=a.next=m)}}function Dh(s,t){var a=t.action,r=t.payload,o=s.state;if(t.isTransition){var m=z.T,j={};z.T=j;try{var C=a(o,r),$=z.S;$!==null&&$(j,C),Rh(s,t,C)}catch(ae){uu(s,t,ae)}finally{m!==null&&j.types!==null&&(m.types=j.types),z.T=m}}else try{m=a(o,r),Rh(s,t,m)}catch(ae){uu(s,t,ae)}}function Rh(s,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(r){Lh(s,t,r)},function(r){return uu(s,t,r)}):Lh(s,t,a)}function Lh(s,t,a){t.status="fulfilled",t.value=a,Uh(t),s.state=a,t=s.pending,t!==null&&(a=t.next,a===t?s.pending=null:(a=a.next,t.next=a,Dh(s,a)))}function uu(s,t,a){var r=s.pending;if(s.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=a,Uh(t),t=t.next;while(t!==r)}s.action=null}function Uh(s){s=s.listeners;for(var t=0;t<s.length;t++)(0,s[t])()}function $h(s,t){return t}function Bh(s,t){if(zs){var a=Ws.formState;if(a!==null){e:{var r=cs;if(zs){if(it){s:{for(var o=it,m=Ia;o.nodeType!==8;){if(!m){o=null;break s}if(o=Ha(o.nextSibling),o===null){o=null;break s}}m=o.data,o=m==="F!"||m==="F"?o:null}if(o){it=Ha(o.nextSibling),r=o.data==="F!";break e}}Fl(r)}r=!1}r&&(t=a[0])}}return a=la(),a.memoizedState=a.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$h,lastRenderedState:t},a.queue=r,a=lf.bind(null,cs,r),r.dispatch=a,r=du(!1),m=gu.bind(null,cs,!1,r.queue),r=la(),o={state:t,dispatch:null,action:s,pending:null},r.queue=o,a=dy.bind(null,cs,o,m,a),o.dispatch=a,r.memoizedState=s,[t,a,!1]}function Ih(s){var t=kt();return Ph(t,Ys,s)}function Ph(s,t,a){if(t=cu(s,t,$h)[0],s=Hc(Nl)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=gi(t)}catch(j){throw j===jr?Ac:j}else r=t;t=kt();var o=t.queue,m=o.dispatch;return a!==t.memoizedState&&(cs.flags|=2048,wr(9,{destroy:void 0},uy.bind(null,o,a),null)),[r,m,s]}function uy(s,t){s.action=t}function Hh(s){var t=kt(),a=Ys;if(a!==null)return Ph(t,a,s);kt(),t=t.memoizedState,a=kt();var r=a.queue.dispatch;return a.memoizedState=s,[t,r,!1]}function wr(s,t,a,r){return s={tag:s,create:a,deps:r,inst:t,next:null},t=cs.updateQueue,t===null&&(t=Ic(),cs.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=s.next=s:(r=a.next,a.next=s,s.next=r,t.lastEffect=s),s}function Fh(){return kt().memoizedState}function Fc(s,t,a,r){var o=la();cs.flags|=s,o.memoizedState=wr(1|t,{destroy:void 0},a,r===void 0?null:r)}function Gc(s,t,a,r){var o=kt();r=r===void 0?null:r;var m=o.memoizedState.inst;Ys!==null&&r!==null&&tu(r,Ys.memoizedState.deps)?o.memoizedState=wr(t,m,a,r):(cs.flags|=s,o.memoizedState=wr(1|t,m,a,r))}function Gh(s,t){Fc(8390656,8,s,t)}function mu(s,t){Gc(2048,8,s,t)}function my(s){cs.flags|=4;var t=cs.updateQueue;if(t===null)t=Ic(),cs.updateQueue=t,t.events=[s];else{var a=t.events;a===null?t.events=[s]:a.push(s)}}function Vh(s){var t=kt().memoizedState;return my({ref:t,nextImpl:s}),function(){if((Ps&2)!==0)throw Error(c(440));return t.impl.apply(void 0,arguments)}}function qh(s,t){return Gc(4,2,s,t)}function Kh(s,t){return Gc(4,4,s,t)}function Qh(s,t){if(typeof t=="function"){s=s();var a=t(s);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return s=s(),t.current=s,function(){t.current=null}}function Yh(s,t,a){a=a!=null?a.concat([s]):null,Gc(4,4,Qh.bind(null,t,s),a)}function xu(){}function Jh(s,t){var a=kt();t=t===void 0?null:t;var r=a.memoizedState;return t!==null&&tu(t,r[1])?r[0]:(a.memoizedState=[s,t],s)}function Xh(s,t){var a=kt();t=t===void 0?null:t;var r=a.memoizedState;if(t!==null&&tu(t,r[1]))return r[0];if(r=s(),Rn){es(!0);try{s()}finally{es(!1)}}return a.memoizedState=[r,t],r}function hu(s,t,a){return a===void 0||(vl&1073741824)!==0&&(Ts&261930)===0?s.memoizedState=t:(s.memoizedState=a,s=Wf(),cs.lanes|=s,Zl|=s,a)}function Zh(s,t,a,r){return va(a,t)?a:Nr.current!==null?(s=hu(s,a,r),va(s,t)||(At=!0),s):(vl&42)===0||(vl&1073741824)!==0&&(Ts&261930)===0?(At=!0,s.memoizedState=a):(s=Wf(),cs.lanes|=s,Zl|=s,t)}function Wh(s,t,a,r,o){var m=V.p;V.p=m!==0&&8>m?m:8;var j=z.T,C={};z.T=C,gu(s,!1,t,a);try{var $=o(),ae=z.S;if(ae!==null&&ae(C,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var ge=iy($,r);ji(s,t,ge,Sa(s))}else ji(s,t,r,Sa(s))}catch(be){ji(s,t,{then:function(){},status:"rejected",reason:be},Sa())}finally{V.p=m,j!==null&&C.types!==null&&(j.types=C.types),z.T=j}}function xy(){}function fu(s,t,a,r){if(s.tag!==5)throw Error(c(476));var o=ef(s).queue;Wh(s,o,t,B,a===null?xy:function(){return sf(s),a(r)})}function ef(s){var t=s.memoizedState;if(t!==null)return t;t={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nl,lastRenderedState:B},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nl,lastRenderedState:a},next:null},s.memoizedState=t,s=s.alternate,s!==null&&(s.memoizedState=t),t}function sf(s){var t=ef(s);t.next===null&&(t=s.alternate.memoizedState),ji(s,t.next.queue,{},Sa())}function pu(){return Vt(Ri)}function tf(){return kt().memoizedState}function af(){return kt().memoizedState}function hy(s){for(var t=s.return;t!==null;){switch(t.tag){case 24:case 3:var a=Sa();s=ql(a);var r=Kl(t,s,a);r!==null&&(fa(r,t,a),xi(r,t,a)),t={cache:Vd()},s.payload=t;return}t=t.return}}function fy(s,t,a){var r=Sa();a={lane:r,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Vc(s)?nf(t,a):(a=Dd(s,t,a,r),a!==null&&(fa(a,s,r),rf(a,t,r)))}function lf(s,t,a){var r=Sa();ji(s,t,a,r)}function ji(s,t,a,r){var o={lane:r,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Vc(s))nf(t,o);else{var m=s.alternate;if(s.lanes===0&&(m===null||m.lanes===0)&&(m=t.lastRenderedReducer,m!==null))try{var j=t.lastRenderedState,C=m(j,a);if(o.hasEagerState=!0,o.eagerState=C,va(C,j))return Sc(s,t,o,0),Ws===null&&_c(),!1}catch{}finally{}if(a=Dd(s,t,o,r),a!==null)return fa(a,s,r),rf(a,t,r),!0}return!1}function gu(s,t,a,r){if(r={lane:2,revertLane:Yu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Vc(s)){if(t)throw Error(c(479))}else t=Dd(s,a,r,2),t!==null&&fa(t,s,2)}function Vc(s){var t=s.alternate;return s===cs||t!==null&&t===cs}function nf(s,t){br=$c=!0;var a=s.pending;a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t}function rf(s,t,a){if((a&4194048)!==0){var r=t.lanes;r&=s.pendingLanes,a|=r,t.lanes=a,Wt(s,a)}}var vi={readContext:Vt,use:Pc,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useLayoutEffect:vt,useInsertionEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useSyncExternalStore:vt,useId:vt,useHostTransitionStatus:vt,useFormState:vt,useActionState:vt,useOptimistic:vt,useMemoCache:vt,useCacheRefresh:vt};vi.useEffectEvent=vt;var cf={readContext:Vt,use:Pc,useCallback:function(s,t){return la().memoizedState=[s,t===void 0?null:t],s},useContext:Vt,useEffect:Gh,useImperativeHandle:function(s,t,a){a=a!=null?a.concat([s]):null,Fc(4194308,4,Qh.bind(null,t,s),a)},useLayoutEffect:function(s,t){return Fc(4194308,4,s,t)},useInsertionEffect:function(s,t){Fc(4,2,s,t)},useMemo:function(s,t){var a=la();t=t===void 0?null:t;var r=s();if(Rn){es(!0);try{s()}finally{es(!1)}}return a.memoizedState=[r,t],r},useReducer:function(s,t,a){var r=la();if(a!==void 0){var o=a(t);if(Rn){es(!0);try{a(t)}finally{es(!1)}}}else o=t;return r.memoizedState=r.baseState=o,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},r.queue=s,s=s.dispatch=fy.bind(null,cs,s),[r.memoizedState,s]},useRef:function(s){var t=la();return s={current:s},t.memoizedState=s},useState:function(s){s=du(s);var t=s.queue,a=lf.bind(null,cs,t);return t.dispatch=a,[s.memoizedState,a]},useDebugValue:xu,useDeferredValue:function(s,t){var a=la();return hu(a,s,t)},useTransition:function(){var s=du(!1);return s=Wh.bind(null,cs,s.queue,!0,!1),la().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,t,a){var r=cs,o=la();if(zs){if(a===void 0)throw Error(c(407));a=a()}else{if(a=t(),Ws===null)throw Error(c(349));(Ts&127)!==0||Th(r,t,a)}o.memoizedState=a;var m={value:a,getSnapshot:t};return o.queue=m,Gh(Mh.bind(null,r,m,s),[s]),r.flags|=2048,wr(9,{destroy:void 0},Eh.bind(null,r,m,a,t),null),a},useId:function(){var s=la(),t=Ws.identifierPrefix;if(zs){var a=ll,r=al;a=(r&~(1<<32-bs(r)-1)).toString(32)+a,t="_"+t+"R_"+a,a=Bc++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=cy++,t="_"+t+"r_"+a.toString(32)+"_";return s.memoizedState=t},useHostTransitionStatus:pu,useFormState:Bh,useActionState:Bh,useOptimistic:function(s){var t=la();t.memoizedState=t.baseState=s;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=gu.bind(null,cs,!0,a),a.dispatch=t,[s,t]},useMemoCache:iu,useCacheRefresh:function(){return la().memoizedState=hy.bind(null,cs)},useEffectEvent:function(s){var t=la(),a={impl:s};return t.memoizedState=a,function(){if((Ps&2)!==0)throw Error(c(440));return a.impl.apply(void 0,arguments)}}},ju={readContext:Vt,use:Pc,useCallback:Jh,useContext:Vt,useEffect:mu,useImperativeHandle:Yh,useInsertionEffect:qh,useLayoutEffect:Kh,useMemo:Xh,useReducer:Hc,useRef:Fh,useState:function(){return Hc(Nl)},useDebugValue:xu,useDeferredValue:function(s,t){var a=kt();return Zh(a,Ys.memoizedState,s,t)},useTransition:function(){var s=Hc(Nl)[0],t=kt().memoizedState;return[typeof s=="boolean"?s:gi(s),t]},useSyncExternalStore:Ch,useId:tf,useHostTransitionStatus:pu,useFormState:Ih,useActionState:Ih,useOptimistic:function(s,t){var a=kt();return Oh(a,Ys,s,t)},useMemoCache:iu,useCacheRefresh:af};ju.useEffectEvent=Vh;var of={readContext:Vt,use:Pc,useCallback:Jh,useContext:Vt,useEffect:mu,useImperativeHandle:Yh,useInsertionEffect:qh,useLayoutEffect:Kh,useMemo:Xh,useReducer:ou,useRef:Fh,useState:function(){return ou(Nl)},useDebugValue:xu,useDeferredValue:function(s,t){var a=kt();return Ys===null?hu(a,s,t):Zh(a,Ys.memoizedState,s,t)},useTransition:function(){var s=ou(Nl)[0],t=kt().memoizedState;return[typeof s=="boolean"?s:gi(s),t]},useSyncExternalStore:Ch,useId:tf,useHostTransitionStatus:pu,useFormState:Hh,useActionState:Hh,useOptimistic:function(s,t){var a=kt();return Ys!==null?Oh(a,Ys,s,t):(a.baseState=s,[s,a.queue.dispatch])},useMemoCache:iu,useCacheRefresh:af};of.useEffectEvent=Vh;function vu(s,t,a,r){t=s.memoizedState,a=a(r,t),a=a==null?t:v({},t,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Nu={enqueueSetState:function(s,t,a){s=s._reactInternals;var r=Sa(),o=ql(r);o.payload=t,a!=null&&(o.callback=a),t=Kl(s,o,r),t!==null&&(fa(t,s,r),xi(t,s,r))},enqueueReplaceState:function(s,t,a){s=s._reactInternals;var r=Sa(),o=ql(r);o.tag=1,o.payload=t,a!=null&&(o.callback=a),t=Kl(s,o,r),t!==null&&(fa(t,s,r),xi(t,s,r))},enqueueForceUpdate:function(s,t){s=s._reactInternals;var a=Sa(),r=ql(a);r.tag=2,t!=null&&(r.callback=t),t=Kl(s,r,a),t!==null&&(fa(t,s,a),xi(t,s,a))}};function df(s,t,a,r,o,m,j){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(r,m,j):t.prototype&&t.prototype.isPureReactComponent?!ni(a,r)||!ni(o,m):!0}function uf(s,t,a,r){s=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,r),t.state!==s&&Nu.enqueueReplaceState(t,t.state,null)}function Ln(s,t){var a=t;if("ref"in t){a={};for(var r in t)r!=="ref"&&(a[r]=t[r])}if(s=s.defaultProps){a===t&&(a=v({},a));for(var o in s)a[o]===void 0&&(a[o]=s[o])}return a}function mf(s){wc(s)}function xf(s){console.error(s)}function hf(s){wc(s)}function qc(s,t){try{var a=s.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function ff(s,t,a){try{var r=s.onCaughtError;r(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function bu(s,t,a){return a=ql(a),a.tag=3,a.payload={element:null},a.callback=function(){qc(s,t)},a}function pf(s){return s=ql(s),s.tag=3,s}function gf(s,t,a,r){var o=a.type.getDerivedStateFromError;if(typeof o=="function"){var m=r.value;s.payload=function(){return o(m)},s.callback=function(){ff(t,a,r)}}var j=a.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(s.callback=function(){ff(t,a,r),typeof o!="function"&&(Wl===null?Wl=new Set([this]):Wl.add(this));var C=r.stack;this.componentDidCatch(r.value,{componentStack:C!==null?C:""})})}function py(s,t,a,r,o){if(a.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=a.alternate,t!==null&&fr(t,a,o,!0),a=ba.current,a!==null){switch(a.tag){case 31:case 13:return Pa===null?lo():a.alternate===null&&Nt===0&&(Nt=3),a.flags&=-257,a.flags|=65536,a.lanes=o,r===Oc?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([r]):t.add(r),qu(s,r,o)),!1;case 22:return a.flags|=65536,r===Oc?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([r]):a.add(r)),qu(s,r,o)),!1}throw Error(c(435,a.tag))}return qu(s,r,o),lo(),!1}if(zs)return t=ba.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,r!==Id&&(s=Error(c(422),{cause:r}),ci(Ua(s,a)))):(r!==Id&&(t=Error(c(423),{cause:r}),ci(Ua(t,a))),s=s.current.alternate,s.flags|=65536,o&=-o,s.lanes|=o,r=Ua(r,a),o=bu(s.stateNode,r,o),Xd(s,o),Nt!==4&&(Nt=2)),!1;var m=Error(c(520),{cause:r});if(m=Ua(m,a),Ci===null?Ci=[m]:Ci.push(m),Nt!==4&&(Nt=2),t===null)return!0;r=Ua(r,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,s=o&-o,a.lanes|=s,s=bu(a.stateNode,r,s),Xd(a,s),!1;case 1:if(t=a.type,m=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Wl===null||!Wl.has(m))))return a.flags|=65536,o&=-o,a.lanes|=o,o=pf(o),gf(o,s,a,r),Xd(a,o),!1}a=a.return}while(a!==null);return!1}var yu=Error(c(461)),At=!1;function qt(s,t,a,r){t.child=s===null?Nh(t,null,a,r):Dn(t,s.child,a,r)}function jf(s,t,a,r,o){a=a.render;var m=t.ref;if("ref"in r){var j={};for(var C in r)C!=="ref"&&(j[C]=r[C])}else j=r;return Mn(t),r=au(s,t,a,j,m,o),C=lu(),s!==null&&!At?(nu(s,t,o),bl(s,t,o)):(zs&&C&&$d(t),t.flags|=1,qt(s,t,r,o),t.child)}function vf(s,t,a,r,o){if(s===null){var m=a.type;return typeof m=="function"&&!Rd(m)&&m.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=m,Nf(s,t,m,r,o)):(s=Cc(a.type,null,r,t,t.mode,o),s.ref=t.ref,s.return=t,t.child=s)}if(m=s.child,!Mu(s,o)){var j=m.memoizedProps;if(a=a.compare,a=a!==null?a:ni,a(j,r)&&s.ref===t.ref)return bl(s,t,o)}return t.flags|=1,s=fl(m,r),s.ref=t.ref,s.return=t,t.child=s}function Nf(s,t,a,r,o){if(s!==null){var m=s.memoizedProps;if(ni(m,r)&&s.ref===t.ref)if(At=!1,t.pendingProps=r=m,Mu(s,o))(s.flags&131072)!==0&&(At=!0);else return t.lanes=s.lanes,bl(s,t,o)}return wu(s,t,a,r,o)}function bf(s,t,a,r){var o=r.children,m=s!==null?s.memoizedState:null;if(s===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((t.flags&128)!==0){if(m=m!==null?m.baseLanes|a:a,s!==null){for(r=t.child=s.child,o=0;r!==null;)o=o|r.lanes|r.childLanes,r=r.sibling;r=o&~m}else r=0,t.child=null;return yf(s,t,m,a,r)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},s!==null&&zc(t,m!==null?m.cachePool:null),m!==null?wh(t,m):Wd(),_h(t);else return r=t.lanes=536870912,yf(s,t,m!==null?m.baseLanes|a:a,a,r)}else m!==null?(zc(t,m.cachePool),wh(t,m),Yl(),t.memoizedState=null):(s!==null&&zc(t,null),Wd(),Yl());return qt(s,t,o,a),t.child}function Ni(s,t){return s!==null&&s.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function yf(s,t,a,r,o){var m=Kd();return m=m===null?null:{parent:Mt._currentValue,pool:m},t.memoizedState={baseLanes:a,cachePool:m},s!==null&&zc(t,null),Wd(),_h(t),s!==null&&fr(s,t,r,!0),t.childLanes=o,null}function Kc(s,t){return t=Yc({mode:t.mode,children:t.children},s.mode),t.ref=s.ref,s.child=t,t.return=s,t}function wf(s,t,a){return Dn(t,s.child,null,a),s=Kc(t,t.pendingProps),s.flags|=2,ya(t),t.memoizedState=null,s}function gy(s,t,a){var r=t.pendingProps,o=(t.flags&128)!==0;if(t.flags&=-129,s===null){if(zs){if(r.mode==="hidden")return s=Kc(t,r),t.lanes=536870912,Ni(null,s);if(su(t),(s=it)?(s=Rp(s,Ia),s=s!==null&&s.data==="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Pl!==null?{id:al,overflow:ll}:null,retryLane:536870912,hydrationErrors:null},a=nh(s),a.return=t,t.child=a,Gt=t,it=null)):s=null,s===null)throw Fl(t);return t.lanes=536870912,null}return Kc(t,r)}var m=s.memoizedState;if(m!==null){var j=m.dehydrated;if(su(t),o)if(t.flags&256)t.flags&=-257,t=wf(s,t,a);else if(t.memoizedState!==null)t.child=s.child,t.flags|=128,t=null;else throw Error(c(558));else if(At||fr(s,t,a,!1),o=(a&s.childLanes)!==0,At||o){if(r=Ws,r!==null&&(j=rt(r,a),j!==0&&j!==m.retryLane))throw m.retryLane=j,kn(s,j),fa(r,s,j),yu;lo(),t=wf(s,t,a)}else s=m.treeContext,it=Ha(j.nextSibling),Gt=t,zs=!0,Hl=null,Ia=!1,s!==null&&ch(t,s),t=Kc(t,r),t.flags|=4096;return t}return s=fl(s.child,{mode:r.mode,children:r.children}),s.ref=t.ref,t.child=s,s.return=t,s}function Qc(s,t){var a=t.ref;if(a===null)s!==null&&s.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(c(284));(s===null||s.ref!==a)&&(t.flags|=4194816)}}function wu(s,t,a,r,o){return Mn(t),a=au(s,t,a,r,void 0,o),r=lu(),s!==null&&!At?(nu(s,t,o),bl(s,t,o)):(zs&&r&&$d(t),t.flags|=1,qt(s,t,a,o),t.child)}function _f(s,t,a,r,o,m){return Mn(t),t.updateQueue=null,a=kh(t,r,a,o),Sh(s),r=lu(),s!==null&&!At?(nu(s,t,m),bl(s,t,m)):(zs&&r&&$d(t),t.flags|=1,qt(s,t,a,m),t.child)}function Sf(s,t,a,r,o){if(Mn(t),t.stateNode===null){var m=ur,j=a.contextType;typeof j=="object"&&j!==null&&(m=Vt(j)),m=new a(r,m),t.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Nu,t.stateNode=m,m._reactInternals=t,m=t.stateNode,m.props=r,m.state=t.memoizedState,m.refs={},Yd(t),j=a.contextType,m.context=typeof j=="object"&&j!==null?Vt(j):ur,m.state=t.memoizedState,j=a.getDerivedStateFromProps,typeof j=="function"&&(vu(t,a,j,r),m.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(j=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),j!==m.state&&Nu.enqueueReplaceState(m,m.state,null),fi(t,r,m,o),hi(),m.state=t.memoizedState),typeof m.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(s===null){m=t.stateNode;var C=t.memoizedProps,$=Ln(a,C);m.props=$;var ae=m.context,ge=a.contextType;j=ur,typeof ge=="object"&&ge!==null&&(j=Vt(ge));var be=a.getDerivedStateFromProps;ge=typeof be=="function"||typeof m.getSnapshotBeforeUpdate=="function",C=t.pendingProps!==C,ge||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(C||ae!==j)&&uf(t,m,r,j),Vl=!1;var ce=t.memoizedState;m.state=ce,fi(t,r,m,o),hi(),ae=t.memoizedState,C||ce!==ae||Vl?(typeof be=="function"&&(vu(t,a,be,r),ae=t.memoizedState),($=Vl||df(t,a,$,r,ce,ae,j))?(ge||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(t.flags|=4194308)):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=ae),m.props=r,m.state=ae,m.context=j,r=$):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{m=t.stateNode,Jd(s,t),j=t.memoizedProps,ge=Ln(a,j),m.props=ge,be=t.pendingProps,ce=m.context,ae=a.contextType,$=ur,typeof ae=="object"&&ae!==null&&($=Vt(ae)),C=a.getDerivedStateFromProps,(ae=typeof C=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(j!==be||ce!==$)&&uf(t,m,r,$),Vl=!1,ce=t.memoizedState,m.state=ce,fi(t,r,m,o),hi();var me=t.memoizedState;j!==be||ce!==me||Vl||s!==null&&s.dependencies!==null&&Ec(s.dependencies)?(typeof C=="function"&&(vu(t,a,C,r),me=t.memoizedState),(ge=Vl||df(t,a,ge,r,ce,me,$)||s!==null&&s.dependencies!==null&&Ec(s.dependencies))?(ae||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(r,me,$),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(r,me,$)),typeof m.componentDidUpdate=="function"&&(t.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof m.componentDidUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=me),m.props=r,m.state=me,m.context=$,r=ge):(typeof m.componentDidUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ce===s.memoizedState||(t.flags|=1024),r=!1)}return m=r,Qc(s,t),r=(t.flags&128)!==0,m||r?(m=t.stateNode,a=r&&typeof a.getDerivedStateFromError!="function"?null:m.render(),t.flags|=1,s!==null&&r?(t.child=Dn(t,s.child,null,o),t.child=Dn(t,null,a,o)):qt(s,t,a,o),t.memoizedState=m.state,s=t.child):s=bl(s,t,o),s}function kf(s,t,a,r){return Tn(),t.flags|=256,qt(s,t,a,r),t.child}var _u={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Su(s){return{baseLanes:s,cachePool:hh()}}function ku(s,t,a){return s=s!==null?s.childLanes&~a:0,t&&(s|=_a),s}function Cf(s,t,a){var r=t.pendingProps,o=!1,m=(t.flags&128)!==0,j;if((j=m)||(j=s!==null&&s.memoizedState===null?!1:(St.current&2)!==0),j&&(o=!0,t.flags&=-129),j=(t.flags&32)!==0,t.flags&=-33,s===null){if(zs){if(o?Ql(t):Yl(),(s=it)?(s=Rp(s,Ia),s=s!==null&&s.data!=="&"?s:null,s!==null&&(t.memoizedState={dehydrated:s,treeContext:Pl!==null?{id:al,overflow:ll}:null,retryLane:536870912,hydrationErrors:null},a=nh(s),a.return=t,t.child=a,Gt=t,it=null)):s=null,s===null)throw Fl(t);return cm(s)?t.lanes=32:t.lanes=536870912,null}var C=r.children;return r=r.fallback,o?(Yl(),o=t.mode,C=Yc({mode:"hidden",children:C},o),r=Cn(r,o,a,null),C.return=t,r.return=t,C.sibling=r,t.child=C,r=t.child,r.memoizedState=Su(a),r.childLanes=ku(s,j,a),t.memoizedState=_u,Ni(null,r)):(Ql(t),Cu(t,C))}var $=s.memoizedState;if($!==null&&(C=$.dehydrated,C!==null)){if(m)t.flags&256?(Ql(t),t.flags&=-257,t=Tu(s,t,a)):t.memoizedState!==null?(Yl(),t.child=s.child,t.flags|=128,t=null):(Yl(),C=r.fallback,o=t.mode,r=Yc({mode:"visible",children:r.children},o),C=Cn(C,o,a,null),C.flags|=2,r.return=t,C.return=t,r.sibling=C,t.child=r,Dn(t,s.child,null,a),r=t.child,r.memoizedState=Su(a),r.childLanes=ku(s,j,a),t.memoizedState=_u,t=Ni(null,r));else if(Ql(t),cm(C)){if(j=C.nextSibling&&C.nextSibling.dataset,j)var ae=j.dgst;j=ae,r=Error(c(419)),r.stack="",r.digest=j,ci({value:r,source:null,stack:null}),t=Tu(s,t,a)}else if(At||fr(s,t,a,!1),j=(a&s.childLanes)!==0,At||j){if(j=Ws,j!==null&&(r=rt(j,a),r!==0&&r!==$.retryLane))throw $.retryLane=r,kn(s,r),fa(j,s,r),yu;im(C)||lo(),t=Tu(s,t,a)}else im(C)?(t.flags|=192,t.child=s.child,t=null):(s=$.treeContext,it=Ha(C.nextSibling),Gt=t,zs=!0,Hl=null,Ia=!1,s!==null&&ch(t,s),t=Cu(t,r.children),t.flags|=4096);return t}return o?(Yl(),C=r.fallback,o=t.mode,$=s.child,ae=$.sibling,r=fl($,{mode:"hidden",children:r.children}),r.subtreeFlags=$.subtreeFlags&65011712,ae!==null?C=fl(ae,C):(C=Cn(C,o,a,null),C.flags|=2),C.return=t,r.return=t,r.sibling=C,t.child=r,Ni(null,r),r=t.child,C=s.child.memoizedState,C===null?C=Su(a):(o=C.cachePool,o!==null?($=Mt._currentValue,o=o.parent!==$?{parent:$,pool:$}:o):o=hh(),C={baseLanes:C.baseLanes|a,cachePool:o}),r.memoizedState=C,r.childLanes=ku(s,j,a),t.memoizedState=_u,Ni(s.child,r)):(Ql(t),a=s.child,s=a.sibling,a=fl(a,{mode:"visible",children:r.children}),a.return=t,a.sibling=null,s!==null&&(j=t.deletions,j===null?(t.deletions=[s],t.flags|=16):j.push(s)),t.child=a,t.memoizedState=null,a)}function Cu(s,t){return t=Yc({mode:"visible",children:t},s.mode),t.return=s,s.child=t}function Yc(s,t){return s=Na(22,s,null,t),s.lanes=0,s}function Tu(s,t,a){return Dn(t,s.child,null,a),s=Cu(t,t.pendingProps.children),s.flags|=2,t.memoizedState=null,s}function Tf(s,t,a){s.lanes|=t;var r=s.alternate;r!==null&&(r.lanes|=t),Fd(s.return,t,a)}function Eu(s,t,a,r,o,m){var j=s.memoizedState;j===null?s.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:a,tailMode:o,treeForkCount:m}:(j.isBackwards=t,j.rendering=null,j.renderingStartTime=0,j.last=r,j.tail=a,j.tailMode=o,j.treeForkCount=m)}function Ef(s,t,a){var r=t.pendingProps,o=r.revealOrder,m=r.tail;r=r.children;var j=St.current,C=(j&2)!==0;if(C?(j=j&1|2,t.flags|=128):j&=1,ke(St,j),qt(s,t,r,a),r=zs?ii:0,!C&&s!==null&&(s.flags&128)!==0)e:for(s=t.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Tf(s,a,t);else if(s.tag===19)Tf(s,a,t);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(o){case"forwards":for(a=t.child,o=null;a!==null;)s=a.alternate,s!==null&&Uc(s)===null&&(o=a),a=a.sibling;a=o,a===null?(o=t.child,t.child=null):(o=a.sibling,a.sibling=null),Eu(t,!1,o,a,m,r);break;case"backwards":case"unstable_legacy-backwards":for(a=null,o=t.child,t.child=null;o!==null;){if(s=o.alternate,s!==null&&Uc(s)===null){t.child=o;break}s=o.sibling,o.sibling=a,a=o,o=s}Eu(t,!0,a,null,m,r);break;case"together":Eu(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function bl(s,t,a){if(s!==null&&(t.dependencies=s.dependencies),Zl|=t.lanes,(a&t.childLanes)===0)if(s!==null){if(fr(s,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(s!==null&&t.child!==s.child)throw Error(c(153));if(t.child!==null){for(s=t.child,a=fl(s,s.pendingProps),t.child=a,a.return=t;s.sibling!==null;)s=s.sibling,a=a.sibling=fl(s,s.pendingProps),a.return=t;a.sibling=null}return t.child}function Mu(s,t){return(s.lanes&t)!==0?!0:(s=s.dependencies,!!(s!==null&&Ec(s)))}function jy(s,t,a){switch(t.tag){case 3:Ee(t,t.stateNode.containerInfo),Gl(t,Mt,s.memoizedState.cache),Tn();break;case 27:case 5:Oe(t);break;case 4:Ee(t,t.stateNode.containerInfo);break;case 10:Gl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,su(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(Ql(t),t.flags|=128,null):(a&t.child.childLanes)!==0?Cf(s,t,a):(Ql(t),s=bl(s,t,a),s!==null?s.sibling:null);Ql(t);break;case 19:var o=(s.flags&128)!==0;if(r=(a&t.childLanes)!==0,r||(fr(s,t,a,!1),r=(a&t.childLanes)!==0),o){if(r)return Ef(s,t,a);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),ke(St,St.current),r)break;return null;case 22:return t.lanes=0,bf(s,t,a,t.pendingProps);case 24:Gl(t,Mt,s.memoizedState.cache)}return bl(s,t,a)}function Mf(s,t,a){if(s!==null)if(s.memoizedProps!==t.pendingProps)At=!0;else{if(!Mu(s,a)&&(t.flags&128)===0)return At=!1,jy(s,t,a);At=(s.flags&131072)!==0}else At=!1,zs&&(t.flags&1048576)!==0&&ih(t,ii,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(s=An(t.elementType),t.type=s,typeof s=="function")Rd(s)?(r=Ln(s,r),t.tag=1,t=Sf(null,t,s,r,a)):(t.tag=0,t=wu(null,t,s,r,a));else{if(s!=null){var o=s.$$typeof;if(o===T){t.tag=11,t=jf(null,t,s,r,a);break e}else if(o===L){t.tag=14,t=vf(null,t,s,r,a);break e}}throw t=ve(s)||s,Error(c(306,t,""))}}return t;case 0:return wu(s,t,t.type,t.pendingProps,a);case 1:return r=t.type,o=Ln(r,t.pendingProps),Sf(s,t,r,o,a);case 3:e:{if(Ee(t,t.stateNode.containerInfo),s===null)throw Error(c(387));r=t.pendingProps;var m=t.memoizedState;o=m.element,Jd(s,t),fi(t,r,null,a);var j=t.memoizedState;if(r=j.cache,Gl(t,Mt,r),r!==m.cache&&Gd(t,[Mt],a,!0),hi(),r=j.element,m.isDehydrated)if(m={element:r,isDehydrated:!1,cache:j.cache},t.updateQueue.baseState=m,t.memoizedState=m,t.flags&256){t=kf(s,t,r,a);break e}else if(r!==o){o=Ua(Error(c(424)),t),ci(o),t=kf(s,t,r,a);break e}else{switch(s=t.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(it=Ha(s.firstChild),Gt=t,zs=!0,Hl=null,Ia=!0,a=Nh(t,null,r,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Tn(),r===o){t=bl(s,t,a);break e}qt(s,t,r,a)}t=t.child}return t;case 26:return Qc(s,t),s===null?(a=Pp(t.type,null,t.pendingProps,null))?t.memoizedState=a:zs||(a=t.type,s=t.pendingProps,r=mo(H.current).createElement(a),r[gs]=t,r[is]=s,Kt(r,a,s),It(r),t.stateNode=r):t.memoizedState=Pp(t.type,s.memoizedProps,t.pendingProps,s.memoizedState),null;case 27:return Oe(t),s===null&&zs&&(r=t.stateNode=$p(t.type,t.pendingProps,H.current),Gt=t,Ia=!0,o=it,an(t.type)?(om=o,it=Ha(r.firstChild)):it=o),qt(s,t,t.pendingProps.children,a),Qc(s,t),s===null&&(t.flags|=4194304),t.child;case 5:return s===null&&zs&&((o=r=it)&&(r=Qy(r,t.type,t.pendingProps,Ia),r!==null?(t.stateNode=r,Gt=t,it=Ha(r.firstChild),Ia=!1,o=!0):o=!1),o||Fl(t)),Oe(t),o=t.type,m=t.pendingProps,j=s!==null?s.memoizedProps:null,r=m.children,lm(o,m)?r=null:j!==null&&lm(o,j)&&(t.flags|=32),t.memoizedState!==null&&(o=au(s,t,oy,null,null,a),Ri._currentValue=o),Qc(s,t),qt(s,t,r,a),t.child;case 6:return s===null&&zs&&((s=a=it)&&(a=Yy(a,t.pendingProps,Ia),a!==null?(t.stateNode=a,Gt=t,it=null,s=!0):s=!1),s||Fl(t)),null;case 13:return Cf(s,t,a);case 4:return Ee(t,t.stateNode.containerInfo),r=t.pendingProps,s===null?t.child=Dn(t,null,r,a):qt(s,t,r,a),t.child;case 11:return jf(s,t,t.type,t.pendingProps,a);case 7:return qt(s,t,t.pendingProps,a),t.child;case 8:return qt(s,t,t.pendingProps.children,a),t.child;case 12:return qt(s,t,t.pendingProps.children,a),t.child;case 10:return r=t.pendingProps,Gl(t,t.type,r.value),qt(s,t,r.children,a),t.child;case 9:return o=t.type._context,r=t.pendingProps.children,Mn(t),o=Vt(o),r=r(o),t.flags|=1,qt(s,t,r,a),t.child;case 14:return vf(s,t,t.type,t.pendingProps,a);case 15:return Nf(s,t,t.type,t.pendingProps,a);case 19:return Ef(s,t,a);case 31:return gy(s,t,a);case 22:return bf(s,t,a,t.pendingProps);case 24:return Mn(t),r=Vt(Mt),s===null?(o=Kd(),o===null&&(o=Ws,m=Vd(),o.pooledCache=m,m.refCount++,m!==null&&(o.pooledCacheLanes|=a),o=m),t.memoizedState={parent:r,cache:o},Yd(t),Gl(t,Mt,o)):((s.lanes&a)!==0&&(Jd(s,t),fi(t,null,null,a),hi()),o=s.memoizedState,m=t.memoizedState,o.parent!==r?(o={parent:r,cache:r},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),Gl(t,Mt,r)):(r=m.cache,Gl(t,Mt,r),r!==o.cache&&Gd(t,[Mt],a,!0))),qt(s,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(c(156,t.tag))}function yl(s){s.flags|=4}function zu(s,t,a,r,o){if((t=(s.mode&32)!==0)&&(t=!1),t){if(s.flags|=16777216,(o&335544128)===o)if(s.stateNode.complete)s.flags|=8192;else if(ap())s.flags|=8192;else throw On=Oc,Qd}else s.flags&=-16777217}function zf(s,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!qp(t))if(ap())s.flags|=8192;else throw On=Oc,Qd}function Jc(s,t){t!==null&&(s.flags|=4),s.flags&16384&&(t=s.tag!==22?W():536870912,s.lanes|=t,Cr|=t)}function bi(s,t){if(!zs)switch(s.tailMode){case"hidden":t=s.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var r=null;a!==null;)a.alternate!==null&&(r=a),a=a.sibling;r===null?t||s.tail===null?s.tail=null:s.tail.sibling=null:r.sibling=null}}function ct(s){var t=s.alternate!==null&&s.alternate.child===s.child,a=0,r=0;if(t)for(var o=s.child;o!==null;)a|=o.lanes|o.childLanes,r|=o.subtreeFlags&65011712,r|=o.flags&65011712,o.return=s,o=o.sibling;else for(o=s.child;o!==null;)a|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=s,o=o.sibling;return s.subtreeFlags|=r,s.childLanes=a,t}function vy(s,t,a){var r=t.pendingProps;switch(Bd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(t),null;case 1:return ct(t),null;case 3:return a=t.stateNode,r=null,s!==null&&(r=s.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),jl(Mt),Z(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(s===null||s.child===null)&&(hr(t)?yl(t):s===null||s.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Pd())),ct(t),null;case 26:var o=t.type,m=t.memoizedState;return s===null?(yl(t),m!==null?(ct(t),zf(t,m)):(ct(t),zu(t,o,null,r,a))):m?m!==s.memoizedState?(yl(t),ct(t),zf(t,m)):(ct(t),t.flags&=-16777217):(s=s.memoizedProps,s!==r&&yl(t),ct(t),zu(t,o,s,r,a)),null;case 27:if(ns(t),a=H.current,o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==r&&yl(t);else{if(!r){if(t.stateNode===null)throw Error(c(166));return ct(t),null}s=O.current,hr(t)?oh(t):(s=$p(o,r,a),t.stateNode=s,yl(t))}return ct(t),null;case 5:if(ns(t),o=t.type,s!==null&&t.stateNode!=null)s.memoizedProps!==r&&yl(t);else{if(!r){if(t.stateNode===null)throw Error(c(166));return ct(t),null}if(m=O.current,hr(t))oh(t);else{var j=mo(H.current);switch(m){case 1:m=j.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:m=j.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":m=j.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":m=j.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":m=j.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof r.is=="string"?j.createElement("select",{is:r.is}):j.createElement("select"),r.multiple?m.multiple=!0:r.size&&(m.size=r.size);break;default:m=typeof r.is=="string"?j.createElement(o,{is:r.is}):j.createElement(o)}}m[gs]=t,m[is]=r;e:for(j=t.child;j!==null;){if(j.tag===5||j.tag===6)m.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===t)break e;for(;j.sibling===null;){if(j.return===null||j.return===t)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}t.stateNode=m;e:switch(Kt(m,o,r),o){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&yl(t)}}return ct(t),zu(t,t.type,s===null?null:s.memoizedProps,t.pendingProps,a),null;case 6:if(s&&t.stateNode!=null)s.memoizedProps!==r&&yl(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(c(166));if(s=H.current,hr(t)){if(s=t.stateNode,a=t.memoizedProps,r=null,o=Gt,o!==null)switch(o.tag){case 27:case 5:r=o.memoizedProps}s[gs]=t,s=!!(s.nodeValue===a||r!==null&&r.suppressHydrationWarning===!0||Cp(s.nodeValue,a)),s||Fl(t,!0)}else s=mo(s).createTextNode(r),s[gs]=t,t.stateNode=s}return ct(t),null;case 31:if(a=t.memoizedState,s===null||s.memoizedState!==null){if(r=hr(t),a!==null){if(s===null){if(!r)throw Error(c(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(557));s[gs]=t}else Tn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ct(t),s=!1}else a=Pd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=a),s=!0;if(!s)return t.flags&256?(ya(t),t):(ya(t),null);if((t.flags&128)!==0)throw Error(c(558))}return ct(t),null;case 13:if(r=t.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(o=hr(t),r!==null&&r.dehydrated!==null){if(s===null){if(!o)throw Error(c(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(c(317));o[gs]=t}else Tn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ct(t),o=!1}else o=Pd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(ya(t),t):(ya(t),null)}return ya(t),(t.flags&128)!==0?(t.lanes=a,t):(a=r!==null,s=s!==null&&s.memoizedState!==null,a&&(r=t.child,o=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(o=r.alternate.memoizedState.cachePool.pool),m=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),m!==o&&(r.flags|=2048)),a!==s&&a&&(t.child.flags|=8192),Jc(t,t.updateQueue),ct(t),null);case 4:return Z(),s===null&&Wu(t.stateNode.containerInfo),ct(t),null;case 10:return jl(t.type),ct(t),null;case 19:if(pe(St),r=t.memoizedState,r===null)return ct(t),null;if(o=(t.flags&128)!==0,m=r.rendering,m===null)if(o)bi(r,!1);else{if(Nt!==0||s!==null&&(s.flags&128)!==0)for(s=t.child;s!==null;){if(m=Uc(s),m!==null){for(t.flags|=128,bi(r,!1),s=m.updateQueue,t.updateQueue=s,Jc(t,s),t.subtreeFlags=0,s=a,a=t.child;a!==null;)lh(a,s),a=a.sibling;return ke(St,St.current&1|2),zs&&pl(t,r.treeForkCount),t.child}s=s.sibling}r.tail!==null&&mt()>so&&(t.flags|=128,o=!0,bi(r,!1),t.lanes=4194304)}else{if(!o)if(s=Uc(m),s!==null){if(t.flags|=128,o=!0,s=s.updateQueue,t.updateQueue=s,Jc(t,s),bi(r,!0),r.tail===null&&r.tailMode==="hidden"&&!m.alternate&&!zs)return ct(t),null}else 2*mt()-r.renderingStartTime>so&&a!==536870912&&(t.flags|=128,o=!0,bi(r,!1),t.lanes=4194304);r.isBackwards?(m.sibling=t.child,t.child=m):(s=r.last,s!==null?s.sibling=m:t.child=m,r.last=m)}return r.tail!==null?(s=r.tail,r.rendering=s,r.tail=s.sibling,r.renderingStartTime=mt(),s.sibling=null,a=St.current,ke(St,o?a&1|2:a&1),zs&&pl(t,r.treeForkCount),s):(ct(t),null);case 22:case 23:return ya(t),eu(),r=t.memoizedState!==null,s!==null?s.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?(a&536870912)!==0&&(t.flags&128)===0&&(ct(t),t.subtreeFlags&6&&(t.flags|=8192)):ct(t),a=t.updateQueue,a!==null&&Jc(t,a.retryQueue),a=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==a&&(t.flags|=2048),s!==null&&pe(zn),null;case 24:return a=null,s!==null&&(a=s.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),jl(Mt),ct(t),null;case 25:return null;case 30:return null}throw Error(c(156,t.tag))}function Ny(s,t){switch(Bd(t),t.tag){case 1:return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 3:return jl(Mt),Z(),s=t.flags,(s&65536)!==0&&(s&128)===0?(t.flags=s&-65537|128,t):null;case 26:case 27:case 5:return ns(t),null;case 31:if(t.memoizedState!==null){if(ya(t),t.alternate===null)throw Error(c(340));Tn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 13:if(ya(t),s=t.memoizedState,s!==null&&s.dehydrated!==null){if(t.alternate===null)throw Error(c(340));Tn()}return s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 19:return pe(St),null;case 4:return Z(),null;case 10:return jl(t.type),null;case 22:case 23:return ya(t),eu(),s!==null&&pe(zn),s=t.flags,s&65536?(t.flags=s&-65537|128,t):null;case 24:return jl(Mt),null;case 25:return null;default:return null}}function Af(s,t){switch(Bd(t),t.tag){case 3:jl(Mt),Z();break;case 26:case 27:case 5:ns(t);break;case 4:Z();break;case 31:t.memoizedState!==null&&ya(t);break;case 13:ya(t);break;case 19:pe(St);break;case 10:jl(t.type);break;case 22:case 23:ya(t),eu(),s!==null&&pe(zn);break;case 24:jl(Mt)}}function yi(s,t){try{var a=t.updateQueue,r=a!==null?a.lastEffect:null;if(r!==null){var o=r.next;a=o;do{if((a.tag&s)===s){r=void 0;var m=a.create,j=a.inst;r=m(),j.destroy=r}a=a.next}while(a!==o)}}catch(C){Vs(t,t.return,C)}}function Jl(s,t,a){try{var r=t.updateQueue,o=r!==null?r.lastEffect:null;if(o!==null){var m=o.next;r=m;do{if((r.tag&s)===s){var j=r.inst,C=j.destroy;if(C!==void 0){j.destroy=void 0,o=t;var $=a,ae=C;try{ae()}catch(ge){Vs(o,$,ge)}}}r=r.next}while(r!==m)}}catch(ge){Vs(t,t.return,ge)}}function Of(s){var t=s.updateQueue;if(t!==null){var a=s.stateNode;try{yh(t,a)}catch(r){Vs(s,s.return,r)}}}function Df(s,t,a){a.props=Ln(s.type,s.memoizedProps),a.state=s.memoizedState;try{a.componentWillUnmount()}catch(r){Vs(s,t,r)}}function wi(s,t){try{var a=s.ref;if(a!==null){switch(s.tag){case 26:case 27:case 5:var r=s.stateNode;break;case 30:r=s.stateNode;break;default:r=s.stateNode}typeof a=="function"?s.refCleanup=a(r):a.current=r}}catch(o){Vs(s,t,o)}}function nl(s,t){var a=s.ref,r=s.refCleanup;if(a!==null)if(typeof r=="function")try{r()}catch(o){Vs(s,t,o)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(o){Vs(s,t,o)}else a.current=null}function Rf(s){var t=s.type,a=s.memoizedProps,r=s.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break e;case"img":a.src?r.src=a.src:a.srcSet&&(r.srcset=a.srcSet)}}catch(o){Vs(s,s.return,o)}}function Au(s,t,a){try{var r=s.stateNode;Hy(r,s.type,a,t),r[is]=t}catch(o){Vs(s,s.return,o)}}function Lf(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&an(s.type)||s.tag===4}function Ou(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Lf(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&an(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Du(s,t,a){var r=s.tag;if(r===5||r===6)s=s.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(s,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(s),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=xl));else if(r!==4&&(r===27&&an(s.type)&&(a=s.stateNode,t=null),s=s.child,s!==null))for(Du(s,t,a),s=s.sibling;s!==null;)Du(s,t,a),s=s.sibling}function Xc(s,t,a){var r=s.tag;if(r===5||r===6)s=s.stateNode,t?a.insertBefore(s,t):a.appendChild(s);else if(r!==4&&(r===27&&an(s.type)&&(a=s.stateNode),s=s.child,s!==null))for(Xc(s,t,a),s=s.sibling;s!==null;)Xc(s,t,a),s=s.sibling}function Uf(s){var t=s.stateNode,a=s.memoizedProps;try{for(var r=s.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);Kt(t,r,a),t[gs]=s,t[is]=a}catch(m){Vs(s,s.return,m)}}var wl=!1,Ot=!1,Ru=!1,$f=typeof WeakSet=="function"?WeakSet:Set,Pt=null;function by(s,t){if(s=s.containerInfo,tm=vo,s=Yx(s),Td(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var r=a.getSelection&&a.getSelection();if(r&&r.rangeCount!==0){a=r.anchorNode;var o=r.anchorOffset,m=r.focusNode;r=r.focusOffset;try{a.nodeType,m.nodeType}catch{a=null;break e}var j=0,C=-1,$=-1,ae=0,ge=0,be=s,ce=null;s:for(;;){for(var me;be!==a||o!==0&&be.nodeType!==3||(C=j+o),be!==m||r!==0&&be.nodeType!==3||($=j+r),be.nodeType===3&&(j+=be.nodeValue.length),(me=be.firstChild)!==null;)ce=be,be=me;for(;;){if(be===s)break s;if(ce===a&&++ae===o&&(C=j),ce===m&&++ge===r&&($=j),(me=be.nextSibling)!==null)break;be=ce,ce=be.parentNode}be=me}a=C===-1||$===-1?null:{start:C,end:$}}else a=null}a=a||{start:0,end:0}}else a=null;for(am={focusedElem:s,selectionRange:a},vo=!1,Pt=t;Pt!==null;)if(t=Pt,s=t.child,(t.subtreeFlags&1028)!==0&&s!==null)s.return=t,Pt=s;else for(;Pt!==null;){switch(t=Pt,m=t.alternate,s=t.flags,t.tag){case 0:if((s&4)!==0&&(s=t.updateQueue,s=s!==null?s.events:null,s!==null))for(a=0;a<s.length;a++)o=s[a],o.ref.impl=o.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&m!==null){s=void 0,a=t,o=m.memoizedProps,m=m.memoizedState,r=a.stateNode;try{var He=Ln(a.type,o);s=r.getSnapshotBeforeUpdate(He,m),r.__reactInternalSnapshotBeforeUpdate=s}catch(Xe){Vs(a,a.return,Xe)}}break;case 3:if((s&1024)!==0){if(s=t.stateNode.containerInfo,a=s.nodeType,a===9)rm(s);else if(a===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":rm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(c(163))}if(s=t.sibling,s!==null){s.return=t.return,Pt=s;break}Pt=t.return}}function Bf(s,t,a){var r=a.flags;switch(a.tag){case 0:case 11:case 15:Sl(s,a),r&4&&yi(5,a);break;case 1:if(Sl(s,a),r&4)if(s=a.stateNode,t===null)try{s.componentDidMount()}catch(j){Vs(a,a.return,j)}else{var o=Ln(a.type,t.memoizedProps);t=t.memoizedState;try{s.componentDidUpdate(o,t,s.__reactInternalSnapshotBeforeUpdate)}catch(j){Vs(a,a.return,j)}}r&64&&Of(a),r&512&&wi(a,a.return);break;case 3:if(Sl(s,a),r&64&&(s=a.updateQueue,s!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{yh(s,t)}catch(j){Vs(a,a.return,j)}}break;case 27:t===null&&r&4&&Uf(a);case 26:case 5:Sl(s,a),t===null&&r&4&&Rf(a),r&512&&wi(a,a.return);break;case 12:Sl(s,a);break;case 31:Sl(s,a),r&4&&Hf(s,a);break;case 13:Sl(s,a),r&4&&Ff(s,a),r&64&&(s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(a=My.bind(null,a),Jy(s,a))));break;case 22:if(r=a.memoizedState!==null||wl,!r){t=t!==null&&t.memoizedState!==null||Ot,o=wl;var m=Ot;wl=r,(Ot=t)&&!m?kl(s,a,(a.subtreeFlags&8772)!==0):Sl(s,a),wl=o,Ot=m}break;case 30:break;default:Sl(s,a)}}function If(s){var t=s.alternate;t!==null&&(s.alternate=null,If(t)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(t=s.stateNode,t!==null&&ud(t)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ht=null,ua=!1;function _l(s,t,a){for(a=a.child;a!==null;)Pf(s,t,a),a=a.sibling}function Pf(s,t,a){if(as&&typeof as.onCommitFiberUnmount=="function")try{as.onCommitFiberUnmount(Ns,a)}catch{}switch(a.tag){case 26:Ot||nl(a,t),_l(s,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Ot||nl(a,t);var r=ht,o=ua;an(a.type)&&(ht=a.stateNode,ua=!1),_l(s,t,a),Ai(a.stateNode),ht=r,ua=o;break;case 5:Ot||nl(a,t);case 6:if(r=ht,o=ua,ht=null,_l(s,t,a),ht=r,ua=o,ht!==null)if(ua)try{(ht.nodeType===9?ht.body:ht.nodeName==="HTML"?ht.ownerDocument.body:ht).removeChild(a.stateNode)}catch(m){Vs(a,t,m)}else try{ht.removeChild(a.stateNode)}catch(m){Vs(a,t,m)}break;case 18:ht!==null&&(ua?(s=ht,Op(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.stateNode),Rr(s)):Op(ht,a.stateNode));break;case 4:r=ht,o=ua,ht=a.stateNode.containerInfo,ua=!0,_l(s,t,a),ht=r,ua=o;break;case 0:case 11:case 14:case 15:Jl(2,a,t),Ot||Jl(4,a,t),_l(s,t,a);break;case 1:Ot||(nl(a,t),r=a.stateNode,typeof r.componentWillUnmount=="function"&&Df(a,t,r)),_l(s,t,a);break;case 21:_l(s,t,a);break;case 22:Ot=(r=Ot)||a.memoizedState!==null,_l(s,t,a),Ot=r;break;default:_l(s,t,a)}}function Hf(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Rr(s)}catch(a){Vs(t,t.return,a)}}}function Ff(s,t){if(t.memoizedState===null&&(s=t.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Rr(s)}catch(a){Vs(t,t.return,a)}}function yy(s){switch(s.tag){case 31:case 13:case 19:var t=s.stateNode;return t===null&&(t=s.stateNode=new $f),t;case 22:return s=s.stateNode,t=s._retryCache,t===null&&(t=s._retryCache=new $f),t;default:throw Error(c(435,s.tag))}}function Zc(s,t){var a=yy(s);t.forEach(function(r){if(!a.has(r)){a.add(r);var o=zy.bind(null,s,r);r.then(o,o)}})}function ma(s,t){var a=t.deletions;if(a!==null)for(var r=0;r<a.length;r++){var o=a[r],m=s,j=t,C=j;e:for(;C!==null;){switch(C.tag){case 27:if(an(C.type)){ht=C.stateNode,ua=!1;break e}break;case 5:ht=C.stateNode,ua=!1;break e;case 3:case 4:ht=C.stateNode.containerInfo,ua=!0;break e}C=C.return}if(ht===null)throw Error(c(160));Pf(m,j,o),ht=null,ua=!1,m=o.alternate,m!==null&&(m.return=null),o.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Gf(t,s),t=t.sibling}var Ja=null;function Gf(s,t){var a=s.alternate,r=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ma(t,s),xa(s),r&4&&(Jl(3,s,s.return),yi(3,s),Jl(5,s,s.return));break;case 1:ma(t,s),xa(s),r&512&&(Ot||a===null||nl(a,a.return)),r&64&&wl&&(s=s.updateQueue,s!==null&&(r=s.callbacks,r!==null&&(a=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=a===null?r:a.concat(r))));break;case 26:var o=Ja;if(ma(t,s),xa(s),r&512&&(Ot||a===null||nl(a,a.return)),r&4){var m=a!==null?a.memoizedState:null;if(r=s.memoizedState,a===null)if(r===null)if(s.stateNode===null){e:{r=s.type,a=s.memoizedProps,o=o.ownerDocument||o;s:switch(r){case"title":m=o.getElementsByTagName("title")[0],(!m||m[bn]||m[gs]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=o.createElement(r),o.head.insertBefore(m,o.querySelector("head > title"))),Kt(m,r,a),m[gs]=s,It(m),r=m;break e;case"link":var j=Gp("link","href",o).get(r+(a.href||""));if(j){for(var C=0;C<j.length;C++)if(m=j[C],m.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&m.getAttribute("rel")===(a.rel==null?null:a.rel)&&m.getAttribute("title")===(a.title==null?null:a.title)&&m.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){j.splice(C,1);break s}}m=o.createElement(r),Kt(m,r,a),o.head.appendChild(m);break;case"meta":if(j=Gp("meta","content",o).get(r+(a.content||""))){for(C=0;C<j.length;C++)if(m=j[C],m.getAttribute("content")===(a.content==null?null:""+a.content)&&m.getAttribute("name")===(a.name==null?null:a.name)&&m.getAttribute("property")===(a.property==null?null:a.property)&&m.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&m.getAttribute("charset")===(a.charSet==null?null:a.charSet)){j.splice(C,1);break s}}m=o.createElement(r),Kt(m,r,a),o.head.appendChild(m);break;default:throw Error(c(468,r))}m[gs]=s,It(m),r=m}s.stateNode=r}else Vp(o,s.type,s.stateNode);else s.stateNode=Fp(o,r,s.memoizedProps);else m!==r?(m===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):m.count--,r===null?Vp(o,s.type,s.stateNode):Fp(o,r,s.memoizedProps)):r===null&&s.stateNode!==null&&Au(s,s.memoizedProps,a.memoizedProps)}break;case 27:ma(t,s),xa(s),r&512&&(Ot||a===null||nl(a,a.return)),a!==null&&r&4&&Au(s,s.memoizedProps,a.memoizedProps);break;case 5:if(ma(t,s),xa(s),r&512&&(Ot||a===null||nl(a,a.return)),s.flags&32){o=s.stateNode;try{lr(o,"")}catch(He){Vs(s,s.return,He)}}r&4&&s.stateNode!=null&&(o=s.memoizedProps,Au(s,o,a!==null?a.memoizedProps:o)),r&1024&&(Ru=!0);break;case 6:if(ma(t,s),xa(s),r&4){if(s.stateNode===null)throw Error(c(162));r=s.memoizedProps,a=s.stateNode;try{a.nodeValue=r}catch(He){Vs(s,s.return,He)}}break;case 3:if(fo=null,o=Ja,Ja=xo(t.containerInfo),ma(t,s),Ja=o,xa(s),r&4&&a!==null&&a.memoizedState.isDehydrated)try{Rr(t.containerInfo)}catch(He){Vs(s,s.return,He)}Ru&&(Ru=!1,Vf(s));break;case 4:r=Ja,Ja=xo(s.stateNode.containerInfo),ma(t,s),xa(s),Ja=r;break;case 12:ma(t,s),xa(s);break;case 31:ma(t,s),xa(s),r&4&&(r=s.updateQueue,r!==null&&(s.updateQueue=null,Zc(s,r)));break;case 13:ma(t,s),xa(s),s.child.flags&8192&&s.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(eo=mt()),r&4&&(r=s.updateQueue,r!==null&&(s.updateQueue=null,Zc(s,r)));break;case 22:o=s.memoizedState!==null;var $=a!==null&&a.memoizedState!==null,ae=wl,ge=Ot;if(wl=ae||o,Ot=ge||$,ma(t,s),Ot=ge,wl=ae,xa(s),r&8192)e:for(t=s.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(a===null||$||wl||Ot||Un(s)),a=null,t=s;;){if(t.tag===5||t.tag===26){if(a===null){$=a=t;try{if(m=$.stateNode,o)j=m.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{C=$.stateNode;var be=$.memoizedProps.style,ce=be!=null&&be.hasOwnProperty("display")?be.display:null;C.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(He){Vs($,$.return,He)}}}else if(t.tag===6){if(a===null){$=t;try{$.stateNode.nodeValue=o?"":$.memoizedProps}catch(He){Vs($,$.return,He)}}}else if(t.tag===18){if(a===null){$=t;try{var me=$.stateNode;o?Dp(me,!0):Dp($.stateNode,!1)}catch(He){Vs($,$.return,He)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===s)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=s.updateQueue,r!==null&&(a=r.retryQueue,a!==null&&(r.retryQueue=null,Zc(s,a))));break;case 19:ma(t,s),xa(s),r&4&&(r=s.updateQueue,r!==null&&(s.updateQueue=null,Zc(s,r)));break;case 30:break;case 21:break;default:ma(t,s),xa(s)}}function xa(s){var t=s.flags;if(t&2){try{for(var a,r=s.return;r!==null;){if(Lf(r)){a=r;break}r=r.return}if(a==null)throw Error(c(160));switch(a.tag){case 27:var o=a.stateNode,m=Ou(s);Xc(s,m,o);break;case 5:var j=a.stateNode;a.flags&32&&(lr(j,""),a.flags&=-33);var C=Ou(s);Xc(s,C,j);break;case 3:case 4:var $=a.stateNode.containerInfo,ae=Ou(s);Du(s,ae,$);break;default:throw Error(c(161))}}catch(ge){Vs(s,s.return,ge)}s.flags&=-3}t&4096&&(s.flags&=-4097)}function Vf(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var t=s;Vf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),s=s.sibling}}function Sl(s,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Bf(s,t.alternate,t),t=t.sibling}function Un(s){for(s=s.child;s!==null;){var t=s;switch(t.tag){case 0:case 11:case 14:case 15:Jl(4,t,t.return),Un(t);break;case 1:nl(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&Df(t,t.return,a),Un(t);break;case 27:Ai(t.stateNode);case 26:case 5:nl(t,t.return),Un(t);break;case 22:t.memoizedState===null&&Un(t);break;case 30:Un(t);break;default:Un(t)}s=s.sibling}}function kl(s,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,o=s,m=t,j=m.flags;switch(m.tag){case 0:case 11:case 15:kl(o,m,a),yi(4,m);break;case 1:if(kl(o,m,a),r=m,o=r.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(ae){Vs(r,r.return,ae)}if(r=m,o=r.updateQueue,o!==null){var C=r.stateNode;try{var $=o.shared.hiddenCallbacks;if($!==null)for(o.shared.hiddenCallbacks=null,o=0;o<$.length;o++)bh($[o],C)}catch(ae){Vs(r,r.return,ae)}}a&&j&64&&Of(m),wi(m,m.return);break;case 27:Uf(m);case 26:case 5:kl(o,m,a),a&&r===null&&j&4&&Rf(m),wi(m,m.return);break;case 12:kl(o,m,a);break;case 31:kl(o,m,a),a&&j&4&&Hf(o,m);break;case 13:kl(o,m,a),a&&j&4&&Ff(o,m);break;case 22:m.memoizedState===null&&kl(o,m,a),wi(m,m.return);break;case 30:break;default:kl(o,m,a)}t=t.sibling}}function Lu(s,t){var a=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==a&&(s!=null&&s.refCount++,a!=null&&oi(a))}function Uu(s,t){s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&oi(s))}function Xa(s,t,a,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)qf(s,t,a,r),t=t.sibling}function qf(s,t,a,r){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Xa(s,t,a,r),o&2048&&yi(9,t);break;case 1:Xa(s,t,a,r);break;case 3:Xa(s,t,a,r),o&2048&&(s=null,t.alternate!==null&&(s=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==s&&(t.refCount++,s!=null&&oi(s)));break;case 12:if(o&2048){Xa(s,t,a,r),s=t.stateNode;try{var m=t.memoizedProps,j=m.id,C=m.onPostCommit;typeof C=="function"&&C(j,t.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch($){Vs(t,t.return,$)}}else Xa(s,t,a,r);break;case 31:Xa(s,t,a,r);break;case 13:Xa(s,t,a,r);break;case 23:break;case 22:m=t.stateNode,j=t.alternate,t.memoizedState!==null?m._visibility&2?Xa(s,t,a,r):_i(s,t):m._visibility&2?Xa(s,t,a,r):(m._visibility|=2,_r(s,t,a,r,(t.subtreeFlags&10256)!==0||!1)),o&2048&&Lu(j,t);break;case 24:Xa(s,t,a,r),o&2048&&Uu(t.alternate,t);break;default:Xa(s,t,a,r)}}function _r(s,t,a,r,o){for(o=o&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var m=s,j=t,C=a,$=r,ae=j.flags;switch(j.tag){case 0:case 11:case 15:_r(m,j,C,$,o),yi(8,j);break;case 23:break;case 22:var ge=j.stateNode;j.memoizedState!==null?ge._visibility&2?_r(m,j,C,$,o):_i(m,j):(ge._visibility|=2,_r(m,j,C,$,o)),o&&ae&2048&&Lu(j.alternate,j);break;case 24:_r(m,j,C,$,o),o&&ae&2048&&Uu(j.alternate,j);break;default:_r(m,j,C,$,o)}t=t.sibling}}function _i(s,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=s,r=t,o=r.flags;switch(r.tag){case 22:_i(a,r),o&2048&&Lu(r.alternate,r);break;case 24:_i(a,r),o&2048&&Uu(r.alternate,r);break;default:_i(a,r)}t=t.sibling}}var Si=8192;function Sr(s,t,a){if(s.subtreeFlags&Si)for(s=s.child;s!==null;)Kf(s,t,a),s=s.sibling}function Kf(s,t,a){switch(s.tag){case 26:Sr(s,t,a),s.flags&Si&&s.memoizedState!==null&&c0(a,Ja,s.memoizedState,s.memoizedProps);break;case 5:Sr(s,t,a);break;case 3:case 4:var r=Ja;Ja=xo(s.stateNode.containerInfo),Sr(s,t,a),Ja=r;break;case 22:s.memoizedState===null&&(r=s.alternate,r!==null&&r.memoizedState!==null?(r=Si,Si=16777216,Sr(s,t,a),Si=r):Sr(s,t,a));break;default:Sr(s,t,a)}}function Qf(s){var t=s.alternate;if(t!==null&&(s=t.child,s!==null)){t.child=null;do t=s.sibling,s.sibling=null,s=t;while(s!==null)}}function ki(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var r=t[a];Pt=r,Jf(r,s)}Qf(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Yf(s),s=s.sibling}function Yf(s){switch(s.tag){case 0:case 11:case 15:ki(s),s.flags&2048&&Jl(9,s,s.return);break;case 3:ki(s);break;case 12:ki(s);break;case 22:var t=s.stateNode;s.memoizedState!==null&&t._visibility&2&&(s.return===null||s.return.tag!==13)?(t._visibility&=-3,Wc(s)):ki(s);break;default:ki(s)}}function Wc(s){var t=s.deletions;if((s.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var r=t[a];Pt=r,Jf(r,s)}Qf(s)}for(s=s.child;s!==null;){switch(t=s,t.tag){case 0:case 11:case 15:Jl(8,t,t.return),Wc(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,Wc(t));break;default:Wc(t)}s=s.sibling}}function Jf(s,t){for(;Pt!==null;){var a=Pt;switch(a.tag){case 0:case 11:case 15:Jl(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var r=a.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:oi(a.memoizedState.cache)}if(r=a.child,r!==null)r.return=a,Pt=r;else e:for(a=s;Pt!==null;){r=Pt;var o=r.sibling,m=r.return;if(If(r),r===a){Pt=null;break e}if(o!==null){o.return=m,Pt=o;break e}Pt=m}}}var wy={getCacheForType:function(s){var t=Vt(Mt),a=t.data.get(s);return a===void 0&&(a=s(),t.data.set(s,a)),a},cacheSignal:function(){return Vt(Mt).controller.signal}},_y=typeof WeakMap=="function"?WeakMap:Map,Ps=0,Ws=null,_s=null,Ts=0,Gs=0,wa=null,Xl=!1,kr=!1,$u=!1,Cl=0,Nt=0,Zl=0,$n=0,Bu=0,_a=0,Cr=0,Ci=null,ha=null,Iu=!1,eo=0,Xf=0,so=1/0,to=null,Wl=null,Rt=0,en=null,Tr=null,Tl=0,Pu=0,Hu=null,Zf=null,Ti=0,Fu=null;function Sa(){return(Ps&2)!==0&&Ts!==0?Ts&-Ts:z.T!==null?Yu():re()}function Wf(){if(_a===0)if((Ts&536870912)===0||zs){var s=Et;Et<<=1,(Et&3932160)===0&&(Et=262144),_a=s}else _a=536870912;return s=ba.current,s!==null&&(s.flags|=32),_a}function fa(s,t,a){(s===Ws&&(Gs===2||Gs===9)||s.cancelPendingCommit!==null)&&(Er(s,0),sn(s,Ts,_a,!1)),Re(s,a),((Ps&2)===0||s!==Ws)&&(s===Ws&&((Ps&2)===0&&($n|=a),Nt===4&&sn(s,Ts,_a,!1)),rl(s))}function ep(s,t,a){if((Ps&6)!==0)throw Error(c(327));var r=!a&&(t&127)===0&&(t&s.expiredLanes)===0||ul(s,t),o=r?Cy(s,t):Vu(s,t,!0),m=r;do{if(o===0){kr&&!r&&sn(s,t,0,!1);break}else{if(a=s.current.alternate,m&&!Sy(a)){o=Vu(s,t,!1),m=!1;continue}if(o===2){if(m=t,s.errorRecoveryDisabledLanes&m)var j=0;else j=s.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){t=j;e:{var C=s;o=Ci;var $=C.current.memoizedState.isDehydrated;if($&&(Er(C,j).flags|=256),j=Vu(C,j,!1),j!==2){if($u&&!$){C.errorRecoveryDisabledLanes|=m,$n|=m,o=4;break e}m=ha,ha=o,m!==null&&(ha===null?ha=m:ha.push.apply(ha,m))}o=j}if(m=!1,o!==2)continue}}if(o===1){Er(s,0),sn(s,t,0,!0);break}e:{switch(r=s,m=o,m){case 0:case 1:throw Error(c(345));case 4:if((t&4194048)!==t)break;case 6:sn(r,t,_a,!Xl);break e;case 2:ha=null;break;case 3:case 5:break;default:throw Error(c(329))}if((t&62914560)===t&&(o=eo+300-mt(),10<o)){if(sn(r,t,_a,!Xl),tl(r,0,!0)!==0)break e;Tl=t,r.timeoutHandle=zp(sp.bind(null,r,a,ha,to,Iu,t,_a,$n,Cr,Xl,m,"Throttled",-0,0),o);break e}sp(r,a,ha,to,Iu,t,_a,$n,Cr,Xl,m,null,-0,0)}}break}while(!0);rl(s)}function sp(s,t,a,r,o,m,j,C,$,ae,ge,be,ce,me){if(s.timeoutHandle=-1,be=t.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:xl},Kf(t,m,be);var He=(m&62914560)===m?eo-mt():(m&4194048)===m?Xf-mt():0;if(He=o0(be,He),He!==null){Tl=m,s.cancelPendingCommit=He(op.bind(null,s,t,m,a,r,o,j,C,$,ge,be,null,ce,me)),sn(s,m,j,!ae);return}}op(s,t,m,a,r,o,j,C,$)}function Sy(s){for(var t=s;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var r=0;r<a.length;r++){var o=a[r],m=o.getSnapshot;o=o.value;try{if(!va(m(),o))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===s)break;for(;t.sibling===null;){if(t.return===null||t.return===s)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sn(s,t,a,r){t&=~Bu,t&=~$n,s.suspendedLanes|=t,s.pingedLanes&=~t,r&&(s.warmLanes|=t),r=s.expirationTimes;for(var o=t;0<o;){var m=31-bs(o),j=1<<m;r[m]=-1,o&=~j}a!==0&&Dt(s,a,t)}function ao(){return(Ps&6)===0?(Ei(0),!1):!0}function Gu(){if(_s!==null){if(Gs===0)var s=_s.return;else s=_s,gl=En=null,ru(s),vr=null,ui=0,s=_s;for(;s!==null;)Af(s.alternate,s),s=s.return;_s=null}}function Er(s,t){var a=s.timeoutHandle;a!==-1&&(s.timeoutHandle=-1,Vy(a)),a=s.cancelPendingCommit,a!==null&&(s.cancelPendingCommit=null,a()),Tl=0,Gu(),Ws=s,_s=a=fl(s.current,null),Ts=t,Gs=0,wa=null,Xl=!1,kr=ul(s,t),$u=!1,Cr=_a=Bu=$n=Zl=Nt=0,ha=Ci=null,Iu=!1,(t&8)!==0&&(t|=t&32);var r=s.entangledLanes;if(r!==0)for(s=s.entanglements,r&=t;0<r;){var o=31-bs(r),m=1<<o;t|=s[o],r&=~m}return Cl=t,_c(),a}function tp(s,t){cs=null,z.H=vi,t===jr||t===Ac?(t=gh(),Gs=3):t===Qd?(t=gh(),Gs=4):Gs=t===yu?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,wa=t,_s===null&&(Nt=1,qc(s,Ua(t,s.current)))}function ap(){var s=ba.current;return s===null?!0:(Ts&4194048)===Ts?Pa===null:(Ts&62914560)===Ts||(Ts&536870912)!==0?s===Pa:!1}function lp(){var s=z.H;return z.H=vi,s===null?vi:s}function np(){var s=z.A;return z.A=wy,s}function lo(){Nt=4,Xl||(Ts&4194048)!==Ts&&ba.current!==null||(kr=!0),(Zl&134217727)===0&&($n&134217727)===0||Ws===null||sn(Ws,Ts,_a,!1)}function Vu(s,t,a){var r=Ps;Ps|=2;var o=lp(),m=np();(Ws!==s||Ts!==t)&&(to=null,Er(s,t)),t=!1;var j=Nt;e:do try{if(Gs!==0&&_s!==null){var C=_s,$=wa;switch(Gs){case 8:Gu(),j=6;break e;case 3:case 2:case 9:case 6:ba.current===null&&(t=!0);var ae=Gs;if(Gs=0,wa=null,Mr(s,C,$,ae),a&&kr){j=0;break e}break;default:ae=Gs,Gs=0,wa=null,Mr(s,C,$,ae)}}ky(),j=Nt;break}catch(ge){tp(s,ge)}while(!0);return t&&s.shellSuspendCounter++,gl=En=null,Ps=r,z.H=o,z.A=m,_s===null&&(Ws=null,Ts=0,_c()),j}function ky(){for(;_s!==null;)rp(_s)}function Cy(s,t){var a=Ps;Ps|=2;var r=lp(),o=np();Ws!==s||Ts!==t?(to=null,so=mt()+500,Er(s,t)):kr=ul(s,t);e:do try{if(Gs!==0&&_s!==null){t=_s;var m=wa;s:switch(Gs){case 1:Gs=0,wa=null,Mr(s,t,m,1);break;case 2:case 9:if(fh(m)){Gs=0,wa=null,ip(t);break}t=function(){Gs!==2&&Gs!==9||Ws!==s||(Gs=7),rl(s)},m.then(t,t);break e;case 3:Gs=7;break e;case 4:Gs=5;break e;case 7:fh(m)?(Gs=0,wa=null,ip(t)):(Gs=0,wa=null,Mr(s,t,m,7));break;case 5:var j=null;switch(_s.tag){case 26:j=_s.memoizedState;case 5:case 27:var C=_s;if(j?qp(j):C.stateNode.complete){Gs=0,wa=null;var $=C.sibling;if($!==null)_s=$;else{var ae=C.return;ae!==null?(_s=ae,no(ae)):_s=null}break s}}Gs=0,wa=null,Mr(s,t,m,5);break;case 6:Gs=0,wa=null,Mr(s,t,m,6);break;case 8:Gu(),Nt=6;break e;default:throw Error(c(462))}}Ty();break}catch(ge){tp(s,ge)}while(!0);return gl=En=null,z.H=r,z.A=o,Ps=a,_s!==null?0:(Ws=null,Ts=0,_c(),Nt)}function Ty(){for(;_s!==null&&!Qa();)rp(_s)}function rp(s){var t=Mf(s.alternate,s,Cl);s.memoizedProps=s.pendingProps,t===null?no(s):_s=t}function ip(s){var t=s,a=t.alternate;switch(t.tag){case 15:case 0:t=_f(a,t,t.pendingProps,t.type,void 0,Ts);break;case 11:t=_f(a,t,t.pendingProps,t.type.render,t.ref,Ts);break;case 5:ru(t);default:Af(a,t),t=_s=lh(t,Cl),t=Mf(a,t,Cl)}s.memoizedProps=s.pendingProps,t===null?no(s):_s=t}function Mr(s,t,a,r){gl=En=null,ru(t),vr=null,ui=0;var o=t.return;try{if(py(s,o,t,a,Ts)){Nt=1,qc(s,Ua(a,s.current)),_s=null;return}}catch(m){if(o!==null)throw _s=o,m;Nt=1,qc(s,Ua(a,s.current)),_s=null;return}t.flags&32768?(zs||r===1?s=!0:kr||(Ts&536870912)!==0?s=!1:(Xl=s=!0,(r===2||r===9||r===3||r===6)&&(r=ba.current,r!==null&&r.tag===13&&(r.flags|=16384))),cp(t,s)):no(t)}function no(s){var t=s;do{if((t.flags&32768)!==0){cp(t,Xl);return}s=t.return;var a=vy(t.alternate,t,Cl);if(a!==null){_s=a;return}if(t=t.sibling,t!==null){_s=t;return}_s=t=s}while(t!==null);Nt===0&&(Nt=5)}function cp(s,t){do{var a=Ny(s.alternate,s);if(a!==null){a.flags&=32767,_s=a;return}if(a=s.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(s=s.sibling,s!==null)){_s=s;return}_s=s=a}while(s!==null);Nt=6,_s=null}function op(s,t,a,r,o,m,j,C,$){s.cancelPendingCommit=null;do ro();while(Rt!==0);if((Ps&6)!==0)throw Error(c(327));if(t!==null){if(t===s.current)throw Error(c(177));if(m=t.lanes|t.childLanes,m|=Od,Hs(s,a,m,j,C,$),s===Ws&&(_s=Ws=null,Ts=0),Tr=t,en=s,Tl=a,Pu=m,Hu=o,Zf=r,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ay(We,function(){return hp(),null})):(s.callbackNode=null,s.callbackPriority=0),r=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||r){r=z.T,z.T=null,o=V.p,V.p=2,j=Ps,Ps|=4;try{by(s,t,a)}finally{Ps=j,V.p=o,z.T=r}}Rt=1,dp(),up(),mp()}}function dp(){if(Rt===1){Rt=0;var s=en,t=Tr,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=z.T,z.T=null;var r=V.p;V.p=2;var o=Ps;Ps|=4;try{Gf(t,s);var m=am,j=Yx(s.containerInfo),C=m.focusedElem,$=m.selectionRange;if(j!==C&&C&&C.ownerDocument&&Qx(C.ownerDocument.documentElement,C)){if($!==null&&Td(C)){var ae=$.start,ge=$.end;if(ge===void 0&&(ge=ae),"selectionStart"in C)C.selectionStart=ae,C.selectionEnd=Math.min(ge,C.value.length);else{var be=C.ownerDocument||document,ce=be&&be.defaultView||window;if(ce.getSelection){var me=ce.getSelection(),He=C.textContent.length,Xe=Math.min($.start,He),Xs=$.end===void 0?Xe:Math.min($.end,He);!me.extend&&Xe>Xs&&(j=Xs,Xs=Xe,Xe=j);var Y=Kx(C,Xe),G=Kx(C,Xs);if(Y&&G&&(me.rangeCount!==1||me.anchorNode!==Y.node||me.anchorOffset!==Y.offset||me.focusNode!==G.node||me.focusOffset!==G.offset)){var te=be.createRange();te.setStart(Y.node,Y.offset),me.removeAllRanges(),Xe>Xs?(me.addRange(te),me.extend(G.node,G.offset)):(te.setEnd(G.node,G.offset),me.addRange(te))}}}}for(be=[],me=C;me=me.parentNode;)me.nodeType===1&&be.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<be.length;C++){var Ne=be[C];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}vo=!!tm,am=tm=null}finally{Ps=o,V.p=r,z.T=a}}s.current=t,Rt=2}}function up(){if(Rt===2){Rt=0;var s=en,t=Tr,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=z.T,z.T=null;var r=V.p;V.p=2;var o=Ps;Ps|=4;try{Bf(s,t.alternate,t)}finally{Ps=o,V.p=r,z.T=a}}Rt=3}}function mp(){if(Rt===4||Rt===3){Rt=0,Ft();var s=en,t=Tr,a=Tl,r=Zf;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Rt=5:(Rt=0,Tr=en=null,xp(s,s.pendingLanes));var o=s.pendingLanes;if(o===0&&(Wl=null),xt(a),t=t.stateNode,as&&typeof as.onCommitFiberRoot=="function")try{as.onCommitFiberRoot(Ns,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=z.T,o=V.p,V.p=2,z.T=null;try{for(var m=s.onRecoverableError,j=0;j<r.length;j++){var C=r[j];m(C.value,{componentStack:C.stack})}}finally{z.T=t,V.p=o}}(Tl&3)!==0&&ro(),rl(s),o=s.pendingLanes,(a&261930)!==0&&(o&42)!==0?s===Fu?Ti++:(Ti=0,Fu=s):Ti=0,Ei(0)}}function xp(s,t){(s.pooledCacheLanes&=t)===0&&(t=s.pooledCache,t!=null&&(s.pooledCache=null,oi(t)))}function ro(){return dp(),up(),mp(),hp()}function hp(){if(Rt!==5)return!1;var s=en,t=Pu;Pu=0;var a=xt(Tl),r=z.T,o=V.p;try{V.p=32>a?32:a,z.T=null,a=Hu,Hu=null;var m=en,j=Tl;if(Rt=0,Tr=en=null,Tl=0,(Ps&6)!==0)throw Error(c(331));var C=Ps;if(Ps|=4,Yf(m.current),qf(m,m.current,j,a),Ps=C,Ei(0,!1),as&&typeof as.onPostCommitFiberRoot=="function")try{as.onPostCommitFiberRoot(Ns,m)}catch{}return!0}finally{V.p=o,z.T=r,xp(s,t)}}function fp(s,t,a){t=Ua(a,t),t=bu(s.stateNode,t,2),s=Kl(s,t,2),s!==null&&(Re(s,2),rl(s))}function Vs(s,t,a){if(s.tag===3)fp(s,s,a);else for(;t!==null;){if(t.tag===3){fp(t,s,a);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wl===null||!Wl.has(r))){s=Ua(a,s),a=pf(2),r=Kl(t,a,2),r!==null&&(gf(a,r,t,s),Re(r,2),rl(r));break}}t=t.return}}function qu(s,t,a){var r=s.pingCache;if(r===null){r=s.pingCache=new _y;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(a)||($u=!0,o.add(a),s=Ey.bind(null,s,t,a),t.then(s,s))}function Ey(s,t,a){var r=s.pingCache;r!==null&&r.delete(t),s.pingedLanes|=s.suspendedLanes&a,s.warmLanes&=~a,Ws===s&&(Ts&a)===a&&(Nt===4||Nt===3&&(Ts&62914560)===Ts&&300>mt()-eo?(Ps&2)===0&&Er(s,0):Bu|=a,Cr===Ts&&(Cr=0)),rl(s)}function pp(s,t){t===0&&(t=W()),s=kn(s,t),s!==null&&(Re(s,t),rl(s))}function My(s){var t=s.memoizedState,a=0;t!==null&&(a=t.retryLane),pp(s,a)}function zy(s,t){var a=0;switch(s.tag){case 31:case 13:var r=s.stateNode,o=s.memoizedState;o!==null&&(a=o.retryLane);break;case 19:r=s.stateNode;break;case 22:r=s.stateNode._retryCache;break;default:throw Error(c(314))}r!==null&&r.delete(t),pp(s,a)}function Ay(s,t){return Ut(s,t)}var io=null,zr=null,Ku=!1,co=!1,Qu=!1,tn=0;function rl(s){s!==zr&&s.next===null&&(zr===null?io=zr=s:zr=zr.next=s),co=!0,Ku||(Ku=!0,Dy())}function Ei(s,t){if(!Qu&&co){Qu=!0;do for(var a=!1,r=io;r!==null;){if(s!==0){var o=r.pendingLanes;if(o===0)var m=0;else{var j=r.suspendedLanes,C=r.pingedLanes;m=(1<<31-bs(42|s)+1)-1,m&=o&~(j&~C),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(a=!0,Np(r,m))}else m=Ts,m=tl(r,r===Ws?m:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(m&3)===0||ul(r,m)||(a=!0,Np(r,m));r=r.next}while(a);Qu=!1}}function Oy(){gp()}function gp(){co=Ku=!1;var s=0;tn!==0&&Gy()&&(s=tn);for(var t=mt(),a=null,r=io;r!==null;){var o=r.next,m=jp(r,t);m===0?(r.next=null,a===null?io=o:a.next=o,o===null&&(zr=a)):(a=r,(s!==0||(m&3)!==0)&&(co=!0)),r=o}Rt!==0&&Rt!==5||Ei(s),tn!==0&&(tn=0)}function jp(s,t){for(var a=s.suspendedLanes,r=s.pingedLanes,o=s.expirationTimes,m=s.pendingLanes&-62914561;0<m;){var j=31-bs(m),C=1<<j,$=o[j];$===-1?((C&a)===0||(C&r)!==0)&&(o[j]=Xn(C,t)):$<=t&&(s.expiredLanes|=C),m&=~C}if(t=Ws,a=Ts,a=tl(s,s===t?a:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),r=s.callbackNode,a===0||s===t&&(Gs===2||Gs===9)||s.cancelPendingCommit!==null)return r!==null&&r!==null&&aa(r),s.callbackNode=null,s.callbackPriority=0;if((a&3)===0||ul(s,a)){if(t=a&-a,t===s.callbackPriority)return t;switch(r!==null&&aa(r),xt(a)){case 2:case 8:a=Ke;break;case 32:a=We;break;case 268435456:a=ts;break;default:a=We}return r=vp.bind(null,s),a=Ut(a,r),s.callbackPriority=t,s.callbackNode=a,t}return r!==null&&r!==null&&aa(r),s.callbackPriority=2,s.callbackNode=null,2}function vp(s,t){if(Rt!==0&&Rt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var a=s.callbackNode;if(ro()&&s.callbackNode!==a)return null;var r=Ts;return r=tl(s,s===Ws?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),r===0?null:(ep(s,r,t),jp(s,mt()),s.callbackNode!=null&&s.callbackNode===a?vp.bind(null,s):null)}function Np(s,t){if(ro())return null;ep(s,t,!0)}function Dy(){qy(function(){(Ps&6)!==0?Ut(Ve,Oy):gp()})}function Yu(){if(tn===0){var s=pr;s===0&&(s=Ms,Ms<<=1,(Ms&261888)===0&&(Ms=256)),tn=s}return tn}function bp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:pc(""+s)}function yp(s,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,s.id&&a.setAttribute("form",s.id),t.parentNode.insertBefore(a,t),s=new FormData(s),a.parentNode.removeChild(a),s}function Ry(s,t,a,r,o){if(t==="submit"&&a&&a.stateNode===o){var m=bp((o[is]||null).action),j=r.submitter;j&&(t=(t=j[is]||null)?bp(t.formAction):j.getAttribute("formAction"),t!==null&&(m=t,j=null));var C=new Nc("action","action",null,r,o);s.push({event:C,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(tn!==0){var $=j?yp(o,j):new FormData(o);fu(a,{pending:!0,data:$,method:o.method,action:m},null,$)}}else typeof m=="function"&&(C.preventDefault(),$=j?yp(o,j):new FormData(o),fu(a,{pending:!0,data:$,method:o.method,action:m},m,$))},currentTarget:o}]})}}for(var Ju=0;Ju<Ad.length;Ju++){var Xu=Ad[Ju],Ly=Xu.toLowerCase(),Uy=Xu[0].toUpperCase()+Xu.slice(1);Ya(Ly,"on"+Uy)}Ya(Zx,"onAnimationEnd"),Ya(Wx,"onAnimationIteration"),Ya(eh,"onAnimationStart"),Ya("dblclick","onDoubleClick"),Ya("focusin","onFocus"),Ya("focusout","onBlur"),Ya(Wb,"onTransitionRun"),Ya(ey,"onTransitionStart"),Ya(sy,"onTransitionCancel"),Ya(sh,"onTransitionEnd"),tr("onMouseEnter",["mouseout","mouseover"]),tr("onMouseLeave",["mouseout","mouseover"]),tr("onPointerEnter",["pointerout","pointerover"]),tr("onPointerLeave",["pointerout","pointerover"]),yn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yn("onBeforeInput",["compositionend","keypress","textInput","paste"]),yn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$y=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mi));function wp(s,t){t=(t&4)!==0;for(var a=0;a<s.length;a++){var r=s[a],o=r.event;r=r.listeners;e:{var m=void 0;if(t)for(var j=r.length-1;0<=j;j--){var C=r[j],$=C.instance,ae=C.currentTarget;if(C=C.listener,$!==m&&o.isPropagationStopped())break e;m=C,o.currentTarget=ae;try{m(o)}catch(ge){wc(ge)}o.currentTarget=null,m=$}else for(j=0;j<r.length;j++){if(C=r[j],$=C.instance,ae=C.currentTarget,C=C.listener,$!==m&&o.isPropagationStopped())break e;m=C,o.currentTarget=ae;try{m(o)}catch(ge){wc(ge)}o.currentTarget=null,m=$}}}}function Ss(s,t){var a=t[ja];a===void 0&&(a=t[ja]=new Set);var r=s+"__bubble";a.has(r)||(_p(t,s,2,!1),a.add(r))}function Zu(s,t,a){var r=0;t&&(r|=4),_p(a,s,r,t)}var oo="_reactListening"+Math.random().toString(36).slice(2);function Wu(s){if(!s[oo]){s[oo]=!0,px.forEach(function(a){a!=="selectionchange"&&($y.has(a)||Zu(a,!1,s),Zu(a,!0,s))});var t=s.nodeType===9?s:s.ownerDocument;t===null||t[oo]||(t[oo]=!0,Zu("selectionchange",!1,t))}}function _p(s,t,a,r){switch(Wp(t)){case 2:var o=m0;break;case 8:o=x0;break;default:o=hm}a=o.bind(null,t,a,s),o=void 0,!vd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?s.addEventListener(t,a,{capture:!0,passive:o}):s.addEventListener(t,a,!0):o!==void 0?s.addEventListener(t,a,{passive:o}):s.addEventListener(t,a,!1)}function em(s,t,a,r,o){var m=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var j=r.tag;if(j===3||j===4){var C=r.stateNode.containerInfo;if(C===o)break;if(j===4)for(j=r.return;j!==null;){var $=j.tag;if(($===3||$===4)&&j.stateNode.containerInfo===o)return;j=j.return}for(;C!==null;){if(j=Wn(C),j===null)return;if($=j.tag,$===5||$===6||$===26||$===27){r=m=j;continue e}C=C.parentNode}}r=r.return}Tx(function(){var ae=m,ge=gd(a),be=[];e:{var ce=th.get(s);if(ce!==void 0){var me=Nc,He=s;switch(s){case"keypress":if(jc(a)===0)break e;case"keydown":case"keyup":me=zb;break;case"focusin":He="focus",me=wd;break;case"focusout":He="blur",me=wd;break;case"beforeblur":case"afterblur":me=wd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=zx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=vb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=Db;break;case Zx:case Wx:case eh:me=yb;break;case sh:me=Lb;break;case"scroll":case"scrollend":me=gb;break;case"wheel":me=$b;break;case"copy":case"cut":case"paste":me=_b;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Ox;break;case"toggle":case"beforetoggle":me=Ib}var Xe=(t&4)!==0,Xs=!Xe&&(s==="scroll"||s==="scrollend"),Y=Xe?ce!==null?ce+"Capture":null:ce;Xe=[];for(var G=ae,te;G!==null;){var Ne=G;if(te=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||te===null||Y===null||(Ne=Zr(G,Y),Ne!=null&&Xe.push(zi(G,Ne,te))),Xs)break;G=G.return}0<Xe.length&&(ce=new me(ce,He,null,a,ge),be.push({event:ce,listeners:Xe}))}}if((t&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",me=s==="mouseout"||s==="pointerout",ce&&a!==pd&&(He=a.relatedTarget||a.fromElement)&&(Wn(He)||He[jt]))break e;if((me||ce)&&(ce=ge.window===ge?ge:(ce=ge.ownerDocument)?ce.defaultView||ce.parentWindow:window,me?(He=a.relatedTarget||a.toElement,me=ae,He=He?Wn(He):null,He!==null&&(Xs=x(He),Xe=He.tag,He!==Xs||Xe!==5&&Xe!==27&&Xe!==6)&&(He=null)):(me=null,He=ae),me!==He)){if(Xe=zx,Ne="onMouseLeave",Y="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(Xe=Ox,Ne="onPointerLeave",Y="onPointerEnter",G="pointer"),Xs=me==null?ce:Xr(me),te=He==null?ce:Xr(He),ce=new Xe(Ne,G+"leave",me,a,ge),ce.target=Xs,ce.relatedTarget=te,Ne=null,Wn(ge)===ae&&(Xe=new Xe(Y,G+"enter",He,a,ge),Xe.target=te,Xe.relatedTarget=Xs,Ne=Xe),Xs=Ne,me&&He)s:{for(Xe=By,Y=me,G=He,te=0,Ne=Y;Ne;Ne=Xe(Ne))te++;Ne=0;for(var Qe=G;Qe;Qe=Xe(Qe))Ne++;for(;0<te-Ne;)Y=Xe(Y),te--;for(;0<Ne-te;)G=Xe(G),Ne--;for(;te--;){if(Y===G||G!==null&&Y===G.alternate){Xe=Y;break s}Y=Xe(Y),G=Xe(G)}Xe=null}else Xe=null;me!==null&&Sp(be,ce,me,Xe,!1),He!==null&&Xs!==null&&Sp(be,Xs,He,Xe,!0)}}e:{if(ce=ae?Xr(ae):window,me=ce.nodeName&&ce.nodeName.toLowerCase(),me==="select"||me==="input"&&ce.type==="file")var Us=Px;else if(Bx(ce))if(Hx)Us=Jb;else{Us=Qb;var Ge=Kb}else me=ce.nodeName,!me||me.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ae&&fd(ae.elementType)&&(Us=Px):Us=Yb;if(Us&&(Us=Us(s,ae))){Ix(be,Us,a,ge);break e}Ge&&Ge(s,ce,ae),s==="focusout"&&ae&&ce.type==="number"&&ae.memoizedProps.value!=null&&hd(ce,"number",ce.value)}switch(Ge=ae?Xr(ae):window,s){case"focusin":(Bx(Ge)||Ge.contentEditable==="true")&&(cr=Ge,Ed=ae,ri=null);break;case"focusout":ri=Ed=cr=null;break;case"mousedown":Md=!0;break;case"contextmenu":case"mouseup":case"dragend":Md=!1,Jx(be,a,ge);break;case"selectionchange":if(Zb)break;case"keydown":case"keyup":Jx(be,a,ge)}var os;if(Sd)e:{switch(s){case"compositionstart":var Es="onCompositionStart";break e;case"compositionend":Es="onCompositionEnd";break e;case"compositionupdate":Es="onCompositionUpdate";break e}Es=void 0}else ir?Ux(s,a)&&(Es="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&(Es="onCompositionStart");Es&&(Dx&&a.locale!=="ko"&&(ir||Es!=="onCompositionStart"?Es==="onCompositionEnd"&&ir&&(os=Ex()):(Il=ge,Nd="value"in Il?Il.value:Il.textContent,ir=!0)),Ge=uo(ae,Es),0<Ge.length&&(Es=new Ax(Es,s,null,a,ge),be.push({event:Es,listeners:Ge}),os?Es.data=os:(os=$x(a),os!==null&&(Es.data=os)))),(os=Hb?Fb(s,a):Gb(s,a))&&(Es=uo(ae,"onBeforeInput"),0<Es.length&&(Ge=new Ax("onBeforeInput","beforeinput",null,a,ge),be.push({event:Ge,listeners:Es}),Ge.data=os)),Ry(be,s,ae,a,ge)}wp(be,t)})}function zi(s,t,a){return{instance:s,listener:t,currentTarget:a}}function uo(s,t){for(var a=t+"Capture",r=[];s!==null;){var o=s,m=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||m===null||(o=Zr(s,a),o!=null&&r.unshift(zi(s,o,m)),o=Zr(s,t),o!=null&&r.push(zi(s,o,m))),s.tag===3)return r;s=s.return}return[]}function By(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Sp(s,t,a,r,o){for(var m=t._reactName,j=[];a!==null&&a!==r;){var C=a,$=C.alternate,ae=C.stateNode;if(C=C.tag,$!==null&&$===r)break;C!==5&&C!==26&&C!==27||ae===null||($=ae,o?(ae=Zr(a,m),ae!=null&&j.unshift(zi(a,ae,$))):o||(ae=Zr(a,m),ae!=null&&j.push(zi(a,ae,$)))),a=a.return}j.length!==0&&s.push({event:t,listeners:j})}var Iy=/\r\n?/g,Py=/\u0000|\uFFFD/g;function kp(s){return(typeof s=="string"?s:""+s).replace(Iy,`
`).replace(Py,"")}function Cp(s,t){return t=kp(t),kp(s)===t}function Js(s,t,a,r,o,m){switch(a){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||lr(s,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&lr(s,""+r);break;case"className":hc(s,"class",r);break;case"tabIndex":hc(s,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":hc(s,a,r);break;case"style":kx(s,r,m);break;case"data":if(t!=="object"){hc(s,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||a!=="href")){s.removeAttribute(a);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){s.removeAttribute(a);break}r=pc(""+r),s.setAttribute(a,r);break;case"action":case"formAction":if(typeof r=="function"){s.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(a==="formAction"?(t!=="input"&&Js(s,t,"name",o.name,o,null),Js(s,t,"formEncType",o.formEncType,o,null),Js(s,t,"formMethod",o.formMethod,o,null),Js(s,t,"formTarget",o.formTarget,o,null)):(Js(s,t,"encType",o.encType,o,null),Js(s,t,"method",o.method,o,null),Js(s,t,"target",o.target,o,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){s.removeAttribute(a);break}r=pc(""+r),s.setAttribute(a,r);break;case"onClick":r!=null&&(s.onclick=xl);break;case"onScroll":r!=null&&Ss("scroll",s);break;case"onScrollEnd":r!=null&&Ss("scrollend",s);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(c(61));if(a=r.__html,a!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=a}}break;case"multiple":s.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":s.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){s.removeAttribute("xlink:href");break}a=pc(""+r),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?s.setAttribute(a,""+r):s.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?s.setAttribute(a,""):s.removeAttribute(a);break;case"capture":case"download":r===!0?s.setAttribute(a,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?s.setAttribute(a,r):s.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?s.setAttribute(a,r):s.removeAttribute(a);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?s.removeAttribute(a):s.setAttribute(a,r);break;case"popover":Ss("beforetoggle",s),Ss("toggle",s),xc(s,"popover",r);break;case"xlinkActuate":ml(s,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ml(s,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ml(s,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ml(s,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ml(s,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ml(s,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ml(s,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ml(s,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ml(s,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":xc(s,"is",r);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=fb.get(a)||a,xc(s,a,r))}}function sm(s,t,a,r,o,m){switch(a){case"style":kx(s,r,m);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(c(61));if(a=r.__html,a!=null){if(o.children!=null)throw Error(c(60));s.innerHTML=a}}break;case"children":typeof r=="string"?lr(s,r):(typeof r=="number"||typeof r=="bigint")&&lr(s,""+r);break;case"onScroll":r!=null&&Ss("scroll",s);break;case"onScrollEnd":r!=null&&Ss("scrollend",s);break;case"onClick":r!=null&&(s.onclick=xl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gx.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(o=a.endsWith("Capture"),t=a.slice(2,o?a.length-7:void 0),m=s[is]||null,m=m!=null?m[a]:null,typeof m=="function"&&s.removeEventListener(t,m,o),typeof r=="function")){typeof m!="function"&&m!==null&&(a in s?s[a]=null:s.hasAttribute(a)&&s.removeAttribute(a)),s.addEventListener(t,r,o);break e}a in s?s[a]=r:r===!0?s.setAttribute(a,""):xc(s,a,r)}}}function Kt(s,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ss("error",s),Ss("load",s);var r=!1,o=!1,m;for(m in a)if(a.hasOwnProperty(m)){var j=a[m];if(j!=null)switch(m){case"src":r=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:Js(s,t,m,j,a,null)}}o&&Js(s,t,"srcSet",a.srcSet,a,null),r&&Js(s,t,"src",a.src,a,null);return;case"input":Ss("invalid",s);var C=m=j=o=null,$=null,ae=null;for(r in a)if(a.hasOwnProperty(r)){var ge=a[r];if(ge!=null)switch(r){case"name":o=ge;break;case"type":j=ge;break;case"checked":$=ge;break;case"defaultChecked":ae=ge;break;case"value":m=ge;break;case"defaultValue":C=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(c(137,t));break;default:Js(s,t,r,ge,a,null)}}yx(s,m,C,$,ae,j,o,!1);return;case"select":Ss("invalid",s),r=j=m=null;for(o in a)if(a.hasOwnProperty(o)&&(C=a[o],C!=null))switch(o){case"value":m=C;break;case"defaultValue":j=C;break;case"multiple":r=C;default:Js(s,t,o,C,a,null)}t=m,a=j,s.multiple=!!r,t!=null?ar(s,!!r,t,!1):a!=null&&ar(s,!!r,a,!0);return;case"textarea":Ss("invalid",s),m=o=r=null;for(j in a)if(a.hasOwnProperty(j)&&(C=a[j],C!=null))switch(j){case"value":r=C;break;case"defaultValue":o=C;break;case"children":m=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(c(91));break;default:Js(s,t,j,C,a,null)}_x(s,r,o,m);return;case"option":for($ in a)if(a.hasOwnProperty($)&&(r=a[$],r!=null))switch($){case"selected":s.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:Js(s,t,$,r,a,null)}return;case"dialog":Ss("beforetoggle",s),Ss("toggle",s),Ss("cancel",s),Ss("close",s);break;case"iframe":case"object":Ss("load",s);break;case"video":case"audio":for(r=0;r<Mi.length;r++)Ss(Mi[r],s);break;case"image":Ss("error",s),Ss("load",s);break;case"details":Ss("toggle",s);break;case"embed":case"source":case"link":Ss("error",s),Ss("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in a)if(a.hasOwnProperty(ae)&&(r=a[ae],r!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:Js(s,t,ae,r,a,null)}return;default:if(fd(t)){for(ge in a)a.hasOwnProperty(ge)&&(r=a[ge],r!==void 0&&sm(s,t,ge,r,a,void 0));return}}for(C in a)a.hasOwnProperty(C)&&(r=a[C],r!=null&&Js(s,t,C,r,a,null))}function Hy(s,t,a,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,m=null,j=null,C=null,$=null,ae=null,ge=null;for(me in a){var be=a[me];if(a.hasOwnProperty(me)&&be!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":$=be;default:r.hasOwnProperty(me)||Js(s,t,me,null,r,be)}}for(var ce in r){var me=r[ce];if(be=a[ce],r.hasOwnProperty(ce)&&(me!=null||be!=null))switch(ce){case"type":m=me;break;case"name":o=me;break;case"checked":ae=me;break;case"defaultChecked":ge=me;break;case"value":j=me;break;case"defaultValue":C=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(c(137,t));break;default:me!==be&&Js(s,t,ce,me,r,be)}}xd(s,j,C,$,ae,ge,m,o);return;case"select":me=j=C=ce=null;for(m in a)if($=a[m],a.hasOwnProperty(m)&&$!=null)switch(m){case"value":break;case"multiple":me=$;default:r.hasOwnProperty(m)||Js(s,t,m,null,r,$)}for(o in r)if(m=r[o],$=a[o],r.hasOwnProperty(o)&&(m!=null||$!=null))switch(o){case"value":ce=m;break;case"defaultValue":C=m;break;case"multiple":j=m;default:m!==$&&Js(s,t,o,m,r,$)}t=C,a=j,r=me,ce!=null?ar(s,!!a,ce,!1):!!r!=!!a&&(t!=null?ar(s,!!a,t,!0):ar(s,!!a,a?[]:"",!1));return;case"textarea":me=ce=null;for(C in a)if(o=a[C],a.hasOwnProperty(C)&&o!=null&&!r.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Js(s,t,C,null,r,o)}for(j in r)if(o=r[j],m=a[j],r.hasOwnProperty(j)&&(o!=null||m!=null))switch(j){case"value":ce=o;break;case"defaultValue":me=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(c(91));break;default:o!==m&&Js(s,t,j,o,r,m)}wx(s,ce,me);return;case"option":for(var He in a)if(ce=a[He],a.hasOwnProperty(He)&&ce!=null&&!r.hasOwnProperty(He))switch(He){case"selected":s.selected=!1;break;default:Js(s,t,He,null,r,ce)}for($ in r)if(ce=r[$],me=a[$],r.hasOwnProperty($)&&ce!==me&&(ce!=null||me!=null))switch($){case"selected":s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:Js(s,t,$,ce,r,me)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in a)ce=a[Xe],a.hasOwnProperty(Xe)&&ce!=null&&!r.hasOwnProperty(Xe)&&Js(s,t,Xe,null,r,ce);for(ae in r)if(ce=r[ae],me=a[ae],r.hasOwnProperty(ae)&&ce!==me&&(ce!=null||me!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(c(137,t));break;default:Js(s,t,ae,ce,r,me)}return;default:if(fd(t)){for(var Xs in a)ce=a[Xs],a.hasOwnProperty(Xs)&&ce!==void 0&&!r.hasOwnProperty(Xs)&&sm(s,t,Xs,void 0,r,ce);for(ge in r)ce=r[ge],me=a[ge],!r.hasOwnProperty(ge)||ce===me||ce===void 0&&me===void 0||sm(s,t,ge,ce,r,me);return}}for(var Y in a)ce=a[Y],a.hasOwnProperty(Y)&&ce!=null&&!r.hasOwnProperty(Y)&&Js(s,t,Y,null,r,ce);for(be in r)ce=r[be],me=a[be],!r.hasOwnProperty(be)||ce===me||ce==null&&me==null||Js(s,t,be,ce,r,me)}function Tp(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Fy(){if(typeof performance.getEntriesByType=="function"){for(var s=0,t=0,a=performance.getEntriesByType("resource"),r=0;r<a.length;r++){var o=a[r],m=o.transferSize,j=o.initiatorType,C=o.duration;if(m&&C&&Tp(j)){for(j=0,C=o.responseEnd,r+=1;r<a.length;r++){var $=a[r],ae=$.startTime;if(ae>C)break;var ge=$.transferSize,be=$.initiatorType;ge&&Tp(be)&&($=$.responseEnd,j+=ge*($<C?1:(C-ae)/($-ae)))}if(--r,t+=8*(m+j)/(o.duration/1e3),s++,10<s)break}}if(0<s)return t/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var tm=null,am=null;function mo(s){return s.nodeType===9?s:s.ownerDocument}function Ep(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mp(s,t){if(s===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&t==="foreignObject"?0:s}function lm(s,t){return s==="textarea"||s==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var nm=null;function Gy(){var s=window.event;return s&&s.type==="popstate"?s===nm?!1:(nm=s,!0):(nm=null,!1)}var zp=typeof setTimeout=="function"?setTimeout:void 0,Vy=typeof clearTimeout=="function"?clearTimeout:void 0,Ap=typeof Promise=="function"?Promise:void 0,qy=typeof queueMicrotask=="function"?queueMicrotask:typeof Ap<"u"?function(s){return Ap.resolve(null).then(s).catch(Ky)}:zp;function Ky(s){setTimeout(function(){throw s})}function an(s){return s==="head"}function Op(s,t){var a=t,r=0;do{var o=a.nextSibling;if(s.removeChild(a),o&&o.nodeType===8)if(a=o.data,a==="/$"||a==="/&"){if(r===0){s.removeChild(o),Rr(t);return}r--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")r++;else if(a==="html")Ai(s.ownerDocument.documentElement);else if(a==="head"){a=s.ownerDocument.head,Ai(a);for(var m=a.firstChild;m;){var j=m.nextSibling,C=m.nodeName;m[bn]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&m.rel.toLowerCase()==="stylesheet"||a.removeChild(m),m=j}}else a==="body"&&Ai(s.ownerDocument.body);a=o}while(a);Rr(t)}function Dp(s,t){var a=s;s=0;do{var r=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),r&&r.nodeType===8)if(a=r.data,a==="/$"){if(s===0)break;s--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||s++;a=r}while(a)}function rm(s){var t=s.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":rm(a),ud(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}s.removeChild(a)}}function Qy(s,t,a,r){for(;s.nodeType===1;){var o=a;if(s.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(r){if(!s[bn])switch(t){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(m=s.getAttribute("rel"),m==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(m!==o.rel||s.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||s.getAttribute("title")!==(o.title==null?null:o.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(m=s.getAttribute("src"),(m!==(o.src==null?null:o.src)||s.getAttribute("type")!==(o.type==null?null:o.type)||s.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&m&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(t==="input"&&s.type==="hidden"){var m=o.name==null?null:""+o.name;if(o.type==="hidden"&&s.getAttribute("name")===m)return s}else return s;if(s=Ha(s.nextSibling),s===null)break}return null}function Yy(s,t,a){if(t==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Ha(s.nextSibling),s===null))return null;return s}function Rp(s,t){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!t||(s=Ha(s.nextSibling),s===null))return null;return s}function im(s){return s.data==="$?"||s.data==="$~"}function cm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Jy(s,t){var a=s.ownerDocument;if(s.data==="$~")s._reactRetry=t;else if(s.data!=="$?"||a.readyState!=="loading")t();else{var r=function(){t(),a.removeEventListener("DOMContentLoaded",r)};a.addEventListener("DOMContentLoaded",r),s._reactRetry=r}}function Ha(s){for(;s!=null;s=s.nextSibling){var t=s.nodeType;if(t===1||t===3)break;if(t===8){if(t=s.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return s}var om=null;function Lp(s){s=s.nextSibling;for(var t=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"||a==="/&"){if(t===0)return Ha(s.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}s=s.nextSibling}return null}function Up(s){s=s.previousSibling;for(var t=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return s;t--}else a!=="/$"&&a!=="/&"||t++}s=s.previousSibling}return null}function $p(s,t,a){switch(t=mo(a),s){case"html":if(s=t.documentElement,!s)throw Error(c(452));return s;case"head":if(s=t.head,!s)throw Error(c(453));return s;case"body":if(s=t.body,!s)throw Error(c(454));return s;default:throw Error(c(451))}}function Ai(s){for(var t=s.attributes;t.length;)s.removeAttributeNode(t[0]);ud(s)}var Fa=new Map,Bp=new Set;function xo(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var El=V.d;V.d={f:Xy,r:Zy,D:Wy,C:e0,L:s0,m:t0,X:l0,S:a0,M:n0};function Xy(){var s=El.f(),t=ao();return s||t}function Zy(s){var t=er(s);t!==null&&t.tag===5&&t.type==="form"?sf(t):El.r(s)}var Ar=typeof document>"u"?null:document;function Ip(s,t,a){var r=Ar;if(r&&typeof t=="string"&&t){var o=Ra(t);o='link[rel="'+s+'"][href="'+o+'"]',typeof a=="string"&&(o+='[crossorigin="'+a+'"]'),Bp.has(o)||(Bp.add(o),s={rel:s,crossOrigin:a,href:t},r.querySelector(o)===null&&(t=r.createElement("link"),Kt(t,"link",s),It(t),r.head.appendChild(t)))}}function Wy(s){El.D(s),Ip("dns-prefetch",s,null)}function e0(s,t){El.C(s,t),Ip("preconnect",s,t)}function s0(s,t,a){El.L(s,t,a);var r=Ar;if(r&&s&&t){var o='link[rel="preload"][as="'+Ra(t)+'"]';t==="image"&&a&&a.imageSrcSet?(o+='[imagesrcset="'+Ra(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(o+='[imagesizes="'+Ra(a.imageSizes)+'"]')):o+='[href="'+Ra(s)+'"]';var m=o;switch(t){case"style":m=Or(s);break;case"script":m=Dr(s)}Fa.has(m)||(s=v({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:s,as:t},a),Fa.set(m,s),r.querySelector(o)!==null||t==="style"&&r.querySelector(Oi(m))||t==="script"&&r.querySelector(Di(m))||(t=r.createElement("link"),Kt(t,"link",s),It(t),r.head.appendChild(t)))}}function t0(s,t){El.m(s,t);var a=Ar;if(a&&s){var r=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ra(r)+'"][href="'+Ra(s)+'"]',m=o;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Dr(s)}if(!Fa.has(m)&&(s=v({rel:"modulepreload",href:s},t),Fa.set(m,s),a.querySelector(o)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Di(m)))return}r=a.createElement("link"),Kt(r,"link",s),It(r),a.head.appendChild(r)}}}function a0(s,t,a){El.S(s,t,a);var r=Ar;if(r&&s){var o=sr(r).hoistableStyles,m=Or(s);t=t||"default";var j=o.get(m);if(!j){var C={loading:0,preload:null};if(j=r.querySelector(Oi(m)))C.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":t},a),(a=Fa.get(m))&&dm(s,a);var $=j=r.createElement("link");It($),Kt($,"link",s),$._p=new Promise(function(ae,ge){$.onload=ae,$.onerror=ge}),$.addEventListener("load",function(){C.loading|=1}),$.addEventListener("error",function(){C.loading|=2}),C.loading|=4,ho(j,t,r)}j={type:"stylesheet",instance:j,count:1,state:C},o.set(m,j)}}}function l0(s,t){El.X(s,t);var a=Ar;if(a&&s){var r=sr(a).hoistableScripts,o=Dr(s),m=r.get(o);m||(m=a.querySelector(Di(o)),m||(s=v({src:s,async:!0},t),(t=Fa.get(o))&&um(s,t),m=a.createElement("script"),It(m),Kt(m,"link",s),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},r.set(o,m))}}function n0(s,t){El.M(s,t);var a=Ar;if(a&&s){var r=sr(a).hoistableScripts,o=Dr(s),m=r.get(o);m||(m=a.querySelector(Di(o)),m||(s=v({src:s,async:!0,type:"module"},t),(t=Fa.get(o))&&um(s,t),m=a.createElement("script"),It(m),Kt(m,"link",s),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},r.set(o,m))}}function Pp(s,t,a,r){var o=(o=H.current)?xo(o):null;if(!o)throw Error(c(446));switch(s){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=Or(a.href),a=sr(o).hoistableStyles,r=a.get(t),r||(r={type:"style",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){s=Or(a.href);var m=sr(o).hoistableStyles,j=m.get(s);if(j||(o=o.ownerDocument||o,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(s,j),(m=o.querySelector(Oi(s)))&&!m._p&&(j.instance=m,j.state.loading=5),Fa.has(s)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Fa.set(s,a),m||r0(o,s,a,j.state))),t&&r===null)throw Error(c(528,""));return j}if(t&&r!==null)throw Error(c(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Dr(a),a=sr(o).hoistableScripts,r=a.get(t),r||(r={type:"script",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,s))}}function Or(s){return'href="'+Ra(s)+'"'}function Oi(s){return'link[rel="stylesheet"]['+s+"]"}function Hp(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function r0(s,t,a,r){s.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=s.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),Kt(t,"link",a),It(t),s.head.appendChild(t))}function Dr(s){return'[src="'+Ra(s)+'"]'}function Di(s){return"script[async]"+s}function Fp(s,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var r=s.querySelector('style[data-href~="'+Ra(a.href)+'"]');if(r)return t.instance=r,It(r),r;var o=v({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return r=(s.ownerDocument||s).createElement("style"),It(r),Kt(r,"style",o),ho(r,a.precedence,s),t.instance=r;case"stylesheet":o=Or(a.href);var m=s.querySelector(Oi(o));if(m)return t.state.loading|=4,t.instance=m,It(m),m;r=Hp(a),(o=Fa.get(o))&&dm(r,o),m=(s.ownerDocument||s).createElement("link"),It(m);var j=m;return j._p=new Promise(function(C,$){j.onload=C,j.onerror=$}),Kt(m,"link",r),t.state.loading|=4,ho(m,a.precedence,s),t.instance=m;case"script":return m=Dr(a.src),(o=s.querySelector(Di(m)))?(t.instance=o,It(o),o):(r=a,(o=Fa.get(m))&&(r=v({},a),um(r,o)),s=s.ownerDocument||s,o=s.createElement("script"),It(o),Kt(o,"link",r),s.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(c(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(r=t.instance,t.state.loading|=4,ho(r,a.precedence,s));return t.instance}function ho(s,t,a){for(var r=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=r.length?r[r.length-1]:null,m=o,j=0;j<r.length;j++){var C=r[j];if(C.dataset.precedence===t)m=C;else if(m!==o)break}m?m.parentNode.insertBefore(s,m.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(s,t.firstChild))}function dm(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.title==null&&(s.title=t.title)}function um(s,t){s.crossOrigin==null&&(s.crossOrigin=t.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=t.referrerPolicy),s.integrity==null&&(s.integrity=t.integrity)}var fo=null;function Gp(s,t,a){if(fo===null){var r=new Map,o=fo=new Map;o.set(a,r)}else o=fo,r=o.get(a),r||(r=new Map,o.set(a,r));if(r.has(s))return r;for(r.set(s,null),a=a.getElementsByTagName(s),o=0;o<a.length;o++){var m=a[o];if(!(m[bn]||m[gs]||s==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var j=m.getAttribute(t)||"";j=s+j;var C=r.get(j);C?C.push(m):r.set(j,[m])}}return r}function Vp(s,t,a){s=s.ownerDocument||s,s.head.insertBefore(a,t==="title"?s.querySelector("head > title"):null)}function i0(s,t,a){if(a===1||t.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return s=t.disabled,typeof t.precedence=="string"&&s==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function qp(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function c0(s,t,a,r){if(a.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var o=Or(r.href),m=t.querySelector(Oi(o));if(m){t=m._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(s.count++,s=po.bind(s),t.then(s,s)),a.state.loading|=4,a.instance=m,It(m);return}m=t.ownerDocument||t,r=Hp(r),(o=Fa.get(o))&&dm(r,o),m=m.createElement("link"),It(m);var j=m;j._p=new Promise(function(C,$){j.onload=C,j.onerror=$}),Kt(m,"link",r),a.instance=m}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(s.count++,a=po.bind(s),t.addEventListener("load",a),t.addEventListener("error",a))}}var mm=0;function o0(s,t){return s.stylesheets&&s.count===0&&jo(s,s.stylesheets),0<s.count||0<s.imgCount?function(a){var r=setTimeout(function(){if(s.stylesheets&&jo(s,s.stylesheets),s.unsuspend){var m=s.unsuspend;s.unsuspend=null,m()}},6e4+t);0<s.imgBytes&&mm===0&&(mm=62500*Fy());var o=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&jo(s,s.stylesheets),s.unsuspend)){var m=s.unsuspend;s.unsuspend=null,m()}},(s.imgBytes>mm?50:800)+t);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(r),clearTimeout(o)}}:null}function po(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)jo(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var go=null;function jo(s,t){s.stylesheets=null,s.unsuspend!==null&&(s.count++,go=new Map,t.forEach(d0,s),go=null,po.call(s))}function d0(s,t){if(!(t.state.loading&4)){var a=go.get(s);if(a)var r=a.get(null);else{a=new Map,go.set(s,a);for(var o=s.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<o.length;m++){var j=o[m];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(a.set(j.dataset.precedence,j),r=j)}r&&a.set(null,r)}o=t.instance,j=o.getAttribute("data-precedence"),m=a.get(j)||r,m===r&&a.set(null,o),a.set(j,o),this.count++,r=po.bind(this),o.addEventListener("load",r),o.addEventListener("error",r),m?m.parentNode.insertBefore(o,m.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(o,s.firstChild)),t.state.loading|=4}}var Ri={$$typeof:M,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function u0(s,t,a,r,o,m,j,C,$){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ye(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ye(0),this.hiddenUpdates=ye(null),this.identifierPrefix=r,this.onUncaughtError=o,this.onCaughtError=m,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Kp(s,t,a,r,o,m,j,C,$,ae,ge,be){return s=new u0(s,t,a,j,$,ae,ge,be,C),t=1,m===!0&&(t|=24),m=Na(3,null,null,t),s.current=m,m.stateNode=s,t=Vd(),t.refCount++,s.pooledCache=t,t.refCount++,m.memoizedState={element:r,isDehydrated:a,cache:t},Yd(m),s}function Qp(s){return s?(s=ur,s):ur}function Yp(s,t,a,r,o,m){o=Qp(o),r.context===null?r.context=o:r.pendingContext=o,r=ql(t),r.payload={element:a},m=m===void 0?null:m,m!==null&&(r.callback=m),a=Kl(s,r,t),a!==null&&(fa(a,s,t),xi(a,s,t))}function Jp(s,t){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<t?a:t}}function xm(s,t){Jp(s,t),(s=s.alternate)&&Jp(s,t)}function Xp(s){if(s.tag===13||s.tag===31){var t=kn(s,67108864);t!==null&&fa(t,s,67108864),xm(s,67108864)}}function Zp(s){if(s.tag===13||s.tag===31){var t=Sa();t=ea(t);var a=kn(s,t);a!==null&&fa(a,s,t),xm(s,t)}}var vo=!0;function m0(s,t,a,r){var o=z.T;z.T=null;var m=V.p;try{V.p=2,hm(s,t,a,r)}finally{V.p=m,z.T=o}}function x0(s,t,a,r){var o=z.T;z.T=null;var m=V.p;try{V.p=8,hm(s,t,a,r)}finally{V.p=m,z.T=o}}function hm(s,t,a,r){if(vo){var o=fm(r);if(o===null)em(s,t,r,No,a),eg(s,r);else if(f0(o,s,t,a,r))r.stopPropagation();else if(eg(s,r),t&4&&-1<h0.indexOf(s)){for(;o!==null;){var m=er(o);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var j=Oa(m.pendingLanes);if(j!==0){var C=m;for(C.pendingLanes|=2,C.entangledLanes|=2;j;){var $=1<<31-bs(j);C.entanglements[1]|=$,j&=~$}rl(m),(Ps&6)===0&&(so=mt()+500,Ei(0))}}break;case 31:case 13:C=kn(m,2),C!==null&&fa(C,m,2),ao(),xm(m,2)}if(m=fm(r),m===null&&em(s,t,r,No,a),m===o)break;o=m}o!==null&&r.stopPropagation()}else em(s,t,r,null,a)}}function fm(s){return s=gd(s),pm(s)}var No=null;function pm(s){if(No=null,s=Wn(s),s!==null){var t=x(s);if(t===null)s=null;else{var a=t.tag;if(a===13){if(s=h(t),s!==null)return s;s=null}else if(a===31){if(s=f(t),s!==null)return s;s=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;s=null}else t!==s&&(s=null)}}return No=s,null}function Wp(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(q()){case Ve:return 2;case Ke:return 8;case We:case Ls:return 32;case ts:return 268435456;default:return 32}default:return 32}}var gm=!1,ln=null,nn=null,rn=null,Li=new Map,Ui=new Map,cn=[],h0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eg(s,t){switch(s){case"focusin":case"focusout":ln=null;break;case"dragenter":case"dragleave":nn=null;break;case"mouseover":case"mouseout":rn=null;break;case"pointerover":case"pointerout":Li.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ui.delete(t.pointerId)}}function $i(s,t,a,r,o,m){return s===null||s.nativeEvent!==m?(s={blockedOn:t,domEventName:a,eventSystemFlags:r,nativeEvent:m,targetContainers:[o]},t!==null&&(t=er(t),t!==null&&Xp(t)),s):(s.eventSystemFlags|=r,t=s.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),s)}function f0(s,t,a,r,o){switch(t){case"focusin":return ln=$i(ln,s,t,a,r,o),!0;case"dragenter":return nn=$i(nn,s,t,a,r,o),!0;case"mouseover":return rn=$i(rn,s,t,a,r,o),!0;case"pointerover":var m=o.pointerId;return Li.set(m,$i(Li.get(m)||null,s,t,a,r,o)),!0;case"gotpointercapture":return m=o.pointerId,Ui.set(m,$i(Ui.get(m)||null,s,t,a,r,o)),!0}return!1}function sg(s){var t=Wn(s.target);if(t!==null){var a=x(t);if(a!==null){if(t=a.tag,t===13){if(t=h(a),t!==null){s.blockedOn=t,fe(s.priority,function(){Zp(a)});return}}else if(t===31){if(t=f(a),t!==null){s.blockedOn=t,fe(s.priority,function(){Zp(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function bo(s){if(s.blockedOn!==null)return!1;for(var t=s.targetContainers;0<t.length;){var a=fm(s.nativeEvent);if(a===null){a=s.nativeEvent;var r=new a.constructor(a.type,a);pd=r,a.target.dispatchEvent(r),pd=null}else return t=er(a),t!==null&&Xp(t),s.blockedOn=a,!1;t.shift()}return!0}function tg(s,t,a){bo(s)&&a.delete(t)}function p0(){gm=!1,ln!==null&&bo(ln)&&(ln=null),nn!==null&&bo(nn)&&(nn=null),rn!==null&&bo(rn)&&(rn=null),Li.forEach(tg),Ui.forEach(tg)}function yo(s,t){s.blockedOn===t&&(s.blockedOn=null,gm||(gm=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,p0)))}var wo=null;function ag(s){wo!==s&&(wo=s,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){wo===s&&(wo=null);for(var t=0;t<s.length;t+=3){var a=s[t],r=s[t+1],o=s[t+2];if(typeof r!="function"){if(pm(r||a)===null)continue;break}var m=er(a);m!==null&&(s.splice(t,3),t-=3,fu(m,{pending:!0,data:o,method:a.method,action:r},r,o))}}))}function Rr(s){function t($){return yo($,s)}ln!==null&&yo(ln,s),nn!==null&&yo(nn,s),rn!==null&&yo(rn,s),Li.forEach(t),Ui.forEach(t);for(var a=0;a<cn.length;a++){var r=cn[a];r.blockedOn===s&&(r.blockedOn=null)}for(;0<cn.length&&(a=cn[0],a.blockedOn===null);)sg(a),a.blockedOn===null&&cn.shift();if(a=(s.ownerDocument||s).$$reactFormReplay,a!=null)for(r=0;r<a.length;r+=3){var o=a[r],m=a[r+1],j=o[is]||null;if(typeof m=="function")j||ag(a);else if(j){var C=null;if(m&&m.hasAttribute("formAction")){if(o=m,j=m[is]||null)C=j.formAction;else if(pm(o)!==null)continue}else C=j.action;typeof C=="function"?a[r+1]=C:(a.splice(r,3),r-=3),ag(a)}}}function lg(){function s(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(j){return o=j})},focusReset:"manual",scroll:"manual"})}function t(){o!==null&&(o(),o=null),r||setTimeout(a,20)}function a(){if(!r&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,o=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){r=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),o!==null&&(o(),o=null)}}}function jm(s){this._internalRoot=s}_o.prototype.render=jm.prototype.render=function(s){var t=this._internalRoot;if(t===null)throw Error(c(409));var a=t.current,r=Sa();Yp(a,r,s,t,null,null)},_o.prototype.unmount=jm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var t=s.containerInfo;Yp(s.current,2,null,s,null,null),ao(),t[jt]=null}};function _o(s){this._internalRoot=s}_o.prototype.unstable_scheduleHydration=function(s){if(s){var t=re();s={blockedOn:null,target:s,priority:t};for(var a=0;a<cn.length&&t!==0&&t<cn[a].priority;a++);cn.splice(a,0,s),a===0&&sg(s)}};var ng=n.version;if(ng!=="19.2.1")throw Error(c(527,ng,"19.2.1"));V.findDOMNode=function(s){var t=s._reactInternals;if(t===void 0)throw typeof s.render=="function"?Error(c(188)):(s=Object.keys(s).join(","),Error(c(268,s)));return s=g(t),s=s!==null?N(s):null,s=s===null?null:s.stateNode,s};var g0={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var So=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!So.isDisabled&&So.supportsFiber)try{Ns=So.inject(g0),as=So}catch{}}return Bi.createRoot=function(s,t){if(!u(s))throw Error(c(299));var a=!1,r="",o=mf,m=xf,j=hf;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(m=t.onCaughtError),t.onRecoverableError!==void 0&&(j=t.onRecoverableError)),t=Kp(s,1,!1,null,null,a,r,null,o,m,j,lg),s[jt]=t.current,Wu(s),new jm(t)},Bi.hydrateRoot=function(s,t,a){if(!u(s))throw Error(c(299));var r=!1,o="",m=mf,j=xf,C=hf,$=null;return a!=null&&(a.unstable_strictMode===!0&&(r=!0),a.identifierPrefix!==void 0&&(o=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(j=a.onCaughtError),a.onRecoverableError!==void 0&&(C=a.onRecoverableError),a.formState!==void 0&&($=a.formState)),t=Kp(s,1,!0,t,a??null,r,o,$,m,j,C,lg),t.context=Qp(null),a=t.current,r=Sa(),r=ea(r),o=ql(r),o.callback=null,Kl(a,o,r),a=r,t.current.lanes=a,Re(t,a),rl(t),s[jt]=t.current,Wu(s),new _o(t)},Bi.version="19.2.1",Bi}var hg;function e1(){if(hg)return ym.exports;hg=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),ym.exports=W_(),ym.exports}var s1=e1();function I(...l){return M0(z0(l))}const Ce=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:I("rounded-xl border bg-card text-card-foreground shadow",l),...n}));Ce.displayName="Card";const De=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:I("flex flex-col space-y-1.5 p-6",l),...n}));De.displayName="CardHeader";const Le=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:I("font-semibold leading-none tracking-tight",l),...n}));Le.displayName="CardTitle";const ws=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:I("text-sm text-muted-foreground",l),...n}));ws.displayName="CardDescription";const Ae=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:I("p-6 pt-0",l),...n}));Ae.displayName="CardContent";const Zo=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:I("flex items-center p-6 pt-0",l),...n}));Zo.displayName="CardFooter";const ta=O0,Xt=d.forwardRef(({className:l,...n},i)=>e.jsx(Ig,{ref:i,className:I("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",l),...n}));Xt.displayName=Ig.displayName;const Je=d.forwardRef(({className:l,...n},i)=>e.jsx(Pg,{ref:i,className:I("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",l),...n}));Je.displayName=Pg.displayName;const ys=d.forwardRef(({className:l,...n},i)=>e.jsx(Hg,{ref:i,className:I("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 data-[state=active]:animate-in data-[state=active]:fade-in data-[state=active]:duration-300",l),...n}));ys.displayName=Hg.displayName;const Ye=d.forwardRef(({className:l,children:n,viewportRef:i,...c},u)=>e.jsxs(Fg,{ref:u,className:I("relative overflow-hidden",l),...c,children:[e.jsx(D0,{ref:i,className:"h-full w-full rounded-[inherit]",children:n}),e.jsx(Um,{}),e.jsx(Um,{orientation:"horizontal"}),e.jsx(R0,{})]}));Ye.displayName=Fg.displayName;const Um=d.forwardRef(({className:l,orientation:n="vertical",...i},c)=>e.jsx(Gg,{ref:c,orientation:n,className:I("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",l),...i,children:e.jsx(L0,{className:"relative flex-1 rounded-full bg-border"})}));Um.displayName=Gg.displayName;function js({className:l,...n}){return e.jsx("div",{className:I("animate-pulse rounded-md bg-primary/10",l),...n})}const Kn=d.forwardRef(({className:l,value:n,...i},c)=>e.jsx(Vg,{ref:c,className:I("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",l),...i,children:e.jsx(U0,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));Kn.displayName=Vg.displayName;async function we(l,n){const c=n?.body instanceof FormData?{...n?.headers}:{"Content-Type":"application/json",...n?.headers},u={...n,credentials:"include",headers:c},x=await fetch(l,u);if(x.status===401)throw window.location.href="/auth",new Error("");return x}function Fs(){return{"Content-Type":"application/json"}}async function t1(){try{await fetch("/api/webui/auth/logout",{method:"POST",credentials:"include"})}catch(l){console.error(":",l)}window.location.href="/auth"}async function tc(){try{return(await(await fetch("/api/webui/auth/check",{method:"GET",credentials:"include"})).json()).authenticated===!0}catch{return!1}}const a1={light:"",dark:".dark"},tv=d.createContext(null);function av(){const l=d.useContext(tv);if(!l)throw new Error("useChart must be used within a <ChartContainer />");return l}const $r=d.forwardRef(({id:l,className:n,children:i,config:c,...u},x)=>{const h=d.useId(),f=`chart-${l||h.replace(/:/g,"")}`;return e.jsx(tv.Provider,{value:{config:c},children:e.jsxs("div",{"data-chart":f,ref:x,className:I("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",n),...u,children:[e.jsx(l1,{id:f,config:c}),e.jsx(oj,{children:i})]})})});$r.displayName="Chart";const l1=({id:l,config:n})=>{const i=Object.entries(n).filter(([,c])=>c.theme||c.color);return i.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(a1).map(([c,u])=>`
${u} [data-chart=${l}] {
${i.map(([x,h])=>{const f=h.theme?.[c]||h.color;return f?`  --color-${x}: ${f};`:null}).join(`
`)}
}
`).join(`
`)}}):null},Ii=dj,Br=d.forwardRef(({active:l,payload:n,className:i,indicator:c="dot",hideLabel:u=!1,hideIndicator:x=!1,label:h,labelFormatter:f,labelClassName:p,formatter:g,color:N,nameKey:v,labelKey:y},w)=>{const{config:b}=av(),R=d.useMemo(()=>{if(u||!n?.length)return null;const[S]=n,P=`${y||S?.dataKey||S?.name||"value"}`,M=$m(b,S,P),T=!y&&typeof h=="string"?b[h]?.label||h:M?.label;return f?e.jsx("div",{className:I("font-medium",p),children:f(T,n)}):T?e.jsx("div",{className:I("font-medium",p),children:T}):null},[h,f,n,u,p,b,y]);if(!l||!n?.length)return null;const D=n.length===1&&c!=="dot";return e.jsxs("div",{ref:w,className:I("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",i),children:[D?null:R,e.jsx("div",{className:"grid gap-1.5",children:n.filter(S=>S.type!=="none").map((S,P)=>{const M=`${v||S.name||S.dataKey||"value"}`,T=$m(b,S,M),A=N||S.payload.fill||S.color;return e.jsx("div",{className:I("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",c==="dot"&&"items-center"),children:g&&S?.value!==void 0&&S.name?g(S.value,S.name,S,P,S.payload):e.jsxs(e.Fragment,{children:[T?.icon?e.jsx(T.icon,{}):!x&&e.jsx("div",{className:I("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":c==="dot","w-1":c==="line","w-0 border-[1.5px] border-dashed bg-transparent":c==="dashed","my-0.5":D&&c==="dashed"}),style:{"--color-bg":A,"--color-border":A}}),e.jsxs("div",{className:I("flex flex-1 justify-between leading-none",D?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[D?R:null,e.jsx("span",{className:"text-muted-foreground",children:T?.label||S.name})]}),S.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:S.value.toLocaleString()})]})]})},S.dataKey)})})]})});Br.displayName="ChartTooltip";const n1=fw,lv=d.forwardRef(({className:l,hideIcon:n=!1,payload:i,verticalAlign:c="bottom",nameKey:u},x)=>{const{config:h}=av();return i?.length?e.jsx("div",{ref:x,className:I("flex items-center justify-center gap-4",c==="top"?"pb-3":"pt-3",l),children:i.filter(f=>f.type!=="none").map(f=>{const p=`${u||f.dataKey||"value"}`,g=$m(h,f,p);return e.jsxs("div",{className:I("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[g?.icon&&!n?e.jsx(g.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:f.color}}),g?.label]},f.value)})}):null});lv.displayName="ChartLegend";function $m(l,n,i){if(typeof n!="object"||n===null)return;const c="payload"in n&&typeof n.payload=="object"&&n.payload!==null?n.payload:void 0;let u=i;return i in n&&typeof n[i]=="string"?u=n[i]:c&&i in c&&typeof c[i]=="string"&&(u=c[i]),u in l?l[u]:l[i]}const qr=Kr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),_=d.forwardRef(({className:l,variant:n,size:i,asChild:c=!1,...u},x)=>{const h=c?bw:"button";return e.jsx(h,{className:I(qr({variant:n,size:i,className:l})),ref:x,...u})});_.displayName="Button";const r1=Kr("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Se({className:l,variant:n,...i}){return e.jsx("div",{className:I(r1({variant:n}),l),...i})}async function i1(){const l=await we("/api/webui/system/restart",{method:"POST",headers:Fs()});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return await l.json()}async function c1(){const l=await we("/api/webui/system/status",{method:"GET",headers:Fs()});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return await l.json()}const Lr={INITIAL_DELAY:3e3,CHECK_INTERVAL:2e3,CHECK_TIMEOUT:3e3,MAX_ATTEMPTS:60,PROGRESS_INTERVAL:200,SUCCESS_REDIRECT_DELAY:1500},nv=d.createContext(null);function Yn({children:l,onRestartComplete:n,onRestartFailed:i,healthCheckUrl:c="/api/webui/system/status",maxAttempts:u=Lr.MAX_ATTEMPTS}){const[x,h]=d.useState({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:u}),[f,p]=d.useState({}),g=d.useCallback(()=>{f.progress&&clearInterval(f.progress),f.elapsed&&clearInterval(f.elapsed),f.check&&clearTimeout(f.check),p({})},[f]),N=d.useCallback(()=>{g(),h({status:"idle",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:u})},[g,u]),v=d.useCallback(async()=>{try{const D=new AbortController,S=setTimeout(()=>D.abort(),Lr.CHECK_TIMEOUT),P=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include",signal:D.signal});return clearTimeout(S),P.ok}catch{return!1}},[c]),y=d.useCallback(()=>{let D=0;const S=async()=>{if(D++,h(M=>({...M,status:"checking",checkAttempts:D})),await v())g(),h(M=>({...M,status:"success",progress:100})),setTimeout(()=>{n?.(),window.location.href="/auth"},Lr.SUCCESS_REDIRECT_DELAY);else if(D>=u){g();const M=` (${D}/${u})`;h(T=>({...T,status:"failed",error:M})),i?.(M)}else{const M=setTimeout(S,Lr.CHECK_INTERVAL);p(T=>({...T,check:M}))}};S()},[v,g,u,n,i]),w=d.useCallback(()=>{h(D=>({...D,status:"checking",checkAttempts:0,error:void 0})),y()},[y]),b=d.useCallback(async D=>{const{delay:S=0,skipApiCall:P=!1}=D??{};if(x.status!=="idle"&&x.status!=="failed")return;if(g(),h({status:"requesting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:u}),S>0&&await new Promise(A=>setTimeout(A,S)),P)h(A=>({...A,status:"restarting"}));else try{h(A=>({...A,status:"restarting"})),await Promise.race([i1(),new Promise(A=>setTimeout(A,5e3))])}catch{}const M=setInterval(()=>{h(A=>({...A,progress:A.progress>=90?A.progress:A.progress+1}))},Lr.PROGRESS_INTERVAL),T=setInterval(()=>{h(A=>({...A,elapsedTime:A.elapsedTime+1}))},1e3);p({progress:M,elapsed:T}),setTimeout(()=>{y()},Lr.INITIAL_DELAY)},[x.status,g,u,y]),R={state:x,isRestarting:x.status!=="idle",triggerRestart:b,resetState:N,retryHealthCheck:w};return e.jsx(nv.Provider,{value:R,children:l})}function vn(){const l=d.useContext(nv);if(!l)throw new Error("useRestart must be used within a RestartProvider");return l}function o1(){try{return vn()}catch{return null}}const d1=(l,n,i,c,u)=>({idle:{icon:null,title:"",description:"",tip:""},requesting:{icon:e.jsx(Bs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:u??"...",tip:" ..."},restarting:{icon:e.jsx(Bs,{className:"h-16 w-16 text-primary animate-spin"}),title:c??"",description:u??"...",tip:" ..."},checking:{icon:e.jsx(Bs,{className:"h-16 w-16 text-primary animate-spin"}),title:"",description:`... (${n}/${i})`,tip:" ..."},success:{icon:e.jsx(pt,{className:"h-16 w-16 text-green-500"}),title:"",description:"...",tip:" "},failed:{icon:e.jsx(_t,{className:"h-16 w-16 text-destructive"}),title:"",description:"",tip:" "}})[l];function Jn({visible:l,onComplete:n,onFailed:i,title:c,description:u,showAnimation:x=!0,className:h}){const f=o1();return(f?f.isRestarting:l)?f?e.jsx(rv,{state:f.state,onRetry:f.retryHealthCheck,onComplete:n,onFailed:i,title:c,description:u,showAnimation:x,className:h}):e.jsx(u1,{onComplete:n,onFailed:i,title:c,description:u,showAnimation:x,className:h}):null}function rv({state:l,onRetry:n,onComplete:i,onFailed:c,title:u,description:x,showAnimation:h,className:f}){const{status:p,progress:g,elapsedTime:N,checkAttempts:v,maxAttempts:y}=l;d.useEffect(()=>{p==="success"&&i?i():p==="failed"&&c&&c()},[p,i,c]);const w=d1(p,v,y,u,x),b=R=>{const D=Math.floor(R/60),S=R%60;return`${D}:${S.toString().padStart(2,"0")}`};return e.jsxs("div",{className:I("fixed inset-0 bg-background/95 backdrop-blur-sm z-50 flex items-center justify-center",f),children:[h&&e.jsx(m1,{}),e.jsxs("div",{className:"max-w-md w-full mx-4 space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[w.icon,(p==="restarting"||p==="checking")&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/20 animate-ping"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:w.title}),e.jsx("p",{className:"text-muted-foreground text-center",children:w.description})]}),p!=="failed"&&p!=="idle"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Kn,{value:g,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[g,"%"]}),e.jsxs("span",{children:[": ",b(N)]})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:w.tip})}),p==="failed"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{onClick:()=>window.location.reload(),variant:"default",className:"flex-1",children:[e.jsx(dt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:n,variant:"secondary",className:"flex-1",children:[e.jsx(Zi,{className:"mr-2 h-4 w-4"}),""]})]})]})]})}function u1({onComplete:l,onFailed:n,title:i,description:c,showAnimation:u,className:x}){const[h,f]=d.useState({status:"restarting",progress:0,elapsedTime:0,checkAttempts:0,maxAttempts:60}),p=d.useCallback(()=>{let g=0;const N=60,v=async()=>{g++,f(y=>({...y,status:"checking",checkAttempts:g}));try{if((await fetch("/api/webui/system/status",{method:"GET",signal:AbortSignal.timeout(3e3)})).ok){f(w=>({...w,status:"success",progress:100})),setTimeout(()=>{l?.(),window.location.href="/auth"},1500);return}}catch{}g>=N?(f(y=>({...y,status:"failed"})),n?.()):setTimeout(v,2e3)};v()},[l,n]);return d.useEffect(()=>{const g=setInterval(()=>{f(y=>({...y,progress:y.progress>=90?y.progress:y.progress+1}))},200),N=setInterval(()=>{f(y=>({...y,elapsedTime:y.elapsedTime+1}))},1e3),v=setTimeout(()=>{p()},3e3);return()=>{clearInterval(g),clearInterval(N),clearTimeout(v)}},[p]),e.jsx(rv,{state:h,onRetry:p,onComplete:l,onFailed:n,title:i,description:c,showAnimation:u,className:x})}function m1(){return e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite]"}),e.jsx("div",{className:"absolute inset-8 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_0.5s]"}),e.jsx("div",{className:"absolute inset-16 rounded-full border border-primary/10 animate-[ping_3s_ease-in-out_infinite_1s]"})]}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-bounce"}),e.jsx("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-primary/15 rounded-full animate-bounce delay-150"}),e.jsx("div",{className:"absolute top-1/2 right-1/3 w-2 h-2 bg-primary/20 rounded-full animate-bounce delay-300"})]})}const Is=_w,Wo=Sw,x1=yw,iv=d.forwardRef(({className:l,...n},i)=>e.jsx(uj,{ref:i,className:I("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...n}));iv.displayName=uj.displayName;const Os=d.forwardRef(({className:l,children:n,preventOutsideClose:i=!1,...c},u)=>e.jsxs(x1,{children:[e.jsx(iv,{}),e.jsxs(mj,{ref:u,className:I("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),onPointerDownOutside:i?x=>x.preventDefault():void 0,onInteractOutside:i?x=>x.preventDefault():void 0,...c,children:[n,e.jsxs(ww,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ea,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Os.displayName=mj.displayName;const Ds=({className:l,...n})=>e.jsx("div",{className:I("flex flex-col space-y-1.5 text-center sm:text-left",l),...n});Ds.displayName="DialogHeader";const st=({className:l,...n})=>e.jsx("div",{className:I("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",l),...n});st.displayName="DialogFooter";const Rs=d.forwardRef(({className:l,...n},i)=>e.jsx(xj,{ref:i,className:I("text-lg font-semibold leading-none tracking-tight",l),...n}));Rs.displayName=xj.displayName;const Ks=d.forwardRef(({className:l,...n},i)=>e.jsx(hj,{ref:i,className:I("text-sm text-muted-foreground",l),...n}));Ks.displayName=hj.displayName;const le=d.forwardRef(({className:l,type:n,...i},c)=>e.jsx("input",{type:n,className:I("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),ref:c,...i}));le.displayName="Input";const qs=d.forwardRef(({className:l,...n},i)=>e.jsx(fj,{ref:i,className:I("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",l),...n,children:e.jsx(kw,{className:I("grid place-content-center text-current"),children:e.jsx(Ct,{className:"h-4 w-4"})})}));qs.displayName=fj.displayName;const h1=5,f1=5e3;let Sm=0;function p1(){return Sm=(Sm+1)%Number.MAX_SAFE_INTEGER,Sm.toString()}const km=new Map,fg=l=>{if(km.has(l))return;const n=setTimeout(()=>{km.delete(l),Yi({type:"REMOVE_TOAST",toastId:l})},f1);km.set(l,n)},g1=(l,n)=>{switch(n.type){case"ADD_TOAST":return{...l,toasts:[n.toast,...l.toasts].slice(0,h1)};case"UPDATE_TOAST":return{...l,toasts:l.toasts.map(i=>i.id===n.toast.id?{...i,...n.toast}:i)};case"DISMISS_TOAST":{const{toastId:i}=n;return i?fg(i):l.toasts.forEach(c=>{fg(c.id)}),{...l,toasts:l.toasts.map(c=>c.id===i||i===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return n.toastId===void 0?{...l,toasts:[]}:{...l,toasts:l.toasts.filter(i=>i.id!==n.toastId)}}},Ao=[];let Oo={toasts:[]};function Yi(l){Oo=g1(Oo,l),Ao.forEach(n=>{n(Oo)})}function Qt({...l}){const n=p1(),i=u=>Yi({type:"UPDATE_TOAST",toast:{...u,id:n}}),c=()=>Yi({type:"DISMISS_TOAST",toastId:n});return Yi({type:"ADD_TOAST",toast:{...l,id:n,open:!0,onOpenChange:u=>{u||c()}}}),{id:n,dismiss:c,update:i}}function Zs(){const[l,n]=d.useState(Oo);return d.useEffect(()=>(Ao.push(n),()=>{const i=Ao.indexOf(n);i>-1&&Ao.splice(i,1)}),[l]),{...l,toast:Qt,dismiss:i=>Yi({type:"DISMISS_TOAST",toastId:i})}}const el="/api/webui/expression";async function Zm(){const l=await we(`${el}/chats`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function j1(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.chat_id&&n.append("chat_id",l.chat_id);const i=await we(`${el}/list?${n}`,{});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function v1(l){const n=await we(`${el}/${l}`,{});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function N1(l){const n=await we(`${el}/`,{method:"POST",body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function b1(l,n){const i=await we(`${el}/${l}`,{method:"PATCH",body:JSON.stringify(n)});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function y1(l){const n=await we(`${el}/${l}`,{method:"DELETE"});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function w1(l){const n=await we(`${el}/batch/delete`,{method:"POST",body:JSON.stringify({ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function _1(){const l=await we(`${el}/stats/summary`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function Wm(){const l=await we(`${el}/review/stats`);if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function S1(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.filter_type&&n.append("filter_type",l.filter_type),l.search&&n.append("search",l.search),l.chat_id&&n.append("chat_id",l.chat_id);const i=await we(`${el}/review/list?${n}`);if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function pg(l){const n=await we(`${el}/review/batch`,{method:"POST",body:JSON.stringify({items:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}function cv({open:l,onOpenChange:n}){const[i,c]=d.useState(null),[u,x]=d.useState([]),[h,f]=d.useState(!1),[p,g]=d.useState(!1),[N,v]=d.useState(0),[y,w]=d.useState(1),[b]=d.useState(20),[R,D]=d.useState("unchecked"),[S,P]=d.useState(""),[M,T]=d.useState(""),[A,F]=d.useState(new Set),[L,J]=d.useState(new Set),[U,ue]=d.useState(new Map),{toast:xe}=Zs(),he=d.useCallback(async()=>{try{g(!0);const k=await Wm();c(k)}catch(k){console.error(":",k)}finally{g(!1)}},[]),ne=d.useCallback(async()=>{try{f(!0);const k=await S1({page:y,page_size:b,filter_type:R,search:S||void 0});x(k.data),v(k.total)}catch(k){xe({title:"",description:k instanceof Error?k.message:"",variant:"destructive"})}finally{f(!1)}},[y,b,R,S,xe]),ve=d.useCallback(async()=>{try{const k=await Zm();if(k?.data){const H=new Map;k.data.forEach(se=>{H.set(se.chat_id,se.chat_name)}),ue(H)}}catch(k){console.error(":",k)}},[]);d.useEffect(()=>{l&&(he(),ne(),ve())},[l,he,ne,ve]),d.useEffect(()=>{w(1),F(new Set)},[R,S]);const je=()=>{P(M),w(1)},z=k=>U.get(k)||k,V=async(k,H)=>{try{J(Ee=>new Set(Ee).add(k));const se=await pg([{id:k,rejected:H,require_unchecked:R==="unchecked"}]);se.results[0]?.success?(xe({title:H?"":"",description:` #${k} ${H?"":""}`}),ne(),he()):xe({title:"",description:se.results[0]?.message||"",variant:"destructive"})}catch(se){xe({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{J(se=>{const Ee=new Set(se);return Ee.delete(k),Ee})}},B=async k=>{if(A.size===0){xe({title:"",description:"",variant:"destructive"});return}try{f(!0);const H=Array.from(A).map(Ee=>({id:Ee,rejected:k,require_unchecked:R==="unchecked"})),se=await pg(H);xe({title:"",description:` ${se.succeeded}  ${se.failed} `,variant:se.failed>0?"destructive":"default"}),F(new Set),ne(),he()}catch(H){xe({title:"",description:H instanceof Error?H.message:"",variant:"destructive"})}finally{f(!1)}},oe=()=>{A.size===u.length?F(new Set):F(new Set(u.map(k=>k.id)))},K=k=>{F(H=>{const se=new Set(H);return se.has(k)?se.delete(k):se.add(k),se})},_e=k=>k?new Date(k*1e3).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",pe=k=>k.checked?k.rejected?e.jsxs(Se,{variant:"destructive",className:"gap-1",children:[e.jsx(Va,{className:"h-3 w-3"}),""]}):e.jsxs(Se,{variant:"default",className:"gap-1 bg-green-600",children:[e.jsx(pt,{className:"h-3 w-3"}),""]}):e.jsxs(Se,{variant:"outline",className:"gap-1",children:[e.jsx(na,{className:"h-3 w-3"}),""]}),ke=k=>k?k==="ai"?e.jsxs(Se,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(Pn,{className:"h-3 w-3"}),"AI"]}):e.jsxs(Se,{variant:"secondary",className:"gap-1 text-xs",children:[e.jsx(fn,{className:"h-3 w-3"}),""]}):null,O=Math.ceil(N/b);return e.jsx(Is,{open:l,onOpenChange:n,children:e.jsxs(Os,{className:"max-w-5xl h-[85vh] flex flex-col p-0",children:[e.jsxs(Ds,{className:"px-6 pt-6 pb-4 border-b shrink-0",children:[e.jsx(Rs,{className:"text-xl",children:""}),e.jsx(Ks,{children:""}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mt-4",children:[e.jsxs("div",{className:"rounded-lg border p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:p?"-":i?.unchecked??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:p?"-":i?.passed??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:p?"-":i?.rejected??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"rounded-lg border p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:p?"-":i?.total??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsxs("div",{className:"px-6 py-3 border-b shrink-0 space-y-3",children:[e.jsx(ta,{value:R,onValueChange:k=>D(k),className:"w-full",children:e.jsxs(Xt,{className:"grid w-full grid-cols-4",children:[e.jsxs(Je,{value:"unchecked",className:"gap-1",children:[e.jsx(na,{className:"h-4 w-4"})," (",i?.unchecked??0,")"]}),e.jsxs(Je,{value:"passed",className:"gap-1",children:[e.jsx(pt,{className:"h-4 w-4"})," (",i?.passed??0,")"]}),e.jsxs(Je,{value:"rejected",className:"gap-1",children:[e.jsx(Va,{className:"h-4 w-4"})," (",i?.rejected??0,")"]}),e.jsxs(Je,{value:"all",className:"gap-1",children:[" (",i?.total??0,")"]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:M,onChange:k=>T(k.target.value),onKeyDown:k=>k.key==="Enter"&&je(),className:"pl-9"})]}),e.jsx(_,{variant:"outline",size:"icon",onClick:je,children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"icon",onClick:()=>{ne(),he()},disabled:h,children:e.jsx(dt,{className:I("h-4 w-4",h&&"animate-spin")})}),R==="unchecked"&&A.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>B(!1),disabled:h,children:[e.jsx(pt,{className:"h-4 w-4 mr-1"})," (",A.size,")"]}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>B(!0),disabled:h,children:[e.jsx(Va,{className:"h-4 w-4 mr-1"})," (",A.size,")"]})]})]})]}),e.jsx(Ye,{className:"flex-1 px-6",children:h&&u.length===0?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(dt,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):u.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-muted-foreground",children:[e.jsx(_t,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:""})]}):e.jsxs("div",{className:"space-y-2 py-2",children:[R==="unchecked"&&u.length>0&&e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 rounded-lg bg-muted/50",children:[e.jsx(qs,{checked:A.size===u.length&&u.length>0,onCheckedChange:oe}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" (",u.length," )"]})]}),u.map(k=>e.jsx("div",{className:I("rounded-lg border p-4 space-y-3 transition-colors",A.has(k.id)&&"bg-accent border-primary",L.has(k.id)&&"opacity-50"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[R==="unchecked"&&e.jsx(qs,{checked:A.has(k.id),onCheckedChange:()=>K(k.id),disabled:L.has(k.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm font-medium break-words",children:k.situation})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground break-words",children:k.style})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["#",k.id]}),e.jsx("span",{children:""}),e.jsx("span",{title:z(k.chat_id),className:"truncate max-w-32",children:z(k.chat_id)}),e.jsx("span",{children:""}),e.jsx("span",{children:_e(k.create_date)}),pe(k),ke(k.modified_by)]})]}),e.jsx("div",{className:"flex flex-col gap-2 shrink-0",children:R==="unchecked"?e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>V(k.id,!1),disabled:L.has(k.id),children:[e.jsx(pt,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>V(k.id,!0),disabled:L.has(k.id),children:[e.jsx(Va,{className:"h-4 w-4 mr-1"}),""]})]}):R==="passed"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>V(k.id,!0),disabled:L.has(k.id),children:[e.jsx(Va,{className:"h-4 w-4 mr-1"}),""]}):R==="rejected"?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>V(k.id,!1),disabled:L.has(k.id),children:[e.jsx(pt,{className:"h-4 w-4 mr-1"}),""]}):e.jsx(e.Fragment,{children:k.rejected?e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>V(k.id,!1),disabled:L.has(k.id),children:[e.jsx(pt,{className:"h-4 w-4 mr-1"}),""]}):k.checked?e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>V(k.id,!0),disabled:L.has(k.id),children:[e.jsx(Va,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>V(k.id,!1),disabled:L.has(k.id),children:[e.jsx(pt,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>V(k.id,!0),disabled:L.has(k.id),children:[e.jsx(Va,{className:"h-4 w-4 mr-1"}),""]})]})})})]})},k.id))]})}),e.jsxs("div",{className:"px-6 py-3 border-t shrink-0 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",N,"  ",y,"/",O||1," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>w(k=>Math.max(1,k-1)),disabled:y<=1||h,children:[e.jsx(Aa,{className:"h-4 w-4"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>w(k=>Math.min(O,k+1)),disabled:y>=O||h,children:["",e.jsx(Zt,{className:"h-4 w-4"})]})]})]})]})})}function k1(){return e.jsx(Yn,{children:e.jsx(T1,{})})}const C1=l=>{const n=[];for(let i=0;i<l;i++){const c=i*137.508%360;n.push(`hsl(${c}, 70%, 55%)`)}return n};function T1(){const[l,n]=d.useState(null),[i,c]=d.useState(!0),[u,x]=d.useState(0),[h,f]=d.useState(24),[p,g]=d.useState(!0),[N,v]=d.useState(null),[y,w]=d.useState(!0),[b,R]=d.useState(null),[D,S]=d.useState(!1),[P,M]=d.useState(0),{triggerRestart:T,isRestarting:A}=vn(),F=d.useCallback(async()=>{try{const O=await Wm();M(O.unchecked)}catch(O){console.error(":",O)}},[]),L=d.useCallback(async()=>{try{w(!0);const O=await A0.get("https://v1.hitokoto.cn/?c=a&c=b&c=c&c=d&c=h&c=i&c=k");v({hitokoto:O.data.hitokoto,from:O.data.from||O.data.from_who||""})}catch(O){console.error(":",O),v({hitokoto:"",from:""})}finally{w(!1)}},[]),J=d.useCallback(async()=>{try{const O=await we("/api/webui/system/status");if(O.ok){const k=await O.json();R(k)}else R(null)}catch(O){console.error(":",O),R(null)}},[]),U=async()=>{await T()},ue=d.useCallback(async()=>{try{const O=await we(`/api/webui/statistics/dashboard?hours=${h}`);if(O.ok){const k=await O.json();n(k)}c(!1),x(100)}catch(O){console.error("Failed to fetch dashboard data:",O),c(!1),x(100)}},[h]);if(d.useEffect(()=>{if(!i)return;x(0);const O=setTimeout(()=>x(15),200),k=setTimeout(()=>x(30),800),H=setTimeout(()=>x(45),2e3),se=setTimeout(()=>x(60),4e3),Ee=setTimeout(()=>x(75),6500),Z=setTimeout(()=>x(85),9e3),Oe=setTimeout(()=>x(92),11e3);return()=>{clearTimeout(O),clearTimeout(k),clearTimeout(H),clearTimeout(se),clearTimeout(Ee),clearTimeout(Z),clearTimeout(Oe)}},[i]),d.useEffect(()=>{ue(),L(),J(),F()},[ue,L,J,F]),d.useEffect(()=>{if(!p)return;const O=setInterval(()=>{ue(),J()},3e4);return()=>clearInterval(O)},[p,ue,J]),i||!l)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"text-center space-y-6 w-full max-w-md px-4",children:[e.jsx(dt,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Kn,{value:u,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u,"%"]})]})]})});const{summary:xe,model_stats:he=[],hourly_data:ne=[],daily_data:ve=[],recent_activity:je=[]}=l,z=xe??{total_requests:0,total_cost:0,total_tokens:0,online_time:0,total_messages:0,total_replies:0,avg_response_time:0,cost_per_hour:0,tokens_per_hour:0},V=O=>{const k=Math.floor(O/3600),H=Math.floor(O%3600/60);return`${k}${H}`},B=O=>{const k=O.toLocaleString("zh-CN");return O>=1e9?{display:`${(O/1e9).toFixed(2)}B`,exact:k,needsExact:!0}:O>=1e6?{display:`${(O/1e6).toFixed(2)}M`,exact:k,needsExact:!0}:O>=1e4?{display:`${(O/1e3).toFixed(1)}K`,exact:k,needsExact:!0}:O>=1e3?{display:`${(O/1e3).toFixed(2)}K`,exact:k,needsExact:!0}:{display:k,exact:k,needsExact:!1}},oe=O=>{const k=`${O.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return O>=1e6?{display:`${(O/1e6).toFixed(2)}M`,exact:k,needsExact:!0}:O>=1e4?{display:`${(O/1e3).toFixed(1)}K`,exact:k,needsExact:!0}:O>=1e3?{display:`${(O/1e3).toFixed(2)}K`,exact:k,needsExact:!0}:{display:k,exact:k,needsExact:!1}},K=O=>new Date(O).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),_e=C1(he.length),pe=he.map((O,k)=>({name:O.model_name,value:O.request_count,fill:_e[k]})),ke={requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"},tokens:{label:"Tokens",color:"hsl(var(--chart-3))"}};return e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ta,{value:h.toString(),onValueChange:O=>f(Number(O)),children:e.jsxs(Xt,{className:"grid grid-cols-3 w-full sm:w-auto",children:[e.jsx(Je,{value:"24",children:"24"}),e.jsx(Je,{value:"168",children:"7"}),e.jsx(Je,{value:"720",children:"30"})]})}),e.jsxs(_,{variant:p?"default":"outline",size:"sm",onClick:()=>g(!p),className:"gap-2",children:[e.jsx(dt,{className:`h-4 w-4 ${p?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:ue,children:e.jsx(dt,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg border border-dashed border-muted-foreground/30 bg-muted/20",children:[y?e.jsx(js,{className:"h-5 flex-1"}):N?e.jsxs("p",{className:"flex-1 text-sm text-muted-foreground italic truncate",children:['"',N.hitokoto,'"  ',N.from]}):null,e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:L,disabled:y,children:e.jsx(dt,{className:`h-3.5 w-3.5 ${y?"animate-spin":""}`})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-3",children:[e.jsxs(Ce,{className:"lg:col-span-1",children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Le,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(cc,{className:"h-4 w-4"}),""]})}),e.jsx(Ae,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:b?.running?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500 animate-pulse"}),e.jsxs(Se,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[e.jsx(pt,{className:"h-3 w-3 mr-1"}),""]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-red-500"}),e.jsxs(Se,{variant:"outline",className:"text-red-600 border-red-300 bg-red-50",children:[e.jsx(_t,{className:"h-3 w-3 mr-1"}),""]})]})}),b&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{children:["v",b.version]}),e.jsx("span",{className:"mx-2",children:"|"}),e.jsxs("span",{children:[" ",V(b.uptime)]})]})]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"pb-3",children:e.jsxs(Le,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Za,{className:"h-4 w-4"}),""]})}),e.jsx(Ae,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:U,disabled:A,className:"gap-2",children:[e.jsx(Zi,{className:`h-4 w-4 ${A?"animate-spin":""}`}),A?"...":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>S(!0),className:"gap-2",children:[e.jsx(Aj,{className:"h-4 w-4"}),"",P>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:P>99?"99+":P})]}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Bn,{to:"/logs",children:[e.jsx(Ca,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Bn,{to:"/plugins",children:[e.jsx(Gw,{className:"h-4 w-4"}),""]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Bn,{to:"/settings",children:[e.jsx(pn,{className:"h-4 w-4"}),""]})})]})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"pb-3",children:[e.jsxs(Le,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Vw,{className:"h-4 w-4"}),""]}),e.jsx(ws,{className:"text-xs",children:""})]}),e.jsx(Ae,{children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Bn,{to:"/survey/webui-feedback",children:[e.jsx(Ca,{className:"h-4 w-4"}),"WebUI "]})}),e.jsx(_,{variant:"outline",size:"sm",asChild:!0,className:"gap-2",children:e.jsxs(Bn,{to:"/survey/maibot-feedback",children:[e.jsx(Ma,{className:"h-4 w-4"}),""]})})]})})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Gm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[B(z.total_requests).display,B(z.total_requests).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",B(z.total_requests).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["",h<48?h+"":Math.floor(h/24)+""]})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(qw,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[oe(z.total_cost).display,oe(z.total_cost).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",oe(z.total_cost).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:z.cost_per_hour>0?`${z.cost_per_hour.toFixed(2)}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:"Token"}),e.jsx(Hr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[B(z.total_tokens).display,B(z.total_tokens).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",B(z.total_tokens).exact,")"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:z.tokens_per_hour>0?`${B(z.tokens_per_hour).display}/`:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[z.avg_response_time.toFixed(2),"s"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"API"})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(na,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:e.jsxs("div",{className:"text-xl font-bold",children:[V(z.online_time),e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",z.online_time.toLocaleString(),")"]})]})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"text-xl font-bold",children:[B(z.total_messages).display,B(z.total_messages).needsExact&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground ml-1",children:["(",B(z.total_messages).exact,")"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",B(z.total_replies).display,B(z.total_replies).needsExact&&e.jsxs("span",{children:["(",B(z.total_replies).exact,")"]})," "]})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Vm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-xl font-bold",children:z.total_messages>0?`${(z.total_cost/z.total_messages*100).toFixed(2)}`:"0.00"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"100"})]})]})]}),e.jsxs(ta,{defaultValue:"trends",className:"space-y-4",children:[e.jsxs(Xt,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[e.jsx(Je,{value:"trends",children:""}),e.jsx(Je,{value:"models",children:""}),e.jsx(Je,{value:"activity",children:""}),e.jsx(Je,{value:"daily",children:""})]}),e.jsxs(ys,{value:"trends",className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsxs(ws,{children:["",h,""]})]}),e.jsx(Ae,{children:e.jsx($r,{config:ke,className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(pw,{data:ne,children:[e.jsx(Hi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Fi,{dataKey:"timestamp",tickFormatter:O=>K(O),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ur,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ii,{content:e.jsx(Br,{labelFormatter:O=>K(O)})}),e.jsx(gw,{type:"monotone",dataKey:"requests",stroke:"var(--color-requests)",strokeWidth:2})]})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:"API"})]}),e.jsx(Ae,{children:e.jsx($r,{config:ke,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Eo,{data:ne,children:[e.jsx(Hi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Fi,{dataKey:"timestamp",tickFormatter:O=>K(O),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ur,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ii,{content:e.jsx(Br,{labelFormatter:O=>K(O)})}),e.jsx(Gi,{dataKey:"cost",fill:"var(--color-cost)"})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Token"}),e.jsx(ws,{children:"Token"})]}),e.jsx(Ae,{children:e.jsx($r,{config:ke,className:"h-[250px] sm:h-[300px] w-full aspect-auto",children:e.jsxs(Eo,{data:ne,children:[e.jsx(Hi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Fi,{dataKey:"timestamp",tickFormatter:O=>K(O),angle:-45,textAnchor:"end",height:60,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ur,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ii,{content:e.jsx(Br,{labelFormatter:O=>K(O)})}),e.jsx(Gi,{dataKey:"tokens",fill:"var(--color-tokens)"})]})})})]})]})]}),e.jsx(ys,{value:"models",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsxs(ws,{children:[" ( ",he.length," )"]})]}),e.jsx(Ae,{children:e.jsx($r,{config:Object.fromEntries(he.map((O,k)=>[O.model_name,{label:O.model_name,color:_e[k]}])),className:"h-[300px] sm:h-[400px] w-full aspect-auto",children:e.jsxs(jw,{children:[e.jsx(Ii,{content:e.jsx(Br,{})}),e.jsx(vw,{data:pe,cx:"50%",cy:"50%",labelLine:!1,label:({name:O,percent:k})=>k&&k<.05?"":`${O} ${k?(k*100).toFixed(0):0}%`,outerRadius:100,dataKey:"value",children:pe.map((O,k)=>e.jsx(Nw,{fill:O.fill},`cell-${k}`))})]})})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:e.jsx(Ye,{className:"h-[300px] sm:h-[400px]",children:e.jsx("div",{className:"space-y-3",children:he.map((O,k)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm truncate flex-1 min-w-0",children:O.model_name}),e.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:`hsl(var(--chart-${k%5+1}))`}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"ml-1 font-medium",children:O.request_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:["",O.total_cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[(O.total_tokens/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1 font-medium",children:[O.avg_response_time.toFixed(2),"s"]})]})]})]},k))})})})]})]})}),e.jsx(ys,{value:"activity",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:"API"})]}),e.jsx(Ae,{children:e.jsx(Ye,{className:"h-[400px] sm:h-[500px]",children:e.jsx("div",{className:"space-y-2",children:je.map((O,k)=>e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:O.model}),e.jsx("div",{className:"text-xs text-muted-foreground",children:O.request_type})]}),e.jsx("div",{className:"text-xs text-muted-foreground flex-shrink-0",children:K(O.timestamp)})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tokens:"}),e.jsx("span",{className:"ml-1",children:O.tokens})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:["",O.cost.toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"ml-1",children:[O.time_cost.toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:`ml-1 ${O.status==="success"?"text-green-600":"text-red-600"}`,children:O.status})]})]})]},k))})})})]})}),e.jsx(ys,{value:"daily",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:"7"})]}),e.jsx(Ae,{children:e.jsx($r,{config:{requests:{label:"",color:"hsl(var(--chart-1))"},cost:{label:"()",color:"hsl(var(--chart-2))"}},className:"h-[400px] sm:h-[500px] w-full aspect-auto",children:e.jsxs(Eo,{data:ve,children:[e.jsx(Hi,{strokeDasharray:"3 3",stroke:"hsl(var(--muted-foreground) / 0.2)"}),e.jsx(Fi,{dataKey:"timestamp",tickFormatter:O=>{const k=new Date(O);return`${k.getMonth()+1}/${k.getDate()}`},stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ur,{yAxisId:"left",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ur,{yAxisId:"right",orientation:"right",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Ii,{content:e.jsx(Br,{labelFormatter:O=>new Date(O).toLocaleDateString("zh-CN")})}),e.jsx(n1,{content:e.jsx(lv,{})}),e.jsx(Gi,{yAxisId:"left",dataKey:"requests",fill:"var(--color-requests)"}),e.jsx(Gi,{yAxisId:"right",dataKey:"cost",fill:"var(--color-cost)"})]})})})]})})]}),e.jsx(Jn,{}),e.jsx(cv,{open:D,onOpenChange:O=>{S(O),O||F()}})]})})}const E1={theme:"system",setTheme:()=>null},ov=d.createContext(E1),ex=()=>{const l=d.useContext(ov);if(l===void 0)throw new Error("useTheme must be used within a ThemeProvider");return l},M1=(l,n,i)=>{const c=document.documentElement.classList.contains("no-animations");if(!document.startViewTransition||c){n(l);return}const u=i.clientX,x=i.clientY,h=Math.hypot(Math.max(u,innerWidth-u),Math.max(x,innerHeight-x));document.startViewTransition(()=>{n(l)}).ready.then(()=>{document.documentElement.animate({clipPath:[`circle(0px at ${u}px ${x}px)`,`circle(${h}px at ${u}px ${x}px)`]},{duration:500,easing:"ease-in-out",pseudoElement:"::view-transition-new(root)"})})},dv=d.createContext(void 0),uv=()=>{const l=d.useContext(dv);if(l===void 0)throw new Error("useAnimation must be used within an AnimationProvider");return l},Fe=d.forwardRef(({className:l,...n},i)=>e.jsx(qg,{className:I("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",l),...n,ref:i,children:e.jsx($0,{className:I("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Fe.displayName=qg.displayName;const z1=Kr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),E=d.forwardRef(({className:l,...n},i)=>e.jsx(pj,{ref:i,className:I(z1(),l),...n}));E.displayName=pj.displayName;const A1=[{id:"minLength",label:" 10 ",description:"Token  10 ",validate:l=>l.length>=10},{id:"hasUppercase",label:"",description:" (A-Z)",validate:l=>/[A-Z]/.test(l)},{id:"hasLowercase",label:"",description:" (a-z)",validate:l=>/[a-z]/.test(l)},{id:"hasSpecialChar",label:"",description:" (!@#$%^&*()_+-=[]{}|;:,.<>?/)",validate:l=>/[!@#$%^&*()_+\-=[\]{}|;:,.<>?/]/.test(l)}];function O1(l){const n=A1.map(c=>({id:c.id,label:c.label,description:c.description,passed:c.validate(l)}));return{isValid:n.every(c=>c.passed),rules:n}}const ed="0.12.1",sx="MaiBot Dashboard",D1=`${sx} v${ed}`,R1=(l="v")=>`${l}${ed}`,pa={THEME:"maibot-ui-theme",ACCENT_COLOR:"accent-color",ENABLE_ANIMATIONS:"maibot-animations",ENABLE_WAVES_BACKGROUND:"maibot-waves-background",LOG_CACHE_SIZE:"maibot-log-cache-size",LOG_AUTO_SCROLL:"maibot-log-auto-scroll",LOG_FONT_SIZE:"maibot-log-font-size",LOG_LINE_SPACING:"maibot-log-line-spacing",DATA_SYNC_INTERVAL:"maibot-data-sync-interval",WS_RECONNECT_INTERVAL:"maibot-ws-reconnect-interval",WS_MAX_RECONNECT_ATTEMPTS:"maibot-ws-max-reconnect-attempts",COMPLETED_TOURS:"maibot-completed-tours"},cl={theme:"system",accentColor:"blue",enableAnimations:!0,enableWavesBackground:!0,logCacheSize:1e3,logAutoScroll:!0,logFontSize:"xs",logLineSpacing:4,dataSyncInterval:30,wsReconnectInterval:3e3,wsMaxReconnectAttempts:10};function yt(l){const n=mv(l),i=localStorage.getItem(n);if(i===null)return cl[l];const c=cl[l];if(typeof c=="boolean")return i==="true";if(typeof c=="number"){const u=parseFloat(i);return isNaN(u)?c:u}return i}function Ir(l,n){const i=mv(l);localStorage.setItem(i,String(n)),window.dispatchEvent(new CustomEvent("maibot-settings-change",{detail:{key:l,value:n}}))}function L1(){return{theme:yt("theme"),accentColor:yt("accentColor"),enableAnimations:yt("enableAnimations"),enableWavesBackground:yt("enableWavesBackground"),logCacheSize:yt("logCacheSize"),logAutoScroll:yt("logAutoScroll"),logFontSize:yt("logFontSize"),logLineSpacing:yt("logLineSpacing"),dataSyncInterval:yt("dataSyncInterval"),wsReconnectInterval:yt("wsReconnectInterval"),wsMaxReconnectAttempts:yt("wsMaxReconnectAttempts")}}function U1(){const l=L1(),n=localStorage.getItem(pa.COMPLETED_TOURS),i=n?JSON.parse(n):[];return{...l,completedTours:i}}function $1(l){const n=[],i=[];for(const[c,u]of Object.entries(l)){if(c==="completedTours"){Array.isArray(u)?(localStorage.setItem(pa.COMPLETED_TOURS,JSON.stringify(u)),n.push("completedTours")):i.push("completedTours");continue}if(c in cl){const x=c,h=cl[x];if(typeof u==typeof h){if(x==="theme"&&!["light","dark","system"].includes(u)){i.push(c);continue}if(x==="logFontSize"&&!["xs","sm","base"].includes(u)){i.push(c);continue}Ir(x,u),n.push(c)}else i.push(c)}else i.push(c)}return{success:n.length>0,imported:n,skipped:i}}function B1(){for(const l of Object.keys(cl))Ir(l,cl[l]);localStorage.removeItem(pa.COMPLETED_TOURS),window.dispatchEvent(new CustomEvent("maibot-settings-reset"))}function I1(){const l=[],n=[],i=[];for(let c=0;c<localStorage.length;c++){const u=localStorage.key(c);u&&(u.startsWith("maibot")||u.startsWith("accent-color")||u==="access-token")&&i.push(u)}for(const c of i)localStorage.removeItem(c),l.push(c);return{clearedKeys:l,preservedKeys:n}}function gg(){let l=0;const n=[];for(let i=0;i<localStorage.length;i++){const c=localStorage.key(i);if(c){const u=localStorage.getItem(c)||"",x=(c.length+u.length)*2;l+=x,n.push({key:c,size:x})}}return n.sort((i,c)=>c.size-i.size),{used:l,items:localStorage.length,details:n}}function P1(l){if(l===0)return"0 B";const n=1024,i=["B","KB","MB"],c=Math.floor(Math.log(l)/Math.log(n));return parseFloat((l/Math.pow(n,c)).toFixed(2))+" "+i[c]}function mv(l){return{theme:pa.THEME,accentColor:pa.ACCENT_COLOR,enableAnimations:pa.ENABLE_ANIMATIONS,enableWavesBackground:pa.ENABLE_WAVES_BACKGROUND,logCacheSize:pa.LOG_CACHE_SIZE,logAutoScroll:pa.LOG_AUTO_SCROLL,logFontSize:pa.LOG_FONT_SIZE,logLineSpacing:pa.LOG_LINE_SPACING,dataSyncInterval:pa.DATA_SYNC_INTERVAL,wsReconnectInterval:pa.WS_RECONNECT_INTERVAL,wsMaxReconnectAttempts:pa.WS_MAX_RECONNECT_ATTEMPTS}[l]}const qa=d.forwardRef(({className:l,...n},i)=>e.jsxs(Kg,{ref:i,className:I("relative flex w-full touch-none select-none items-center",l),...n,children:[e.jsx(B0,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(I0,{className:"absolute h-full bg-primary"})}),e.jsx(P0,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));qa.displayName=Kg.displayName;class H1{ws=null;reconnectTimeout=null;reconnectAttempts=0;heartbeatInterval=null;logCallbacks=new Set;connectionCallbacks=new Set;isConnected=!1;logCache=[];getMaxCacheSize(){return yt("logCacheSize")}getMaxReconnectAttempts(){return yt("wsMaxReconnectAttempts")}getReconnectInterval(){return yt("wsReconnectInterval")}getWebSocketUrl(n){let i;{const c=window.location.protocol==="https:"?"wss:":"ws:",u=window.location.host;i=`${c}//${u}/ws/logs`}return n?`${i}?token=${encodeURIComponent(n)}`:i}async getWsToken(){try{const n=await we("/api/webui/ws-token",{method:"GET",credentials:"include"});if(!n.ok)return console.error(" WebSocket token :",n.status),null;const i=await n.json();return i.success&&i.token?i.token:null}catch(n){return console.error(" WebSocket token :",n),null}}async connect(){if(this.ws?.readyState===WebSocket.OPEN||this.ws?.readyState===WebSocket.CONNECTING)return;if(window.location.pathname==="/auth"){console.log("  WebSocket ");return}if(!await tc()){console.log("  WebSocket ");return}const i=await this.getWsToken();if(!i){console.log("  WebSocket token");return}const c=this.getWebSocketUrl(i);try{this.ws=new WebSocket(c),this.ws.onopen=()=>{this.isConnected=!0,this.reconnectAttempts=0,this.notifyConnection(!0),this.startHeartbeat()},this.ws.onmessage=u=>{try{if(u.data==="pong")return;const x=JSON.parse(u.data);this.notifyLog(x)}catch(x){console.error(":",x)}},this.ws.onerror=u=>{console.error(" WebSocket :",u),this.isConnected=!1,this.notifyConnection(!1)},this.ws.onclose=()=>{this.isConnected=!1,this.notifyConnection(!1),this.stopHeartbeat(),this.attemptReconnect()}}catch(u){console.error(" WebSocket :",u),this.attemptReconnect()}}attemptReconnect(){const n=this.getMaxReconnectAttempts();if(this.reconnectAttempts>=n)return;this.reconnectAttempts+=1;const i=this.getReconnectInterval(),c=Math.min(i*this.reconnectAttempts,3e4);this.reconnectTimeout=window.setTimeout(()=>{this.connect()},c)}startHeartbeat(){this.heartbeatInterval=window.setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.ws.send("ping")},3e4)}stopHeartbeat(){this.heartbeatInterval!==null&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}disconnect(){this.reconnectTimeout!==null&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.stopHeartbeat(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.reconnectAttempts=0}onLog(n){return this.logCallbacks.add(n),()=>this.logCallbacks.delete(n)}onConnectionChange(n){return this.connectionCallbacks.add(n),n(this.isConnected),()=>this.connectionCallbacks.delete(n)}notifyLog(n){if(!this.logCache.some(c=>c.id===n.id)){this.logCache.push(n);const c=this.getMaxCacheSize();this.logCache.length>c&&(this.logCache=this.logCache.slice(-c)),this.logCallbacks.forEach(u=>{try{u(n)}catch(x){console.error(":",x)}})}}notifyConnection(n){this.connectionCallbacks.forEach(i=>{try{i(n)}catch(c){console.error(":",c)}})}getAllLogs(){return[...this.logCache]}clearLogs(){this.logCache=[]}getConnectionStatus(){return this.isConnected}}const In=new H1;typeof window<"u"&&setTimeout(()=>{In.connect()},100);const vs=F0,wt=G0,F1=H0,xv=d.forwardRef(({className:l,...n},i)=>e.jsx(Qg,{className:I("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...n,ref:i}));xv.displayName=Qg.displayName;const ds=d.forwardRef(({className:l,...n},i)=>e.jsxs(F1,{children:[e.jsx(xv,{}),e.jsx(Yg,{ref:i,className:I("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),...n})]}));ds.displayName=Yg.displayName;const us=({className:l,...n})=>e.jsx("div",{className:I("flex flex-col space-y-2 text-center sm:text-left",l),...n});us.displayName="AlertDialogHeader";const ms=({className:l,...n})=>e.jsx("div",{className:I("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",l),...n});ms.displayName="AlertDialogFooter";const xs=d.forwardRef(({className:l,...n},i)=>e.jsx(Jg,{ref:i,className:I("text-lg font-semibold",l),...n}));xs.displayName=Jg.displayName;const hs=d.forwardRef(({className:l,...n},i)=>e.jsx(Xg,{ref:i,className:I("text-sm text-muted-foreground",l),...n}));hs.displayName=Xg.displayName;const fs=d.forwardRef(({className:l,variant:n,...i},c)=>e.jsx(Zg,{ref:c,className:I(qr({variant:n}),l),...i}));fs.displayName=Zg.displayName;const ps=d.forwardRef(({className:l,...n},i)=>e.jsx(Wg,{ref:i,className:I(qr({variant:"outline"}),"mt-2 sm:mt-0",l),...n}));ps.displayName=Wg.displayName;function G1(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]})}),e.jsxs(ta,{defaultValue:"appearance",className:"w-full",children:[e.jsxs(Xt,{className:"grid w-full grid-cols-2 sm:grid-cols-4 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Je,{value:"appearance",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Kw,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Je,{value:"security",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Oj,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Je,{value:"other",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(pn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Je,{value:"about",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Ht,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Ye,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(ys,{value:"appearance",className:"mt-0",children:e.jsx(V1,{})}),e.jsx(ys,{value:"security",className:"mt-0",children:e.jsx(q1,{})}),e.jsx(ys,{value:"other",className:"mt-0",children:e.jsx(K1,{})}),e.jsx(ys,{value:"about",className:"mt-0",children:e.jsx(Q1,{})})]})]})]})}function jg(l){const n=document.documentElement,c={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[l];if(c)n.style.setProperty("--primary",c.hsl),c.gradient?(n.style.setProperty("--primary-gradient",c.gradient),n.classList.add("has-gradient")):(n.style.removeProperty("--primary-gradient"),n.classList.remove("has-gradient"));else if(l.startsWith("#")){const u=x=>{x=x.replace("#","");const h=parseInt(x.substring(0,2),16)/255,f=parseInt(x.substring(2,4),16)/255,p=parseInt(x.substring(4,6),16)/255,g=Math.max(h,f,p),N=Math.min(h,f,p);let v=0,y=0;const w=(g+N)/2;if(g!==N){const b=g-N;switch(y=w>.5?b/(2-g-N):b/(g+N),g){case h:v=((f-p)/b+(f<p?6:0))/6;break;case f:v=((p-h)/b+2)/6;break;case p:v=((h-f)/b+4)/6;break}}return`${Math.round(v*360)} ${Math.round(y*100)}% ${Math.round(w*100)}%`};n.style.setProperty("--primary",u(l)),n.style.removeProperty("--primary-gradient"),n.classList.remove("has-gradient")}}function V1(){const{theme:l,setTheme:n}=ex(),{enableAnimations:i,setEnableAnimations:c,enableWavesBackground:u,setEnableWavesBackground:x}=uv(),[h,f]=d.useState(()=>localStorage.getItem("accent-color")||"blue");d.useEffect(()=>{const g=localStorage.getItem("accent-color")||"blue";jg(g)},[]);const p=g=>{f(g),localStorage.setItem("accent-color",g),jg(g)};return e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(Cm,{value:"light",current:l,onChange:n,label:"",description:""}),e.jsx(Cm,{value:"dark",current:l,onChange:n,label:"",description:""}),e.jsx(Cm,{value:"system",current:l,onChange:n,label:"",description:""})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Ga,{value:"blue",current:h,onChange:p,label:"",colorClass:"bg-blue-500"}),e.jsx(Ga,{value:"purple",current:h,onChange:p,label:"",colorClass:"bg-purple-500"}),e.jsx(Ga,{value:"green",current:h,onChange:p,label:"",colorClass:"bg-green-500"}),e.jsx(Ga,{value:"orange",current:h,onChange:p,label:"",colorClass:"bg-orange-500"}),e.jsx(Ga,{value:"pink",current:h,onChange:p,label:"",colorClass:"bg-pink-500"}),e.jsx(Ga,{value:"red",current:h,onChange:p,label:"",colorClass:"bg-red-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3",children:[e.jsx(Ga,{value:"gradient-sunset",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-orange-500 to-pink-500"}),e.jsx(Ga,{value:"gradient-ocean",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-500"}),e.jsx(Ga,{value:"gradient-forest",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-green-500 to-emerald-500"}),e.jsx(Ga,{value:"gradient-aurora",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-purple-500 to-pink-500"}),e.jsx(Ga,{value:"gradient-fire",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-red-500 to-orange-500"}),e.jsx(Ga,{value:"gradient-twilight",current:h,onChange:p,label:"",colorClass:"bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium mb-2 sm:mb-3",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"color",value:h.startsWith("#")?h:"#3b82f6",onChange:g=>p(g.target.value),className:"h-10 sm:h-12 w-full rounded-lg border-2 border-border cursor-pointer",title:""})}),e.jsx("div",{className:"flex-1",children:e.jsx(le,{type:"text",value:h,onChange:g=>p(g.target.value),placeholder:"#3b82f6",className:"font-mono text-sm"})})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-2",children:" HEX "})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(E,{htmlFor:"animations",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"animations",checked:i,onCheckedChange:c})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5 flex-1",children:[e.jsx(E,{htmlFor:"waves-background",className:"text-base font-medium cursor-pointer",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"waves-background",checked:u,onCheckedChange:x})]})})]})]})]})}function q1(){const l=ca(),[n,i]=d.useState(""),[c,u]=d.useState(""),[x,h]=d.useState(!1),[f,p]=d.useState(!1),[g,N]=d.useState(!1),[v,y]=d.useState(!1),[w,b]=d.useState(!1),[R,D]=d.useState(!1),[S,P]=d.useState(""),[M,T]=d.useState(!1),{toast:A}=Zs(),F=d.useMemo(()=>O1(c),[c]),L=async ne=>{if(!n){A({title:"",description:"Token  Cookie  Token",variant:"destructive"});return}try{await navigator.clipboard.writeText(ne),b(!0),A({title:"",description:"Token "}),setTimeout(()=>b(!1),2e3)}catch{A({title:"",description:" Token",variant:"destructive"})}},J=async()=>{if(!c.trim()){A({title:"",description:" Token",variant:"destructive"});return}if(!F.isValid){const ne=F.rules.filter(ve=>!ve.passed).map(ve=>ve.label).join(", ");A({title:"",description:`Token : ${ne}`,variant:"destructive"});return}N(!0);try{const ne=await fetch("/api/webui/auth/update",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({new_token:c.trim()})}),ve=await ne.json();ne.ok&&ve.success?(u(""),i(c.trim()),A({title:"",description:"Access Token "}),setTimeout(()=>{l({to:"/auth"})},1500)):A({title:"",description:ve.message||" Token",variant:"destructive"})}catch(ne){console.error(" Token :",ne),A({title:"",description:"",variant:"destructive"})}finally{N(!1)}},U=async()=>{y(!0);try{const ne=await fetch("/api/webui/auth/regenerate",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),ve=await ne.json();ne.ok&&ve.success?(i(ve.token),P(ve.token),D(!0),T(!1),A({title:"",description:" Access Token "})):A({title:"",description:ve.message||" Token",variant:"destructive"})}catch(ne){console.error(" Token :",ne),A({title:"",description:"",variant:"destructive"})}finally{y(!1)}},ue=async()=>{try{await navigator.clipboard.writeText(S),T(!0),A({title:"",description:"Token "})}catch{A({title:"",description:" Token",variant:"destructive"})}},xe=()=>{D(!1),setTimeout(()=>{P(""),T(!1)},300),setTimeout(()=>{l({to:"/auth"})},500)},he=ne=>{ne||xe()};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(Is,{open:R,onOpenChange:he,children:e.jsxs(Os,{className:"sm:max-w-md",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-yellow-500"})," Access Token"]}),e.jsx(Ks,{children:" Token"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-2 border-primary/20 bg-primary/5 p-4",children:[e.jsx(E,{className:"text-xs text-muted-foreground mb-2 block",children:" Token (64)"}),e.jsx("div",{className:"font-mono text-sm break-all select-all bg-background p-3 rounded border",children:S})]}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Jt,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token "}),e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:" Token "})]})]})]})})]}),e.jsxs(st,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:ue,className:"gap-2",children:M?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Ro,{className:"h-4 w-4"})," Token"]})}),e.jsx(_,{onClick:xe,children:""})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"current-token",className:"text-sm",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(le,{id:"current-token",type:x?"text":"password",value:n||"",readOnly:!0,className:"pr-10 font-mono text-sm",placeholder:"Token  Cookie "}),e.jsx("button",{onClick:()=>{n?h(!x):A({title:"",description:'Token  Cookie  Token ""'})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:x?"":"",children:x?e.jsx(Wi,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(_,{variant:"outline",size:"icon",onClick:()=>L(n),title:"",className:"flex-shrink-0",disabled:!n,children:w?e.jsx(Ct,{className:"h-4 w-4 text-green-500"}):e.jsx(Ro,{className:"h-4 w-4"})}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:v,className:"gap-2 flex-1 sm:flex-none",children:[e.jsx(dt,{className:I("h-4 w-4",v&&"animate-spin")}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:" Token"}),e.jsx(hs,{children:" 64  Token   Token "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:U,children:""})]})]})]})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:" Access Token"})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:" Access Token"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"new-token",className:"text-sm",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{id:"new-token",type:f?"text":"password",value:c,onChange:ne=>u(ne.target.value),className:"pr-10 font-mono text-sm",placeholder:" Token"}),e.jsx("button",{onClick:()=>p(!f),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 hover:bg-accent rounded",title:f?"":"",children:f?e.jsx(Wi,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),c&&e.jsxs("div",{className:"mt-3 space-y-2 p-3 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Token :"}),e.jsx("div",{className:"space-y-1.5",children:F.rules.map(ne=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[ne.passed?e.jsx(pt,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(Va,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:I(ne.passed?"text-green-600 dark:text-green-400":"text-muted-foreground"),children:ne.label})]},ne.id))}),F.isValid&&e.jsx("div",{className:"mt-2 pt-2 border-t border-border",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Token "})]})})]})]}),e.jsx(_,{onClick:J,disabled:g||!F.isValid||!c,className:"w-full sm:w-auto",children:g?"...":" Token"})]})]}),e.jsxs("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3 sm:p-4",children:[e.jsx("h4",{className:"text-sm sm:text-base font-semibold text-yellow-900 dark:text-yellow-200 mb-2",children:""}),e.jsxs("ul",{className:"text-xs sm:text-sm text-yellow-800 dark:text-yellow-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:" Token  64 "}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token  Token "}),e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token "}),e.jsx("li",{children:" Token "})]})]})]})}function K1(){const l=ca(),{toast:n}=Zs(),[i,c]=d.useState(!1),[u,x]=d.useState(!1),[h,f]=d.useState(()=>yt("logCacheSize")),[p,g]=d.useState(()=>yt("wsReconnectInterval")),[N,v]=d.useState(()=>yt("wsMaxReconnectAttempts")),[y,w]=d.useState(()=>yt("dataSyncInterval")),[b,R]=d.useState(()=>gg()),[D,S]=d.useState(!1),[P,M]=d.useState(!1),T=d.useRef(null);if(u)throw new Error("");const A=()=>{R(gg())},F=z=>{const V=z[0];f(V),Ir("logCacheSize",V)},L=z=>{const V=z[0];g(V),Ir("wsReconnectInterval",V)},J=z=>{const V=z[0];v(V),Ir("wsMaxReconnectAttempts",V)},U=z=>{const V=z[0];w(V),Ir("dataSyncInterval",V)},ue=()=>{In.clearLogs(),n({title:"",description:""})},xe=()=>{const z=I1();A(),n({title:"",description:` ${z.clearedKeys.length} `})},he=()=>{S(!0);try{const z=U1(),V=JSON.stringify(z,null,2),B=new Blob([V],{type:"application/json"}),oe=URL.createObjectURL(B),K=document.createElement("a");K.href=oe,K.download=`maibot-webui-settings-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(oe),n({title:"",description:" JSON "})}catch(z){console.error(":",z),n({title:"",description:"",variant:"destructive"})}finally{S(!1)}},ne=z=>{const V=z.target.files?.[0];if(!V)return;M(!0);const B=new FileReader;B.onload=oe=>{try{const K=oe.target?.result,_e=JSON.parse(K),pe=$1(_e);pe.success?(f(yt("logCacheSize")),g(yt("wsReconnectInterval")),v(yt("wsMaxReconnectAttempts")),w(yt("dataSyncInterval")),A(),n({title:"",description:` ${pe.imported.length} ${pe.skipped.length>0?` ${pe.skipped.length} `:""}`}),(pe.imported.includes("theme")||pe.imported.includes("accentColor"))&&n({title:"",description:""})):n({title:"",description:"",variant:"destructive"})}catch(K){console.error(":",K),n({title:"",description:"",variant:"destructive"})}finally{M(!1),T.current&&(T.current.value="")}},B.readAsText(V)},ve=()=>{B1(),f(cl.logCacheSize),g(cl.wsReconnectInterval),v(cl.wsMaxReconnectAttempts),w(cl.dataSyncInterval),A(),n({title:"",description:""})},je=async()=>{c(!0);try{const z=await we("/api/webui/setup/reset",{method:"POST"}),V=await z.json();z.ok&&V.success?(n({title:"",description:""}),setTimeout(()=>{l({to:"/setup"})},1e3)):n({title:"",description:V.message||"",variant:"destructive"})}catch(z){console.error(":",z),n({title:"",description:"",variant:"destructive"})}finally{c(!1)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Hr,{className:"h-5 w-5"}),""]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Qw,{className:"h-4 w-4"}),""]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:A,className:"h-7 px-2",children:e.jsx(dt,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:P1(b.used)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[b.items," "]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h," "]})]}),e.jsx(qa,{value:[h],onValueChange:F,min:100,max:5e3,step:100,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y," "]})]}),e.jsx(qa,{value:[y],onValueChange:U,min:10,max:120,step:5,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p/1e3," "]})]}),e.jsx(qa,{value:[p],onValueChange:L,min:1e3,max:1e4,step:500,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" WebSocket "})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-sm font-medium",children:"WebSocket "}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[N," "]})]}),e.jsx(qa,{value:[N],onValueChange:J,min:3,max:30,step:1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:ue,className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),""]}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:" "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:xe,children:""})]})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(sa,{className:"h-5 w-5"}),"/"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:"outline",onClick:he,disabled:D,className:"gap-2",children:[e.jsx(sa,{className:"h-4 w-4"}),D?"...":""]}),e.jsx("input",{ref:T,type:"file",accept:".json",onChange:ne,className:"hidden"}),e.jsxs(_,{variant:"outline",onClick:()=>T.current?.click(),disabled:P,className:"gap-2",children:[e.jsx(ec,{className:"h-4 w-4"}),P?"...":""]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"gap-2 text-destructive hover:text-destructive",children:[e.jsx(Zi,{className:"h-4 w-4"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:" "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:ve,children:""})]})]})]})})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"outline",disabled:i,className:"gap-2",children:[e.jsx(Zi,{className:I("h-4 w-4",i&&"animate-spin")}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:""})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:je,children:""})]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-dashed border-yellow-500/50 bg-yellow-500/5 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-yellow-500"}),""]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""})}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"destructive",className:"gap-2",children:[e.jsx(Jt,{className:"h-4 w-4"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:" React  "})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>x(!0),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})]})]})]})]})}function Q1(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"rounded-lg border-2 border-primary/30 bg-gradient-to-r from-primary/5 to-primary/10 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-shrink-0 rounded-lg bg-primary/10 p-2 sm:p-3",children:e.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-foreground mb-2",children:""}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3",children:" GitHub  Star  "}),e.jsxs("a",{href:"https://github.com/Mai-with-u/MaiBot-Dashboard",target:"_blank",rel:"noopener noreferrer",className:I("inline-flex items-center gap-2 px-4 py-2 rounded-lg","bg-primary text-primary-foreground font-medium text-sm","hover:bg-primary/90 transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})," GitHub",e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:[" ",sx]}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("p",{children:[": ",ed]}),e.jsx("p",{children:"MaiBot Web "})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"MaiBot "}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Mai-with-u"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"WebUI"}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Mai-with-u ",e.jsx("a",{href:"https://github.com/DrSmoothl",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"@MotricSeven"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"React 19.2.0"}),e.jsx("li",{children:"TypeScript 5.7.2"}),e.jsx("li",{children:"Vite 6.0.7"}),e.jsx("li",{children:"TanStack Router 1.94.2"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:"UI "}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"shadcn/ui"}),e.jsx("li",{children:"Radix UI"}),e.jsx("li",{children:"Tailwind CSS 3.4.17"}),e.jsx("li",{children:"Lucide Icons"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Python 3.12+"}),e.jsx("li",{children:"FastAPI"}),e.jsx("li",{children:"Uvicorn"}),e.jsx("li",{children:"WebSocket"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"font-medium text-foreground",children:""}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Bun / npm"}),e.jsx("li",{children:"ESLint 9.17.0"}),e.jsx("li",{children:"PostCSS"})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-3",children:""}),e.jsx(Ye,{className:"h-[300px] sm:h-[400px]",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"UI "}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"React",description:"",license:"MIT"}),e.jsx(ft,{name:"shadcn/ui",description:" React ",license:"MIT"}),e.jsx(ft,{name:"Radix UI",description:"",license:"MIT"}),e.jsx(ft,{name:"Tailwind CSS",description:" CSS ",license:"MIT"}),e.jsx(ft,{name:"Lucide React",description:"",license:"ISC"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"TanStack Router",description:"",license:"MIT"}),e.jsx(ft,{name:"Zustand",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"React Hook Form",description:"",license:"MIT"}),e.jsx(ft,{name:"Zod",description:"TypeScript  schema ",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"clsx",description:" className ",license:"MIT"}),e.jsx(ft,{name:"tailwind-merge",description:"Tailwind ",license:"MIT"}),e.jsx(ft,{name:"class-variance-authority",description:"",license:"Apache-2.0"}),e.jsx(ft,{name:"date-fns",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"Framer Motion",description:"React ",license:"MIT"}),e.jsx(ft,{name:"vaul",description:"",license:"MIT"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"FastAPI",description:" Python Web ",license:"MIT"}),e.jsx(ft,{name:"Uvicorn",description:"ASGI ",license:"BSD-3-Clause"}),e.jsx(ft,{name:"Pydantic",description:"",license:"MIT"}),e.jsx(ft,{name:"python-multipart",description:"",license:"Apache-2.0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:""}),e.jsxs("div",{className:"grid gap-2 text-xs sm:text-sm",children:[e.jsx(ft,{name:"TypeScript",description:"JavaScript ",license:"Apache-2.0"}),e.jsx(ft,{name:"Vite",description:"",license:"MIT"}),e.jsx(ft,{name:"ESLint",description:"JavaScript ",license:"MIT"}),e.jsx(ft,{name:"PostCSS",description:"CSS ",license:"MIT"})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:""}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/5 border border-primary/20 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:"rounded-md bg-primary/10 px-2 py-1",children:e.jsx("span",{className:"text-xs sm:text-sm font-bold text-primary",children:"GPLv3"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm sm:text-base font-semibold text-foreground mb-1",children:"MaiBot WebUI"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" GNU General Public License v3.0  "})]})]})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"MITApache-2.0BSD  "})]})]})]})}function ft({name:l,description:n,license:i}){return e.jsxs("div",{className:"flex items-start justify-between gap-2 rounded-lg border bg-muted/30 p-2.5 sm:p-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground truncate",children:l}),e.jsx("p",{className:"text-muted-foreground text-xs mt-0.5",children:n})]}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary flex-shrink-0",children:i})]})}function Cm({value:l,current:n,onChange:i,label:c,description:u}){const x=n===l;return e.jsxs("button",{onClick:()=>i(l),className:I("relative rounded-lg border-2 p-3 sm:p-4 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",x?"border-primary bg-accent":"border-border"),children:[x&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3 h-2 w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm sm:text-base font-medium",children:c}),e.jsx("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:u})]}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex gap-1",children:[l==="light"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-200"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-300"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-400"})]}),l==="dark"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"})]}),l==="system"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-200 to-slate-700"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-300 to-slate-800"}),e.jsx("div",{className:"h-2 w-2 rounded-full bg-gradient-to-r from-slate-400 to-slate-900"})]})]})]})}function Ga({value:l,current:n,onChange:i,label:c,colorClass:u}){const x=n===l;return e.jsxs("button",{onClick:()=>i(l),className:I("relative rounded-lg border-2 p-2 sm:p-3 text-left transition-all","hover:border-primary/50 hover:bg-accent/50",x?"border-primary bg-accent":"border-border"),children:[x&&e.jsx("div",{className:"absolute top-1.5 right-1.5 sm:top-2 sm:right-2 h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full bg-primary"}),e.jsxs("div",{className:"flex flex-col items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:I("h-8 w-8 sm:h-10 sm:w-10 rounded-full",u)}),e.jsx("div",{className:"text-[10px] sm:text-xs font-medium text-center",children:c})]})]})}const Y1=Date.now()%1e6;class J1{grad3;p;perm;constructor(n=0){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];for(let i=0;i<256;i++)this.p[i]=Math.floor(Math.random()*256);this.perm=[];for(let i=0;i<512;i++)this.perm[i]=this.p[i&255]}dot(n,i,c){return n[0]*i+n[1]*c}mix(n,i,c){return(1-c)*n+c*i}fade(n){return n*n*n*(n*(n*6-15)+10)}perlin2(n,i){const c=Math.floor(n)&255,u=Math.floor(i)&255;n-=Math.floor(n),i-=Math.floor(i);const x=this.fade(n),h=this.fade(i),f=this.perm[c]+u,p=this.perm[f],g=this.perm[f+1],N=this.perm[c+1]+u,v=this.perm[N],y=this.perm[N+1];return this.mix(this.mix(this.dot(this.grad3[p%12],n,i),this.dot(this.grad3[v%12],n-1,i),x),this.mix(this.dot(this.grad3[g%12],n,i-1),this.dot(this.grad3[y%12],n-1,i-1),x),h)}}function vg(){const l=d.useRef(null),n=d.useRef(null),i=d.useRef(void 0),[c]=d.useState(()=>new J1(Y1)),u=d.useRef({mouse:{x:-10,y:0,lx:0,ly:0,sx:0,sy:0,v:0,vs:0,a:0,set:!1},lines:[],paths:[],noise:c,bounding:null});return d.useEffect(()=>{const x=n.current,h=l.current;if(!x||!h)return;const f=u.current;f.noise=c;const p=()=>{const D=x.getBoundingClientRect();f.bounding=D,h.style.width=`${D.width}px`,h.style.height=`${D.height}px`},g=()=>{if(!f.bounding)return;const{width:D,height:S}=f.bounding;f.lines=[],f.paths.forEach(ue=>ue.remove()),f.paths=[];const P=10,M=32,T=D+200,A=S+30,F=Math.ceil(T/P),L=Math.ceil(A/M),J=(D-P*F)/2,U=(S-M*L)/2;for(let ue=0;ue<=F;ue++){const xe=[];for(let ne=0;ne<=L;ne++){const ve={x:J+P*ue,y:U+M*ne,wave:{x:0,y:0},cursor:{x:0,y:0,vx:0,vy:0}};xe.push(ve)}const he=document.createElementNS("http://www.w3.org/2000/svg","path");h.appendChild(he),f.paths.push(he),f.lines.push(xe)}},N=D=>{const{lines:S,mouse:P,noise:M}=f;S.forEach(T=>{T.forEach(A=>{const F=M.perlin2((A.x+D*.0125)*.002,(A.y+D*.005)*.0015)*12;A.wave.x=Math.cos(F)*32,A.wave.y=Math.sin(F)*16;const L=A.x-P.sx,J=A.y-P.sy,U=Math.hypot(L,J),ue=Math.max(175,P.vs);if(U<ue){const xe=1-U/ue,he=Math.cos(U*.001)*xe;A.cursor.vx+=Math.cos(P.a)*he*ue*P.vs*65e-5,A.cursor.vy+=Math.sin(P.a)*he*ue*P.vs*65e-5}A.cursor.vx+=(0-A.cursor.x)*.005,A.cursor.vy+=(0-A.cursor.y)*.005,A.cursor.vx*=.925,A.cursor.vy*=.925,A.cursor.x+=A.cursor.vx*2,A.cursor.y+=A.cursor.vy*2,A.cursor.x=Math.min(100,Math.max(-100,A.cursor.x)),A.cursor.y=Math.min(100,Math.max(-100,A.cursor.y))})})},v=(D,S=!0)=>{const P={x:D.x+D.wave.x+(S?D.cursor.x:0),y:D.y+D.wave.y+(S?D.cursor.y:0)};return P.x=Math.round(P.x*10)/10,P.y=Math.round(P.y*10)/10,P},y=()=>{const{lines:D,paths:S}=f;D.forEach((P,M)=>{let T=v(P[0],!1),A=`M ${T.x} ${T.y}`;P.forEach((F,L)=>{const J=L===P.length-1;T=v(F,!J),A+=`L ${T.x} ${T.y}`}),S[M].setAttribute("d",A)})},w=D=>{const{mouse:S}=f;S.sx+=(S.x-S.sx)*.1,S.sy+=(S.y-S.sy)*.1;const P=S.x-S.lx,M=S.y-S.ly,T=Math.hypot(P,M);S.v=T,S.vs+=(T-S.vs)*.1,S.vs=Math.min(100,S.vs),S.lx=S.x,S.ly=S.y,S.a=Math.atan2(M,P),x&&(x.style.setProperty("--x",`${S.sx}px`),x.style.setProperty("--y",`${S.sy}px`)),N(D),y(),i.current=requestAnimationFrame(w)},b=D=>{if(!f.bounding)return;const{mouse:S}=f;S.x=D.pageX-f.bounding.left,S.y=D.pageY-f.bounding.top+window.scrollY,S.set||(S.sx=S.x,S.sy=S.y,S.lx=S.x,S.ly=S.y,S.set=!0)},R=()=>{p(),g()};return p(),g(),window.addEventListener("resize",R),window.addEventListener("mousemove",b),i.current=requestAnimationFrame(w),()=>{window.removeEventListener("resize",R),window.removeEventListener("mousemove",b),i.current&&cancelAnimationFrame(i.current)}},[c]),e.jsxs("div",{ref:n,className:"waves-background",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},children:[e.jsx("div",{className:"waves-cursor",style:{position:"absolute",top:0,left:0,width:"0.5rem",height:"0.5rem",background:"hsl(var(--primary) / 0.3)",borderRadius:"50%",transform:"translate3d(calc(var(--x, -0.5rem) - 50%), calc(var(--y, 50%) - 50%), 0)",willChange:"transform",pointerEvents:"none"}}),e.jsx("svg",{ref:l,style:{display:"block",width:"100%",height:"100%"},children:e.jsx("style",{children:`
          path {
            fill: none;
            stroke: hsl(var(--primary) / 0.20);
            stroke-width: 1px;
          }
        `})})]})}function X1(){const[l,n]=d.useState(""),[i,c]=d.useState(!1),[u,x]=d.useState(""),[h,f]=d.useState(!0),p=ca(),{enableWavesBackground:g,setEnableWavesBackground:N}=uv(),{theme:v,setTheme:y}=ex();d.useEffect(()=>{(async()=>{try{await tc()&&p({to:"/"})}catch{}finally{f(!1)}})()},[p]);const b=v==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":v,R=()=>{y(b==="dark"?"light":"dark")},D=async S=>{if(S.preventDefault(),x(""),!l.trim()){x(" Access Token");return}c(!0),console.log(" token...");try{const P=await fetch("/api/webui/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:l.trim()})});console.log("Token :",P.status);const M=await P.json();if(console.log("Token :",M),P.ok&&M.valid){console.log("Token ..."),console.log("is_first_setup:",M.is_first_setup),await new Promise(A=>setTimeout(A,100));const T=await tc();console.log(":",T),M.is_first_setup?(console.log(""),p({to:"/setup"})):(console.log(""),p({to:"/"}))}else console.error("Token :",M.message),x(M.message||"Token ")}catch(P){console.error("Token :",P),x("")}finally{c(!1)}};return h?e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(vg,{}),e.jsx("div",{className:"text-muted-foreground",children:"..."})]}):e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-background p-4",children:[g&&e.jsx(vg,{}),e.jsxs(Ce,{className:"relative z-10 w-full max-w-md shadow-2xl backdrop-blur-xl bg-card/80 border-border/50",children:[e.jsx("button",{onClick:R,className:"absolute right-4 top-4 rounded-lg p-2 hover:bg-accent transition-colors z-10 text-foreground",title:b==="dark"?"":"",children:b==="dark"?e.jsx(qm,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"}):e.jsx(Qi,{className:"h-5 w-5",strokeWidth:2.5,fill:"none"})}),e.jsxs(De,{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(rg,{className:"h-8 w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Le,{className:"text-2xl font-bold",children:" MaiBot"}),e.jsx(ws,{className:"text-base",children:" Access Token "})]})]}),e.jsx(Ae,{children:e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"token",className:"text-sm font-medium",children:"Access Token"}),e.jsxs("div",{className:"relative",children:[e.jsx(Km,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground",strokeWidth:2,fill:"none"}),e.jsx(le,{id:"token",type:"password",placeholder:" Access Token",value:l,onChange:S=>n(S.target.value),className:I("pl-10",u&&"border-red-500 focus-visible:ring-red-500"),disabled:i,autoFocus:!0,autoComplete:"off"})]})]}),u&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-red-50 p-3 text-sm text-red-600 dark:bg-red-950/50 dark:text-red-400",children:[e.jsx(_t,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{children:u})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):""}),e.jsxs(Is,{children:[e.jsx(Wo,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-primary hover:text-primary/80 transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(Dj,{className:"h-4 w-4",strokeWidth:2,fill:"none"})," Token Token"]})}),e.jsxs(Os,{className:"sm:max-w-md",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(rg,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"})," Access Token"]}),e.jsx(Ks,{children:"Access Token  MaiBot WebUI "})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Yw,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" MaiBot  WebUI Access Token"}),e.jsxs("div",{className:"rounded bg-background p-2 font-mono text-xs",children:[e.jsx("p",{className:"text-muted-foreground",children:" WebUI Access Token: abc123..."}),e.jsx("p",{className:"text-muted-foreground",children:"  Token  WebUI"})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ca,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Token "}),e.jsx("div",{className:"rounded bg-background p-2 font-mono text-xs break-all",children:e.jsx("code",{className:"text-primary",children:"data/webui.json"})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",e.jsx("code",{className:"px-1 py-0.5 bg-background rounded",children:"access_token"})," "]})]})]})}),e.jsx("div",{className:"rounded-lg border border-yellow-200 dark:border-yellow-900 bg-yellow-50 dark:bg-yellow-950/30 p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_t,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-500 flex-shrink-0 mt-0.5",strokeWidth:2,fill:"none"}),e.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-300 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsx("li",{children:" Token"}),e.jsx("li",{children:" Token"})]})]})]})})]})]})]}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs("button",{className:"w-full text-center text-sm text-muted-foreground hover:text-foreground transition-colors underline-offset-4 hover:underline flex items-center justify-center gap-1",children:[e.jsx(Za,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsxs(xs,{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"h-5 w-5 text-primary",strokeWidth:2,fill:"none"}),""]}),e.jsx(hs,{children:""})]}),e.jsx("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>N(!1),children:""})]})]})]})]})})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:D1})})]})}const ot=d.forwardRef(({className:l,...n},i)=>e.jsx("textarea",{className:I("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),ref:i,...n}));ot.displayName="Textarea";const Yt=d.forwardRef(({className:l,orientation:n="horizontal",decorative:i=!0,...c},u)=>e.jsx(ej,{ref:u,decorative:i,orientation:n,className:I("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",l),...c}));Yt.displayName=ej.displayName;function Z1({config:l,onChange:n}){const i=u=>{u.trim()&&!l.alias_names.includes(u.trim())&&n({...l,alias_names:[...l.alias_names,u.trim()]})},c=u=>{n({...l,alias_names:l.alias_names.filter((x,h)=>h!==u)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"qq_account",children:"QQ *"}),e.jsx(le,{id:"qq_account",type:"number",placeholder:"QQ",value:l.qq_account||"",onChange:u=>n({...l,qq_account:Number(u.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"QQ"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"nickname",children:" *"}),e.jsx(le,{id:"nickname",placeholder:"",value:l.nickname,onChange:u=>n({...l,nickname:u.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{children:""}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:l.alias_names.map((u,x)=>e.jsxs(Se,{variant:"secondary",className:"gap-1",children:[u,e.jsx("button",{type:"button",onClick:()=>c(x),className:"ml-1 hover:text-destructive",children:e.jsx(Ea,{className:"h-3 w-3"})})]},x))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{id:"alias_input",placeholder:"",onKeyPress:u=>{u.key==="Enter"&&(i(u.target.value),u.target.value="")}}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>{const u=document.getElementById("alias_input");u&&(i(u.value),u.value="")},children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function W1({config:l,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"personality",children:" *"}),e.jsx(ot,{id:"personality",placeholder:"120",value:l.personality,onChange:i=>n({...l,personality:i.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"reply_style",children:" *"}),e.jsx(ot,{id:"reply_style",placeholder:"",value:l.reply_style,onChange:i=>n({...l,reply_style:i.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"interest",children:" *"}),e.jsx(ot,{id:"interest",placeholder:"",value:l.interest,onChange:i=>n({...l,interest:i.target.value}),rows:2}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"plan_style",children:" *"}),e.jsx(ot,{id:"plan_style",placeholder:"",value:l.plan_style,onChange:i=>n({...l,plan_style:i.target.value}),rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"private_plan_style",children:" *"}),e.jsx(ot,{id:"private_plan_style",placeholder:"",value:l.private_plan_style,onChange:i=>n({...l,private_plan_style:i.target.value}),rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function e2({config:l,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{htmlFor:"emoji_chance",children:""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[(l.emoji_chance*100).toFixed(0),"%"]})]}),e.jsx(le,{id:"emoji_chance",type:"range",min:"0",max:"1",step:"0.1",value:l.emoji_chance,onChange:i=>n({...l,emoji_chance:Number(i.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"max_reg_num",children:""}),e.jsx(le,{id:"max_reg_num",type:"number",min:"1",max:"200",value:l.max_reg_num,onChange:i=>n({...l,max_reg_num:Number(i.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"do_replace",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"do_replace",checked:l.do_replace,onCheckedChange:i=>n({...l,do_replace:i})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"check_interval",children:""}),e.jsx(le,{id:"check_interval",type:"number",min:"1",max:"120",value:l.check_interval,onChange:i=>n({...l,check_interval:Number(i.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"steal_emoji",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"steal_emoji",checked:l.steal_emoji,onCheckedChange:i=>n({...l,steal_emoji:i})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"content_filtration",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"content_filtration",checked:l.content_filtration,onCheckedChange:i=>n({...l,content_filtration:i})})]}),l.content_filtration&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"filtration_prompt",children:""}),e.jsx(le,{id:"filtration_prompt",placeholder:"",value:l.filtration_prompt,onChange:i=>n({...l,filtration_prompt:i.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})}function s2({config:l,onChange:n}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"enable_tool",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"enable_tool",checked:l.enable_tool,onCheckedChange:i=>n({...l,enable_tool:i})})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"all_global",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"all_global",checked:l.all_global,onCheckedChange:i=>n({...l,all_global:i})})]})]})}function t2({config:l,onChange:n}){const[i,c]=d.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:" (SiliconFlow)"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 mb-2",children:" DeepSeek V3Qwen  API Key "}),e.jsxs("a",{href:"https://cloud.siliconflow.cn",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:underline font-medium",children:[" API Key",e.jsx(Mo,{className:"h-3 w-3"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(E,{htmlFor:"siliconflow_api_key",children:"SiliconFlow API Key *"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{id:"siliconflow_api_key",type:i?"text":"password",placeholder:"sk-...",value:l.api_key,onChange:u=>n({api_key:u.target.value}),className:"font-mono pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>c(!i),children:i?e.jsx(Wi,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(ia,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" API "})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium",children:""}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground ml-2",children:[e.jsx("li",{children:"DeepSeek V3 - "}),e.jsx("li",{children:"Qwen3 30B - "}),e.jsx("li",{children:"Qwen3 VL 30B - "}),e.jsx("li",{children:"SenseVoice - "}),e.jsx("li",{children:"BGE-M3 - "}),e.jsx("li",{children:" (LPMM)"})]})]}),e.jsx("div",{className:"rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/30 p-4",children:e.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-medium",children:" "}),'"  " API ']})})]})}async function a2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("Bot");const i=(await l.json()).config.bot||{};return{qq_account:i.qq_account||0,nickname:i.nickname||"",alias_names:i.alias_names||[]}}async function l2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");const i=(await l.json()).config.personality||{};return{personality:i.personality||"",reply_style:i.reply_style||"",interest:i.interest||"",plan_style:i.plan_style||"",private_plan_style:i.private_plan_style||""}}async function n2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");const i=(await l.json()).config.emoji||{};return{emoji_chance:i.emoji_chance??.4,max_reg_num:i.max_reg_num??40,do_replace:i.do_replace??!0,check_interval:i.check_interval??10,steal_emoji:i.steal_emoji??!0,content_filtration:i.content_filtration??!1,filtration_prompt:i.filtration_prompt||""}}async function r2(){const l=await we("/api/webui/config/bot",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");const i=(await l.json()).config,c=i.tool||{},u=i.expression||{};return{enable_tool:c.enable_tool??!0,all_global:u.all_global_jargon??!0}}async function i2(){const l=await we("/api/webui/config/model",{method:"GET",headers:Fs()});if(!l.ok)throw new Error("");return{api_key:((await l.json()).config.api_providers||[]).find(x=>x.name==="SiliconFlow")?.api_key||""}}async function c2(l){const n=await we("/api/webui/config/bot/section/bot",{method:"POST",headers:Fs(),body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"Bot")}return await n.json()}async function o2(l){const n=await we("/api/webui/config/bot/section/personality",{method:"POST",headers:Fs(),body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function d2(l){const n=await we("/api/webui/config/bot/section/emoji",{method:"POST",headers:Fs(),body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function u2(l){const n=[];n.push(we("/api/webui/config/bot/section/tool",{method:"POST",headers:Fs(),body:JSON.stringify({enable_tool:l.enable_tool})})),n.push(we("/api/webui/config/bot/section/expression",{method:"POST",headers:Fs(),body:JSON.stringify({all_global_jargon:l.all_global})}));const i=await Promise.all(n);for(const c of i)if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return{success:!0}}async function m2(l){const n=await we("/api/webui/config/model",{method:"GET",headers:Fs()});if(!n.ok)throw new Error("");const c=(await n.json()).config,u=c.api_providers||[],x=u.findIndex(p=>p.name==="SiliconFlow");x>=0?u[x]={...u[x],api_key:l.api_key}:u.push({name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",api_key:l.api_key,client_type:"openai",max_retry:3,timeout:120,retry_interval:5});const h={...c,api_providers:u},f=await we("/api/webui/config/model",{method:"POST",headers:Fs(),body:JSON.stringify(h)});if(!f.ok){const p=await f.json();throw new Error(p.detail||"")}return await f.json()}async function Ng(){const l=await we("/api/webui/setup/complete",{method:"POST"});if(!l.ok){const n=await l.json();throw new Error(n.message||"")}return await l.json()}function x2(){return e.jsx(Yn,{children:e.jsx(h2,{})})}function h2(){const l=ca(),{toast:n}=Zs(),{triggerRestart:i}=vn(),[c,u]=d.useState(0),[x,h]=d.useState(!1),[f,p]=d.useState(!1),[g,N]=d.useState(!0),[v,y]=d.useState({qq_account:0,nickname:"",alias_names:[]}),[w,b]=d.useState({personality:"",reply_style:"",interest:"",plan_style:`1.****action****
2.
3.
4.
5.`,private_plan_style:`1.****action****
2.
3.`}),[R,D]=d.useState({emoji_chance:.4,max_reg_num:40,do_replace:!0,check_interval:10,steal_emoji:!0,content_filtration:!1,filtration_prompt:""}),[S,P]=d.useState({enable_tool:!0,all_global:!0}),[M,T]=d.useState({api_key:""}),A=[{id:"bot-basic",title:"Bot",description:"",icon:Pn},{id:"personality",title:"",description:"",icon:fn},{id:"emoji",title:"",description:"",icon:Yo},{id:"other",title:"",description:"",icon:pn},{id:"siliconflow",title:"API",description:"API",icon:Km}],F=(c+1)/A.length*100;d.useEffect(()=>{(async()=>{try{N(!0);const[ve,je,z,V,B]=await Promise.all([a2(),l2(),n2(),r2(),i2()]);y(ve),b(je),D(z),P(V),T(B)}catch(ve){n({title:"",description:ve instanceof Error?ve.message:"",variant:"destructive"})}finally{N(!1)}})()},[n]);const L=async()=>{p(!0);try{switch(c){case 0:await c2(v);break;case 1:await o2(w);break;case 2:await d2(R);break;case 3:await u2(S);break;case 4:await m2(M);break}return n({title:"",description:`${A[c].title}`}),!0}catch(ne){return n({title:"",description:ne instanceof Error?ne.message:"",variant:"destructive"}),!1}finally{p(!1)}},J=async()=>{await L()&&c<A.length-1&&u(c+1)},U=()=>{c>0&&u(c-1)},ue=async()=>{h(!0);try{if(!await L()){h(!1);return}await Ng(),n({title:"",description:"..."}),await i()}catch(ne){n({title:"",description:ne instanceof Error?ne.message:"",variant:"destructive"})}finally{h(!1)}},xe=async()=>{try{await Ng(),l({to:"/"})}catch(ne){n({title:"",description:ne instanceof Error?ne.message:"",variant:"destructive"})}},he=()=>{switch(c){case 0:return e.jsx(Z1,{config:v,onChange:y});case 1:return e.jsx(W1,{config:w,onChange:b});case 2:return e.jsx(e2,{config:R,onChange:D});case 3:return e.jsx(s2,{config:S,onChange:P});case 4:return e.jsx(t2,{config:M,onChange:T});default:return null}};return e.jsxs("div",{className:"relative flex min-h-screen flex-col items-center justify-center overflow-hidden bg-gradient-to-br from-primary/5 via-background to-secondary/5 p-4 md:p-6",children:[e.jsx(Jn,{}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute left-1/4 top-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-primary/5 blur-3xl"}),e.jsx("div",{className:"absolute right-1/4 bottom-1/4 h-64 w-64 md:h-96 md:w-96 rounded-full bg-secondary/5 blur-3xl"})]}),g?e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center",children:e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})}),e.jsx("p",{className:"text-lg font-medium",children:"..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative z-10 w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6 md:mb-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 md:h-16 md:w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(Jw,{className:"h-6 w-6 md:h-8 md:w-8 text-primary",strokeWidth:2,fill:"none"})}),e.jsx("h1",{className:"mb-2 text-2xl md:text-3xl font-bold",children:""}),e.jsxs("p",{className:"text-sm md:text-base text-muted-foreground",children:[" ",sx," "]})]}),e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs md:text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[" ",c+1," / ",A.length]}),e.jsxs("span",{className:"font-medium text-primary",children:[Math.round(F),"%"]})]}),e.jsx(Kn,{value:F,className:"h-2"})]}),e.jsx("div",{className:"mb-6 md:mb-8 flex justify-between",children:A.map((ne,ve)=>{const je=ne.icon;return e.jsxs("div",{className:I("flex flex-1 flex-col items-center gap-1 md:gap-2",ve<A.length-1&&"relative"),children:[ve<A.length-1&&e.jsx("div",{className:I("absolute left-1/2 top-3 md:top-4 h-0.5 w-full",ve<c?"bg-primary":"bg-border")}),e.jsx("div",{className:I("relative z-10 flex h-6 w-6 md:h-8 md:w-8 items-center justify-center rounded-full border-2 transition-all",ve===c||ve<c?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-muted-foreground"),children:ve<c?e.jsx(pt,{className:"h-3 w-3 md:h-4 md:w-4",strokeWidth:2.5,fill:"none"}):e.jsx(je,{className:"h-3 w-3 md:h-4 md:w-4"})}),e.jsx("span",{className:I("text-[10px] md:text-xs text-center max-w-[60px] md:max-w-none truncate md:whitespace-normal",ve===c?"font-medium text-foreground":"text-muted-foreground"),title:ne.title,children:ne.title})]},ne.id)})}),e.jsx(Ce,{className:"mb-6 md:mb-8 shadow-lg",children:e.jsx(Ae,{className:"p-4 md:p-8",children:e.jsxs("div",{className:"min-h-[300px] md:min-h-[400px]",children:[e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsx("h2",{className:"mb-2 text-xl md:text-2xl font-semibold",children:A[c].title}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:A[c].description})]}),e.jsx(Ye,{className:"h-[400px] md:h-[500px]",children:e.jsx("div",{className:"pr-2",children:he()})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:U,disabled:c===0||f,className:"w-full sm:w-auto order-2 sm:order-1",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto order-1 sm:order-2",children:[e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"flex-1 sm:flex-none gap-2",disabled:f||x,children:[e.jsx(Xw,{className:"h-4 w-4",strokeWidth:2,fill:"none"}),""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:""})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:xe,children:""})]})]})]}),c===A.length-1?e.jsx(_,{onClick:ue,disabled:x||f,className:"flex-1 sm:flex-none",children:x||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),f?"...":"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(pt,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})}):e.jsx(_,{onClick:J,disabled:f,className:"flex-1 sm:flex-none",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"..."]}):e.jsxs(e.Fragment,{children:["",e.jsx(Zw,{className:"ml-2 h-4 w-4",strokeWidth:2,fill:"none"})]})})]})]})]}),e.jsx("div",{className:"relative z-10 mt-6 md:mt-8 text-center text-xs text-muted-foreground",children:e.jsx("p",{children:""})})]})]})}function hv(){const l=ca();return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-2xl text-center",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("h1",{className:"text-[150px] font-black leading-none text-primary/10 select-none sm:text-[200px]",children:"404"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Tt,{className:"h-20 w-20 text-primary/30 sm:h-24 sm:w-24"})})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground sm:text-3xl",children:""}),e.jsx("p",{className:"text-base text-muted-foreground sm:text-lg max-w-md mx-auto",children:" URL "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs(_,{size:"lg",onClick:()=>l({to:"/"}),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Jo,{className:"h-4 w-4"}),""]}),e.jsxs(_,{size:"lg",variant:"outline",onClick:()=>window.history.back(),className:"gap-2 w-full sm:w-auto",children:[e.jsx(Ta,{className:"h-4 w-4"}),""]})]}),e.jsx("div",{className:"mt-12 pt-8 border-t border-border",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:""})})]})})}const f2=As.memo(function({config:n,onChange:i}){const c=n.platforms||[],u=n.alias_names||[],x=()=>{i({...n,platforms:[...c,""]})},h=v=>{i({...n,platforms:c.filter((y,w)=>w!==v)})},f=(v,y)=>{const w=[...c];w[v]=y,i({...n,platforms:w})},p=()=>{i({...n,alias_names:[...u,""]})},g=v=>{i({...n,alias_names:u.filter((y,w)=>w!==v)})},N=(v,y)=>{const w=[...u];w[v]=y,i({...n,alias_names:w})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"platform",children:""}),e.jsx(le,{id:"platform",value:n.platform,onChange:v=>i({...n,platform:v.target.value}),placeholder:"qq"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"qq_account",children:"QQ"}),e.jsx(le,{id:"qq_account",value:n.qq_account,onChange:v=>i({...n,qq_account:v.target.value}),placeholder:"123456789"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"nickname",children:""}),e.jsx(le,{id:"nickname",value:n.nickname,onChange:v=>i({...n,nickname:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:""}),e.jsxs(_,{onClick:p,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[u.map((v,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:v,onChange:w=>N(y,w.target.value),placeholder:""}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',v||"()",'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>g(y),children:""})]})]})]})]},y)),u.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:""}),e.jsxs(_,{onClick:x,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((v,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:v,onChange:w=>f(y,w.target.value),placeholder:"wx:114514"}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',v||"()",'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>h(y),children:""})]})]})]})]},y)),c.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})]})})}),p2=As.memo(function({config:n,onChange:i}){const c=()=>{i({...n,states:[...n.states,""]})},u=h=>{i({...n,states:n.states.filter((f,p)=>p!==h)})},x=(h,f)=>{const p=[...n.states];p[h]=f,i({...n,states:p})};return e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"personality",children:""}),e.jsx(ot,{id:"personality",value:n.personality,onChange:h=>i({...n,personality:h.target.value}),placeholder:"120",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"120"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:""}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"space-y-2",children:n.states.map((h,f)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ot,{value:h,onChange:p=>x(f,p.target.value),placeholder:"",rows:2}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{children:""})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>u(f),children:""})]})]})]})]},f))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"state_probability",children:""}),e.jsx(le,{id:"state_probability",type:"number",step:"0.1",min:"0",max:"1",value:n.state_probability,onChange:h=>i({...n,state_probability:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.0-1.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"reply_style",children:""}),e.jsx(ot,{id:"reply_style",value:n.reply_style,onChange:h=>i({...n,reply_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"plan_style",children:""}),e.jsx(ot,{id:"plan_style",value:n.plan_style,onChange:h=>i({...n,plan_style:h.target.value}),placeholder:"",rows:5})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"visual_style",children:""}),e.jsx(ot,{id:"visual_style",value:n.visual_style,onChange:h=>i({...n,visual_style:h.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"private_plan_style",children:""}),e.jsx(ot,{id:"private_plan_style",value:n.private_plan_style,onChange:h=>i({...n,private_plan_style:h.target.value}),placeholder:"",rows:4})]})]})]})})}),Ie=Aw,Pe=Ow,$e=d.forwardRef(({className:l,children:n,...i},c)=>e.jsxs(gj,{ref:c,className:I("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",l),...i,children:[n,e.jsx(Cw,{asChild:!0,children:e.jsx(za,{className:"h-4 w-4 opacity-50"})})]}));$e.displayName=gj.displayName;const fv=d.forwardRef(({className:l,...n},i)=>e.jsx(jj,{ref:i,className:I("flex cursor-default items-center justify-center py-1",l),...n,children:e.jsx(Fr,{className:"h-4 w-4"})}));fv.displayName=jj.displayName;const pv=d.forwardRef(({className:l,...n},i)=>e.jsx(vj,{ref:i,className:I("flex cursor-default items-center justify-center py-1",l),...n,children:e.jsx(za,{className:"h-4 w-4"})}));pv.displayName=vj.displayName;const Be=d.forwardRef(({className:l,children:n,position:i="popper",...c},u)=>e.jsx(Tw,{children:e.jsxs(Nj,{ref:u,className:I("relative z-[100] max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-hidden rounded-md border border-border bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",i==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",l),position:i,...c,children:[e.jsx(fv,{}),e.jsx(Ew,{className:I("p-1",i==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(pv,{})]})}));Be.displayName=Nj.displayName;const g2=d.forwardRef(({className:l,...n},i)=>e.jsx(bj,{ref:i,className:I("px-2 py-1.5 text-sm font-semibold",l),...n}));g2.displayName=bj.displayName;const X=d.forwardRef(({className:l,children:n,...i},c)=>e.jsxs(yj,{ref:c,className:I("relative flex w-full cursor-default select-none items-center rounded-sm py-2 pl-2 pr-8 text-sm outline-none bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-gray-100 dark:focus:bg-gray-800 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),...i,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Mw,{children:e.jsx(Ct,{className:"h-4 w-4"})})}),e.jsx(zw,{children:n})]}));X.displayName=yj.displayName;const j2=d.forwardRef(({className:l,...n},i)=>e.jsx(wj,{ref:i,className:I("-mx-1 my-1 h-px bg-muted",l),...n}));j2.displayName=wj.displayName;const ol=q0,dl=K0,Wa=d.forwardRef(({className:l,align:n="center",sideOffset:i=4,...c},u)=>e.jsx(V0,{children:e.jsx(sj,{ref:u,align:n,sideOffset:i,className:I("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",l),...c})}));Wa.displayName=sj.displayName;const v2=As.memo(function({value:n,onChange:i}){const c=d.useMemo(()=>{const w=n.split("-");if(w.length===2){const[b,R]=w,[D,S]=b.split(":"),[P,M]=R.split(":");return{startHour:D?D.padStart(2,"0"):"00",startMinute:S?S.padStart(2,"0"):"00",endHour:P?P.padStart(2,"0"):"23",endMinute:M?M.padStart(2,"0"):"59"}}return{startHour:"00",startMinute:"00",endHour:"23",endMinute:"59"}},[n]),[u,x]=d.useState(c.startHour),[h,f]=d.useState(c.startMinute),[p,g]=d.useState(c.endHour),[N,v]=d.useState(c.endMinute);d.useEffect(()=>{x(c.startHour),f(c.startMinute),g(c.endHour),v(c.endMinute)},[c]);const y=(w,b,R,D)=>{const S=`${w}:${b}-${R}:${D}`;i(S)};return e.jsxs(ol,{children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"w-full justify-start font-mono text-sm",children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),n||""]})}),e.jsx(Wa,{className:"w-72 sm:w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-xs",children:""}),e.jsxs(Ie,{value:u,onValueChange:w=>{x(w),y(w,h,p,N)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:24},(w,b)=>b).map(w=>e.jsx(X,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-xs",children:""}),e.jsxs(Ie,{value:h,onValueChange:w=>{f(w),y(u,w,p,N)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:60},(w,b)=>b).map(w=>e.jsx(X,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-xs",children:""}),e.jsxs(Ie,{value:p,onValueChange:w=>{g(w),y(u,h,w,N)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:24},(w,b)=>b).map(w=>e.jsx(X,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-xs",children:""}),e.jsxs(Ie,{value:N,onValueChange:w=>{v(w),y(u,h,p,w)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:Array.from({length:60},(w,b)=>b).map(w=>e.jsx(X,{value:w.toString().padStart(2,"0"),children:w.toString().padStart(2,"0")},w))})]})]})]})]})]})})]})}),N2=As.memo(function({rule:n}){const i=`{ target = "${n.target}", time = "${n.time}", value = ${n.value.toFixed(1)} }`;return e.jsxs(ol,{children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Wa,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:i}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})}),b2=As.memo(function({config:n,onChange:i}){const c=()=>{i({...n,talk_value_rules:[...n.talk_value_rules,{target:"",time:"00:00-23:59",value:1}]})},u=h=>{i({...n,talk_value_rules:n.talk_value_rules.filter((f,p)=>p!==h)})},x=(h,f,p)=>{const g=[...n.talk_value_rules];g[h]={...g[h],[f]:p},i({...n,talk_value_rules:g})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"talk_value",children:""}),e.jsx(le,{id:"talk_value",type:"number",step:"0.1",min:"0",max:"1",value:n.talk_value,onChange:h=>i({...n,talk_value:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"think_mode",children:""}),e.jsxs(Ie,{value:n.think_mode||"classic",onValueChange:h=>i({...n,think_mode:h}),children:[e.jsx($e,{id:"think_mode",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"classic",children:" - "}),e.jsx(X,{value:"deep",children:" - "}),e.jsx(X,{value:"dynamic",children:" - "})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"mentioned_bot_reply",checked:n.mentioned_bot_reply,onCheckedChange:h=>i({...n,mentioned_bot_reply:h})}),e.jsx(E,{htmlFor:"mentioned_bot_reply",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"max_context_size",children:""}),e.jsx(le,{id:"max_context_size",type:"number",min:"1",value:n.max_context_size,onChange:h=>i({...n,max_context_size:parseInt(h.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"planner_smooth",children:""}),e.jsx(le,{id:"planner_smooth",type:"number",step:"1",min:"0",value:n.planner_smooth,onChange:h=>i({...n,planner_smooth:parseFloat(h.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" planner  1-50 "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_talk_value_rules",checked:n.enable_talk_value_rules,onCheckedChange:h=>i({...n,enable_talk_value_rules:h})}),e.jsx(E,{htmlFor:"enable_talk_value_rules",className:"cursor-pointer",children:""})]})]})]}),n.enable_talk_value_rules&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ID"})]}),e.jsxs(_,{onClick:c,size:"sm",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),n.talk_value_rules&&n.talk_value_rules.length>0?e.jsx("div",{className:"space-y-4",children:n.talk_value_rules.map((h,f)=>e.jsxs("div",{className:"rounded-lg border p-4 bg-muted/50 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[" #",f+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N2,{rule:h}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(ls,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" #",f+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>u(f),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:h.target===""?"global":"specific",onValueChange:p=>{p==="global"?x(f,"target",""):x(f,"target","qq::group")},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"global",children:""}),e.jsx(X,{value:"specific",children:""})]})]})]}),h.target!==""&&(()=>{const p=h.target.split(":"),g=p[0]||"qq",N=p[1]||"",v=p[2]||"group";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:g,onValueChange:y=>{x(f,"target",`${y}:${N}:${v}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"qq",children:"QQ"}),e.jsx(X,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:" ID"}),e.jsx(le,{value:N,onChange:y=>{x(f,"target",`${g}:${y.target.value}:${v}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:v,onValueChange:y=>{x(f,"target",`${g}:${N}:${y}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"group",children:"group"}),e.jsx(X,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",h.target||""]})]})})(),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:" (Time)"}),e.jsx(v2,{value:h.time,onChange:p=>x(f,"time",p)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00-02:00"})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{htmlFor:`rule-value-${f}`,className:"text-xs font-medium",children:" (Value)"}),e.jsx(le,{id:`rule-value-${f}`,type:"number",step:"0.01",min:"0.01",max:"1",value:h.value,onChange:p=>{const g=parseFloat(p.target.value);isNaN(g)||x(f,"value",Math.max(.01,Math.min(1,g)))},className:"w-20 h-8 text-xs"})]}),e.jsx(qa,{value:[h.value],onValueChange:p=>x(f,"value",p[0]),min:.01,max:1,step:.01,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0.01 ()"}),e.jsx("span",{children:"0.5"}),e.jsx("span",{children:"1.0 ()"})]})]})]})]},f))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:'""'})}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Target "}),"platform:id:type"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""}),""]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 23:00-02:00 112"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:""})," 0-10 1 "]})]})]})]})]})}),y2=As.memo(function({config:n,onChange:i}){const c=S=>{if(!S||!S.includes(":"))return{platform:"qq",userId:""};const[P,M]=S.split(":");return{platform:P,userId:M}},{platform:u,userId:x}=c(n.dream_send),[h,f]=d.useState(u),[p,g]=d.useState(x),N=S=>{const[P,M]=S.split("-");return{startTime:P||"09:00",endTime:M||"22:00"}},v=(S,P)=>{const M=P?`${S}:${P}`:"";i({...n,dream_send:M})},y=S=>{f(S),v(S,p)},w=S=>{g(S),v(h,S)},b=()=>{i({...n,dream_time_ranges:[...n.dream_time_ranges,"09:00-22:00"]})},R=S=>{i({...n,dream_time_ranges:n.dream_time_ranges.filter((P,M)=>M!==S)})},D=(S,P,M)=>{const T=[...n.dream_time_ranges],A=N(T[S]);P==="startTime"?A.startTime=M:A.endTime=M,T[S]=`${A.startTime}-${A.endTime}`,i({...n,dream_time_ranges:T})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"interval_minutes",children:""}),e.jsx(le,{id:"interval_minutes",type:"number",min:"1",value:n.interval_minutes,onChange:S=>i({...n,interval_minutes:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"max_iterations",children:""}),e.jsx(le,{id:"max_iterations",type:"number",min:"1",value:n.max_iterations,onChange:S=>i({...n,max_iterations:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"first_delay_seconds",children:""}),e.jsx(le,{id:"first_delay_seconds",type:"number",min:"0",value:n.first_delay_seconds,onChange:S=>i({...n,first_delay_seconds:Number(S.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:""}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ie,{value:h,onValueChange:y,children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"qq",children:"QQ"}),e.jsx(X,{value:"wx",children:""}),e.jsx(X,{value:"webui",children:"WebUI"})]})]}),e.jsx(le,{type:"text",placeholder:"ID (: 123456)",value:p,onChange:S=>w(S.target.value),className:"flex-1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IDID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:""}),e.jsx(_,{type:"button",size:"sm",onClick:b,children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 23:00  02:00"}),e.jsxs("div",{className:"space-y-2",children:[n.dream_time_ranges.map((S,P)=>{const{startTime:M,endTime:T}=N(S);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"time",value:M,onChange:A=>D(P,"startTime",A.target.value),className:"w-[140px]"}),e.jsx("span",{className:"text-muted-foreground",children:""}),e.jsx(le,{type:"time",value:T,onChange:A=>D(P,"endTime",A.target.value),className:"w-[140px]"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:()=>R(P),children:e.jsx(Ea,{className:"h-4 w-4"})})]},P)}),n.dream_time_ranges.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})]})}),w2=As.memo(function({config:n,onChange:i}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.enable,onCheckedChange:c=>i({...n,enable:c})}),e.jsx(E,{className:"cursor-pointer",children:" LPMM "})]}),n.enable&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:"LPMM "}),e.jsxs(Ie,{value:n.lpmm_mode,onValueChange:c=>i({...n,lpmm_mode:c}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:" LPMM "})}),e.jsxs(Be,{children:[e.jsx(X,{value:"classic",children:""}),e.jsx(X,{value:"agent",children:"Agent "})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:" TopK"}),e.jsx(le,{type:"number",min:"1",value:n.rag_synonym_search_top_k,onChange:c=>i({...n,rag_synonym_search_top_k:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",step:"0.1",min:"0",max:"1",value:n.rag_synonym_threshold,onChange:c=>i({...n,rag_synonym_threshold:parseFloat(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",min:"1",value:n.info_extraction_workers,onChange:c=>i({...n,info_extraction_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",min:"1",value:n.embedding_dimension,onChange:c=>i({...n,embedding_dimension:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",min:"1",value:n.max_embedding_workers,onChange:c=>i({...n,max_embedding_workers:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",min:"1",value:n.embedding_chunk_size,onChange:c=>i({...n,embedding_chunk_size:parseInt(c.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",min:"1",value:n.max_synonym_entities,onChange:c=>i({...n,max_synonym_entities:parseInt(c.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.enable_ppr,onCheckedChange:c=>i({...n,enable_ppr:c})}),e.jsx(E,{className:"cursor-pointer",children:" PPR ()"})]})]})]})]})}),_2=As.memo(function({config:n,onChange:i}){const[c,u]=d.useState(""),[x,h]=d.useState("WARNING"),f=()=>{c&&!n.suppress_libraries.includes(c)&&(i({...n,suppress_libraries:[...n.suppress_libraries,c]}),u(""))},p=b=>{i({...n,suppress_libraries:n.suppress_libraries.filter(R=>R!==b)})},g=()=>{c&&!n.library_log_levels[c]&&(i({...n,library_log_levels:{...n.library_log_levels,[c]:x}}),u(""),h("WARNING"))},N=b=>{const R={...n.library_log_levels};delete R[b],i({...n,library_log_levels:R})},v=["DEBUG","INFO","WARNING","ERROR","CRITICAL"],y=["FULL","compact","lite"],w=["none","title","full"];return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{value:n.date_style,onChange:b=>i({...n,date_style:b.target.value}),placeholder:": m-d H:i:s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"m=, d=, H=, i=, s="})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:n.log_level_style,onValueChange:b=>i({...n,log_level_style:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:y.map(b=>e.jsx(X,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:n.color_text,onValueChange:b=>i({...n,color_text:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:w.map(b=>e.jsx(X,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:n.log_level,onValueChange:b=>i({...n,log_level:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(X,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:n.console_log_level,onValueChange:b=>i({...n,console_log_level:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(X,{value:b,children:b},b))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:n.file_log_level,onValueChange:b=>i({...n,file_log_level:b}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(X,{value:b,children:b},b))})]})]})]})]}),e.jsxs("div",{children:[e.jsx(E,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:c,onChange:b=>u(b.target.value),placeholder:"",className:"flex-1",onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",className:"flex-shrink-0",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.suppress_libraries.map(b=>e.jsxs("div",{className:"flex items-center gap-1 bg-secondary px-3 py-1 rounded-md",children:[e.jsx("span",{className:"text-sm",children:b}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>p(b),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},b))})]}),e.jsxs("div",{children:[e.jsx(E,{className:"mb-2 block",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:c,onChange:b=>u(b.target.value),placeholder:"",className:"flex-1"}),e.jsxs(Ie,{value:x,onValueChange:h,children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsx(Be,{children:v.map(b=>e.jsx(X,{value:b,children:b},b))})]}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(n.library_log_levels).map(([b,R])=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-medium",children:b}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:R}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(b),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]})]},b))})]})]})}),S2=As.memo(function({config:n,onChange:i}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_prompt,onCheckedChange:c=>i({...n,show_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_replyer_prompt,onCheckedChange:c=>i({...n,show_replyer_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_replyer_reasoning,onCheckedChange:c=>i({...n,show_replyer_reasoning:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:" Jargon Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_jargon_prompt,onCheckedChange:c=>i({...n,show_jargon_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:" Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.show_memory_prompt,onCheckedChange:c=>i({...n,show_memory_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:" Planner Prompt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" Planner "})]}),e.jsx(Fe,{checked:n.show_planner_prompt,onCheckedChange:c=>i({...n,show_planner_prompt:c})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:" LPMM "}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" LPMM "})]}),e.jsx(Fe,{checked:n.show_lpmm_paragraph,onCheckedChange:c=>i({...n,show_lpmm_paragraph:c})})]})]})]})}),k2=As.memo(function({config:n,onChange:i}){const[c,u]=d.useState(""),[x,h]=d.useState(""),f=()=>{c&&!n.auth_token.includes(c)&&(i({...n,auth_token:[...n.auth_token,c]}),u(""))},p=v=>{i({...n,auth_token:n.auth_token.filter((y,w)=>w!==v)})},g=()=>{x&&!n.api_server_allowed_api_keys.includes(x)&&(i({...n,api_server_allowed_api_keys:[...n.api_server_allowed_api_keys,x]}),h(""))},N=v=>{i({...n,api_server_allowed_api_keys:n.api_server_allowed_api_keys.filter((y,w)=>w!==v)})};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:" API "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:" API "}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:c,onChange:v=>u(v.target.value),placeholder:"",onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),f())}}),e.jsx(_,{onClick:f,size:"sm",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:n.auth_token.map((v,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:v}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>p(y),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:" API Server "}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:" API Server"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:" API Server"})]}),e.jsx(Fe,{checked:n.enable_api_server,onCheckedChange:v=>i({...n,enable_api_server:v})})]}),n.enable_api_server&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{value:n.api_server_host,onChange:v=>i({...n,api_server_host:v.target.value}),placeholder:"0.0.0.0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",value:n.api_server_port,onChange:v=>i({...n,api_server_port:parseInt(v.target.value)}),placeholder:"8090"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.api_server_use_wss,onCheckedChange:v=>i({...n,api_server_use_wss:v})}),e.jsx(E,{children:" WSS "})]}),n.api_server_use_wss&&e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:"SSL "}),e.jsx(le,{value:n.api_server_cert_file,onChange:v=>i({...n,api_server_cert_file:v.target.value}),placeholder:"cert.pem"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:"SSL "}),e.jsx(le,{value:n.api_server_key_file,onChange:v=>i({...n,api_server_key_file:v.target.value}),placeholder:"key.pem"})]})]}),e.jsxs("div",{children:[e.jsx(E,{className:"mb-2 block",children:" API Key "}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(le,{value:x,onChange:v=>h(v.target.value),placeholder:" API Key",onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),g())}}),e.jsx(_,{onClick:g,size:"sm",children:e.jsx(et,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]}),e.jsx("div",{className:"space-y-2",children:n.api_server_allowed_api_keys.map((v,y)=>e.jsxs("div",{className:"flex items-center justify-between bg-secondary px-3 py-2 rounded-md",children:[e.jsx("span",{className:"text-sm font-mono",children:v}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>N(y),children:e.jsx(ls,{className:"h-3 w-3",strokeWidth:2,fill:"none"})})]},y))})]})]})]})]})]})}),C2=As.memo(function({config:n,onChange:i}){return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{checked:n.enable,onCheckedChange:c=>i({...n,enable:c})})]})]})}),T2=As.memo(function({emojiConfig:n,memoryConfig:i,toolConfig:c,voiceConfig:u,onEmojiChange:x,onMemoryChange:h,onToolChange:f,onVoiceChange:p}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_tool",checked:c.enable_tool,onCheckedChange:g=>f({...c,enable_tool:g})}),e.jsx(E,{htmlFor:"enable_tool",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(Fe,{id:"enable_asr",checked:u.enable_asr,onCheckedChange:g=>p({...u,enable_asr:g})}),e.jsx(E,{htmlFor:"enable_asr",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"max_agent_iterations",children:""}),e.jsx(le,{id:"max_agent_iterations",type:"number",min:"1",value:i.max_agent_iterations,onChange:g=>h({...i,max_agent_iterations:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"agent_timeout_seconds",children:""}),e.jsx(le,{id:"agent_timeout_seconds",type:"number",min:"1",step:"0.1",value:i.agent_timeout_seconds??120,onChange:g=>h({...i,agent_timeout_seconds:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_jargon_detection",checked:i.enable_jargon_detection??!0,onCheckedChange:g=>h({...i,enable_jargon_detection:g})}),e.jsx(E,{htmlFor:"enable_jargon_detection",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"global_memory",checked:i.global_memory??!1,onCheckedChange:g=>h({...i,global_memory:g})}),e.jsx(E,{htmlFor:"global_memory",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"emoji_chance",children:""}),e.jsx(le,{id:"emoji_chance",type:"number",step:"0.1",min:"0",max:"1",value:n.emoji_chance,onChange:g=>x({...n,emoji_chance:parseFloat(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" 0-1"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"max_reg_num",children:""}),e.jsx(le,{id:"max_reg_num",type:"number",min:"1",value:n.max_reg_num,onChange:g=>x({...n,max_reg_num:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"check_interval",children:""}),e.jsx(le,{id:"check_interval",type:"number",min:"1",value:n.check_interval,onChange:g=>x({...n,check_interval:parseInt(g.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"do_replace",checked:n.do_replace,onCheckedChange:g=>x({...n,do_replace:g})}),e.jsx(E,{htmlFor:"do_replace",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"steal_emoji",checked:n.steal_emoji,onCheckedChange:g=>x({...n,steal_emoji:g})}),e.jsx(E,{htmlFor:"steal_emoji",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"content_filtration",checked:n.content_filtration,onCheckedChange:g=>x({...n,content_filtration:g})}),e.jsx(E,{htmlFor:"content_filtration",className:"cursor-pointer",children:""})]}),n.content_filtration&&e.jsxs("div",{className:"grid gap-2 pl-6 border-l-2 border-primary/20",children:[e.jsx(E,{htmlFor:"filtration_prompt",children:""}),e.jsx(le,{id:"filtration_prompt",value:n.filtration_prompt,onChange:g=>x({...n,filtration_prompt:g.target.value}),placeholder:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})})]})}),E2=As.memo(function({member:n,groupIndex:i,memberIndex:c,availableChatIds:u,onUpdate:x,onRemove:h}){const f=u.includes(n)||n==="*",[p,g]=d.useState(!f);return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 flex gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx(le,{value:n,onChange:N=>x(i,c,N.target.value),placeholder:' "*"  "qq:123456:group"',className:"flex-1"}),u.length>0&&e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!1),title:"",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{value:n,onValueChange:N=>x(i,c,N),children:[e.jsx($e,{className:"flex-1",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"*",children:"* ()"}),u.map((N,v)=>e.jsx(X,{value:N,children:N},v))]})]}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>g(!0),title:"",children:""})]})}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',n||"()",'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>h(i,c),children:""})]})]})]})]})}),M2=As.memo(function({config:n,onChange:i}){const c=()=>{i({...n,learning_list:[...n.learning_list,["","enable","enable","1.0"]]})},u=y=>{i({...n,learning_list:n.learning_list.filter((w,b)=>b!==y)})},x=(y,w,b)=>{const R=[...n.learning_list];R[y][w]=b,i({...n,learning_list:R})},h=({rule:y})=>{const w=`["${y[0]}", "${y[1]}", "${y[2]}", "${y[3]}"]`;return e.jsxs(ol,{children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Wa,{className:"w-80 sm:w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:w}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},f=()=>{i({...n,expression_groups:[...n.expression_groups,[]]})},p=y=>{i({...n,expression_groups:n.expression_groups.filter((w,b)=>b!==y)})},g=y=>{const w=[...n.expression_groups];w[y]=[...w[y],""],i({...n,expression_groups:w})},N=(y,w)=>{const b=[...n.expression_groups];b[y]=b[y].filter((R,D)=>D!==w),i({...n,expression_groups:b})},v=(y,w,b)=>{const R=[...n.expression_groups];R[y][w]=b,i({...n,expression_groups:R})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"all_global_jargon",checked:n.all_global_jargon??!1,onCheckedChange:y=>i({...n,all_global_jargon:y})}),e.jsx(E,{htmlFor:"all_global_jargon",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_jargon_explanation",checked:n.enable_jargon_explanation??!0,onCheckedChange:y=>i({...n,enable_jargon_explanation:y})}),e.jsx(E,{htmlFor:"enable_jargon_explanation",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"LLM"})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"jargon_mode",children:""}),e.jsxs(Ie,{value:n.jargon_mode??"context",onValueChange:y=>i({...n,jargon_mode:y}),children:[e.jsx($e,{id:"jargon_mode",className:"mt-2",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"context",children:""}),e.jsx(X,{value:"planner",children:"Plannerunknown_words"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["",e.jsx("br",{}),"PlannerPlannerreplyunknown_words"]})]})]}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:c,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[n.learning_list.map((y,w)=>{const b=n.learning_list.some((T,A)=>A!==w&&T[0]===""),R=y[0]==="",D=y[0].split(":"),S=D[0]||"qq",P=D[1]||"",M=D[2]||"group";return e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",w+1," ",R&&""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{rule:y}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",w+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>u(w),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:R?"global":"specific",onValueChange:T=>{T==="global"?x(w,0,""):x(w,0,"qq::group")},disabled:b&&!R,children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"global",children:""}),e.jsx(X,{value:"specific",disabled:b&&!R,children:""})]})]}),b&&!R&&e.jsx("p",{className:"text-xs text-amber-600",children:""})]}),!R&&e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:S,onValueChange:T=>{x(w,0,`${T}:${P}:${M}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"qq",children:"QQ"}),e.jsx(X,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:" ID"}),e.jsx(le,{value:P,onChange:T=>{x(w,0,`${S}:${T.target.value}:${M}`)},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:M,onValueChange:T=>{x(w,0,`${S}:${P}:${T}`)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"group",children:"group"}),e.jsx(X,{value:"private",children:"private"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",y[0]||""]})]}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Fe,{checked:y[1]==="enable",onCheckedChange:T=>x(w,1,T?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Fe,{checked:y[2]==="enable",onCheckedChange:T=>x(w,2,T?"enable":"disable")})]})}),e.jsx("div",{className:"grid gap-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Fe,{checked:y[3]==="true"||y[3]==="enable",onCheckedChange:T=>x(w,3,T?"true":"false")})]})})]})]},w)}),n.learning_list.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"expression_self_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"expression_self_reflect",checked:n.expression_self_reflect??!1,onCheckedChange:y=>i({...n,expression_self_reflect:y})})]}),n.expression_self_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"expression_auto_check_interval",children:""}),e.jsx(le,{id:"expression_auto_check_interval",type:"number",min:"60",value:n.expression_auto_check_interval??3600,onChange:y=>i({...n,expression_auto_check_interval:parseInt(y.target.value)||3600})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"36001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"expression_auto_check_count",children:""}),e.jsx(le,{id:"expression_auto_check_count",type:"number",min:"1",max:"100",value:n.expression_auto_check_count??10,onChange:y=>i({...n,expression_auto_check_count:parseInt(y.target.value)||10})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"10"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:""}),e.jsxs(_,{onClick:()=>{i({...n,expression_auto_check_custom_criteria:[...n.expression_auto_check_custom_criteria||[],""]})},size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(n.expression_auto_check_custom_criteria||[]).map((y,w)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:y,onChange:b=>{const R=[...n.expression_auto_check_custom_criteria||[]];R[w]=b.target.value,i({...n,expression_auto_check_custom_criteria:R})},placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>{i({...n,expression_auto_check_custom_criteria:(n.expression_auto_check_custom_criteria||[]).filter((b,R)=>R!==w)})},size:"icon",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})]},w)),(!n.expression_auto_check_custom_criteria||n.expression_auto_check_custom_criteria.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:'""'})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"expression_checked_only",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"expression_checked_only",checked:n.expression_checked_only??!1,onCheckedChange:y=>i({...n,expression_checked_only:y})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{htmlFor:"expression_manual_reflect",className:"cursor-pointer font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"expression_manual_reflect",checked:n.expression_manual_reflect??!1,onCheckedChange:y=>i({...n,expression_manual_reflect:y})})]}),n.expression_manual_reflect&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-sm font-medium",children:""})}),e.jsx("div",{className:"space-y-4",children:(()=>{const w=(n.manual_reflect_operator_id||"").split(":"),b=w[0]||"qq",R=w[1]||"",D=w[2]||"private";return e.jsxs("div",{className:"grid gap-4 p-3 sm:p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:b,onValueChange:S=>{i({...n,manual_reflect_operator_id:`${S}:${R}:${D}`})},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"qq",children:"QQ"}),e.jsx(X,{value:"wx",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:"/ ID"}),e.jsx(le,{value:R,onChange:S=>{i({...n,manual_reflect_operator_id:`${b}:${S.target.value}:${D}`})},placeholder:" ID",className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(Ie,{value:D,onValueChange:S=>{i({...n,manual_reflect_operator_id:`${b}:${R}:${S}`})},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"private",children:"private"}),e.jsx(X,{value:"group",children:"group"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ID",n.manual_reflect_operator_id||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'IDplatform:id:type ( "qq:123456:private"  "qq:654321:group")'})]})})()})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>{i({...n,allow_reflect:[...n.allow_reflect||[],"qq::group"]})},size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(n.allow_reflect||[]).map((y,w)=>{const b=y.split(":"),R=b[0]||"qq",D=b[1]||"",S=b[2]||"group";return e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-muted/50",children:[e.jsxs(Ie,{value:R,onValueChange:P=>{const M=[...n.allow_reflect];M[w]=`${P}:${D}:${S}`,i({...n,allow_reflect:M})},children:[e.jsx($e,{className:"w-24",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"qq",children:"QQ"}),e.jsx(X,{value:"wx",children:""})]})]}),e.jsx(le,{value:D,onChange:P=>{const M=[...n.allow_reflect];M[w]=`${R}:${P.target.value}:${S}`,i({...n,allow_reflect:M})},placeholder:"ID",className:"flex-1 font-mono text-sm"}),e.jsxs(Ie,{value:S,onValueChange:P=>{const M=[...n.allow_reflect];M[w]=`${R}:${D}:${P}`,i({...n,allow_reflect:M})},children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"group",children:""}),e.jsx(X,{value:"private",children:""})]})]}),e.jsx(_,{onClick:()=>{i({...n,allow_reflect:n.allow_reflect.filter((P,M)=>M!==w)})},size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})]},w)}),(!n.allow_reflect||n.allow_reflect.length===0)&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:""})]})]})]})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:f,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-4",children:[n.expression_groups.map((y,w)=>{const b=n.learning_list.map(R=>R[0]).filter(R=>R!=="");return e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",w+1,y.length===1&&y[0]==="*"&&""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:()=>g(w),size:"sm",variant:"outline",children:e.jsx(et,{className:"h-4 w-4"})}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",w+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>p(w),children:""})]})]})]})]})]}),e.jsx("div",{className:"space-y-2",children:y.map((R,D)=>e.jsx(E2,{member:R,groupIndex:w,memberIndex:D,availableChatIds:b,onUpdate:v,onRemove:N},`${w}-${D}`))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' "*" '})]},w)}),n.expression_groups.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})})]})});function z2({regex:l,reaction:n,onRegexChange:i,onReactionChange:c}){const[u,x]=d.useState(!1),[h,f]=d.useState(""),[p,g]=d.useState(null),[N,v]=d.useState(""),[y,w]=d.useState({}),[b,R]=d.useState(""),D=d.useRef(null),[S,P]=d.useState("build"),M=L=>L.replace(/\(\?P<([^>]+)>/g,"(?<$1>"),T=(L,J=0)=>{const U=D.current;if(!U)return;const ue=U.selectionStart||0,xe=U.selectionEnd||0,he=l.substring(0,ue)+L+l.substring(xe);i(he),setTimeout(()=>{const ne=ue+L.length+J;U.setSelectionRange(ne,ne),U.focus()},0)};d.useEffect(()=>{if(!l||!h){p!==null&&g(null),Object.keys(y).length>0&&w({}),b!==n&&R(n),N!==""&&v("");return}try{const L=M(l),J=new RegExp(L,"g"),U=h.match(J);g(U),v("");const xe=new RegExp(L).exec(h);if(xe&&xe.groups){w(xe.groups);let he=n;Object.entries(xe.groups).forEach(([ne,ve])=>{he=he.replace(new RegExp(`\\[${ne}\\]`,"g"),ve||"")}),R(he)}else w({}),R(n)}catch(L){v(L.message),g(null),w({}),R(n)}},[l,h,n,p,y,b,N]);const A=()=>{if(!h||!p||p.length===0)return e.jsx("span",{className:"text-muted-foreground",children:h||""});try{const L=M(l),J=new RegExp(L,"g");let U=0;const ue=[];let xe;for(;(xe=J.exec(h))!==null;)xe.index>U&&ue.push(e.jsx("span",{children:h.substring(U,xe.index)},`text-${U}`)),ue.push(e.jsx("span",{className:"bg-yellow-200 dark:bg-yellow-900 font-semibold",children:xe[0]},`match-${xe.index}`)),U=xe.index+xe[0].length;return U<h.length&&ue.push(e.jsx("span",{children:h.substring(U)},`text-${U}`)),e.jsx(e.Fragment,{children:ue})}catch{return e.jsx("span",{children:h})}},F=[{category:"",items:[{label:"",pattern:".",desc:""},{label:"",pattern:"\\d",desc:" 0-9"},{label:"",pattern:"\\D",desc:""},{label:"",pattern:"\\w",desc:""},{label:"",pattern:"\\W",desc:""},{label:"",pattern:"\\s",desc:""},{label:"",pattern:"\\S",desc:""}]},{category:"",items:[{label:"",pattern:"^",desc:""},{label:"",pattern:"$",desc:""},{label:"",pattern:"\\b",desc:""}]},{category:"",items:[{label:"0",pattern:"*",desc:"0"},{label:"1",pattern:"+",desc:"1"},{label:"01",pattern:"?",desc:"01"},{label:"",pattern:"{n}",desc:"nn"},{label:"",pattern:"{m,n}",desc:"mn"}]},{category:"",items:[{label:"",pattern:"()",desc:"",moveCursor:-1},{label:"",pattern:"(?P<name>)",desc:"Python",moveCursor:-1},{label:"",pattern:"(?:)",desc:"",moveCursor:-1}]},{category:"",items:[{label:"",pattern:"[]",desc:"",moveCursor:-1},{label:"",pattern:"[^]",desc:"",moveCursor:-1},{label:"",pattern:"[a-z]",desc:"az"},{label:"",pattern:"[\\u4e00-\\u9fa5]",desc:""}]},{category:"",items:[{label:"",pattern:"(?P<word>\\S+)",desc:""},{label:"",pattern:"(?P<sentence>.+)",desc:""},{label:"",pattern:"(?P<num>\\d+)",desc:""},{label:"",pattern:"(?:1|2)",desc:""}]}];return e.jsxs(Is,{open:u,onOpenChange:x,children:[e.jsx(Wo,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(Qm,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Os,{className:"max-w-[95vw] sm:max-w-[900px] max-h-[90vh]",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{className:"text-sm",children:""})]}),e.jsx(Ye,{className:"max-h-[calc(90vh-120px)]",children:e.jsxs(ta,{value:S,onValueChange:L=>P(L),className:"w-full",children:[e.jsxs(Xt,{className:"grid w-full grid-cols-2",children:[e.jsx(Je,{value:"build",children:" "}),e.jsx(Je,{value:"test",children:" "})]}),e.jsxs(ys,{value:"build",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsx(le,{ref:D,value:l,onChange:L=>i(L.target.value),className:"font-mono text-sm",placeholder:"..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(ot,{value:n,onChange:L=>c(L.target.value),placeholder:" [] ...",rows:3,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[F.map(L=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:L.category}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:L.items.map(J=>e.jsx(_,{variant:"outline",size:"sm",className:"justify-start h-auto py-2 px-3",onClick:()=>T(J.pattern,J.moveCursor||0),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("span",{className:"text-xs font-medium",children:J.label}),e.jsx("code",{className:"ml-auto text-xs bg-muted px-1.5 py-0.5 rounded font-mono",children:J.pattern})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:J.desc})]})},J.label))})]},L.category)),e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx("h5",{className:"text-xs font-semibold text-primary",children:""}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>i("^(?P<n>\\S{1,20})$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsxs("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:["^(?P<n>\\S","{1,20}",")$"]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>i("(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?:[^.\\s]+\\s*)?(?:)?[]\\s*(?P<action>.+?)[.,]?$"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full justify-start h-auto py-2 px-3",onClick:()=>i("(?P<subject>.+?)(?:||)"),children:e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("code",{className:"text-xs font-mono bg-muted px-2 py-1 rounded w-full overflow-x-auto",children:"(?P<subject>.+?)(?:||)"}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:""})]})})]})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsxs("li",{children:["",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"(?P<>)"})]}),e.jsxs("li",{children:[" reaction  ",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-900 px-1 rounded",children:"[]"})," "]}),e.jsx("li",{children:""})]})]})]}),e.jsxs(ys,{value:"test",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"rounded-md bg-muted p-3 font-mono text-xs break-all",children:l||"()"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"test-text",className:"text-sm font-medium",children:""}),e.jsx(ot,{id:"test-text",value:h,onChange:L=>f(L.target.value),placeholder:`...
`,className:"min-h-[100px] text-sm"})]}),N&&e.jsxs("div",{className:"rounded-md bg-destructive/10 border border-destructive/20 p-3",children:[e.jsx("p",{className:"text-sm text-destructive font-medium",children:""}),e.jsx("p",{className:"text-xs text-destructive/80 mt-1",children:N})]}),!N&&h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:p&&p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[" (",p.length," )"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:""})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsx(Ye,{className:"h-40 rounded-md bg-muted p-3",children:e.jsx("div",{className:"text-sm break-words",children:A()})})]}),Object.keys(y).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsx(Ye,{className:"h-32 rounded-md border p-3",children:e.jsx("div",{className:"space-y-2",children:Object.entries(y).map(([L,J])=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsxs("span",{className:"font-mono font-semibold text-primary min-w-[80px]",children:["[",L,"]"]}),e.jsx("span",{className:"text-muted-foreground",children:"="}),e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded",children:J})]},L))})})]}),Object.keys(y).length>0&&n&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm font-medium",children:"Reaction "}),e.jsx(Ye,{className:"h-48 rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3",children:e.jsx("div",{className:"text-sm break-words",children:b})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"reaction  [name] "})]})]}),e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 p-3 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:" "}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:"Reaction "}),e.jsx("li",{children:""})]})]})]})]})})]})]})}const A2=As.memo(function({keywordReactionConfig:n,responsePostProcessConfig:i,chineseTypoConfig:c,responseSplitterConfig:u,onKeywordReactionChange:x,onResponsePostProcessChange:h,onChineseTypoChange:f,onResponseSplitterChange:p}){const g=()=>{x({...n,regex_rules:[...n.regex_rules,{regex:[""],reaction:""}]})},N=T=>{x({...n,regex_rules:n.regex_rules.filter((A,F)=>F!==T)})},v=(T,A,F)=>{const L=[...n.regex_rules];A==="regex"&&typeof F=="string"?L[T]={...L[T],regex:[F]}:A==="reaction"&&typeof F=="string"&&(L[T]={...L[T],reaction:F}),x({...n,regex_rules:L})},y=()=>{x({...n,keyword_rules:[...n.keyword_rules,{keywords:[],reaction:""}]})},w=T=>{x({...n,keyword_rules:n.keyword_rules.filter((A,F)=>F!==T)})},b=(T,A,F)=>{const L=[...n.keyword_rules];typeof F=="string"&&(L[T]={...L[T],reaction:F}),x({...n,keyword_rules:L})},R=T=>{const A=[...n.keyword_rules];A[T]={...A[T],keywords:[...A[T].keywords||[],""]},x({...n,keyword_rules:A})},D=(T,A)=>{const F=[...n.keyword_rules];F[T]={...F[T],keywords:(F[T].keywords||[]).filter((L,J)=>J!==A)},x({...n,keyword_rules:F})},S=(T,A,F)=>{const L=[...n.keyword_rules],J=[...L[T].keywords||[]];J[A]=F,L[T]={...L[T],keywords:J},x({...n,keyword_rules:L})},P=({rule:T})=>{const A=`{ regex = [${(T.regex||[]).map(F=>`"${F}"`).join(", ")}], reaction = "${T.reaction}" }`;return e.jsxs(ol,{children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Wa,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Ye,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs break-all",children:A})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})},M=({rule:T})=>{const A=`[[keyword_reaction.keyword_rules]]
keywords = [${(T.keywords||[]).map(F=>`"${F}"`).join(", ")}]
reaction = "${T.reaction}"`;return e.jsxs(ol,{children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]})}),e.jsx(Wa,{className:"w-[95vw] sm:w-[500px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:""}),e.jsx(Ye,{className:"h-60 rounded-md bg-muted p-3",children:e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-all",children:A})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" bot_config.toml "})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:g,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[n.regex_rules.map((T,A)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",A+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z2,{regex:T.regex&&T.regex[0]||"",reaction:T.reaction,onRegexChange:F=>v(A,"regex",F),onReactionChange:F=>v(A,"reaction",F)}),e.jsx(P,{rule:T}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",A+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>N(A),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:"Python "}),e.jsx(le,{value:T.regex&&T.regex[0]||"",onChange:F=>v(A,"regex",F.target.value),placeholder:"^(?P<n>\\\\S{1,20})$ ",className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:' (?P<name>pattern) reaction  [name] ""'})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsx(ot,{value:T.reaction,onChange:F=>v(A,"reaction",F.target.value),placeholder:`...
 [] `,rows:3,className:"text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" []  [n] "})]})]})]},A)),n.regex_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:y,size:"sm",variant:"outline",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-3",children:[n.keyword_rules.map((T,A)=>e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[" ",A+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{rule:T}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",A+1," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>w(A),children:""})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsxs(_,{onClick:()=>R(A),size:"sm",variant:"ghost",children:[e.jsx(et,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{className:"space-y-2",children:[(T.keywords||[]).map((F,L)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{value:F,onChange:J=>S(A,L,J.target.value),placeholder:"",className:"flex-1"}),e.jsx(_,{onClick:()=>D(A,L),size:"sm",variant:"ghost",children:e.jsx(ls,{className:"h-4 w-4"})})]},L)),(!T.keywords||T.keywords.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-2",children:'""'})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-xs font-medium",children:""}),e.jsx(ot,{value:T.reaction,onChange:F=>b(A,"reaction",F.target.value),placeholder:"...",rows:3,className:"text-sm"})]})]})]},A)),n.keyword_rules.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'""'})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_response_post_process",checked:i.enable_response_post_process,onCheckedChange:T=>h({...i,enable_response_post_process:T})}),e.jsx(E,{htmlFor:"enable_response_post_process",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:""})]}),i.enable_response_post_process&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Fe,{id:"enable_chinese_typo",checked:c.enable,onCheckedChange:T=>f({...c,enable:T})}),e.jsx(E,{htmlFor:"enable_chinese_typo",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),c.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"error_rate",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"error_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.error_rate,onChange:T=>f({...c,error_rate:parseFloat(T.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"min_freq",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"min_freq",type:"number",min:"0",value:c.min_freq,onChange:T=>f({...c,min_freq:parseInt(T.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"tone_error_rate",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"tone_error_rate",type:"number",step:"0.01",min:"0",max:"1",value:c.tone_error_rate,onChange:T=>f({...c,tone_error_rate:parseFloat(T.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"word_replace_rate",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"word_replace_rate",type:"number",step:"0.001",min:"0",max:"1",value:c.word_replace_rate,onChange:T=>f({...c,word_replace_rate:parseFloat(T.target.value)})})]})]})]})}),e.jsx("div",{className:"border-t pt-6 space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Fe,{id:"enable_response_splitter",checked:u.enable,onCheckedChange:T=>p({...u,enable:T})}),e.jsx(E,{htmlFor:"enable_response_splitter",className:"cursor-pointer font-semibold",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),u.enable&&e.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-primary/20",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"max_length",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"max_length",type:"number",min:"1",value:u.max_length,onChange:T=>p({...u,max_length:parseInt(T.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"max_sentence_num",className:"text-xs font-medium",children:""}),e.jsx(le,{id:"max_sentence_num",type:"number",min:"1",value:u.max_sentence_num,onChange:T=>p({...u,max_sentence_num:parseInt(T.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_kaomoji_protection",checked:u.enable_kaomoji_protection,onCheckedChange:T=>p({...u,enable_kaomoji_protection:T})}),e.jsx(E,{htmlFor:"enable_kaomoji_protection",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"enable_overflow_return_all",checked:u.enable_overflow_return_all,onCheckedChange:T=>p({...u,enable_overflow_return_all:T})}),e.jsx(E,{htmlFor:"enable_overflow_return_all",className:"cursor-pointer",children:""})]}),e.jsx("p",{className:"text-xs text-muted-foreground -mt-2",children:""})]})]})})]})]})]})}),O2=As.memo(function({config:n,onChange:i}){const[c,u]=d.useState(""),[x,h]=d.useState(""),[f,p]=d.useState(!1),g=n.allowed_ips?n.allowed_ips.split(",").map(S=>S.trim()).filter(S=>S):[],N=n.trusted_proxies?n.trusted_proxies.split(",").map(S=>S.trim()).filter(S=>S):[],v=()=>{if(!c.trim())return;const S=[...g,c.trim()];i({...n,allowed_ips:S.join(",")}),u("")},y=S=>{const P=g.filter((M,T)=>T!==S);i({...n,allowed_ips:P.join(",")})},w=()=>{if(!x.trim())return;const S=[...N,x.trim()];i({...n,trusted_proxies:S.join(",")}),h("")},b=S=>{const P=N.filter((M,T)=>T!==S);i({...n,trusted_proxies:P.join(",")})},R=S=>{!S&&n.enabled?p(!0):i({...n,enabled:S})},D=()=>{i({...n,enabled:!1}),p(!1)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"WebUI "}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.enabled,onCheckedChange:R}),e.jsx(E,{className:"cursor-pointer",children:" WebUI"})]}),n.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:n.mode,onValueChange:S=>i({...n,mode:S}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"development",children:""}),e.jsx(X,{value:"production",children:""})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:": WebUI  .env  WEBUI_HOST  WEBUI_PORT"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:n.anti_crawler_mode,onValueChange:S=>i({...n,anti_crawler_mode:S}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"false",children:""}),e.jsx(X,{value:"basic",children:""}),e.jsx(X,{value:"loose",children:""}),e.jsx(X,{value:"strict",children:""})]})]})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(E,{children:"IP "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:c,onChange:S=>u(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),v())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:v,disabled:!c.trim(),children:e.jsx(et,{className:"h-4 w-4"})})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:g.map((S,P)=>e.jsxs(Se,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>y(P),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Ea,{className:"h-3 w-3"})})]},P))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPCIDR127.0.0.1192.168.1.0/24"})]}),e.jsxs("div",{className:"grid gap-2 sm:col-span-2",children:[e.jsx(E,{children:" IP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:x,onChange:S=>h(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),w())},placeholder:"IP"}),e.jsx(_,{type:"button",size:"sm",onClick:w,disabled:!x.trim(),children:e.jsx(et,{className:"h-4 w-4"})})]}),N.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:N.map((S,P)=>e.jsxs(Se,{variant:"secondary",className:"flex items-center gap-1",children:[S,e.jsx("button",{type:"button",onClick:()=>b(P),className:"ml-1 hover:bg-destructive/20 rounded-full p-0.5",children:e.jsx(Ea,{className:"h-3 w-3"})})]},P))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IPX-Forwarded-For"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.trust_xff,onCheckedChange:S=>i({...n,trust_xff:S})}),e.jsx(E,{className:"cursor-pointer",children:" X-Forwarded-For "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{checked:n.secure_cookie,onCheckedChange:S=>i({...n,secure_cookie:S})}),e.jsx(E,{className:"cursor-pointer",children:" Cookie HTTPS"})]})]})]}),e.jsx(vs,{open:f,onOpenChange:p,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:" WebUI"}),e.jsxs(hs,{children:[" WebUI WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI ",e.jsx("br",{}),e.jsx("br",{})," WebUI "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{variant:"destructive",onClick:D,children:""})]})]})})]})}),Nn="/api/webui/config";async function bg(){const n=await(await we(`${Nn}/bot`)).json();if(!n.success)throw new Error("");return n.config}async function un(){const n=await(await we(`${Nn}/model`)).json();if(!n.success)throw new Error("");return n.config}async function yg(l){const i=await(await we(`${Nn}/bot`,{method:"POST",body:JSON.stringify(l)})).json();if(!i.success)throw new Error(i.message||"")}async function D2(){const n=await(await we(`${Nn}/bot/raw`)).json();if(!n.success)throw new Error("");return n.content}async function R2(l){const i=await(await we(`${Nn}/bot/raw`,{method:"POST",body:JSON.stringify({raw_content:l})})).json();if(!i.success)throw new Error(i.message||"")}async function Ji(l){const i=await(await we(`${Nn}/model`,{method:"POST",body:JSON.stringify(l)})).json();if(!i.success)throw new Error(i.message||"")}async function L2(l,n){const c=await(await we(`${Nn}/bot/section/${l}`,{method:"POST",body:JSON.stringify(n)})).json();if(!c.success)throw new Error(c.message||` ${l} `)}async function Bm(l,n){const c=await(await we(`${Nn}/model/section/${l}`,{method:"POST",body:JSON.stringify(n)})).json();if(!c.success)throw new Error(c.message||` ${l} `)}async function U2(l,n="openai",i="/models"){const c=new URLSearchParams({provider_name:l,parser:n,endpoint:i}),u=await we(`/api/webui/models/list?${c}`);if(!u.ok){const h=await u.json().catch(()=>({}));throw new Error(h.detail||` (${u.status})`)}const x=await u.json();if(!x.success)throw new Error("");return x.models}async function $2(l){const n=new URLSearchParams({provider_name:l}),i=await we(`/api/webui/models/test-connection-by-name?${n}`,{method:"POST"});if(!i.ok){const c=await i.json().catch(()=>({}));throw new Error(c.detail||` (${i.status})`)}return await i.json()}const B2=Kr("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),at=d.forwardRef(({className:l,variant:n,...i},c)=>e.jsx("div",{ref:c,role:"alert",className:I(B2({variant:n}),l),...i}));at.displayName="Alert";const Hn=d.forwardRef(({className:l,...n},i)=>e.jsx("h5",{ref:i,className:I("mb-1 font-medium leading-none tracking-tight",l),...n}));Hn.displayName="AlertTitle";const lt=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{ref:i,className:I("text-sm [&_p]:leading-relaxed",l),...n}));lt.displayName="AlertDescription";const I2={name:"toml",startState:function(){return{inString:!1,stringType:"",lhs:!0,inArray:0}},token:function(l,n){let i;if(!n.inString&&(i=l.match(/^('''|"""|'|")/))&&(n.stringType=i[0],n.inString=!0),l.sol()&&!n.inString&&n.inArray===0&&(n.lhs=!0),n.inString){for(;n.inString;)if(l.match(n.stringType))n.inString=!1;else if(l.peek()==="\\")l.next(),l.next();else{if(l.eol())break;l.match(/^.[^\\\"\']*/)}return n.lhs?"property":"string"}else{if(n.inArray&&l.peek()==="]")return l.next(),n.inArray--,"bracket";if(n.lhs&&l.peek()==="["&&l.skipTo("]"))return l.next(),l.peek()==="]"&&l.next(),"atom";if(l.peek()==="#")return l.skipToEnd(),"comment";if(l.eatSpace())return null;if(n.lhs&&l.eatWhile(function(c){return c!="="&&c!=" "}))return"property";if(n.lhs&&l.peek()==="=")return l.next(),n.lhs=!1,null;if(!n.lhs&&l.match(/^\d\d\d\d[\d\-\:\.T]*Z/))return"atom";if(!n.lhs&&(l.match("true")||l.match("false")))return"atom";if(!n.lhs&&l.peek()==="[")return n.inArray++,l.next(),"bracket";if(!n.lhs&&l.match(/^\-?\d+(?:\.\d+)?/))return"number";l.eatSpace()||l.next()}return null},languageData:{commentTokens:{line:"#"}}},P2={python:[C_()],json:[T_(),E_()],toml:[k_.define(I2)],text:[]};function gv({value:l,onChange:n,language:i="text",readOnly:c=!1,height:u="400px",minHeight:x,maxHeight:h,placeholder:f,theme:p="dark",className:g=""}){const[N,v]=d.useState(!1);if(d.useEffect(()=>{v(!0)},[]),!N)return e.jsx("div",{className:`rounded-md border bg-muted animate-pulse ${g}`,style:{height:u,minHeight:x,maxHeight:h}});const y=[...P2[i]||[],dg.lineWrapping];return c&&y.push(dg.editable.of(!1)),e.jsx("div",{className:`rounded-md overflow-hidden border ${g}`,children:e.jsx(M_,{value:l,height:u,minHeight:x,maxHeight:h,theme:p==="dark"?z_:void 0,extensions:y,onChange:n,placeholder:f,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightSpecialChars:!0,history:!0,foldGutter:!0,drawSelection:!0,dropCursor:!0,allowMultipleSelections:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!0,rectangularSelection:!0,crosshairCursor:!0,highlightActiveLine:!0,highlightSelectionMatches:!0,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:!0,historyKeymap:!0,foldKeymap:!0,completionKeymap:!0,lintKeymap:!0}})})}function H2({id:l,index:n,itemType:i,itemFields:c,value:u,onChange:x,onRemove:h,disabled:f,canRemove:p,placeholder:g}){const{attributes:N,listeners:v,setNodeRef:y,transform:w,transition:b,isDragging:R}=Wj({id:l,disabled:f}),D={transform:ev.Transform.toString(w),transition:b};return e.jsxs("div",{ref:y,style:D,className:I("flex items-start gap-2 group",R&&"opacity-50 z-50"),children:[e.jsx("button",{type:"button",className:I("flex-shrink-0 p-2 cursor-grab active:cursor-grabbing","text-muted-foreground hover:text-foreground transition-colors","opacity-0 group-hover:opacity-100 focus:opacity-100",f&&"cursor-not-allowed opacity-30"),...N,...v,children:e.jsx(Rj,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1 min-w-0",children:i==="object"&&c?e.jsx(F2,{value:u,onChange:x,fields:c,disabled:f}):i==="number"?e.jsx(le,{type:"number",value:u??"",onChange:S=>x(parseFloat(S.target.value)||0),placeholder:g??` ${n+1} `,disabled:f,className:"font-mono"}):e.jsx(le,{type:"text",value:u??"",onChange:S=>x(S.target.value),placeholder:g??` ${n+1} `,disabled:f})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",onClick:h,disabled:f||!p,className:I("flex-shrink-0 text-muted-foreground hover:text-destructive","opacity-0 group-hover:opacity-100 focus:opacity-100 transition-opacity"),children:e.jsx(ls,{className:"h-4 w-4"})})]})}function F2({value:l,onChange:n,fields:i,disabled:c}){const u=d.useCallback((h,f)=>{n({...l,[h]:f})},[l,n]),x=(h,f)=>{const p=l?.[h];if(f.type==="boolean"||f.type==="switch")return e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(Fe,{checked:!!(p??f.default),onCheckedChange:g=>u(h,g),disabled:c})]});if(f.type==="slider"||f.type==="number"&&f.min!=null&&f.max!=null){const g=p??f.default??f.min??0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g})]}),e.jsx(qa,{value:[g],onValueChange:N=>u(h,N[0]),min:f.min??0,max:f.max??100,step:f.step??1,disabled:c,className:"py-1"})]})}return f.type==="select"&&f.choices?e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsxs(Ie,{value:String(p??f.default??""),onValueChange:g=>u(h,g),disabled:c,children:[e.jsx($e,{className:"h-8 text-sm",children:e.jsx(Pe,{placeholder:f.placeholder??""})}),e.jsx(Be,{children:f.choices.map(g=>e.jsx(X,{value:String(g),children:String(g)},String(g)))})]})]}):f.type==="number"?e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(le,{type:"number",value:p??f.default??"",onChange:g=>u(h,parseFloat(g.target.value)||0),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:f.label??h}),e.jsx(le,{type:"text",value:p??f.default??"",onChange:g=>u(h,g.target.value),placeholder:f.placeholder,disabled:c,className:"h-8 text-sm"})]})};return e.jsx(Ce,{className:"p-3 space-y-2 bg-muted/30",children:Object.entries(i).map(([h,f])=>e.jsx("div",{children:x(h,f)},h))})}function G2({value:l,onChange:n,itemType:i="string",itemFields:c,minItems:u,maxItems:x,disabled:h,placeholder:f}){const p=d.useMemo(()=>Array.isArray(l)?l:typeof l=="string"&&l.trim()?l.split(",").map(M=>M.trim()):[],[l]),[g]=d.useState(()=>new Map),N=d.useCallback(M=>(g.has(M)||g.set(M,`item-${Date.now()}-${M}-${Math.random().toString(36).slice(2)}`),g.get(M)),[g]),v=d.useMemo(()=>{const M=[];for(let T=0;T<p.length;T++)M.push(N(T));return M},[p.length,N]),y=Vj(Bo(Qj,{activationConstraint:{distance:8}}),Bo(Kj,{coordinateGetter:qj})),w=d.useCallback(M=>{const{active:T,over:A}=M;if(A&&T.id!==A.id){const F=v.indexOf(T.id),L=v.indexOf(A.id),J=Yj(p,F,L);n(J)}},[p,v,n]),b=d.useCallback(()=>{if(x!=null&&p.length>=x)return;let M;i==="object"&&c?M=Object.fromEntries(Object.entries(c).map(([T,A])=>[T,A.default??""])):i==="number"?M=0:M="",n([...p,M])},[p,x,i,c,n]),R=d.useCallback((M,T)=>{const A=[...p];A[M]=T,n(A)},[p,n]),D=d.useCallback(M=>{if(u!=null&&p.length<=u)return;const T=p.filter((A,F)=>F!==M);g.delete(M),n(T)},[p,u,g,n]),S=x==null||p.length<x,P=u==null||p.length>u;return e.jsxs("div",{className:"space-y-2",children:[p.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground py-4 justify-center border border-dashed rounded-md",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx("span",{children:""})]}):e.jsx(Jj,{sensors:y,collisionDetection:Xj,onDragEnd:w,children:e.jsx(Zj,{items:v,strategy:A_,children:e.jsx("div",{className:"space-y-2",children:p.map((M,T)=>e.jsx(H2,{id:v[T],index:T,itemType:i,itemFields:c,value:M,onChange:A=>R(T,A),onRemove:()=>D(T),disabled:h,canRemove:P,placeholder:f},v[T]))})})}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:b,disabled:h||!S,className:"w-full",children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),"",x!==void 0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",p.length,"/",x,")"]})]}),(u!=null||x!=null)&&(u!==null||x!==null)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:u!=null&&x!=null?` ${u} - ${x} `:u!=null?` ${u} `:` ${x} `})]})}function tx({content:l,className:n=""}){return e.jsx("div",{className:`prose prose-sm dark:prose-invert max-w-none ${n}`,children:e.jsx($_,{remarkPlugins:[I_,P_],rehypePlugins:[B_],components:{code({inline:i,className:c,children:u,...x}){return i?e.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded text-sm font-mono",...x,children:u}):e.jsx("code",{className:`${c} block bg-muted p-4 rounded-lg overflow-x-auto`,...x,children:u})},table({children:i,...c}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"border-collapse border border-border",...c,children:i})})},th({children:i,...c}){return e.jsx("th",{className:"border border-border bg-muted px-4 py-2 text-left font-semibold",...c,children:i})},td({children:i,...c}){return e.jsx("td",{className:"border border-border px-4 py-2",...c,children:i})},a({children:i,...c}){return e.jsx("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...c,children:i})},blockquote({children:i,...c}){return e.jsx("blockquote",{className:"border-l-4 border-primary pl-4 italic text-muted-foreground",...c,children:i})},h1({children:i,...c}){return e.jsx("h1",{className:"text-3xl font-bold mt-6 mb-4",...c,children:i})},h2({children:i,...c}){return e.jsx("h2",{className:"text-2xl font-bold mt-5 mb-3",...c,children:i})},h3({children:i,...c}){return e.jsx("h3",{className:"text-xl font-bold mt-4 mb-2",...c,children:i})},h4({children:i,...c}){return e.jsx("h4",{className:"text-lg font-semibold mt-3 mb-2",...c,children:i})},ul({children:i,...c}){return e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",...c,children:i})},ol({children:i,...c}){return e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",...c,children:i})},p({children:i,...c}){return e.jsx("p",{className:"my-2 leading-relaxed",...c,children:i})},hr({...i}){return e.jsx("hr",{className:"my-4 border-border",...i})}},children:l})})}function V2(l,n,i,c={}){const{debounceMs:u=2e3,onSaveSuccess:x,onSaveError:h}=c,f=d.useRef(null),p=d.useCallback(async(y,w)=>{try{n(!0),await L2(y,w),i(!1),x?.()}catch(b){console.error(` ${y} :`,b),i(!0),h?.(b instanceof Error?b:new Error(String(b)))}finally{n(!1)}},[n,i,x,h]),g=d.useCallback((y,w)=>{l||(i(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{p(y,w)},u))},[l,i,p,u]),N=d.useCallback(async(y,w)=>{f.current&&(clearTimeout(f.current),f.current=null),await p(y,w)},[p]),v=d.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);return d.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),{triggerAutoSave:g,saveNow:N,cancelPendingAutoSave:v}}function Lt(l,n,i,c){d.useEffect(()=>{l&&!i&&c(n,l)},[l])}const q2=500;function K2(){return e.jsx(Yn,{children:e.jsx(Q2,{})})}function Q2(){const[l,n]=d.useState(!0),[i,c]=d.useState(!1),[u,x]=d.useState(!1),[h,f]=d.useState(!1),[p,g]=d.useState("visual"),[N,v]=d.useState(""),[y,w]=d.useState(!1),{toast:b}=Zs(),{triggerRestart:R,isRestarting:D}=vn(),[S,P]=d.useState(null),[M,T]=d.useState(null),[A,F]=d.useState(null),[L,J]=d.useState(null),[U,ue]=d.useState(null),[xe,he]=d.useState(null),[ne,ve]=d.useState(null),[je,z]=d.useState(null),[V,B]=d.useState(null),[oe,K]=d.useState(null),[_e,pe]=d.useState(null),[ke,O]=d.useState(null),[k,H]=d.useState(null),[se,Ee]=d.useState(null),[Z,Oe]=d.useState(null),[ns,Q]=d.useState(null),[ee,Ue]=d.useState(null),[ie,Te]=d.useState(null),[de,Me]=d.useState(null),rs=d.useRef(!0),Ut=d.useRef({}),aa=d.useCallback(ze=>{Ut.current=ze,P(ze.bot),T(ze.personality);const Ns=ze.chat;Ns.talk_value_rules||(Ns.talk_value_rules=[]),F(Ns),J(ze.expression),ue(ze.emoji),he(ze.memory),ve(ze.tool),z(ze.voice),B(ze.dream),K(ze.lpmm_knowledge),pe(ze.keyword_reaction),O(ze.response_post_process),H(ze.chinese_typo),Ee(ze.response_splitter),Oe(ze.log),Q(ze.debug),Ue(ze.maim_message),Te(ze.telemetry),Me(ze.webui)},[]),Qa=d.useCallback(()=>({...Ut.current,bot:S,personality:M,chat:A,expression:L,emoji:U,memory:xe,tool:ne,voice:je,dream:V,lpmm_knowledge:oe,keyword_reaction:_e,response_post_process:ke,chinese_typo:k,response_splitter:se,log:Z,debug:ns,maim_message:ee,telemetry:ie,webui:de}),[S,M,A,L,U,xe,ne,je,V,oe,_e,ke,k,se,Z,ns,ee,ie,de]),Ft=d.useCallback(async()=>{try{const Ns=(await D2()).replace(/"([^"]*)"/g,(as,es)=>`"${es.replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\"/g,'"').replace(/\\\\/g,"\\")}"`);v(Ns),w(!1)}catch(ze){b({variant:"destructive",title:"",description:ze instanceof Error?ze.message:""})}},[b]),mt=d.useCallback(async()=>{try{n(!0);const ze=await bg();aa(ze),f(!1),rs.current=!1,await Ft()}catch(ze){console.error(":",ze),b({title:"",description:"",variant:"destructive"})}finally{n(!1)}},[b,Ft,aa]);d.useEffect(()=>{mt()},[mt]);const{triggerAutoSave:q,cancelPendingAutoSave:Ve}=V2(rs.current,x,f);Lt(S,"bot",rs.current,q),Lt(M,"personality",rs.current,q),Lt(A,"chat",rs.current,q),Lt(L,"expression",rs.current,q),Lt(U,"emoji",rs.current,q),Lt(xe,"memory",rs.current,q),Lt(ne,"tool",rs.current,q),Lt(je,"voice",rs.current,q),Lt(V,"dream",rs.current,q),Lt(oe,"lpmm_knowledge",rs.current,q),Lt(_e,"keyword_reaction",rs.current,q),Lt(ke,"response_post_process",rs.current,q),Lt(k,"chinese_typo",rs.current,q),Lt(se,"response_splitter",rs.current,q),Lt(Z,"log",rs.current,q),Lt(ns,"debug",rs.current,q),Lt(ee,"maim_message",rs.current,q),Lt(ie,"telemetry",rs.current,q),Lt(de,"webui",rs.current,q);const Ke=async()=>{try{c(!0);const ze=N.replace(/"([^"]*)"/g,(Ns,as)=>`"${as.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}"`);await R2(ze),f(!1),w(!1),b({title:"",description:""}),await mt()}catch(ze){w(!0),b({variant:"destructive",title:"",description:ze instanceof Error?ze.message:""})}finally{c(!1)}},We=async ze=>{if(h){b({variant:"destructive",title:"",description:""});return}if(g(ze),ze==="source")await Ft();else try{const Ns=await bg();aa(Ns),f(!1)}catch(Ns){console.error(":",Ns),b({title:"",description:"",variant:"destructive"})}},Ls=async()=>{try{c(!0),Ve(),await yg(Qa()),f(!1),b({title:"",description:""})}catch(ze){console.error(":",ze),b({title:"",description:ze.message,variant:"destructive"})}finally{c(!1)}},ts=async()=>{await R()},Cs=async()=>{try{c(!0),Ve(),await yg(Qa()),f(!1),b({title:"",description:"..."}),await new Promise(ze=>setTimeout(ze,q2)),await ts()}catch(ze){console.error(":",ze),b({title:"",description:ze.message,variant:"destructive"})}finally{c(!1)}};return l?e.jsx(Ye,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs sm:text-sm",children:""})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(_,{onClick:p==="visual"?Ls:Ke,disabled:i||u||!h||D,size:"sm",variant:"outline",className:"w-20 sm:w-24",children:[e.jsx(oc,{className:"h-4 w-4 flex-shrink-0",strokeWidth:2,fill:"none"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:i?"":u?"":h?"":""})]}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{disabled:i||u||D,size:"sm",className:"w-20 sm:w-28",children:[e.jsx(cc,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"ml-1 truncate text-xs sm:text-sm",children:D?"":h?"":""})]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:h?",":","})})})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:h?Cs:ts,children:h?"":""})]})]})]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(ta,{value:p,onValueChange:ze=>We(ze),className:"w-full",children:e.jsxs(Xt,{className:"h-8 sm:h-9 w-full grid grid-cols-2",children:[e.jsxs(Je,{value:"visual",className:"text-xs sm:text-sm",children:[e.jsx(Lj,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]}),e.jsxs(Je,{value:"source",className:"text-xs sm:text-sm",children:[e.jsx(Uj,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),""]})]})})})]}),e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""}),'""']})]}),p==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsxs(lt,{children:[e.jsx("strong",{children:""})," TOML  TOML ",y&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(gv,{value:N,onChange:ze=>{v(ze),f(!0),y&&w(!1)},language:"toml",theme:"dark",height:"calc(100vh - 280px)",minHeight:"500px",placeholder:"TOML "})]}),p==="visual"&&e.jsx(e.Fragment,{children:e.jsxs(ta,{defaultValue:"bot",className:"w-full",children:[e.jsxs(Xt,{className:"flex flex-wrap h-auto gap-1 p-1 sm:grid sm:grid-cols-5 lg:grid-cols-10",children:[e.jsx(Je,{value:"bot",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"personality",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"chat",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"expression",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"features",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"processing",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"dream",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"lpmm",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"webui",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:"WebUI"}),e.jsx(Je,{value:"other",className:"text-xs px-2 py-1.5 sm:px-3 sm:py-2 data-[state=active]:shadow-sm",children:""})]}),e.jsx(ys,{value:"bot",className:"space-y-4",children:S&&e.jsx(f2,{config:S,onChange:P})}),e.jsx(ys,{value:"personality",className:"space-y-4",children:M&&e.jsx(p2,{config:M,onChange:T})}),e.jsx(ys,{value:"chat",className:"space-y-4",children:A&&e.jsx(b2,{config:A,onChange:F})}),e.jsx(ys,{value:"expression",className:"space-y-4",children:L&&e.jsx(M2,{config:L,onChange:J})}),e.jsx(ys,{value:"features",className:"space-y-4",children:U&&xe&&ne&&je&&e.jsx(T2,{emojiConfig:U,memoryConfig:xe,toolConfig:ne,voiceConfig:je,onEmojiChange:ue,onMemoryChange:he,onToolChange:ve,onVoiceChange:z})}),e.jsx(ys,{value:"processing",className:"space-y-4",children:_e&&ke&&k&&se&&e.jsx(A2,{keywordReactionConfig:_e,responsePostProcessConfig:ke,chineseTypoConfig:k,responseSplitterConfig:se,onKeywordReactionChange:pe,onResponsePostProcessChange:O,onChineseTypoChange:H,onResponseSplitterChange:Ee})}),e.jsx(ys,{value:"dream",className:"space-y-4",children:V&&e.jsx(y2,{config:V,onChange:B})}),e.jsx(ys,{value:"lpmm",className:"space-y-4",children:oe&&e.jsx(w2,{config:oe,onChange:K})}),e.jsx(ys,{value:"webui",className:"space-y-4",children:de&&e.jsx(O2,{config:de,onChange:Me})}),e.jsxs(ys,{value:"other",className:"space-y-4",children:[Z&&e.jsx(_2,{config:Z,onChange:Oe}),ns&&e.jsx(S2,{config:ns,onChange:Q}),ee&&e.jsx(k2,{config:ee,onChange:Ue}),ie&&e.jsx(C2,{config:ie,onChange:Te})]})]})}),e.jsx(Jn,{})]})})}const Rl=d.forwardRef(({className:l,...n},i)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:i,className:I("w-full caption-bottom text-sm",l),...n})}));Rl.displayName="Table";const Ll=d.forwardRef(({className:l,...n},i)=>e.jsx("thead",{ref:i,className:I("[&_tr]:border-b",l),...n}));Ll.displayName="TableHeader";const Ul=d.forwardRef(({className:l,...n},i)=>e.jsx("tbody",{ref:i,className:I("[&_tr:last-child]:border-0",l),...n}));Ul.displayName="TableBody";const Y2=d.forwardRef(({className:l,...n},i)=>e.jsx("tfoot",{ref:i,className:I("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...n}));Y2.displayName="TableFooter";const ut=d.forwardRef(({className:l,...n},i)=>e.jsx("tr",{ref:i,className:I("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...n}));ut.displayName="TableRow";const Ze=d.forwardRef(({className:l,...n},i)=>e.jsx("th",{ref:i,className:I("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...n}));Ze.displayName="TableHead";const qe=d.forwardRef(({className:l,...n},i)=>e.jsx("td",{ref:i,className:I("px-4 py-3 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...n}));qe.displayName="TableCell";const J2=d.forwardRef(({className:l,...n},i)=>e.jsx("caption",{ref:i,className:I("mt-4 text-sm text-muted-foreground",l),...n}));J2.displayName="TableCaption";const sd=d.forwardRef(({className:l,...n},i)=>e.jsx(ga,{ref:i,className:I("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",l),...n}));sd.displayName=ga.displayName;const td=d.forwardRef(({className:l,...n},i)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Tt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(ga.Input,{ref:i,className:I("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",l),...n})]}));td.displayName=ga.Input.displayName;const ad=d.forwardRef(({className:l,...n},i)=>e.jsx(ga.List,{ref:i,className:I("max-h-[300px] overflow-y-auto overflow-x-hidden",l),...n}));ad.displayName=ga.List.displayName;const ld=d.forwardRef((l,n)=>e.jsx(ga.Empty,{ref:n,className:"py-6 text-center text-sm",...l}));ld.displayName=ga.Empty.displayName;const ac=d.forwardRef(({className:l,...n},i)=>e.jsx(ga.Group,{ref:i,className:I("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",l),...n}));ac.displayName=ga.Group.displayName;const X2=d.forwardRef(({className:l,...n},i)=>e.jsx(ga.Separator,{ref:i,className:I("-mx-1 h-px bg-border",l),...n}));X2.displayName=ga.Separator.displayName;const lc=d.forwardRef(({className:l,...n},i)=>e.jsx(ga.Item,{ref:i,className:I("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l),...n}));lc.displayName=ga.Item.displayName;const jv=d.createContext(null),vv="maibot-completed-tours";function Z2(){try{const l=localStorage.getItem(vv);return l?new Set(JSON.parse(l)):new Set}catch{return new Set}}function wg(l){localStorage.setItem(vv,JSON.stringify([...l]))}function W2({children:l}){const[n,i]=d.useState({activeTourId:null,stepIndex:0,isRunning:!1}),[c]=d.useState(()=>new Map),[u,x]=d.useState(Z2),[,h]=d.useState(0),f=d.useCallback((M,T)=>{c.set(M,T),h(A=>A+1)},[c]),p=d.useCallback(M=>{c.delete(M),i(T=>T.activeTourId===M?{...T,activeTourId:null,isRunning:!1,stepIndex:0}:T)},[c]),g=d.useCallback((M,T=0)=>{c.has(M)&&i({activeTourId:M,stepIndex:T,isRunning:!0})},[c]),N=d.useCallback(()=>{i(M=>({...M,isRunning:!1}))},[]),v=d.useCallback(M=>{i(T=>({...T,stepIndex:M}))},[]),y=d.useCallback(()=>{i(M=>({...M,stepIndex:M.stepIndex+1}))},[]),w=d.useCallback(()=>{i(M=>({...M,stepIndex:Math.max(0,M.stepIndex-1)}))},[]),b=d.useCallback(()=>n.activeTourId?c.get(n.activeTourId)||[]:[],[n.activeTourId,c]),R=d.useCallback(M=>{x(T=>{const A=new Set(T);return A.add(M),wg(A),A})},[]),D=d.useCallback(M=>{const{action:T,index:A,status:F,type:L}=M,J=["finished","skipped"];if(T==="close"){i(U=>({...U,isRunning:!1,stepIndex:0}));return}J.includes(F)?i(U=>(F==="finished"&&U.activeTourId&&setTimeout(()=>R(U.activeTourId),0),{...U,isRunning:!1,stepIndex:0})):L==="step:after"&&(T==="next"?i(U=>({...U,stepIndex:A+1})):T==="prev"&&i(U=>({...U,stepIndex:A-1})))},[R]),S=d.useCallback(M=>u.has(M),[u]),P=d.useCallback(M=>{x(T=>{const A=new Set(T);return A.delete(M),wg(A),A})},[]);return e.jsx(jv.Provider,{value:{state:n,tours:c,registerTour:f,unregisterTour:p,startTour:g,stopTour:N,goToStep:v,nextStep:y,prevStep:w,getCurrentSteps:b,handleJoyrideCallback:D,isTourCompleted:S,markTourCompleted:R,resetTourCompleted:P},children:l})}function ax(){const l=d.useContext(jv);if(!l)throw new Error("useTour must be used within a TourProvider");return l}const eS={options:{zIndex:1e4,primaryColor:"hsl(var(--primary))",textColor:"hsl(var(--foreground))",backgroundColor:"hsl(var(--background))",arrowColor:"hsl(var(--background))",overlayColor:"rgba(0, 0, 0, 0.5)"},tooltip:{borderRadius:"var(--radius)",padding:"1rem"},tooltipContainer:{textAlign:"left"},tooltipTitle:{fontSize:"1rem",fontWeight:600,marginBottom:"0.5rem"},tooltipContent:{fontSize:"0.875rem",padding:"0.5rem 0"},buttonNext:{backgroundColor:"hsl(var(--primary))",color:"hsl(var(--primary-foreground))",borderRadius:"calc(var(--radius) - 2px)",fontSize:"0.875rem",padding:"0.5rem 1rem"},buttonBack:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem",marginRight:"0.5rem"},buttonSkip:{color:"hsl(var(--muted-foreground))",fontSize:"0.875rem"},buttonClose:{color:"hsl(var(--muted-foreground))"},spotlight:{borderRadius:"var(--radius)"}},sS={back:"",close:"",last:"",next:"",nextLabelWithProgress:" ({step}/{steps})",open:"",skip:""};function tS(){const{state:l,getCurrentSteps:n,handleJoyrideCallback:i}=ax(),c=n(),[u,x]=d.useState(!1),h=d.useRef(l.stepIndex),f=d.useRef(null);d.useEffect(()=>{h.current!==l.stepIndex&&(x(!1),h.current=l.stepIndex)},[l.stepIndex]),d.useEffect(()=>{if(!l.isRunning||c.length===0){x(!1);return}const v=c[l.stepIndex];if(!v){x(!1);return}const y=v.target;if(y==="body"){x(!0);return}x(!1);const w=setTimeout(()=>{const b=()=>{const P=document.querySelector(y);if(P){const M=P.getBoundingClientRect();if(M.width>0&&M.height>0)return!0}return!1};if(b()){setTimeout(()=>x(!0),100);return}const R=setInterval(()=>{b()&&(clearInterval(R),setTimeout(()=>x(!0),100))},100),D=setTimeout(()=>{clearInterval(R),x(!0)},5e3),S=()=>{clearInterval(R),clearTimeout(D)};f.current=S},150);return()=>{clearTimeout(w),f.current&&(f.current(),f.current=null)}},[l.isRunning,l.stepIndex,c]);const[p,g]=d.useState(null);if(d.useEffect(()=>{let v=document.getElementById("tour-portal-container");return v||(v=document.createElement("div"),v.id="tour-portal-container",v.style.cssText="position: fixed; top: 0; left: 0; z-index: 99999; pointer-events: none;",document.body.appendChild(v)),g(v),()=>{}},[]),!l.isRunning||c.length===0||!u)return null;const N=e.jsx(D_,{steps:c,stepIndex:l.stepIndex,run:l.isRunning,continuous:!0,showSkipButton:!0,showProgress:!0,disableOverlayClose:!0,disableScrolling:!1,disableScrollParentFix:!1,callback:i,styles:eS,locale:sS,scrollOffset:80,scrollToFirstStep:!0,floaterProps:{styles:{floater:{zIndex:99999}},disableAnimation:!0}},`tour-step-${l.stepIndex}`);return p?v0.createPortal(N,p):N}const il="model-assignment-tour",Nv=[{target:"body",content:"",placement:"center",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="sidebar-model-provider"]',content:' DeepSeek Siliconflow""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-provider-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="provider-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-apikey-input"]',content:" API  API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-url-input"]',content:" API API ",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-template-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="provider-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="sidebar-model-management"]',content:'""',placement:"right",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="add-model-button"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="model-dialog"]',content:"",placement:"left",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-name-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-provider-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-identifier-input"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-save-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1},{target:'[data-tour="model-cancel-button"]',content:"",placement:"top",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="tasks-tab-trigger"]',content:'""',placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!0,hideFooter:!0},{target:'[data-tour="task-model-select"]',content:"",placement:"bottom",disableBeacon:!0,disableOverlayClose:!0,hideCloseButton:!1,spotlightClicks:!1}],bv={0:"/config/model",1:"/config/model",2:"/config/modelProvider",3:"/config/modelProvider",4:"/config/modelProvider",5:"/config/modelProvider",6:"/config/modelProvider",7:"/config/modelProvider",8:"/config/modelProvider",9:"/config/modelProvider",10:"/config/modelProvider",11:"/config/model",12:"/config/model",13:"/config/model",14:"/config/model",15:"/config/model",16:"/config/model",17:"/config/model",18:"/config/model",19:"/config/model"},Vi=[{id:"siliconflow",name:"SiliconFlow",base_url:"https://api.siliconflow.cn/v1",client_type:"openai",display_name:" (SiliconFlow)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"deepseek",name:"DeepSeek",base_url:"https://api.deepseek.com",client_type:"openai",display_name:"DeepSeek",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"rinkoai",name:"RinkoAI",base_url:"https://rinkoai.com/v1",client_type:"openai",display_name:"RinkoAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"zhipu",name:"ZhipuAI",base_url:"https://open.bigmodel.cn/api/paas/v4",client_type:"openai",display_name:" AI (ZhipuAI / GLM)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"moonshot",name:"Moonshot",base_url:"https://api.moonshot.cn/v1",client_type:"openai",display_name:" (Moonshot / Kimi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"doubao",name:"Doubao",base_url:"https://ark.cn-beijing.volces.com/api/v3",client_type:"openai",display_name:" (Doubao)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"alibaba",name:"Alibaba",base_url:"https://dashscope.aliyuncs.com/compatible-mode/v1",client_type:"openai",display_name:" (Alibaba Qwen)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"baichuan",name:"Baichuan",base_url:"https://api.baichuan-ai.com/v1",client_type:"openai",display_name:" (Baichuan)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"minimax",name:"MiniMax",base_url:"https://api.minimax.chat/v1",client_type:"openai",display_name:"MiniMax ( AI)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"stepfun",name:"StepFun",base_url:"https://api.stepfun.com/v1",client_type:"openai",display_name:" (StepFun)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"lingyi",name:"Lingyi",base_url:"https://api.lingyiwanwu.com/v1",client_type:"openai",display_name:" (Lingyi / Yi)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"openai",name:"OpenAI",base_url:"https://api.openai.com/v1",client_type:"openai",display_name:"OpenAI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"xai",name:"xAI",base_url:"https://api.x.ai/v1",client_type:"openai",display_name:"xAI (Grok)",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"anthropic",name:"Anthropic",base_url:"https://api.anthropic.com/v1",client_type:"openai",display_name:"Anthropic (Claude)"},{id:"gemini",name:"Gemini",base_url:"https://generativelanguage.googleapis.com/v1beta",client_type:"gemini",display_name:"Google Gemini",modelFetcher:{endpoint:"/models",parser:"gemini"}},{id:"cohere",name:"Cohere",base_url:"https://api.cohere.ai/v1",client_type:"openai",display_name:"Cohere"},{id:"groq",name:"Groq",base_url:"https://api.groq.com/openai/v1",client_type:"openai",display_name:"Groq",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"together",name:"Together AI",base_url:"https://api.together.xyz/v1",client_type:"openai",display_name:"Together AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"fireworks",name:"Fireworks",base_url:"https://api.fireworks.ai/inference/v1",client_type:"openai",display_name:"Fireworks AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"mistral",name:"Mistral",base_url:"https://api.mistral.ai/v1",client_type:"openai",display_name:"Mistral AI",modelFetcher:{endpoint:"/models",parser:"openai"}},{id:"perplexity",name:"Perplexity",base_url:"https://api.perplexity.ai",client_type:"openai",display_name:"Perplexity AI"},{id:"custom",name:"",base_url:"",client_type:"openai",display_name:""}];function _g(l){return l?l.replace(/\/+$/,"").toLowerCase():""}function aS(l){if(!l)return null;const n=_g(l);return Vi.find(i=>i.id!=="custom"&&_g(i.base_url)===n)||null}const Co=l=>({...l,max_retry:l.max_retry??2,timeout:l.timeout??30,retry_interval:l.retry_interval??10}),lS=(l,n=[],i=null)=>{const c={};return l?(l.name?.trim()?n.some((x,h)=>i!==null&&h===i?!1:x.name.trim().toLowerCase()===l.name.trim().toLowerCase())&&(c.name=""):c.name="",l.base_url?.trim()||(c.base_url=" URL"),l.api_key?.trim()||(c.api_key=" API Key"),{isValid:Object.keys(c).length===0,errors:c}):{isValid:!1,errors:{name:""}}};function nS(){return e.jsx(Yn,{children:e.jsx(rS,{})})}function rS(){const[l,n]=d.useState([]),[i,c]=d.useState(!0),[u,x]=d.useState(!1),[h,f]=d.useState(!1),[p,g]=d.useState(!1),[N,v]=d.useState(!1),[y,w]=d.useState(null),[b,R]=d.useState(null),[D,S]=d.useState("custom"),[P,M]=d.useState(!1),[T,A]=d.useState(!1),[F,L]=d.useState(null),[J,U]=d.useState(!1),[ue,xe]=d.useState(""),[he,ne]=d.useState(new Set),[ve,je]=d.useState(!1),[z,V]=d.useState(1),[B,oe]=d.useState(20),[K,_e]=d.useState(""),[pe,ke]=d.useState({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),[O,k]=d.useState({}),[H,se]=d.useState(new Set),[Ee,Z]=d.useState(new Map),{toast:Oe}=Zs(),ns=ca(),{state:Q,goToStep:ee,registerTour:Ue}=ax(),{triggerRestart:ie,isRestarting:Te}=vn(),de=d.useRef(null),Me=d.useRef(!0);d.useEffect(()=>{Ue(il,Nv)},[Ue]),d.useEffect(()=>{if(Q.activeTourId===il&&Q.isRunning){const W=bv[Q.stepIndex];W&&!window.location.pathname.endsWith(W.replace("/config/",""))&&ns({to:W})}},[Q.stepIndex,Q.activeTourId,Q.isRunning,ns]);const rs=d.useRef(Q.stepIndex);d.useEffect(()=>{if(Q.activeTourId===il&&Q.isRunning){const W=rs.current,ye=Q.stepIndex;W>=3&&W<=9&&ye<3&&v(!1),W>=10&&ye>=3&&ye<=9&&(k({}),S("custom"),w({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10}),R(null),U(!1),v(!0)),rs.current=ye}},[Q.stepIndex,Q.activeTourId,Q.isRunning]),d.useEffect(()=>{if(Q.activeTourId!==il||!Q.isRunning)return;const W=ye=>{const Re=ye.target,Hs=Q.stepIndex;Hs===2&&Re.closest('[data-tour="add-provider-button"]')?setTimeout(()=>ee(3),300):Hs===9&&Re.closest('[data-tour="provider-cancel-button"]')&&setTimeout(()=>ee(10),300)};return document.addEventListener("click",W,!0),()=>document.removeEventListener("click",W,!0)},[Q,ee]),d.useEffect(()=>{Ut()},[]);const Ut=async()=>{try{c(!0);const W=await un();n(W.api_providers||[]),g(!1),Me.current=!1}catch(W){console.error(":",W)}finally{c(!1)}},aa=async()=>{await ie()},Qa=async()=>{try{x(!0),de.current&&clearTimeout(de.current);const W=l.map(rt=>({...rt,max_retry:rt.max_retry??2,timeout:rt.timeout??30,retry_interval:rt.retry_interval??10})),{shouldProceed:ye}=await Ft(W,"restart");if(!ye){x(!1);return}const Re=await un(),Hs=new Set(W.map(rt=>rt.name)),Wt=(Re.models||[]).filter(rt=>Hs.has(rt.api_provider));Re.api_providers=W,Re.models=Wt,await Ji(Re),g(!1),Oe({title:"",description:"..."}),await aa()}catch(W){console.error(":",W),Oe({title:"",description:W.message,variant:"destructive"}),x(!1)}},Ft=d.useCallback(async(W,ye="auto")=>{try{const Re=await un(),Hs=new Set(l.map(xt=>xt.name)),Dt=new Set(W.map(xt=>xt.name)),Wt=Array.from(Hs).filter(xt=>!Dt.has(xt));if(Wt.length===0)return{shouldProceed:!0,providers:W};const ea=(Re.models||[]).filter(xt=>Wt.includes(xt.api_provider));return ea.length===0?{shouldProceed:!0,providers:W}:(ke({isOpen:!0,providersToDelete:Wt,affectedModels:ea,pendingProviders:W,context:ye,oldProviders:[...l]}),{shouldProceed:!1,providers:W})}catch(Re){return console.error(":",Re),{shouldProceed:!0,providers:W}}},[l]),mt=async()=>{try{(pe.context==="auto"?f:x)(!0),ke(xt=>({...xt,isOpen:!1}));const ye=await un(),Re=pe.pendingProviders.map(Co),Hs=new Set(Re.map(xt=>xt.name)),Wt=(ye.models||[]).filter(xt=>Hs.has(xt.api_provider)),rt=new Set(pe.affectedModels.map(xt=>xt.name)),ea=ye.model_task_config;ea&&Object.keys(ea).forEach(xt=>{const re=ea[xt];re&&Array.isArray(re.model_list)&&(re.model_list=re.model_list.filter(fe=>!rt.has(fe)))}),ye.api_providers=Re,ye.models=Wt,ye.model_task_config=ea,await Ji(ye),n(pe.pendingProviders),g(!1),Oe({title:"",description:` ${pe.providersToDelete.length}  ${pe.affectedModels.length} `}),ke({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),ne(new Set),pe.context==="restart"&&await aa()}catch(W){console.error(":",W),Oe({title:"",description:W.message,variant:"destructive"})}finally{pe.context==="auto"?f(!1):x(!1)}},q=()=>{pe.oldProviders.length>0&&n(pe.oldProviders),ke({isOpen:!1,providersToDelete:[],affectedModels:[],pendingProviders:[],context:"auto",oldProviders:[]}),g(!1)},Ve=d.useCallback(async W=>{if(Me.current)return;const{shouldProceed:ye}=await Ft(W,"auto");if(!ye){g(!0);return}try{f(!0);const Re=W.map(Co);await Bm("api_providers",Re),g(!1)}catch(Re){console.error(":",Re),Oe({title:"",description:Re.message,variant:"destructive"}),g(!0)}finally{f(!1)}},[l,Ft]);d.useEffect(()=>{if(!Me.current)return g(!0),de.current&&clearTimeout(de.current),de.current=setTimeout(()=>{Ve(l)},2e3),()=>{de.current&&clearTimeout(de.current)}},[l,Ve]);const Ke=async()=>{try{x(!0),de.current&&clearTimeout(de.current);const W=l.map(Co),{shouldProceed:ye}=await Ft(W,"manual");if(!ye){x(!1);return}const Re=await un(),Hs=new Set(W.map(rt=>rt.name)),Dt=Re.models||[],Wt=Dt.filter(rt=>{const ea=Hs.has(rt.api_provider);return ea||console.warn(` "${rt.name}"  "${rt.api_provider}"`),ea});if(Dt.length!==Wt.length){const rt=Dt.length-Wt.length;Oe({title:"",description:` ${rt} `,variant:"default"})}console.log(" providers :",W),Re.api_providers=W,Re.models=Wt,console.log(":",Re),await Ji(Re),g(!1),Oe({title:"",description:""})}catch(W){console.error(":",W),Oe({title:"",description:W.message,variant:"destructive"})}finally{x(!1)}},We=(W,ye)=>{if(k({}),W){const Re=Vi.find(Hs=>Hs.base_url===W.base_url&&Hs.client_type===W.client_type);S(Re?.id||"custom"),w(W)}else S("custom"),w({name:"",base_url:"",api_key:"",client_type:"openai",max_retry:2,timeout:30,retry_interval:10});R(ye),U(!1),v(!0)},Ls=d.useCallback(W=>{S(W),M(!1);const ye=Vi.find(Re=>Re.id===W);ye&&ye.id!=="custom"?w(Re=>({...Re,name:ye.name,base_url:ye.base_url,client_type:ye.client_type})):ye?.id==="custom"&&w(Re=>({...Re,name:"",base_url:"",client_type:"openai"}))},[]),ts=d.useMemo(()=>D!=="custom",[D]),Cs=d.useCallback(async()=>{if(y?.api_key)try{await navigator.clipboard.writeText(y.api_key),Oe({title:"",description:"API Key "})}catch{Oe({title:"",description:"",variant:"destructive"})}},[y?.api_key,Oe]),ze=()=>{if(!y)return;const{isValid:W,errors:ye}=lS(y,l,b);if(!W){k(ye);return}k({});const Re=Co(y);if(b!==null){const Hs=[...l];Hs[b]=Re,n(Hs)}else n([...l,Re]);v(!1),w(null),R(null)},Ns=W=>{if(!W&&y){const ye={...y,max_retry:y.max_retry??2,timeout:y.timeout??30,retry_interval:y.retry_interval??10};w(ye)}v(W)},as=W=>{L(W),A(!0)},es=async()=>{if(F!==null){const W=l.filter((Re,Hs)=>Hs!==F),{shouldProceed:ye}=await Ft(W,"manual");ye&&(n(W),Oe({title:"",description:""}))}A(!1),L(null)},bs=W=>{const ye=new Set(he);ye.has(W)?ye.delete(W):ye.add(W),ne(ye)},gt=()=>{if(he.size===Ms.length)ne(new Set);else{const W=Ms.map((ye,Re)=>l.findIndex(Hs=>Hs===Ms[Re]));ne(new Set(W))}},$t=()=>{if(he.size===0){Oe({title:"",description:"",variant:"default"});return}je(!0)},tt=async()=>{const W=l.filter((Re,Hs)=>!he.has(Hs)),{shouldProceed:ye}=await Ft(W,"manual");ye&&(n(W),ne(new Set),Oe({title:"",description:` ${he.size} `})),je(!1)},Ms=d.useMemo(()=>{if(!ue)return l;const W=ue.toLowerCase();return l.filter(ye=>ye.name.toLowerCase().includes(W)||ye.base_url.toLowerCase().includes(W)||ye.client_type.toLowerCase().includes(W))},[l,ue]),{totalPages:Et,paginatedProviders:Bt}=d.useMemo(()=>{const W=Math.ceil(Ms.length/B),ye=Ms.slice((z-1)*B,z*B);return{totalPages:W,paginatedProviders:ye}},[Ms,z,B]),Oa=d.useCallback(()=>{const W=parseInt(K);W>=1&&W<=Et&&(V(W),_e(""))},[K,Et]),tl=async W=>{se(ye=>new Set(ye).add(W));try{const ye=await $2(W);Z(Re=>new Map(Re).set(W,ye)),ye.network_ok?ye.api_key_valid===!0?Oe({title:"",description:`${W} API Key  (${ye.latency_ms}ms)`}):ye.api_key_valid===!1?Oe({title:" Key ",description:`${W}  API Key `,variant:"destructive"}):Oe({title:"",description:`${W}  (${ye.latency_ms}ms)`}):Oe({title:"",description:ye.error||"",variant:"destructive"})}catch(ye){Oe({title:"",description:ye.message,variant:"destructive"})}finally{se(ye=>{const Re=new Set(ye);return Re.delete(W),Re})}},ul=async()=>{for(const W of l)await tl(W.name)},Xn=W=>{const ye=H.has(W),Re=Ee.get(W);return ye?e.jsxs(Se,{variant:"secondary",className:"gap-1",children:[e.jsx(Bs,{className:"h-3 w-3 animate-spin"}),""]}):Re?Re.network_ok?Re.api_key_valid===!0?e.jsxs(Se,{className:"gap-1 bg-green-600 hover:bg-green-700",children:[e.jsx(pt,{className:"h-3 w-3"}),""]}):Re.api_key_valid===!1?e.jsxs(Se,{variant:"destructive",className:"gap-1",children:[e.jsx(_t,{className:"h-3 w-3"}),"Key"]}):e.jsxs(Se,{className:"gap-1 bg-blue-600 hover:bg-blue-700",children:[e.jsx(pt,{className:"h-3 w-3"}),""]}):e.jsxs(Se,{variant:"destructive",className:"gap-1",children:[e.jsx(Va,{className:"h-3 w-3"}),""]}):null};return i?e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"AI"}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" AI  API "})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[he.size>0&&e.jsxs(_,{onClick:$t,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ls,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",he.size,")"]}),e.jsxs(_,{onClick:ul,size:"sm",variant:"outline",className:"w-full sm:w-auto",disabled:l.length===0||H.size>0,children:[e.jsx(Za,{className:"mr-2 h-4 w-4"}),H.size>0?` (${H.size})`:""]}),e.jsxs(_,{onClick:()=>We(null,null),size:"sm",className:"w-full sm:w-auto","data-tour":"add-provider-button",children:[e.jsx(et,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{onClick:Ke,disabled:u||h||!p||Te,size:"sm",variant:"outline",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(oc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),u?"...":h?"...":p?"":""]}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{disabled:u||h||Te,size:"sm",className:"w-full sm:w-auto sm:min-w-[120px]",children:[e.jsx(cc,{className:"mr-2 h-4 w-4"}),Te?"...":p?"":""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:p?",":","})})})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:p?Qa:aa,children:p?"":""})]})]})]})]})]}),e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""}),'""']})]}),e.jsxs(Ye,{className:"h-[calc(100vh-260px)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"URL ...",value:ue,onChange:W=>xe(W.target.value),className:"pl-9"})]}),ue&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Ms.length," "]})]}),e.jsx("div",{className:"md:hidden space-y-3",children:Ms.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8 rounded-lg border bg-card",children:ue?"":'""'}):Bt.map((W,ye)=>{const Re=l.findIndex(Hs=>Hs===W);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-base truncate",children:W.name}),Xn(W.name)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 break-all",children:W.base_url})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>tl(W.name),disabled:H.has(W.name),title:"",children:H.has(W.name)?e.jsx(Bs,{className:"h-4 w-4 animate-spin"}):e.jsx(Za,{className:"h-4 w-4"})}),e.jsx(_,{variant:"default",size:"sm",onClick:()=>We(W,Re),children:e.jsx(Fn,{className:"h-4 w-4",strokeWidth:2,fill:"none"})}),e.jsx(_,{size:"sm",onClick:()=>as(Re),className:"bg-red-600 hover:bg-red-700 text-white",children:e.jsx(ls,{className:"h-4 w-4",strokeWidth:2,fill:"none"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:W.client_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:W.max_retry})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:W.timeout})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"()"}),e.jsx("p",{className:"font-medium",children:W.retry_interval})]})]})]},ye)})}),e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(qs,{checked:he.size===Ms.length&&Ms.length>0,onCheckedChange:gt})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"URL"}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""}),e.jsx(Ze,{className:"text-right",children:"()"}),e.jsx(Ze,{className:"text-right",children:"()"}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Ul,{children:Bt.length===0?e.jsx(ut,{children:e.jsx(qe,{colSpan:9,className:"text-center text-muted-foreground py-8",children:ue?"":'""'})}):Bt.map((W,ye)=>{const Re=l.findIndex(Hs=>Hs===W);return e.jsxs(ut,{children:[e.jsx(qe,{children:e.jsx(qs,{checked:he.has(Re),onCheckedChange:()=>bs(Re)})}),e.jsx(qe,{children:Xn(W.name)||e.jsx(Se,{variant:"outline",className:"text-muted-foreground",children:""})}),e.jsx(qe,{className:"font-medium",children:W.name}),e.jsx(qe,{className:"max-w-xs truncate",title:W.base_url,children:W.base_url}),e.jsx(qe,{children:W.client_type}),e.jsx(qe,{className:"text-right",children:W.max_retry}),e.jsx(qe,{className:"text-right",children:W.timeout}),e.jsx(qe,{className:"text-right",children:W.retry_interval}),e.jsx(qe,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>tl(W.name),disabled:H.has(W.name),title:"",children:H.has(W.name)?e.jsx(Bs,{className:"h-4 w-4 animate-spin"}):e.jsx(Za,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>We(W,Re),children:[e.jsx(Fn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>as(Re),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},ye)})})]})})}),Ms.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{htmlFor:"page-size-provider",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:B.toString(),onValueChange:W=>{oe(parseInt(W)),V(1),ne(new Set)},children:[e.jsx($e,{id:"page-size-provider",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"10",children:"10"}),e.jsx(X,{value:"20",children:"20"}),e.jsx(X,{value:"50",children:"50"}),e.jsx(X,{value:"100",children:"100"})]})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(z-1)*B+1," "," ",Math.min(z*B,Ms.length),"  ",Ms.length," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>V(1),disabled:z===1,className:"hidden sm:flex",children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>V(W=>Math.max(1,W-1)),disabled:z===1,children:[e.jsx(Aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:K,onChange:W=>_e(W.target.value),onKeyDown:W=>W.key==="Enter"&&Oa(),placeholder:z.toString(),className:"w-16 h-8 text-center",min:1,max:Et}),e.jsx(_,{variant:"outline",size:"sm",onClick:Oa,disabled:!K,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>V(W=>W+1),disabled:z>=Et,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Zt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>V(Et),disabled:z>=Et,className:"hidden sm:flex",children:e.jsx(jn,{className:"h-4 w-4"})})]})]})]}),e.jsx(Is,{open:N,onOpenChange:Ns,children:e.jsxs(Os,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"provider-dialog",preventOutsideClose:Q.isRunning,children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:b!==null?"":""}),e.jsx(Ks,{children:" API "})]}),e.jsxs("form",{onSubmit:W=>{W.preventDefault(),ze()},autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"provider-template-select",children:[e.jsx(E,{htmlFor:"template",children:""}),e.jsxs(ol,{open:P,onOpenChange:M,children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":P,className:"w-full justify-between",children:[D?Vi.find(W=>W.id===D)?.display_name:"...",e.jsx(Ym,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Wa,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(sd,{children:[e.jsx(td,{placeholder:"..."}),e.jsx(Ye,{className:"h-[300px]",children:e.jsxs(ad,{className:"max-h-none overflow-visible",children:[e.jsx(ld,{children:""}),e.jsx(ac,{children:Vi.map(W=>e.jsxs(lc,{value:W.display_name,onSelect:()=>Ls(W.id),children:[e.jsx(Ct,{className:`mr-2 h-4 w-4 ${D===W.id?"opacity-100":"opacity-0"}`}),W.display_name]},W.id))})]})})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" URL ,"})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-name-input",children:[e.jsx(E,{htmlFor:"name",className:O.name?"text-destructive":"",children:" *"}),e.jsx(le,{id:"name",value:y?.name||"",onChange:W=>{w(ye=>ye?{...ye,name:W.target.value}:null),O.name&&k(ye=>({...ye,name:void 0}))},placeholder:": DeepSeek, SiliconFlow",className:O.name?"border-destructive focus-visible:ring-destructive":""}),O.name&&e.jsx("p",{className:"text-xs text-destructive",children:O.name})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-url-input",children:[e.jsx(E,{htmlFor:"base_url",className:O.base_url?"text-destructive":"",children:" URL *"}),e.jsx(le,{id:"base_url",value:y?.base_url||"",onChange:W=>{w(ye=>ye?{...ye,base_url:W.target.value}:null),O.base_url&&k(ye=>({...ye,base_url:void 0}))},placeholder:"https://api.example.com/v1",disabled:ts,className:`${ts?"bg-muted cursor-not-allowed":""} ${O.base_url?"border-destructive focus-visible:ring-destructive":""}`}),O.base_url&&e.jsx("p",{className:"text-xs text-destructive",children:O.base_url}),ts&&!O.base_url&&e.jsx("p",{className:"text-xs text-muted-foreground",children:' URL ,""'})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"provider-apikey-input",children:[e.jsx(E,{htmlFor:"api_key",className:O.api_key?"text-destructive":"",children:"API Key *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{id:"api_key",type:J?"text":"password",value:y?.api_key||"",onChange:W=>{w(ye=>ye?{...ye,api_key:W.target.value}:null),O.api_key&&k(ye=>({...ye,api_key:void 0}))},placeholder:"sk-...",className:`flex-1 ${O.api_key?"border-destructive focus-visible:ring-destructive":""}`}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:()=>U(!J),title:J?"":"",children:J?e.jsx(Wi,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"outline",size:"icon",onClick:Cs,title:"",children:e.jsx(Ro,{className:"h-4 w-4"})})]}),O.api_key&&e.jsx("p",{className:"text-xs text-destructive",children:O.api_key})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"client_type",children:""}),e.jsxs(Ie,{value:y?.client_type||"openai",onValueChange:W=>w(ye=>ye?{...ye,client_type:W}:null),disabled:ts,children:[e.jsx($e,{id:"client_type",className:ts?"bg-muted cursor-not-allowed":"",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"openai",children:"OpenAI"}),e.jsx(X,{value:"gemini",children:"Gemini"})]})]}),ts&&e.jsx("p",{className:"text-xs text-muted-foreground",children:',""'})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"max_retry",children:""}),e.jsx(le,{id:"max_retry",type:"number",min:"0",value:y?.max_retry??"",onChange:W=>{const ye=W.target.value===""?null:parseInt(W.target.value);w(Re=>Re?{...Re,max_retry:ye}:null)},placeholder:": 2"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"timeout",children:"()"}),e.jsx(le,{id:"timeout",type:"number",min:"1",value:y?.timeout??"",onChange:W=>{const ye=W.target.value===""?null:parseInt(W.target.value);w(Re=>Re?{...Re,timeout:ye}:null)},placeholder:": 30"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"retry_interval",children:"()"}),e.jsx(le,{id:"retry_interval",type:"number",min:"1",value:y?.retry_interval??"",onChange:W=>{const ye=W.target.value===""?null:parseInt(W.target.value);w(Re=>Re?{...Re,retry_interval:ye}:null)},placeholder:": 10"})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>v(!1),"data-tour":"provider-cancel-button",children:""}),e.jsx(_,{type:"submit","data-tour":"provider-save-button",children:""})]})]})]})}),e.jsx(vs,{open:T,onOpenChange:A,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',F!==null?l[F]?.name:"",'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:es,children:""})]})]})}),e.jsx(vs,{open:ve,onOpenChange:je,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",he.size,"  "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:tt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:pe.isOpen,onOpenChange:W=>ke(ye=>({...ye,isOpen:W})),children:e.jsxs(ds,{className:"max-w-2xl",children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:["",e.jsx("strong",{className:"text-foreground ml-1",children:pe.providersToDelete.join(", ")})]}),e.jsxs("p",{className:"text-yellow-600 dark:text-yellow-500 font-medium",children:["  ",pe.affectedModels.length," "]}),e.jsx(Ye,{className:"h-32 w-full rounded border p-3",children:e.jsx("div",{className:"space-y-1",children:pe.affectedModels.map((W,ye)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-mono text-muted-foreground",children:""}),e.jsx("span",{className:"ml-2 font-medium",children:W.name}),e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",W.model_identifier,")"]})]},ye))})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:q,children:""}),e.jsx(fs,{onClick:mt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(Jn,{})]})}function Xi(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,11)}`}function Tm(l){return l===null?"null":Array.isArray(l)?"array":typeof l=="object"?"object":typeof l=="boolean"?"boolean":typeof l=="number"?"number":"string"}function Im(l){return Object.entries(l).map(([n,i])=>{const c=Tm(i),u={id:Xi(),key:n,value:i,type:c,expanded:!0};return c==="object"&&i&&typeof i=="object"?u.children=Im(i):c==="array"&&Array.isArray(i)&&(u.children=i.map((x,h)=>{const f=Tm(x),p={id:Xi(),key:String(h),value:x,type:f,expanded:!0};return f==="object"&&x&&typeof x=="object"?p.children=Im(x):f==="array"&&Array.isArray(x)&&(p.children=x.map((g,N)=>({id:Xi(),key:String(N),value:g,type:Tm(g),expanded:!0}))),p})),u})}function Pm(l){const n={};for(const i of l)i.key.trim()&&(i.type==="object"&&i.children?n[i.key]=Pm(i.children):i.type==="array"&&i.children?n[i.key]=i.children.map(c=>c.type==="object"&&c.children?Pm(c.children):c.type==="array"&&c.children?c.children.map(u=>u.value):c.value):i.type==="null"?n[i.key]=null:n[i.key]=i.value);return n}function Sg(l,n){switch(n){case"boolean":return l==="true";case"number":{const i=parseFloat(l);return isNaN(i)?0:i}case"null":return null;default:return l}}function yv({node:l,level:n,onUpdate:i,onRemove:c,onAddChild:u,onToggleExpand:x}){const h=l.type==="object"||l.type==="array",f=l.children&&l.children.length>0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 items-center",style:{gridTemplateColumns:h?"32px 1fr 90px 64px":"32px 1fr 1fr 90px 32px",paddingLeft:`${n*20}px`},children:[e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>x(l.id),disabled:!h||!f,children:h&&f?l.expanded?e.jsx(za,{className:"h-4 w-4"}):e.jsx(Zt,{className:"h-4 w-4"}):e.jsx("span",{className:"w-4"})}),e.jsx(le,{value:l.key,onChange:p=>i(l.id,"key",p.target.value),placeholder:"key",className:"h-8 text-sm"}),!h&&e.jsx(e.Fragment,{children:l.type==="boolean"?e.jsxs("div",{className:"flex items-center h-8 px-3 border rounded-md bg-background",children:[e.jsx(Fe,{checked:l.value===!0,onCheckedChange:p=>i(l.id,"value",p)}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:l.value?"true":"false"})]}):l.type==="null"?e.jsx("div",{className:"flex items-center h-8 px-3 border rounded-md bg-muted text-sm text-muted-foreground",children:"null"}):e.jsx(le,{type:l.type==="number"?"number":"text",value:l.value,onChange:p=>i(l.id,"value",p.target.value),placeholder:"value",className:"h-8 text-sm",step:l.type==="number"?"any":void 0})}),e.jsxs(Ie,{value:l.type,onValueChange:p=>i(l.id,"type",p),children:[e.jsx($e,{className:"h-8 text-xs",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"string",children:""}),e.jsx(X,{value:"number",children:""}),e.jsx(X,{value:"boolean",children:""}),e.jsx(X,{value:"null",children:"Null"}),e.jsx(X,{value:"object",children:""}),e.jsx(X,{value:"array",children:""})]})]}),e.jsxs("div",{className:"flex gap-1 justify-end",children:[h&&e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>u(l.id),title:"",children:e.jsx(et,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>c(l.id),title:"",children:e.jsx(ls,{className:"h-4 w-4"})})]})]}),h&&l.expanded&&l.children&&l.children.length>0&&e.jsx("div",{className:"space-y-1",children:l.children.map(p=>e.jsx(yv,{node:p,level:n+1,onUpdate:i,onRemove:c,onAddChild:u,onToggleExpand:x},p.id))})]})}function iS({value:l,onChange:n,placeholder:i="..."}){const[c,u]=d.useState(()=>Im(l||{})),x=d.useCallback(v=>{u(v),n(Pm(v))},[n]),h=d.useCallback(()=>{const v={id:Xi(),key:"",value:"",type:"string",expanded:!1};x([...c,v])},[c,x]),f=d.useCallback((v,y,w)=>{const b=R=>R.map(D=>{if(D.id===v)if(y==="type"){const S=w;if(S==="object")return{...D,type:S,value:{},children:[]};if(S==="array")return{...D,type:S,value:[],children:[]};if(S==="null")return{...D,type:S,value:null};{const P=Sg(String(D.value),S);return{...D,type:S,value:P,children:void 0}}}else if(y==="value"){const S=Sg(String(w),D.type);return{...D,value:S}}else return{...D,[y]:String(w)};return D.children?{...D,children:b(D.children)}:D});x(b(c))},[c,x]),p=d.useCallback(v=>{const y=w=>w.filter(b=>b.id!==v).map(b=>b.children?{...b,children:y(b.children)}:b);x(y(c))},[c,x]),g=d.useCallback(v=>{const y=w=>w.map(b=>{if(b.id===v){const R={id:Xi(),key:b.type==="array"?String(b.children?.length||0):"",value:"",type:"string",expanded:!0};return{...b,children:[...b.children||[],R]}}return b.children?{...b,children:y(b.children)}:b});x(y(c))},[c,x]),N=d.useCallback(v=>{const y=w=>w.map(b=>b.id===v?{...b,expanded:!b.expanded}:b.children?{...b,children:y(b.children)}:b);u(y(c))},[c]);return e.jsxs("div",{className:"h-full flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c.length," "]}),e.jsxs(_,{type:"button",size:"sm",variant:"outline",onClick:h,className:"h-7 text-xs",children:[e.jsx(et,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",children:c.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4 border border-dashed rounded-md",children:i}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-2 text-xs text-muted-foreground px-1 sticky top-0 bg-background z-10",style:{gridTemplateColumns:"32px 1fr 1fr 90px 32px"},children:[e.jsx("span",{}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{children:""}),e.jsx("span",{})]}),c.map(v=>e.jsx(yv,{node:v,level:0,onUpdate:f,onRemove:p,onAddChild:g,onToggleExpand:N},v.id))]})})]})}function kg(l){if(!l.trim())return{valid:!0,parsed:{}};try{const n=JSON.parse(l);return typeof n!="object"||n===null||Array.isArray(n)?{valid:!1,error:" JSON  {}"}:{valid:!0,parsed:n}}catch{return{valid:!1,error:"JSON "}}}function cS({value:l,onChange:n,className:i,placeholder:c="..."}){const[u,x]=d.useState("list"),h=d.useMemo(()=>Object.keys(l||{}).length>0?JSON.stringify(l,null,2):"",[l]),[f,p]=d.useState(h),[g,N]=d.useState(null);d.useEffect(()=>{p(h)},[h]);const v=d.useMemo(()=>{const b=kg(f);return b.valid&&b.parsed?{success:!0,data:b.parsed}:{success:!1,data:{}}},[f]),y=d.useCallback(b=>{const R=b;R==="json"&&u==="list"&&(p(Object.keys(l).length>0?JSON.stringify(l,null,2):""),N(null)),x(R)},[u,l]),w=d.useCallback(b=>{p(b);const R=kg(b);R.valid&&R.parsed?(N(null),n(R.parsed)):N(R.error||"JSON ")},[n]);return e.jsx("div",{className:I("h-full flex flex-col",i),children:e.jsxs(ta,{value:u,onValueChange:y,className:"w-full flex-1 flex flex-col",children:[e.jsxs(Xt,{className:"h-8 p-0.5 bg-muted/60 w-fit",children:[e.jsx(Je,{value:"list",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:""}),e.jsx(Je,{value:"json",className:"h-7 px-3 text-xs data-[state=active]:bg-background data-[state=active]:shadow-sm",children:"JSON "})]}),e.jsx(ys,{value:"list",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsx(iS,{value:l,onChange:n,placeholder:c})}),e.jsx(ys,{value:"json",className:"mt-2 flex-1 flex flex-col overflow-hidden data-[state=inactive]:hidden data-[state=inactive]:h-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),g?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-destructive",children:[e.jsx(_t,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:g})]}):f.trim()&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Ct,{className:"h-3 w-3"}),e.jsx("span",{children:""})]})]}),e.jsx(ot,{value:f,onChange:b=>w(b.target.value),placeholder:`{
  "key": "value"
}`,className:I("font-mono text-sm flex-1 resize-none",g&&"border-destructive focus-visible:ring-destructive")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" JSON "})]}),e.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"flex-1 rounded-md border bg-muted/30 p-3 overflow-auto",children:v.success&&Object.keys(v.data).length>0?e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-words",children:JSON.stringify(v.data,null,2)}):v.success?e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:""}):e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-destructive",children:"JSON "})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})})]})})}function oS({open:l,onOpenChange:n,value:i,onChange:c}){const[u,x]=d.useState(i),h=g=>{g&&x(i),n(g)},f=()=>{c(u),n(!1)},p=()=>{x(i),n(!1)};return e.jsx(Is,{open:l,onOpenChange:h,children:e.jsxs(Os,{className:"max-w-3xl h-[70vh] flex flex-col",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:e.jsx(cS,{value:u,onChange:x,placeholder:" thinkingtop_p ..."})}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:p,children:""}),e.jsx(_,{onClick:f,children:""})]})]})})}const Qr="https://maibot-plugin-stats.maibot-webui.workers.dev";async function dS(l){const n=new URLSearchParams;l?.status&&n.set("status",l.status),l?.page&&n.set("page",l.page.toString()),l?.page_size&&n.set("page_size",l.page_size.toString()),l?.search&&n.set("search",l.search),l?.sort_by&&n.set("sort_by",l.sort_by),l?.sort_order&&n.set("sort_order",l.sort_order);const i=await fetch(`${Qr}/pack?${n.toString()}`);if(!i.ok)throw new Error(` Pack : ${i.status}`);return i.json()}async function uS(l){const n=await fetch(`${Qr}/pack/${l}`);if(!n.ok)throw new Error(` Pack : ${n.status}`);const i=await n.json();if(!i.success)throw new Error(i.error||" Pack ");return i.pack}async function mS(l){const i=await(await fetch(`${Qr}/pack`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();if(!i.success)throw new Error(i.error||" Pack ");return i}async function xS(l,n){await fetch(`${Qr}/pack/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:l,user_id:n})})}async function wv(l,n){const c=await(await fetch(`${Qr}/pack/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pack_id:l,user_id:n})})).json();if(!c.success)throw new Error(c.error||"");return{likes:c.likes,liked:c.liked}}async function _v(l,n){return(await(await fetch(`${Qr}/pack/like/check?pack_id=${l}&user_id=${n}`)).json()).liked||!1}async function hS(l){const n=await we("/api/webui/config/model");if(!n.ok)throw new Error("");const i=await n.json(),c=i.config||i;console.log("=== Pack Conflict Detection ==="),console.log("Pack providers:",l.providers),console.log("Local providers:",c.api_providers);const u={existing_providers:[],new_providers:[],conflicting_models:[]},x=c.api_providers||[];for(const f of l.providers){console.log(`
Checking pack provider: ${f.name}`),console.log(`  Pack URL: ${f.base_url}`),console.log(`  Normalized: ${Em(f.base_url)}`);const p=x.filter(g=>{const N=Em(g.base_url),v=Em(f.base_url);return console.log(`  Comparing with local "${g.name}": ${g.base_url}`),console.log(`    Local normalized: ${N}`),console.log(`    Match: ${N===v}`),N===v});p.length>0?(console.log(`   Matched with ${p.length} local provider(s):`,p.map(g=>g.name).join(", ")),u.existing_providers.push({pack_provider:f,local_providers:p.map(g=>({name:g.name,base_url:g.base_url}))})):(console.log("   No match found - will need API key"),u.new_providers.push(f))}const h=c.models||[];console.log(`
=== Model Conflict Detection ===`);for(const f of l.models){const p=h.find(g=>g.name===f.name);p&&(console.log(`Model conflict: ${f.name}`),u.conflicting_models.push({pack_model:f.name,local_model:p.name}))}return console.log(`
=== Detection Summary ===`),console.log(`Existing providers: ${u.existing_providers.length}`),console.log(`New providers: ${u.new_providers.length}`),console.log(`Conflicting models: ${u.conflicting_models.length}`),console.log(`===========================
`),u}async function fS(l,n,i,c){const u=await we("/api/webui/config/model");if(!u.ok)throw new Error("");const x=await u.json(),h=x.config||x;if(n.apply_providers){const p=n.selected_providers?l.providers.filter(g=>n.selected_providers.includes(g.name)):l.providers;for(const g of p){if(i[g.name])continue;const N=c[g.name];if(!N)throw new Error(` "${g.name}"  API Key`);const v={...g,api_key:N},y=h.api_providers.findIndex(w=>w.name===g.name);y>=0?h.api_providers[y]=v:h.api_providers.push(v)}}if(n.apply_models){const p=n.selected_models?l.models.filter(g=>n.selected_models.includes(g.name)):l.models;for(const g of p){const N=i[g.api_provider]||g.api_provider,v={...g,api_provider:N},y=h.models.findIndex(w=>w.name===g.name);y>=0?h.models[y]=v:h.models.push(v)}}if(n.apply_task_config){const p=n.selected_tasks||Object.keys(l.task_config);for(const g of p){const N=l.task_config[g];if(!N)continue;const v=new Set(n.selected_models||l.models.map(b=>b.name)),y=N.model_list.filter(b=>v.has(b));if(y.length===0)continue;const w={...N,model_list:y};if(n.task_mode==="replace")h.model_task_config[g]=w;else{const b=h.model_task_config[g];if(b){const R=[...new Set([...b.model_list,...y])];h.model_task_config[g]={...b,model_list:R}}else h.model_task_config[g]=w}}}if(!(await we("/api/webui/config/model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("")}async function pS(l){const n=await we("/api/webui/config/model");if(!n.ok)throw new Error("");const i=await n.json();if(!i.success||!i.config)throw new Error("");const c=i.config;let u=(c.api_providers||[]).map(g=>({name:g.name,base_url:g.base_url,client_type:g.client_type,max_retry:g.max_retry,timeout:g.timeout,retry_interval:g.retry_interval}));l.selectedProviders&&(u=u.filter(g=>l.selectedProviders.includes(g.name)));let x=c.models||[];l.selectedModels&&(x=x.filter(g=>l.selectedModels.includes(g.name)));const h={},f=c.model_task_config||{},p=l.selectedTasks||Object.keys(f);for(const g of p)f[g]&&(h[g]=f[g]);return{providers:u,models:x,task_config:h}}function Em(l){try{const n=new URL(l);return`${n.protocol}//${n.host}${n.pathname}`.replace(/\/$/,"").toLowerCase()}catch{return l.toLowerCase().replace(/\/$/,"")}}function Sv(){const l="maibot_pack_user_id";let n=localStorage.getItem(l);return n||(n="pack_user_"+Math.random().toString(36).substring(2,15),localStorage.setItem(l,n)),n}const gS={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""},jS=["","","","","","","OpenAI","Claude","Gemini","","",""];function vS({trigger:l}){const[n,i]=d.useState(!1),[c,u]=d.useState(1),[x,h]=d.useState(!1),[f,p]=d.useState(!1),[g,N]=d.useState([]),[v,y]=d.useState([]),[w,b]=d.useState({}),[R,D]=d.useState(new Set),[S,P]=d.useState(new Set),[M,T]=d.useState(new Set),[A,F]=d.useState(""),[L,J]=d.useState(""),[U,ue]=d.useState(""),[xe,he]=d.useState([]);d.useEffect(()=>{n&&c===1&&ne()},[n,c]);const ne=async()=>{h(!0);try{const O=await pS({name:"",description:"",author:""});N(O.providers),y(O.models),b(O.task_config),D(new Set(O.providers.map(k=>k.name))),P(new Set(O.models.map(k=>k.name))),T(new Set(Object.keys(O.task_config)))}catch(O){console.error(":",O),Qt({title:"",variant:"destructive"})}finally{h(!1)}},ve=O=>{const k=new Set(R),H=new Set(S),se=new Set(M);k.has(O)?(k.delete(O),v.filter(Z=>Z.api_provider===O).forEach(Z=>H.delete(Z.name)),Object.entries(w).forEach(([Z,Oe])=>{Oe.model_list&&(Oe.model_list.some(Q=>H.has(Q))||se.delete(Z))})):(k.add(O),v.filter(Z=>Z.api_provider===O).forEach(Z=>H.add(Z.name)),Object.entries(w).forEach(([Z,Oe])=>{Oe.model_list&&Oe.model_list.some(Q=>{const ee=v.find(Ue=>Ue.name===Q);return ee&&ee.api_provider===O})&&se.add(Z)})),D(k),P(H),T(se)},je=O=>{const k=new Set(S),H=new Set(M);k.has(O)?(k.delete(O),Object.entries(w).forEach(([se,Ee])=>{Ee.model_list&&(Ee.model_list.some(Oe=>k.has(Oe))||H.delete(se))})):(k.add(O),Object.entries(w).forEach(([se,Ee])=>{Ee.model_list&&Ee.model_list.includes(O)&&H.add(se)})),P(k),T(H)},z=O=>{const k=new Set(M);k.has(O)?k.delete(O):k.add(O),T(k)},V=O=>{xe.includes(O)?he(xe.filter(k=>k!==O)):xe.length<5?he([...xe,O]):Qt({title:" 5 ",variant:"destructive"})},B=()=>{R.size===g.length?D(new Set):D(new Set(g.map(O=>O.name)))},oe=()=>{S.size===v.length?P(new Set):P(new Set(v.map(O=>O.name)))},K=()=>{const O=Object.keys(w);M.size===O.length?T(new Set):T(new Set(O))},_e=async()=>{if(!A.trim()){Qt({title:"",variant:"destructive"});return}if(!L.trim()){Qt({title:"",variant:"destructive"});return}if(!U.trim()){Qt({title:"",variant:"destructive"});return}if(R.size===0&&S.size===0&&M.size===0){Qt({title:"",variant:"destructive"});return}p(!0);try{const O=g.filter(se=>R.has(se.name)),k=v.filter(se=>S.has(se.name)),H={};for(const[se,Ee]of Object.entries(w))M.has(se)&&(H[se]=Ee);await mS({name:A.trim(),description:L.trim(),author:U.trim(),tags:xe,providers:O,models:k,task_config:H}),Qt({title:""}),i(!1),pe()}catch(O){console.error(":",O),Qt({title:O instanceof Error?O.message:"",variant:"destructive"})}finally{p(!1)}},pe=()=>{u(1),F(""),J(""),ue(""),he([]),D(new Set),P(new Set),T(new Set)},ke=2;return e.jsxs(Is,{open:n,onOpenChange:i,children:[e.jsx(Wo,{asChild:!0,children:l||e.jsxs(_,{variant:"outline",children:[e.jsx($j,{className:"w-4 h-4 mr-2"}),""]})}),e.jsxs(Os,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(ra,{className:"w-5 h-5"}),""]}),e.jsxs(Ks,{children:[" ",c," / ",ke,"",c===1&&"",c===2&&""]})]}),e.jsx(Ye,{className:"h-[calc(85vh-220px)] pr-4",children:x?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Bs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Hn,{children:""}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""})," API Key"]})]}),e.jsxs(ta,{defaultValue:"providers",className:"w-full",children:[e.jsxs(Xt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Je,{value:"providers",children:[e.jsx(Dl,{className:"w-4 h-4 mr-2"}),"API ",e.jsxs(Se,{variant:"secondary",className:"ml-2",children:[R.size,"/",g.length]})]}),e.jsxs(Je,{value:"models",children:[e.jsx(Gn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(Se,{variant:"secondary",className:"ml-2",children:[S.size,"/",v.length]})]}),e.jsxs(Je,{value:"tasks",children:[e.jsx(Vn,{className:"w-4 h-4 mr-2"}),"",e.jsxs(Se,{variant:"secondary",className:"ml-2",children:[M.size,"/",Object.keys(w).length]})]})]}),e.jsx(ys,{value:"providers",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:B,children:R.size===g.length?"":""})}),g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):g.map(O=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(qs,{id:`provider-${O.name}`,checked:R.has(O.name),onCheckedChange:()=>ve(O.name)}),e.jsxs(E,{htmlFor:`provider-${O.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:O.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:O.base_url})]}),e.jsx(Se,{variant:"outline",className:"text-xs",children:O.client_type})]},O.name))]})}),e.jsx(ys,{value:"models",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:oe,children:S.size===v.length?"":""})}),v.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):v.map(O=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded hover:bg-muted",children:[e.jsx(qs,{id:`model-${O.name}`,checked:S.has(O.name),onCheckedChange:()=>je(O.name)}),e.jsxs(E,{htmlFor:`model-${O.name}`,className:"flex-1 cursor-pointer",children:[e.jsx("span",{className:"font-medium",children:O.name}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:O.model_identifier})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:O.api_provider})]},O.name))]})}),e.jsx(ys,{value:"tasks",className:"space-y-2 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:K,children:M.size===Object.keys(w).length?"":""})}),Object.keys(w).length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:""}):Object.entries(w).map(([O,k])=>e.jsxs("div",{className:"space-y-2 p-2 rounded hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:`task-${O}`,checked:M.has(O),onCheckedChange:()=>z(O)}),e.jsx(E,{htmlFor:`task-${O}`,className:"flex-1 cursor-pointer",children:e.jsx("span",{className:"font-medium",children:gS[O]||O})}),e.jsxs(Se,{variant:"outline",className:"text-xs",children:[k.model_list.length," "]})]}),k.model_list&&k.model_list.length>0&&e.jsx("div",{className:"ml-6 flex flex-wrap gap-1",children:k.model_list.map(H=>{const se=v.find(Z=>Z.name===H),Ee=S.has(H);return e.jsxs(Se,{variant:Ee?"default":"outline",className:"text-xs cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>je(H),children:[H,se&&e.jsxs("span",{className:"ml-1 opacity-70",children:["(",se.api_provider,")"]})]},H)})})]},O))]})})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm p-3 bg-muted rounded-lg",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Dl,{className:"w-4 h-4"}),R.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Gn,{className:"w-4 h-4"}),S.size," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Vn,{className:"w-4 h-4"}),M.size," "]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"pack-name",children:" *"}),e.jsx(le,{id:"pack-name",placeholder:"",value:A,onChange:O=>F(O.target.value),maxLength:50}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[A.length,"/50"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"pack-description",children:" *"}),e.jsx(ot,{id:"pack-description",placeholder:"...",value:L,onChange:O=>J(O.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[L.length,"/500"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"pack-author",children:" *"}),e.jsx(le,{id:"pack-author",placeholder:" ID",value:U,onChange:O=>ue(O.target.value),maxLength:30})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:" 5 "}),e.jsx("div",{className:"flex flex-wrap gap-2",children:jS.map(O=>e.jsxs(Se,{variant:xe.includes(O)?"default":"outline",className:"cursor-pointer transition-colors",onClick:()=>V(O),children:[xe.includes(O)&&e.jsx(Ct,{className:"w-3 h-3 mr-1"}),e.jsx(Xo,{className:"w-3 h-3 mr-1"}),O]},O))})]})]}),e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Hn,{children:""}),e.jsx(lt,{children:" 1-3 "})]})]})]})}),e.jsxs(st,{className:"flex justify-between pt-4 border-t",children:[e.jsx("div",{children:c>1&&e.jsx(_,{variant:"outline",onClick:()=>u(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>{i(!1),pe()},disabled:f,children:""}),c<ke?e.jsx(_,{onClick:()=>u(c+1),disabled:x||R.size===0&&S.size===0&&M.size===0,children:""}):e.jsxs(_,{onClick:_e,disabled:f,children:[f&&e.jsx(Bs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})]})}function NS({value:l,label:n,onRemove:i}){const{attributes:c,listeners:u,setNodeRef:x,transform:h,transition:f,isDragging:p}=Wj({id:l}),g={transform:ev.Transform.toString(h),transition:f,opacity:p?.5:1},N=y=>{y.preventDefault(),y.stopPropagation(),i(l)},v=y=>{y.stopPropagation()};return e.jsx("div",{ref:x,style:g,className:I("inline-flex items-center gap-1",p&&"shadow-lg"),children:e.jsxs(Se,{variant:"secondary",className:"cursor-move hover:bg-secondary/80 flex items-center gap-1",children:[e.jsx("div",{...c,...u,className:"cursor-grab active:cursor-grabbing flex items-center",children:e.jsx(Rj,{className:"h-3 w-3 text-muted-foreground"})}),e.jsx("span",{children:n}),e.jsx("span",{role:"button",tabIndex:0,className:"ml-1 rounded-sm hover:bg-destructive/20 focus:outline-none focus:ring-1 focus:ring-destructive cursor-pointer",onClick:N,onPointerDown:v,onMouseDown:y=>y.stopPropagation(),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),N(y))},children:e.jsx(Ea,{className:"h-3 w-3 hover:text-destructive",strokeWidth:2,fill:"none"})})]})})}function bS({options:l,selected:n,onChange:i,placeholder:c="...",emptyText:u="",className:x}){const[h,f]=d.useState(!1),p=Vj(Bo(Qj,{activationConstraint:{distance:8}}),Bo(Kj,{coordinateGetter:qj})),g=y=>{n.includes(y)?i(n.filter(w=>w!==y)):i([...n,y])},N=y=>{i(n.filter(w=>w!==y))},v=y=>{const{active:w,over:b}=y;if(b&&w.id!==b.id){const R=n.indexOf(w.id),D=n.indexOf(b.id);i(Yj(n,R,D))}};return e.jsxs(ol,{open:h,onOpenChange:f,children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":h,className:I("w-full justify-between min-h-10 h-auto",x),children:[e.jsx(Jj,{sensors:p,collisionDetection:Xj,onDragEnd:v,children:e.jsx(Zj,{items:n,strategy:O_,children:e.jsx("div",{className:"flex gap-1 flex-wrap flex-1",children:n.length===0?e.jsx("span",{className:"text-muted-foreground",children:c}):n.map(y=>{const w=l.find(b=>b.value===y);return e.jsx(NS,{value:y,label:w?.label||y,onRemove:N},y)})})})}),e.jsx(Ym,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:2,fill:"none"})]})}),e.jsx(Wa,{className:"w-full p-0",align:"start",children:e.jsxs(sd,{children:[e.jsx(td,{placeholder:"...",className:"h-9"}),e.jsxs(ad,{children:[e.jsx(ld,{children:u}),e.jsx(ac,{children:l.map(y=>{const w=n.includes(y.value);return e.jsxs(lc,{value:y.value,onSelect:()=>g(y.value),children:[e.jsx("div",{className:I("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",w?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Ct,{className:"h-3 w-3",strokeWidth:2,fill:"none"})}),e.jsx("span",{children:y.label})]},y.value)})})]})]})})]})}const Ml=As.memo(function({title:n,description:i,taskConfig:c,modelNames:u,onChange:x,hideTemperature:h=!1,hideMaxTokens:f=!1,dataTour:p}){const g=N=>{x("model_list",N)};return e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-base sm:text-lg",children:n}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:i})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":p,children:[e.jsx(E,{children:""}),e.jsx(bS,{options:u.map(N=>({label:N,value:N})),selected:c.model_list||[],onChange:g,placeholder:"...",emptyText:""})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!h&&e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:""}),e.jsx(le,{type:"number",step:"0.1",min:"0",max:"1",value:c.temperature??.3,onChange:N=>{const v=parseFloat(N.target.value);!isNaN(v)&&v>=0&&v<=1&&x("temperature",v)},className:"w-20 h-8 text-sm"})]}),e.jsx(qa,{value:[c.temperature??.3],onValueChange:N=>x("temperature",N[0]),min:0,max:1,step:.1,className:"w-full"})]}),!f&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:" Token"}),e.jsx(le,{type:"number",step:"1",min:"1",value:c.max_tokens??1024,onChange:N=>x("max_tokens",parseInt(N.target.value))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:" ()"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(le,{type:"number",step:"1",min:"1",value:c.slow_threshold??15,onChange:N=>{const v=parseInt(N.target.value);!isNaN(v)&&v>=1&&x("slow_threshold",v)},placeholder:"15"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:c.selection_strategy??"balance",onValueChange:N=>x("selection_strategy",N),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"balance",children:"balance"}),e.jsx(X,{value:"random",children:"random"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]})]})}),yS=As.memo(function({paginatedModels:n,allModels:i,onEdit:c,onDelete:u,isModelUsed:x,searchQuery:h}){return n.length===0?e.jsx("div",{className:"md:hidden text-center text-muted-foreground py-8 rounded-lg border bg-card",children:h?"":""}):e.jsx("div",{className:"md:hidden space-y-3",children:n.map((f,p)=>{const g=i.findIndex(v=>v===f),N=x(f.name);return e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:f.name}),e.jsx(Se,{variant:N?"default":"secondary",className:N?"bg-green-600 hover:bg-green-700":"",children:N?"":""})]}),e.jsx("p",{className:"text-xs text-muted-foreground break-all",title:f.model_identifier,children:f.model_identifier})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>c(f,g),children:[e.jsx(Fn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>u(g),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.api_provider})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsx("p",{className:"font-medium",children:f.temperature!=null?f.temperature:e.jsx("span",{className:"text-muted-foreground",children:""})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_in,"/M"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:""}),e.jsxs("p",{className:"font-medium",children:["",f.price_out,"/M"]})]})]})]},p)})})}),wS=As.memo(function({paginatedModels:n,allModels:i,filteredModels:c,selectedModels:u,onEdit:x,onDelete:h,onToggleSelection:f,onToggleSelectAll:p,isModelUsed:g,searchQuery:N}){return e.jsx("div",{className:"hidden md:block rounded-lg border bg-card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(qs,{checked:u.size===c.length&&c.length>0,onCheckedChange:p})}),e.jsx(Ze,{className:"w-24",children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-center",children:""}),e.jsx(Ze,{className:"text-right",children:""}),e.jsx(Ze,{className:"text-right",children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Ul,{children:n.length===0?e.jsx(ut,{children:e.jsx(qe,{colSpan:9,className:"text-center text-muted-foreground py-8",children:N?"":""})}):n.map((v,y)=>{const w=i.findIndex(R=>R===v),b=g(v.name);return e.jsxs(ut,{children:[e.jsx(qe,{children:e.jsx(qs,{checked:u.has(w),onCheckedChange:()=>f(w)})}),e.jsx(qe,{children:e.jsx(Se,{variant:b?"default":"secondary",className:b?"bg-green-600 hover:bg-green-700":"",children:b?"":""})}),e.jsx(qe,{className:"font-medium",children:v.name}),e.jsx(qe,{className:"max-w-xs truncate",title:v.model_identifier,children:v.model_identifier}),e.jsx(qe,{children:v.api_provider}),e.jsx(qe,{className:"text-center",children:v.temperature!=null?v.temperature:e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(qe,{className:"text-right",children:["",v.price_in,"/M"]}),e.jsxs(qe,{className:"text-right",children:["",v.price_out,"/M"]}),e.jsx(qe,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>x(v,w),children:[e.jsx(Fn,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>h(w),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1",strokeWidth:2,fill:"none"}),""]})]})})]},y)})})]})})})}),_S=300*1e3,Cg=new Map,SS=[10,20,50,100],kS=As.memo(function({page:n,pageSize:i,totalItems:c,jumpToPage:u,onPageChange:x,onPageSizeChange:h,onJumpToPageChange:f,onJumpToPage:p,onSelectionClear:g}){const N=Math.ceil(c/i),v=w=>{h(parseInt(w)),x(1),g?.()},y=w=>{w.key==="Enter"&&p()};return c===0?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{htmlFor:"page-size-model",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:i.toString(),onValueChange:v,children:[e.jsx($e,{id:"page-size-model",className:"w-20",children:e.jsx(Pe,{})}),e.jsx(Be,{children:SS.map(w=>e.jsx(X,{value:w.toString(),children:w},w))})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",(n-1)*i+1," "," ",Math.min(n*i,c),"  ",c," "]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>x(1),disabled:n===1,className:"hidden sm:flex",children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>x(Math.max(1,n-1)),disabled:n===1,children:[e.jsx(Aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:u,onChange:w=>f(w.target.value),onKeyDown:y,placeholder:n.toString(),className:"w-16 h-8 text-center",min:1,max:N}),e.jsx(_,{variant:"outline",size:"sm",onClick:p,disabled:!u,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>x(n+1),disabled:n>=N,children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Zt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>x(N),disabled:n>=N,className:"hidden sm:flex",children:e.jsx(jn,{className:"h-4 w-4"})})]})]})});function CS(l){const{models:n,taskConfig:i,debounceMs:c=2e3,onSavingChange:u,onUnsavedChange:x}=l,h=d.useRef(null),f=d.useRef(null),p=d.useRef(!0),g=d.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),f.current&&(clearTimeout(f.current),f.current=null)},[]),N=d.useCallback(w=>{const b={model_identifier:w.model_identifier,name:w.name,api_provider:w.api_provider,price_in:w.price_in??0,price_out:w.price_out??0,force_stream_mode:w.force_stream_mode??!1,extra_params:w.extra_params??{}};return w.temperature!=null&&(b.temperature=w.temperature),w.max_tokens!=null&&(b.max_tokens=w.max_tokens),b},[]),v=d.useCallback(async w=>{try{u?.(!0);const b=w.map(N);await Bm("models",b),x?.(!1)}catch(b){console.error(":",b),x?.(!0)}finally{u?.(!1)}},[u,x,N]),y=d.useCallback(async w=>{try{u?.(!0),await Bm("model_task_config",w),x?.(!1)}catch(b){console.error(":",b),x?.(!0)}finally{u?.(!1)}},[u,x]);return d.useEffect(()=>{if(!p.current)return x?.(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{v(n)},c),()=>{h.current&&clearTimeout(h.current)}},[n,v,c,x]),d.useEffect(()=>{if(!(p.current||!i))return x?.(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{y(i)},c),()=>{f.current&&clearTimeout(f.current)}},[i,y,c,x]),d.useEffect(()=>()=>{g()},[g]),{clearTimers:g,initialLoadRef:p}}function TS(l={}){const{onCloseEditDialog:n}=l,i=ca(),{registerTour:c,startTour:u,state:x,goToStep:h}=ax(),f=d.useRef(x.stepIndex);return d.useEffect(()=>{c(il,Nv)},[c]),d.useEffect(()=>{if(x.activeTourId===il&&x.isRunning){const g=bv[x.stepIndex];g&&!window.location.pathname.endsWith(g.replace("/config/",""))&&i({to:g})}},[x.stepIndex,x.activeTourId,x.isRunning,i]),d.useEffect(()=>{if(x.activeTourId===il&&x.isRunning){const g=f.current,N=x.stepIndex;g>=12&&g<=17&&N<12&&n?.(),f.current=N}},[x.stepIndex,x.activeTourId,x.isRunning,n]),d.useEffect(()=>{if(x.activeTourId!==il||!x.isRunning)return;const g=N=>{const v=N.target,y=x.stepIndex;y===2&&v.closest('[data-tour="add-provider-button"]')?setTimeout(()=>h(3),300):y===9&&v.closest('[data-tour="provider-cancel-button"]')?setTimeout(()=>h(10),300):y===11&&v.closest('[data-tour="add-model-button"]')?setTimeout(()=>h(12),300):y===17&&v.closest('[data-tour="model-cancel-button"]')?setTimeout(()=>h(18),300):y===18&&v.closest('[data-tour="tasks-tab-trigger"]')&&setTimeout(()=>h(19),300)};return document.addEventListener("click",g,!0),()=>document.removeEventListener("click",g,!0)},[x,h]),{startTour:d.useCallback(()=>{u(il)},[u]),isRunning:x.isRunning&&x.activeTourId===il,stepIndex:x.stepIndex}}function ES(l){const{getProviderConfig:n}=l,[i,c]=d.useState([]),[u,x]=d.useState(!1),[h,f]=d.useState(null),[p,g]=d.useState(null),N=d.useCallback(()=>{c([]),f(null),g(null)},[]),v=d.useCallback(async(y,w=!1)=>{const b=n(y);if(!b?.base_url){c([]),g(null),f('""');return}if(!b.api_key){c([]),g(null),f(' API Key""');return}const R=aS(b.base_url);if(g(R),!R?.modelFetcher){c([]),f(null);return}const D=`${y}:${b.base_url}`,S=Cg.get(D);if(!w&&S&&Date.now()-S.timestamp<_S){c(S.models),f(null);return}x(!0),f(null);try{const P=await U2(y,R.modelFetcher.parser,R.modelFetcher.endpoint);c(P),Cg.set(D,{models:P,timestamp:Date.now()})}catch(P){console.error(":",P);const M=P.message||"";M.includes("")||M.includes("")||M.includes("API Key")?f('API Key ""'):M.includes("")?f(" API Key "):M.includes("timeout")||M.includes("")?f(""):M.includes("")?f(""):f(M),c([])}finally{x(!1)}},[n]);return{availableModels:i,fetchingModels:u,modelFetchError:h,matchedTemplate:p,fetchModelsForProvider:v,clearModels:N}}function MS(){return e.jsx(Yn,{children:e.jsx(zS,{})})}function zS(){const[l,n]=d.useState([]),[i,c]=d.useState([]),[u,x]=d.useState([]),[h,f]=d.useState([]),[p,g]=d.useState(null),[N,v]=d.useState(!0),[y,w]=d.useState(!1),[b,R]=d.useState(!1),[D,S]=d.useState(!1),[P,M]=d.useState(!1),[T,A]=d.useState(null),[F,L]=d.useState(null),[J,U]=d.useState(!1),[ue,xe]=d.useState(!1),[he,ne]=d.useState(null),[ve,je]=d.useState(""),[z,V]=d.useState(new Set),[B,oe]=d.useState(!1),[K,_e]=d.useState(1),[pe,ke]=d.useState(20),[O,k]=d.useState(""),[H,se]=d.useState(!1),[Ee,Z]=d.useState(!1),Oe=d.useRef([]),ns=d.useRef(null),[Q,ee]=d.useState([]),[Ue,ie]=d.useState([]),[Te,de]=d.useState({}),{toast:Me}=Zs(),{triggerRestart:rs,isRestarting:Ut}=vn(),{startTour:aa,isRunning:Qa}=TS({onCloseEditDialog:()=>M(!1)}),{clearTimers:Ft,initialLoadRef:mt}=CS({models:l,taskConfig:p,onSavingChange:R,onUnsavedChange:S}),q=d.useCallback((re,fe)=>{if(!re)return;const ss=new Set(fe.map(ja=>ja.name)),gs=[],is=[],jt=[{key:"utils",label:""},{key:"tool_use",label:""},{key:"replyer",label:""},{key:"planner",label:""},{key:"vlm",label:""},{key:"voice",label:""},{key:"embedding",label:""},{key:"lpmm_entity_extract",label:"LPMM"},{key:"lpmm_rdf_build",label:"LPMM"}];for(const{key:ja,label:Bl}of jt){const Zn=re[ja];if(!Zn)continue;if(!Zn.model_list||Zn.model_list.length===0){is.push(Bl);continue}const Jr=Zn.model_list.filter(bn=>!ss.has(bn));Jr.length>0&&gs.push({taskName:Bl,invalidModels:Jr})}ee(gs),ie(is)},[]),Ve=d.useCallback(async()=>{try{v(!0);const re=await un(),fe=re.models||[];n(fe),f(fe.map(jt=>jt.name));const ss=re.api_providers||[];c(ss.map(jt=>jt.name)),x(ss);const gs=re.model_task_config||null;g(gs),q(gs,fe);const is=gs?.embedding?.model_list||[];Oe.current=[...is],S(!1),mt.current=!1}catch(re){console.error(":",re)}finally{v(!1)}},[mt,q]);d.useEffect(()=>{Ve()},[Ve]);const Ke=d.useCallback(re=>u.find(fe=>fe.name===re),[u]),{availableModels:We,fetchingModels:Ls,modelFetchError:ts,matchedTemplate:Cs,fetchModelsForProvider:ze,clearModels:Ns}=ES({getProviderConfig:Ke});d.useEffect(()=>{P&&T?.api_provider&&ze(T.api_provider)},[P,T?.api_provider,ze]);const as=async()=>{await rs()},es=d.useCallback(()=>{if(!p)return;const re=new Set(l.map(gs=>gs.name)),fe={...p},ss=Object.keys(fe);for(const gs of ss){const is=fe[gs];is&&is.model_list&&(is.model_list=is.model_list.filter(jt=>re.has(jt)))}g(fe),ee([]),Me({title:"",description:""})},[p,l,Me]),bs=re=>{const fe={model_identifier:re.model_identifier,name:re.name,api_provider:re.api_provider,price_in:re.price_in??0,price_out:re.price_out??0,force_stream_mode:re.force_stream_mode??!1,extra_params:re.extra_params??{}};return re.temperature!=null&&(fe.temperature=re.temperature),re.max_tokens!=null&&(fe.max_tokens=re.max_tokens),fe},gt=async()=>{try{w(!0),Ft();const re=await un();re.models=l.map(bs),re.model_task_config=p,await Ji(re),S(!1),Me({title:"",description:"..."}),await as()}catch(re){console.error(":",re),Me({title:"",description:re.message,variant:"destructive"}),w(!1)}},$t=async()=>{try{w(!0),Ft();const re=await un();re.models=l.map(bs),re.model_task_config=p,await Ji(re),S(!1),Me({title:"",description:""}),await Ve()}catch(re){console.error(":",re),Me({title:"",description:re.message,variant:"destructive"})}finally{w(!1)}},tt=(re,fe)=>{de({}),A(re||{model_identifier:"",name:"",api_provider:i[0]||"",price_in:0,price_out:0,temperature:null,max_tokens:null,force_stream_mode:!1,extra_params:{}}),L(fe),M(!0)},Ms=()=>{if(!T)return;const re={};if(T.name?.trim()?l.some((jt,ja)=>F!==null&&ja===F?!1:jt.name.trim().toLowerCase()===T.name.trim().toLowerCase())&&(re.name=""):re.name="",T.api_provider?.trim()||(re.api_provider=" API "),T.model_identifier?.trim()||(re.model_identifier=""),Object.keys(re).length>0){de(re);return}de({});const fe={model_identifier:T.model_identifier,name:T.name,api_provider:T.api_provider,price_in:T.price_in??0,price_out:T.price_out??0,force_stream_mode:T.force_stream_mode??!1,extra_params:T.extra_params??{}};T.temperature!=null&&(fe.temperature=T.temperature),T.max_tokens!=null&&(fe.max_tokens=T.max_tokens);let ss,gs=null;if(F!==null?(gs=l[F].name,ss=[...l],ss[F]=fe):ss=[...l,fe],n(ss),f(ss.map(is=>is.name)),gs&&gs!==fe.name&&p){const is=jt=>jt.map(ja=>ja===gs?fe.name:ja);g({...p,utils:{...p.utils,model_list:is(p.utils?.model_list||[])},tool_use:{...p.tool_use,model_list:is(p.tool_use?.model_list||[])},replyer:{...p.replyer,model_list:is(p.replyer?.model_list||[])},planner:{...p.planner,model_list:is(p.planner?.model_list||[])},vlm:{...p.vlm,model_list:is(p.vlm?.model_list||[])},voice:{...p.voice,model_list:is(p.voice?.model_list||[])},embedding:{...p.embedding,model_list:is(p.embedding?.model_list||[])},lpmm_entity_extract:{...p.lpmm_entity_extract,model_list:is(p.lpmm_entity_extract?.model_list||[])},lpmm_rdf_build:{...p.lpmm_rdf_build,model_list:is(p.lpmm_rdf_build?.model_list||[])}})}M(!1),A(null),L(null),Me({title:F!==null?"":"",description:' 2 ""'})},Et=re=>{if(!re&&T){const fe={...T,price_in:T.price_in??0,price_out:T.price_out??0};A(fe)}M(re)},Bt=re=>{ne(re),xe(!0)},Oa=()=>{if(he!==null){const re=l.filter((fe,ss)=>ss!==he);n(re),f(re.map(fe=>fe.name)),q(p,re),Me({title:"",description:' 2 ""'})}xe(!1),ne(null)},tl=re=>{const fe=new Set(z);fe.has(re)?fe.delete(re):fe.add(re),V(fe)},ul=()=>{if(z.size===Dt.length)V(new Set);else{const re=Dt.map((fe,ss)=>l.findIndex(gs=>gs===Dt[ss]));V(new Set(re))}},Xn=()=>{if(z.size===0){Me({title:"",description:"",variant:"default"});return}oe(!0)},W=()=>{const re=z.size,fe=l.filter((ss,gs)=>!z.has(gs));n(fe),f(fe.map(ss=>ss.name)),q(p,fe),V(new Set),oe(!1),Me({title:"",description:` ${re}  2 `})},ye=(re,fe,ss)=>{if(!p)return;if(re==="embedding"&&fe==="model_list"&&Array.isArray(ss)){const is=Oe.current,jt=ss;if((is.length!==jt.length||is.some(Bl=>!jt.includes(Bl))||jt.some(Bl=>!is.includes(Bl)))&&is.length>0){ns.current={field:fe,value:ss},Z(!0);return}}const gs={...p,[re]:{...p[re],[fe]:ss}};g(gs),q(gs,l),re==="embedding"&&fe==="model_list"&&Array.isArray(ss)&&(Oe.current=[...ss])},Re=()=>{if(!p||!ns.current)return;const{field:re,value:fe}=ns.current,ss={...p,embedding:{...p.embedding,[re]:fe}};g(ss),q(ss,l),re==="model_list"&&Array.isArray(fe)&&(Oe.current=[...fe]),ns.current=null,Z(!1),Me({title:"",description:""})},Hs=()=>{ns.current=null,Z(!1)},Dt=l.filter(re=>{if(!ve)return!0;const fe=ve.toLowerCase();return re.name.toLowerCase().includes(fe)||re.model_identifier.toLowerCase().includes(fe)||re.api_provider.toLowerCase().includes(fe)}),Wt=Math.ceil(Dt.length/pe),rt=Dt.slice((K-1)*pe,K*pe),ea=()=>{const re=parseInt(O);re>=1&&re<=Wt&&(_e(re),k(""))},xt=re=>p?[p.utils?.model_list||[],p.tool_use?.model_list||[],p.replyer?.model_list||[],p.planner?.model_list||[],p.vlm?.model_list||[],p.voice?.model_list||[],p.embedding?.model_list||[],p.lpmm_entity_extract?.model_list||[],p.lpmm_rdf_build?.model_list||[]].some(ss=>ss.includes(re)):!1;return N?e.jsx(Ye,{className:"h-full",children:e.jsx("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"..."})})})}):e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(vS,{trigger:e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx($j,{className:"mr-2 h-4 w-4"}),""]})}),e.jsxs(_,{onClick:$t,disabled:y||b||!D||Ut,size:"sm",variant:"outline",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(oc,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),y?"...":b?"...":D?"":""]}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs(_,{disabled:y||b||Ut,size:"sm",className:"flex-1 sm:flex-none sm:min-w-[120px]",children:[e.jsx(cc,{className:"mr-2 h-4 w-4"}),Ut?"...":D?"":""]})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsx(hs,{asChild:!0,children:e.jsx("div",{children:e.jsx("p",{children:D?",":","})})})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:D?gt:as,children:D?"":""})]})]})]})]})]}),e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsxs(lt,{children:["",e.jsx("strong",{children:""}),'""']})]}),Q.length>0&&e.jsxs(at,{variant:"destructive",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsxs(lt,{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:Q.map(({taskName:re,invalidModels:fe})=>e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:re})," : ",fe.join(", ")]},re))})]}),e.jsx(_,{variant:"outline",size:"sm",className:"shrink-0 bg-background hover:bg-accent",onClick:es,children:""})]})]}),Ue.length>0&&e.jsxs(at,{variant:"default",className:"border-yellow-500/50 bg-yellow-500/10",children:[e.jsx(Jt,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(lt,{children:[e.jsx("strong",{className:"text-yellow-600",children:""}),e.jsxs("div",{className:"mt-2 text-sm",children:[Ue.join("")," "]})]})]}),e.jsxs(at,{className:"hidden lg:flex border-primary/30 bg-primary/5 cursor-pointer hover:bg-primary/10 transition-colors",onClick:aa,children:[e.jsx(Ww,{className:"h-4 w-4 text-primary"}),e.jsxs(lt,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[e.jsx("strong",{className:"text-primary",children:""}),""]}),e.jsx(_,{variant:"outline",size:"sm",className:"ml-4 shrink-0",children:""})]})]}),e.jsxs(ta,{defaultValue:"models",className:"w-full",children:[e.jsxs(Xt,{className:"grid w-full max-w-full sm:max-w-md grid-cols-2",children:[e.jsx(Je,{value:"models",children:""}),e.jsx(Je,{value:"tasks","data-tour":"tasks-tab-trigger",children:""})]}),e.jsxs(ys,{value:"models",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[z.size>0&&e.jsxs(_,{onClick:Xn,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ls,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"})," (",z.size,")"]}),e.jsxs(_,{onClick:()=>tt(null,null),size:"sm",variant:"outline",className:"w-full sm:w-auto","data-tour":"add-model-button",children:[e.jsx(et,{className:"mr-2 h-4 w-4",strokeWidth:2,fill:"none"}),""]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsxs("div",{className:"relative w-full sm:flex-1 sm:max-w-sm",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:ve,onChange:re=>je(re.target.value),className:"pl-9"})]}),ve&&e.jsxs("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[" ",Dt.length," "]})]}),e.jsx(yS,{paginatedModels:rt,allModels:l,onEdit:tt,onDelete:Bt,isModelUsed:xt,searchQuery:ve}),e.jsx(wS,{paginatedModels:rt,allModels:l,filteredModels:Dt,selectedModels:z,onEdit:tt,onDelete:Bt,onToggleSelection:tl,onToggleSelectAll:ul,isModelUsed:xt,searchQuery:ve}),e.jsx(kS,{page:K,pageSize:pe,totalItems:Dt.length,jumpToPage:O,onPageChange:_e,onPageSizeChange:ke,onJumpToPageChange:k,onJumpToPage:ea,onSelectionClear:()=>V(new Set)})]}),e.jsxs(ys,{value:"tasks",className:"space-y-6 mt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:""}),p&&e.jsxs("div",{className:"grid gap-4 sm:gap-6",children:[e.jsx(Ml,{title:" (utils)",description:"",taskConfig:p.utils,modelNames:h,onChange:(re,fe)=>ye("utils",re,fe),dataTour:"task-model-select"}),e.jsx(Ml,{title:" (tool_use)",description:"",taskConfig:p.tool_use,modelNames:h,onChange:(re,fe)=>ye("tool_use",re,fe)}),e.jsx(Ml,{title:" (replyer)",description:"",taskConfig:p.replyer,modelNames:h,onChange:(re,fe)=>ye("replyer",re,fe)}),e.jsx(Ml,{title:" (planner)",description:"",taskConfig:p.planner,modelNames:h,onChange:(re,fe)=>ye("planner",re,fe)}),e.jsx(Ml,{title:" (vlm)",description:"",taskConfig:p.vlm,modelNames:h,onChange:(re,fe)=>ye("vlm",re,fe),hideTemperature:!0}),e.jsx(Ml,{title:" (voice)",description:"",taskConfig:p.voice,modelNames:h,onChange:(re,fe)=>ye("voice",re,fe),hideTemperature:!0,hideMaxTokens:!0}),e.jsx(Ml,{title:" (embedding)",description:"",taskConfig:p.embedding,modelNames:h,onChange:(re,fe)=>ye("embedding",re,fe),hideTemperature:!0,hideMaxTokens:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"LPMM "}),e.jsx(Ml,{title:" (lpmm_entity_extract)",description:"",taskConfig:p.lpmm_entity_extract,modelNames:h,onChange:(re,fe)=>ye("lpmm_entity_extract",re,fe)}),e.jsx(Ml,{title:"RDF  (lpmm_rdf_build)",description:"",taskConfig:p.lpmm_rdf_build,modelNames:h,onChange:(re,fe)=>ye("lpmm_rdf_build",re,fe)})]})]})]})]}),e.jsx(Is,{open:P,onOpenChange:Et,children:e.jsxs(Os,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto","data-tour":"model-dialog",preventOutsideClose:Qa,children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:F!==null?"":""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2","data-tour":"model-name-input",children:[e.jsx(E,{htmlFor:"model_name",className:Te.name?"text-destructive":"",children:" *"}),e.jsx(le,{id:"model_name",value:T?.name||"",onChange:re=>{A(fe=>fe?{...fe,name:re.target.value}:null),Te.name&&de(fe=>({...fe,name:void 0}))},placeholder:": qwen3-30b",className:Te.name?"border-destructive focus-visible:ring-destructive":""}),Te.name?e.jsx("p",{className:"text-xs text-destructive",children:Te.name}):e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-provider-select",children:[e.jsx(E,{htmlFor:"api_provider",className:Te.api_provider?"text-destructive":"",children:"API  *"}),e.jsxs(Ie,{value:T?.api_provider||"",onValueChange:re=>{A(fe=>fe?{...fe,api_provider:re}:null),Ns(),Te.api_provider&&de(fe=>({...fe,api_provider:void 0}))},children:[e.jsx($e,{id:"api_provider",className:Te.api_provider?"border-destructive focus-visible:ring-destructive":"",children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:i.map(re=>e.jsx(X,{value:re,children:re},re))})]}),Te.api_provider&&e.jsx("p",{className:"text-xs text-destructive",children:Te.api_provider})]}),e.jsxs("div",{className:"grid gap-2","data-tour":"model-identifier-input",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{htmlFor:"model_identifier",className:Te.model_identifier?"text-destructive":"",children:" *"}),Cs?.modelFetcher&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{variant:"secondary",className:"text-xs",children:Cs.display_name}),e.jsx(_,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>T?.api_provider&&ze(T.api_provider,!0),disabled:Ls,children:Ls?e.jsx(Bs,{className:"h-3 w-3 animate-spin"}):e.jsx(dt,{className:"h-3 w-3"})})]})]}),Cs?.modelFetcher?e.jsxs(ol,{open:H,onOpenChange:se,children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",role:"combobox","aria-expanded":H,className:"w-full justify-between font-normal",disabled:Ls||!!ts,children:[Ls?e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Bs,{className:"h-4 w-4 animate-spin"}),"..."]}):ts?e.jsx("span",{className:"text-muted-foreground text-sm",children:""}):T?.model_identifier?e.jsx("span",{className:"truncate",children:T.model_identifier}):e.jsx("span",{className:"text-muted-foreground",children:"..."}),e.jsx(Ym,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Wa,{className:"p-0",align:"start",style:{width:"var(--radix-popover-trigger-width)"},children:e.jsxs(sd,{children:[e.jsx(td,{placeholder:"..."}),e.jsx(Ye,{className:"h-[300px]",children:e.jsxs(ad,{className:"max-h-none overflow-visible",children:[e.jsx(ld,{children:ts?e.jsxs("div",{className:"py-4 px-2 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-destructive",children:ts}),!ts.includes("API Key")&&e.jsx(_,{variant:"link",size:"sm",onClick:()=>T?.api_provider&&ze(T.api_provider,!0),children:""})]}):""}),e.jsx(ac,{heading:"",children:We.map(re=>e.jsxs(lc,{value:re.id,onSelect:()=>{A(fe=>fe?{...fe,model_identifier:re.id}:null),se(!1)},children:[e.jsx(Ct,{className:`mr-2 h-4 w-4 ${T?.model_identifier===re.id?"opacity-100":"opacity-0"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:re.id}),re.name!==re.id&&e.jsx("span",{className:"text-xs text-muted-foreground",children:re.name})]})]},re.id))}),e.jsx(ac,{heading:"",children:e.jsxs(lc,{value:"__manual_input__",onSelect:()=>{se(!1)},children:[e.jsx(Fn,{className:"mr-2 h-4 w-4"}),"..."]})})]})})]})})]}):e.jsx(le,{id:"model_identifier",value:T?.model_identifier||"",onChange:re=>{A(fe=>fe?{...fe,model_identifier:re.target.value}:null),Te.model_identifier&&de(fe=>({...fe,model_identifier:void 0}))},placeholder:"Qwen/Qwen3-30B-A3B-Instruct-2507",className:Te.model_identifier?"border-destructive focus-visible:ring-destructive":""}),Te.model_identifier&&e.jsx("p",{className:"text-xs text-destructive",children:Te.model_identifier}),ts&&Cs?.modelFetcher&&!Te.model_identifier&&e.jsxs(at,{variant:"destructive",className:"mt-2 py-2",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(lt,{className:"text-xs",children:ts})]}),Cs?.modelFetcher&&e.jsx(le,{value:T?.model_identifier||"",onChange:re=>{A(fe=>fe?{...fe,model_identifier:re.target.value}:null),Te.model_identifier&&de(fe=>({...fe,model_identifier:void 0}))},placeholder:"",className:`mt-2 ${Te.model_identifier?"border-destructive focus-visible:ring-destructive":""}`}),!Te.model_identifier&&e.jsx("p",{className:"text-xs text-muted-foreground",children:ts?'"" API Key':Cs?.modelFetcher?` ${Cs.display_name}`:"API  ID"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"price_in",children:" (/M token)"}),e.jsx(le,{id:"price_in",type:"number",step:"0.1",min:"0",value:T?.price_in??"",onChange:re=>{const fe=re.target.value===""?null:parseFloat(re.target.value);A(ss=>ss?{...ss,price_in:fe}:null)},placeholder:": 0"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"price_out",children:" (/M token)"}),e.jsx(le,{id:"price_out",type:"number",step:"0.1",min:"0",value:T?.price_out??"",onChange:re=>{const fe=re.target.value===""?null:parseFloat(re.target.value);A(ss=>ss?{...ss,price_out:fe}:null)},placeholder:": 0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{htmlFor:"enable_model_temperature",className:"cursor-pointer",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"enable_model_temperature",checked:T?.temperature!=null,onCheckedChange:re=>{A(re?fe=>fe?{...fe,temperature:.5}:null:fe=>fe?{...fe,temperature:null}:null)}})]}),T?.temperature!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-sm",children:""}),e.jsx("span",{className:"text-sm font-medium tabular-nums",children:T.temperature.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"0"}),e.jsx(qa,{value:[T.temperature],onValueChange:re=>A(fe=>fe?{...fe,temperature:re[0]}:null),min:0,max:1,step:.1,className:"flex-1"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"1"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"0.1-0.30.7-1.0"})]})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{htmlFor:"enable_model_max_tokens",className:"cursor-pointer",children:" Token"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Token "})]}),e.jsx(Fe,{id:"enable_model_max_tokens",checked:T?.max_tokens!=null,onCheckedChange:re=>{A(re?fe=>fe?{...fe,max_tokens:2048}:null:fe=>fe?{...fe,max_tokens:null}:null)}})]}),T?.max_tokens!=null&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-sm",children:" Token "}),e.jsx(le,{type:"number",min:"1",max:"128000",value:T.max_tokens,onChange:re=>{const fe=parseInt(re.target.value);!isNaN(fe)&&fe>=1&&A(ss=>ss?{...ss,max_tokens:fe}:null)},className:"w-28 h-8 text-sm"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" token "})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"force_stream_mode",checked:T?.force_stream_mode||!1,onCheckedChange:re=>A(fe=>fe?{...fe,force_stream_mode:re}:null)}),e.jsx(E,{htmlFor:"force_stream_mode",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(_,{type:"button",variant:"outline",size:"sm",className:"flex-1 justify-start h-9",onClick:()=>U(!0),children:[e.jsx(pn,{className:"h-4 w-4 mr-2"}),Object.keys(T?.extra_params||{}).length>0?e.jsxs("span",{children:[" ",Object.keys(T?.extra_params||{}).length," "]}):e.jsx("span",{className:"text-muted-foreground",children:""})]})}),Object.keys(T?.extra_params||{}).length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:[Object.keys(T?.extra_params||{}).slice(0,3).map(re=>e.jsx("span",{className:"inline-block mr-2",children:e.jsx("code",{className:"px-1.5 py-0.5 bg-muted rounded",children:re})},re)),Object.keys(T?.extra_params||{}).length>3&&e.jsx("span",{children:"..."})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>M(!1),"data-tour":"model-cancel-button",children:""}),e.jsx(_,{onClick:Ms,"data-tour":"model-save-button",children:""})]})]})}),e.jsx(vs,{open:ue,onOpenChange:xe,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',he!==null?l[he]?.name:"",'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:Oa,children:""})]})]})}),e.jsx(vs,{open:B,onOpenChange:oe,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",z.size,"  "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:W,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:Ee,onOpenChange:Z,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsxs(xs,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-amber-500"}),""]}),e.jsx(hs,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-foreground",children:""}),""]}),e.jsxs("ul",{className:"space-y-2 ml-4 list-disc text-muted-foreground",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"text-foreground font-medium",children:""})]})})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:Hs,children:""}),e.jsx(fs,{onClick:Re,className:"bg-amber-600 hover:bg-amber-700",children:""})]})]})}),e.jsx(oS,{open:J,onOpenChange:U,value:T?.extra_params||{},onChange:re=>A(fe=>fe?{...fe,extra_params:re}:null)}),e.jsx(Jn,{})]})})}const nc=tj,rc=Q0,ic=Y0,nd="/api/webui/config";async function AS(){const n=await(await we(`${nd}/adapter-config/path`)).json();return!n.success||!n.path?null:{path:n.path,lastModified:n.lastModified}}async function Tg(l){const i=await(await we(`${nd}/adapter-config/path`,{method:"POST",headers:Fs(),body:JSON.stringify({path:l})})).json();if(!i.success)throw new Error(i.message||"")}async function Eg(l){const i=await(await we(`${nd}/adapter-config?path=${encodeURIComponent(l)}`)).json();if(!i.success)throw new Error("");return i.content}async function Mg(l,n){const c=await(await we(`${nd}/adapter-config`,{method:"POST",headers:Fs(),body:JSON.stringify({path:l,content:n})})).json();if(!c.success)throw new Error(c.message||"")}const bt={inner:{version:"0.1.2"},nickname:{nickname:""},napcat_server:{host:"localhost",port:8095,token:"",heartbeat_interval:30},maibot_server:{host:"localhost",port:8e3},chat:{group_list_type:"whitelist",group_list:[],private_list_type:"whitelist",private_list:[],ban_user_id:[],ban_qq_bot:!1,enable_poke:!0},voice:{use_tts:!1},debug:{level:"INFO"}},Mm={oneclick:{name:"",description:"",path:"../MaiBot-Napcat-Adapter/config.toml",icon:ra},docker:{name:"Docker",description:"Docker Compose ",path:"/MaiMBot/adapters-config/config.toml",icon:e_}};function OS(l,n){let i=l.slice(0,n).split(/\r\n|\n|\r/g);return[i.length,i.pop().length+1]}function DS(l,n,i){let c=l.split(/\r\n|\n|\r/g),u="",x=(Math.log10(n+1)|0)+1;for(let h=n-1;h<=n+1;h++){let f=c[h-1];f&&(u+=h.toString().padEnd(x," "),u+=":  ",u+=f,u+=`
`,h===n&&(u+=" ".repeat(x+i+2),u+=`^
`))}return u}class ks extends Error{line;column;codeblock;constructor(n,i){const[c,u]=OS(i.toml,i.ptr),x=DS(i.toml,c,u);super(`Invalid TOML document: ${n}

${x}`,i),this.line=c,this.column=u,this.codeblock=x}}function RS(l,n){let i=0;for(;l[n-++i]==="\\";);return--i&&i%2}function Ho(l,n=0,i=l.length){let c=l.indexOf(`
`,n);return l[c-1]==="\r"&&c--,c<=i?c:-1}function lx(l,n){for(let i=n;i<l.length;i++){let c=l[i];if(c===`
`)return i;if(c==="\r"&&l[i+1]===`
`)return i+1;if(c<" "&&c!=="	"||c==="")throw new ks("control characters are not allowed in comments",{toml:l,ptr:n})}return l.length}function Ol(l,n,i,c){let u;for(;(u=l[n])===" "||u==="	"||!i&&(u===`
`||u==="\r"&&l[n+1]===`
`);)n++;return c||u!=="#"?n:Ol(l,lx(l,n),i)}function zg(l,n,i,c,u=!1){if(!c)return n=Ho(l,n),n<0?l.length:n;for(let x=n;x<l.length;x++){let h=l[x];if(h==="#")x=Ho(l,x);else{if(h===i)return x+1;if(h===c||u&&(h===`
`||h==="\r"&&l[x+1]===`
`))return x}}throw new ks("cannot find end of structure",{toml:l,ptr:n})}function kv(l,n){let i=l[n],c=i===l[n+1]&&l[n+1]===l[n+2]?l.slice(n,n+3):i;n+=c.length-1;do n=l.indexOf(c,++n);while(n>-1&&i!=="'"&&RS(l,n));return n>-1&&(n+=c.length,c.length>1&&(l[n]===i&&n++,l[n]===i&&n++)),n}let LS=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i;class Pr extends Date{#s=!1;#t=!1;#e=null;constructor(n){let i=!0,c=!0,u="Z";if(typeof n=="string"){let x=n.match(LS);x?(x[1]||(i=!1,n=`0000-01-01T${n}`),c=!!x[2],c&&n[10]===" "&&(n=n.replace(" ","T")),x[2]&&+x[2]>23?n="":(u=x[3]||null,n=n.toUpperCase(),!u&&c&&(n+="Z"))):n=""}super(n),isNaN(this.getTime())||(this.#s=i,this.#t=c,this.#e=u)}isDateTime(){return this.#s&&this.#t}isLocal(){return!this.#s||!this.#t||!this.#e}isDate(){return this.#s&&!this.#t}isTime(){return this.#t&&!this.#s}isValid(){return this.#s||this.#t}toISOString(){let n=super.toISOString();if(this.isDate())return n.slice(0,10);if(this.isTime())return n.slice(11,23);if(this.#e===null)return n.slice(0,-1);if(this.#e==="Z")return n;let i=+this.#e.slice(1,3)*60+ +this.#e.slice(4,6);return i=this.#e[0]==="-"?i:-i,new Date(this.getTime()-i*6e4).toISOString().slice(0,-1)+this.#e}static wrapAsOffsetDateTime(n,i="Z"){let c=new Pr(n);return c.#e=i,c}static wrapAsLocalDateTime(n){let i=new Pr(n);return i.#e=null,i}static wrapAsLocalDate(n){let i=new Pr(n);return i.#t=!1,i.#e=null,i}static wrapAsLocalTime(n){let i=new Pr(n);return i.#s=!1,i.#e=null,i}}let US=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,$S=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,BS=/^[+-]?0[0-9_]/,IS=/^[0-9a-f]{4,8}$/i,Ag={b:"\b",t:"	",n:`
`,f:"\f",r:"\r",'"':'"',"\\":"\\"};function Cv(l,n=0,i=l.length){let c=l[n]==="'",u=l[n++]===l[n]&&l[n]===l[n+1];u&&(i-=2,l[n+=2]==="\r"&&n++,l[n]===`
`&&n++);let x=0,h,f="",p=n;for(;n<i-1;){let g=l[n++];if(g===`
`||g==="\r"&&l[n]===`
`){if(!u)throw new ks("newlines are not allowed in strings",{toml:l,ptr:n-1})}else if(g<" "&&g!=="	"||g==="")throw new ks("control characters are not allowed in strings",{toml:l,ptr:n-1});if(h){if(h=!1,g==="u"||g==="U"){let N=l.slice(n,n+=g==="u"?4:8);if(!IS.test(N))throw new ks("invalid unicode escape",{toml:l,ptr:x});try{f+=String.fromCodePoint(parseInt(N,16))}catch{throw new ks("invalid unicode escape",{toml:l,ptr:x})}}else if(u&&(g===`
`||g===" "||g==="	"||g==="\r")){if(n=Ol(l,n-1,!0),l[n]!==`
`&&l[n]!=="\r")throw new ks("invalid escape: only line-ending whitespace may be escaped",{toml:l,ptr:x});n=Ol(l,n)}else if(g in Ag)f+=Ag[g];else throw new ks("unrecognized escape sequence",{toml:l,ptr:x});p=n}else!c&&g==="\\"&&(x=n-1,h=!0,f+=l.slice(p,x))}return f+l.slice(p,i-1)}function PS(l,n,i,c){if(l==="true")return!0;if(l==="false")return!1;if(l==="-inf")return-1/0;if(l==="inf"||l==="+inf")return 1/0;if(l==="nan"||l==="+nan"||l==="-nan")return NaN;if(l==="-0")return c?0n:0;let u=US.test(l);if(u||$S.test(l)){if(BS.test(l))throw new ks("leading zeroes are not allowed",{toml:n,ptr:i});l=l.replace(/_/g,"");let h=+l;if(isNaN(h))throw new ks("invalid number",{toml:n,ptr:i});if(u){if((u=!Number.isSafeInteger(h))&&!c)throw new ks("integer value cannot be represented losslessly",{toml:n,ptr:i});(u||c===!0)&&(h=BigInt(l))}return h}const x=new Pr(l);if(!x.isValid())throw new ks("invalid value",{toml:n,ptr:i});return x}function HS(l,n,i,c){let u=l.slice(n,i),x=u.indexOf("#");x>-1&&(lx(l,x),u=u.slice(0,x));let h=u.trimEnd();if(!c){let f=u.indexOf(`
`,h.length);if(f>-1)throw new ks("newlines are not allowed in inline tables",{toml:l,ptr:n+f})}return[h,x]}function nx(l,n,i,c,u){if(c===0)throw new ks("document contains excessively nested structures. aborting.",{toml:l,ptr:n});let x=l[n];if(x==="["||x==="{"){let[p,g]=x==="["?VS(l,n,c,u):GS(l,n,c,u),N=i?zg(l,g,",",i):g;if(g-N&&i==="}"){let v=Ho(l,g,N);if(v>-1)throw new ks("newlines are not allowed in inline tables",{toml:l,ptr:v})}return[p,N]}let h;if(x==='"'||x==="'"){h=kv(l,n);let p=Cv(l,n,h);if(i){if(h=Ol(l,h,i!=="]"),l[h]&&l[h]!==","&&l[h]!==i&&l[h]!==`
`&&l[h]!=="\r")throw new ks("unexpected character encountered",{toml:l,ptr:h});h+=+(l[h]===",")}return[p,h]}h=zg(l,n,",",i);let f=HS(l,n,h-+(l[h-1]===","),i==="]");if(!f[0])throw new ks("incomplete key-value declaration: no value specified",{toml:l,ptr:n});return i&&f[1]>-1&&(h=Ol(l,n+f[1]),h+=+(l[h]===",")),[PS(f[0],l,n,u),h]}let FS=/^[a-zA-Z0-9-_]+[ \t]*$/;function Hm(l,n,i="="){let c=n-1,u=[],x=l.indexOf(i,n);if(x<0)throw new ks("incomplete key-value: cannot find end of key",{toml:l,ptr:n});do{let h=l[n=++c];if(h!==" "&&h!=="	")if(h==='"'||h==="'"){if(h===l[n+1]&&h===l[n+2])throw new ks("multiline strings are not allowed in keys",{toml:l,ptr:n});let f=kv(l,n);if(f<0)throw new ks("unfinished string encountered",{toml:l,ptr:n});c=l.indexOf(".",f);let p=l.slice(f,c<0||c>x?x:c),g=Ho(p);if(g>-1)throw new ks("newlines are not allowed in keys",{toml:l,ptr:n+c+g});if(p.trimStart())throw new ks("found extra tokens after the string part",{toml:l,ptr:f});if(x<f&&(x=l.indexOf(i,f),x<0))throw new ks("incomplete key-value: cannot find end of key",{toml:l,ptr:n});u.push(Cv(l,n,f))}else{c=l.indexOf(".",n);let f=l.slice(n,c<0||c>x?x:c);if(!FS.test(f))throw new ks("only letter, numbers, dashes and underscores are allowed in keys",{toml:l,ptr:n});u.push(f.trimEnd())}}while(c+1&&c<x);return[u,Ol(l,x+1,!0,!0)]}function GS(l,n,i,c){let u={},x=new Set,h,f=0;for(n++;(h=l[n++])!=="}"&&h;){let p={toml:l,ptr:n-1};if(h===`
`)throw new ks("newlines are not allowed in inline tables",p);if(h==="#")throw new ks("inline tables cannot contain comments",p);if(h===",")throw new ks("expected key-value, found comma",p);if(h!==" "&&h!=="	"){let g,N=u,v=!1,[y,w]=Hm(l,n-1);for(let D=0;D<y.length;D++){if(D&&(N=v?N[g]:N[g]={}),g=y[D],(v=Object.hasOwn(N,g))&&(typeof N[g]!="object"||x.has(N[g])))throw new ks("trying to redefine an already defined value",{toml:l,ptr:n});!v&&g==="__proto__"&&Object.defineProperty(N,g,{enumerable:!0,configurable:!0,writable:!0})}if(v)throw new ks("trying to redefine an already defined value",{toml:l,ptr:n});let[b,R]=nx(l,w,"}",i-1,c);x.add(b),N[g]=b,n=R,f=l[n-1]===","?n-1:0}}if(f)throw new ks("trailing commas are not allowed in inline tables",{toml:l,ptr:f});if(!h)throw new ks("unfinished table encountered",{toml:l,ptr:n});return[u,n]}function VS(l,n,i,c){let u=[],x;for(n++;(x=l[n++])!=="]"&&x;){if(x===",")throw new ks("expected value, found comma",{toml:l,ptr:n-1});if(x==="#")n=lx(l,n);else if(x!==" "&&x!=="	"&&x!==`
`&&x!=="\r"){let h=nx(l,n-1,"]",i-1,c);u.push(h[0]),n=h[1]}}if(!x)throw new ks("unfinished array encountered",{toml:l,ptr:n});return[u,n]}function Og(l,n,i,c){let u=n,x=i,h,f=!1,p;for(let g=0;g<l.length;g++){if(g){if(u=f?u[h]:u[h]={},x=(p=x[h]).c,c===0&&(p.t===1||p.t===2))return null;if(p.t===2){let N=u.length-1;u=u[N],x=x[N].c}}if(h=l[g],(f=Object.hasOwn(u,h))&&x[h]?.t===0&&x[h]?.d)return null;f||(h==="__proto__"&&(Object.defineProperty(u,h,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(x,h,{enumerable:!0,configurable:!0,writable:!0})),x[h]={t:g<l.length-1&&c===2?3:c,d:!1,i:0,c:{}})}if(p=x[h],p.t!==c&&!(c===1&&p.t===3)||(c===2&&(p.d||(p.d=!0,u[h]=[]),u[h].push(u={}),p.c[p.i++]=p={t:1,d:!1,i:0,c:{}}),p.d))return null;if(p.d=!0,c===1)u=f?u[h]:u[h]={};else if(c===0&&f)return null;return[h,u,p.c]}function Tv(l,{maxDepth:n=1e3,integersAsBigInt:i}={}){let c={},u={},x=c,h=u;for(let f=Ol(l,0);f<l.length;){if(l[f]==="["){let p=l[++f]==="[",g=Hm(l,f+=+p,"]");if(p){if(l[g[1]-1]!=="]")throw new ks("expected end of table declaration",{toml:l,ptr:g[1]-1});g[1]++}let N=Og(g[0],c,u,p?2:1);if(!N)throw new ks("trying to redefine an already defined table or value",{toml:l,ptr:f});h=N[2],x=N[1],f=g[1]}else{let p=Hm(l,f),g=Og(p[0],x,h,0);if(!g)throw new ks("trying to redefine an already defined table or value",{toml:l,ptr:f});let N=nx(l,p[1],void 0,n,i);g[1][g[0]]=N[0],f=N[1]}if(f=Ol(l,f,!0),l[f]&&l[f]!==`
`&&l[f]!=="\r")throw new ks("each key-value declaration must be followed by an end-of-line",{toml:l,ptr:f});f=Ol(l,f)}return c}let Ev=/^[a-z0-9-_]+$/i;function dc(l){let n=typeof l;if(n==="object"){if(Array.isArray(l))return"array";if(l instanceof Date)return"date"}return n}function qS(l){for(let n=0;n<l.length;n++)if(dc(l[n])!=="object")return!1;return l.length!=0}function rx(l){return JSON.stringify(l).replace(/\x7f/g,"\\u007f")}function ix(l,n,i,c){if(i===0)throw new Error("Could not stringify the object: maximum object depth exceeded");if(n==="number")return isNaN(l)?"nan":l===1/0?"inf":l===-1/0?"-inf":c&&Number.isInteger(l)?l.toFixed(1):l.toString();if(n==="bigint"||n==="boolean")return l.toString();if(n==="string")return rx(l);if(n==="date"){if(isNaN(l.getTime()))throw new TypeError("cannot serialize invalid date");return l.toISOString()}if(n==="object")return KS(l,i,c);if(n==="array")return QS(l,i,c)}function KS(l,n,i){let c=Object.keys(l);if(c.length===0)return"{}";let u="{ ";for(let x=0;x<c.length;x++){let h=c[x];x&&(u+=", "),u+=Ev.test(h)?h:rx(h),u+=" = ",u+=ix(l[h],dc(l[h]),n-1,i)}return u+" }"}function QS(l,n,i){if(l.length===0)return"[]";let c="[ ";for(let u=0;u<l.length;u++){if(u&&(c+=", "),l[u]===null||l[u]===void 0)throw new TypeError("arrays cannot contain null or undefined values");c+=ix(l[u],dc(l[u]),n-1,i)}return c+" ]"}function YS(l,n,i,c){if(i===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let u="";for(let x=0;x<l.length;x++)u+=`${u&&`
`}[[${n}]]
`,u+=cx(0,l[x],n,i,c);return u}function cx(l,n,i,c,u){if(c===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let x="",h="",f=Object.keys(n);for(let p=0;p<f.length;p++){let g=f[p];if(n[g]!==null&&n[g]!==void 0){let N=dc(n[g]);if(N==="symbol"||N==="function")throw new TypeError(`cannot serialize values of type '${N}'`);let v=Ev.test(g)?g:rx(g);if(N==="array"&&qS(n[g]))h+=(h&&`
`)+YS(n[g],i?`${i}.${v}`:v,c-1,u);else if(N==="object"){let y=i?`${i}.${v}`:v;h+=(h&&`
`)+cx(y,n[g],y,c-1,u)}else x+=v,x+=" = ",x+=ix(n[g],N,c,u),x+=`
`}}return l&&(x||!h)&&(x=x?`[${l}]
${x}`:`[${l}]`),x&&h?`${x}
${h}`:x||h}function JS(l,{maxDepth:n=1e3,numbersAsFloat:i=!1}={}){if(dc(l)!=="object")throw new TypeError("stringify can only be called with an object");let c=cx(0,l,"",n,i);return c[c.length-1]!==`
`?c+`
`:c}function zm(l){try{const n=Tv(l);return{inner:{...bt.inner,...n.inner},nickname:{...bt.nickname,...n.nickname},napcat_server:{...bt.napcat_server,...n.napcat_server},maibot_server:{...bt.maibot_server,...n.maibot_server},chat:{...bt.chat,...n.chat},voice:{...bt.voice,...n.voice},debug:{...bt.debug,...n.debug}}}catch(n){throw console.error("TOML :",n),new Error(` TOML : ${n instanceof Error?n.message:""}`)}}function Am(l){try{const n=(u,x)=>u===""||u===null||u===void 0?x:u,i={inner:{version:n(l.inner.version,bt.inner.version)},nickname:{nickname:n(l.nickname.nickname,bt.nickname.nickname)},napcat_server:{host:n(l.napcat_server.host,bt.napcat_server.host),port:n(l.napcat_server.port||0,bt.napcat_server.port),token:n(l.napcat_server.token,bt.napcat_server.token),heartbeat_interval:n(l.napcat_server.heartbeat_interval||0,bt.napcat_server.heartbeat_interval)},maibot_server:{host:n(l.maibot_server.host,bt.maibot_server.host),port:n(l.maibot_server.port||0,bt.maibot_server.port)},chat:{group_list_type:n(l.chat.group_list_type,bt.chat.group_list_type),group_list:l.chat.group_list||[],private_list_type:n(l.chat.private_list_type,bt.chat.private_list_type),private_list:l.chat.private_list||[],ban_user_id:l.chat.ban_user_id||[],ban_qq_bot:l.chat.ban_qq_bot??bt.chat.ban_qq_bot,enable_poke:l.chat.enable_poke??bt.chat.enable_poke},voice:{use_tts:l.voice.use_tts??bt.voice.use_tts},debug:{level:n(l.debug.level,bt.debug.level)}};let c=JS(i);return c=XS(c),c}catch(n){throw console.error("TOML :",n),new Error(` TOML : ${n instanceof Error?n.message:""}`)}}function XS(l){const n=l.split(`
`),i=[];for(let c=0;c<n.length;c++){const u=n[c];if(u==="[inner]"){i.push(u);continue}if(u.startsWith("version = ")){i.push(`${u} # `),i.push("# ");continue}if(u==="[nickname]"){i.push("[nickname] # ");continue}if(u==="[napcat_server]"){i.push("[napcat_server] # Napcatws");continue}if(u.startsWith("host = ")&&i[i.length-1]?.includes("[napcat_server]")){i.push(`${u}      # Napcat`);continue}if(u.startsWith("port = ")&&n[c-1]?.includes("host")){i.push(`${u}             # Napcat`);continue}if(u.startsWith("token = ")){i.push(`${u}              # Napcat`);continue}if(u.startsWith("heartbeat_interval = ")){i.push(`${u} # Napcat`);continue}if(u==="[maibot_server]"){i.push("[maibot_server] # ws");continue}if(u.startsWith("host = ")&&i[i.length-1]?.includes("[maibot_server]")){i.push(`${u} # .envHOST`);continue}if(u.startsWith("port = ")&&i[i.length-1]?.includes(".env")){i.push(`${u}        # .envPORT`);continue}if(u==="[chat]"){i.push("[chat] # ");continue}if(u.startsWith("group_list_type = ")){i.push(`${u} # whitelist, blacklist`);continue}if(u.startsWith("group_list = ")){i.push(`${u}               # `),i.push("# group_list_typewhitelist"),i.push("# group_list_typeblacklist");continue}if(u.startsWith("private_list_type = ")){i.push(`${u} # whitelist, blacklist`);continue}if(u.startsWith("private_list = ")){i.push(`${u}               # `),i.push("# private_list_typewhitelist"),i.push("# private_list_typeblacklist");continue}if(u.startsWith("ban_user_id = ")){i.push(`${u}   # `);continue}if(u.startsWith("ban_qq_bot = ")){i.push(`${u} # QQ`);continue}if(u.startsWith("enable_poke = ")){i.push(`${u} # `);continue}if(u==="[voice]"){i.push("[voice] # ");continue}if(u.startsWith("use_tts = ")){i.push(`${u} # ttsttsadapter`);continue}if(u.startsWith("level = ")&&i[i.length-1]==="[debug]"){i.push(`${u} # DEBUG, INFO, WARNING, ERROR, CRITICAL`);continue}i.push(u)}return i.join(`
`)}function Om(l){if(!l.trim())return{valid:!1,error:""};if(!l.toLowerCase().endsWith(".toml"))return{valid:!1,error:" .toml "};const n=/^([a-zA-Z]:\\|\\\\[^\\]+\\[^\\]+\\).+\.toml$/i,i=/^(\/|~\/).+\.toml$/i,c=/^(\.{1,2}[\\/]|[^:\\/]).+\.toml$/i,u=n.test(l),x=i.test(l),h=c.test(l);return!u&&!x&&!h?{valid:!1,error:""}:/[<>"|?*\x00-\x1F]/.test(l)?{valid:!1,error:""}:{valid:!0,error:""}}function ZS(){const[l,n]=d.useState("upload"),[i,c]=d.useState(null),[u,x]=d.useState(""),[h,f]=d.useState(""),[p,g]=d.useState("oneclick"),[N,v]=d.useState(""),[y,w]=d.useState(!1),[b,R]=d.useState(!1),[D,S]=d.useState(!1),[P,M]=d.useState(!1),[T,A]=d.useState(null),[F,L]=d.useState(!1),J=d.useRef(null),{toast:U}=Zs(),ue=d.useRef(null),xe=H=>{if(f(H),H.trim()){const se=Om(H);v(se.error)}else v("")},he=d.useCallback(async H=>{const se=Mm[H];R(!0);try{const Ee=await Eg(se.path),Z=zm(Ee);c(Z),g(H),f(se.path),await Tg(se.path),U({title:"",description:`${se.name}`})}catch(Ee){console.error(":",Ee),U({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}finally{R(!1)}},[U]),ne=d.useCallback(async H=>{const se=Om(H);if(!se.valid){v(se.error),U({title:"",description:se.error,variant:"destructive"});return}v(""),R(!0);try{const Ee=await Eg(H),Z=zm(Ee);c(Z),f(H),await Tg(H),U({title:"",description:""})}catch(Ee){console.error(":",Ee),U({title:"",description:Ee instanceof Error?Ee.message:"",variant:"destructive"})}finally{R(!1)}},[U]);d.useEffect(()=>{(async()=>{try{const se=await AS();if(se&&se.path){f(se.path);const Ee=Object.entries(Mm).find(([,Z])=>Z.path===se.path);Ee?(n("preset"),g(Ee[0]),await he(Ee[0])):(n("path"),await ne(se.path))}}catch(se){console.error(":",se)}})()},[ne,he]);const ve=d.useCallback(H=>{l!=="path"&&l!=="preset"||!h||(ue.current&&clearTimeout(ue.current),ue.current=setTimeout(async()=>{w(!0);try{const se=Am(H);await Mg(h,se),U({title:"",description:""})}catch(se){console.error(":",se),U({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{w(!1)}},1e3))},[l,h,U]),je=async()=>{if(!i||!h)return;const H=Om(h);if(!H.valid){U({title:"",description:H.error,variant:"destructive"});return}w(!0);try{const se=Am(i);await Mg(h,se),U({title:"",description:""})}catch(se){console.error(":",se),U({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{w(!1)}},z=async()=>{h&&await ne(h)},V=H=>{if(H!==l){if(i){A(H),S(!0);return}B(H)}},B=H=>{c(null),x(""),v(""),n(H),H==="preset"&&he("oneclick"),U({title:"",description:{upload:"",path:"",preset:""}[H]})},oe=()=>{T&&(B(T),A(null)),S(!1)},K=()=>{if(i){M(!0);return}_e()},_e=()=>{f(""),c(null),v(""),U({title:"",description:""})},pe=()=>{_e(),M(!1)},ke=H=>{const se=H.target.files?.[0];if(!se)return;const Ee=new FileReader;Ee.onload=Z=>{try{const Oe=Z.target?.result,ns=zm(Oe);c(ns),x(se.name),U({title:"",description:`${se.name}`})}catch(Oe){console.error(":",Oe),U({title:"",description:"",variant:"destructive"})}},Ee.readAsText(se)},O=()=>{if(!i)return;const H=Am(i),se=new Blob([H],{type:"text/plain;charset=utf-8"}),Ee=URL.createObjectURL(se),Z=document.createElement("a");Z.href=Ee,Z.download=u||"config.toml",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(Ee),U({title:"",description:""})},k=()=>{c(JSON.parse(JSON.stringify(bt))),x("config.toml"),U({title:"",description:""})};return e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:" QQ "})]})}),e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg border border-amber-500/50 bg-amber-500/10 text-amber-700 dark:text-amber-400",children:[e.jsx(_t,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:" WebUI "})]}),e.jsx(nc,{open:F,onOpenChange:L,children:e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(rc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",size:"sm",className:"w-9 p-0",children:[e.jsx(za,{className:`h-4 w-4 transition-transform duration-200 ${F?"transform rotate-180":""}`}),e.jsx("span",{className:"sr-only",children:""})]})})]})}),e.jsx(ic,{children:e.jsxs(Ae,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${l==="preset"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>V("preset"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(ra,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${l==="upload"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>V("upload"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(ec,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-3 md:p-4 cursor-pointer transition-all ${l==="path"?"border-primary bg-primary/5":"border-muted hover:border-primary/50 active:border-primary/70"}`,onClick:()=>V("path"),children:e.jsxs("div",{className:"flex items-start gap-2 md:gap-3",children:[e.jsx(s_,{className:"h-4 w-4 md:h-5 md:w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-1 line-clamp-2",children:""})]})]})})]}),l==="preset"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(Mm).map(([H,se])=>{const Ee=se.icon,Z=p===H;return e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-all ${Z?"border-primary bg-primary/5":"border-muted hover:border-primary/50"}`,onClick:()=>{g(H),he(H)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ee,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:se.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:se.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 font-mono break-all",children:se.path})]})]})},H)})})]}),l==="path"&&e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"config-path",className:"text-sm md:text-base",children:""}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(le,{id:"config-path",value:h,onChange:H=>xe(H.target.value),placeholder:": C:\\Adapter\\config.toml",className:`text-sm ${N?"border-destructive":""}`}),N&&e.jsx("p",{className:"text-xs text-destructive",children:N})]}),e.jsx(_,{onClick:()=>ne(h),disabled:b||!h||!!N,className:"w-full sm:w-auto",children:b?e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sm:hidden",children:""}),e.jsx("span",{className:"hidden sm:inline",children:""})]})})]})]}),e.jsxs("details",{className:"rounded-lg bg-muted/50 p-3 group",children:[e.jsxs("summary",{className:"text-xs font-medium cursor-pointer select-none list-none flex items-center justify-between",children:[e.jsx("span",{children:""}),e.jsx("svg",{className:"h-4 w-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Windows"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"C:\\Adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"D:\\MaiBot\\adapter\\config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"\\\\server\\share\\config.toml"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-background px-1.5 py-0.5 rounded text-[10px] md:text-xs whitespace-nowrap",children:"Linux"})}),e.jsxs("div",{className:"pl-2 space-y-0.5 text-[10px] md:text-xs break-all",children:[e.jsx("div",{children:"/opt/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"/home/user/adapter/config.toml"}),e.jsx("div",{className:"hidden sm:block",children:"~/adapter/config.toml"})]})]}),e.jsx("p",{className:"pt-1 border-t text-[10px] md:text-xs",children:"  1 "})]})]})]})]})})]})}),e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(lt,{children:l==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]}):l==="upload"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""}),"      "]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:""})," 1 ",y&&" (...)"]})})]}),l==="upload"&&!i&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx("input",{ref:J,type:"file",accept:".toml",className:"hidden",onChange:ke}),e.jsxs(_,{onClick:()=>J.current?.click(),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(ec,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:k,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Ca,{className:"mr-2 h-4 w-4"}),""]})]}),l==="upload"&&i&&e.jsx("div",{className:"flex gap-2",children:e.jsxs(_,{onClick:O,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(sa,{className:"mr-2 h-4 w-4"}),""]})}),(l==="preset"||l==="path")&&i&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(_,{onClick:je,size:"sm",disabled:y||!!N,className:"w-full sm:w-auto",children:[e.jsx(oc,{className:"mr-2 h-4 w-4"}),y?"...":""]}),e.jsxs(_,{onClick:z,size:"sm",variant:"outline",disabled:b,className:"w-full sm:w-auto",children:[e.jsx(dt,{className:`mr-2 h-4 w-4 ${b?"animate-spin":""}`}),""]}),l==="path"&&e.jsxs(_,{onClick:K,size:"sm",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),""]})]}),i?e.jsxs(ta,{defaultValue:"napcat",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Xt,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:grid-cols-5",children:[e.jsxs(Je,{value:"napcat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Napcat "}),e.jsx("span",{className:"sm:hidden",children:"Napcat"})]}),e.jsxs(Je,{value:"maibot",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Je,{value:"chat",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs(Je,{value:"voice",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsx(Je,{value:"debug",className:"flex-shrink-0 text-xs sm:text-sm whitespace-nowrap",children:""})]})}),e.jsx(ys,{value:"napcat",className:"space-y-4",children:e.jsx(WS,{config:i,onChange:H=>{c(H),ve(H)}})}),e.jsx(ys,{value:"maibot",className:"space-y-4",children:e.jsx(e4,{config:i,onChange:H=>{c(H),ve(H)}})}),e.jsx(ys,{value:"chat",className:"space-y-4",children:e.jsx(s4,{config:i,onChange:H=>{c(H),ve(H)}})}),e.jsx(ys,{value:"voice",className:"space-y-4",children:e.jsx(t4,{config:i,onChange:H=>{c(H),ve(H)}})}),e.jsx(ys,{value:"debug",className:"space-y-4",children:e.jsx(a4,{config:i,onChange:H=>{c(H),ve(H)}})})]}):e.jsx("div",{className:"rounded-lg border bg-card p-6 md:p-12",children:e.jsxs("div",{className:"text-center space-y-3 md:space-y-4",children:[e.jsx(Ca,{className:"h-12 w-12 md:h-16 md:w-16 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold",children:""}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mt-2 px-4",children:l==="preset"?"":l==="upload"?"":""})]})]})}),e.jsx(vs,{open:D,onOpenChange:S,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-destructive font-medium",children:""})]})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>{S(!1),A(null)},children:""}),e.jsx(fs,{onClick:oe,children:""})]})]})}),e.jsx(vs,{open:P,onOpenChange:M,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:["",e.jsx("br",{}),e.jsx("span",{className:"text-muted-foreground text-sm",children:""})]})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>M(!1),children:""}),e.jsx(fs,{onClick:pe,className:"bg-destructive hover:bg-destructive/90",children:""})]})]})})]})})}function WS({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:"Napcat WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"napcat-host",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"napcat-host",value:l.napcat_server.host,onChange:i=>n({...l,napcat_server:{...l.napcat_server,host:i.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"napcat-port",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"napcat-port",type:"number",value:l.napcat_server.port||"",onChange:i=>n({...l,napcat_server:{...l.napcat_server,port:i.target.value?parseInt(i.target.value):0}}),placeholder:"8095",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat  8095"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"napcat-token",className:"text-sm md:text-base",children:"Token"}),e.jsx(le,{id:"napcat-token",type:"password",value:l.napcat_server.token,onChange:i=>n({...l,napcat_server:{...l.napcat_server,token:i.target.value}}),placeholder:"",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Napcat "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"napcat-heartbeat",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"napcat-heartbeat",type:"number",value:l.napcat_server.heartbeat_interval||"",onChange:i=>n({...l,napcat_server:{...l.napcat_server,heartbeat_interval:i.target.value?parseInt(i.target.value):0}}),placeholder:"30",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Napcat  30"})]})]})]})})}function e4({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:" WebSocket "}),e.jsxs("div",{className:"grid gap-3 md:gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"maibot-host",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"maibot-host",value:l.maibot_server.host,onChange:i=>n({...l,maibot_server:{...l.maibot_server,host:i.target.value}}),placeholder:"localhost",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  HOST "})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"maibot-port",className:"text-sm md:text-base",children:""}),e.jsx(le,{id:"maibot-port",type:"number",value:l.maibot_server.port||"",onChange:i=>n({...l,maibot_server:{...l.maibot_server,port:i.target.value?parseInt(i.target.value):0}}),placeholder:"8000",className:"text-sm md:text-base"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" .env  PORT  8000"})]})]})]})})}function s4({config:l,onChange:n}){const i=x=>{const h={...l};x==="group"?h.chat.group_list=[...h.chat.group_list,0]:x==="private"?h.chat.private_list=[...h.chat.private_list,0]:h.chat.ban_user_id=[...h.chat.ban_user_id,0],n(h)},c=(x,h)=>{const f={...l};x==="group"?f.chat.group_list=f.chat.group_list.filter((p,g)=>g!==h):x==="private"?f.chat.private_list=f.chat.private_list.filter((p,g)=>g!==h):f.chat.ban_user_id=f.chat.ban_user_id.filter((p,g)=>g!==h),n(f)},u=(x,h,f)=>{const p={...l};x==="group"?p.chat.group_list[h]=f:x==="private"?p.chat.private_list[h]=f:p.chat.ban_user_id[h]=f,n(p)};return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"grid gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:l.chat.group_list_type,onValueChange:x=>n({...l,chat:{...l.chat,group_list_type:x}}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"whitelist",children:""}),e.jsx(X,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>i("group"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ca,{className:"mr-1 h-4 w-4"}),""]})]}),l.chat.group_list.map((x,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{type:"number",value:x,onChange:f=>u("group",h,parseInt(f.target.value)||0),placeholder:"",className:"text-sm md:text-base"}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",x," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>c("group",h),children:""})]})]})]})]},h)),l.chat.group_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:l.chat.private_list_type,onValueChange:x=>n({...l,chat:{...l.chat,private_list_type:x}}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"whitelist",children:""}),e.jsx(X,{value:"blacklist",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsxs(_,{onClick:()=>i("private"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ca,{className:"mr-1 h-4 w-4"}),""]})]}),l.chat.private_list.map((x,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{type:"number",value:x,onChange:f=>u("private",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",x," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>c("private",h),children:""})]})]})]})]},h)),l.chat.private_list.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>i("ban"),size:"sm",variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ca,{className:"mr-1 h-4 w-4"}),""]})]}),l.chat.ban_user_id.map((x,h)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{type:"number",value:x,onChange:f=>u("ban",h,parseInt(f.target.value)||0),placeholder:"QQ",className:"text-sm md:text-base"}),e.jsxs(vs,{children:[e.jsx(wt,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",children:e.jsx(ls,{className:"h-4 w-4"})})}),e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",x," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>c("ban",h),children:""})]})]})]})]},h)),l.chat.ban_user_id.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-sm md:text-base",children:"QQ"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"QQ"})]}),e.jsx(Fe,{checked:l.chat.ban_qq_bot,onCheckedChange:x=>n({...l,chat:{...l.chat,ban_qq_bot:x}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsx(Fe,{checked:l.chat.enable_poke,onCheckedChange:x=>n({...l,chat:{...l.chat,enable_poke:x}})})]})]})]})})}function t4({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-sm md:text-base",children:" TTS "}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" TTS "})]}),e.jsx(Fe,{checked:l.voice.use_tts,onCheckedChange:i=>n({...l,voice:{use_tts:i}})})]})]})})}function a4({config:l,onChange:n}){return e.jsx("div",{className:"rounded-lg border bg-card p-4 md:p-6 space-y-4 md:space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4",children:""}),e.jsx("div",{className:"grid gap-3 md:gap-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{className:"text-sm md:text-base",children:""}),e.jsxs(Ie,{value:l.debug.level,onValueChange:i=>n({...l,debug:{level:i}}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"DEBUG",children:"DEBUG"}),e.jsx(X,{value:"INFO",children:"INFO"}),e.jsx(X,{value:"WARNING",children:"WARNING"}),e.jsx(X,{value:"ERROR",children:"ERROR"}),e.jsx(X,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})})]})})}const l4=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],n4=/^(aria-|data-)/,Mv=l=>Object.fromEntries(Object.entries(l).filter(([n])=>n4.test(n)||l4.includes(n)));function r4(l,n){const i=Mv(l);return Object.keys(l).some(c=>!Object.hasOwn(i,c)&&l[c]!==n[c])}class i4 extends d.Component{container;plugin;componentDidMount(){this.installPlugin()}componentDidUpdate(n){if(n.uppy!==this.props.uppy)this.uninstallPlugin(n),this.installPlugin();else if(r4(this.props,n)){const{uppy:i,...c}={...this.props,target:this.container};this.plugin.setOptions(c)}}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{uppy:n,...i}={id:"Dashboard",...this.props,inline:!0,target:this.container};n.use(L_,i),this.plugin=n.getPlugin(i.id)}uninstallPlugin(n=this.props){const{uppy:i}=n;i.removePlugin(this.plugin)}render(){return d.createElement("div",{className:"uppy-Container",ref:n=>{this.container=n},...Mv(this.props)})}}function c4({src:l,alt:n="",className:i,maxRetries:c=5,retryInterval:u=1500}){const[x,h]=d.useState("loading"),[f,p]=d.useState(0),[g,N]=d.useState(null),[v,y]=d.useState(l);l!==v&&(h("loading"),p(0),N(null),y(l));const w=d.useCallback(async()=>{try{const b=await fetch(l,{credentials:"include"});if(b.status===202){h("generating"),f<c?setTimeout(()=>{p(S=>S+1)},u):h("error");return}if(!b.ok){h("error");return}const R=await b.blob(),D=URL.createObjectURL(R);N(D),h("loaded")}catch(b){console.error(":",b),h("error")}},[l,f,c,u]);return d.useEffect(()=>{w()},[w]),d.useEffect(()=>()=>{g&&URL.revokeObjectURL(g)},[g]),x==="loading"||x==="generating"?e.jsx(js,{className:I("w-full h-full",i)}):x==="error"||!g?e.jsx("div",{className:I("w-full h-full flex items-center justify-center bg-muted",i),children:e.jsx(Jm,{className:"h-8 w-8 text-muted-foreground"})}):e.jsx("img",{src:g,alt:n,className:I("w-full h-full object-contain",i)})}function o4({children:l,className:n}){return e.jsx(tx,{content:l,className:n})}const Ka="/api/webui/emoji";async function d4(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.is_registered!==void 0&&n.append("is_registered",l.is_registered.toString()),l.is_banned!==void 0&&n.append("is_banned",l.is_banned.toString()),l.format&&n.append("format",l.format),l.sort_by&&n.append("sort_by",l.sort_by),l.sort_order&&n.append("sort_order",l.sort_order);const i=await we(`${Ka}/list?${n}`,{});if(!i.ok)throw new Error(`: ${i.statusText}`);return i.json()}async function u4(l){const n=await we(`${Ka}/${l}`,{});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function m4(l,n){const i=await we(`${Ka}/${l}`,{method:"PATCH",body:JSON.stringify(n)});if(!i.ok)throw new Error(`: ${i.statusText}`);return i.json()}async function x4(l){const n=await we(`${Ka}/${l}`,{method:"DELETE"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function h4(){const l=await we(`${Ka}/stats/summary`,{});if(!l.ok)throw new Error(`: ${l.statusText}`);return l.json()}async function f4(l){const n=await we(`${Ka}/${l}/register`,{method:"POST"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}async function p4(l){const n=await we(`${Ka}/${l}/ban`,{method:"POST"});if(!n.ok)throw new Error(`: ${n.statusText}`);return n.json()}function g4(l,n=!1){return n?`${Ka}/${l}/thumbnail?original=true`:`${Ka}/${l}/thumbnail`}function j4(l){return`${Ka}/${l}/thumbnail?original=true`}async function v4(l){const n=await we(`${Ka}/batch/delete`,{method:"POST",body:JSON.stringify({emoji_ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}function N4(){return`${Ka}/upload`}function b4(){const[l,n]=d.useState([]),[i,c]=d.useState(null),[u,x]=d.useState(!1),[h,f]=d.useState(1),[p,g]=d.useState(0),[N,v]=d.useState(20),[y,w]=d.useState("all"),[b,R]=d.useState("all"),[D,S]=d.useState("all"),[P,M]=d.useState("usage_count"),[T,A]=d.useState("desc"),[F,L]=d.useState(null),[J,U]=d.useState(!1),[ue,xe]=d.useState(!1),[he,ne]=d.useState(!1),[ve,je]=d.useState(new Set),[z,V]=d.useState(!1),[B,oe]=d.useState(""),[K,_e]=d.useState("medium"),[pe,ke]=d.useState(!1),{toast:O}=Zs(),k=d.useCallback(async()=>{try{x(!0);const de=await d4({page:h,page_size:N,is_registered:y==="all"?void 0:y==="registered",is_banned:b==="all"?void 0:b==="banned",format:D==="all"?void 0:D,sort_by:P,sort_order:T});n(de.data),g(de.total)}catch(de){const Me=de instanceof Error?de.message:"";O({title:"",description:Me,variant:"destructive"})}finally{x(!1)}},[h,N,y,b,D,P,T,O]),H=async()=>{try{const de=await h4();c(de.data)}catch(de){console.error(":",de)}};d.useEffect(()=>{k()},[k]),d.useEffect(()=>{H()},[]);const se=async de=>{try{const Me=await u4(de.id);L(Me.data),U(!0)}catch(Me){const rs=Me instanceof Error?Me.message:"";O({title:"",description:rs,variant:"destructive"})}},Ee=de=>{L(de),xe(!0)},Z=de=>{L(de),ne(!0)},Oe=async()=>{if(F)try{await x4(F.id),O({title:"",description:""}),ne(!1),L(null),k(),H()}catch(de){const Me=de instanceof Error?de.message:"";O({title:"",description:Me,variant:"destructive"})}},ns=async de=>{try{await f4(de.id),O({title:"",description:""}),k(),H()}catch(Me){const rs=Me instanceof Error?Me.message:"";O({title:"",description:rs,variant:"destructive"})}},Q=async de=>{try{await p4(de.id),O({title:"",description:""}),k(),H()}catch(Me){const rs=Me instanceof Error?Me.message:"";O({title:"",description:rs,variant:"destructive"})}},ee=de=>{const Me=new Set(ve);Me.has(de)?Me.delete(de):Me.add(de),je(Me)},Ue=async()=>{try{const de=await v4(Array.from(ve));O({title:"",description:de.message}),je(new Set),V(!1),k(),H()}catch(de){O({title:"",description:de instanceof Error?de.message:"",variant:"destructive"})}},ie=()=>{const de=parseInt(B),Me=Math.ceil(p/N);de>=1&&de<=Me?(f(de),oe("")):O({title:"",description:`1-${Me}`,variant:"destructive"})},Te=i?.formats?Object.keys(i.formats):[];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:""})]}),e.jsxs(_,{onClick:()=>ke(!0),className:"gap-2",children:[e.jsx(ec,{className:"h-4 w-4"}),""]})]}),e.jsx(Ye,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[i&&e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Le,{className:"text-2xl",children:i.total})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Le,{className:"text-2xl text-green-600",children:i.registered})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Le,{className:"text-2xl text-red-600",children:i.banned})]})}),e.jsx(Ce,{children:e.jsxs(De,{className:"pb-2",children:[e.jsx(ws,{children:""}),e.jsx(Le,{className:"text-2xl text-gray-600",children:i.unregistered})]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx(zo,{className:"h-5 w-5"}),""]})}),e.jsxs(Ae,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:`${P}-${T}`,onValueChange:de=>{const[Me,rs]=de.split("-");M(Me),A(rs),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"usage_count-desc",children:" ()"}),e.jsx(X,{value:"usage_count-asc",children:" ()"}),e.jsx(X,{value:"register_time-desc",children:" ()"}),e.jsx(X,{value:"register_time-asc",children:" ()"}),e.jsx(X,{value:"record_time-desc",children:" ()"}),e.jsx(X,{value:"record_time-asc",children:" ()"}),e.jsx(X,{value:"last_used_time-desc",children:" ()"}),e.jsx(X,{value:"last_used_time-asc",children:" ()"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:y,onValueChange:de=>{w(de),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),e.jsx(X,{value:"registered",children:""}),e.jsx(X,{value:"unregistered",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:b,onValueChange:de=>{R(de),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),e.jsx(X,{value:"banned",children:""}),e.jsx(X,{value:"unbanned",children:""})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:D,onValueChange:de=>{S(de),f(1)},children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),Te.map(de=>e.jsxs(X,{value:de,children:[de.toUpperCase()," (",i?.formats[de],")"]},de))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[ve.size>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",ve.size," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:K,onValueChange:de=>_e(de),children:[e.jsx($e,{className:"w-24",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"small",children:""}),e.jsx(X,{value:"medium",children:""}),e.jsx(X,{value:"large",children:""})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{htmlFor:"emoji-page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:N.toString(),onValueChange:de=>{v(parseInt(de)),f(1),je(new Set)},children:[e.jsx($e,{id:"emoji-page-size",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"20",children:"20"}),e.jsx(X,{value:"40",children:"40"}),e.jsx(X,{value:"60",children:"60"}),e.jsx(X,{value:"100",children:"100"})]})]}),ve.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>je(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>V(!0),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs(_,{variant:"outline",size:"sm",onClick:k,disabled:u,children:[e.jsx(dt,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),""]})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsxs(ws,{children:[" ",p,"  ",h," "]})]}),e.jsxs(Ae,{children:[l.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""}):e.jsx("div",{className:`grid gap-3 ${K==="small"?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10":K==="medium"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8":"grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"}`,children:l.map(de=>e.jsxs("div",{className:`group relative rounded-lg border bg-card overflow-hidden hover:ring-2 hover:ring-primary transition-all cursor-pointer ${ve.has(de.id)?"ring-2 ring-primary bg-primary/5":""}`,onClick:()=>ee(de.id),children:[e.jsx("div",{className:`absolute top-1 left-1 z-10 transition-opacity ${ve.has(de.id)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${ve.has(de.id)?"bg-primary border-primary text-primary-foreground":"bg-background/80 border-muted-foreground/50"}`,children:ve.has(de.id)&&e.jsx(pt,{className:"h-3 w-3"})})}),e.jsxs("div",{className:"absolute top-1 right-1 z-10 flex flex-col gap-0.5",children:[de.is_registered&&e.jsx(Se,{variant:"default",className:"bg-green-600 text-[10px] px-1 py-0",children:""}),de.is_banned&&e.jsx(Se,{variant:"destructive",className:"text-[10px] px-1 py-0",children:""})]}),e.jsx("div",{className:`aspect-square bg-muted flex items-center justify-center overflow-hidden ${K==="small"?"p-1":K==="medium"?"p-2":"p-3"}`,children:e.jsx(c4,{src:g4(de.id),alt:""})}),e.jsxs("div",{className:`border-t bg-card ${K==="small"?"p-1":"p-2"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-1 text-xs text-muted-foreground mb-1",children:[e.jsx(Se,{variant:"outline",className:"text-[10px] px-1 py-0",children:de.format.toUpperCase()}),e.jsxs("span",{className:"font-mono",children:[de.usage_count,""]})]}),e.jsxs("div",{className:`flex gap-1 justify-center opacity-0 group-hover:opacity-100 transition-opacity ${K==="small"?"flex-wrap":""}`,children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Me=>{Me.stopPropagation(),Ee(de)},title:"",children:e.jsx(qn,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:Me=>{Me.stopPropagation(),se(de)},title:"",children:e.jsx(Ht,{className:"h-3 w-3"})}),!de.is_registered&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-green-700",onClick:Me=>{Me.stopPropagation(),ns(de)},title:"",children:e.jsx(pt,{className:"h-3 w-3"})}),!de.is_banned&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-orange-600 hover:text-orange-700",onClick:Me=>{Me.stopPropagation(),Q(de)},title:"",children:e.jsx(t_,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600 hover:text-red-700",onClick:Me=>{Me.stopPropagation(),Z(de)},title:"",children:e.jsx(ls,{className:"h-3 w-3"})})]})]})]},de.id))}),p>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(h-1)*N+1," "," ",Math.min(h*N,p),"  ",p," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(de=>Math.max(1,de-1)),disabled:h===1,children:[e.jsx(Aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:B,onChange:de=>oe(de.target.value),onKeyDown:de=>de.key==="Enter"&&ie(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(p/N)}),e.jsx(_,{variant:"outline",size:"sm",onClick:ie,disabled:!B,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(de=>de+1),disabled:h>=Math.ceil(p/N),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Zt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(p/N)),disabled:h>=Math.ceil(p/N),className:"hidden sm:flex",children:e.jsx(jn,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(y4,{emoji:F,open:J,onOpenChange:U}),e.jsx(w4,{emoji:F,open:ue,onOpenChange:xe,onSuccess:()=>{k(),H()}}),e.jsx(_4,{open:pe,onOpenChange:ke,onSuccess:()=>{k(),H()}})]})}),e.jsx(vs,{open:z,onOpenChange:V,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",ve.size," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:Ue,children:""})]})]})}),e.jsx(Is,{open:he,onOpenChange:ne,children:e.jsxs(Os,{children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>ne(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:Oe,children:""})]})]})})]})}function y4({emoji:l,open:n,onOpenChange:i}){if(!l)return null;const c=u=>u?new Date(u*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl max-h-[90vh]",children:[e.jsx(Ds,{children:e.jsx(Rs,{children:""})}),e.jsx(Ye,{className:"max-h-[calc(90vh-8rem)] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:j4(l.id),alt:l.description||"",className:"w-full h-full object-cover",onError:u=>{const x=u.target;x.style.display="none";const h=x.parentElement;h&&(h.innerHTML='<svg class="h-16 w-16 text-muted-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>')}})})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:"ID"}),e.jsx("div",{className:"mt-1 font-mono",children:l.id})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(Se,{variant:"outline",children:l.format.toUpperCase()})})]})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:l.full_path})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-sm break-all bg-muted p-2 rounded",children:l.emoji_hash})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),l.description?e.jsx("div",{className:"mt-1 rounded-lg border bg-muted/50 p-3",children:e.jsx(o4,{className:"prose-sm",children:l.description})}):e.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:"-"})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:l.emotion?e.jsx("span",{className:"text-sm",children:l.emotion}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[l.is_registered&&e.jsx(Se,{variant:"default",className:"bg-green-600",children:""}),l.is_banned&&e.jsx(Se,{variant:"destructive",children:""}),!l.is_registered&&!l.is_banned&&e.jsx(Se,{variant:"outline",children:""})]})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 font-mono text-lg",children:l.usage_count})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(l.record_time)})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(l.register_time)})]})]}),e.jsxs("div",{children:[e.jsx(E,{className:"text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1 text-sm",children:c(l.last_used_time)})]})]})})]})})}function w4({emoji:l,open:n,onOpenChange:i,onSuccess:c}){const[u,x]=d.useState(""),[h,f]=d.useState(!1),[p,g]=d.useState(!1),[N,v]=d.useState(!1),{toast:y}=Zs();d.useEffect(()=>{l&&(x(l.emotion||""),f(l.is_registered),g(l.is_banned))},[l]);const w=async()=>{if(l)try{v(!0);const b=u.split(/[,,]/).map(R=>R.trim()).filter(Boolean).join(",");await m4(l.id,{emotion:b||void 0,is_registered:h,is_banned:p}),y({title:"",description:""}),i(!1),c()}catch(b){const R=b instanceof Error?b.message:"";y({title:"",description:R,variant:"destructive"})}finally{v(!1)}};return l?e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{children:""}),e.jsx(ot,{value:u,onChange:b=>x(b.target.value),placeholder:"...",rows:2,className:"mt-1"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"is_registered",checked:h,onCheckedChange:b=>{b===!0?(f(!0),g(!1)):f(!1)}}),e.jsx(E,{htmlFor:"is_registered",className:"cursor-pointer",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"is_banned",checked:p,onCheckedChange:b=>{b===!0?(g(!0),f(!1)):g(!1)}}),e.jsx(E,{htmlFor:"is_banned",className:"cursor-pointer",children:""})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(_,{onClick:w,disabled:N,children:N?"...":""})]})]})}):null}function _4({open:l,onOpenChange:n,onSuccess:i}){const[c,u]=d.useState("select"),[x,h]=d.useState([]),[f,p]=d.useState(null),[g,N]=d.useState(!1),{toast:v}=Zs(),y=d.useMemo(()=>new U_({id:"emoji-uploader",autoProceed:!1,restrictions:{maxFileSize:10485760,allowedFileTypes:["image/jpeg","image/png","image/gif","image/webp"],maxNumberOfFiles:20},locale:{pluralize:()=>0,strings:{addMoreFiles:"",addingMoreFiles:"",allowedFileTypes:"%{types}",cancel:"",closeModal:"",complete:"",connectedToInternet:"",copyLink:"",copyLinkToClipboardFallback:"",copyLinkToClipboardSuccess:"",dashboardTitle:"",dashboardWindowTitle:" ESC ",done:"",dropHereOr:" %{browse}",dropHint:"",dropPasteFiles:" %{browseFiles}",dropPasteFolders:" %{browseFolders}",dropPasteBoth:"%{browseFiles}  %{browseFolders}",dropPasteImportFiles:"%{browseFiles} ",dropPasteImportFolders:"%{browseFolders} ",dropPasteImportBoth:"%{browseFiles}%{browseFolders} ",editFile:"",editing:" %{file}",emptyFolderAdded:"",exceedsSize:"%{file}  %{size}",failedToUpload:" %{file} ",fileSource:"%{name}",filesUploadedOfTotal:{0:" %{complete} / %{smart_count} ",1:" %{complete} / %{smart_count} "},filter:"",finishEditingFile:"",folderAdded:{0:" %{folder}  %{smart_count} ",1:" %{folder}  %{smart_count} "},generatingThumbnails:"...",import:"",importFiles:"",importFrom:" %{name} ",loading:"...",logOut:"",myDevice:"",noFilesFound:"",noInternetConnection:"",openFolderNamed:" %{name}",pause:"",pauseUpload:"",paused:"",poweredBy:"%{uppy}",processingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},recording:"",removeFile:"",resetFilter:"",resume:"",resumeUpload:"",retry:"",retryUpload:"",save:"",saveChanges:"",selectFileNamed:" %{name}",selectX:{0:" %{smart_count}",1:" %{smart_count}"},smile:"",startRecording:"",stopRecording:"",takePicture:"",timedOut:" %{seconds} ",upload:"",uploadComplete:"",uploadFailed:"",uploadPaused:"",uploadXFiles:{0:"%{smart_count} ",1:"%{smart_count} "},uploadXNewFiles:{0:"+%{smart_count} ",1:"+%{smart_count} "},uploading:"",uploadingXFiles:{0:" %{smart_count} ",1:" %{smart_count} "},xFilesSelected:{0:" %{smart_count} ",1:" %{smart_count} "},xMoreFilesAdded:{0:" %{smart_count} ",1:" %{smart_count} "},xTimeLeft:" %{time}",youCanOnlyUploadFileTypes:"%{types}",youCanOnlyUploadX:{0:" %{smart_count} ",1:" %{smart_count} "},youHaveToAtLeastSelectX:{0:" %{smart_count} ",1:" %{smart_count} "},browseFiles:"",browseFolders:"",cancelUpload:"",addMore:"",back:"",editFileWithFilename:" %{file}"}}}),[]);d.useEffect(()=>{const F=()=>{const L=y.getFiles();if(L.length===0)return;const J=L.map(U=>({id:U.id,name:U.name,previewUrl:U.preview||URL.createObjectURL(U.data),emotion:"",description:"",isRegistered:!0,file:U.data}));h(J),L.length===1?(p(J[0].id),u("edit-single")):u("edit-multiple")};return y.on("upload",F),()=>{y.off("upload",F)}},[y]),d.useEffect(()=>{l||(y.cancelAll(),u("select"),h([]),p(null),N(!1))},[l,y]);const w=d.useCallback((F,L)=>{h(J=>J.map(U=>U.id===F?{...U,...L}:U))},[]),b=d.useCallback(F=>F.emotion.trim().length>0,[]),R=d.useMemo(()=>x.length>0&&x.every(b),[x,b]),D=d.useMemo(()=>x.find(F=>F.id===f)||null,[x,f]),S=d.useCallback(()=>{(c==="edit-single"||c==="edit-multiple")&&(u("select"),h([]),p(null))},[c]),P=d.useCallback(async()=>{if(!R){v({title:"",description:"",variant:"destructive"});return}N(!0);let F=0,L=0;try{for(const J of x){const U=new FormData;U.append("file",J.file),U.append("emotion",J.emotion),U.append("description",J.description),U.append("is_registered",J.isRegistered.toString());try{(await we(N4(),{method:"POST",body:U})).ok?F++:L++}catch{L++}}L===0?(v({title:"",description:` ${F} `}),n(!1),i()):(v({title:"",description:` ${F}  ${L} `,variant:"destructive"}),i())}finally{N(!1)}},[R,x,v,n,i]),M=()=>e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"border rounded-lg overflow-hidden w-full",children:e.jsx(i4,{uppy:y,proudlyDisplayPoweredByUppy:!1,hideProgressDetails:!0,height:350,width:"100%",theme:"auto",note:" JPGPNGGIFWebP  20 "})})}),T=()=>{const F=x[0];return F?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ta,{className:"h-4 w-4 mr-1"}),""]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"w-32 h-32 rounded-lg border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:F.previewUrl,alt:F.name,className:"max-w-full max-h-full object-contain"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center truncate max-w-32",children:F.name})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"single-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"single-emotion",value:F.emotion,onChange:L=>w(F.id,{emotion:L.target.value}),placeholder:",",className:F.emotion.trim()?"":"border-destructive"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"single-description",children:""}),e.jsx(le,{id:"single-description",value:F.description,onChange:L=>w(F.id,{description:L.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"single-is-registered",checked:F.isRegistered,onCheckedChange:L=>w(F.id,{isRegistered:L===!0})}),e.jsx(E,{htmlFor:"single-is-registered",className:"cursor-pointer",children:""})]})]})]}),e.jsx(st,{children:e.jsx(_,{onClick:P,disabled:!R||g,children:g?"...":""})})]}):null},A=()=>{const F=x.filter(b).length,L=x.length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Ta,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["",F,"/",L," "]})]}),e.jsx(Se,{variant:R?"default":"secondary",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Ea,{className:"h-3 w-3 mr-1"}),""]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Ye,{className:"h-[350px] pr-2",children:e.jsx("div",{className:"space-y-2",children:x.map(J=>{const U=b(J),ue=f===J.id;return e.jsxs("div",{onClick:()=>p(J.id),className:`
                      flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all
                      ${ue?"ring-2 ring-primary":""}
                      ${U?"border-green-500 bg-green-50 dark:bg-green-950/20":"border-border hover:border-muted-foreground/50"}
                    `,children:[e.jsx("div",{className:"w-12 h-12 rounded border overflow-hidden bg-muted flex-shrink-0 flex items-center justify-center",children:e.jsx("img",{src:J.previewUrl,alt:J.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:J.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:J.emotion||""})]}),U?e.jsx(pt,{className:"h-5 w-5 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-muted-foreground/30 flex-shrink-0"})]},J.id)})})}),e.jsx("div",{className:"border rounded-lg p-4",children:D?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 rounded border overflow-hidden bg-muted flex items-center justify-center",children:e.jsx("img",{src:D.previewUrl,alt:D.name,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:D.name}),b(D)&&e.jsxs(Se,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"multi-emotion",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"multi-emotion",value:D.emotion,onChange:J=>w(D.id,{emotion:J.target.value}),placeholder:",",className:D.emotion.trim()?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"multi-description",children:""}),e.jsx(le,{id:"multi-description",value:D.description,onChange:J=>w(D.id,{description:J.target.value}),placeholder:"..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"multi-is-registered",checked:D.isRegistered,onCheckedChange:J=>w(D.id,{isRegistered:J===!0})}),e.jsx(E,{htmlFor:"multi-is-registered",className:"cursor-pointer text-sm",children:""})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jm,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:""})]})})})]}),e.jsx(st,{children:e.jsx(_,{onClick:P,disabled:!R||g,children:g?"...":` (${L})`})})]})};return e.jsx(Is,{open:l,onOpenChange:n,children:e.jsxs(Os,{className:"max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(ec,{className:"h-5 w-5"}),c==="select"&&" - ",c==="edit-single"&&" - ",c==="edit-multiple"&&" - "]}),e.jsxs(Ks,{children:[c==="select"&&" JPGPNGGIFWebP  10MB",c==="edit-single"&&"",c==="edit-multiple"&&""]})]}),e.jsxs("div",{className:"overflow-y-auto pr-1",children:[c==="select"&&M(),c==="edit-single"&&T(),c==="edit-multiple"&&A()]})]})})}function S4(){const[l,n]=d.useState([]),[i,c]=d.useState(!0),[u,x]=d.useState(0),[h,f]=d.useState(1),[p,g]=d.useState(20),[N,v]=d.useState(""),[y,w]=d.useState(null),[b,R]=d.useState(!1),[D,S]=d.useState(!1),[P,M]=d.useState(!1),[T,A]=d.useState(null),[F,L]=d.useState(new Set),[J,U]=d.useState(!1),[ue,xe]=d.useState(""),[he,ne]=d.useState({total:0,recent_7days:0,chat_count:0,top_chats:{}}),[ve,je]=d.useState([]),[z,V]=d.useState(new Map),[B,oe]=d.useState(!1),[K,_e]=d.useState(0),{toast:pe}=Zs(),ke=async()=>{try{c(!0);const ie=await j1({page:h,page_size:p,search:N||void 0});n(ie.data),x(ie.total)}catch(ie){pe({title:"",description:ie instanceof Error?ie.message:"",variant:"destructive"})}finally{c(!1)}},O=async()=>{try{const ie=await _1();ie?.data&&ne(ie.data)}catch(ie){console.error(":",ie)}},k=async()=>{try{const ie=await Wm();_e(ie.unchecked)}catch(ie){console.error(":",ie)}},H=async()=>{try{const ie=await Zm();if(ie?.data){je(ie.data);const Te=new Map;ie.data.forEach(de=>{Te.set(de.chat_id,de.chat_name)}),V(Te)}}catch(ie){console.error(":",ie)}},se=ie=>z.get(ie)||ie;d.useEffect(()=>{ke(),k(),O(),H()},[h,p,N]);const Ee=async ie=>{try{const Te=await v1(ie.id);w(Te.data),R(!0)}catch(Te){pe({title:"",description:Te instanceof Error?Te.message:"",variant:"destructive"})}},Z=ie=>{w(ie),S(!0)},Oe=async ie=>{try{await y1(ie.id),pe({title:"",description:`: ${ie.situation}`}),A(null),ke(),O()}catch(Te){pe({title:"",description:Te instanceof Error?Te.message:"",variant:"destructive"})}},ns=ie=>{const Te=new Set(F);Te.has(ie)?Te.delete(ie):Te.add(ie),L(Te)},Q=()=>{F.size===l.length&&l.length>0?L(new Set):L(new Set(l.map(ie=>ie.id)))},ee=async()=>{try{await w1(Array.from(F)),pe({title:"",description:` ${F.size} `}),L(new Set),U(!1),ke(),O()}catch(ie){pe({title:"",description:ie instanceof Error?ie.message:"",variant:"destructive"})}},Ue=()=>{const ie=parseInt(ue),Te=Math.ceil(u/p);ie>=1&&ie<=Te?(f(ie),xe("")):pe({title:"",description:`1-${Te}`,variant:"destructive"})};return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ma,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>oe(!0),className:"gap-2",children:[e.jsx(Aj,{className:"h-4 w-4"}),"",K>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-orange-500 text-white",children:K>99?"99+":K})]}),e.jsxs(_,{onClick:()=>M(!0),className:"gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),""]})]})]})}),e.jsx(Ye,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:he.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"7"}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:he.recent_7days})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-blue-600",children:he.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx(E,{htmlFor:"search",children:""}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 mt-1.5",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Tt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(le,{id:"search",placeholder:"...",value:N,onChange:ie=>v(ie.target.value),className:"pl-9"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:F.size>0&&e.jsxs("span",{children:[" ",F.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:ie=>{g(parseInt(ie)),f(1),L(new Set)},children:[e.jsx($e,{id:"page-size",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"10",children:"10"}),e.jsx(X,{value:"20",children:"20"}),e.jsx(X,{value:"50",children:"50"}),e.jsx(X,{value:"100",children:"100"})]})]}),F.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>L(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>U(!0),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(qs,{checked:F.size===l.length&&l.length>0,onCheckedChange:Q})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Ul,{children:i?e.jsx(ut,{children:e.jsx(qe,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"..."})}):l.length===0?e.jsx(ut,{children:e.jsx(qe,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:""})}):l.map(ie=>e.jsxs(ut,{children:[e.jsx(qe,{children:e.jsx(qs,{checked:F.has(ie.id),onCheckedChange:()=>ns(ie.id)})}),e.jsx(qe,{className:"font-medium max-w-xs truncate",children:ie.situation}),e.jsx(qe,{className:"max-w-xs truncate",children:ie.style}),e.jsx(qe,{className:"max-w-[200px] truncate",title:se(ie.chat_id),style:{wordBreak:"keep-all"},children:e.jsx("span",{className:"whitespace-nowrap overflow-hidden text-ellipsis block",children:se(ie.chat_id)})}),e.jsx(qe,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>Z(ie),children:[e.jsx(qn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Ee(ie),title:"",children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>A(ie),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})})]},ie.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):l.map(ie=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qs,{checked:F.has(ie.id),onCheckedChange:()=>ns(ie.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 overflow-hidden space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 w-full break-all",title:ie.situation,children:ie.situation})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm line-clamp-2 w-full break-all",title:ie.style,children:ie.style})]})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm truncate",title:se(ie.chat_id),style:{wordBreak:"keep-all"},children:se(ie.chat_id)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Z(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(qn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>Ee(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:e.jsx(ia,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>A(ie),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ls,{className:"h-3 w-3 mr-1"}),""]})]})]},ie.id))}),u>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",u,"  ",h," / ",Math.ceil(u/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:ue,onChange:ie=>xe(ie.target.value),onKeyDown:ie=>ie.key==="Enter"&&Ue(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(u/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:Ue,disabled:!ue,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(u/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Zt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(u/p)),disabled:h>=Math.ceil(u/p),className:"hidden sm:flex",children:e.jsx(jn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(k4,{expression:y,open:b,onOpenChange:R,chatNameMap:z}),e.jsx(C4,{open:P,onOpenChange:M,chatList:ve,onSuccess:()=>{ke(),O(),M(!1)}}),e.jsx(T4,{expression:y,open:D,onOpenChange:S,chatList:ve,onSuccess:()=>{ke(),O(),S(!1)}}),e.jsx(vs,{open:!!T,onOpenChange:()=>A(null),children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',T?.situation,'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>T&&Oe(T),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(E4,{open:J,onOpenChange:U,onConfirm:ee,count:F.size}),e.jsx(cv,{open:B,onOpenChange:ie=>{oe(ie),ie||(ke(),O(),k())}})]})}function k4({expression:l,open:n,onOpenChange:i,chatNameMap:c}){if(!l)return null;const u=h=>h?new Date(h*1e3).toLocaleString("zh-CN"):"-",x=h=>c.get(h)||h;return e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Pi,{label:"",value:l.situation}),e.jsx(Pi,{label:"",value:l.style}),e.jsx(Pi,{label:"",value:x(l.chat_id)}),e.jsx(Pi,{icon:Gr,label:"ID",value:l.id.toString(),mono:!0})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(Pi,{icon:na,label:"",value:u(l.create_date)})}),e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-4",children:[e.jsx(E,{className:"text-xs text-muted-foreground mb-3 block",children:""}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:I("flex h-8 w-8 items-center justify-center rounded-full",l.checked?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:l.checked?e.jsx(pt,{className:"h-5 w-5"}):e.jsx(Lo,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.checked?"":""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:I("flex h-8 w-8 items-center justify-center rounded-full",l.rejected?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600"),children:l.rejected?e.jsx(Va,{className:"h-5 w-5"}):e.jsx(Lo,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.rejected?"":""})]})]})]})]})]}),e.jsx(st,{children:e.jsx(_,{onClick:()=>i(!1),children:""})})]})})}function Pi({icon:l,label:n,value:i,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(E,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[l&&e.jsx(l,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:I("text-sm",c&&"font-mono",!i&&"text-muted-foreground"),children:i||"-"})]})}function C4({open:l,onOpenChange:n,chatList:i,onSuccess:c}){const[u,x]=d.useState({situation:"",style:"",chat_id:""}),[h,f]=d.useState(!1),{toast:p}=Zs(),g=async()=>{if(!u.situation||!u.style||!u.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await N1(u),p({title:"",description:""}),x({situation:"",style:"",chat_id:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Is,{open:l,onOpenChange:n,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"situation",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"situation",value:u.situation,onChange:N=>x({...u,situation:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"style",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"style",value:u.style,onChange:N=>x({...u,style:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Ie,{value:u.chat_id,onValueChange:N=>x({...u,chat_id:N}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:i.map(N=>e.jsx(X,{value:N.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[N.chat_name,N.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},N.chat_id))})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>n(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function T4({expression:l,open:n,onOpenChange:i,chatList:c,onSuccess:u}){const[x,h]=d.useState({}),[f,p]=d.useState(!1),{toast:g}=Zs();d.useEffect(()=>{l&&h({situation:l.situation,style:l.style,chat_id:l.chat_id,checked:l.checked,rejected:l.rejected})},[l]);const N=async()=>{if(l)try{p(!0),await b1(l.id,x),g({title:"",description:""}),u()}catch(v){g({title:"",description:v instanceof Error?v.message:"",variant:"destructive"})}finally{p(!1)}};return l?e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit_situation",children:""}),e.jsx(le,{id:"edit_situation",value:x.situation||"",onChange:v=>h({...x,situation:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit_style",children:""}),e.jsx(le,{id:"edit_style",value:x.style||"",onChange:v=>h({...x,style:v.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Ie,{value:x.chat_id||"",onValueChange:v=>h({...x,chat_id:v}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:c.map(v=>e.jsx(X,{value:v.chat_id,children:e.jsxs("span",{className:"truncate",style:{wordBreak:"keep-all"},children:[v.chat_name,v.is_group&&e.jsx("span",{className:"text-muted-foreground ml-1",children:"()"})]})},v.chat_id))})]})]}),e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(lt,{className:"text-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:""})}),e.jsx("p",{children:" AI"}),e.jsx("p",{children:" "}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:['""',e.jsx("br",{})," ",e.jsx("br",{})," "]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{htmlFor:"edit_checked",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"edit_checked",checked:x.checked??!1,onCheckedChange:v=>h({...x,checked:v})})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{htmlFor:"edit_rejected",className:"text-sm font-medium",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"edit_rejected",checked:x.rejected??!1,onCheckedChange:v=>h({...x,rejected:v})})]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}function E4({open:l,onOpenChange:n,onConfirm:i,count:c}){return e.jsx(vs,{open:l,onOpenChange:n,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",c," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:i,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})}const $l="/api/webui/jargon";async function M4(){const l=await we(`${$l}/chats`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function z4(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.chat_id&&n.append("chat_id",l.chat_id),l.is_jargon!==void 0&&l.is_jargon!==null&&n.append("is_jargon",l.is_jargon.toString()),l.is_global!==void 0&&n.append("is_global",l.is_global.toString());const i=await we(`${$l}/list?${n}`,{});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function A4(l){const n=await we(`${$l}/${l}`,{});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function O4(l){const n=await we(`${$l}/`,{method:"POST",body:JSON.stringify(l)});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function D4(l,n){const i=await we(`${$l}/${l}`,{method:"PATCH",body:JSON.stringify(n)});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function R4(l){const n=await we(`${$l}/${l}`,{method:"DELETE"});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function L4(l){const n=await we(`${$l}/batch/delete`,{method:"POST",body:JSON.stringify({ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function U4(){const l=await we(`${$l}/stats/summary`,{});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function $4(l,n){const i=new URLSearchParams;l.forEach(u=>i.append("ids",u.toString())),i.append("is_jargon",n.toString());const c=await we(`${$l}/batch/set-jargon?${i}`,{method:"POST"});if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return c.json()}function B4(){const[l,n]=d.useState([]),[i,c]=d.useState(!0),[u,x]=d.useState(0),[h,f]=d.useState(1),[p,g]=d.useState(20),[N,v]=d.useState(""),[y,w]=d.useState("all"),[b,R]=d.useState("all"),[D,S]=d.useState(null),[P,M]=d.useState(!1),[T,A]=d.useState(!1),[F,L]=d.useState(!1),[J,U]=d.useState(null),[ue,xe]=d.useState(new Set),[he,ne]=d.useState(!1),[ve,je]=d.useState(""),[z,V]=d.useState({total:0,confirmed_jargon:0,confirmed_not_jargon:0,pending:0,global_count:0,complete_count:0,chat_count:0,top_chats:{}}),[B,oe]=d.useState([]),{toast:K}=Zs(),_e=async()=>{try{c(!0);const ee=await z4({page:h,page_size:p,search:N||void 0,chat_id:y==="all"?void 0:y,is_jargon:b==="all"?void 0:b==="true"?!0:b==="false"?!1:void 0});n(ee.data),x(ee.total)}catch(ee){K({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}finally{c(!1)}},pe=async()=>{try{const ee=await U4();ee?.data&&V(ee.data)}catch(ee){console.error(":",ee)}},ke=async()=>{try{const ee=await M4();ee?.data&&oe(ee.data)}catch(ee){console.error(":",ee)}};d.useEffect(()=>{_e(),pe(),ke()},[h,p,N,y,b]);const O=async ee=>{try{const Ue=await A4(ee.id);S(Ue.data),M(!0)}catch(Ue){K({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},k=ee=>{S(ee),A(!0)},H=async ee=>{try{await R4(ee.id),K({title:"",description:`: ${ee.content}`}),U(null),_e(),pe()}catch(Ue){K({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},se=ee=>{const Ue=new Set(ue);Ue.has(ee)?Ue.delete(ee):Ue.add(ee),xe(Ue)},Ee=()=>{ue.size===l.length&&l.length>0?xe(new Set):xe(new Set(l.map(ee=>ee.id)))},Z=async()=>{try{await L4(Array.from(ue)),K({title:"",description:` ${ue.size} `}),xe(new Set),ne(!1),_e(),pe()}catch(ee){K({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}},Oe=async ee=>{try{await $4(Array.from(ue),ee),K({title:"",description:` ${ue.size} ${ee?"":""}`}),xe(new Set),_e(),pe()}catch(Ue){K({title:"",description:Ue instanceof Error?Ue.message:"",variant:"destructive"})}},ns=()=>{const ee=parseInt(ve),Ue=Math.ceil(u/p);ee>=1&&ee<=Ue?(f(ee),je("")):K({title:"",description:`1-${Ue}`,variant:"destructive"})},Q=ee=>ee===!0?e.jsxs(Se,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),""]}):ee===!1?e.jsxs(Se,{variant:"secondary",children:[e.jsx(Ea,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(Se,{variant:"outline",children:[e.jsx(Dj,{className:"h-3 w-3 mr-1"}),""]});return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(a_,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsxs(_,{onClick:()=>L(!0),className:"gap-2",children:[e.jsx(et,{className:"h-4 w-4"}),""]})]})}),e.jsx(Ye,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:z.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-green-600",children:z.confirmed_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-gray-500",children:z.confirmed_not_jargon})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-yellow-600",children:z.pending})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-blue-600",children:z.global_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1 text-purple-600",children:z.complete_count})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-3 sm:p-4",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-xl sm:text-2xl font-bold mt-1",children:z.chat_count})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(E,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(le,{id:"search",placeholder:"...",value:N,onChange:ee=>v(ee.target.value),className:"pl-9"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:y,onValueChange:w,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),B.map(ee=>e.jsx(X,{value:ee.chat_id,children:ee.chat_name},ee.chat_id))]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:b,onValueChange:R,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),e.jsx(X,{value:"true",children:""}),e.jsx(X,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(E,{htmlFor:"page-size",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:ee=>{g(parseInt(ee)),f(1),xe(new Set)},children:[e.jsx($e,{id:"page-size",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"10",children:"10"}),e.jsx(X,{value:"20",children:"20"}),e.jsx(X,{value:"50",children:"50"}),e.jsx(X,{value:"100",children:"100"})]})]})]})]}),ue.size>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",ue.size," "]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Oe(!0),children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Oe(!1),children:[e.jsx(Ea,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>xe(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>ne(!0),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(qs,{checked:ue.size===l.length&&l.length>0,onCheckedChange:Ee})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-center",children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Ul,{children:i?e.jsx(ut,{children:e.jsx(qe,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"..."})}):l.length===0?e.jsx(ut,{children:e.jsx(qe,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:""})}):l.map(ee=>e.jsxs(ut,{children:[e.jsx(qe,{children:e.jsx(qs,{checked:ue.has(ee.id),onCheckedChange:()=>se(ee.id)})}),e.jsx(qe,{className:"font-medium max-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[ee.is_global&&e.jsx("span",{title:"",children:e.jsx(Uo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"})}),e.jsx("span",{className:"truncate",title:ee.content,children:ee.content})]})}),e.jsx(qe,{className:"max-w-[200px] truncate",title:ee.meaning||"",children:ee.meaning||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(qe,{className:"max-w-[150px] truncate",title:ee.chat_name||ee.chat_id,children:ee.chat_name||ee.chat_id}),e.jsx(qe,{children:Q(ee.is_jargon)}),e.jsx(qe,{className:"text-center",children:ee.count}),e.jsx(qe,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>k(ee),children:[e.jsx(qn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>O(ee),title:"",children:e.jsx(ia,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",onClick:()=>U(ee),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})})]},ee.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):l.map(ee=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qs,{checked:ue.has(ee.id),onCheckedChange:()=>se(ee.id),className:"mt-1"}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ee.is_global&&e.jsx(Uo,{className:"h-4 w-4 text-blue-500 flex-shrink-0"}),e.jsx("h3",{className:"font-semibold text-sm break-all",children:ee.content})]}),ee.meaning&&e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:ee.meaning}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[Q(ee.is_jargon),e.jsxs("span",{className:"text-muted-foreground",children:[": ",ee.count]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[": ",ee.chat_name||ee.chat_id]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>k(ee),className:"text-xs px-2 py-1 h-auto",children:[e.jsx(qn,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>O(ee),className:"text-xs px-2 py-1 h-auto",children:e.jsx(ia,{className:"h-3 w-3"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>U(ee),className:"text-xs px-2 py-1 h-auto text-destructive hover:text-destructive",children:[e.jsx(ls,{className:"h-3 w-3 mr-1"}),""]})]})]},ee.id))}),u>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",u,"  ",h," / ",Math.ceil(u/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:ve,onChange:ee=>je(ee.target.value),onKeyDown:ee=>ee.key==="Enter"&&ns(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(u/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:ns,disabled:!ve,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(u/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Zt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(u/p)),disabled:h>=Math.ceil(u/p),className:"hidden sm:flex",children:e.jsx(jn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(I4,{jargon:D,open:P,onOpenChange:M}),e.jsx(P4,{open:F,onOpenChange:L,chatList:B,onSuccess:()=>{_e(),pe(),L(!1)}}),e.jsx(H4,{jargon:D,open:T,onOpenChange:A,chatList:B,onSuccess:()=>{_e(),pe(),A(!1)}}),e.jsx(vs,{open:!!J,onOpenChange:()=>U(null),children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',J?.content,'" ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>J&&H(J),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:he,onOpenChange:ne,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",ue.size," "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:Z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function I4({jargon:l,open:n,onOpenChange:i}){return l?e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsx(Ye,{className:"h-full pr-4",children:e.jsxs("div",{className:"space-y-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Dm,{icon:Gr,label:"ID",value:l.id.toString(),mono:!0}),e.jsx(Dm,{label:"",value:l.count.toString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all whitespace-pre-wrap",children:l.content})]}),l.raw_content&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:(()=>{try{const c=JSON.parse(l.raw_content);return Array.isArray(c)?c.map((u,x)=>e.jsxs("div",{children:[x>0&&e.jsx("hr",{className:"my-3 border-border"}),e.jsx("div",{className:"whitespace-pre-wrap",children:u})]},x)):e.jsx("div",{className:"whitespace-pre-wrap",children:l.raw_content})}catch{return e.jsx("div",{className:"whitespace-pre-wrap",children:l.raw_content})}})()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"text-sm p-2 bg-muted rounded break-all",children:l.meaning?e.jsx(tx,{content:l.meaning}):"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Dm,{label:"",value:l.chat_name||l.chat_id}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.is_jargon===!0&&e.jsx(Se,{variant:"default",className:"bg-green-600",children:""}),l.is_jargon===!1&&e.jsx(Se,{variant:"secondary",children:""}),l.is_jargon===null&&e.jsx(Se,{variant:"outline",children:""}),l.is_global&&e.jsx(Se,{variant:"outline",className:"border-blue-500 text-blue-500",children:""}),l.is_complete&&e.jsx(Se,{variant:"outline",className:"border-purple-500 text-purple-500",children:""})]})]})]}),l.inference_with_context&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:l.inference_with_context})]}),l.inference_content_only&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"p-2 bg-muted rounded break-all whitespace-pre-wrap font-mono text-xs max-h-[200px] overflow-y-auto",children:l.inference_content_only})]})]})}),e.jsx(st,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>i(!1),children:""})})]})}):null}function Dm({icon:l,label:n,value:i,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(E,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[l&&e.jsx(l,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:I("text-sm",c&&"font-mono",!i&&"text-muted-foreground"),children:i||"-"})]})}function P4({open:l,onOpenChange:n,chatList:i,onSuccess:c}){const[u,x]=d.useState({content:"",meaning:"",chat_id:"",is_global:!1}),[h,f]=d.useState(!1),{toast:p}=Zs(),g=async()=>{if(!u.content||!u.chat_id){p({title:"",description:"",variant:"destructive"});return}try{f(!0),await O4(u),p({title:"",description:""}),x({content:"",meaning:"",chat_id:"",is_global:!1}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return e.jsx(Is,{open:l,onOpenChange:n,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"content",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(le,{id:"content",value:u.content,onChange:N=>x({...u,content:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"meaning",children:""}),e.jsx(ot,{id:"meaning",value:u.meaning||"",onChange:N=>x({...u,meaning:N.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"chat_id",children:[" ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Ie,{value:u.chat_id,onValueChange:N=>x({...u,chat_id:N}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:i.map(N=>e.jsx(X,{value:N.chat_id,children:N.chat_name},N.chat_id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"is_global",checked:u.is_global,onCheckedChange:N=>x({...u,is_global:N})}),e.jsx(E,{htmlFor:"is_global",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>n(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})})}function H4({jargon:l,open:n,onOpenChange:i,chatList:c,onSuccess:u}){const[x,h]=d.useState({}),[f,p]=d.useState(!1),{toast:g}=Zs();d.useEffect(()=>{l&&h({content:l.content,meaning:l.meaning||"",chat_id:l.stream_id||l.chat_id,is_global:l.is_global,is_jargon:l.is_jargon})},[l]);const N=async()=>{if(l)try{p(!0),await D4(l.id,x),g({title:"",description:""}),u()}catch(v){g({title:"",description:v instanceof Error?v.message:"",variant:"destructive"})}finally{p(!1)}};return l?e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit_content",children:""}),e.jsx(le,{id:"edit_content",value:x.content||"",onChange:v=>h({...x,content:v.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit_meaning",children:""}),e.jsx(ot,{id:"edit_meaning",value:x.meaning||"",onChange:v=>h({...x,meaning:v.target.value}),placeholder:"",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit_chat_id",children:""}),e.jsxs(Ie,{value:x.chat_id||"",onValueChange:v=>h({...x,chat_id:v}),children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsx(Be,{children:c.map(v=>e.jsx(X,{value:v.chat_id,children:v.chat_name},v.chat_id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:""}),e.jsxs(Ie,{value:x.is_jargon===null?"null":x.is_jargon?.toString()||"null",onValueChange:v=>h({...x,is_jargon:v==="null"?null:v==="true"}),children:[e.jsx($e,{children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"null",children:""}),e.jsx(X,{value:"true",children:""}),e.jsx(X,{value:"false",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"edit_is_global",checked:x.is_global,onCheckedChange:v=>h({...x,is_global:v})}),e.jsx(E,{htmlFor:"edit_is_global",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(_,{onClick:N,disabled:f,children:f?"...":""})]})]})}):null}const Yr="/api/webui/person";async function F4(l){const n=new URLSearchParams;l.page&&n.append("page",l.page.toString()),l.page_size&&n.append("page_size",l.page_size.toString()),l.search&&n.append("search",l.search),l.is_known!==void 0&&n.append("is_known",l.is_known.toString()),l.platform&&n.append("platform",l.platform);const i=await we(`${Yr}/list?${n}`,{headers:Fs()});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function G4(l){const n=await we(`${Yr}/${l}`,{headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function V4(l,n){const i=await we(`${Yr}/${l}`,{method:"PATCH",headers:Fs(),body:JSON.stringify(n)});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return i.json()}async function q4(l){const n=await we(`${Yr}/${l}`,{method:"DELETE",headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}async function K4(){const l=await we(`${Yr}/stats/summary`,{headers:Fs()});if(!l.ok){const n=await l.json();throw new Error(n.detail||"")}return l.json()}async function Q4(l){const n=await we(`${Yr}/batch/delete`,{method:"POST",headers:Fs(),body:JSON.stringify({person_ids:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}function Y4(){const[l,n]=d.useState([]),[i,c]=d.useState(!0),[u,x]=d.useState(0),[h,f]=d.useState(1),[p,g]=d.useState(20),[N,v]=d.useState(""),[y,w]=d.useState(void 0),[b,R]=d.useState(void 0),[D,S]=d.useState(null),[P,M]=d.useState(!1),[T,A]=d.useState(!1),[F,L]=d.useState(null),[J,U]=d.useState({total:0,known:0,unknown:0,platforms:{}}),[ue,xe]=d.useState(new Set),[he,ne]=d.useState(!1),[ve,je]=d.useState(""),{toast:z}=Zs(),V=async()=>{try{c(!0);const Z=await F4({page:h,page_size:p,search:N||void 0,is_known:y,platform:b});n(Z.data),x(Z.total)}catch(Z){z({title:"",description:Z instanceof Error?Z.message:"",variant:"destructive"})}finally{c(!1)}},B=async()=>{try{const Z=await K4();Z?.data&&U(Z.data)}catch(Z){console.error(":",Z)}};d.useEffect(()=>{V(),B()},[h,p,N,y,b]);const oe=async Z=>{try{const Oe=await G4(Z.person_id);S(Oe.data),M(!0)}catch(Oe){z({title:"",description:Oe instanceof Error?Oe.message:"",variant:"destructive"})}},K=Z=>{S(Z),A(!0)},_e=async Z=>{try{await q4(Z.person_id),z({title:"",description:`: ${Z.person_name||Z.nickname||Z.user_id}`}),L(null),V(),B()}catch(Oe){z({title:"",description:Oe instanceof Error?Oe.message:"",variant:"destructive"})}},pe=d.useMemo(()=>Object.keys(J.platforms),[J.platforms]),ke=Z=>{const Oe=new Set(ue);Oe.has(Z)?Oe.delete(Z):Oe.add(Z),xe(Oe)},O=()=>{ue.size===l.length&&l.length>0?xe(new Set):xe(new Set(l.map(Z=>Z.person_id)))},k=()=>{if(ue.size===0){z({title:"",description:"",variant:"destructive"});return}ne(!0)},H=async()=>{try{const Z=await Q4(Array.from(ue));z({title:"",description:Z.message}),xe(new Set),ne(!1),V(),B()}catch(Z){z({title:"",description:Z instanceof Error?Z.message:"",variant:"destructive"})}},se=()=>{const Z=parseInt(ve),Oe=Math.ceil(u/p);Z>=1&&Z<=Oe?(f(Z),je("")):z({title:"",description:`1-${Oe}`,variant:"destructive"})},Ee=Z=>Z?new Date(Z*1e3).toLocaleString("zh-CN"):"-";return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(sc,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Ye,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 pr-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:J.total})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-green-600",children:J.known})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"text-2xl font-bold mt-1 text-muted-foreground",children:J.unknown})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx(E,{htmlFor:"search",children:""}),e.jsxs("div",{className:"relative mt-1.5",children:[e.jsx(Tt,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(le,{id:"search",placeholder:"ID...",value:N,onChange:Z=>v(Z.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"filter-known",children:""}),e.jsxs(Ie,{value:y===void 0?"all":y.toString(),onValueChange:Z=>{w(Z==="all"?void 0:Z==="true"),f(1)},children:[e.jsx($e,{id:"filter-known",className:"mt-1.5",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),e.jsx(X,{value:"true",children:""}),e.jsx(X,{value:"false",children:""})]})]})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"filter-platform",children:""}),e.jsxs(Ie,{value:b||"all",onValueChange:Z=>{R(Z==="all"?void 0:Z),f(1)},children:[e.jsx($e,{id:"filter-platform",className:"mt-1.5",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),pe.map(Z=>e.jsxs(X,{value:Z,children:[Z," (",J.platforms[Z],")"]},Z))]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mt-4 pt-4 border-t",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:ue.size>0&&e.jsxs("span",{children:[" ",ue.size," "]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{htmlFor:"page-size",className:"text-sm whitespace-nowrap",children:""}),e.jsxs(Ie,{value:p.toString(),onValueChange:Z=>{g(parseInt(Z)),f(1),xe(new Set)},children:[e.jsx($e,{id:"page-size",className:"w-20",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"10",children:"10"}),e.jsx(X,{value:"20",children:"20"}),e.jsx(X,{value:"50",children:"50"}),e.jsx(X,{value:"100",children:"100"})]})]}),ue.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>xe(new Set),children:""}),e.jsxs(_,{variant:"destructive",size:"sm",onClick:k,children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{className:"w-12",children:e.jsx(qs,{checked:l.length>0&&ue.size===l.length,onCheckedChange:O,"aria-label":""})}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"ID"}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Ul,{children:i?e.jsx(ut,{children:e.jsx(qe,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"..."})}):l.length===0?e.jsx(ut,{children:e.jsx(qe,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:""})}):l.map(Z=>e.jsxs(ut,{children:[e.jsx(qe,{children:e.jsx(qs,{checked:ue.has(Z.person_id),onCheckedChange:()=>ke(Z.person_id),"aria-label":` ${Z.person_name||Z.nickname||Z.user_id}`})}),e.jsx(qe,{children:e.jsx("div",{className:I("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",Z.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:Z.is_known?"":""})}),e.jsx(qe,{className:"font-medium",children:Z.person_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(qe,{children:Z.nickname||"-"}),e.jsx(qe,{children:Z.platform}),e.jsx(qe,{className:"font-mono text-sm",children:Z.user_id}),e.jsx(qe,{className:"text-sm text-muted-foreground",children:Ee(Z.last_know)}),e.jsx(qe,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(_,{variant:"default",size:"sm",onClick:()=>oe(Z),children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"default",size:"sm",onClick:()=>K(Z),children:[e.jsx(qn,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{size:"sm",onClick:()=>L(Z),className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]})]})})]},Z.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"..."}):l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""}):l.map(Z=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qs,{checked:ue.has(Z.person_id),onCheckedChange:()=>ke(Z.person_id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:I("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium mb-2",Z.is_known?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:Z.is_known?"":""}),e.jsx("h3",{className:"font-semibold text-sm line-clamp-1 w-full break-all",children:Z.person_name||e.jsx("span",{className:"text-muted-foreground",children:""})}),Z.nickname&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1 w-full break-all",children:[": ",Z.nickname]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"font-medium text-xs",children:Z.platform})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"ID"}),e.jsx("p",{className:"font-mono text-xs truncate",title:Z.user_id,children:Z.user_id})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-xs",children:Ee(Z.last_know)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 pt-2 border-t overflow-hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>oe(Z),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(ia,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>K(Z),className:"text-xs px-2 py-1 h-auto flex-shrink-0",children:[e.jsx(qn,{className:"h-3 w-3 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>L(Z),className:"text-xs px-2 py-1 h-auto flex-shrink-0 text-destructive hover:text-destructive",children:[e.jsx(ls,{className:"h-3 w-3 mr-1"}),""]})]})]},Z.id))}),u>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",u,"  ",h," / ",Math.ceil(u/p)," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(1),disabled:h===1,className:"hidden sm:flex",children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h-1),disabled:h===1,children:[e.jsx(Aa,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",value:ve,onChange:Z=>je(Z.target.value),onKeyDown:Z=>Z.key==="Enter"&&se(),placeholder:h.toString(),className:"w-16 h-8 text-center",min:1,max:Math.ceil(u/p)}),e.jsx(_,{variant:"outline",size:"sm",onClick:se,disabled:!ve,className:"h-8",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>f(h+1),disabled:h>=Math.ceil(u/p),children:[e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsx(Zt,{className:"h-4 w-4 sm:ml-1"})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>f(Math.ceil(u/p)),disabled:h>=Math.ceil(u/p),className:"hidden sm:flex",children:e.jsx(jn,{className:"h-4 w-4"})})]})]})]})]})}),e.jsx(J4,{person:D,open:P,onOpenChange:M}),e.jsx(X4,{person:D,open:T,onOpenChange:A,onSuccess:()=>{V(),B(),A(!1)}}),e.jsx(vs,{open:!!F,onOpenChange:()=>L(null),children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[' "',F?.person_name||F?.nickname||F?.user_id,'"  ']})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:()=>F&&_e(F),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})}),e.jsx(vs,{open:he,onOpenChange:ne,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:[" ",ue.size,"  "]})]}),e.jsxs(ms,{children:[e.jsx(ps,{children:""}),e.jsx(fs,{onClick:H,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:""})]})]})})]})}function J4({person:l,open:n,onOpenChange:i}){if(!l)return null;const c=u=>u?new Date(u*1e3).toLocaleString("zh-CN"):"-";return e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsxs(Ks,{children:[" ",l.person_name||l.nickname||l.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(zl,{icon:fn,label:"",value:l.person_name}),e.jsx(zl,{icon:Ma,label:"",value:l.nickname}),e.jsx(zl,{icon:Gr,label:"ID",value:l.user_id,mono:!0}),e.jsx(zl,{icon:Gr,label:"ID",value:l.person_id,mono:!0}),e.jsx(zl,{label:"",value:l.platform}),e.jsx(zl,{label:"",value:l.is_known?"":""})]}),l.name_reason&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm",children:l.name_reason})]}),l.memory_points&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:l.memory_points})]}),l.group_nick_name&&l.group_nick_name.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[e.jsx(E,{className:"text-xs text-muted-foreground",children:""}),e.jsx("div",{className:"mt-2 space-y-1",children:l.group_nick_name.map((u,x)=>e.jsxs("div",{className:"text-sm flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:u.group_id}),e.jsx("span",{children:""}),e.jsx("span",{children:u.group_nick_name})]},x))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(zl,{icon:na,label:"",value:c(l.know_times)}),e.jsx(zl,{icon:na,label:"",value:c(l.know_since)}),e.jsx(zl,{icon:na,label:"",value:c(l.last_know)})]})]}),e.jsx(st,{children:e.jsx(_,{onClick:()=>i(!1),children:""})})]})})}function zl({icon:l,label:n,value:i,mono:c=!1}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs(E,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[l&&e.jsx(l,{className:"h-3 w-3"}),n]}),e.jsx("div",{className:I("text-sm",c&&"font-mono",!i&&"text-muted-foreground"),children:i||"-"})]})}function X4({person:l,open:n,onOpenChange:i,onSuccess:c}){const[u,x]=d.useState({}),[h,f]=d.useState(!1),{toast:p}=Zs();d.useEffect(()=>{l&&x({person_name:l.person_name||"",name_reason:l.name_reason||"",nickname:l.nickname||"",is_known:l.is_known})},[l]);const g=async()=>{if(l)try{f(!0),await V4(l.person_id,u),p({title:"",description:""}),c()}catch(N){p({title:"",description:N instanceof Error?N.message:"",variant:"destructive"})}finally{f(!1)}};return l?e.jsx(Is,{open:n,onOpenChange:i,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsxs(Ks,{children:[" ",l.person_name||l.nickname||l.user_id," "]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"person_name",children:""}),e.jsx(le,{id:"person_name",value:u.person_name||"",onChange:N=>x({...u,person_name:N.target.value}),placeholder:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"nickname",children:""}),e.jsx(le,{id:"nickname",value:u.nickname||"",onChange:N=>x({...u,nickname:N.target.value}),placeholder:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"name_reason",children:""}),e.jsx(ot,{id:"name_reason",value:u.name_reason||"",onChange:N=>x({...u,name_reason:N.target.value}),placeholder:"",rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"is_known",className:"text-base font-medium",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]}),e.jsx(Fe,{id:"is_known",checked:u.is_known,onCheckedChange:N=>x({...u,is_known:N})})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>i(!1),children:""}),e.jsx(_,{onClick:g,disabled:h,children:h?"...":""})]})]})}):null}var Z4=H_();const Dg=E0(Z4),ox="/api/webui";async function W4(l=100,n="all"){const i=`${ox}/knowledge/graph?limit=${l}&node_type=${n}`,c=await fetch(i);if(!c.ok)throw new Error(`: ${c.status}`);return c.json()}async function ek(){const l=await fetch(`${ox}/knowledge/stats`);if(!l.ok)throw new Error("");return l.json()}async function sk(l){const n=await fetch(`${ox}/knowledge/search?query=${encodeURIComponent(l)}`);if(!n.ok)throw new Error("");return n.json()}const zv=d.memo(({data:l})=>e.jsxs("div",{className:"px-4 py-2 shadow-md rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700 min-w-[120px]",children:[e.jsx(Io,{type:"target",position:Po.Top}),e.jsx("div",{className:"font-semibold text-white text-sm truncate max-w-[200px]",title:l.content,children:l.label}),e.jsx(Io,{type:"source",position:Po.Bottom})]}));zv.displayName="EntityNode";const Av=d.memo(({data:l})=>e.jsxs("div",{className:"px-3 py-2 shadow-md rounded-md bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700 min-w-[100px]",children:[e.jsx(Io,{type:"target",position:Po.Top}),e.jsx("div",{className:"font-medium text-white text-xs truncate max-w-[150px]",title:l.content,children:l.label}),e.jsx(Io,{type:"source",position:Po.Bottom})]}));Av.displayName="ParagraphNode";const tk={entity:zv,paragraph:Av};function ak(l,n){const i=new Dg.graphlib.Graph;i.setDefaultEdgeLabel(()=>({})),i.setGraph({rankdir:"TB",ranksep:100,nodesep:80});const c=[],u=[];return l.forEach(x=>{i.setNode(x.id,{width:150,height:50})}),n.forEach(x=>{i.setEdge(x.source,x.target)}),Dg.layout(i),l.forEach(x=>{const h=i.node(x.id);c.push({id:x.id,type:x.type,position:{x:h.x-75,y:h.y-25},data:{label:x.content.slice(0,20)+(x.content.length>20?"...":""),content:x.content}})}),n.forEach((x,h)=>{const f={id:`edge-${h}`,source:x.source,target:x.target,animated:l.length<=200&&x.weight>5,style:{strokeWidth:Math.min(x.weight/2,5),opacity:.6}};x.weight>10&&l.length<100&&(f.label=`${x.weight.toFixed(0)}`),u.push(f)}),{nodes:c,edges:u}}function lk(){const l=ca(),[n,i]=d.useState(!1),[c,u]=d.useState(null),[x,h]=d.useState(""),[f,p]=d.useState("all"),[g,N]=d.useState(50),[v,y]=d.useState("50"),[w,b]=d.useState(!1),[R,D]=d.useState(!0),[S,P]=d.useState(!1),[M,T]=d.useState(!1),[A,F,L]=F_([]),[J,U,ue]=G_([]),[xe,he]=d.useState(0),[ne,ve]=d.useState(null),[je,z]=d.useState(null),{toast:V}=Zs(),B=d.useCallback(H=>H.type==="entity"?"#6366f1":H.type==="paragraph"?"#10b981":"#6b7280",[]),oe=d.useCallback(async(H=!1)=>{try{if(!H&&g>200){T(!0);return}i(!0);const[se,Ee]=await Promise.all([W4(g,f),ek()]);if(u(Ee),se.nodes.length===0){V({title:"",description:""}),F([]),U([]);return}const{nodes:Z,edges:Oe}=ak(se.nodes,se.edges);F(Z),U(Oe),he(Z.length),Ee&&Ee.total_nodes>g&&V({title:"",description:` ${Ee.total_nodes}  ${Z.length} `}),V({title:"",description:` ${Z.length} ${Oe.length} `})}catch(se){console.error(":",se),V({title:"",description:se instanceof Error?se.message:"",variant:"destructive"})}finally{i(!1)}},[g,f,V]),K=d.useCallback(async()=>{if(!x.trim()){V({title:"",description:""});return}try{const H=await sk(x);if(H.length===0){V({title:"",description:""});return}const se=new Set(H.map(Ee=>Ee.id));F(Ee=>Ee.map(Z=>({...Z,style:{...Z.style,opacity:se.has(Z.id)?1:.3,filter:se.has(Z.id)?"brightness(1.2)":"brightness(0.8)"}}))),V({title:"",description:` ${H.length} `})}catch(H){console.error(":",H),V({title:"",description:H instanceof Error?H.message:"",variant:"destructive"})}},[x,V]),_e=d.useCallback(()=>{F(H=>H.map(se=>({...se,style:{...se.style,opacity:1,filter:"brightness(1)"}})))},[]),pe=d.useCallback(()=>{D(!1),P(!0),oe()},[oe]),ke=d.useCallback(()=>{T(!1),setTimeout(()=>{oe(!0)},0)},[oe]),O=d.useCallback((H,se)=>{A.find(Z=>Z.id===se.id)&&ve({id:se.id,type:se.type,content:se.data.content})},[A]);d.useEffect(()=>{R||S&&oe()},[g,f,R,S]);const k=d.useCallback((H,se)=>{const Ee=A.find(ns=>ns.id===se.source),Z=A.find(ns=>ns.id===se.target),Oe=J.find(ns=>ns.id===se.id);Ee&&Z&&Oe&&z({source:{id:Ee.id,type:Ee.type,content:Ee.data.content},target:{id:Z.id,type:Z.type,content:Z.data.content},edge:{source:se.source,target:se.target,weight:parseFloat(se.label||"0")}})},[A,J]);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b bg-background",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1",children:""})]}),c&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(Se,{variant:"outline",className:"gap-1",children:[e.jsx(Hr,{className:"h-3 w-3"}),": ",c.total_nodes]}),e.jsxs(Se,{variant:"outline",className:"gap-1",children:[e.jsx(Bj,{className:"h-3 w-3"}),": ",c.total_edges]}),e.jsxs(Se,{variant:"outline",className:"gap-1",children:[e.jsx(Ht,{className:"h-3 w-3"}),": ",c.entity_nodes]}),e.jsxs(Se,{variant:"outline",className:"gap-1",children:[e.jsx(Ca,{className:"h-3 w-3"}),": ",c.paragraph_nodes]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(le,{placeholder:"...",value:x,onChange:H=>h(H.target.value),onKeyDown:H=>H.key==="Enter"&&K(),className:"flex-1"}),e.jsx(_,{onClick:K,size:"sm",children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx(_,{onClick:_e,variant:"outline",size:"sm",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ie,{value:f,onValueChange:H=>p(H),children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),e.jsx(X,{value:"entity",children:""}),e.jsx(X,{value:"paragraph",children:""})]})]}),e.jsxs(Ie,{value:g===1e4?"all":w?"custom":g.toString(),onValueChange:H=>{H==="custom"?(b(!0),y(g.toString())):H==="all"?(b(!1),N(1e4)):(b(!1),N(Number(H)))},children:[e.jsx($e,{className:"w-[120px]",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"50",children:"50 "}),e.jsx(X,{value:"100",children:"100 "}),e.jsx(X,{value:"200",children:"200 "}),e.jsx(X,{value:"500",children:"500 "}),e.jsx(X,{value:"1000",children:"1000 "}),e.jsx(X,{value:"all",children:" (10000)"}),e.jsx(X,{value:"custom",children:"..."})]})]}),w&&e.jsx(le,{type:"number",min:"50",value:v,onChange:H=>y(H.target.value),onBlur:()=>{const H=parseInt(v);!isNaN(H)&&H>=50?N(H):(y("50"),N(50))},onKeyDown:H=>{if(H.key==="Enter"){const se=parseInt(v);!isNaN(se)&&se>=50?N(se):(y("50"),N(50))}},placeholder:"50",className:"w-[120px]"}),e.jsx(_,{onClick:()=>oe(),variant:"outline",size:"sm",disabled:n,children:e.jsx(dt,{className:I("h-4 w-4",n&&"animate-spin")})})]})]})]}),e.jsx("div",{className:"flex-1 relative",children:n?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(dt,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"..."})]})}):A.length===0?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Hr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-muted-foreground",children:""})]})}):e.jsxs(V_,{nodes:A,edges:J,onNodesChange:L,onEdgesChange:ue,onNodeClick:O,onEdgeClick:k,nodeTypes:tk,fitView:!0,minZoom:.05,maxZoom:1.5,defaultViewport:{x:0,y:0,zoom:.5},elevateNodesOnSelect:xe<=500,nodesDraggable:xe<=1e3,attributionPosition:"bottom-left",children:[e.jsx(q_,{variant:K_.Dots,gap:12,size:1}),e.jsx(Q_,{}),xe<=500&&e.jsx(Y_,{nodeColor:B,nodeBorderRadius:8,pannable:!0,zoomable:!0}),e.jsxs(J_,{position:"top-right",className:"bg-background/95 backdrop-blur-sm rounded-lg border p-3 shadow-lg",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:""}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-blue-500 to-blue-600 border-2 border-blue-700"}),e.jsx("span",{children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-green-500 to-green-600 border-2 border-green-700"}),e.jsx("span",{children:""})]}),xe>200&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-yellow-600 dark:text-yellow-500",children:[e.jsx("div",{className:"font-semibold",children:""}),e.jsx("div",{children:""}),xe>500&&e.jsx("div",{children:""})]})]})]})]})}),e.jsx(Is,{open:!!ne,onOpenChange:H=>!H&&ve(null),children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ds,{children:e.jsx(Rs,{children:""})}),ne&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(Se,{variant:ne.type==="entity"?"default":"secondary",children:ne.type==="entity"?" ":" "})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ID"}),e.jsx("code",{className:"mt-1 block p-2 bg-muted rounded text-xs break-all",children:ne.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx(Ye,{className:"mt-1 h-40 p-3 bg-muted rounded",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:ne.content})})]})]})]})}),e.jsx(Is,{open:!!je,onOpenChange:H=>!H&&z(null),children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx(Ds,{children:e.jsx(Rs,{children:""})}),je&&e.jsx(Ye,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-blue-50 dark:bg-blue-950 rounded border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:je.source.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[je.source.id.slice(0,40),"..."]})]}),e.jsx("div",{className:"text-2xl text-muted-foreground flex-shrink-0",children:""}),e.jsxs("div",{className:"flex-1 min-w-0 p-3 bg-green-50 dark:bg-green-950 rounded border-2 border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"font-medium text-sm mb-2 truncate",children:je.target.content}),e.jsxs("code",{className:"text-xs text-muted-foreground truncate block",children:[je.target.id.slice(0,40),"..."]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:""}),e.jsx("div",{className:"mt-1",children:e.jsx(Se,{variant:"outline",className:"text-base font-mono",children:je.edge.weight.toFixed(4)})})]})]})})]})}),e.jsx(vs,{open:R,onOpenChange:D,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:""}),e.jsxs(hs,{children:["",e.jsx("br",{}),"?"]})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>l({to:"/"}),children:" ()"}),e.jsx(fs,{onClick:pe,children:""})]})]})}),e.jsx(vs,{open:M,onOpenChange:T,children:e.jsxs(ds,{children:[e.jsxs(us,{children:[e.jsx(xs,{children:" "}),e.jsx(hs,{asChild:!0,children:e.jsxs("div",{children:[e.jsxs("p",{children:[" ",e.jsx("strong",{className:"text-orange-600",children:g>=1e4?" (10000)":g})," "]}),e.jsx("p",{className:"mt-4",children:":"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:""}),e.jsx("li",{children:""}),e.jsx("li",{children:""})]}),e.jsx("p",{className:"mt-4",children:" (50-200 )"})]})})]}),e.jsxs(ms,{children:[e.jsx(ps,{onClick:()=>{T(!1),g>200&&(N(50),b(!1))},children:""}),e.jsx(fs,{onClick:ke,className:"bg-orange-600 hover:bg-orange-700",children:""})]})]})})]})}function nk(){return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-none border-b bg-card/50 px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:""}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:""})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"mx-auto max-w-4xl",children:e.jsxs(Ce,{children:[e.jsxs(De,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-20 w-20 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Hr,{className:"h-10 w-10 text-primary"})}),e.jsx(Le,{className:"text-2xl",children:""}),e.jsx(ws,{className:"text-base",children:""})]}),e.jsx(Ae,{className:"text-center text-sm text-muted-foreground",children:e.jsx("p",{children:""})})]})})})]})}function Rg({className:l,classNames:n,showOutsideDays:i=!0,captionLayout:c="label",buttonVariant:u="ghost",formatters:x,components:h,...f}){const p=sv();return e.jsx(R_,{showOutsideDays:i,className:I("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,l),captionLayout:c,formatters:{formatMonthDropdown:g=>g.toLocaleString("default",{month:"short"}),...x},classNames:{root:I("w-fit",p.root),months:I("relative flex flex-col gap-4 md:flex-row",p.months),month:I("flex w-full flex-col gap-4",p.month),nav:I("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",p.nav),button_previous:I(qr({variant:u}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_previous),button_next:I(qr({variant:u}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",p.button_next),month_caption:I("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",p.month_caption),dropdowns:I("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",p.dropdowns),dropdown_root:I("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",p.dropdown_root),dropdown:I("bg-popover absolute inset-0 opacity-0",p.dropdown),caption_label:I("select-none font-medium",c==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",p.caption_label),table:"w-full border-collapse",weekdays:I("flex",p.weekdays),weekday:I("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",p.weekday),week:I("mt-2 flex w-full",p.week),week_number_header:I("w-[--cell-size] select-none",p.week_number_header),week_number:I("text-muted-foreground select-none text-[0.8rem]",p.week_number),day:I("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",p.day),range_start:I("bg-accent rounded-l-md",p.range_start),range_middle:I("rounded-none",p.range_middle),range_end:I("bg-accent rounded-r-md",p.range_end),today:I("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",p.today),outside:I("text-muted-foreground aria-selected:text-muted-foreground",p.outside),disabled:I("text-muted-foreground opacity-50",p.disabled),hidden:I("invisible",p.hidden),...n},components:{Root:({className:g,rootRef:N,...v})=>e.jsx("div",{"data-slot":"calendar",ref:N,className:I(g),...v}),Chevron:({className:g,orientation:N,...v})=>N==="left"?e.jsx(Aa,{className:I("size-4",g),...v}):N==="right"?e.jsx(Zt,{className:I("size-4",g),...v}):e.jsx(za,{className:I("size-4",g),...v}),DayButton:rk,WeekNumber:({children:g,...N})=>e.jsx("td",{...N,children:e.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:g})}),...h},...f})}function rk({className:l,day:n,modifiers:i,...c}){const u=sv(),x=d.useRef(null);return d.useEffect(()=>{i.focused&&x.current?.focus()},[i.focused]),e.jsx(_,{ref:x,variant:"ghost",size:"icon","data-day":n.date.toLocaleDateString(),"data-selected-single":i.selected&&!i.range_start&&!i.range_end&&!i.range_middle,"data-range-start":i.range_start,"data-range-end":i.range_end,"data-range-middle":i.range_middle,className:I("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",u.day,l),...c})}const To={xs:{label:"",rowHeight:28,class:"text-[10px] sm:text-xs"},sm:{label:"",rowHeight:36,class:"text-xs sm:text-sm"},base:{label:"",rowHeight:44,class:"text-sm sm:text-base"}};function ik(){const[l,n]=d.useState([]),[i,c]=d.useState(""),[u,x]=d.useState("all"),[h,f]=d.useState("all"),[p,g]=d.useState(void 0),[N,v]=d.useState(void 0),[y,w]=d.useState(!0),[b,R]=d.useState(!1),[D,S]=d.useState("xs"),[P,M]=d.useState(4),[T,A]=d.useState(!1),F=d.useRef(null);d.useEffect(()=>{const K=In.getAllLogs();n(K);const _e=In.onLog(()=>{n(In.getAllLogs())}),pe=In.onConnectionChange(ke=>{R(ke)});return()=>{_e(),pe()}},[]);const L=d.useMemo(()=>{const K=new Set(l.map(_e=>_e.module).filter(_e=>_e&&_e.trim()!==""));return Array.from(K).sort()},[l]),J=K=>{switch(K){case"DEBUG":return"text-muted-foreground";case"INFO":return"text-blue-500 dark:text-blue-400";case"WARNING":return"text-yellow-600 dark:text-yellow-500";case"ERROR":return"text-red-600 dark:text-red-500";case"CRITICAL":return"text-red-700 dark:text-red-400 font-bold";default:return"text-foreground"}},U=K=>{switch(K){case"DEBUG":return"bg-gray-800/30 dark:bg-gray-800/50";case"INFO":return"bg-blue-900/20 dark:bg-blue-500/20";case"WARNING":return"bg-yellow-900/20 dark:bg-yellow-500/20";case"ERROR":return"bg-red-900/20 dark:bg-red-500/20";case"CRITICAL":return"bg-red-900/30 dark:bg-red-600/30";default:return"bg-gray-800/20 dark:bg-gray-800/30"}},ue=()=>{window.location.reload()},xe=()=>{In.clearLogs(),n([])},he=()=>{const K=je.map(O=>`${O.timestamp} [${O.level.padEnd(8)}] [${O.module}] ${O.message}`).join(`
`),_e=new Blob([K],{type:"text/plain;charset=utf-8"}),pe=URL.createObjectURL(_e),ke=document.createElement("a");ke.href=pe,ke.download=`logs-${vm(new Date,"yyyy-MM-dd-HHmmss")}.txt`,ke.click(),URL.revokeObjectURL(pe)},ne=()=>{w(!y)},ve=()=>{g(void 0),v(void 0)},je=d.useMemo(()=>l.filter(K=>{const _e=i===""||K.message.toLowerCase().includes(i.toLowerCase())||K.module.toLowerCase().includes(i.toLowerCase()),pe=u==="all"||K.level===u,ke=h==="all"||K.module===h;let O=!0;if(p||N){const k=new Date(K.timestamp);if(p){const H=new Date(p);H.setHours(0,0,0,0),O=O&&k>=H}if(N){const H=new Date(N);H.setHours(23,59,59,999),O=O&&k<=H}}return _e&&pe&&ke&&O}),[l,i,u,h,p,N]),z=To[D].rowHeight+P,V=N0({count:je.length,getScrollElement:()=>F.current,estimateSize:()=>z,overscan:50}),B=d.useRef(!1),oe=d.useRef(je.length);return d.useEffect(()=>{const K=F.current;if(!K)return;const _e=()=>{if(B.current)return;const{scrollTop:pe,scrollHeight:ke,clientHeight:O}=K,k=ke-pe-O;k>100&&y?w(!1):k<50&&!y&&w(!0)};return K.addEventListener("scroll",_e,{passive:!0}),()=>K.removeEventListener("scroll",_e)},[y]),d.useEffect(()=>{const K=je.length>oe.current;oe.current=je.length,y&&je.length>0&&K&&(B.current=!0,V.scrollToIndex(je.length-1,{align:"end",behavior:"auto"}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{B.current=!1})}))},[je.length,y,V]),e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 space-y-2 sm:space-y-3 p-2 sm:p-3 lg:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 hidden sm:block",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:I("h-2 w-2 sm:h-2.5 sm:w-2.5 rounded-full",b?"bg-green-500 animate-pulse":"bg-red-500")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:b?"":""})]})]}),e.jsx(Ce,{className:"p-2 sm:p-3",children:e.jsx(nc,{open:T,onOpenChange:A,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(Tt,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:i,onChange:K=>c(K.target.value),className:"pl-8 h-8 text-xs sm:text-sm"})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(_,{variant:y?"default":"outline",size:"sm",onClick:ne,className:"h-8 px-2",title:y?"":"",children:[y?e.jsx(l_,{className:"h-3.5 w-3.5"}):e.jsx(n_,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden sm:inline",children:y?"":""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:xe,className:"h-8 px-2",title:"",children:[e.jsx(ls,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden md:inline",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:he,className:"h-8 px-2 hidden sm:flex",title:"",children:[e.jsx(sa,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"ml-1 text-xs hidden lg:inline",children:""})]}),e.jsx(rc,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:"h-8 px-2",title:T?"":"",children:[e.jsx(zo,{className:"h-3.5 w-3.5"}),T?e.jsx(Fr,{className:"h-3.5 w-3.5 ml-1"}):e.jsx(za,{className:"h-3.5 w-3.5 ml-1"})]})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center sm:text-right -mt-1",children:[e.jsxs("span",{className:"font-mono",children:[je.length," / ",l.length]}),e.jsx("span",{className:"ml-1",children:""})]}),e.jsxs(ic,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(Ie,{value:u,onValueChange:x,children:[e.jsxs($e,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(zo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Pe,{placeholder:""})]}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),e.jsx(X,{value:"DEBUG",children:"DEBUG"}),e.jsx(X,{value:"INFO",children:"INFO"}),e.jsx(X,{value:"WARNING",children:"WARNING"}),e.jsx(X,{value:"ERROR",children:"ERROR"}),e.jsx(X,{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsxs(Ie,{value:h,onValueChange:f,children:[e.jsxs($e,{className:"w-full sm:flex-1 h-8 text-xs",children:[e.jsx(zo,{className:"h-3.5 w-3.5 mr-1.5"}),e.jsx(Pe,{placeholder:""})]}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),L.map(K=>e.jsx(X,{value:K,children:K},K))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-2",children:[e.jsxs(ol,{children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:I("w-full sm:flex-1 justify-start text-left font-normal h-8",!p&&"text-muted-foreground"),children:[e.jsx($o,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:p?vm(p,"PP",{locale:ko}):""})]})}),e.jsx(Wa,{className:"w-auto p-0",align:"start",children:e.jsx(Rg,{mode:"single",selected:p,onSelect:g,initialFocus:!0,locale:ko})})]}),e.jsxs(ol,{children:[e.jsx(dl,{asChild:!0,children:e.jsxs(_,{variant:"outline",size:"sm",className:I("w-full sm:flex-1 justify-start text-left font-normal h-8",!N&&"text-muted-foreground"),children:[e.jsx($o,{className:"mr-1.5 h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:N?vm(N,"PP",{locale:ko}):""})]})}),e.jsx(Wa,{className:"w-auto p-0",align:"start",children:e.jsx(Rg,{mode:"single",selected:N,onSelect:v,initialFocus:!0,locale:ko})})]}),(p||N)&&e.jsxs(_,{variant:"outline",size:"sm",onClick:ve,className:"w-full sm:w-auto h-8",children:[e.jsx(Ea,{className:"h-3.5 w-3.5 sm:mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3 pt-2 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(r_,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:""})]}),e.jsx("div",{className:"flex gap-1",children:Object.keys(To).map(K=>e.jsx(_,{variant:D===K?"default":"outline",size:"sm",onClick:()=>S(K),className:"h-6 px-2 text-xs",children:To[K].label},K))})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:""}),e.jsx(qa,{value:[P],onValueChange:([K])=>M(K),min:0,max:12,step:2,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-7",children:[P,"px"]})]}),e.jsxs("div",{className:"flex gap-2 sm:hidden",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:ue,className:"flex-1 h-8",children:[e.jsx(dt,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:he,className:"flex-1 h-8",children:[e.jsx(sa,{className:"h-3.5 w-3.5 mr-1"}),e.jsx("span",{className:"text-xs",children:""})]})]})]})]})]})})})]}),e.jsx("div",{className:"flex-1 min-h-0 px-2 sm:px-3 lg:px-4 pb-2 sm:pb-3 lg:pb-4",children:e.jsx(Ce,{className:"bg-black dark:bg-gray-950 border-gray-800 dark:border-gray-900 h-full overflow-hidden",children:e.jsx("div",{ref:F,className:I("h-full overflow-auto","[&::-webkit-scrollbar]:w-2.5","[&::-webkit-scrollbar-track]:bg-transparent","[&::-webkit-scrollbar-thumb]:bg-border [&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-thumb:hover]:bg-border/80"),children:e.jsx("div",{className:I("p-2 sm:p-3 font-mono relative",To[D].class),style:{height:`${V.getTotalSize()}px`},children:je.length===0?e.jsx("div",{className:"text-gray-500 dark:text-gray-600 text-center py-8 text-xs sm:text-sm",children:""}):V.getVirtualItems().map(K=>{const _e=je[K.index];return e.jsxs("div",{"data-index":K.index,ref:V.measureElement,className:I("absolute top-0 left-0 w-full px-2 sm:px-3 rounded hover:bg-white/5 transition-colors",U(_e.level)),style:{transform:`translateY(${K.start}px)`,paddingTop:`${P/2}px`,paddingBottom:`${P/2}px`},children:[e.jsxs("div",{className:"flex flex-col gap-0.5 sm:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 text-[10px]",children:_e.timestamp}),e.jsxs("span",{className:I("font-semibold text-[10px]",J(_e.level)),children:["[",_e.level,"]"]})]}),e.jsx("div",{className:"text-cyan-400 dark:text-cyan-500 truncate text-[10px]",children:_e.module}),e.jsx("div",{className:"text-gray-300 dark:text-gray-400 whitespace-pre-wrap break-words text-[10px]",children:_e.message})]}),e.jsxs("div",{className:"hidden sm:flex gap-2 items-start",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-600 flex-shrink-0 w-[130px] lg:w-[160px]",children:_e.timestamp}),e.jsxs("span",{className:I("flex-shrink-0 w-[65px] lg:w-[75px] font-semibold",J(_e.level)),children:["[",_e.level,"]"]}),e.jsx("span",{className:"text-cyan-400 dark:text-cyan-500 flex-shrink-0 w-[100px] lg:w-[130px] truncate",children:_e.module}),e.jsx("span",{className:"text-gray-300 dark:text-gray-400 flex-1 whitespace-pre-wrap break-words",children:_e.message})]})]},K.key)})})})})})]})}async function ck(){return(await we("/api/planner/overview")).json()}async function ok(l,n=1,i=20,c){const u=new URLSearchParams({page:n.toString(),page_size:i.toString()});return c&&u.append("search",c),(await we(`/api/planner/chat/${l}/logs?${u}`)).json()}async function dk(l,n){return(await we(`/api/planner/log/${l}/${n}`)).json()}async function uk(){return(await we("/api/replier/overview")).json()}async function mk(l,n=1,i=20,c){const u=new URLSearchParams({page:n.toString(),page_size:i.toString()});return c&&u.append("search",c),(await we(`/api/replier/chat/${l}/logs?${u}`)).json()}async function xk(l,n){return(await we(`/api/replier/log/${l}/${n}`)).json()}function Ov(){const[l,n]=d.useState(new Map),[i,c]=d.useState(!0),u=d.useCallback(async()=>{try{c(!0);const h=await Zm();if(h?.data){const f=new Map;h.data.forEach(p=>{f.set(p.chat_id,p.chat_name)}),n(f)}}catch(h){console.error(":",h)}finally{c(!1)}},[]);d.useEffect(()=>{u()},[u]);const x=d.useCallback(h=>l.get(h)||h,[l]);return{chatNameMap:l,getChatName:x,loading:i,reload:u}}function Fo(l){return new Date(l*1e3).toLocaleString("zh-CN")}function Dv(l){const i=Date.now()/1e3-l;return i<60?"":i<3600?`${Math.floor(i/60)} `:i<86400?`${Math.floor(i/3600)} `:`${Math.floor(i/86400)} `}function Rv(l,n,i=1e4){d.useEffect(()=>{if(!l)return;const c=setInterval(n,i);return()=>clearInterval(c)},[l,n,i])}function hk({autoRefresh:l,refreshKey:n}){const[i,c]=d.useState("overview"),[u,x]=d.useState(null),{getChatName:h}=Ov(),[f,p]=d.useState(null),[g,N]=d.useState(!0),[v,y]=d.useState(null),[w,b]=d.useState(!1),[R,D]=d.useState(1),[S,P]=d.useState(20),[M,T]=d.useState(""),[A,F]=d.useState(""),[L,J]=d.useState(""),[U,ue]=d.useState(null),[xe,he]=d.useState(!1),[ne,ve]=d.useState(!1),je=d.useCallback(async()=>{try{N(!0);const k=await ck();p(k)}catch(k){console.error(":",k)}finally{N(!1)}},[]),z=d.useCallback(async()=>{if(u)try{b(!0);const k=await ok(u.chat_id,R,S,A||void 0);y(k)}catch(k){console.error(":",k)}finally{b(!1)}},[u,R,S,A]);d.useEffect(()=>{je()},[je]),d.useEffect(()=>{n>0&&(i==="overview"?je():z())},[n,i,je,z]),d.useEffect(()=>{i==="chat-logs"&&u&&z()},[i,u,z]),Rv(l,d.useCallback(()=>{i==="overview"?je():z()},[i,je,z]));const V=k=>{x(k),D(1),F(""),J(""),c("chat-logs")},B=()=>{c("overview"),x(null),y(null),F(""),J("")},oe=()=>{F(L),D(1)},K=()=>{J(""),F(""),D(1)},_e=async(k,H)=>{try{ve(!0),he(!0);const se=await dk(k,H);ue(se)}catch(se){console.error(":",se)}finally{ve(!1)}},pe=k=>{P(Number(k)),D(1)},ke=()=>{const k=parseInt(M),H=v?Math.ceil(v.total/v.page_size):0;!isNaN(k)&&k>=1&&k<=H&&(D(k),T(""))},O=v?Math.ceil(v.total/v.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:i==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Vm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_plans||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((k,H)=>e.jsx(js,{className:"h-24 w-full"},H))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(k=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>V(k),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(k.chat_id),children:h(k.chat_id)})]}),e.jsx(Se,{variant:"secondary",children:k.plan_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",Dv(k.latest_timestamp)]})]},k.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(Ta,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:u?h(u.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",v?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:u?h(u.chat_id):""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{placeholder:"...",value:L,onChange:k=>J(k.target.value),onKeyDown:k=>k.key==="Enter"&&oe(),className:"w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:oe,children:e.jsx(Tt,{className:"h-4 w-4"})}),A&&e.jsx(_,{variant:"ghost",size:"sm",onClick:K,children:""})]}),e.jsxs(Ie,{value:S.toString(),onValueChange:pe,children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"10",children:"10/"}),e.jsx(X,{value:"20",children:"20/"}),e.jsx(X,{value:"50",children:"50/"}),e.jsx(X,{value:"100",children:"100/"})]})]})]})]}),A&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',A,'"']})]})]}),e.jsx(Ae,{children:w?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((k,H)=>e.jsx(js,{className:"h-20 w-full"},H))}):v?.data&&v.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:v.data.map(k=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e(k.chat_id,k.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Fo(k.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(Se,{variant:"secondary",className:"text-xs",children:[k.action_count," "]}),e.jsxs(Se,{variant:"outline",className:"text-xs",children:[k.total_plan_ms.toFixed(0),"ms"]})]})]}),k.action_types&&k.action_types.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:k.action_types.map((H,se)=>e.jsx(Se,{variant:"outline",className:"text-xs bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800",children:H},se))}),e.jsx("p",{className:"text-sm line-clamp-2",children:k.reasoning_preview||""})]},k.filename))}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",v.total,"  ",R," / ",O," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(1),disabled:R===1,children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(k=>Math.max(1,k-1)),disabled:R===1,children:e.jsx(Aa,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",min:1,max:O,value:M,onChange:k=>T(k.target.value),onKeyDown:k=>k.key==="Enter"&&ke(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:ke,children:""})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(k=>Math.min(O,k+1)),disabled:R===O,children:e.jsx(Zt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(O),disabled:R===O,children:e.jsx(jn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Is,{open:xe,onOpenChange:he,children:e.jsxs(Os,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(Ca,{className:"h-5 w-5"}),""]}),e.jsx(Ks,{children:""})]}),e.jsx(Ye,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:ne?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((k,H)=>e.jsx(js,{className:"h-24 w-full"},H))}):U?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:U.chat_id,children:h(U.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Fo(U.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx(Se,{variant:"outline",children:U.type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(Se,{children:[U.actions.length," "]})]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Za,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Le,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.prompt_build_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Le,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.llm_duration_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Le,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.total_plan_ms?.toFixed(2)||0,"ms"]})})]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Xm,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:U.reasoning||""})})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(i_,{className:"h-4 w-4"})," (",U.actions.length,")"]}),e.jsx("div",{className:"space-y-3",children:U.actions.map((k,H)=>e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Se,{variant:"default",children:[" ",H+1]}),e.jsx(Se,{variant:"outline",children:k.action_type})]})})}),e.jsxs(Ae,{className:"p-4 pt-0 space-y-3",children:[k.reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof k.reasoning=="string"?k.reasoning:JSON.stringify(k.reasoning)})]}),k.action_message&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),typeof k.action_message=="string"?e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded break-all whitespace-pre-wrap",children:k.action_message}):e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify(k.action_message,null,2)})]}),k.action_data&&Object.keys(k.action_data).length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("pre",{className:"text-xs bg-muted/30 p-2 rounded overflow-x-auto",children:JSON.stringify(k.action_data,null,2)})]}),k.action_reasoning&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:""}),e.jsx("p",{className:"text-sm bg-muted/30 p-2 rounded",children:typeof k.action_reasoning=="string"?k.action_reasoning:JSON.stringify(k.action_reasoning)})]})]})]},H))})]}),e.jsx(Yt,{}),U.raw_output&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:U.raw_output})})]})]}),U.prompt&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:U.prompt})})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(st,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>he(!1),children:""})})]})})]})}function fk({autoRefresh:l,refreshKey:n}){const[i,c]=d.useState("overview"),[u,x]=d.useState(null),{getChatName:h}=Ov(),[f,p]=d.useState(null),[g,N]=d.useState(!0),[v,y]=d.useState(null),[w,b]=d.useState(!1),[R,D]=d.useState(1),[S,P]=d.useState(20),[M,T]=d.useState(""),[A,F]=d.useState(""),[L,J]=d.useState(""),[U,ue]=d.useState(null),[xe,he]=d.useState(!1),[ne,ve]=d.useState(!1),je=d.useCallback(async()=>{try{N(!0);const k=await uk();p(k)}catch(k){console.error(":",k)}finally{N(!1)}},[]),z=d.useCallback(async()=>{if(u)try{b(!0);const k=await mk(u.chat_id,R,S,A||void 0);y(k)}catch(k){console.error(":",k)}finally{b(!1)}},[u,R,S,A]);d.useEffect(()=>{je()},[je]),d.useEffect(()=>{n>0&&(i==="overview"?je():z())},[n,i,je,z]),d.useEffect(()=>{i==="chat-logs"&&u&&z()},[i,u,z]),Rv(l,d.useCallback(()=>{i==="overview"?je():z()},[i,je,z]));const V=k=>{x(k),D(1),F(""),J(""),c("chat-logs")},B=()=>{c("overview"),x(null),y(null),F(""),J("")},oe=()=>{F(L),D(1)},K=()=>{J(""),F(""),D(1)},_e=async(k,H)=>{try{ve(!0),he(!0);const se=await xk(k,H);ue(se)}catch(se){console.error(":",se)}finally{ve(!1)}},pe=k=>{P(Number(k)),D(1)},ke=()=>{const k=parseInt(M),H=v?Math.ceil(v.total/v.page_size):0;!isNaN(k)&&k>=1&&k<=H&&(D(k),T(""))},O=v?Math.ceil(v.total/v.page_size):0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:i==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_chats||0})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(Vm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Ae,{children:g?e.jsx(js,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold",children:f?.total_replies||0})})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:g?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((k,H)=>e.jsx(js,{className:"h-24 w-full"},H))}):f?.chats&&f.chats.length>0?e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:f.chats.map(k=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>V(k),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate max-w-[180px]",title:h(k.chat_id),children:h(k.chat_id)})]}),e.jsx(Se,{variant:"secondary",children:k.reply_count})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[": ",Dv(k.latest_timestamp)]})]},k.chat_id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(Ta,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[": ",e.jsx("span",{className:"font-medium",children:u?h(u.chat_id):""}),e.jsx("span",{className:"mx-2",children:""})," ",v?.total||0," "]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:u?h(u.chat_id):""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{placeholder:"...",value:L,onChange:k=>J(k.target.value),onKeyDown:k=>k.key==="Enter"&&oe(),className:"w-48"}),e.jsx(_,{variant:"outline",size:"icon",onClick:oe,children:e.jsx(Tt,{className:"h-4 w-4"})}),A&&e.jsx(_,{variant:"ghost",size:"sm",onClick:K,children:""})]}),e.jsxs(Ie,{value:S.toString(),onValueChange:pe,children:[e.jsx($e,{className:"w-32",children:e.jsx(Pe,{})}),e.jsxs(Be,{children:[e.jsx(X,{value:"10",children:"10/"}),e.jsx(X,{value:"20",children:"20/"}),e.jsx(X,{value:"50",children:"50/"}),e.jsx(X,{value:"100",children:"100/"})]})]})]})]}),A&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[": ",e.jsxs("span",{className:"font-medium",children:['"',A,'"']})]})]}),e.jsx(Ae,{children:w?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((k,H)=>e.jsx(js,{className:"h-20 w-full"},H))}):v?.data&&v.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:v.data.map(k=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-accent/50 transition-colors cursor-pointer",onClick:()=>_e(k.chat_id,k.filename),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:Fo(k.timestamp)}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[k.success?e.jsxs(Se,{variant:"default",className:"text-xs bg-green-600",children:[e.jsx(ig,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(Se,{variant:"destructive",className:"text-xs",children:[e.jsx(Va,{className:"h-3 w-3 mr-1"}),""]}),e.jsx(Se,{variant:"outline",className:"text-xs",children:k.model}),e.jsxs(Se,{variant:"secondary",className:"text-xs",children:[k.overall_ms.toFixed(0),"ms"]})]})]}),e.jsx("p",{className:"text-sm line-clamp-2",children:k.output_preview||""})]},k.filename))}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",v.total,"  ",R," / ",O," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(1),disabled:R===1,children:e.jsx(gn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(k=>Math.max(1,k-1)),disabled:R===1,children:e.jsx(Aa,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",min:1,max:O,value:M,onChange:k=>T(k.target.value),onKeyDown:k=>k.key==="Enter"&&ke(),placeholder:"",className:"w-20 h-8"}),e.jsx(_,{size:"sm",variant:"outline",onClick:ke,children:""})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(k=>Math.min(O,k+1)),disabled:R===O,children:e.jsx(Zt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>D(O),disabled:R===O,children:e.jsx(jn,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:""})})]})]})}),e.jsx(Is,{open:xe,onOpenChange:he,children:e.jsxs(Os,{className:"max-w-4xl max-h-[80vh] grid grid-rows-[auto_1fr_auto] overflow-hidden",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(Ca,{className:"h-5 w-5"}),""]}),e.jsx(Ks,{children:""})]}),e.jsx(Ye,{className:"h-full pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:ne?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((k,H)=>e.jsx(js,{className:"h-24 w-full"},H))}):U?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",title:U.chat_id,children:h(U.chat_id)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsx("div",{className:"text-sm",children:Fo(U.timestamp)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),U.success?e.jsxs(Se,{variant:"default",className:"bg-green-600",children:[e.jsx(ig,{className:"h-3 w-3 mr-1"}),""]}):e.jsxs(Se,{variant:"destructive",children:[e.jsx(Va,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:""}),e.jsxs(Se,{variant:"outline",children:["Level ",U.think_level]})]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(c_,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx(Se,{variant:"secondary",className:"text-sm",children:U.model})})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Za,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Le,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.prompt_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Le,{className:"text-xs text-muted-foreground",children:"LLM "})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.llm_ms?.toFixed(2)||0,"ms"]})})]}),e.jsxs(Ce,{children:[e.jsx(De,{className:"p-4 pb-2",children:e.jsx(Le,{className:"text-xs text-muted-foreground",children:""})}),e.jsx(Ae,{className:"p-4 pt-0",children:e.jsxs("div",{className:"text-xl font-bold",children:[U.timing.overall_ms?.toFixed(2)||0,"ms"]})})]})]}),U.timing.timing_logs&&U.timing.timing_logs.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"space-y-1",children:U.timing.timing_logs.map((k,H)=>e.jsx("div",{className:"text-xs text-muted-foreground",children:k},H))})]}),U.timing.almost_zero&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),U.timing.almost_zero]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Xm,{className:"h-4 w-4"}),""]}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:U.output||""})})]}),U.processed_output&&U.processed_output.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-2",children:U.processed_output.map((k,H)=>e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:k})},H))})]})]}),U.reasoning&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:U.reasoning})})]})]}),U.error&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-destructive",children:""}),e.jsx("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:e.jsx("p",{className:"text-sm text-destructive whitespace-pre-wrap",children:U.error})})]})]}),U.prompt&&e.jsxs(e.Fragment,{children:[e.jsx(Yt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:""}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground",children:""}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-lg",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap break-words",children:U.prompt})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:""})})})}),e.jsx(st,{className:"flex-shrink-0",children:e.jsx(_,{onClick:()=>he(!1),children:""})})]})})]})}function pk(){const[l,n]=d.useState("planner"),[i,c]=d.useState(!1),[u,x]=d.useState(0),h=d.useCallback(()=>{x(f=>f+1)},[]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:" & "}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:i?"default":"outline",size:"sm",onClick:()=>c(!i),children:[e.jsx(dt,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),i?"":""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:h,children:e.jsx(dt,{className:"h-4 w-4"})})]})]}),e.jsxs(ta,{value:l,onValueChange:f=>n(f),className:"w-full",children:[e.jsxs(Xt,{className:"grid w-full grid-cols-2 gap-0.5 sm:gap-1 h-auto p-1",children:[e.jsxs(Je,{value:"planner",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(Gm,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]}),e.jsxs(Je,{value:"replier",className:"gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3 py-2",children:[e.jsx(o_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4",strokeWidth:2,fill:"none"}),e.jsx("span",{children:""})]})]}),e.jsxs(Ye,{className:"h-[calc(100vh-240px)] sm:h-[calc(100vh-280px)] mt-4 sm:mt-6",children:[e.jsx(ys,{value:"planner",className:"mt-0",children:e.jsx(hk,{autoRefresh:i,refreshKey:u})}),e.jsx(ys,{value:"replier",className:"mt-0",children:e.jsx(fk,{autoRefresh:i,refreshKey:u})})]})]})]})}const gk="Mai-with-u",jk="plugin-repo",vk="main",Nk="plugin_details.json";async function bk(){try{const l=await we("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:gk,repo:jk,branch:vk,file_path:Nk})});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const n=await l.json();if(!n.success||!n.data)throw new Error(n.error||"");return JSON.parse(n.data).filter(u=>!u?.id||!u?.manifest?(console.warn(":",u),!1):!u.manifest.name||!u.manifest.version?(console.warn(":",u.id),!1):!0).map(u=>({id:u.id,manifest:{manifest_version:u.manifest.manifest_version||1,name:u.manifest.name,version:u.manifest.version,description:u.manifest.description||"",author:u.manifest.author||{name:"Unknown"},license:u.manifest.license||"Unknown",host_application:u.manifest.host_application||{min_version:"0.0.0"},homepage_url:u.manifest.homepage_url,repository_url:u.manifest.repository_url,keywords:u.manifest.keywords||[],categories:u.manifest.categories||[],default_locale:u.manifest.default_locale||"zh-CN",locales_path:u.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()}))}catch(l){throw console.error("Failed to fetch plugin list:",l),l}}async function Lv(){try{const l=await we("/api/webui/plugins/git-status");if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){return console.error("Failed to check Git status:",l),{installed:!1,error:" Git "}}}async function Uv(){try{const l=await we("/api/webui/plugins/version");if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){return console.error("Failed to get Maimai version:",l),{version:"0.0.0",version_major:0,version_minor:0,version_patch:0}}}function $v(l,n,i){const c=l.split(".").map(f=>parseInt(f)||0),u=c[0]||0,x=c[1]||0,h=c[2]||0;if(i.version_major<u||i.version_major===u&&i.version_minor<x||i.version_major===u&&i.version_minor===x&&i.version_patch<h)return!1;if(n){const f=n.split(".").map(v=>parseInt(v)||0),p=f[0]||0,g=f[1]||0,N=f[2]||0;if(i.version_major>p||i.version_major===p&&i.version_minor>g||i.version_major===p&&i.version_minor===g&&i.version_patch>N)return!1}return!0}async function yk(){try{const l=await we("/api/webui/ws-token");if(!l.ok)return console.error(" WebSocket token :",l.status),null;const n=await l.json();return n.success&&n.token?n.token:null}catch(l){return console.error(" WebSocket token :",l),null}}async function wk(l,n){const i=await yk();if(!i)return console.warn(" WebSocket token"),null;const c=window.location.protocol==="https:"?"wss:":"ws:",u=window.location.host,x=`${c}//${u}/api/webui/ws/plugin-progress?token=${encodeURIComponent(i)}`;try{const h=new WebSocket(x);return h.onopen=()=>{console.log("Plugin progress WebSocket connected");const f=setInterval(()=>{h.readyState===WebSocket.OPEN?h.send("ping"):clearInterval(f)},3e4)},h.onmessage=f=>{try{if(f.data==="pong")return;const p=JSON.parse(f.data);l(p)}catch(p){console.error("Failed to parse progress data:",p)}},h.onerror=f=>{console.error("Plugin progress WebSocket error:",f),n?.(f)},h.onclose=()=>{console.log("Plugin progress WebSocket disconnected")},h}catch(h){return console.error(" WebSocket :",h),null}}async function Al(){try{const l=await we("/api/webui/plugins/installed",{headers:Fs()});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const n=await l.json();if(!n.success)throw new Error(n.message||"");return n.plugins||[]}catch(l){return console.error("Failed to get installed plugins:",l),[]}}function mn(l,n){return n.some(i=>i.id===l)}function xn(l,n){const i=n.find(c=>c.id===l);if(i)return i.manifest?.version||i.version}async function Bv(l,n,i="main"){const c=await we("/api/webui/plugins/install",{method:"POST",body:JSON.stringify({plugin_id:l,repository_url:n,branch:i})});if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return await c.json()}async function Iv(l){const n=await we("/api/webui/plugins/uninstall",{method:"POST",body:JSON.stringify({plugin_id:l})});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function Pv(l,n,i="main"){const c=await we("/api/webui/plugins/update",{method:"POST",body:JSON.stringify({plugin_id:l,repository_url:n,branch:i})});if(!c.ok){const u=await c.json();throw new Error(u.detail||"")}return await c.json()}async function _k(l){const n=await we(`/api/webui/plugins/config/${l}/schema`,{headers:Fs()});if(!n.ok){const c=await n.text();try{const u=JSON.parse(c);throw new Error(u.detail||" Schema ")}catch{throw new Error(` Schema  (${n.status})`)}}const i=await n.json();if(!i.success)throw new Error(i.message||" Schema ");return i.schema}async function Sk(l){const n=await we(`/api/webui/plugins/config/${l}`,{headers:Fs()});if(!n.ok){const c=await n.text();try{const u=JSON.parse(c);throw new Error(u.detail||"")}catch{throw new Error(` (${n.status})`)}}const i=await n.json();if(!i.success)throw new Error(i.message||"");return i.config}async function kk(l){const n=await we(`/api/webui/plugins/config/${l}/raw`,{headers:Fs()});if(!n.ok){const c=await n.text();try{const u=JSON.parse(c);throw new Error(u.detail||"")}catch{throw new Error(` (${n.status})`)}}const i=await n.json();if(!i.success)throw new Error(i.message||"");return i.config}async function Ck(l,n){const i=await we(`/api/webui/plugins/config/${l}`,{method:"PUT",headers:Fs(),body:JSON.stringify({config:n})});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return await i.json()}async function Tk(l,n){const i=await we(`/api/webui/plugins/config/${l}/raw`,{method:"PUT",headers:Fs(),body:JSON.stringify({config:n})});if(!i.ok){const c=await i.json();throw new Error(c.detail||"")}return await i.json()}async function Ek(l){const n=await we(`/api/webui/plugins/config/${l}/reset`,{method:"POST",headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}async function Mk(l){const n=await we(`/api/webui/plugins/config/${l}/toggle`,{method:"POST",headers:Fs()});if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return await n.json()}const uc="https://maibot-plugin-stats.maibot-webui.workers.dev";async function Hv(l){try{const n=await fetch(`${uc}/stats/${l}`);return n.ok?await n.json():(console.error("Failed to fetch plugin stats:",n.statusText),null)}catch(n){return console.error("Error fetching plugin stats:",n),null}}async function zk(l,n){try{const i=n||dx(),c=await fetch(`${uc}/stats/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l,user_id:i})}),u=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...u}:{success:!1,error:u.error||""}}catch(i){return console.error("Error liking plugin:",i),{success:!1,error:""}}}async function Ak(l,n){try{const i=n||dx(),c=await fetch(`${uc}/stats/dislike`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l,user_id:i})}),u=await c.json();return c.status===429?{success:!1,error:""}:c.ok?{success:!0,...u}:{success:!1,error:u.error||""}}catch(i){return console.error("Error disliking plugin:",i),{success:!1,error:""}}}async function Ok(l,n,i,c){if(n<1||n>5)return{success:!1,error:" 1-5 "};try{const u=c||dx(),x=await fetch(`${uc}/stats/rate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l,rating:n,comment:i,user_id:u})}),h=await x.json();return x.status===429?{success:!1,error:" 3 "}:x.ok?{success:!0,...h}:{success:!1,error:h.error||""}}catch(u){return console.error("Error rating plugin:",u),{success:!1,error:""}}}async function Fv(l){try{const n=await fetch(`${uc}/stats/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plugin_id:l})}),i=await n.json();return n.status===429?(console.warn("Download recording rate limited"),{success:!0}):n.ok?{success:!0,...i}:(console.error("Failed to record download:",i.error),{success:!1,error:i.error})}catch(n){return console.error("Error recording download:",n),{success:!1,error:""}}}function Dk(){const l=navigator,n=[navigator.userAgent,navigator.language,navigator.languages?.join(",")||"",navigator.platform,navigator.hardwareConcurrency||0,screen.width,screen.height,screen.colorDepth,screen.pixelDepth,new Date().getTimezoneOffset(),Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.maxTouchPoints||0,l.deviceMemory||0].join("|");let i=0;for(let c=0;c<n.length;c++){const u=n.charCodeAt(c);i=(i<<5)-i+u,i=i&i}return`fp_${Math.abs(i).toString(36)}`}function dx(){const l="maibot_user_id";let n=localStorage.getItem(l);if(!n){const i=Dk(),c=Date.now().toString(36),u=Math.random().toString(36).substring(2,15);n=`${i}_${c}_${u}`,localStorage.setItem(l,n)}return n}const Rk={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function Lk(){return e.jsx(Yn,{children:e.jsx(Uk,{})})}function Uk(){const l=ca(),{triggerRestart:n,isRestarting:i}=vn(),[c,u]=d.useState(""),[x,h]=d.useState("all"),[f,p]=d.useState("all"),[g,N]=d.useState(!0),[v,y]=d.useState([]),[w,b]=d.useState(!0),[R,D]=d.useState(null),[S,P]=d.useState(null),[M,T]=d.useState(null),[A,F]=d.useState(null),[,L]=d.useState([]),[J,U]=d.useState({}),[ue,xe]=d.useState(!1),[he,ne]=d.useState(null),[ve,je]=d.useState("main"),[z,V]=d.useState(""),[B,oe]=d.useState("preset"),[K,_e]=d.useState(!1),{toast:pe}=Zs(),ke=async Q=>{const ee=Q.map(async Te=>{try{const de=await Hv(Te.id);return{id:Te.id,stats:de}}catch(de){return console.warn(`Failed to load stats for ${Te.id}:`,de),{id:Te.id,stats:null}}}),Ue=await Promise.all(ee),ie={};Ue.forEach(({id:Te,stats:de})=>{de&&(ie[Te]=de)}),U(ie)};d.useEffect(()=>{let Q=null,ee=!1;return(async()=>{if(Q=await wk(ie=>{ee||(T(ie),ie.stage==="success"?setTimeout(()=>{ee||T(null)},2e3):ie.stage==="error"&&(b(!1),D(ie.error||"")))},ie=>{console.error("WebSocket error:",ie),ee||pe({title:"WebSocket ",description:"",variant:"destructive"})}),await new Promise(ie=>{if(!Q){ie();return}const Te=()=>{Q&&Q.readyState===WebSocket.OPEN?(console.log("WebSocket connected, starting to load plugins"),ie()):Q&&Q.readyState===WebSocket.CLOSED?(console.warn("WebSocket closed before loading plugins"),ie()):setTimeout(Te,100)};Te()}),!ee){const ie=await Lv();P(ie),ie.installed||pe({title:"Git ",description:ie.error||" Git ",variant:"destructive"})}if(!ee){const ie=await Uv();F(ie)}if(!ee)try{b(!0),D(null);const ie=await bk();if(!ee){const Te=await Al();L(Te);const de=ie.map(Me=>{const rs=mn(Me.id,Te),Ut=xn(Me.id,Te);return{...Me,installed:rs,installed_version:Ut}});for(const Me of Te)!de.some(Ut=>Ut.id===Me.id)&&Me.manifest&&de.push({id:Me.id,manifest:{manifest_version:Me.manifest.manifest_version||1,name:Me.manifest.name,version:Me.manifest.version,description:Me.manifest.description||"",author:Me.manifest.author,license:Me.manifest.license||"Unknown",host_application:Me.manifest.host_application,homepage_url:Me.manifest.homepage_url,repository_url:Me.manifest.repository_url,keywords:Me.manifest.keywords||[],categories:Me.manifest.categories||[],default_locale:Me.manifest.default_locale||"zh-CN",locales_path:Me.manifest.locales_path},downloads:0,rating:0,review_count:0,installed:!0,installed_version:Me.manifest.version,published_at:new Date().toISOString(),updated_at:new Date().toISOString()});y(de),ke(de)}}catch(ie){if(!ee){const Te=ie instanceof Error?ie.message:"";D(Te),pe({title:"",description:Te,variant:"destructive"})}}finally{ee||b(!1)}})(),()=>{ee=!0,Q&&Q.close()}},[pe]);const O=Q=>{if(!Q.installed&&A&&!k(Q))return e.jsxs(Se,{variant:"destructive",className:"gap-1",children:[e.jsx(_t,{className:"h-3 w-3"}),""]});if(Q.installed){const ee=Q.installed_version?.trim(),Ue=Q.manifest.version?.trim();if(ee!==Ue){const ie=ee?.split(".").map(Number)||[0,0,0],Te=Ue?.split(".").map(Number)||[0,0,0];for(let de=0;de<3;de++){if((Te[de]||0)>(ie[de]||0))return e.jsxs(Se,{variant:"outline",className:"gap-1 text-orange-600 border-orange-600",children:[e.jsx(_t,{className:"h-3 w-3"}),""]});if((Te[de]||0)<(ie[de]||0))break}}return e.jsxs(Se,{variant:"default",className:"gap-1",children:[e.jsx(pt,{className:"h-3 w-3"}),""]})}return null},k=Q=>!A||!Q.manifest?.host_application?!0:$v(Q.manifest.host_application.min_version,Q.manifest.host_application.max_version,A),H=Q=>{if(!Q.installed||!Q.installed_version||!Q.manifest?.version)return!1;const ee=Q.installed_version.trim(),Ue=Q.manifest.version.trim();if(ee===Ue)return!1;const ie=ee.split(".").map(Number),Te=Ue.split(".").map(Number);for(let de=0;de<3;de++){if((Te[de]||0)>(ie[de]||0))return!0;if((Te[de]||0)<(ie[de]||0))return!1}return!1},se=v.filter(Q=>{if(!Q.manifest)return console.warn("[]  manifest :",Q.id),!1;const ee=c===""||Q.manifest.name?.toLowerCase().includes(c.toLowerCase())||Q.manifest.description?.toLowerCase().includes(c.toLowerCase())||Q.manifest.keywords&&Q.manifest.keywords.some(de=>de.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Q.manifest.categories&&Q.manifest.categories.includes(x);let ie=!0;f==="installed"?ie=Q.installed===!0:f==="updates"&&(ie=Q.installed===!0&&H(Q));const Te=!g||!A||k(Q);return ee&&Ue&&ie&&Te}),Ee=Q=>{if(!S?.installed){pe({title:"",description:"Git ",variant:"destructive"});return}if(A&&!k(Q)){pe({title:"",description:"",variant:"destructive"});return}ne(Q),je("main"),V(""),oe("preset"),_e(!1),xe(!0)},Z=async()=>{if(!he)return;const Q=B==="custom"?z:ve;if(!Q||Q.trim()===""){pe({title:"",variant:"destructive"});return}try{xe(!1),await Bv(he.id,he.manifest.repository_url||"",Q),Fv(he.id).catch(Ue=>{console.warn("Failed to record download:",Ue)}),pe({title:"",description:`${he.manifest.name} `});const ee=await Al();L(ee),y(Ue=>Ue.map(ie=>{if(ie.id===he.id){const Te=mn(ie.id,ee),de=xn(ie.id,ee);return{...ie,installed:Te,installed_version:de}}return ie}))}catch(ee){pe({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}finally{ne(null)}},Oe=async Q=>{try{await Iv(Q.id),pe({title:"",description:`${Q.manifest.name} `});const ee=await Al();L(ee),y(Ue=>Ue.map(ie=>{if(ie.id===Q.id){const Te=mn(ie.id,ee),de=xn(ie.id,ee);return{...ie,installed:Te,installed_version:de}}return ie}))}catch(ee){pe({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}},ns=async Q=>{if(!S?.installed){pe({title:"",description:"Git ",variant:"destructive"});return}try{const ee=await Pv(Q.id,Q.manifest.repository_url||"","main");pe({title:"",description:`${Q.manifest.name}  ${ee.old_version}  ${ee.new_version}`});const Ue=await Al();L(Ue),y(ie=>ie.map(Te=>{if(Te.id===Q.id){const de=mn(Te.id,Ue),Me=xn(Te.id,Ue);return{...Te,installed:de,installed_version:Me}}return Te}))}catch(ee){pe({title:"",description:ee instanceof Error?ee.message:"",variant:"destructive"})}};return e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",onClick:()=>n(),disabled:i,children:[e.jsx(Ij,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),""]}),e.jsxs(_,{onClick:()=>l({to:"/plugin-mirrors"}),children:[e.jsx(d_,{className:"h-4 w-4 mr-2"}),""]})]})]}),e.jsx(Ce,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900",children:e.jsx(Ae,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ht,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["",e.jsx("span",{className:"font-semibold",children:""}),""]})]})})}),S&&!S.installed&&e.jsxs(Ce,{className:"border-orange-600 bg-orange-50 dark:bg-orange-950/20",children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Jt,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx(Le,{className:"text-lg text-orange-900 dark:text-orange-100",children:"Git "}),e.jsx(ws,{className:"text-orange-800 dark:text-orange-200",children:S.error||" Git "})]})]})}),e.jsx(Ae,{children:e.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[" ",e.jsx("a",{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer",className:"underline font-medium",children:"git-scm.com"}),"  Git "]})})]}),e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:c,onChange:Q=>u(Q.target.value),className:"pl-9"})]}),e.jsxs(Ie,{value:x,onValueChange:h,children:[e.jsx($e,{className:"w-full sm:w-[200px]",children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"all",children:""}),e.jsx(X,{value:"Group Management",children:""}),e.jsx(X,{value:"Entertainment & Interaction",children:""}),e.jsx(X,{value:"Utility Tools",children:""}),e.jsx(X,{value:"Content Generation",children:""}),e.jsx(X,{value:"Multimedia",children:""}),e.jsx(X,{value:"External Integration",children:""}),e.jsx(X,{value:"Data Analysis & Insights",children:""}),e.jsx(X,{value:"Other",children:""})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"compatible-only",checked:g,onCheckedChange:Q=>N(Q===!0)}),e.jsx("label",{htmlFor:"compatible-only",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:""})]})]})}),e.jsx(ta,{value:f,onValueChange:p,className:"w-full",children:e.jsxs(Xt,{className:"grid w-full grid-cols-3",children:[e.jsxs(Je,{value:"all",children:[" (",v.filter(Q=>{if(!Q.manifest)return!1;const ee=c===""||Q.manifest.name?.toLowerCase().includes(c.toLowerCase())||Q.manifest.description?.toLowerCase().includes(c.toLowerCase())||Q.manifest.keywords&&Q.manifest.keywords.some(Te=>Te.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Q.manifest.categories&&Q.manifest.categories.includes(x),ie=!g||!A||k(Q);return ee&&Ue&&ie}).length,")"]}),e.jsxs(Je,{value:"installed",children:[" (",v.filter(Q=>{if(!Q.manifest)return!1;const ee=c===""||Q.manifest.name?.toLowerCase().includes(c.toLowerCase())||Q.manifest.description?.toLowerCase().includes(c.toLowerCase())||Q.manifest.keywords&&Q.manifest.keywords.some(Te=>Te.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Q.manifest.categories&&Q.manifest.categories.includes(x),ie=!g||!A||k(Q);return Q.installed&&ee&&Ue&&ie}).length,")"]}),e.jsxs(Je,{value:"updates",children:[" (",v.filter(Q=>{if(!Q.manifest)return!1;const ee=c===""||Q.manifest.name?.toLowerCase().includes(c.toLowerCase())||Q.manifest.description?.toLowerCase().includes(c.toLowerCase())||Q.manifest.keywords&&Q.manifest.keywords.some(Te=>Te.toLowerCase().includes(c.toLowerCase())),Ue=x==="all"||Q.manifest.categories&&Q.manifest.categories.includes(x),ie=!g||!A||k(Q);return Q.installed&&H(Q)&&ee&&Ue&&ie}).length,")"]})]})}),M&&M.stage==="loading"&&M.operation==="fetch"&&e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:""})]}),e.jsxs("span",{className:"text-sm font-medium",children:[M.progress,"%"]})]}),e.jsx(Kn,{value:M.progress,className:"h-2"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:M.message}),M.total_plugins>0&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[" ",M.loaded_plugins," / ",M.total_plugins," "]})]})}),M&&M.stage==="error"&&M.error&&e.jsx(Ce,{className:"border-destructive bg-destructive/10",children:e.jsx(De,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Jt,{className:"h-5 w-5 text-destructive"}),e.jsxs("div",{children:[e.jsx(Le,{className:"text-lg text-destructive",children:""}),e.jsx(ws,{className:"text-destructive/80",children:M.error})]})]})})}),w?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Bs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]}):R?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Jt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:R}),e.jsx(_,{onClick:()=>window.location.reload(),children:""})]})}):se.length===0?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Tt,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||x!=="all"?"":""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:se.map(Q=>e.jsxs(Ce,{className:"flex flex-col hover:shadow-lg transition-shadow h-full",children:[e.jsxs(De,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(Le,{className:"text-xl",children:Q.manifest?.name||Q.id}),e.jsxs("div",{className:"flex flex-col gap-1",children:[Q.manifest?.categories&&Q.manifest.categories[0]&&e.jsx(Se,{variant:"secondary",className:"text-xs whitespace-nowrap",children:Rk[Q.manifest.categories[0]]||Q.manifest.categories[0]}),O(Q)]})]}),e.jsx(ws,{className:"line-clamp-2",children:Q.manifest?.description||""})]}),e.jsx(Ae,{className:"flex-1",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{children:(J[Q.id]?.downloads??Q.downloads??0).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(dn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:(J[Q.id]?.rating??Q.rating??0).toFixed(1)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Q.manifest?.keywords&&Q.manifest.keywords.slice(0,3).map(ee=>e.jsx(Se,{variant:"outline",className:"text-xs",children:ee},ee)),Q.manifest?.keywords&&Q.manifest.keywords.length>3&&e.jsxs(Se,{variant:"outline",className:"text-xs",children:["+",Q.manifest.keywords.length-3]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t space-y-1",children:[e.jsxs("div",{children:["v",Q.manifest?.version||"unknown","  ",Q.manifest?.author?.name||"Unknown"]}),Q.manifest?.host_application&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:":"}),e.jsxs("span",{className:"font-medium",children:[Q.manifest.host_application.min_version,Q.manifest.host_application.max_version?` - ${Q.manifest.host_application.max_version}`:" - "]})]})]})]})}),e.jsx(Zo,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>l({to:"/plugin-detail",search:{pluginId:Q.id}}),children:""}),Q.installed?H(Q)?e.jsxs(_,{size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>ns(Q),children:[e.jsx(dt,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{variant:"destructive",size:"sm",disabled:!S?.installed,title:S?.installed?void 0:"Git ",onClick:()=>Oe(Q),children:[e.jsx(ls,{className:"h-4 w-4 mr-1"}),""]}):e.jsxs(_,{size:"sm",disabled:!S?.installed||M?.operation==="install"||A!==null&&!k(Q),title:S?.installed?A!==null&&!k(Q)?` ( ${Q.manifest?.host_application?.min_version||""}${Q.manifest?.host_application?.max_version?` - ${Q.manifest.host_application.max_version}`:"+"} ${A?.version})`:void 0:"Git ",onClick:()=>Ee(Q),children:[e.jsx(sa,{className:"h-4 w-4 mr-1"}),M?.operation==="install"&&M?.plugin_id===Q.id?"...":""]})]})}),M&&(M.stage==="loading"||M.stage==="success"||M.stage==="error")&&M.operation!=="fetch"&&M.plugin_id===Q.id&&e.jsx("div",{className:"px-6 pb-4 -mt-2",children:e.jsxs("div",{className:`space-y-2 p-3 rounded-lg border ${M.stage==="success"?"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-900":M.stage==="error"?"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-900":"bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[M.stage==="loading"?e.jsx(Bs,{className:"h-3 w-3 animate-spin"}):M.stage==="success"?e.jsx(pt,{className:"h-3 w-3 text-green-600"}):e.jsx(_t,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:`text-xs font-medium ${M.stage==="success"?"text-green-700 dark:text-green-300":M.stage==="error"?"text-red-700 dark:text-red-300":""}`,children:M.stage==="loading"?e.jsxs(e.Fragment,{children:[M.operation==="install"&&"",M.operation==="uninstall"&&"",M.operation==="update"&&""]}):M.stage==="success"?e.jsxs(e.Fragment,{children:[M.operation==="install"&&"",M.operation==="uninstall"&&"",M.operation==="update"&&""]}):e.jsxs(e.Fragment,{children:[M.operation==="install"&&"",M.operation==="uninstall"&&"",M.operation==="update"&&""]})})]}),M.stage!=="error"&&e.jsxs("span",{className:`text-xs font-medium ${M.stage==="success"?"text-green-700 dark:text-green-300":""}`,children:[M.progress,"%"]})]}),M.stage!=="error"&&e.jsx(Kn,{value:M.progress,className:`h-1.5 ${M.stage==="success"?"[&>div]:bg-green-500":""}`}),e.jsx("div",{className:`text-xs ${M.stage==="success"?"text-green-600 dark:text-green-400 truncate":M.stage==="error"?"text-red-600 dark:text-red-400":"text-muted-foreground truncate"}`,children:M.stage==="error"?M.error||M.message||"":M.message})]})})]},Q.id))}),e.jsx(Is,{open:ue,onOpenChange:xe,children:e.jsxs(Os,{children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsxs(Ks,{children:[" ",he?.manifest.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",he?.manifest.version]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[": ",typeof he?.manifest.author=="string"?he.manifest.author:he?.manifest.author?.name]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"advanced-options",checked:K,onCheckedChange:Q=>_e(Q)}),e.jsx("label",{htmlFor:"advanced-options",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:""})]}),K&&e.jsx("div",{className:"space-y-4 p-4 border rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:""}),e.jsxs(ta,{value:B,onValueChange:Q=>oe(Q),children:[e.jsxs(Xt,{className:"grid w-full grid-cols-2",children:[e.jsx(Je,{value:"preset",className:"text-xs",children:""}),e.jsx(Je,{value:"custom",className:"text-xs",children:""})]}),B==="preset"&&e.jsx("div",{className:"mt-3",children:e.jsxs(Ie,{value:ve,onValueChange:je,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:""})}),e.jsxs(Be,{children:[e.jsx(X,{value:"main",children:"main ()"}),e.jsx(X,{value:"master",children:"master"}),e.jsx(X,{value:"dev",children:"dev ()"}),e.jsx(X,{value:"develop",children:"develop"}),e.jsx(X,{value:"beta",children:"beta ()"}),e.jsx(X,{value:"stable",children:"stable ()"})]})]})}),B==="custom"&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:": feature/new-feature",value:z,onChange:Q=>V(Q.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:" Git "})]})]})]})}),!K&&e.jsx("p",{className:"text-sm text-muted-foreground",children:" (main) "})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>xe(!1),children:""}),e.jsxs(_,{onClick:Z,children:[e.jsx(sa,{className:"h-4 w-4 mr-2"}),""]})]})]})}),e.jsx(Jn,{})]})})}function $k(){return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Pj,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]})})}),e.jsx(Ye,{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)]",children:e.jsxs(Ce,{className:"max-w-2xl w-full border-dashed",children:[e.jsxs(De,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(ra,{className:"h-16 w-16 text-muted-foreground"})}),e.jsx(Le,{className:"text-2xl",children:""}),e.jsx(ws,{className:"text-base",children:""})]}),e.jsx(Ae,{children:e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground",children:" "}),e.jsxs("ul",{className:"space-y-2 ml-6",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:""}),e.jsx("span",{children:""})]})]})]})})]})})})]})}function Bk({field:l,value:n,onChange:i}){const[c,u]=d.useState(!1);switch(l.ui_type){case"switch":return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(E,{children:l.label}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]}),e.jsx(Fe,{checked:!!n,onCheckedChange:i,disabled:l.disabled})]});case"number":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:l.label}),e.jsx(le,{type:"number",value:n??l.default,onChange:x=>i(parseFloat(x.target.value)||0),min:l.min,max:l.max,step:l.step??1,placeholder:l.placeholder,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"slider":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:l.label}),e.jsx("span",{className:"text-sm text-muted-foreground",children:n??l.default})]}),e.jsx(qa,{value:[n??l.default],onValueChange:x=>i(x[0]),min:l.min??0,max:l.max??100,step:l.step??1,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"select":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:l.label}),e.jsxs(Ie,{value:String(n??l.default),onValueChange:i,disabled:l.disabled,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:l.placeholder??""})}),e.jsx(Be,{children:l.choices?.map(x=>e.jsx(X,{value:String(x),children:String(x)},String(x)))})]}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"textarea":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:l.label}),e.jsx(ot,{value:n??l.default,onChange:x=>i(x.target.value),placeholder:l.placeholder,rows:l.rows??3,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"password":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:l.label}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{type:c?"text":"password",value:n??"",onChange:x=>i(x.target.value),placeholder:l.placeholder,disabled:l.disabled,className:"pr-10"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>u(!c),children:c?e.jsx(Wi,{className:"h-4 w-4"}):e.jsx(ia,{className:"h-4 w-4"})})]}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"list":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:l.label}),e.jsx(G2,{value:Array.isArray(n)?n:[],onChange:x=>i(x),itemType:l.item_type??"string",itemFields:l.item_fields,minItems:l.min_items,maxItems:l.max_items,disabled:l.disabled,placeholder:l.placeholder}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]});case"text":default:return e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:l.label}),e.jsx(le,{type:"text",value:n??l.default??"",onChange:x=>i(x.target.value),placeholder:l.placeholder,maxLength:l.max_length,disabled:l.disabled}),l.hint&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.hint})]})}}function Lg({section:l,config:n,onChange:i}){const[c,u]=d.useState(!l.collapsed),x=Object.entries(l.fields).filter(([,h])=>!h.hidden).sort(([,h],[,f])=>h.order-f.order);return e.jsx(nc,{open:c,onOpenChange:u,children:e.jsxs(Ce,{children:[e.jsx(rc,{asChild:!0,children:e.jsxs(De,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx(za,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(Le,{className:"text-lg",children:l.title})]}),e.jsxs(Se,{variant:"secondary",className:"text-xs",children:[x.length," "]})]}),l.description&&e.jsx(ws,{className:"ml-6",children:l.description})]})}),e.jsx(ic,{children:e.jsx(Ae,{className:"space-y-4 pt-0",children:x.map(([h,f])=>e.jsx(Bk,{field:f,value:n[l.name]?.[h],onChange:p=>i(l.name,h,p),sectionName:l.name},h))})})]})})}function Ik({plugin:l,onBack:n}){const{toast:i}=Zs(),{triggerRestart:c,isRestarting:u}=vn(),[x,h]=d.useState("visual"),[f,p]=d.useState(null),[g,N]=d.useState({}),[v,y]=d.useState({}),[w,b]=d.useState(""),[R,D]=d.useState(""),[S,P]=d.useState(!0),[M,T]=d.useState(!1),[A,F]=d.useState(!1),[L,J]=d.useState(!1),[U,ue]=d.useState(!1),xe=d.useCallback(async()=>{P(!0);try{const[B,oe,K]=await Promise.all([_k(l.id),Sk(l.id),kk(l.id)]);p(B),N(oe),y(JSON.parse(JSON.stringify(oe))),b(K),D(K)}catch(B){i({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}finally{P(!1)}},[l.id,i]);d.useEffect(()=>{xe()},[xe]),d.useEffect(()=>{F(x==="visual"?JSON.stringify(g)!==JSON.stringify(v):w!==R)},[g,v,w,R,x]);const he=(B,oe,K)=>{N(_e=>({..._e,[B]:{..._e[B]||{},[oe]:K}}))},ne=async()=>{T(!0);try{if(x==="source"){try{Tv(w)}catch(B){J(!0),i({title:"TOML ",description:B instanceof Error?B.message:" TOML ",variant:"destructive"}),T(!1);return}await Tk(l.id,w),D(w),J(!1)}else await Ck(l.id,g),y(JSON.parse(JSON.stringify(g)));i({title:"",description:""})}catch(B){i({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}finally{T(!1)}},ve=async()=>{try{await Ek(l.id),i({title:"",description:""}),ue(!1),xe()}catch(B){i({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}},je=async()=>{try{const B=await Mk(l.id);i({title:B.message,description:B.note}),xe()}catch(B){i({title:"",description:B instanceof Error?B.message:"",variant:"destructive"})}};if(S)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Bs,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!f)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx(_t,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsxs(_,{onClick:n,variant:"outline",children:[e.jsx(Ta,{className:"h-4 w-4 mr-2"}),""]})]});const z=Object.values(f.sections).sort((B,oe)=>B.order-oe.order),V=g.plugin?.enabled!==!1;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:n,children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:f.plugin_info.name||l.manifest.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Se,{variant:V?"default":"secondary",children:V?"":""}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["v",f.plugin_info.version||l.manifest.version]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-10 sm:ml-0",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>h(x==="visual"?"source":"visual"),children:x==="visual"?e.jsxs(e.Fragment,{children:[e.jsx(Uj,{className:"h-4 w-4 mr-2"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Lj,{className:"h-4 w-4 mr-2"}),""]})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>c(),disabled:u,children:[e.jsx(Ij,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:je,children:[e.jsx(cc,{className:"h-4 w-4 mr-2"}),V?"":""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>ue(!0),children:[e.jsx(Zi,{className:"h-4 w-4 mr-2"}),""]}),e.jsxs(_,{size:"sm",onClick:ne,disabled:!A||M,children:[M?e.jsx(Bs,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(oc,{className:"h-4 w-4 mr-2"}),""]})]})]}),A&&e.jsx(Ce,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20 dark:border-orange-900",children:e.jsx(Ae,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ht,{className:"h-4 w-4 text-orange-600"}),e.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:""})]})})}),x==="source"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsxs(lt,{children:[e.jsx("strong",{children:""})," TOML ",L&&e.jsx("span",{className:"text-destructive font-semibold ml-2",children:"  TOML "})]})]}),e.jsx(gv,{value:w,onChange:B=>{b(B),L&&J(!1)},language:"toml",theme:"dark",height:"calc(100vh - 350px)",minHeight:"500px",placeholder:"TOML "})]}),x==="visual"&&e.jsxs(e.Fragment,{children:[e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsxs(lt,{children:[e.jsx("strong",{children:""}),"WebUI  "]})]}),f.layout.type==="tabs"&&f.layout.tabs.length>0?e.jsxs(ta,{defaultValue:f.layout.tabs[0]?.id,children:[e.jsx(Xt,{children:f.layout.tabs.map(B=>e.jsxs(Je,{value:B.id,children:[B.title,B.badge&&e.jsx(Se,{variant:"secondary",className:"ml-2 text-xs",children:B.badge})]},B.id))}),f.layout.tabs.map(B=>e.jsx(ys,{value:B.id,className:"space-y-4 mt-4",children:B.sections.map(oe=>{const K=f.sections[oe];return K?e.jsx(Lg,{section:K,config:g,onChange:he},oe):null})},B.id))]}):e.jsx("div",{className:"space-y-4",children:z.map(B=>e.jsx(Lg,{section:B,config:g,onChange:he},B.name))})]}),e.jsx(Is,{open:U,onOpenChange:ue,children:e.jsxs(Os,{children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>ue(!1),children:""}),e.jsx(_,{variant:"destructive",onClick:ve,children:""})]})]})})]})}function Pk(){return e.jsx(Yn,{children:e.jsx(Hk,{})})}function Hk(){const{toast:l}=Zs(),[n,i]=d.useState([]),[c,u]=d.useState(!0),[x,h]=d.useState(""),[f,p]=d.useState(null),g=async()=>{u(!0);try{const b=await Al();i(b)}catch(b){l({title:"",description:b instanceof Error?b.message:"",variant:"destructive"})}finally{u(!1)}};d.useEffect(()=>{g()},[]);const v=n.filter(b=>{const R=x.toLowerCase();return b.id.toLowerCase().includes(R)||b.manifest.name.toLowerCase().includes(R)||b.manifest.description?.toLowerCase().includes(R)}).filter((b,R,D)=>R===D.findIndex(S=>S.id===b.id)),y=n.length,w=0;return f?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-full",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(Ik,{plugin:f,onBack:()=>p(null)})})}),e.jsx(Jn,{})]}):e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:""})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:g,children:[e.jsx(dt,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),""]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 xs:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c?"...":""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(pt,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]}),e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:""}),e.jsx(_t,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:w}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:""})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:x,onChange:b=>h(b.target.value),className:"pl-9"})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Bs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):v.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(ra,{className:"h-16 w-16 text-muted-foreground/50"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:x?"":""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x?"":""})]})]}):e.jsx("div",{className:"space-y-2",children:v.map(b=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>p(b),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(ra,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:b.manifest.name}),e.jsxs(Se,{variant:"secondary",className:"text-xs flex-shrink-0",children:["v",b.manifest.version]})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:b.manifest.description||""})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(_,{variant:"ghost",size:"sm",children:e.jsx(pn,{className:"h-4 w-4"})}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]})]},b.id))})})]})]})})}function Fk(){const l=ca(),{toast:n}=Zs(),[i,c]=d.useState([]),[u,x]=d.useState(!0),[h,f]=d.useState(null),[p,g]=d.useState(null),[N,v]=d.useState(!1),[y,w]=d.useState(!1),[b,R]=d.useState({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),D=d.useCallback(async()=>{try{x(!0),f(null);const L=await we("/api/webui/plugins/mirrors");if(!L.ok)throw new Error("");const J=await L.json();c(J.mirrors||[])}catch(L){const J=L instanceof Error?L.message:"";f(J),n({title:"",description:J,variant:"destructive"})}finally{x(!1)}},[n]);d.useEffect(()=>{D()},[D]);const S=async()=>{try{const L=await we("/api/webui/plugins/mirrors",{method:"POST",body:JSON.stringify(b)});if(!L.ok){const J=await L.json();throw new Error(J.detail||"")}n({title:"",description:""}),v(!1),R({id:"",name:"",raw_prefix:"",clone_prefix:"",enabled:!0,priority:1}),D()}catch(L){n({title:"",description:L instanceof Error?L.message:"",variant:"destructive"})}},P=async()=>{if(p)try{if(!(await we(`/api/webui/plugins/mirrors/${p.id}`,{method:"PUT",body:JSON.stringify({name:b.name,raw_prefix:b.raw_prefix,clone_prefix:b.clone_prefix,enabled:b.enabled,priority:b.priority})})).ok)throw new Error("");n({title:"",description:""}),w(!1),g(null),D()}catch(L){n({title:"",description:L instanceof Error?L.message:"",variant:"destructive"})}},M=async L=>{if(confirm(""))try{if(!(await we(`/api/webui/plugins/mirrors/${L}`,{method:"DELETE"})).ok)throw new Error("");n({title:"",description:""}),D()}catch(J){n({title:"",description:J instanceof Error?J.message:"",variant:"destructive"})}},T=async L=>{try{if(!(await we(`/api/webui/plugins/mirrors/${L.id}`,{method:"PUT",body:JSON.stringify({enabled:!L.enabled})})).ok)throw new Error("");D()}catch(J){n({title:"",description:J instanceof Error?J.message:"",variant:"destructive"})}},A=L=>{g(L),R({id:L.id,name:L.name,raw_prefix:L.raw_prefix,clone_prefix:L.clone_prefix,enabled:L.enabled,priority:L.priority}),w(!0)},F=async(L,J)=>{const U=J==="up"?L.priority-1:L.priority+1;if(!(U<1))try{if(!(await we(`/api/webui/plugins/mirrors/${L.id}`,{method:"PUT",body:JSON.stringify({priority:U})})).ok)throw new Error("");D()}catch(ue){n({title:"",description:ue instanceof Error?ue.message:"",variant:"destructive"})}};return e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:" Git "})]})]}),e.jsxs(_,{onClick:()=>v(!0),children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),""]})]}),u?e.jsx(Ce,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Bs,{className:"h-8 w-8 animate-spin text-primary"})})}):h?e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Jt,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h}),e.jsx(_,{onClick:D,children:""})]})}):e.jsxs(Ce,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"ID"}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:""})]})}),e.jsx(Ul,{children:i.map(L=>e.jsxs(ut,{children:[e.jsx(qe,{children:e.jsx(Fe,{checked:L.enabled,onCheckedChange:()=>T(L)})}),e.jsx(qe,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:L.name}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Raw: ",L.raw_prefix]})]})}),e.jsx(qe,{children:e.jsx(Se,{variant:"outline",children:L.id})}),e.jsx(qe,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono",children:L.priority}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>F(L,"up"),disabled:L.priority===1,children:e.jsx(Fr,{className:"h-3 w-3"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>F(L,"down"),children:e.jsx(za,{className:"h-3 w-3"})})]})]})}),e.jsx(qe,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>A(L),children:e.jsx(Fn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>M(L.id),children:e.jsx(ls,{className:"h-4 w-4 text-destructive"})})]})})]},L.id))})]})}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:i.map(L=>e.jsx(Ce,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:L.name}),L.enabled&&e.jsx(Se,{variant:"default",className:"text-xs",children:""})]}),e.jsx(Se,{variant:"outline",className:"mt-1 text-xs",children:L.id})]}),e.jsx(Fe,{checked:L.enabled,onCheckedChange:()=>T(L)})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Raw: "}),e.jsx("span",{className:"break-all",children:L.raw_prefix})]}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:": "}),e.jsx("span",{className:"font-mono",children:L.priority})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>A(L),children:[e.jsx(Fn,{className:"h-4 w-4 mr-1"}),""]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>F(L,"up"),disabled:L.priority===1,children:e.jsx(Fr,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>F(L,"down"),children:e.jsx(za,{className:"h-4 w-4"})}),e.jsx(_,{variant:"destructive",size:"sm",onClick:()=>M(L.id),children:e.jsx(ls,{className:"h-4 w-4"})})]})]})},L.id))})]}),e.jsx(Is,{open:N,onOpenChange:v,children:e.jsxs(Os,{className:"max-w-lg",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:" Git "})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"add-id",children:" ID *"}),e.jsx(le,{id:"add-id",placeholder:": my-mirror",value:b.id,onChange:L=>R({...b,id:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"add-name",children:" *"}),e.jsx(le,{id:"add-name",placeholder:": ",value:b.name,onChange:L=>R({...b,name:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"add-raw",children:"Raw  *"}),e.jsx(le,{id:"add-raw",placeholder:"https://example.com/raw",value:b.raw_prefix,onChange:L=>R({...b,raw_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"add-clone",children:" *"}),e.jsx(le,{id:"add-clone",placeholder:"https://example.com/clone",value:b.clone_prefix,onChange:L=>R({...b,clone_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"add-priority",children:""}),e.jsx(le,{id:"add-priority",type:"number",min:"1",value:b.priority,onChange:L=>R({...b,priority:parseInt(L.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"add-enabled",checked:b.enabled,onCheckedChange:L=>R({...b,enabled:L})}),e.jsx(E,{htmlFor:"add-enabled",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>v(!1),children:""}),e.jsx(_,{onClick:S,children:""})]})]})}),e.jsx(Is,{open:y,onOpenChange:w,children:e.jsxs(Os,{className:"max-w-lg",children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:" ID"}),e.jsx(le,{value:b.id,disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit-name",children:" *"}),e.jsx(le,{id:"edit-name",value:b.name,onChange:L=>R({...b,name:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit-raw",children:"Raw  *"}),e.jsx(le,{id:"edit-raw",value:b.raw_prefix,onChange:L=>R({...b,raw_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit-clone",children:" *"}),e.jsx(le,{id:"edit-clone",value:b.clone_prefix,onChange:L=>R({...b,clone_prefix:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"edit-priority",children:""}),e.jsx(le,{id:"edit-priority",type:"number",min:"1",value:b.priority,onChange:L=>R({...b,priority:parseInt(L.target.value)||1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{id:"edit-enabled",checked:b.enabled,onCheckedChange:L=>R({...b,enabled:L})}),e.jsx(E,{htmlFor:"edit-enabled",children:""})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>w(!1),children:""}),e.jsx(_,{onClick:P,children:""})]})]})})]})})}function Gk({pluginId:l,compact:n=!1}){const[i,c]=d.useState(null),[u,x]=d.useState(!0),[h,f]=d.useState(0),[p,g]=d.useState(""),[N,v]=d.useState(!1),{toast:y}=Zs(),w=async()=>{x(!0);const S=await Hv(l);S&&c(S),x(!1)};d.useEffect(()=>{w()},[l]);const b=async()=>{const S=await zk(l);S.success?(y({title:"",description:""}),w()):y({title:"",description:S.error||"",variant:"destructive"})},R=async()=>{const S=await Ak(l);S.success?(y({title:"",description:""}),w()):y({title:"",description:S.error||"",variant:"destructive"})},D=async()=>{if(h===0){y({title:"",description:" 1 ",variant:"destructive"});return}const S=await Ok(l,h,p||void 0);S.success?(y({title:"",description:""}),v(!1),f(0),g(""),w()):y({title:"",description:S.error||"",variant:"destructive"})};return u?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(dn,{className:"h-4 w-4"}),e.jsx("span",{children:"-"})]})]}):i?n?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",title:`: ${i.downloads.toLocaleString()}`,children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{children:i.downloads.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${i.rating.toFixed(1)} (${i.rating_count} )`,children:[e.jsx(dn,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:i.rating.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-1",title:`: ${i.likes}`,children:[e.jsx(Nm,{className:"h-4 w-4"}),e.jsx("span",{children:i.likes})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(sa,{className:"h-5 w-5 text-muted-foreground mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:i.downloads.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(dn,{className:"h-5 w-5 text-yellow-400 mb-1 fill-yellow-400"}),e.jsx("span",{className:"text-2xl font-bold",children:i.rating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.rating_count," "]})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(Nm,{className:"h-5 w-5 text-green-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:i.likes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{className:"flex flex-col items-center p-3 rounded-lg border bg-card",children:[e.jsx(cg,{className:"h-5 w-5 text-red-500 mb-1"}),e.jsx("span",{className:"text-2xl font-bold",children:i.dislikes}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:b,children:[e.jsx(Nm,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:R,children:[e.jsx(cg,{className:"h-4 w-4 mr-1"}),""]}),e.jsxs(Is,{open:N,onOpenChange:v,children:[e.jsx(Wo,{asChild:!0,children:e.jsxs(_,{variant:"default",size:"sm",children:[e.jsx(dn,{className:"h-4 w-4 mr-1"}),""]})}),e.jsxs(Os,{children:[e.jsxs(Ds,{children:[e.jsx(Rs,{children:""}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(S=>e.jsx("button",{onClick:()=>f(S),className:"focus:outline-none",children:e.jsx(dn,{className:`h-8 w-8 transition-colors ${S<=h?"fill-yellow-400 text-yellow-400":"text-muted-foreground hover:text-yellow-300"}`})},S))}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h===0&&"",h===1&&"",h===2&&"",h===3&&"",h===4&&"",h===5&&""]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),e.jsx(ot,{value:p,onChange:S=>g(S.target.value),placeholder:"...",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[p.length," / 500"]})]})]}),e.jsxs(st,{children:[e.jsx(_,{variant:"outline",onClick:()=>v(!1),children:""}),e.jsx(_,{onClick:D,disabled:h===0,children:""})]})]})]})]}),i.recent_ratings&&i.recent_ratings.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:""}),e.jsx("div",{className:"space-y-3",children:i.recent_ratings.map((S,P)=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(M=>e.jsx(dn,{className:`h-3 w-3 ${M<=S.rating?"fill-yellow-400 text-yellow-400":"text-muted-foreground"}`},M))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(S.created_at).toLocaleDateString()})]}),S.comment&&e.jsx("p",{className:"text-sm text-muted-foreground",children:S.comment})]},P))})]})]}):null}const Vk={"Group Management":"","Entertainment & Interaction":"","Utility Tools":"","Content Generation":"",Multimedia:"","External Integration":"","Data Analysis & Insights":"",Other:""};function qk(){const l=ca(),n=b0({strict:!1}),{toast:i}=Zs(),[c,u]=d.useState(null),[x,h]=d.useState(""),[f,p]=d.useState(!0),[g,N]=d.useState(!0),[v,y]=d.useState(null),[w,b]=d.useState(null),[R,D]=d.useState(null),[S,P]=d.useState(!1),[M,T]=d.useState(),[A,F]=d.useState(!1);d.useEffect(()=>{(async()=>{if(!n.pluginId){y(" ID"),p(!1);return}try{p(!0),y(null);const ve=await we("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:"Mai-with-u",repo:"plugin-repo",branch:"main",file_path:"plugin_details.json"})});if(!ve.ok)throw new Error("");const je=await ve.json();if(!je.success||!je.data)throw new Error(je.error||"");const V=JSON.parse(je.data).find(pe=>pe.id===n.pluginId);if(!V)throw new Error("");const B={id:V.id,manifest:V.manifest,downloads:0,rating:0,review_count:0,installed:!1,published_at:new Date().toISOString(),updated_at:new Date().toISOString()};u(B);const[oe,K,_e]=await Promise.all([Lv(),Uv(),Al()]);b(oe),D(K),P(mn(n.pluginId,_e)),T(xn(n.pluginId,_e))}catch(ve){y(ve instanceof Error?ve.message:"")}finally{p(!1)}})()},[n.pluginId]),d.useEffect(()=>{(async()=>{if(!c?.manifest?.repository_url){N(!1);return}try{if(N(!0),S&&n.pluginId)try{const K=await we(`/api/webui/plugins/local-readme/${n.pluginId}`);if(K.ok){const _e=await K.json();if(_e.success&&_e.data){h(_e.data),N(!1);return}}}catch(K){console.log(" README :",K)}const ve=c.manifest.repository_url.match(/github\.com\/([^/]+)\/([^/\s]+)/);if(!ve){h("");return}const[,je,z]=ve,V=z.replace(/\.git$/,""),B=await we("/api/webui/plugins/fetch-raw",{method:"POST",body:JSON.stringify({owner:je,repo:V,branch:"main",file_path:"README.md"})});if(!B.ok)throw new Error(" README ");const oe=await B.json();oe.success&&oe.data?h(oe.data):h(" README ")}catch(ve){console.error(" README :",ve),h(" README ")}finally{N(!1)}})()},[c,S,n.pluginId]);const L=()=>!c||!S||!M?!1:M!==c.manifest.version,J=()=>!c||!R?!0:$v(c.manifest.host_application.min_version,c.manifest.host_application.max_version,R),U=async()=>{if(!(!c||!w?.installed))try{F(!0),await Bv(c.id,c.manifest.repository_url||"","main"),Fv(c.id).catch(ve=>{console.warn("Failed to record download:",ve)}),i({title:"",description:`${c.manifest.name} `});const ne=await Al();P(mn(c.id,ne)),T(xn(c.id,ne))}catch(ne){i({title:"",description:ne instanceof Error?ne.message:"",variant:"destructive"})}finally{F(!1)}},ue=async()=>{if(c)try{F(!0),await Iv(c.id),i({title:"",description:`${c.manifest.name} `});const ne=await Al();P(mn(c.id,ne)),T(xn(c.id,ne))}catch(ne){i({title:"",description:ne instanceof Error?ne.message:"",variant:"destructive"})}finally{F(!1)}},xe=async()=>{if(!(!c||!w?.installed))try{F(!0);const ne=await Pv(c.id,c.manifest.repository_url||"","main");i({title:"",description:`${c.manifest.name}  ${ne.old_version}  ${ne.new_version}`});const ve=await Al();P(mn(c.id,ve)),T(xn(c.id,ve))}catch(ne){i({title:"",description:ne instanceof Error?ne.message:"",variant:"destructive"})}finally{F(!1)}};if(f)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Bs,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"..."})]})]});if(v||!c)return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""})})]}),e.jsx(Ce,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(_t,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:""}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:v}),e.jsx(_,{onClick:()=>l({to:"/plugins"}),children:""})]})})]});const he=J();return e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>l({to:"/plugins"}),className:"shrink-0",children:e.jsx(Ta,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-2 text-sm sm:text-base",children:c.manifest.name})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S?e.jsxs(e.Fragment,{children:[L()?e.jsx(_,{disabled:!w?.installed||A,onClick:xe,title:w?.installed?void 0:"Git ",children:A?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),""]})}):null,e.jsx(_,{variant:"destructive",disabled:!w?.installed||A,onClick:ue,title:w?.installed?void 0:"Git ",children:A?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),""]})})]}):e.jsx(_,{disabled:!w?.installed||!he||A,onClick:U,title:w?.installed?he?void 0:` ( ${c.manifest.host_application.min_version}${c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:"+"} ${R?.version})`:"Git ",children:A?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"h-4 w-4 mr-2 animate-spin"}),"..."]}):e.jsxs(e.Fragment,{children:[e.jsx(sa,{className:"h-4 w-4 mr-2"}),""]})})})]}),e.jsx(Ye,{className:"h-[calc(100vh-200px)] sm:h-[calc(100vh-220px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsx(Ce,{children:e.jsx(De,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(Le,{className:"text-2xl",children:c.manifest.name}),e.jsxs(Se,{variant:"secondary",className:"text-sm",children:["v",c.manifest.version]}),S&&e.jsxs(Se,{variant:"default",className:"text-sm",children:[e.jsx(pt,{className:"h-3 w-3 mr-1"})," ",M&&`(v${M})`]}),L()&&e.jsxs(Se,{variant:"outline",className:"text-sm border-orange-500 text-orange-500",children:[e.jsx(dt,{className:"h-3 w-3 mr-1"}),""]}),!he&&e.jsxs(Se,{variant:"destructive",className:"text-sm",children:[e.jsx(_t,{className:"h-3 w-3 mr-1"}),""]})]}),e.jsx(ws,{className:"text-base",children:c.manifest.description})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Le,{className:"text-lg",children:""})}),e.jsx(Ae,{children:e.jsx(Gk,{pluginId:c.id})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Le,{className:"text-lg",children:""})}),e.jsx(Ae,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(fn,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.author?.name||"Unknown"}),c.manifest.author?.url&&e.jsx("a",{href:c.manifest.author.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:e.jsx(Mo,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("span",{className:"font-medium",children:["v",c.manifest.version]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Oj,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-medium",children:c.manifest.license})]}),c.manifest.homepage_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Uo,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.homepage_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["",e.jsx(Mo,{className:"h-3 w-3"})]})]}),c.manifest.repository_url&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(u_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsxs("a",{href:c.manifest.repository_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center gap-1",children:["GitHub",e.jsx(Mo,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx(Ht,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:":"})]}),e.jsxs("div",{className:"text-sm pl-6 font-medium",children:[c.manifest.host_application.min_version,c.manifest.host_application.max_version?` - ${c.manifest.host_application.max_version}`:" - "]})]})]})})]}),(c.manifest.categories||c.manifest.keywords)&&e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Le,{className:"text-lg",children:""})}),e.jsxs(Ae,{className:"space-y-4",children:[c.manifest.categories&&c.manifest.categories.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.categories.map(ne=>e.jsx(Se,{variant:"secondary",children:Vk[ne]||ne},ne))})]}),c.manifest.keywords&&c.manifest.keywords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.manifest.keywords.map(ne=>e.jsxs(Se,{variant:"outline",className:"text-xs",children:[e.jsx(Xo,{className:"h-3 w-3 mr-1"}),ne]},ne))})]})]})]})]}),e.jsxs(Ce,{className:"lg:col-span-2",children:[e.jsx(De,{children:e.jsx(Le,{className:"text-lg",children:""})}),e.jsx(Ae,{children:e.jsx(Ye,{className:"h-[600px] pr-4",children:g?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Bs,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-3 text-sm text-muted-foreground",children:"..."})]}):x?e.jsx(tx,{content:x}):e.jsx("div",{className:"text-center text-muted-foreground py-12",children:""})})})]})]})]})})]})}const qi=d.forwardRef(({className:l,...n},i)=>e.jsx(aj,{ref:i,className:I("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",l),...n}));qi.displayName=aj.displayName;const Kk=d.forwardRef(({className:l,...n},i)=>e.jsx(lj,{ref:i,className:I("aspect-square h-full w-full",l),...n}));Kk.displayName=lj.displayName;const Ki=d.forwardRef(({className:l,...n},i)=>e.jsx(nj,{ref:i,className:I("flex h-full w-full items-center justify-center rounded-full bg-muted",l),...n}));Ki.displayName=nj.displayName;function Qk(){return"webui_"+Math.random().toString(36).substr(2,9)+"_"+Date.now().toString(36)}function Yk(){const l="maibot_webui_user_id";let n=localStorage.getItem(l);return n||(n=Qk(),localStorage.setItem(l,n)),n}function Jk(){return localStorage.getItem("maibot_webui_user_name")||"WebUI"}function Xk(l){localStorage.setItem("maibot_webui_user_name",l)}const Gv="maibot_webui_virtual_tabs";function Zk(){try{const l=localStorage.getItem(Gv);if(l)return JSON.parse(l)}catch(l){console.error("[Chat] :",l)}return[]}function Ug(l){try{localStorage.setItem(Gv,JSON.stringify(l))}catch(n){console.error("[Chat] :",n)}}function Wk({segment:l}){switch(l.type){case"text":return e.jsx("span",{className:"whitespace-pre-wrap",children:String(l.data)});case"image":case"emoji":return e.jsx("img",{src:String(l.data),alt:l.type==="emoji"?"":"",className:I("rounded-lg max-w-full",l.type==="emoji"?"max-h-32":"max-h-64"),loading:"lazy",onError:n=>{const i=n.target;i.style.display="none",i.parentElement?.insertAdjacentHTML("beforeend",`<span class="text-muted-foreground text-xs">[${l.type==="emoji"?"":""}]</span>`)}});case"voice":return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("audio",{controls:!0,src:String(l.data),className:"max-w-[200px] h-8",children:""})});case"video":return e.jsx("video",{controls:!0,src:String(l.data),className:"rounded-lg max-w-full max-h-64",children:""});case"face":return e.jsxs("span",{className:"text-muted-foreground",children:["[:",String(l.data),"]"]});case"music":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"file":return e.jsxs("span",{className:"text-muted-foreground",children:["[: ",String(l.data),"]"]});case"reply":return e.jsx("span",{className:"text-muted-foreground text-xs",children:"[]"});case"forward":return e.jsx("span",{className:"text-muted-foreground",children:"[]"});case"unknown":default:return e.jsxs("span",{className:"text-muted-foreground",children:["[",l.original_type||"","]"]})}}function eC({message:l,isBot:n}){return l.message_type==="rich"&&l.segments&&l.segments.length>0?e.jsx("div",{className:"flex flex-col gap-2",children:l.segments.map((i,c)=>e.jsx(Wk,{segment:i},c))}):e.jsx("span",{className:"whitespace-pre-wrap",children:l.content})}function sC(){const l={id:"webui-default",type:"webui",label:"WebUI",messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}},n=()=>{const Ve=Zk().map(Ke=>{const We=Ke.virtualConfig;return!We.groupId&&We.platform&&We.userId&&(We.groupId=`webui_virtual_group_${We.platform}_${We.userId}`),{id:Ke.id,type:"virtual",label:Ke.label,virtualConfig:We,messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}}});return[l,...Ve]},[i,c]=d.useState(n),[u,x]=d.useState("webui-default"),h=i.find(q=>q.id===u)||i[0],[f,p]=d.useState(""),[g,N]=d.useState(!1),[v,y]=d.useState(!0),[w,b]=d.useState(Jk()),[R,D]=d.useState(!1),[S,P]=d.useState(""),[M,T]=d.useState(!1),[A,F]=d.useState([]),[L,J]=d.useState([]),[U,ue]=d.useState(!1),[xe,he]=d.useState(!1),[ne,ve]=d.useState(""),[je,z]=d.useState({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),V=d.useRef(Yk()),B=d.useRef(new Map),oe=d.useRef(null),K=d.useRef(new Map),_e=d.useRef(0),pe=d.useRef(new Map),{toast:ke}=Zs(),O=q=>(_e.current+=1,`${q}-${Date.now()}-${_e.current}-${Math.random().toString(36).substr(2,9)}`),k=d.useCallback((q,Ve)=>{c(Ke=>Ke.map(We=>We.id===q?{...We,...Ve}:We))},[]),H=d.useCallback((q,Ve)=>{c(Ke=>Ke.map(We=>We.id===q?{...We,messages:[...We.messages,Ve]}:We))},[]),se=d.useCallback(()=>{oe.current?.scrollIntoView({behavior:"smooth"})},[]);d.useEffect(()=>{se()},[h?.messages,se]);const Ee=d.useCallback(async()=>{ue(!0);try{const q=await we("/api/chat/platforms");if(console.log("[Chat] :",q.status,q.headers.get("content-type")),q.ok){const Ve=q.headers.get("content-type");if(Ve&&Ve.includes("application/json")){const Ke=await q.json();console.log("[Chat] :",Ke),F(Ke.platforms||[])}else{const Ke=await q.text();console.error("[Chat] :  JSON :",Ke.substring(0,200)),ke({title:"",description:" MaiBot ",variant:"destructive"})}}else console.error("[Chat] : HTTP",q.status),ke({title:"",description:`: ${q.status}`,variant:"destructive"})}catch(q){console.error("[Chat] :",q),ke({title:"",description:"",variant:"destructive"})}finally{ue(!1)}},[ke]),Z=d.useCallback(async(q,Ve)=>{he(!0);try{const Ke=new URLSearchParams;q&&Ke.append("platform",q),Ve&&Ke.append("search",Ve),Ke.append("limit","50");const We=await we(`/api/chat/persons?${Ke.toString()}`);if(We.ok){const Ls=We.headers.get("content-type");if(Ls&&Ls.includes("application/json")){const ts=await We.json();J(ts.persons||[])}else console.error("[Chat] :  JSON ")}}catch(Ke){console.error("[Chat] :",Ke)}finally{he(!1)}},[]);d.useEffect(()=>{je.platform&&Z(je.platform,ne)},[je.platform,ne,Z]);const Oe=d.useCallback(async(q,Ve)=>{y(!0);try{const Ke=new URLSearchParams;Ke.append("user_id",V.current),Ke.append("limit","50"),Ve&&Ke.append("group_id",Ve);const We=`/api/chat/history?${Ke.toString()}`;console.log("[Chat] :",We);const Ls=await we(We);if(Ls.ok){const ts=await Ls.text();try{const Cs=JSON.parse(ts);if(Cs.messages&&Cs.messages.length>0){const ze=Cs.messages.map(as=>({id:as.id,type:as.type,content:as.content,timestamp:as.timestamp,sender:{name:as.sender_name||(as.is_bot?"":"WebUI"),user_id:as.user_id,is_bot:as.is_bot}}));k(q,{messages:ze});const Ns=pe.current.get(q)||new Set;ze.forEach(as=>{if(as.type==="bot"){const es=`bot-${as.content}-${Math.floor(as.timestamp*1e3)}`;Ns.add(es)}}),pe.current.set(q,Ns)}}catch(Cs){console.error("[Chat] JSON :",Cs)}}}catch(Ke){console.error("[Chat] :",Ke)}finally{y(!1)}},[k]),ns=d.useCallback(async(q,Ve,Ke)=>{const We=B.current.get(q);if(We?.readyState===WebSocket.OPEN||We?.readyState===WebSocket.CONNECTING){console.log(`[Tab ${q}] WebSocket `);return}N(!0);let Ls=null;try{const Ns=await we("/api/webui/ws-token");if(Ns.ok){const as=await Ns.json();if(as.success&&as.token)Ls=as.token;else{console.warn(`[Tab ${q}]  WebSocket token : ${as.message||""}`),N(!1);return}}}catch(Ns){console.error(`[Tab ${q}]  WebSocket token :`,Ns),N(!1);return}if(!Ls){N(!1);return}const ts=window.location.protocol==="https:"?"wss:":"ws:",Cs=new URLSearchParams;Cs.append("token",Ls),Ve==="virtual"&&Ke?(Cs.append("user_id",Ke.userId),Cs.append("user_name",Ke.userName),Cs.append("platform",Ke.platform),Cs.append("person_id",Ke.personId),Cs.append("group_name",Ke.groupName||"WebUI"),Ke.groupId&&Cs.append("group_id",Ke.groupId)):(Cs.append("user_id",V.current),Cs.append("user_name",w));const ze=`${ts}//${window.location.host}/api/chat/ws?${Cs.toString()}`;console.log(`[Tab ${q}]  WebSocket:`,ze);try{const Ns=new WebSocket(ze);B.current.set(q,Ns),Ns.onopen=()=>{k(q,{isConnected:!0}),N(!1),console.log(`[Tab ${q}] WebSocket `)},Ns.onmessage=as=>{try{const es=JSON.parse(as.data);switch(es.type){case"session_info":k(q,{sessionInfo:{session_id:es.session_id,user_id:es.user_id,user_name:es.user_name,bot_name:es.bot_name}});break;case"system":H(q,{id:O("sys"),type:"system",content:es.content||"",timestamp:es.timestamp||Date.now()/1e3});break;case"user_message":{const bs=es.sender?.user_id,gt=Ve==="virtual"&&Ke?Ke.userId:V.current;console.log(`[Tab ${q}]  user_message, sender: ${bs}, current: ${gt}`);const $t=bs?bs.replace(/^webui_user_/,""):"",tt=gt?gt.replace(/^webui_user_/,""):"";if($t&&tt&&$t===tt){console.log(`[Tab ${q}] user_id `);break}const Ms=pe.current.get(q)||new Set,Et=`user-${es.content}-${Math.floor((es.timestamp||0)*1e3)}`;if(Ms.has(Et)){console.log(`[Tab ${q}] `);break}if(Ms.add(Et),pe.current.set(q,Ms),Ms.size>100){const Bt=Ms.values().next().value;Bt&&Ms.delete(Bt)}H(q,{id:es.message_id||O("user"),type:"user",content:es.content||"",timestamp:es.timestamp||Date.now()/1e3,sender:es.sender});break}case"bot_message":{k(q,{isTyping:!1});const bs=pe.current.get(q)||new Set,gt=`bot-${es.content}-${Math.floor((es.timestamp||0)*1e3)}`;if(bs.has(gt))break;if(bs.add(gt),pe.current.set(q,bs),bs.size>100){const $t=bs.values().next().value;$t&&bs.delete($t)}c($t=>$t.map(tt=>{if(tt.id!==q)return tt;const Ms=tt.messages.filter(Bt=>Bt.type!=="thinking"),Et={id:O("bot"),type:"bot",content:es.content||"",message_type:es.message_type==="rich"?"rich":"text",segments:es.segments,timestamp:es.timestamp||Date.now()/1e3,sender:es.sender};return{...tt,messages:[...Ms,Et]}}));break}case"typing":k(q,{isTyping:es.is_typing||!1});break;case"error":c(bs=>bs.map(gt=>{if(gt.id!==q)return gt;const $t=gt.messages.filter(tt=>tt.type!=="thinking");return{...gt,messages:[...$t,{id:O("error"),type:"error",content:es.content||"",timestamp:es.timestamp||Date.now()/1e3}]}})),ke({title:"",description:es.content,variant:"destructive"});break;case"pong":break;case"history":{const bs=es.messages||[];if(bs.length>0){const gt=pe.current.get(q)||new Set,$t=bs.map(tt=>{const Ms=tt.is_bot||!1,Et=tt.id||O(Ms?"bot":"user"),Bt=`${Ms?"bot":"user"}-${tt.content}-${Math.floor(tt.timestamp*1e3)}`;return gt.add(Bt),{id:Et,type:Ms?"bot":"user",content:tt.content,timestamp:tt.timestamp,sender:{name:tt.sender_name||(Ms?"":""),user_id:tt.sender_id,is_bot:Ms}}});pe.current.set(q,gt),k(q,{messages:$t}),console.log(`[Tab ${q}]  ${$t.length} `)}break}default:console.log(":",es.type)}}catch(es){console.error(":",es)}},Ns.onclose=()=>{k(q,{isConnected:!1}),N(!1),B.current.delete(q),console.log(`[Tab ${q}] WebSocket `);const as=K.current.get(q);as&&clearTimeout(as);const es=window.setTimeout(()=>{if(!Q.current){const bs=i.find(gt=>gt.id===q);bs&&ns(q,bs.type,bs.virtualConfig)}},5e3);K.current.set(q,es)},Ns.onerror=as=>{console.error(`[Tab ${q}] WebSocket :`,as),N(!1)}}catch(Ns){console.error(`[Tab ${q}]  WebSocket :`,Ns),N(!1)}},[w,k,H,ke,i]),Q=d.useRef(!1);d.useEffect(()=>{Q.current=!1;const q=B.current,Ve=K.current,Ke=pe.current;Oe("webui-default");const We=setTimeout(()=>{Q.current||(ns("webui-default","webui"),i.forEach(ts=>{ts.type==="virtual"&&ts.virtualConfig&&(Ke.set(ts.id,new Set),setTimeout(()=>{Q.current||ns(ts.id,"virtual",ts.virtualConfig)},200))}))},100),Ls=setInterval(()=>{q.forEach(ts=>{ts.readyState===WebSocket.OPEN&&ts.send(JSON.stringify({type:"ping"}))})},3e4);return()=>{Q.current=!0,clearTimeout(We),clearInterval(Ls),Ve.forEach(ts=>{clearTimeout(ts)}),Ve.clear(),q.forEach(ts=>{ts.close()}),q.clear()}},[]);const ee=d.useCallback(()=>{const q=B.current.get(u);if(!f.trim()||!q||q.readyState!==WebSocket.OPEN)return;const Ve=h?.type==="virtual"&&h.virtualConfig?.userName||w,Ke=f.trim(),We=Date.now()/1e3;q.send(JSON.stringify({type:"message",content:Ke,user_name:Ve}));const Ls=pe.current.get(u)||new Set,ts=`user-${Ke}-${Math.floor(We*1e3)}`;if(Ls.add(ts),pe.current.set(u,Ls),Ls.size>100){const Ns=Ls.values().next().value;Ns&&Ls.delete(Ns)}const Cs={id:O("user"),type:"user",content:Ke,timestamp:We,sender:{name:Ve,is_bot:!1}};H(u,Cs);const ze={id:O("thinking"),type:"thinking",content:"",timestamp:We+.001,sender:{name:h?.sessionInfo.bot_name||"",is_bot:!0}};H(u,ze),p("")},[f,w,u,h,H]),Ue=q=>{q.key==="Enter"&&!q.shiftKey&&(q.preventDefault(),ee())},ie=()=>{P(w),D(!0)},Te=()=>{const q=S.trim()||"WebUI";b(q),Xk(q),D(!1);const Ve=B.current.get(u);Ve?.readyState===WebSocket.OPEN&&Ve.send(JSON.stringify({type:"update_nickname",user_name:q}))},de=()=>{P(""),D(!1)},Me=q=>new Date(q*1e3).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),rs=()=>{const q=B.current.get(u);q&&(q.close(),B.current.delete(u)),ns(u,h?.type||"webui",h?.virtualConfig)},Ut=()=>{z({platform:"",personId:"",userId:"",userName:"",groupName:"",groupId:""}),ve(""),Ee(),T(!0)},aa=()=>{if(!je.platform||!je.personId){ke({title:"",description:"",variant:"destructive"});return}const q=`webui_virtual_group_${je.platform}_${je.userId}`,Ve=`virtual-${je.platform}-${je.userId}-${Date.now()}`,Ke=je.userName||je.userId,We={id:Ve,type:"virtual",label:Ke,virtualConfig:{...je,groupId:q},messages:[],isConnected:!1,isTyping:!1,sessionInfo:{}};c(Ls=>{const ts=[...Ls,We],Cs=ts.filter(ze=>ze.type==="virtual"&&ze.virtualConfig).map(ze=>({id:ze.id,label:ze.label,virtualConfig:ze.virtualConfig,createdAt:Date.now()}));return Ug(Cs),ts}),x(Ve),T(!1),pe.current.set(Ve,new Set),setTimeout(()=>{ns(Ve,"virtual",je)},100),ke({title:"",description:` ${Ke} `})},Qa=(q,Ve)=>{if(Ve?.stopPropagation(),q==="webui-default")return;const Ke=B.current.get(q);Ke&&(Ke.close(),B.current.delete(q));const We=K.current.get(q);We&&(clearTimeout(We),K.current.delete(q)),pe.current.delete(q),c(Ls=>{const ts=Ls.filter(ze=>ze.id!==q),Cs=ts.filter(ze=>ze.type==="virtual"&&ze.virtualConfig).map(ze=>({id:ze.id,label:ze.label,virtualConfig:ze.virtualConfig,createdAt:Date.now()}));return Ug(Cs),ts}),u===q&&x("webui-default")},Ft=q=>{x(q)},mt=q=>{z(Ve=>({...Ve,personId:q.person_id,userId:q.user_id,userName:q.nickname||q.person_name}))};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(Is,{open:M,onOpenChange:T,children:e.jsxs(Os,{className:"sm:max-w-[500px] max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(bm,{className:"h-5 w-5"}),""]}),e.jsx(Ks,{children:""})]}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Uo,{className:"h-4 w-4"}),""]}),e.jsxs(Ie,{value:je.platform,onValueChange:q=>{z(Ve=>({...Ve,platform:q,personId:"",userId:"",userName:""})),J([])},children:[e.jsx($e,{disabled:U,children:e.jsx(Pe,{placeholder:U?"...":""})}),e.jsx(Be,{children:A.map(q=>e.jsxs(X,{value:q.platform,children:[q.platform," (",q.count," )"]},q.platform))})]})]}),je.platform&&e.jsxs("div",{className:"space-y-2 flex-1 overflow-hidden flex flex-col",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(sc,{className:"h-4 w-4"}),""]}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:ne,onChange:q=>ve(q.target.value),className:"pl-9"})]}),e.jsx(Ye,{className:"h-[250px] border rounded-md",children:e.jsx("div",{className:"p-2",children:xe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Bs,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):L.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(sc,{className:"h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:""})]}):e.jsx("div",{className:"space-y-1",children:L.map(q=>e.jsxs("button",{onClick:()=>mt(q),className:I("w-full flex items-center gap-3 p-2 rounded-md text-left transition-colors",je.personId===q.person_id?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(qi,{className:"h-8 w-8 shrink-0",children:e.jsx(Ki,{className:I("text-xs",je.personId===q.person_id?"bg-primary-foreground/20":"bg-muted"),children:(q.nickname||q.person_name||"?").charAt(0)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate",children:q.nickname||q.person_name}),e.jsxs("div",{className:I("text-xs truncate",je.personId===q.person_id?"text-primary-foreground/70":"text-muted-foreground"),children:["ID: ",q.user_id,q.is_known&&"  "]})]})]},q.person_id))})})})]}),je.personId&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:""}),e.jsx(le,{placeholder:"WebUI",value:je.groupName,onChange:q=>z(Ve=>({...Ve,groupName:q.target.value}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})]}),e.jsxs(st,{className:"gap-2 sm:gap-0",children:[e.jsx(_,{variant:"outline",onClick:()=>T(!1),children:""}),e.jsx(_,{onClick:aa,disabled:!je.platform||!je.personId,children:""})]})]})}),e.jsx("div",{className:"shrink-0 border-b bg-muted/30",children:e.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto py-1.5 scrollbar-thin",children:[i.map(q=>e.jsxs("div",{className:I("flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm whitespace-nowrap transition-colors cursor-pointer","hover:bg-muted",u===q.id?"bg-background shadow-sm border":"text-muted-foreground"),onClick:()=>Ft(q.id),children:[q.type==="webui"?e.jsx(Ma,{className:"h-3.5 w-3.5"}):e.jsx(bm,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"max-w-[100px] truncate",children:q.label}),e.jsx("span",{className:I("w-1.5 h-1.5 rounded-full",q.isConnected?"bg-green-500":"bg-muted-foreground/50")}),q.id!=="webui-default"&&e.jsx("span",{onClick:Ve=>Qa(q.id,Ve),className:"ml-0.5 p-0.5 rounded hover:bg-muted-foreground/20 cursor-pointer",role:"button",tabIndex:0,onKeyDown:Ve=>{(Ve.key==="Enter"||Ve.key===" ")&&(Ve.preventDefault(),Qa(q.id,Ve))},children:e.jsx(Ea,{className:"h-3 w-3"})})]},q.id)),e.jsx("button",{onClick:Ut,className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-sm text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",title:"",children:e.jsx(et,{className:"h-3.5 w-3.5"})})]})})}),e.jsx("div",{className:"shrink-0 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(qi,{className:"h-8 w-8 sm:h-10 sm:w-10 shrink-0",children:e.jsx(Ki,{className:"bg-primary/10 text-primary",children:e.jsx(Pn,{className:"h-4 w-4 sm:h-5 sm:w-5"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:h?.sessionInfo.bot_name||""}),e.jsx("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:h?.isConnected?e.jsxs(e.Fragment,{children:[e.jsx(m_,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:""})]}):g?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(x_,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:""})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[v&&e.jsx(Bs,{className:"h-4 w-4 animate-spin text-muted-foreground"}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:rs,disabled:g,title:"",children:e.jsx(dt,{className:I("h-4 w-4",g&&"animate-spin")})})]})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:h?.type==="virtual"&&h.virtualConfig?e.jsxs(e.Fragment,{children:[e.jsx(bm,{className:"h-3 w-3 text-primary"}),e.jsx("span",{children:""}),e.jsx("span",{className:"font-medium text-primary",children:h.virtualConfig.userName}),e.jsxs("span",{className:"text-xs",children:["(",h.virtualConfig.platform,")"]}),h.virtualConfig.groupName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:""}),e.jsxs("span",{className:"text-xs",children:["",h.virtualConfig.groupName]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(fn,{className:"h-3 w-3"}),e.jsx("span",{children:""}),R?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{value:S,onChange:q=>P(q.target.value),onKeyDown:q=>{q.key==="Enter"&&Te(),q.key==="Escape"&&de()},className:"h-7 w-32",placeholder:"",autoFocus:!0}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:Te,children:""}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:de,children:""})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:w}),e.jsx(_,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:ie,title:"",children:e.jsx(h_,{className:"h-3 w-3"})})]})]})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(Ye,{className:"h-full",children:e.jsxs("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto space-y-3 sm:space-y-4",children:[h?.messages.length===0&&!v&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(Pn,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsxs("p",{className:"text-sm",children:[" ",h?.sessionInfo.bot_name||""," "]})]}),h?.messages.map(q=>e.jsxs("div",{className:I("flex gap-2 sm:gap-3",q.type==="user"&&"flex-row-reverse",q.type==="system"&&"justify-center",q.type==="error"&&"justify-center"),children:[q.type==="system"&&e.jsx("div",{className:"text-xs text-muted-foreground bg-muted/50 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="error"&&e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30 px-3 py-1 rounded-full max-w-[90%]",children:q.content}),q.type==="thinking"&&e.jsxs(e.Fragment,{children:[e.jsx(qi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Ki,{className:"bg-primary/10 text-primary",children:e.jsx(Pn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:"flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",children:[e.jsx("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||h?.sessionInfo.bot_name})}),e.jsx("div",{className:"bg-muted rounded-2xl rounded-tl-sm px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-primary/60 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"..."})]})})]})]}),(q.type==="user"||q.type==="bot")&&e.jsxs(e.Fragment,{children:[e.jsx(qi,{className:"h-7 w-7 sm:h-8 sm:w-8 shrink-0",children:e.jsx(Ki,{className:I("text-xs",q.type==="bot"?"bg-primary/10 text-primary":"bg-secondary text-secondary-foreground"),children:q.type==="bot"?e.jsx(Pn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):e.jsx(fn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})}),e.jsxs("div",{className:I("flex flex-col gap-1 max-w-[75%] sm:max-w-[70%]",q.type==="user"&&"items-end"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:q.sender?.name||(q.type==="bot"?h?.sessionInfo.bot_name:w)}),e.jsx("span",{children:Me(q.timestamp)})]}),e.jsx("div",{className:I("rounded-2xl px-3 py-2 text-sm break-words",q.type==="bot"?"bg-muted rounded-tl-sm":"bg-primary text-primary-foreground rounded-tr-sm"),children:e.jsx(eC,{message:q,isBot:q.type==="bot"})})]})]})]},q.id)),e.jsx("div",{ref:oe})]})})}),e.jsx("div",{className:"shrink-0 border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-3 sm:p-4 max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{value:f,onChange:q=>p(q.target.value),onKeyDown:Ue,placeholder:h?.isConnected?"...":"...",disabled:!h?.isConnected,className:"flex-1 h-10 sm:h-10"}),e.jsx(_,{onClick:ee,disabled:!h?.isConnected||!f.trim(),size:"icon",className:"h-10 w-10 shrink-0",children:e.jsx(f_,{className:"h-4 w-4"})})]})})})]})}var ux="Radio",[tC,Vv]=Ko(ux),[aC,lC]=tC(ux),qv=d.forwardRef((l,n)=>{const{__scopeRadio:i,name:c,checked:u=!1,required:x,disabled:h,value:f="on",onCheck:p,form:g,...N}=l,[v,y]=d.useState(null),w=Qo(n,D=>y(D)),b=d.useRef(!1),R=v?g||!!v.closest("form"):!0;return e.jsxs(aC,{scope:i,checked:u,disabled:h,children:[e.jsx(Qn.button,{type:"button",role:"radio","aria-checked":u,"data-state":Jv(u),"data-disabled":h?"":void 0,disabled:h,value:f,...N,ref:w,onClick:hn(l.onClick,D=>{u||p?.(),R&&(b.current=D.isPropagationStopped(),b.current||D.stopPropagation())})}),R&&e.jsx(Yv,{control:v,bubbles:!b.current,name:c,value:f,checked:u,required:x,disabled:h,form:g,style:{transform:"translateX(-100%)"}})]})});qv.displayName=ux;var Kv="RadioIndicator",Qv=d.forwardRef((l,n)=>{const{__scopeRadio:i,forceMount:c,...u}=l,x=lC(Kv,i);return e.jsx(Dw,{present:c||x.checked,children:e.jsx(Qn.span,{"data-state":Jv(x.checked),"data-disabled":x.disabled?"":void 0,...u,ref:n})})});Qv.displayName=Kv;var nC="RadioBubbleInput",Yv=d.forwardRef(({__scopeRadio:l,control:n,checked:i,bubbles:c=!0,...u},x)=>{const h=d.useRef(null),f=Qo(h,x),p=Rw(i),g=Lw(n);return d.useEffect(()=>{const N=h.current;if(!N)return;const v=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(v,"checked").set;if(p!==i&&w){const b=new Event("click",{bubbles:c});w.call(N,i),N.dispatchEvent(b)}},[p,i,c]),e.jsx(Qn.input,{type:"radio","aria-hidden":!0,defaultChecked:i,...u,tabIndex:-1,ref:f,style:{...u.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Yv.displayName=nC;function Jv(l){return l?"checked":"unchecked"}var rC=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],rd="RadioGroup",[iC]=Ko(rd,[rj,Vv]),Xv=rj(),Zv=Vv(),[cC,oC]=iC(rd),Wv=d.forwardRef((l,n)=>{const{__scopeRadioGroup:i,name:c,defaultValue:u,value:x,required:h=!1,disabled:f=!1,orientation:p,dir:g,loop:N=!0,onValueChange:v,...y}=l,w=Xv(i),b=_j(g),[R,D]=qo({prop:x,defaultProp:u??null,onChange:v,caller:rd});return e.jsx(cC,{scope:i,name:c,required:h,disabled:f,value:R,onValueChange:D,children:e.jsx(J0,{asChild:!0,...w,orientation:p,dir:b,loop:N,children:e.jsx(Qn.div,{role:"radiogroup","aria-required":h,"aria-orientation":p,"data-disabled":f?"":void 0,dir:b,...y,ref:n})})})});Wv.displayName=rd;var eN="RadioGroupItem",sN=d.forwardRef((l,n)=>{const{__scopeRadioGroup:i,disabled:c,...u}=l,x=oC(eN,i),h=x.disabled||c,f=Xv(i),p=Zv(i),g=d.useRef(null),N=Qo(n,g),v=x.value===u.value,y=d.useRef(!1);return d.useEffect(()=>{const w=R=>{rC.includes(R.key)&&(y.current=!0)},b=()=>y.current=!1;return document.addEventListener("keydown",w),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",w),document.removeEventListener("keyup",b)}},[]),e.jsx(X0,{asChild:!0,...f,focusable:!h,active:v,children:e.jsx(qv,{disabled:h,required:x.required,checked:v,...p,...u,name:x.name,ref:N,onCheck:()=>x.onValueChange(u.value),onKeyDown:hn(w=>{w.key==="Enter"&&w.preventDefault()}),onFocus:hn(u.onFocus,()=>{y.current&&g.current?.click()})})})});sN.displayName=eN;var dC="RadioGroupIndicator",tN=d.forwardRef((l,n)=>{const{__scopeRadioGroup:i,...c}=l,u=Zv(i);return e.jsx(Qv,{...u,...c,ref:n})});tN.displayName=dC;var aN=Wv,lN=sN,uC=tN;const mx=d.forwardRef(({className:l,...n},i)=>e.jsx(aN,{className:I("grid gap-2",l),...n,ref:i}));mx.displayName=aN.displayName;const Go=d.forwardRef(({className:l,...n},i)=>e.jsx(lN,{ref:i,className:I("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",l),...n,children:e.jsx(uC,{className:"flex items-center justify-center",children:e.jsx(Lo,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Go.displayName=lN.displayName;function mC({question:l,value:n,onChange:i,error:c,disabled:u=!1}){const[x,h]=d.useState(null),f=u||l.readOnly,p=()=>{switch(l.type){case"single":return e.jsx(mx,{value:n||"",onValueChange:i,disabled:f,className:"space-y-2",children:l.options?.map(g=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Go,{value:g.value,id:`${l.id}-${g.id}`}),e.jsx(E,{htmlFor:`${l.id}-${g.id}`,className:"cursor-pointer font-normal",children:g.label})]},g.id))});case"multiple":{const g=n||[];return e.jsxs("div",{className:"space-y-2",children:[l.options?.map(N=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:`${l.id}-${N.id}`,checked:g.includes(N.value),disabled:f||l.maxSelections!==void 0&&g.length>=l.maxSelections&&!g.includes(N.value),onCheckedChange:v=>{i(v?[...g,N.value]:g.filter(y=>y!==N.value))}}),e.jsx(E,{htmlFor:`${l.id}-${N.id}`,className:"cursor-pointer font-normal",children:N.label})]},N.id)),l.maxSelections&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",l.maxSelections," "]})]})}case"text":return e.jsx(le,{value:n||"",onChange:g=>i(g.target.value),placeholder:l.placeholder||"...",disabled:f,readOnly:l.readOnly,maxLength:l.maxLength,className:I(l.readOnly&&"bg-muted cursor-not-allowed")});case"textarea":return e.jsxs("div",{className:"space-y-1",children:[e.jsx(ot,{value:n||"",onChange:g=>i(g.target.value),placeholder:l.placeholder||"...",disabled:f,readOnly:l.readOnly,maxLength:l.maxLength,rows:4,className:I(l.readOnly&&"bg-muted cursor-not-allowed")}),l.maxLength&&e.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[(n||"").length," / ",l.maxLength]})]});case"rating":{const g=n||0,N=x!==null?x:g;return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(v=>e.jsx("button",{type:"button",disabled:f,className:I("p-1 transition-colors focus:outline-none focus:ring-2 focus:ring-ring rounded",f&&"cursor-not-allowed opacity-50"),onMouseEnter:()=>!f&&h(v),onMouseLeave:()=>h(null),onClick:()=>!f&&i(v),children:e.jsx(dn,{className:I("h-6 w-6 transition-colors",v<=N?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},v)),g>0&&e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:[g," / 5"]})]})}case"scale":{const g=l.min??1,N=l.max??10,v=l.step??1,y=n??g;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(qa,{value:[y],onValueChange:([w])=>i(w),min:g,max:N,step:v,disabled:f}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:l.minLabel||g}),e.jsx("span",{className:"font-medium text-foreground",children:y}),e.jsx("span",{children:l.maxLabel||N})]})]})}case"dropdown":return e.jsxs(Ie,{value:n||"",onValueChange:i,disabled:f,children:[e.jsx($e,{children:e.jsx(Pe,{placeholder:l.placeholder||"..."})}),e.jsx(Be,{children:l.options?.map(g=>e.jsx(X,{value:g.value,children:g.label},g.id))})]});default:return e.jsx("div",{className:"text-muted-foreground",children:""})}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(E,{className:"text-base font-medium",children:[l.title,l.required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),l.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:l.description})]}),p(),c&&e.jsx("p",{className:"text-sm text-destructive",children:c})]})}const nN="https://maibot-plugin-stats.maibot-webui.workers.dev";function rN(){const l="maibot_user_id";let n=localStorage.getItem(l);if(!n){const i=Math.random().toString(36).substring(2,10),c=Date.now().toString(36),u=Math.random().toString(36).substring(2,10);n=`fp_${i}_${c}_${u}`,localStorage.setItem(l,n)}return n}async function xC(l,n,i,c){try{const u=c?.userId||rN(),x={surveyId:l,surveyVersion:n,userId:u,answers:i,submittedAt:new Date().toISOString(),allowMultiple:c?.allowMultiple,metadata:{userAgent:navigator.userAgent,language:navigator.language}},h=await fetch(`${nN}/survey/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}),f=await h.json();return h.status===429?{success:!1,error:""}:h.status===409?{success:!1,error:f.error||""}:h.ok?{success:!0,submissionId:f.submissionId,message:f.message}:{success:!1,error:f.error||""}}catch(u){return console.error("Error submitting survey:",u),{success:!1,error:""}}}async function hC(l,n){try{const i=n||rN(),c=new URLSearchParams({user_id:i,survey_id:l}),u=await fetch(`${nN}/survey/check?${c}`);return u.ok?{success:!0,hasSubmitted:(await u.json()).hasSubmitted}:{success:!1,error:(await u.json()).error||""}}catch(i){return console.error("Error checking submission:",i),{success:!1,error:""}}}function iN({config:l,initialAnswers:n,onSubmitSuccess:i,onSubmitError:c,showProgress:u=!0,paginateQuestions:x=!1,className:h}){const f=d.useCallback(()=>!n||n.length===0?{}:n.reduce((B,oe)=>(B[oe.questionId]=oe.value,B),{}),[n]),[p,g]=d.useState(()=>f()),[N,v]=d.useState({}),[y,w]=d.useState(0),[b,R]=d.useState(!1),[D,S]=d.useState(!1),[P,M]=d.useState(null),[T,A]=d.useState(null),[F,L]=d.useState(!1),[J,U]=d.useState(!0);d.useEffect(()=>{n&&n.length>0&&g(B=>({...B,...f()}))},[n,f]),d.useEffect(()=>{(async()=>{if(!l.settings?.allowMultiple){const oe=await hC(l.id);oe.success&&oe.hasSubmitted&&L(!0)}U(!1)})()},[l.id,l.settings?.allowMultiple]);const ue=d.useCallback(()=>{const B=new Date;return!(l.settings?.startTime&&new Date(l.settings.startTime)>B||l.settings?.endTime&&new Date(l.settings.endTime)<B)},[l.settings?.startTime,l.settings?.endTime]),xe=l.questions.filter(B=>{const oe=p[B.id];return oe==null?!1:Array.isArray(oe)?oe.length>0:typeof oe=="string"?oe.trim()!=="":!0}).length,he=xe/l.questions.length*100,ne=d.useCallback((B,oe)=>{g(K=>({...K,[B]:oe})),v(K=>{const _e={...K};return delete _e[B],_e})},[]),ve=d.useCallback(()=>{const B={};for(const oe of l.questions){if(oe.required){const K=p[oe.id];if(K==null){B[oe.id]="";continue}if(Array.isArray(K)&&K.length===0){B[oe.id]="";continue}if(typeof K=="string"&&K.trim()===""){B[oe.id]="";continue}}oe.minLength&&typeof p[oe.id]=="string"&&p[oe.id].length<oe.minLength&&(B[oe.id]=` ${oe.minLength} `)}return v(B),Object.keys(B).length===0},[l.questions,p]),je=d.useCallback(async()=>{if(!ve()){if(x){const B=l.questions.findIndex(oe=>N[oe.id]);B>=0&&w(B)}return}R(!0),M(null);try{const B=l.questions.filter(K=>p[K.id]!==void 0).map(K=>({questionId:K.id,value:p[K.id]})),oe=await xC(l.id,l.version,B,{allowMultiple:l.settings?.allowMultiple});if(oe.success&&oe.submissionId)S(!0),A(oe.submissionId),i?.(oe.submissionId);else{const K=oe.error||"";M(K),c?.(K)}}catch(B){const oe=B instanceof Error?B.message:"";M(oe),c?.(oe)}finally{R(!1)}},[ve,x,l,p,N,i,c]),z=d.useCallback(B=>{B>=0&&B<l.questions.length&&w(B)},[l.questions.length]);if(J)return e.jsx(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:e.jsx(Ae,{className:"py-12 flex items-center justify-center",children:e.jsx(Bs,{className:"h-6 w-6 animate-spin text-muted-foreground"})})});if(F&&!l.settings?.allowMultiple)return e.jsxs(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsx(Le,{children:l.title})}),e.jsx(Ae,{className:"py-8",children:e.jsxs(at,{children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]})})]});if(!ue())return e.jsxs(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsx(Le,{children:l.title})}),e.jsx(Ae,{className:"py-8",children:e.jsxs(at,{variant:"destructive",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]})})]});if(D)return e.jsxs(Ce,{className:I("w-full max-w-2xl mx-auto",h),children:[e.jsx(De,{children:e.jsxs(Le,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(pt,{className:"h-6 w-6"}),""]})}),e.jsxs(Ae,{className:"py-8",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:l.settings?.thankYouMessage||""}),T&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["",T]})]})]});const V=x?[l.questions[y]]:l.questions;return e.jsxs("div",{className:I("h-full flex flex-col",h),children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4 sm:p-6 mb-4 shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold",children:l.title}),l.description&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:l.description}),u&&e.jsxs("div",{className:"space-y-1 pt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[xe," / ",l.questions.length]})]}),e.jsx(Kn,{value:he,className:"h-2"})]})]}),e.jsx(Ye,{className:"flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-4 pr-4",children:[V.map((B,oe)=>e.jsxs("div",{className:I("p-4 rounded-lg border bg-card",N[B.id]?"border-destructive bg-destructive/5":"border-border"),children:[x&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[" ",y+1," / ",l.questions.length]}),!x&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[oe+1,"."]}),e.jsx(mC,{question:B,value:p[B.id],onChange:K=>ne(B.id,K),error:N[B.id],disabled:b})]},B.id)),P&&e.jsxs(at,{variant:"destructive",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:P})]}),e.jsx("div",{className:"flex justify-between items-center py-4",children:x?e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"outline",onClick:()=>z(y-1),disabled:y===0||b,children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),""]}),y===l.questions.length-1?e.jsxs(_,{onClick:je,disabled:b,children:[b&&e.jsx(Bs,{className:"h-4 w-4 mr-2 animate-spin"}),""]}):e.jsxs(_,{onClick:()=>z(y+1),disabled:b,children:["",e.jsx(Zt,{className:"h-4 w-4 ml-1"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Object.keys(N).length>0&&e.jsxs("span",{className:"text-destructive",children:[" ",Object.keys(N).length," "]})}),e.jsxs(_,{onClick:je,disabled:b,size:"lg",children:[b&&e.jsx(Bs,{className:"h-4 w-4 mr-2 animate-spin"}),""]})]})})]})})]})}const fC={id:"webui-feedback-v1",version:"1.0.0",title:" WebUI ",description:" WebUI",questions:[{id:"webui_version",type:"text",title:" WebUI ",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"ui_design_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"problems_encountered",type:"multiple",title:" WebUI ",description:"",required:!0,options:[{id:"lag",label:"",value:"lag"},{id:"incomplete",label:"",value:"incomplete"},{id:"complex",label:"",value:"complex"},{id:"bugs",label:" Bug",value:"bugs"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"useful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:" WebUI ",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:" WebUI ",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}},pC={id:"maibot-feedback-v1",version:"1.0.0",title:"",description:" AI ",questions:[{id:"maibot_version",type:"text",title:"",description:"",required:!0,readOnly:!0,placeholder:"..."},{id:"improvement_areas",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"problems_encountered",type:"multiple",title:"",description:"",required:!0,options:[{id:"incomplete",label:"",value:"incomplete"},{id:"slow_response",label:"",value:"slow_response"},{id:"complex",label:"",value:"complex"},{id:"unstable",label:"",value:"unstable"},{id:"config_difficult",label:"",value:"config_difficult"},{id:"none",label:"",value:"none"},{id:"other",label:"",value:"other"}]},{id:"problems_other",type:"text",title:'""',required:!1,placeholder:"...",maxLength:500},{id:"helpful_features",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"feature_requests",type:"textarea",title:"",required:!0,placeholder:"...",maxLength:1e3},{id:"overall_satisfaction",type:"single",title:"",required:!0,options:[{id:"very_satisfied",label:"",value:"very_satisfied"},{id:"satisfied",label:"",value:"satisfied"},{id:"neutral",label:"",value:"neutral"},{id:"dissatisfied",label:"",value:"dissatisfied"},{id:"very_dissatisfied",label:"",value:"very_dissatisfied"}]},{id:"would_recommend",type:"single",title:"",required:!0,options:[{id:"yes",label:"",value:"yes"},{id:"no",label:"",value:"no"}]},{id:"other_suggestions",type:"textarea",title:"",description:"",required:!1,placeholder:"...",maxLength:2e3}],settings:{allowMultiple:!1,thankYouMessage:""}};function gC(){const[l,n]=d.useState(!0),i=d.useMemo(()=>JSON.parse(JSON.stringify(fC)),[]);d.useEffect(()=>{n(!1)},[]);const c=d.useMemo(()=>[{questionId:"webui_version",value:`v${ed}`}],[]),u=d.useCallback(h=>{console.log("WebUI Survey submitted:",h)},[]),x=d.useCallback(h=>{console.error("WebUI Survey submission error:",h)},[]);return l?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Bs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):i?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Hj,{className:"h-8 w-8",strokeWidth:2}),"WebUI "]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:""})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(iN,{config:i,initialAnswers:c,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:u,onSubmitError:x})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(at,{variant:"destructive",className:"max-w-md",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}function jC(){const[l,n]=d.useState(null),[i,c]=d.useState(!0),[u,x]=d.useState("");d.useEffect(()=>{(async()=>{try{const v=await c1();x(v.version||"")}catch(v){console.error("Failed to get MaiBot version:",v),x("")}const N=JSON.parse(JSON.stringify(pC));n(N),c(!1)})()},[]);const h=d.useMemo(()=>[{questionId:"maibot_version",value:u}],[u]),f=d.useCallback(g=>{console.log("MaiBot Survey submitted:",g)},[]),p=d.useCallback(g=>{console.error("MaiBot Survey submission error:",g)},[]);return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(Bs,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):l?e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 shrink-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(Hj,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" AI "})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(iN,{config:l,initialAnswers:h,showProgress:!0,paginateQuestions:!1,onSubmitSuccess:f,onSubmitError:p})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[e.jsxs(at,{variant:"destructive",className:"max-w-md",children:[e.jsx(_t,{className:"h-4 w-4"}),e.jsx(lt,{children:""})]}),e.jsx(_,{variant:"outline",onClick:()=>window.location.reload(),children:""})]})}async function vC(l=2025){const n=await we(`/api/webui/annual-report/full?year=${l}`);if(!n.ok){const i=await n.json();throw new Error(i.detail||"")}return n.json()}const $g=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"];function NC(){const[l]=d.useState(2025),[n,i]=d.useState(null),[c,u]=d.useState(!0),[x,h]=d.useState(null),f=d.useRef(null),p=d.useCallback(async()=>{try{u(!0),h(null);const g=await vC(l);i(g)}catch(g){h(g instanceof Error?g:new Error(""))}finally{u(!1)}},[l]);return d.useEffect(()=>{p()},[p]),c?e.jsx(bC,{}):x?e.jsxs("div",{className:"flex h-screen items-center justify-center text-red-500",children:[": ",x.message]}):n?e.jsx(Ye,{className:"h-[calc(100vh-4rem)]",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/50 p-4 md:p-8 print:p-0",children:e.jsxs("div",{className:"mx-auto max-w-5xl space-y-8 print:space-y-4",ref:f,children:[e.jsxs("header",{className:"relative overflow-hidden rounded-3xl bg-primary p-8 text-primary-foreground shadow-2xl print:rounded-none print:shadow-none",children:[e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx(Pn,{className:"mb-4 h-16 w-16 animate-bounce"}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tighter sm:text-6xl",children:[" ",n.year," "]}),e.jsx("p",{className:"mt-4 max-w-2xl text-lg opacity-90",children:"  Connection & Growth"}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-sm opacity-75",children:[e.jsx($o,{className:"h-4 w-4"}),e.jsxs("span",{children:[": ",n.generated_at]})]})]}),e.jsx("div",{className:"absolute -right-20 -top-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 h-64 w-64 rounded-full bg-white/10 blur-3xl"})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(na,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(ka,{title:"",value:`${n.time_footprint.total_online_hours} `,description:"",icon:e.jsx(na,{className:"h-4 w-4"})}),e.jsx(ka,{title:"",value:n.time_footprint.busiest_day||"N/A",description:` ${n.time_footprint.busiest_day_count} `,icon:e.jsx($o,{className:"h-4 w-4"})}),e.jsx(ka,{title:" (0-4)",value:`${n.time_footprint.midnight_chat_count} `,description:"",icon:e.jsx(Qi,{className:"h-4 w-4"})}),e.jsx(ka,{title:"",value:n.time_footprint.is_night_owl?"":"",description:n.time_footprint.is_night_owl?"":"",icon:n.time_footprint.is_night_owl?e.jsx(Qi,{className:"h-4 w-4"}):e.jsx(qm,{className:"h-4 w-4"})})]}),e.jsxs(Ce,{className:"overflow-hidden",children:[e.jsxs(De,{children:[e.jsx(Le,{children:"24"}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{className:"h-[300px]",children:e.jsx(oj,{width:"100%",height:"100%",children:e.jsxs(Eo,{data:n.time_footprint.hourly_distribution.map((g,N)=>({hour:`${N}`,count:g})),children:[e.jsx(Hi,{strokeDasharray:"3 3",vertical:!1}),e.jsx(Fi,{dataKey:"hour"}),e.jsx(Ur,{}),e.jsx(dj,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},cursor:{fill:"transparent"}}),e.jsx(Gi,{dataKey:"count",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),n.time_footprint.first_message_time&&e.jsx(Ce,{className:"bg-muted/30 border-dashed",children:e.jsxs(Ae,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"2025"}),e.jsx("div",{className:"text-xl font-bold text-primary mb-1",children:n.time_footprint.first_message_time}),e.jsxs("p",{className:"text-lg",children:[e.jsx("span",{className:"font-semibold text-foreground",children:n.time_footprint.first_message_user})," ",e.jsxs("span",{className:"italic text-muted-foreground",children:['"',n.time_footprint.first_message_content,'"']})]})]})})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(sc,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(ka,{title:"",value:`${n.social_network.total_groups} `,description:` ${n.social_network.new_friends_count} `,icon:e.jsx(sc,{className:"h-4 w-4"})}),e.jsx(ka,{title:"",value:`${n.social_network.at_count+n.social_network.mentioned_count} `,description:"",icon:e.jsx(p_,{className:"h-4 w-4"})}),e.jsx(ka,{title:"",value:n.social_network.longest_companion_user||"N/A",description:` ${n.social_network.longest_companion_days} `,icon:e.jsx(Vr,{className:"h-4 w-4 text-red-500"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Le,{children:" TOP3"})}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-4",children:n.social_network.top_groups.map((g,N)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{variant:N===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center",children:N+1}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:g.group_name})]}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[g.message_count," "]})]},g.group_id))})})]}),e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Le,{children:" TOP3"})}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-4",children:n.social_network.top_users.map((g,N)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{variant:N===0?"default":"secondary",className:"h-6 w-6 rounded-full p-0 flex items-center justify-center",children:N+1}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:g.user_nickname})]}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[g.message_count," "]})]},g.user_id))})})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(Xm,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(ka,{title:" Token ",value:(n.brain_power.total_tokens/1e6).toFixed(2)+" M",description:" 0.5 ",icon:e.jsx(Za,{className:"h-4 w-4"})}),e.jsx(ka,{title:"",value:`$${n.brain_power.total_cost.toFixed(2)}`,description:"",icon:e.jsx("span",{className:"font-bold",children:"$"})}),e.jsx(ka,{title:"",value:`${n.brain_power.silence_rate}%`,description:` ${n.brain_power.no_reply_count} `,icon:e.jsx(Qi,{className:"h-4 w-4"})}),e.jsx(ka,{title:"",value:n.brain_power.max_interest_value??"N/A",description:n.brain_power.max_interest_time?` ${n.brain_power.max_interest_time}`:"",icon:e.jsx(Vr,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsx(Le,{children:""})}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-3",children:n.brain_power.model_distribution.slice(0,5).map((g,N)=>{const v=n.brain_power.model_distribution[0]?.count||1,y=Math.round(g.count/v*100);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:g.model}),e.jsxs("span",{className:"text-muted-foreground",children:[g.count.toLocaleString()," "]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${y}%`,backgroundColor:$g[N%$g.length]}})})]},g.model)})})})]}),e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:" TOP3"}),e.jsx(ws,{children:" API "})]}),e.jsx(Ae,{children:e.jsx("div",{className:"space-y-6",children:n.brain_power.top_token_consumers.map(g=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsxs("span",{children:[" ",g.user_id]}),e.jsxs("span",{children:["$",g.cost.toFixed(2)]})]}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-500",style:{width:`${g.cost/(n.brain_power.top_token_consumers[0]?.cost||1)*100}%`}})})]},g.user_id))})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20",children:[e.jsx(De,{children:e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Ae,{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-amber-600 dark:text-amber-400",children:["$",n.brain_power.most_expensive_cost.toFixed(4)]}),n.brain_power.most_expensive_time&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[" ",n.brain_power.most_expensive_time]}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:""})]})]}),e.jsxs(Ce,{className:"bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-950/20 dark:to-blue-950/20",children:[e.jsx(De,{children:e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]})}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:n.brain_power.avg_reasoning_length?.toFixed(0)||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:n.brain_power.max_reasoning_length?.toLocaleString()||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:""})]})]}),n.brain_power.max_reasoning_time&&e.jsxs("p",{className:"mt-4 text-center text-xs text-muted-foreground",children:[" ",n.brain_power.max_reasoning_time]})]})]})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(Yo,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(Ce,{className:"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/20 dark:to-purple-950/20",children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{className:"flex flex-col items-center justify-center",children:n.expression_vibe.top_emoji?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-4 h-48 w-48 overflow-hidden rounded-lg shadow-lg transition-transform hover:scale-105",children:[e.jsx("img",{src:`/api/webui/emoji/${n.expression_vibe.top_emoji.id}/thumbnail?original=true`,alt:"Top Emoji",className:"h-full w-full object-cover"}),e.jsx(Se,{className:"absolute right-2 top-2 bg-yellow-500",children:"NO.1"})]}),e.jsxs("p",{className:"text-center font-medium text-lg",children:['"',n.expression_vibe.top_emoji.description,'"']}),e.jsxs("p",{className:"text-muted-foreground",children:[" ",n.expression_vibe.top_emoji.usage_count," "]})]}):e.jsx("div",{className:"flex h-48 items-center justify-center text-muted-foreground",children:""})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:n.expression_vibe.top_expressions.map((g,N)=>e.jsxs(Se,{variant:"outline",className:I("px-3 py-1 text-sm",N===0&&"border-primary bg-primary/10 text-primary text-base px-4 py-2"),children:[g.style," (",g.count,")"]},g.style))})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ka,{title:"",value:`${n.expression_vibe.image_processed_count} `,description:"",icon:e.jsx(Jm,{className:"h-4 w-4"})}),e.jsx(ka,{title:"",value:`${n.expression_vibe.rejected_expression_count} `,description:"",icon:e.jsx(Za,{className:"h-4 w-4"})})]})]})]}),n.expression_vibe.action_types.length>0&&e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:""}),""]}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:n.expression_vibe.action_types.map(g=>e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-primary/10 px-4 py-2",children:[e.jsx("span",{className:"font-medium text-primary",children:g.action}),e.jsxs(Se,{variant:"secondary",children:[g.count," "]})]},g.action))})})]})]}),e.jsxs("section",{className:"space-y-4 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(g_,{className:"h-8 w-8"}),e.jsx("h2",{children:""})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(Ce,{className:"col-span-1 md:col-span-2",children:[e.jsxs(De,{children:[e.jsx(Le,{children:'""'}),e.jsxs(ws,{children:[" ",n.achievements.new_jargon_count," "]})]}),e.jsx(Ae,{children:e.jsx("div",{className:"flex flex-wrap gap-3",children:n.achievements.sample_jargons.map(g=>e.jsxs("div",{className:"group relative rounded-lg border bg-card p-3 shadow-sm transition-all hover:shadow-md",children:[e.jsx("div",{className:"font-bold text-primary",children:g.content}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2 max-w-[200px]",children:g.meaning||""})]},g.content))})})]}),e.jsx(Ce,{className:"flex flex-col justify-center items-center bg-primary text-primary-foreground",children:e.jsxs(Ae,{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Ma,{className:"h-12 w-12 mb-4 opacity-80"}),e.jsx("div",{className:"text-4xl font-bold mb-2",children:n.achievements.total_messages.toLocaleString()}),e.jsx("div",{className:"text-sm opacity-80",children:""}),e.jsxs("div",{className:"mt-4 text-xs opacity-60",children:[" ",n.achievements.total_replies.toLocaleString()," "]})]})})]})]}),e.jsxs("footer",{className:"mt-12 text-center text-muted-foreground",children:[e.jsx("p",{children:"MaiBot 2025 Annual Report"}),e.jsx("p",{className:"text-sm",children:"Generated with  by MaiBot Team"})]})]})})}):null}function ka({title:l,value:n,description:i,icon:c}){return e.jsxs(Ce,{children:[e.jsxs(De,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Le,{className:"text-sm font-medium",children:l}),e.jsx("div",{className:"text-muted-foreground",children:c})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i})]})]})}function bC(){return e.jsxs("div",{className:"container mx-auto space-y-8 p-8",children:[e.jsx(js,{className:"h-64 w-full rounded-3xl"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[...Array(4)].map((l,n)=>e.jsx(js,{className:"h-32 w-full"},n))}),e.jsx(js,{className:"h-96 w-full"})]})}var id="DropdownMenu",[yC]=Ko(id,[ij]),oa=ij(),[wC,cN]=yC(id),oN=l=>{const{__scopeDropdownMenu:n,children:i,dir:c,open:u,defaultOpen:x,onOpenChange:h,modal:f=!0}=l,p=oa(n),g=d.useRef(null),[N,v]=qo({prop:u,defaultProp:x??!1,onChange:h,caller:id});return e.jsx(wC,{scope:n,triggerId:Lm(),triggerRef:g,contentId:Lm(),open:N,onOpenChange:v,onOpenToggle:d.useCallback(()=>v(y=>!y),[v]),modal:f,children:e.jsx(cw,{...p,open:N,onOpenChange:v,dir:c,modal:f,children:i})})};oN.displayName=id;var dN="DropdownMenuTrigger",uN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,disabled:c=!1,...u}=l,x=cN(dN,i),h=oa(i);return e.jsx(ow,{asChild:!0,...h,children:e.jsx(Qn.button,{type:"button",id:x.triggerId,"aria-haspopup":"menu","aria-expanded":x.open,"aria-controls":x.open?x.contentId:void 0,"data-state":x.open?"open":"closed","data-disabled":c?"":void 0,disabled:c,...u,ref:Uw(n,x.triggerRef),onPointerDown:hn(l.onPointerDown,f=>{!c&&f.button===0&&f.ctrlKey===!1&&(x.onOpenToggle(),x.open||f.preventDefault())}),onKeyDown:hn(l.onKeyDown,f=>{c||(["Enter"," "].includes(f.key)&&x.onOpenToggle(),f.key==="ArrowDown"&&x.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});uN.displayName=dN;var _C="DropdownMenuPortal",mN=l=>{const{__scopeDropdownMenu:n,...i}=l,c=oa(n);return e.jsx(ew,{...c,...i})};mN.displayName=_C;var xN="DropdownMenuContent",hN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=cN(xN,i),x=oa(i),h=d.useRef(!1);return e.jsx(sw,{id:u.contentId,"aria-labelledby":u.triggerId,...x,...c,ref:n,onCloseAutoFocus:hn(l.onCloseAutoFocus,f=>{h.current||u.triggerRef.current?.focus(),h.current=!1,f.preventDefault()}),onInteractOutside:hn(l.onInteractOutside,f=>{const p=f.detail.originalEvent,g=p.button===0&&p.ctrlKey===!0,N=p.button===2||g;(!u.modal||N)&&(h.current=!0)}),style:{...l.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});hN.displayName=xN;var SC="DropdownMenuGroup",kC=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(dw,{...u,...c,ref:n})});kC.displayName=SC;var CC="DropdownMenuLabel",fN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(rw,{...u,...c,ref:n})});fN.displayName=CC;var TC="DropdownMenuItem",pN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(tw,{...u,...c,ref:n})});pN.displayName=TC;var EC="DropdownMenuCheckboxItem",gN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(aw,{...u,...c,ref:n})});gN.displayName=EC;var MC="DropdownMenuRadioGroup",zC=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(uw,{...u,...c,ref:n})});zC.displayName=MC;var AC="DropdownMenuRadioItem",jN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(nw,{...u,...c,ref:n})});jN.displayName=AC;var OC="DropdownMenuItemIndicator",vN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(lw,{...u,...c,ref:n})});vN.displayName=OC;var DC="DropdownMenuSeparator",NN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(iw,{...u,...c,ref:n})});NN.displayName=DC;var RC="DropdownMenuArrow",LC=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(mw,{...u,...c,ref:n})});LC.displayName=RC;var UC="DropdownMenuSubTrigger",bN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(Z0,{...u,...c,ref:n})});bN.displayName=UC;var $C="DropdownMenuSubContent",yN=d.forwardRef((l,n)=>{const{__scopeDropdownMenu:i,...c}=l,u=oa(i);return e.jsx(W0,{...u,...c,ref:n,style:{...l.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});yN.displayName=$C;var BC=oN,IC=uN,PC=mN,wN=hN,_N=fN,SN=pN,kN=gN,CN=jN,TN=vN,EN=NN,MN=bN,zN=yN;const HC=BC,FC=IC,GC=d.forwardRef(({className:l,inset:n,children:i,...c},u)=>e.jsxs(MN,{ref:u,className:I("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",l),...c,children:[i,e.jsx(Zt,{className:"ml-auto h-4 w-4"})]}));GC.displayName=MN.displayName;const VC=d.forwardRef(({className:l,...n},i)=>e.jsx(zN,{ref:i,className:I("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...n}));VC.displayName=zN.displayName;const AN=d.forwardRef(({className:l,sideOffset:n=4,...i},c)=>e.jsx(PC,{children:e.jsx(wN,{ref:c,sideOffset:n,className:I("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...i})}));AN.displayName=wN.displayName;const ON=d.forwardRef(({className:l,inset:n,...i},c)=>e.jsx(SN,{ref:c,className:I("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",l),...i}));ON.displayName=SN.displayName;const qC=d.forwardRef(({className:l,children:n,checked:i,...c},u)=>e.jsxs(kN,{ref:u,className:I("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),checked:i,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(TN,{children:e.jsx(Ct,{className:"h-4 w-4"})})}),n]}));qC.displayName=kN.displayName;const KC=d.forwardRef(({className:l,children:n,...i},c)=>e.jsxs(CN,{ref:c,className:I("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),...i,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(TN,{children:e.jsx(Lo,{className:"h-2 w-2 fill-current"})})}),n]}));KC.displayName=CN.displayName;const QC=d.forwardRef(({className:l,inset:n,...i},c)=>e.jsx(_N,{ref:c,className:I("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",l),...i}));QC.displayName=_N.displayName;const YC=d.forwardRef(({className:l,...n},i)=>e.jsx(EN,{ref:i,className:I("-mx-1 my-1 h-px bg-muted",l),...n}));YC.displayName=EN.displayName;const DN=({className:l,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:I("mx-auto flex w-full justify-center",l),...n});DN.displayName="Pagination";const RN=d.forwardRef(({className:l,...n},i)=>e.jsx("ul",{ref:i,className:I("flex flex-row items-center gap-1",l),...n}));RN.displayName="PaginationContent";const Do=d.forwardRef(({className:l,...n},i)=>e.jsx("li",{ref:i,className:I("",l),...n}));Do.displayName="PaginationItem";const cd=({className:l,isActive:n,size:i="icon",...c})=>e.jsx("a",{"aria-current":n?"page":void 0,className:I(qr({variant:n?"outline":"ghost",size:i}),l),...c});cd.displayName="PaginationLink";const LN=({className:l,...n})=>e.jsxs(cd,{"aria-label":"Go to previous page",size:"default",className:I("gap-1 pl-2.5",l),...n,children:[e.jsx(Aa,{className:"h-4 w-4"}),e.jsx("span",{children:""})]});LN.displayName="PaginationPrevious";const UN=({className:l,...n})=>e.jsxs(cd,{"aria-label":"Go to next page",size:"default",className:I("gap-1 pr-2.5",l),...n,children:[e.jsx("span",{children:""}),e.jsx(Zt,{className:"h-4 w-4"})]});UN.displayName="PaginationNext";const Rm=[{value:"created_at",label:"",icon:na},{value:"downloads",label:"",icon:sa},{value:"likes",label:"",icon:Vr}];function JC(){const l=ca(),[n,i]=d.useState([]),[c,u]=d.useState(!0),[x,h]=d.useState(""),[f,p]=d.useState("downloads"),[g,N]=d.useState(1),[v,y]=d.useState(1),[w,b]=d.useState(0),[R,D]=d.useState(new Set),[S,P]=d.useState(new Set),M=Sv(),T=d.useCallback(async()=>{u(!0);try{const U=await dS({status:"approved",page:g,page_size:12,search:x||void 0,sort_by:f,sort_order:"desc"});i(U.packs),y(U.total_pages),b(U.total);const ue=new Set;for(const xe of U.packs)await _v(xe.id,M)&&ue.add(xe.id);D(ue)}catch(U){console.error(" Pack :",U),Qt({title:" Pack ",variant:"destructive"})}finally{u(!1)}},[g,x,f,M]);d.useEffect(()=>{T()},[T]);const A=U=>{U.preventDefault(),N(1),T()},F=async U=>{if(!S.has(U)){P(ue=>new Set(ue).add(U));try{const ue=await wv(U,M);D(xe=>{const he=new Set(xe);return ue.liked?he.add(U):he.delete(U),he}),i(xe=>xe.map(he=>he.id===U?{...he,likes:ue.likes}:he))}catch(ue){console.error(":",ue),Qt({title:"",variant:"destructive"})}finally{P(ue=>{const xe=new Set(ue);return xe.delete(U),xe})}}},L=U=>{l({to:"/config/pack-market/$packId",params:{packId:U}})},J=Rm.find(U=>U.value===f)||Rm[0];return e.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-2",children:[e.jsx(ra,{className:"h-8 w-8",strokeWidth:2}),""]}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:" MaiBot"})]}),e.jsxs(_,{variant:"outline",onClick:T,disabled:c,className:"gap-2",children:[e.jsx(dt,{className:`h-4 w-4 ${c?"animate-spin":""}`}),""]})]})}),e.jsx(Ye,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("form",{onSubmit:A,className:"flex-1 min-w-[200px] max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(le,{placeholder:"...",value:x,onChange:U=>h(U.target.value),className:"pl-10"})]})}),e.jsxs(HC,{children:[e.jsx(FC,{asChild:!0,children:e.jsxs(_,{variant:"outline",className:"min-w-[140px] gap-2",children:[e.jsx(j_,{className:"w-4 h-4"}),J.label,e.jsx(za,{className:"w-4 h-4 ml-auto"})]})}),e.jsx(AN,{align:"end",children:Rm.map(U=>e.jsxs(ON,{onClick:()=>{p(U.value),N(1)},children:[e.jsx(U.icon,{className:"w-4 h-4 mr-2"}),U.label]},U.value))})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",e.jsx("span",{className:"font-medium text-foreground",children:w})," "]}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((U,ue)=>e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(js,{className:"h-6 w-3/4"}),e.jsx(js,{className:"h-4 w-full mt-2"})]}),e.jsx(Ae,{children:e.jsx(js,{className:"h-20 w-full"})}),e.jsx(Zo,{children:e.jsx(js,{className:"h-9 w-full"})})]},ue))}):n.length===0?e.jsx(Ce,{className:"py-12",children:e.jsxs(Ae,{className:"text-center text-muted-foreground",children:[e.jsx(ra,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:""}),e.jsx("p",{className:"mt-1",children:""})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(U=>e.jsx(XC,{pack:U,liked:R.has(U.id),liking:S.has(U.id),onLike:()=>F(U.id),onView:()=>L(U.id)},U.id))}),v>1&&e.jsx(DN,{children:e.jsxs(RN,{children:[e.jsx(Do,{children:e.jsx(LN,{onClick:()=>N(U=>Math.max(1,U-1)),className:g===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:v},(U,ue)=>ue+1).filter(U=>U===1||U===v||Math.abs(U-g)<=1).map((U,ue,xe)=>{const he=ue>0&&U-xe[ue-1]>1;return e.jsxs(Do,{children:[he&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(cd,{onClick:()=>N(U),isActive:U===g,className:"cursor-pointer",children:U})]},U)}),e.jsx(Do,{children:e.jsx(UN,{onClick:()=>N(U=>Math.min(v,U+1)),className:g===v?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})]})}function XC({pack:l,liked:n,liking:i,onLike:c,onView:u}){const x=h=>new Date(h).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(Ce,{className:"flex flex-col hover:shadow-md transition-shadow",children:[e.jsxs(De,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(Le,{className:"text-lg line-clamp-1",children:l.name}),e.jsxs(Se,{variant:"secondary",className:"text-xs",children:["v",l.version]})]}),e.jsx(ws,{className:"line-clamp-2 min-h-[40px]",children:l.description})]}),e.jsxs(Ae,{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"w-3.5 h-3.5"}),l.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-3.5 h-3.5"}),x(l.created_at)]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Dl,{className:"w-3.5 h-3.5"}),l.provider_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Gn,{className:"w-3.5 h-3.5"}),l.model_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",title:"",children:[e.jsx(Vn,{className:"w-3.5 h-3.5"}),l.task_count]})]}),l.tags&&l.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.tags.slice(0,3).map(h=>e.jsxs(Se,{variant:"outline",className:"text-xs",children:[e.jsx(Xo,{className:"w-2.5 h-2.5 mr-1"}),h]},h)),l.tags.length>3&&e.jsxs(Se,{variant:"outline",className:"text-xs",children:["+",l.tags.length-3]})]})]}),e.jsx(Zo,{className:"pt-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(sa,{className:"w-4 h-4"}),l.downloads]}),e.jsxs("button",{onClick:h=>{h.stopPropagation(),c()},disabled:i,className:`flex items-center gap-1 transition-colors ${n?"text-red-500":"hover:text-red-500"} ${i?"opacity-50":""}`,children:[e.jsx(Vr,{className:`w-4 h-4 ${n?"fill-current":""}`}),l.likes]})]}),e.jsx(_,{size:"sm",onClick:u,children:""})]})})]})}var sl="Accordion",ZC=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[xx,WC,e3]=$w(sl),[od]=Ko(sl,[e3,cj]),hx=cj(),$N=As.forwardRef((l,n)=>{const{type:i,...c}=l,u=c,x=c;return e.jsx(xx.Provider,{scope:l.__scopeAccordion,children:i==="multiple"?e.jsx(l3,{...x,ref:n}):e.jsx(a3,{...u,ref:n})})});$N.displayName=sl;var[BN,s3]=od(sl),[IN,t3]=od(sl,{collapsible:!1}),a3=As.forwardRef((l,n)=>{const{value:i,defaultValue:c,onValueChange:u=()=>{},collapsible:x=!1,...h}=l,[f,p]=qo({prop:i,defaultProp:c??"",onChange:u,caller:sl});return e.jsx(BN,{scope:l.__scopeAccordion,value:As.useMemo(()=>f?[f]:[],[f]),onItemOpen:p,onItemClose:As.useCallback(()=>x&&p(""),[x,p]),children:e.jsx(IN,{scope:l.__scopeAccordion,collapsible:x,children:e.jsx(PN,{...h,ref:n})})})}),l3=As.forwardRef((l,n)=>{const{value:i,defaultValue:c,onValueChange:u=()=>{},...x}=l,[h,f]=qo({prop:i,defaultProp:c??[],onChange:u,caller:sl}),p=As.useCallback(N=>f((v=[])=>[...v,N]),[f]),g=As.useCallback(N=>f((v=[])=>v.filter(y=>y!==N)),[f]);return e.jsx(BN,{scope:l.__scopeAccordion,value:h,onItemOpen:p,onItemClose:g,children:e.jsx(IN,{scope:l.__scopeAccordion,collapsible:!0,children:e.jsx(PN,{...x,ref:n})})})}),[n3,dd]=od(sl),PN=As.forwardRef((l,n)=>{const{__scopeAccordion:i,disabled:c,dir:u,orientation:x="vertical",...h}=l,f=As.useRef(null),p=Qo(f,n),g=WC(i),v=_j(u)==="ltr",y=hn(l.onKeyDown,w=>{if(!ZC.includes(w.key))return;const b=w.target,R=g().filter(J=>!J.ref.current?.disabled),D=R.findIndex(J=>J.ref.current===b),S=R.length;if(D===-1)return;w.preventDefault();let P=D;const M=0,T=S-1,A=()=>{P=D+1,P>T&&(P=M)},F=()=>{P=D-1,P<M&&(P=T)};switch(w.key){case"Home":P=M;break;case"End":P=T;break;case"ArrowRight":x==="horizontal"&&(v?A():F());break;case"ArrowDown":x==="vertical"&&A();break;case"ArrowLeft":x==="horizontal"&&(v?F():A());break;case"ArrowUp":x==="vertical"&&F();break}const L=P%S;R[L].ref.current?.focus()});return e.jsx(n3,{scope:i,disabled:c,direction:u,orientation:x,children:e.jsx(xx.Slot,{scope:i,children:e.jsx(Qn.div,{...h,"data-orientation":x,ref:p,onKeyDown:c?void 0:y})})})}),Vo="AccordionItem",[r3,fx]=od(Vo),HN=As.forwardRef((l,n)=>{const{__scopeAccordion:i,value:c,...u}=l,x=dd(Vo,i),h=s3(Vo,i),f=hx(i),p=Lm(),g=c&&h.value.includes(c)||!1,N=x.disabled||l.disabled;return e.jsx(r3,{scope:i,open:g,disabled:N,triggerId:p,children:e.jsx(tj,{"data-orientation":x.orientation,"data-state":QN(g),...f,...u,ref:n,disabled:N,open:g,onOpenChange:v=>{v?h.onItemOpen(c):h.onItemClose(c)}})})});HN.displayName=Vo;var FN="AccordionHeader",GN=As.forwardRef((l,n)=>{const{__scopeAccordion:i,...c}=l,u=dd(sl,i),x=fx(FN,i);return e.jsx(Qn.h3,{"data-orientation":u.orientation,"data-state":QN(x.open),"data-disabled":x.disabled?"":void 0,...c,ref:n})});GN.displayName=FN;var Fm="AccordionTrigger",VN=As.forwardRef((l,n)=>{const{__scopeAccordion:i,...c}=l,u=dd(sl,i),x=fx(Fm,i),h=t3(Fm,i),f=hx(i);return e.jsx(xx.ItemSlot,{scope:i,children:e.jsx(xw,{"aria-disabled":x.open&&!h.collapsible||void 0,"data-orientation":u.orientation,id:x.triggerId,...f,...c,ref:n})})});VN.displayName=Fm;var qN="AccordionContent",KN=As.forwardRef((l,n)=>{const{__scopeAccordion:i,...c}=l,u=dd(sl,i),x=fx(qN,i),h=hx(i);return e.jsx(hw,{role:"region","aria-labelledby":x.triggerId,"data-orientation":u.orientation,...h,...c,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...l.style}})});KN.displayName=qN;function QN(l){return l?"open":"closed"}var i3=$N,c3=HN,o3=GN,YN=VN,JN=KN;const d3=i3,XN=d.forwardRef(({className:l,...n},i)=>e.jsx(c3,{ref:i,className:I("border-b",l),...n}));XN.displayName="AccordionItem";const ZN=d.forwardRef(({className:l,children:n,...i},c)=>e.jsx(o3,{className:"flex",children:e.jsxs(YN,{ref:c,className:I("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",l),...i,children:[n,e.jsx(za,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));ZN.displayName=YN.displayName;const WN=d.forwardRef(({className:l,children:n,...i},c)=>e.jsx(JN,{ref:c,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:e.jsx("div",{className:I("pb-4 pt-0",l),children:n})}));WN.displayName=JN.displayName;const u3={utils:"",utils_small:"",tool_use:"",replyer:"",planner:"",vlm:"",voice:"",embedding:"",lpmm_entity_extract:"",lpmm_rdf_build:"RDF",lpmm_qa:""};function m3(){const{packId:l}=lb.useParams(),n=ca(),[i,c]=d.useState(null),[u,x]=d.useState(!0),[h,f]=d.useState(!1),[p,g]=d.useState(!1),[N,v]=d.useState(!1),[y,w]=d.useState(1),[b,R]=d.useState(null),[D,S]=d.useState(!1),[P,M]=d.useState(!1),[T,A]=d.useState({apply_providers:!0,apply_models:!0,apply_task_config:!0,task_mode:"append",selected_providers:void 0,selected_models:void 0,selected_tasks:void 0}),[F,L]=d.useState({}),[J,U]=d.useState({}),ue=Sv(),xe=d.useCallback(async()=>{if(l){x(!0);try{const z=await uS(l);c(z);const V=await _v(l,ue);f(V)}catch(z){console.error(" Pack :",z),Qt({title:"",variant:"destructive"})}finally{x(!1)}}},[l,ue]);d.useEffect(()=>{xe()},[xe]);const he=async()=>{if(!(!l||p)){g(!0);try{const z=await wv(l,ue);f(z.liked),i&&c({...i,likes:z.likes})}catch(z){console.error(":",z),Qt({title:"",variant:"destructive"})}finally{g(!1)}}},ne=async()=>{if(i){v(!0),w(1),S(!0);try{const z=await hS(i);R(z);const V={};for(const oe of z.existing_providers)V[oe.pack_provider.name]=oe.local_providers[0].name;L(V);const B={};for(const oe of z.new_providers)B[oe.name]="";U(B)}catch(z){console.error(":",z),Qt({title:"",variant:"destructive"}),v(!1)}finally{S(!1)}}},ve=async()=>{if(i){if(T.apply_providers&&b){for(const z of b.new_providers)if(!J[z.name]){Qt({title:` "${z.name}"  API Key`,variant:"destructive"});return}}M(!0);try{await fS(i,T,F,J),await xS(i.id,ue),c({...i,downloads:i.downloads+1}),Qt({title:""}),v(!1)}catch(z){console.error(" Pack :",z),Qt({title:z instanceof Error?z.message:"",variant:"destructive"})}finally{M(!1)}}},je=z=>new Date(z).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"});return u?e.jsx(h3,{}):i?e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Ye,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>n({to:"/config/pack-market"}),className:"gap-2",children:[e.jsx(Ta,{className:"w-4 h-4"}),""]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ra,{className:"w-10 h-10 text-primary mt-1"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[i.name,e.jsxs(Se,{variant:"secondary",children:["v",i.version]})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:i.description})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"w-4 h-4"}),i.author]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(na,{className:"w-4 h-4"}),je(i.created_at)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(sa,{className:"w-4 h-4"}),i.downloads," "]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Vr,{className:`w-4 h-4 ${h?"fill-red-500 text-red-500":""}`}),i.likes," "]})]}),i.tags&&i.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:i.tags.map(z=>e.jsxs(Se,{variant:"outline",children:[e.jsx(Xo,{className:"w-3 h-3 mr-1"}),z]},z))})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsxs(_,{size:"lg",onClick:ne,children:[e.jsx(sa,{className:"w-4 h-4 mr-2"}),""]}),e.jsxs(_,{variant:"outline",onClick:he,disabled:p,className:h?"text-red-500 border-red-200":"",children:[e.jsx(Vr,{className:`w-4 h-4 mr-2 ${h?"fill-current":""}`}),h?"":""]})]})]}),e.jsx(Yt,{}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(Ce,{children:e.jsxs(Ae,{className:"flex items-center gap-3 py-4",children:[e.jsx(Dl,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i.providers.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"API "})]})]})}),e.jsx(Ce,{children:e.jsxs(Ae,{className:"flex items-center gap-3 py-4",children:[e.jsx(Gn,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i.models.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})}),e.jsx(Ce,{children:e.jsxs(Ae,{className:"flex items-center gap-3 py-4",children:[e.jsx(Vn,{className:"w-8 h-8 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(i.task_config).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:""})]})]})})]}),e.jsxs(ta,{defaultValue:"providers",className:"space-y-4",children:[e.jsxs(Xt,{children:[e.jsxs(Je,{value:"providers",children:[e.jsx(Dl,{className:"w-4 h-4 mr-2"})," (",i.providers.length,")"]}),e.jsxs(Je,{value:"models",children:[e.jsx(Gn,{className:"w-4 h-4 mr-2"})," (",i.models.length,")"]}),e.jsxs(Je,{value:"tasks",children:[e.jsx(Vn,{className:"w-4 h-4 mr-2"})," (",Object.keys(i.task_config).length,")"]})]}),e.jsx(ys,{value:"providers",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:"API "}),e.jsx(ws,{children:" API  API Key"})]}),e.jsx(Ae,{children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{children:""}),e.jsx(Ze,{children:"Base URL"}),e.jsx(Ze,{children:""})]})}),e.jsx(Ul,{children:i.providers.map(z=>e.jsxs(ut,{children:[e.jsx(qe,{className:"font-medium",children:z.name}),e.jsx(qe,{className:"text-muted-foreground font-mono text-sm",children:z.base_url}),e.jsx(qe,{children:e.jsx(Se,{variant:"outline",children:z.client_type})})]},z.name))})]})})]})}),e.jsx(ys,{value:"models",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:e.jsxs(Rl,{children:[e.jsx(Ll,{children:e.jsxs(ut,{children:[e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{children:""}),e.jsx(Ze,{className:"text-right",children:" (/)"})]})}),e.jsx(Ul,{children:i.models.map(z=>e.jsxs(ut,{children:[e.jsx(qe,{className:"font-medium",children:z.name}),e.jsx(qe,{className:"text-muted-foreground font-mono text-sm",children:z.model_identifier}),e.jsx(qe,{children:z.api_provider}),e.jsxs(qe,{className:"text-right text-muted-foreground",children:["",z.price_in," / ",z.price_out]})]},z.name))})]})})]})}),e.jsx(ys,{value:"tasks",children:e.jsxs(Ce,{children:[e.jsxs(De,{children:[e.jsx(Le,{children:""}),e.jsx(ws,{children:""})]}),e.jsx(Ae,{children:e.jsx(d3,{type:"multiple",className:"w-full",children:Object.entries(i.task_config).map(([z,V])=>e.jsxs(XN,{value:z,children:[e.jsx(ZN,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"w-4 h-4"}),u3[z]||z,e.jsxs(Se,{variant:"secondary",className:"ml-2",children:[V.model_list.length," "]})]})}),e.jsx(WN,{children:e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:V.model_list.map(B=>e.jsx(Se,{variant:"outline",children:B},B))}),V.temperature!==void 0&&e.jsxs("div",{className:"text-sm",children:["Temperature: ",e.jsx("span",{className:"font-mono",children:V.temperature})]}),V.max_tokens!==void 0&&e.jsxs("div",{className:"text-sm",children:["Max Tokens: ",e.jsx("span",{className:"font-mono",children:V.max_tokens})]})]})})]},z))})})]})})]}),e.jsx(x3,{open:N,onOpenChange:v,pack:i,step:y,setStep:w,conflicts:b,detectingConflicts:D,applying:P,options:T,setOptions:A,_providerMapping:F,_setProviderMapping:L,newProviderApiKeys:J,setNewProviderApiKeys:U,onApply:ve})]})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ra,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-xl font-semibold",children:""}),e.jsx("p",{className:"text-muted-foreground mt-2",children:""}),e.jsxs(_,{className:"mt-4",onClick:()=>n({to:"/config/pack-market"}),children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),""]})]})}function x3({open:l,onOpenChange:n,pack:i,step:c,setStep:u,conflicts:x,detectingConflicts:h,applying:f,options:p,setOptions:g,_providerMapping:N,_setProviderMapping:v,newProviderApiKeys:y,setNewProviderApiKeys:w,onApply:b}){return e.jsx(Is,{open:l,onOpenChange:n,children:e.jsxs(Os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ds,{children:[e.jsxs(Rs,{className:"flex items-center gap-2",children:[e.jsx(ra,{className:"w-5 h-5"}),""]}),e.jsxs(Ks,{children:[" ",c," / ",3,"",c===1&&"",c===2&&"",c===3&&""]})]}),h?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(Bs,{className:"w-8 h-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"..."})]}):e.jsxs(e.Fragment,{children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"apply_providers",checked:p.apply_providers,onCheckedChange:D=>g({...p,apply_providers:D})}),e.jsxs(E,{htmlFor:"apply_providers",className:"flex items-center gap-2",children:[e.jsx(Dl,{className:"w-4 h-4"})," (",i.providers.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"apply_models",checked:p.apply_models,onCheckedChange:D=>g({...p,apply_models:D})}),e.jsxs(E,{htmlFor:"apply_models",className:"flex items-center gap-2",children:[e.jsx(Gn,{className:"w-4 h-4"})," (",i.models.length," )"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{id:"apply_task_config",checked:p.apply_task_config,onCheckedChange:D=>g({...p,apply_task_config:D})}),e.jsxs(E,{htmlFor:"apply_task_config",className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"})," (",Object.keys(i.task_config).length," )"]})]})]}),p.apply_task_config&&e.jsxs("div",{className:"pl-6 space-y-2 border-l-2 border-muted",children:[e.jsx(E,{className:"text-sm font-medium",children:""}),e.jsxs(mx,{value:p.task_mode,onValueChange:D=>g({...p,task_mode:D}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Go,{value:"append",id:"mode_append"}),e.jsx(E,{htmlFor:"mode_append",className:"font-normal",children:" - "})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Go,{value:"replace",id:"mode_replace"}),e.jsx(E,{htmlFor:"mode_replace",className:"font-normal",children:" - "})]})]})]})]}),c===2&&x&&e.jsxs("div",{className:"space-y-4",children:[p.apply_providers&&x.existing_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Hn,{children:""}),e.jsx(lt,{children:" URL "})]}),e.jsx("div",{className:"space-y-2",children:x.existing_providers.map(({pack_provider:D,local_providers:S})=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"font-medium flex-shrink-0",children:D.name}),e.jsx(Zt,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),S.length===1?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:S[0].name}),e.jsx(Se,{variant:"outline",className:"ml-auto",children:"URL "})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{value:N[D.name]||S[0].name,onValueChange:P=>v({...N,[D.name]:P}),children:[e.jsx($e,{className:"w-[200px]",children:e.jsx(Pe,{})}),e.jsx(Be,{children:S.map(P=>e.jsx(X,{value:P.name,children:P.name},P.name))})]}),e.jsxs(Se,{variant:"outline",className:"ml-auto",children:[S.length," "]})]})]},D.name))})]}),p.apply_providers&&x.new_providers.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(at,{variant:"destructive",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsx(Hn,{children:" API Key"}),e.jsx(lt,{children:" API Key"})]}),e.jsx("div",{className:"space-y-4",children:x.new_providers.map(D=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Km,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"font-medium",children:D.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",D.base_url,")"]})]}),e.jsx(le,{type:"password",placeholder:` ${D.name}  API Key`,value:y[D.name]||"",onChange:S=>w({...y,[D.name]:S.target.value})})]},D.name))})]}),(!p.apply_providers||x.existing_providers.length===0&&x.new_providers.length===0)&&e.jsxs(at,{children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx(Hn,{children:""}),e.jsx(lt,{children:""})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx(Hn,{children:""}),e.jsx(lt,{children:""})]}),e.jsxs("div",{className:"space-y-2",children:[p.apply_providers&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500"}),e.jsx(Dl,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",i.providers.length," "]})]}),p.apply_models&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500"}),e.jsx(Gn,{className:"w-4 h-4"}),e.jsxs("span",{children:[" ",i.models.length," "]})]}),p.apply_task_config&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ct,{className:"w-4 h-4 text-green-500"}),e.jsx(Vn,{className:"w-4 h-4"}),e.jsxs("span",{children:[p.task_mode==="append"?"":""," ",Object.keys(i.task_config).length," "]})]})]}),x&&x.new_providers.length>0&&e.jsxs(at,{variant:"destructive",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsxs(lt,{children:[" ",x.new_providers.length,"  API Key"]})]})]})]}),e.jsxs(st,{className:"flex justify-between",children:[e.jsx("div",{children:c>1&&!h&&e.jsx(_,{variant:"outline",onClick:()=>u(c-1),disabled:f,children:""})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>n(!1),disabled:f,children:""}),c<3?e.jsx(_,{onClick:()=>u(c+1),disabled:h,children:""}):e.jsxs(_,{onClick:b,disabled:f,children:[f&&e.jsx(Bs,{className:"w-4 h-4 mr-2 animate-spin"}),""]})]})]})]})})}function h3(){return e.jsx("div",{className:"h-[calc(100vh-4rem)] flex flex-col p-4 sm:p-6",children:e.jsx(Ye,{className:"flex-1",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(js,{className:"h-9 w-24"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(js,{className:"w-10 h-10"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(js,{className:"h-8 w-2/3"}),e.jsx(js,{className:"h-4 w-full"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(js,{className:"h-4 w-24"}),e.jsx(js,{className:"h-4 w-32"}),e.jsx(js,{className:"h-4 w-28"}),e.jsx(js,{className:"h-4 w-20"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(js,{className:"h-6 w-20"}),e.jsx(js,{className:"h-6 w-24"}),e.jsx(js,{className:"h-6 w-16"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[160px]",children:[e.jsx(js,{className:"h-10 w-full"}),e.jsx(js,{className:"h-10 w-full"})]})]}),e.jsx(js,{className:"h-px w-full"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(js,{className:"h-24"}),e.jsx(js,{className:"h-24"}),e.jsx(js,{className:"h-24"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(js,{className:"h-10 w-32"}),e.jsx(js,{className:"h-10 w-32"}),e.jsx(js,{className:"h-10 w-32"})]}),e.jsx(js,{className:"h-96 w-full"})]})]})})})}function f3(){const l=ca(),[n,i]=d.useState(!0);return d.useEffect(()=>{let c=!1;return(async()=>{try{const x=await tc();!c&&!x&&l({to:"/auth"})}catch{c||l({to:"/auth"})}finally{c||i(!1)}})(),()=>{c=!0}},[l]),{checking:n}}async function p3(){return await tc()}const g3=Kr("pointer-events-none inline-flex select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono font-medium opacity-100",{variants:{size:{sm:"h-5 text-[10px]",default:"h-6 text-xs",lg:"h-7 text-sm"}},defaultVariants:{size:"default"}}),eb=d.forwardRef(({className:l,size:n,abbrTitle:i,children:c,...u},x)=>e.jsx("kbd",{className:I(g3({size:n,className:l})),ref:x,...u,children:i?e.jsx("abbr",{title:i,children:c}):c}));eb.displayName="Kbd";const j3=[{icon:Jo,title:"",description:"",path:"/",category:""},{icon:Ca,title:"",description:"",path:"/config/bot",category:""},{icon:Dl,title:"",description:"",path:"/config/modelProvider",category:""},{icon:Fj,title:"",description:"",path:"/config/model",category:""},{icon:Yo,title:"",description:"",path:"/resource/emoji",category:""},{icon:Ma,title:"",description:"",path:"/resource/expression",category:""},{icon:Gj,title:"",description:"",path:"/resource/person",category:""},{icon:Gr,title:"",description:"",path:"/resource/jargon",category:""},{icon:v_,title:"",description:"",path:"/statistics",category:""},{icon:ra,title:"",description:"",path:"/plugins",category:""},{icon:Qm,title:"",description:"",path:"/logs",category:""},{icon:pn,title:"",description:"",path:"/settings",category:""}];function v3({open:l,onOpenChange:n}){const[i,c]=d.useState(""),[u,x]=d.useState(0),h=ca(),f=j3.filter(N=>N.title.toLowerCase().includes(i.toLowerCase())||N.description.toLowerCase().includes(i.toLowerCase())||N.category.toLowerCase().includes(i.toLowerCase())),p=d.useCallback(N=>{h({to:N}),n(!1),c(""),x(0)},[h,n]),g=d.useCallback(N=>{N.key==="ArrowDown"?(N.preventDefault(),x(v=>(v+1)%f.length)):N.key==="ArrowUp"?(N.preventDefault(),x(v=>(v-1+f.length)%f.length)):N.key==="Enter"&&f[u]&&(N.preventDefault(),p(f[u].path))},[f,u,p]);return e.jsx(Is,{open:l,onOpenChange:n,children:e.jsxs(Os,{className:"max-w-2xl p-0 gap-0",children:[e.jsxs(Ds,{className:"px-4 pt-4 pb-0",children:[e.jsx(Rs,{className:"sr-only",children:""}),e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),e.jsx(le,{value:i,onChange:N=>{c(N.target.value),x(0)},onKeyDown:g,placeholder:"...",className:"h-12 pl-11 text-base border-0 focus-visible:ring-0 shadow-none",autoFocus:!0})]})]}),e.jsx("div",{className:"border-t",children:e.jsx(Ye,{className:"h-[400px]",children:f.length>0?e.jsx("div",{className:"p-2",children:f.map((N,v)=>{const y=N.icon;return e.jsxs("button",{onClick:()=>p(N.path),onMouseEnter:()=>x(v),className:I("w-full flex items-center gap-3 px-3 py-2.5 rounded-md text-left transition-colors",v===u?"bg-accent text-accent-foreground":"hover:bg-accent/50"),children:[e.jsx(y,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:N.title}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:N.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1 bg-muted rounded",children:N.category})]},N.path)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Tt,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i?"":""})]})})}),e.jsx("div",{className:"border-t px-4 py-3 flex items-center justify-between text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:""}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Enter"}),""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-muted rounded border",children:"Esc"}),""]})]})})]})})}function N3(){const l=window.location.protocol==="http:",n=window.location.hostname.toLowerCase(),i=n==="localhost"||n==="127.0.0.1"||n==="::1",c=sessionStorage.getItem("http-warning-dismissed")==="true",[u,x]=d.useState(l&&!i&&!c),[h,f]=d.useState(!1),p=()=>{f(!0),x(!1),sessionStorage.setItem("http-warning-dismissed","true")};return!u||h?null:e.jsx("div",{className:"relative bg-amber-500/10 border-b border-amber-500/20 backdrop-blur-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Jt,{className:"h-5 w-5 text-amber-600 dark:text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:[e.jsx("span",{className:"font-semibold",children:""})," ",e.jsx("strong",{children:"HTTP"}),"  MaiBot WebUI"]}),e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200 mt-1",children:" Token HTTPS "})]})]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:p,className:"h-8 w-8 text-amber-700 hover:text-amber-900 dark:text-amber-400 dark:hover:text-amber-200 flex-shrink-0","aria-label":"",children:e.jsx(Ea,{className:"h-4 w-4"})})]})})})}function b3(){const[l,n]=d.useState(0),[i,c]=d.useState(!1),u=d.useRef(null);d.useEffect(()=>{const g=N=>{const v=N.target;if(v.scrollHeight>v.clientHeight+100){u.current=v;const y=v.scrollTop,w=v.scrollHeight-v.clientHeight,b=w>0?y/w*100:0;n(b),c(y>300)}};return window.addEventListener("scroll",g,{capture:!0,passive:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})},[]);const x=()=>{u.current?.scrollTo({top:0,behavior:"smooth"})},h=18,f=2*Math.PI*h,p=f-l/100*f;return e.jsx("div",{className:I("fixed bottom-24 right-8 z-50 transition-all duration-500 ease-in-out transform",i?"translate-x-0 opacity-100":"translate-x-32 opacity-0 pointer-events-none"),children:e.jsxs(_,{variant:"outline",size:"icon",className:I("relative h-12 w-12 rounded-full shadow-xl","bg-background/80 backdrop-blur-md border-border/50","hover:bg-accent hover:scale-110 hover:shadow-2xl hover:border-primary/50","transition-all duration-300","group"),onClick:x,"aria-label":"",children:[e.jsxs("svg",{className:"absolute inset-0 h-full w-full -rotate-90 transform p-1",viewBox:"0 0 44 44",children:[e.jsx("circle",{className:"text-muted-foreground/10",strokeWidth:"3",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"}),e.jsx("circle",{className:"text-primary transition-all duration-100 ease-out",strokeWidth:"3",strokeDasharray:f,strokeDashoffset:p,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:h,cx:"22",cy:"22"})]}),e.jsx(N_,{className:"h-5 w-5 text-primary transition-transform duration-300 group-hover:-translate-y-1 group-hover:scale-110",strokeWidth:2.5}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})})}const y3=Iw,w3=Pw,_3=Hw,sb=d.forwardRef(({className:l,sideOffset:n=4,...i},c)=>e.jsx(Bw,{children:e.jsx(Sj,{ref:c,sideOffset:n,className:I("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",l),...i})}));sb.displayName=Sj.displayName;function S3({children:l}){const{checking:n}=f3(),[i,c]=d.useState(!0),[u,x]=d.useState(!1),[h,f]=d.useState(!1),{theme:p,setTheme:g}=ex(),N=y0();if(d.useEffect(()=>{const R=D=>{(D.metaKey||D.ctrlKey)&&D.key==="k"&&(D.preventDefault(),f(!0))};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[]),n)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-background",children:e.jsx("div",{className:"text-muted-foreground",children:"..."})});const v=[{title:"",items:[{icon:Jo,label:"",path:"/"}]},{title:"",items:[{icon:Ca,label:"",path:"/config/bot"},{icon:Dl,label:"AI",path:"/config/modelProvider",tourId:"sidebar-model-provider"},{icon:Fj,label:"",path:"/config/model",tourId:"sidebar-model-management"},{icon:og,label:"",path:"/config/adapter"}]},{title:"",items:[{icon:Yo,label:"",path:"/resource/emoji"},{icon:Ma,label:"",path:"/resource/expression"},{icon:Gr,label:"",path:"/resource/jargon"},{icon:Gj,label:"",path:"/resource/person"},{icon:Bj,label:"",path:"/resource/knowledge-graph"},{icon:Hr,label:"",path:"/resource/knowledge-base"}]},{title:"",items:[{icon:ra,label:"",path:"/plugins"},{icon:Pj,label:"",path:"/config/pack-market"},{icon:og,label:"",path:"/plugin-config"},{icon:Qm,label:"",path:"/logs"},{icon:Gm,label:"&",path:"/planner-monitor"},{icon:Ma,label:"",path:"/chat"}]},{title:"",items:[{icon:pn,label:"",path:"/settings"}]}],w=p==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":p,b=async()=>{await t1()};return e.jsx(y3,{delayDuration:300,children:e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsxs("aside",{className:I("fixed inset-y-0 left-0 z-50 flex flex-col border-r bg-card transition-all duration-300 lg:relative lg:z-0","w-64 lg:w-auto",i?"lg:w-64":"lg:w-16",u?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsx("div",{className:"flex h-16 items-center border-b px-4",children:e.jsxs("div",{className:I("relative flex items-center justify-center flex-1 transition-all overflow-hidden","lg:flex-1",!i&&"lg:flex-none lg:w-8"),children:[e.jsxs("div",{className:I("flex items-baseline gap-2",!i&&"lg:hidden"),children:[e.jsx("span",{className:"font-bold text-xl text-primary-gradient whitespace-nowrap",children:"MaiBot WebUI"}),e.jsx("span",{className:"text-xs text-primary/60 whitespace-nowrap",children:R1()})]}),!i&&e.jsx("span",{className:"hidden lg:block font-bold text-primary-gradient text-2xl",children:"M"})]})}),e.jsx(Ye,{className:I("flex-1 overflow-x-hidden",!i&&"lg:w-16"),children:e.jsx("nav",{className:I("p-4",!i&&"lg:p-2 lg:w-16"),children:e.jsx("ul",{className:I("space-y-6",!i&&"lg:space-y-3 lg:w-full"),children:v.map((R,D)=>e.jsxs("li",{children:[e.jsx("div",{className:I("px-3 h-[1.25rem]","mb-2",!i&&"lg:mb-1 lg:invisible"),children:e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground/60 whitespace-nowrap",children:R.title})}),!i&&D>0&&e.jsx("div",{className:"hidden lg:block mb-2 border-t border-border"}),e.jsx("ul",{className:"space-y-1",children:R.items.map(S=>{const P=N({to:S.path}),M=S.icon,T=e.jsxs(e.Fragment,{children:[P&&e.jsx("div",{className:"absolute left-0 top-1/2 h-8 w-1 -translate-y-1/2 rounded-r-full bg-primary transition-opacity duration-300"}),e.jsxs("div",{className:I("flex items-center transition-all duration-300",i?"gap-3":"gap-3 lg:gap-0"),children:[e.jsx(M,{className:I("h-5 w-5 flex-shrink-0",P&&"text-primary"),strokeWidth:2,fill:"none"}),e.jsx("span",{className:I("text-sm font-medium whitespace-nowrap transition-all duration-300",P&&"font-semibold",i?"opacity-100 max-w-[200px]":"opacity-100 max-w-[200px] lg:opacity-0 lg:max-w-0 lg:overflow-hidden"),children:S.label})]})]});return e.jsx("li",{className:"relative",children:e.jsxs(w3,{children:[e.jsx(_3,{asChild:!0,children:e.jsx(Bn,{to:S.path,"data-tour":S.tourId,className:I("relative flex items-center rounded-lg py-2 transition-all duration-300","hover:bg-accent hover:text-accent-foreground",P?"bg-accent text-foreground":"text-muted-foreground hover:text-foreground",i?"px-3":"px-3 lg:px-0 lg:justify-center lg:w-12 lg:mx-auto"),onClick:()=>x(!1),children:T})}),!i&&e.jsx(sb,{side:"right",className:"hidden lg:block",children:e.jsx("p",{children:S.label})})]})},S.path)})})]},R.title))})})})]}),u&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>x(!1)}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(N3,{}),e.jsxs("header",{className:"flex h-16 items-center justify-between border-b bg-card/80 backdrop-blur-md px-4 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>x(!u),className:"rounded-lg p-2 hover:bg-accent lg:hidden",children:e.jsx(b_,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>c(!i),className:"hidden rounded-lg p-2 hover:bg-accent lg:block",title:i?"":"",children:e.jsx(Aa,{className:I("h-5 w-5 transition-transform",!i&&"rotate-180")})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bn,{to:"/annual-report",children:e.jsxs(_,{variant:"ghost",size:"sm",className:"gap-2 bg-gradient-to-r from-pink-500/10 to-purple-500/10 hover:from-pink-500/20 hover:to-purple-500/20 border border-pink-500/20",title:"",children:[e.jsx(y_,{className:"h-4 w-4 text-pink-500"}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent font-medium",children:"2025 "})]})}),e.jsxs("button",{onClick:()=>f(!0),className:"relative hidden md:flex items-center w-64 h-9 pl-9 pr-16 bg-background/50 border rounded-md hover:bg-accent/50 transition-colors text-left",children:[e.jsx(Tt,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"..."}),e.jsxs(eb,{size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2",children:[e.jsx("span",{className:"text-xs",children:""}),"K"]})]}),e.jsx(v3,{open:h,onOpenChange:f}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>window.open("https://docs.mai-mai.org","_blank"),className:"gap-2",title:"",children:[e.jsx(w_,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]}),e.jsx("button",{onClick:R=>{M1(w==="dark"?"light":"dark",g,R)},className:"rounded-lg p-2 hover:bg-accent",title:w==="dark"?"":"",children:w==="dark"?e.jsx(qm,{className:"h-5 w-5"}):e.jsx(Qi,{className:"h-5 w-5"})}),e.jsx("div",{className:"h-6 w-px bg-border"}),e.jsxs(_,{variant:"ghost",size:"sm",onClick:b,className:"gap-2",title:"",children:[e.jsx(__,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden bg-background",children:l}),e.jsx(b3,{})]})]})})}function k3(l){const n=l.split(`
`).slice(1),i=[];for(const c of n){const u=c.trim();if(!u.startsWith("at "))continue;const x=u.match(/at\s+(?:(.+?)\s+\()?(.+?):(\d+):(\d+)\)?$/);x?i.push({functionName:x[1]||"<anonymous>",fileName:x[2],lineNumber:x[3],columnNumber:x[4],raw:u}):i.push({functionName:"<unknown>",fileName:"",lineNumber:"",columnNumber:"",raw:u})}return i}function C3({error:l,errorInfo:n}){const[i,c]=d.useState(!0),[u,x]=d.useState(!1),[h,f]=d.useState(!1),p=l.stack?k3(l.stack):[],g=async()=>{const N=`
Error: ${l.name}
Message: ${l.message}

Stack Trace:
${l.stack||"No stack trace available"}

Component Stack:
${n?.componentStack||"No component stack available"}

URL: ${window.location.href}
User Agent: ${navigator.userAgent}
Time: ${new Date().toISOString()}
    `.trim();try{await navigator.clipboard.writeText(N),f(!0),setTimeout(()=>f(!1),2e3)}catch(v){console.error("Failed to copy:",v)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(at,{variant:"destructive",className:"border-red-500/50 bg-red-500/10",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsxs(lt,{className:"font-mono text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[l.name,":"]})," ",l.message]})]}),p.length>0&&e.jsxs(nc,{open:i,onOpenChange:c,children:[e.jsx(rc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(S_,{className:"h-4 w-4"}),"Stack Trace (",p.length," frames)"]}),i?e.jsx(Fr,{className:"h-4 w-4"}):e.jsx(za,{className:"h-4 w-4"})]})}),e.jsx(ic,{children:e.jsx(Ye,{className:"h-[280px] rounded-md border bg-muted/30",children:e.jsx("div",{className:"p-3 space-y-1",children:p.map((N,v)=>e.jsx("div",{className:"font-mono text-xs p-2 rounded hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"text-muted-foreground w-6 text-right flex-shrink-0",children:[v+1,"."]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-primary font-medium",children:N.functionName}),N.fileName&&e.jsxs("div",{className:"text-muted-foreground mt-0.5 break-all",children:[N.fileName,N.lineNumber&&e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:[":",N.lineNumber,":",N.columnNumber]})]})]})]})},v))})})})]}),n?.componentStack&&e.jsxs(nc,{open:u,onOpenChange:x,children:[e.jsx(rc,{asChild:!0,children:e.jsxs(_,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[e.jsxs("span",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(Jt,{className:"h-4 w-4"}),"Component Stack"]}),u?e.jsx(Fr,{className:"h-4 w-4"}):e.jsx(za,{className:"h-4 w-4"})]})}),e.jsx(ic,{children:e.jsx(Ye,{className:"h-[200px] rounded-md border bg-muted/30",children:e.jsx("pre",{className:"p-3 font-mono text-xs whitespace-pre-wrap text-muted-foreground",children:n.componentStack})})})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:g,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{className:"mr-2 h-4 w-4 text-green-500"}),""]}):e.jsxs(e.Fragment,{children:[e.jsx(Ro,{className:"mr-2 h-4 w-4"}),""]})})]})}function tb({error:l,errorInfo:n}){const i=()=>{window.location.href="/"},c=()=>{window.location.reload()};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(Ce,{className:"w-full max-w-2xl shadow-lg",children:[e.jsxs(De,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:e.jsx(Jt,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsx(Le,{className:"text-2xl font-bold",children:""}),e.jsx(ws,{className:"text-base mt-2",children:""})]}),e.jsxs(Ae,{className:"space-y-4",children:[e.jsx(C3,{error:l,errorInfo:n}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[e.jsxs(_,{onClick:c,className:"flex-1",children:[e.jsx(dt,{className:"mr-2 h-4 w-4"}),""]}),e.jsxs(_,{onClick:i,variant:"outline",className:"flex-1",children:[e.jsx(Jo,{className:"mr-2 h-4 w-4"}),""]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground pt-2",children:""})]})]})})}class T3 extends d.Component{constructor(n){super(n),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,i){console.error("ErrorBoundary caught an error:",n,i),this.setState({errorInfo:i})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError&&this.state.error?this.props.fallback?this.props.fallback:e.jsx(tb,{error:this.state.error,errorInfo:this.state.errorInfo}):this.props.children}}function ab({error:l}){return e.jsx(tb,{error:l,errorInfo:null})}const mc=w0({component:()=>e.jsxs(e.Fragment,{children:[e.jsx(Bg,{}),!1]}),beforeLoad:()=>{if(window.location.pathname==="/"&&!p3())throw S0({to:"/auth"})}}),E3=Qs({getParentRoute:()=>mc,path:"/auth",component:X1}),M3=Qs({getParentRoute:()=>mc,path:"/setup",component:x2}),nt=Qs({getParentRoute:()=>mc,id:"protected",component:()=>e.jsx(S3,{children:e.jsx(Bg,{})}),errorComponent:({error:l})=>e.jsx(ab,{error:l})}),z3=Qs({getParentRoute:()=>nt,path:"/",component:k1}),A3=Qs({getParentRoute:()=>nt,path:"/config/bot",component:K2}),O3=Qs({getParentRoute:()=>nt,path:"/config/modelProvider",component:nS}),D3=Qs({getParentRoute:()=>nt,path:"/config/model",component:MS}),R3=Qs({getParentRoute:()=>nt,path:"/config/adapter",component:ZS}),L3=Qs({getParentRoute:()=>nt,path:"/resource/emoji",component:b4}),U3=Qs({getParentRoute:()=>nt,path:"/resource/expression",component:S4}),$3=Qs({getParentRoute:()=>nt,path:"/resource/person",component:Y4}),B3=Qs({getParentRoute:()=>nt,path:"/resource/jargon",component:B4}),I3=Qs({getParentRoute:()=>nt,path:"/resource/knowledge-graph",component:lk}),P3=Qs({getParentRoute:()=>nt,path:"/resource/knowledge-base",component:nk}),H3=Qs({getParentRoute:()=>nt,path:"/logs",component:ik}),F3=Qs({getParentRoute:()=>nt,path:"/planner-monitor",component:pk}),G3=Qs({getParentRoute:()=>nt,path:"/chat",component:sC}),V3=Qs({getParentRoute:()=>nt,path:"/plugins",component:Lk}),q3=Qs({getParentRoute:()=>nt,path:"/plugin-detail",component:qk}),K3=Qs({getParentRoute:()=>nt,path:"/model-presets",component:$k}),Q3=Qs({getParentRoute:()=>nt,path:"/plugin-config",component:Pk}),Y3=Qs({getParentRoute:()=>nt,path:"/plugin-mirrors",component:Fk}),J3=Qs({getParentRoute:()=>nt,path:"/settings",component:G1}),X3=Qs({getParentRoute:()=>nt,path:"/config/pack-market",component:JC}),lb=Qs({getParentRoute:()=>nt,path:"/config/pack-market/$packId",component:m3}),Z3=Qs({getParentRoute:()=>nt,path:"/survey/webui-feedback",component:gC}),W3=Qs({getParentRoute:()=>nt,path:"/survey/maibot-feedback",component:jC}),e5=Qs({getParentRoute:()=>nt,path:"/annual-report",component:NC}),s5=Qs({getParentRoute:()=>mc,path:"*",component:hv}),t5=mc.addChildren([E3,M3,nt.addChildren([z3,A3,O3,D3,R3,L3,U3,B3,$3,I3,P3,V3,q3,K3,Q3,Y3,H3,F3,G3,J3,X3,lb,Z3,W3,e5]),s5]),a5=_0({routeTree:t5,defaultNotFoundComponent:hv,defaultErrorComponent:({error:l})=>e.jsx(ab,{error:l})});function l5({children:l,defaultTheme:n="system",storageKey:i="ui-theme",...c}){const[u,x]=d.useState(()=>localStorage.getItem(i)||n);d.useEffect(()=>{const f=window.document.documentElement;if(f.classList.remove("light","dark"),u==="system"){const p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";f.classList.add(p);return}f.classList.add(u)},[u]),d.useEffect(()=>{const f=localStorage.getItem("accent-color");if(f){const p=document.documentElement,N={blue:{hsl:"221.2 83.2% 53.3%",darkHsl:"217.2 91.2% 59.8%",gradient:null},purple:{hsl:"271 91% 65%",darkHsl:"270 95% 75%",gradient:null},green:{hsl:"142 71% 45%",darkHsl:"142 76% 36%",gradient:null},orange:{hsl:"25 95% 53%",darkHsl:"20 90% 48%",gradient:null},pink:{hsl:"330 81% 60%",darkHsl:"330 85% 70%",gradient:null},red:{hsl:"0 84% 60%",darkHsl:"0 90% 70%",gradient:null},"gradient-sunset":{hsl:"15 95% 60%",darkHsl:"15 95% 65%",gradient:"linear-gradient(135deg, hsl(25 95% 53%) 0%, hsl(330 81% 60%) 100%)"},"gradient-ocean":{hsl:"200 90% 55%",darkHsl:"200 90% 60%",gradient:"linear-gradient(135deg, hsl(221.2 83.2% 53.3%) 0%, hsl(189 94% 43%) 100%)"},"gradient-forest":{hsl:"150 70% 45%",darkHsl:"150 75% 40%",gradient:"linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%)"},"gradient-aurora":{hsl:"310 85% 65%",darkHsl:"310 90% 70%",gradient:"linear-gradient(135deg, hsl(271 91% 65%) 0%, hsl(330 81% 60%) 100%)"},"gradient-fire":{hsl:"15 95% 55%",darkHsl:"15 95% 60%",gradient:"linear-gradient(135deg, hsl(0 84% 60%) 0%, hsl(25 95% 53%) 100%)"},"gradient-twilight":{hsl:"250 90% 60%",darkHsl:"250 95% 65%",gradient:"linear-gradient(135deg, hsl(239 84% 67%) 0%, hsl(271 91% 65%) 100%)"}}[f];N&&(p.style.setProperty("--primary",N.hsl),N.gradient?(p.style.setProperty("--primary-gradient",N.gradient),p.classList.add("has-gradient")):(p.style.removeProperty("--primary-gradient"),p.classList.remove("has-gradient")))}},[]);const h={theme:u,setTheme:f=>{localStorage.setItem(i,f),x(f)}};return e.jsx(ov.Provider,{...c,value:h,children:l})}function n5({children:l,defaultEnabled:n=!0,defaultWavesEnabled:i=!0,storageKey:c="enable-animations",wavesStorageKey:u="enable-waves-background"}){const[x,h]=d.useState(()=>{const N=localStorage.getItem(c);return N!==null?N==="true":n}),[f,p]=d.useState(()=>{const N=localStorage.getItem(u);return N!==null?N==="true":i});d.useEffect(()=>{const N=document.documentElement;x?N.classList.remove("no-animations"):N.classList.add("no-animations"),localStorage.setItem(c,String(x))},[x,c]),d.useEffect(()=>{localStorage.setItem(u,String(f))},[f,u]);const g={enableAnimations:x,setEnableAnimations:h,enableWavesBackground:f,setEnableWavesBackground:p};return e.jsx(dv.Provider,{value:g,children:l})}const r5=Fw,nb=d.forwardRef(({className:l,...n},i)=>e.jsx(kj,{ref:i,className:I("fixed bottom-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:max-w-[420px] gap-2",l),...n}));nb.displayName=kj.displayName;const i5=Kr("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-slide-in-from-right data-[state=open]:animate-fade-in data-[state=closed]:animate-slide-out-to-right data-[state=closed]:animate-fade-out data-[swipe=end]:animate-slide-out-to-right",{variants:{variant:{default:"border bg-primary/5 text-foreground backdrop-blur-sm",destructive:"destructive group border-destructive bg-destructive/10 text-destructive-foreground backdrop-blur-sm"}},defaultVariants:{variant:"default"}}),rb=d.forwardRef(({className:l,variant:n,...i},c)=>e.jsx(Cj,{ref:c,className:I(i5({variant:n}),l),...i}));rb.displayName=Cj.displayName;const c5=d.forwardRef(({className:l,...n},i)=>e.jsx(Tj,{ref:i,className:I("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",l),...n}));c5.displayName=Tj.displayName;const ib=d.forwardRef(({className:l,...n},i)=>e.jsx(Ej,{ref:i,className:I("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",l),"toast-close":"",...n,children:e.jsx(Ea,{className:"h-4 w-4"})}));ib.displayName=Ej.displayName;const cb=d.forwardRef(({className:l,...n},i)=>e.jsx(Mj,{ref:i,className:I("text-sm font-semibold [&+div]:text-xs",l),...n}));cb.displayName=Mj.displayName;const ob=d.forwardRef(({className:l,...n},i)=>e.jsx(zj,{ref:i,className:I("text-sm opacity-90",l),...n}));ob.displayName=zj.displayName;function o5(){const{toasts:l}=Zs();return e.jsxs(r5,{children:[l.map(function({id:n,title:i,description:c,action:u,...x}){return e.jsxs(rb,{...x,children:[e.jsxs("div",{className:"grid gap-1",children:[i&&e.jsx(cb,{children:i}),c&&e.jsx(ob,{children:c})]}),u,e.jsx(ib,{})]},n)}),e.jsx(nb,{})]})}s1.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(T3,{children:e.jsx(l5,{defaultTheme:"system",children:e.jsx(n5,{children:e.jsxs(W2,{children:[e.jsx(k0,{router:a5}),e.jsx(tS,{}),e.jsx(o5,{})]})})})})}));
