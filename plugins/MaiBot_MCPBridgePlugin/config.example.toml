# MCPæ¡¥æ¥æ’ä»¶ - é…ç½®æ–‡ä»¶ç¤ºä¾‹
# å°† MCP (Model Context Protocol) æœåŠ¡å™¨çš„å·¥å…·æ¡¥æ¥åˆ° MaiBot
# 
# ä½¿ç”¨æ–¹æ³•ï¼šå¤åˆ¶æ­¤æ–‡ä»¶ä¸º config.tomlï¼Œç„¶åæ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®
#
# ============================================================
# ğŸ¯ å¿«é€Ÿå¼€å§‹ï¼ˆä¸‰æ­¥ï¼‰
# ============================================================
# 1. åœ¨ä¸‹æ–¹ [servers] æ·»åŠ  MCP æœåŠ¡å™¨é…ç½®
# 2. å°† enabled æ”¹ä¸º true å¯ç”¨æœåŠ¡å™¨
# 3. é‡å¯ MaiBot æˆ–å‘é€ /mcp reconnect
#
# ============================================================
# ğŸ“š å»å“ªæ‰¾ MCP æœåŠ¡å™¨ï¼Ÿ
# ============================================================
#
# ã€è¿œç¨‹æœåŠ¡ï¼ˆæ¨èæ–°æ‰‹ï¼‰ã€‘
#   - ModelScope: https://mcp.modelscope.cn/ (å…è´¹ï¼Œæ¨è)
#   - Smithery: https://smithery.ai/
#   - Glama: https://glama.ai/mcp/servers
#
# ã€æœ¬åœ°æœåŠ¡ï¼ˆéœ€è¦ npx æˆ– uvxï¼‰ã€‘
#   - å®˜æ–¹åˆ—è¡¨: https://github.com/modelcontextprotocol/servers
#
# ============================================================

# ============================================================
# ğŸ”Œ MCP æœåŠ¡å™¨é…ç½®
# ============================================================
#
# âš ï¸ é‡è¦ï¼šé…ç½®æ ¼å¼ï¼ˆClaude Desktop è§„èŒƒï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ç»Ÿä¸€ä½¿ç”¨ Claude Desktop çš„ mcpServers JSONã€‚
#
# claude_config_json çš„å†…å®¹åº”ä¸º JSON å¯¹è±¡ï¼š
# {
#   "mcpServers": {
#     "server_name": { ...server config... },
#     "another": { ... }
#   }
# }
#
# æ¯ä¸ªæœåŠ¡å™¨æ”¯æŒå­—æ®µï¼š
#   transport - ä¼ è¾“æ–¹å¼: "stdio" / "sse" / "http" / "streamable_http"ï¼ˆå¯é€‰ï¼‰
#   url       - æœåŠ¡å™¨åœ°å€ï¼ˆsse/http/streamable_http æ¨¡å¼ï¼‰
#   command   - å¯åŠ¨å‘½ä»¤ï¼ˆstdio æ¨¡å¼ï¼Œå¦‚ "npx" / "uvx"ï¼‰
#   args      - å‘½ä»¤å‚æ•°æ•°ç»„ï¼ˆstdio æ¨¡å¼ï¼‰
#   env       - ç¯å¢ƒå˜é‡å¯¹è±¡ï¼ˆstdio æ¨¡å¼ï¼Œå¯é€‰ï¼‰
#   headers   - é‰´æƒå¤´ï¼ˆå¯é€‰ï¼Œå¦‚ {"Authorization": "Bearer xxx"}ï¼‰
#   enabled   - æ˜¯å¦å¯ç”¨ï¼ˆå¯é€‰ï¼Œé»˜è®¤ trueï¼‰
#   post_process - æœåŠ¡å™¨çº§åˆ«åå¤„ç†é…ç½®ï¼ˆå¯é€‰ï¼‰
#
# ============================================================

[servers]
claude_config_json = '''
{
  "mcpServers": {
    "time-mcp-server": {
      "enabled": false,
      "transport": "streamable_http",
      "url": "https://mcp.api-inference.modelscope.cn/server/mcp-server-time"
    },
    "my-auth-server": {
      "enabled": false,
      "transport": "streamable_http",
      "url": "https://mcp.api-inference.modelscope.net/xxxxxx/mcp",
      "headers": {
        "Authorization": "Bearer ms-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
      }
    },
    "fetch-local": {
      "enabled": false,
      "command": "uvx",
      "args": ["mcp-server-fetch"]
    }
  }
}
'''

# ============================================================
# æ’ä»¶åŸºæœ¬ä¿¡æ¯
# ============================================================
[plugin]
name = "mcp_bridge_plugin"
version = "2.0.0"
config_version = "2.0.0"
enabled = false  # é»˜è®¤ç¦ç”¨ï¼Œåœ¨ WebUI ä¸­å¯ç”¨

# ============================================================
# Workflowï¼ˆç¡¬æµç¨‹/å·¥å…·é“¾ï¼‰
# ============================================================
#
# ä½œç”¨ï¼šæŠŠå¤šä¸ªå·¥å…·æŒ‰é¡ºåºæ‰§è¡Œï¼›åç»­æ­¥éª¤å¯å¼•ç”¨å‰åºè¾“å‡ºã€‚
#
# âœ… æ¨èé…ç½®æ–¹å¼ï¼šWebUIã€ŒWorkflowï¼ˆç¡¬æµç¨‹/å·¥å…·é“¾ï¼‰ã€é‡Œç”¨â€œå¿«é€Ÿæ·»åŠ â€è¡¨å•ã€‚
# âœ… ä¹Ÿå¯ä»¥ç›´æ¥å†™ chains_listï¼ˆJSON æ•°ç»„ï¼‰ã€‚
#
# å˜é‡æ›¿æ¢ï¼š
#   ${input.xxx}                     - ç”¨æˆ·è¾“å…¥
#   ${step.<output_key>}             - æŒ‡å®šæ­¥éª¤è¾“å‡ºï¼ˆéœ€è®¾ç½® output_keyï¼‰
#   ${prev}                          - ä¸Šä¸€æ­¥è¾“å‡º
#   ${prev.å­—æ®µ}                     - ä¸Šä¸€æ­¥è¾“å‡ºï¼ˆJSONï¼‰çš„å­—æ®µ
#   ${step.geo.return.0.location}    - æ•°ç»„/ä¸‹æ ‡è®¿é—®ï¼ˆdotï¼‰
#   ${step.geo.return[0].location}   - æ•°ç»„/ä¸‹æ ‡è®¿é—®ï¼ˆ[]ï¼‰
#   ${step.geo['return'][0]['location']} - bracket å†™æ³•
#
# ============================================================

[tool_chains]
chains_enabled = true

chains_list = '''
[
  {
    "name": "search_and_detail",
    "description": "å…ˆæœç´¢ï¼Œå†æ ¹æ®ç»“æœè·å–è¯¦æƒ…",
    "input_params": { "query": "æœç´¢å…³é”®è¯" },
    "steps": [
      { "tool_name": "æŠŠè¿™é‡Œæ›¿æ¢æˆä½ çš„æœç´¢å·¥å…·å", "args_template": { "keyword": "${input.query}" }, "output_key": "search" },
      { "tool_name": "æŠŠè¿™é‡Œæ›¿æ¢æˆä½ çš„è¯¦æƒ…å·¥å…·å", "args_template": { "id": "${prev}" } }
    ]
  }
]
'''

# ============================================================
# ReActï¼ˆè½¯æµç¨‹ï¼‰
# ============================================================
#
# ä½œç”¨ï¼šæŠŠ MCP å·¥å…·æ³¨å†Œåˆ° MaiBot çš„ ReAct ç³»ç»Ÿï¼ŒLLM å¯è‡ªä¸»å¤šè½®è°ƒç”¨ã€‚
#
# æ³¨æ„ï¼šReAct é€‚åˆâ€œæ¢ç´¢å¼/ä¸ç¡®å®šâ€åœºæ™¯ï¼›Workflow é€‚åˆâ€œå›ºå®š/å¯æ§â€åœºæ™¯ã€‚
#
# ============================================================

[react]
react_enabled = false
filter_mode = "whitelist"  # whitelist / blacklist
tool_filter = ""           # æ¯è¡Œä¸€ä¸ªå·¥å…·åï¼Œæ”¯æŒé€šé…ç¬¦ *

# ============================================================
# å…¨å±€è®¾ç½®ï¼ˆé«˜çº§è®¾ç½®å»ºè®®ä¿æŒé»˜è®¤ï¼‰
# ============================================================
[settings]
# ğŸ·ï¸ å·¥å…·å‰ç¼€ - ç”¨äºåŒºåˆ† MCP å·¥å…·å’ŒåŸç”Ÿå·¥å…·
tool_prefix = "mcp"

# â±ï¸ è¿æ¥è¶…æ—¶ï¼ˆç§’ï¼‰
connect_timeout = 30.0

# â±ï¸ è°ƒç”¨è¶…æ—¶ï¼ˆç§’ï¼‰
call_timeout = 60.0

# ğŸ”„ è‡ªåŠ¨è¿æ¥ - å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥æ‰€æœ‰å·²å¯ç”¨çš„æœåŠ¡å™¨
auto_connect = true

# ğŸ” é‡è¯•æ¬¡æ•° - è¿æ¥å¤±è´¥æ—¶çš„é‡è¯•æ¬¡æ•°
retry_attempts = 3

# â³ é‡è¯•é—´éš”ï¼ˆç§’ï¼‰
retry_interval = 5.0

# ğŸ’“ å¿ƒè·³æ£€æµ‹ - å®šæœŸæ£€æµ‹æœåŠ¡å™¨è¿æ¥çŠ¶æ€
heartbeat_enabled = true

# ğŸ’“ å¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰- å»ºè®® 30-120 ç§’
heartbeat_interval = 60.0

# ğŸ”„ è‡ªåŠ¨é‡è¿ - æ£€æµ‹åˆ°æ–­å¼€æ—¶è‡ªåŠ¨å°è¯•é‡è¿
auto_reconnect = true

# ğŸ”„ æœ€å¤§é‡è¿æ¬¡æ•° - è¿ç»­é‡è¿å¤±è´¥åæš‚åœé‡è¿
max_reconnect_attempts = 3

# ============================================================
# é«˜çº§åŠŸèƒ½ï¼ˆå®éªŒæ€§ï¼‰
# ============================================================
# ğŸ“¦ å¯ç”¨ Resources - å…è®¸è¯»å– MCP æœåŠ¡å™¨æä¾›çš„èµ„æº
enable_resources = false

# ğŸ“ å¯ç”¨ Prompts - å…è®¸ä½¿ç”¨ MCP æœåŠ¡å™¨æä¾›çš„æç¤ºæ¨¡æ¿
enable_prompts = false

# ============================================================
# ç»“æœåå¤„ç†åŠŸèƒ½
# ============================================================
# å½“ MCP å·¥å…·è¿”å›çš„å†…å®¹è¿‡é•¿æ—¶ï¼Œä½¿ç”¨ LLM å¯¹ç»“æœè¿›è¡Œæ‘˜è¦æç‚¼

# ğŸ”„ å¯ç”¨ç»“æœåå¤„ç†
post_process_enabled = false

# ğŸ“ åå¤„ç†é˜ˆå€¼ï¼ˆå­—ç¬¦æ•°ï¼‰- ç»“æœé•¿åº¦è¶…è¿‡æ­¤å€¼æ‰è§¦å‘åå¤„ç†
post_process_threshold = 500

# ğŸ”¢ åå¤„ç†è¾“å‡ºé™åˆ¶ - LLM æ‘˜è¦è¾“å‡ºçš„æœ€å¤§ token æ•°
post_process_max_tokens = 500

# ğŸ¤– åå¤„ç†æ¨¡å‹ï¼ˆå¯é€‰ï¼‰- ç•™ç©ºåˆ™ä½¿ç”¨ utils æ¨¡å‹ç»„
post_process_model = ""

# ğŸ§  åå¤„ç†æç¤ºè¯æ¨¡æ¿
post_process_prompt = '''ç”¨æˆ·é—®é¢˜ï¼š{query}

å·¥å…·è¿”å›å†…å®¹ï¼š
{result}

è¯·ä»ä¸Šè¿°å†…å®¹ä¸­æå–ä¸ç”¨æˆ·é—®é¢˜æœ€ç›¸å…³çš„å…³é”®ä¿¡æ¯ï¼Œç®€æ´å‡†ç¡®åœ°è¾“å‡ºï¼š'''

# ============================================================
# è°ƒç”¨é“¾è·¯è¿½è¸ª
# ============================================================
# è®°å½•å·¥å…·è°ƒç”¨è¯¦æƒ…ï¼Œä¾¿äºè°ƒè¯•å’Œåˆ†æ

# ğŸ” å¯ç”¨è°ƒç”¨è¿½è¸ª
trace_enabled = true

# ğŸ“Š è¿½è¸ªè®°å½•ä¸Šé™ - å†…å­˜ä¸­ä¿ç•™çš„æœ€å¤§è®°å½•æ•°
trace_max_records = 50

# ğŸ“ è¿½è¸ªæ—¥å¿—æ–‡ä»¶ - æ˜¯å¦å°†è¿½è¸ªè®°å½•å†™å…¥æ—¥å¿—æ–‡ä»¶
# å¯ç”¨åè®°å½•å†™å…¥ plugins/MaiBot_MCPBridgePlugin/logs/trace.jsonl
trace_log_enabled = false

# ============================================================
# å·¥å…·è°ƒç”¨ç¼“å­˜
# ============================================================
# ç¼“å­˜ç›¸åŒå‚æ•°çš„è°ƒç”¨ç»“æœï¼Œå‡å°‘é‡å¤è¯·æ±‚

# ğŸ—„ï¸ å¯ç”¨è°ƒç”¨ç¼“å­˜
cache_enabled = false

# â±ï¸ ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
cache_ttl = 300

# ğŸ“¦ æœ€å¤§ç¼“å­˜æ¡ç›® - è¶…å‡ºå LRU æ·˜æ±°
cache_max_entries = 200

# ğŸš« ç¼“å­˜æ’é™¤åˆ—è¡¨ - å³ä¸ç¼“å­˜çš„å·¥å…·ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œæ”¯æŒé€šé…ç¬¦ *ï¼‰
# æ—¶é—´ç±»ã€éšæœºç±»å·¥å…·å»ºè®®æ’é™¤
cache_exclude_tools = '''
mcp_*_time_*
mcp_*_random_*
'''

# ============================================================
# å·¥å…·ç®¡ç†
# ============================================================
[tools]
# ğŸ“‹ å·¥å…·æ¸…å•ï¼ˆåªè¯»ï¼‰- å¯åŠ¨åè‡ªåŠ¨ç”Ÿæˆ
tool_list = "(å¯åŠ¨åè‡ªåŠ¨ç”Ÿæˆ)"

# ğŸš« ç¦ç”¨å·¥å…·åˆ—è¡¨ - è¦ç¦ç”¨çš„å·¥å…·åï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰
# ä»ä¸Šæ–¹å·¥å…·æ¸…å•å¤åˆ¶å·¥å…·åï¼Œç¦ç”¨åè¯¥å·¥å…·ä¸ä¼šè¢« LLM è°ƒç”¨
# ç¤ºä¾‹ï¼š
# disabled_tools = '''
# mcp_filesystem_delete_file
# mcp_filesystem_write_file
# '''
disabled_tools = ""

# ============================================================
# æƒé™æ§åˆ¶
# ============================================================
[permissions]
# ğŸ” å¯ç”¨æƒé™æ§åˆ¶ - æŒ‰ç¾¤/ç”¨æˆ·é™åˆ¶å·¥å…·ä½¿ç”¨
perm_enabled = false

# ğŸ“‹ é»˜è®¤æ¨¡å¼
# allow_all: æœªé…ç½®è§„åˆ™çš„å·¥å…·é»˜è®¤å…è®¸
# deny_all: æœªé…ç½®è§„åˆ™çš„å·¥å…·é»˜è®¤ç¦æ­¢
perm_default_mode = "allow_all"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸš€ å¿«æ·é…ç½®ï¼ˆæ¨èæ–°æ‰‹ä½¿ç”¨ï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# ğŸš« ç¦ç”¨ç¾¤åˆ—è¡¨ - è¿™äº›ç¾¤æ— æ³•ä½¿ç”¨ä»»ä½• MCP å·¥å…·ï¼ˆæ¯è¡Œä¸€ä¸ªç¾¤å·ï¼‰
# ç¤ºä¾‹ï¼š
# quick_deny_groups = '''
# 123456789
# 987654321
# '''
quick_deny_groups = ""

# âœ… ç®¡ç†å‘˜ç™½åå• - è¿™äº›ç”¨æˆ·å§‹ç»ˆå¯ä»¥ä½¿ç”¨æ‰€æœ‰å·¥å…·ï¼ˆæ¯è¡Œä¸€ä¸ªQQå·ï¼‰
# ç¤ºä¾‹ï¼š
# quick_allow_users = '''
# 111111111
# '''
quick_allow_users = ""

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ“œ é«˜çº§æƒé™è§„åˆ™ï¼ˆå¯é€‰ï¼Œé’ˆå¯¹ç‰¹å®šå·¥å…·é…ç½®ï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ ¼å¼: qq:ID:group/private/userï¼Œå·¥å…·åæ”¯æŒé€šé…ç¬¦ *
# ç¤ºä¾‹ï¼š
# perm_rules = '''
# [
#   {"tool": "mcp_*_delete_*", "denied": ["qq:123456:group"]}
# ]
# '''
perm_rules = "[]"

# ============================================================
# çŠ¶æ€æ˜¾ç¤ºï¼ˆåªè¯»ï¼‰
# ============================================================
[status]
connection_status = "æœªåˆå§‹åŒ–"
